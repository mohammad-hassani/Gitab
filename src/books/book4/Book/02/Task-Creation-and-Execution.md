---
layout: layout.njk
title: ุงุฌุงุฏ ู ุงุฌุฑุง Task
---
# ูุตู ุฏูู: ุงุฌุงุฏ ู ุงุฌุฑุง Task โก

ุงู ูุตู ุจู ุดูุง ฺฉูฺฉ ูโฺฉูุฏ ุชุง ุฏุฑ ุจุฑูุงููโููุณ Task ุนููโุชุฑ ุดูุฏ.

ุฏุฑ ุงู ูุตูุ ุดูุง ุจุง ุฑูุดโูุง ูุฎุชูู ุงุฌุงุฏ ู ุงุฌุฑุง Task ุขุดูุง ุฎูุงูุฏ ุดุฏ.

ูพุณ ุงุฒ ุงุฌุฑุง ฺฉ Taskุ ููฺฉู ุงุณุช ุจุฎูุงูุฏ ูุชุฌู ุขู ุฑุง ูุดุงูุฏู ฺฉูุฏ. ุงู ุนู ูุงุฒู ุงุณุช ููุชุธุฑ ุชฺฉูู Task ุดูุฏ โณ.

ุจู ููู ุฏููุ ุงู ูุตู ููฺูู ุงููุงุน ูุฎุชูู ูฺฉุงูุฒูโูุง ุงูุชุธุงุฑ (Waiting Mechanisms) ุฑุง ุจุฑุฑุณ ูโฺฉูุฏ.

### ุงุฌุงุฏ ู ุงุฌุฑุง ฺฉ Task ๐๏ธ

ุดูุง ูโุชูุงูุฏ **Task**โูุง ุฑุง ุจู ุฑูุดโูุง ูุฎุชูู ุงุฌุงุฏ ู ุงุฌุฑุง ฺฉูุฏ. ูุฑุถ ฺฉูุฏ ฺฉุฏ ุฒุฑ ุฑุง ุฏุงุฑู:

```csharp
static void DoSomeTask()
{
    // Some code
}
```

ุจุง ุชูุฌู ุจู ฺฉุฏ ุจุงูุงุ ุจุงุฏ ุฑุงุฌโุชุฑู ุฑูุดโูุง ุงุฌุงุฏ ู ุงุฌุฑุง **Task** ุฑุง ุจุฑุฑุณ ฺฉูู:

ยฉ **Vaskaran Sarcar 2025**
**V. Sarcar, Task Programming in C# and .NET, Apress Pocket Guides,**
[https://doi.org/10.1007/979-8-8688-1279-8\_2](https://doi.org/10.1007/979-8-8688-1279-8_2)

---

### **ูุตู ฒ โ ุงุฌุงุฏ ู ุงุฌุฑุง Task**

#### **ุฑูุด ฑ:**

ูุชุฏ **Task.Run** ุฑูุด ูพุดููุงุฏ ู ุฑุงุฌ ุจุฑุง ุงุฌุงุฏ ู ุดุฑูุน ฺฉ **Task** ุงุณุช. ุงู ุฑูุด ุจู ุดูุง ฺฉูฺฉ ูโฺฉูุฏ ุชุง ุจูุงูุงุตูู ูพุณ ุงุฒ ุงุฌุงุฏุ **Task** ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ุงุฌุฑุง ุดูุฏ. ููููู ฺฉุฏ:

```csharp
Task task = Task.Run(DoSomeTask);
```

---

#### **ุฑูุด ฒ:**

ุจุฑุง ุงุฌุงุฏ ู ุงุฌุฑุง ุฎูุฏฺฉุงุฑ ฺฉ **Task** ูโุชูุงูุฏ ุงุฒ ูุชุฏ **Task.Factory.StartNew** ูู ุงุณุชูุงุฏู ฺฉูุฏ. ุงู ุฑูุด ุจู ุดูุง ุงูฺฉุงู ูโุฏูุฏ ฺฏุฒููโูุง ูพุดุฑูุชูโุชุฑ ุจุฑุง ูพฺฉุฑุจูุฏ **Task**ูุง ุงุนูุงู ฺฉูุฏ. ููููู ฺฉุฏ:

```csharp
Task task = Task.Factory.StartNew(DoSomeTask);
```

---

#### **ุฑูุด ณ:**

ููฺูู ูโุชูุงูุฏ ุงุฒ **ุณุงุฒูุฏู Task** ุงุณุชูุงุฏู ฺฉูุฏ ุชุง ฺฉ **Task** ุจุณุงุฒุฏ. ุงูุง ุฏุฑ ุงู ุญุงูุช ุจุงุฏ ุจูโุทูุฑ **ุตุฑุญ** ุขู ุฑุง ุจุง ูุฑุงุฎูุงู ูุชุฏ **Start** ุดุฑูุน ฺฉูุฏ. ููููู ฺฉุฏ:

```csharp
Task task = new Task(DoSomeTask);
task.Start();
```

ุงุฒ **C# 9** ุจู ุจุนุฏุ ูโุชูุงูุฏ ุงุฒ **target-typed new expressions** ุงุณุชูุงุฏู ฺฉูุฏ ุชุง ฺฉุฏ ุณุงุฏูโุชุฑ ุดูุฏ:

```csharp
Task task = new(DoSomeTask);
task.Start();
```

---

**ูฺฉุชู:**
ุดูุง ุจุง ุฑูุดโูุง ุขุดูุง ุดุฏุฏ ฺฉู ุจูโุตูุฑุช ุตุฑุญ **Task** ุงุฌุงุฏ ู ุงุฌุฑุง ูโฺฉููุฏ. ุงูุง ุฑูุดโูุง ุฏฺฏุฑ ูู ูุฌูุฏ ุฏุงุฑุฏ. ุจุฑุง ูุซุงู:

* ูโุชูุงูุฏ **Task**ูุง ุฑุง ุจูโุตูุฑุช **ุถูู** ุจุง ุงุณุชูุงุฏู ุงุฒ ูุชุฏ **Parallel.Invoke** ุงุฌุงุฏ ู ุงุฌุฑุง ฺฉูุฏ.
* ููฺูู ฺฉูุงุณ **TaskCompletionSource<TResult>** ุจู ุดูุง ฺฉูฺฉ ูโฺฉูุฏ **Task**ูุง ูฺู ู ููุงุณุจ ุจุฑุง ุณูุงุฑููุง ุฎุงุต ุงุฌุงุฏ ฺฉูุฏ.

ุจุง ุงู ุญุงูุ ุจูุชุฑ ุงุณุช ุงู ููุงูู ุฑุง ฺฏุงูโุจูโฺฏุงู ุงุฏ ุจฺฏุฑู.

---

### **ฺฉูพุณููู ฺฉุฑุฏู ฺฉุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ Lambda Expression** โก

ุดูุง ูโุชูุงูุฏ ุจุง ุงุฑุงุฆู ฺฉ **delegate** ฺฉู ฺฉุฏ ููุฑุฏูุธุฑ ุฑุง ฺฉูพุณููู ูโฺฉูุฏุ ฺฉ **Task** ุจุณุงุฒุฏ. ุงู **delegate** ูโุชูุงูุฏ ุจู ุตูุฑุช ฺฉ **delegate ูุงูโฺฏุฐุงุฑโุดุฏู**ุ ฺฉ **ูุชุฏ ูุงุดูุงุณ** ุง ฺฉ **lambda expression** ุจุงู ุดูุฏ.

ุฏุฑ ุงูุฌุง ูููููโุง ุงุฒ ฺฉ **Task** ุฏฺฏุฑ ุงุฑุงุฆู ุดุฏู ุงุณุช ฺฉู ุฏุฑ ุขู ฺฉุฏ ูุงุฒู ุฑุง ุฏุฑูู ฺฉ **lambda expression** ูุฑุงุฑ ุฏุงุฏูโุงู:

```csharp
Task task = Task.Run(
    () =>
    {
    }
);
```

---

### **ููุงุด ฑ** ๐

ุจุงุฏ ุจุฑุฑุณ ฺฉูู ฺฉู ุขุง **Task**โูุง ุจู ูุง ฺฉูฺฉ ูโฺฉููุฏ **ุจุฑูุงููโููุณ ุบุฑููุฒูุงู (Asynchronous Programming)** ุงูุฌุงู ุฏูู ุง ุฎุฑ. ุจุฑุง ุงู ููุธูุฑ ุงุฒ ููุงุด ุฒุฑ ุงุณุชูุงุฏู ูโฺฉูู:
<div align="center">

![Conventions-UsedThis-Book](../../../assets/image/02/Table%202-1.jpeg)
</div>

### **ูฺฉุชูโุง ุจุฑุง ุงุฏุขูุฑ** ๐

ุงุฒ **.NET 6** ุจู ุจุนุฏุ ููฺฉู ุงุณุช ูุชูุฌู ูุฌูุฏ **implicit global directives** ุจุฑุง ูพุฑูฺูโูุง ุฌุฏุฏ **C#** ุดูุฏ. ุงู ูุงุจูุช ฺฉูฺฉ ูโฺฉูุฏ ุจุฏูู ูุงุฒ ุจู ููุดุชู ูุงู ฺฉุงูู ุง ุงุถุงูู ฺฉุฑุฏู ุฏุณุช ุฏุณุชูุฑ **using**ุ ุงุฒ ุงููุงุน ููุฌูุฏ ุฏุฑ ุงู **namespace**ูุง ุงุณุชูุงุฏู ฺฉูุฏ.
ูโุชูุงูุฏ ุงุทูุงุนุงุช ุจุดุชุฑ ุฑุง ุงุฒ ููฺฉ ุฒุฑ ูุทุงูุนู ฺฉูุฏ:
[https://learn.microsoft.com/en-us/dotnet/core/project-sdk/overview#implicit-usingdirectives](https://learn.microsoft.com/en-us/dotnet/core/project-sdk/overview#implicit-usingdirectives)

ุฏุฑ ูพุฑูฺูโูุง **C#** ุงู ฺฉุชุงุจุ ูู ุชูุธูุงุช ูพุดโูุฑุถ ุฑุง ุชุบุฑ ูุฏุงุฏูโุงู. ุจูุงุจุฑุงูุ ูุงูโูุง ุฒุฑ ุฑุง ุจูโุตูุฑุช ุฏุณุช ุฐฺฉุฑ ูฺฉุฑุฏูโุงูุ ฺูู ุจูโุทูุฑ ูพุดโูุฑุถ ููุฌูุฏ ูุณุชูุฏ:

```
System
System.Collections.Generic
System.IO
System.Linq
System.Net.Http
System.Threading
System.Threading.Tasks
using static System.Console;
```

---

### **ููููู ฺฉุฏ** ๐ป

```csharp
WriteLine("The main thread starts executing.");
Task.Run(PrintNumbers);
WriteLine($"The main thread is doing some other work...");
// Simulating a delay
Thread.Sleep(10);
WriteLine($"The main thread is completed.");
ReadKey();

static void PrintNumbers()
{
    for (int i = 1; i <= 5; i++)
    {
        Write($" {i}\t");
        // Simulating a delay
        Thread.Sleep(2);
    }
}
```

---

### **ุฎุฑูุฌ** ๐ฅ๏ธ

ุฏุฑ ุงุฏุงููุ ฺฉ ุฎุฑูุฌ ููููู ุงุฒ ุงู ุจุฑูุงูู ุฑุง ฺฉู ุฏุฑ ุณุณุชู ูู ุงุฌุฑุง ุดุฏูุ ูุดุงูุฏู ูโฺฉูุฏ. ุจุฏู ุงุณุช ฺฉู ููฺฉู ุงุณุช ุฎุฑูุฌ ุฏุฑ ุณุณุชู ุดูุง ูุชูุงูุช ุจุงุดุฏ. ููุงูโุทูุฑ ฺฉู ูโุจูุฏุ **main thread** ุฏุฑ ุญู ุงุฌุฑุง **task** ฺุงูพ ุงุนุฏุงุฏุ **ูุณุฏูุฏ ูุดุฏู ุงุณุช**. ูุชุฌูุ ุชุฑฺฉุจ ุฌุงูุจ ุงุฒ ุฎุฑูุฌ ฺูุฏ **thread/task** ุงุณุช:

```
The main thread starts executing.
The main thread is doing some other work...
1
2
4
5
3
The main thread is completed.
```

---

### **ุฌูุณู ูพุฑุณุด ู ูพุงุณุฎ (Q\&A Session)** โ๐ฌ

**ุณูุงู 2.1**
ุจุฑุง ุงุฌุงุฏ ู ุงุฌุฑุง **Task** ุดูุง ุงุฒ ูุชุฏูุง **Run**ุ **Start** ู **StartNew** ุงุณุชูุงุฏู ฺฉุฑุฏุฏ. ฺุทูุฑ ุชุตูู ุจฺฏุฑู ฺฉุฏุงูโฺฉ ุจุฑุง ูุง ููุงุณุจโุชุฑ ุงุณุชุ

**ูพุงุณุฎ:**
ุงฺฏุฑ ุชุนุงุฑู ุงู ูุชุฏูุง ุฑุง ุฏุฑ **Visual Studio** ุจุฑุฑุณ ฺฉูุฏุ ุฌููู ุฒุฑ ุฑุง ุฎูุงูุฏ ุฏุฏ:

> โThe Start method starts the System.Threading.Tasks.Task, scheduling it for execution to the specified System.Threading.Tasks.TaskScheduler.โ

ุงู ูุชุฏ ุฒูุงู ููุฏ ุงุณุช ฺฉู ุจุฎูุงูุฏ **Task** ุฑุง ุจุณุชู ุจู ฺฉ ุดุฑุท ุฎุงุตุ **ุจูโุตูุฑุช ุฏุณุช** ุงุฌุฑุง ฺฉูุฏ.

ูุชุฏ **Run**ุ ฺฉุงุฑ ูุดุฎุตโุดุฏู ุฑุง ุฏุฑ **thread pool** ูุฑุงุฑ ูโุฏูุฏ ู ฺฉ ุดุก **System.Threading.Tasks.Task** ุฑุง ฺฉู ูุดุงูโุฏููุฏู ููุงู ฺฉุงุฑ ุงุณุชุ ุจุฑูโฺฏุฑุฏุงูุฏ. ุงู ุฑูุด ฺฉ ุฌุงฺฏุฒู ุณุจฺฉโุชุฑ ูุณุจุช ุจู **StartNew** ุงุณุช ู ุจู ุดูุง ฺฉูฺฉ ูโฺฉูุฏ ุชุง ุจุง ููุงุฏุฑ ูพุดโูุฑุถ ฺฉ **Task** ุฑุง ุดุฑูุน ฺฉูุฏ.

ูฺฉุชู ููู ุงู ุงุณุช ฺฉู ูุชุฏ **Run** ุงุฒ **task scheduler ูพุดโูุฑุถ** ุงุณุชูุงุฏู ูโฺฉูุฏุ ุตุฑูโูุธุฑ ุงุฒ ุงูฺฉู **task scheduler** ูุนู ฺู ฺุฒ ุจุงุดุฏ. ุจู ููู ุฏููุ **Microsoft** (ุฏุฑ ููฺฉ [Task-based asynchronous programming](https://learn.microsoft.com/en-us/dotnet/standard/parallel-programming/task-based-asynchronous-programming)) ูพุดููุงุฏุงุช ุฒุฑ ุฑุง ุงุฑุงุฆู ฺฉุฑุฏู ุงุณุช:

* ุฒูุงู ฺฉู ูุงุฒ ุจู ฺฉูุชุฑู ุฒุงุฏ ุจุฑ ูุฑุขูุฏ ุงุฌุงุฏ ู ุฒูุงูโุจูุฏ **Task** ูุฏุงุฑุฏุ **Run** ุจูุชุฑู ฺฏุฒูู ุจุฑุง ุงุฌุงุฏ ู ุดุฑูุน **Task** ุงุณุช.

---

**ูุงฺฉุฑูุณุงูุช ููฺูู ุจุงู ูโฺฉูุฏ** (ุฏุฑ ููุงู ููฺฉ) ฺฉู ูุชุฏ **StartNew** ุฏุฑ ุดุฑุงุท ุฒุฑ ฺฉุงุฑุจุฑุฏ ุฏุงุฑุฏ:

* ุฒูุงู ฺฉู **ุงุฌุงุฏ ู ุฒูุงูโุจูุฏ Task** ูุจุงุฏ ุงุฒ ูู ุฌุฏุง ุจุงุดูุฏ ู ุดูุง ุจู ฺฏุฒููโูุง ุงุถุงู ุจุฑุง ุงุฌุงุฏ **Task** ุง ุงุณุชูุงุฏู ุงุฒ ฺฉ **scheduler ุฎุงุต** ูุงุฒ ุฏุงุฑุฏ.
* ุฒูุงู ฺฉู ุจุงุฏ ฺฉ **ูุถุนุช ุงุถุงู (state)** ุฑุง ุจู **Task** ุงุฑุณุงู ฺฉูุฏ ฺฉู ุจุนุฏุงู ุงุฒ ุทุฑู ูฺฺฏ **Task.AsyncState** ูุงุจู ุจุงุฒุงุจ ุจุงุดุฏ.

<div align="center">

![Conventions-UsedThis-Book](../../../assets/image/02/Table%202-2.jpeg)
</div>

### **ูฺฉุชูโุง ฺฉู ุจุงุฏ ุจู ุฎุงุทุฑ ุจุณูพุงุฑุฏ** ๐

ุจุฑุง ุงูฺฉู ฺฉ ูุซุงู ูุดุฎุต ุฏุงุดุชู ุจุงุดูุ ุจุงุฏ ุจุฏุงูุฏ ฺฉู ุจูโุฒูุฏ ุฏุฑุจุงุฑู **child tasks (ุง nested tasks)** ุงุฏ ุฎูุงูุฏ ฺฏุฑูุช. ุฏุฑ ุขูุฌุง ุฎูุงูุฏ ุฏุฏ ฺฉู ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฏุฒูู **TaskCreationOptions.AttachedToParent** ูโุชูุงูุฏ ฺฉ **task ูุฑุฒูุฏ** ุฑุง ุจู **task ูุงูุฏ** ูุชุตู ฺฉูุฏ (ุงูุจุชู ุงฺฏุฑ **task ูุงูุฏ** ุงู ฺฉุงุฑ ุฑุง ูุฌุงุฒ ุจุฏุงูุฏ). ุงู ฺฏุฒูู ุฏุฑ ุจุฑุฎ ุงุฒ **overload**ูุง ูุชุฏ **StartNew** ุฏุฑ ุฏุณุชุฑุณ ุงุณุช.
ุงูุง ูุชุฏ **Run** ฺูู ฺฏุฒููโุง ุฑุง ุงุฑุงุฆู ููโุฏูุฏ.

---

### **ุงุฑุณุงู ู ุฏุฑุงูุช ููุงุฏุฑ** ๐

ุฏุฑ ุงู ุจุฎุด ุจุฑุฑุณ ูโฺฉูู ฺฉู ฺฺฏููู ูโุชูุงูุฏ **ููุฏุงุฑ(ูุง)** ุฑุง ุจู ฺฉ **task** ุงุฑุณุงู ฺฉูุฏ ุง ฺฉ ููุฏุงุฑ ูุญุงุณุจูโุดุฏู ุฑุง ุงุฒ ุขู ุฏุฑุงูุช ฺฉูุฏ.

---

### **ุงุฑุณุงู ููุงุฏุฑ ุจู ุฏุงุฎู Tasks** ๐ฏ

ุฏุฑ **ููุงุด ฑ**ุ ูุชุฏ **PrintNumbers** ุงุนุฏุงุฏ ุฑุง ุงุฒ **ฑ ุชุง ต** ฺุงูพ ูโฺฉุฑุฏ. ุจุงุฏ ุงู ุชุงุจุน ุฑุง ุชุบุฑ ุฏูู ุชุง ุจุชูุงูุฏ **ุขุฑฺฏููุงู** ุฏุฑุงูุช ฺฉูุฏ. ุฏุฑ ุงุฏุงููุ ูุณุฎู ุงุตูุงุญโุดุฏู ุงู ุชุงุจุน ุจุง ุชุบุฑุงุช ฺฉูุฏ (ูพุฑุฑูฺฏโุดุฏู):

```csharp
static void PrintNumbers(int limit)
{
    for (int i = 1; i <= limit; i++)
    {
        Write($" {i}\t");
        // Simulating a delay
        Thread.Sleep(2);
    }
}
```

---

ุงฺฏุฑ ุจุฎูุงูุฏ ุงู ุชุงุจุน ุฑุง ุฏุฑ ฺฉ **thread** ุฌุฏุงฺฏุงูู ุงุฌุฑุง ฺฉูุฏุ ุจุงุฏ ฺฉ ุขุฑฺฏููุงู ูุนุชุจุฑ (ุจุฑุง ูพุงุฑุงูุชุฑ **limit**) ุงุฒ **thread ูุฑุงุฎูุงููุฏู** ุงุฑุณุงู ฺฉูุฏ.
ุจูุงุจุฑุงูุ ุฎุท ุฒุฑ ุงุฒ **ููุงุด ฑ** ุฑุง:

```csharp
Task task = Task.Run(PrintNumbers);
```

ุจุง ุฎุท ุฒุฑ ุฌุงฺฏุฒู ฺฉูุฏ:

```csharp
Task task = Task.Run(() => PrintNumbers(5));
```

---

ุงฺฉููู ุงฺฏุฑ ุจุฑูุงูู ุฑุง ุฏูุจุงุฑู ุงุฌุฑุง ฺฉูุฏุ ุฎุฑูุฌ ูุดุงุจู ุฎูุงูุฏ ุฏุฏ ฺฉู ุฏุฑ ุงุฌุฑุง **ููุงุด ฑ** ุฏุฏู ุจูุฏุฏ.

ูุงุฒู ูุณุช ุงุฏุขูุฑ ฺฉูู ฺฉู ูโุชูุงูุฏ ุฎุท ูุจู ุฑุง ุจุง ุฎุท ุฒุฑ ูู ุฌุงฺฏุฒู ฺฉูุฏ:

```csharp
Task task = Task.Factory.StartNew(() => PrintNumbers(5));
```

ุง ุงู ุฎุทูุท:

```csharp
Task task = new(() => PrintNumbers(5));
task.Start();
```

---

ุจุงุฏ ฺฉ ุฑูฺฉุฑุฏ ุฌุงฺฏุฒู ุฑุง ุจุฑุฑุณ ฺฉูู. ุฏุฑ ุฒูุงู ูฺฏุงุฑุด ุงู ฺฉุชุงุจุ ฺฉูุงุณ **Task** ุฏุงุฑุง ุณุงุฒูุฏูโูุง ุฒุฑ ุงุณุช (ุดฺฉู ฒ-ฑ ุฑุง ุจุจูุฏ).

<div align="center">

![Conventions-UsedThis-Book](../../../assets/image/02/Table%202-3.jpeg)
</div>

### **ุดฺฉู ฒ-ฑ. ููุง ุฌุฒุฆ ุงุฒ ูุณุฎูโูุง Overload ุดุฏู ุณุงุฒูุฏูโูุง Task** ๐ผ๏ธ

ุจู ุณุงุฒูุฏู ุฒุฑ ฺฉู ุฏุฑ **ุดฺฉู ฒ-ฑ** ุจุฑุฌุณุชู ุดุฏูุ ุชูุฌู ฺฉูุฏ:

```csharp
public Task(Action<object?> action, object? state);
```

ุงู ุณุงุฒูุฏู ุจู ุดูุง ุงู ุงุฏู ุฑุง ูโุฏูุฏ ฺฉู ูโุชูุงูุฏ ฺฉ **ุขุฑฺฏููุงู ุดุก (object)** ุจู ุขู ุงุฑุณุงู ฺฉูุฏ.
ุจุงุฏ ฺฉ ุชุงุจุน ุฌุฏุฏ ุจู ูุงู **PrintNumbersVersion2** ูุนุฑู ฺฉูู ฺฉู ฺฉ **ูพุงุฑุงูุชุฑ ุงุฒ ููุน object** ูโฺฏุฑุฏ ู ฺฉุงุฑ ูุดุงุจู ุงูุฌุงู ูโุฏูุฏ:

```csharp
static void PrintNumbersVersion2(object? state)
{
    int limit = Convert.ToInt32(state);
    for (int i = 0; i <= limit; i++)
    {
        Write($" {i}\t");
        // Doing remaining things, if any
        Thread.Sleep(2);
    }
}
```

---

ุงู ุจุงุฑ ูโุชูุงูุฏ ฺุฒ ุดุจู ุจู ุงู ุจููุณุฏ:

```csharp
Task task = new(PrintNumbersVersion2, 5);
task.Start();
```

ุง:

```csharp
Task task = Task.Factory.StartNew(PrintNumbersVersion2, 5);
```

ุงูุง **ูุชุฏ Run** ฺูู ุณุงุฒูุฏูโุง ูุฏุงุฑุฏ. ุจูุงุจุฑุงู ููโุชูุงูุฏ ฺุฒ ูุงููุฏ ุฒุฑ ุจููุณุฏ:

```csharp
Task task4 = Task.Run(PrintNumbersVersion2, 5); // Error
```

---

ุฎุจุ ุชุง ุงูุฌุง ุฑูุดโูุง ูุฎุชูู ุงุฑุณุงู **state** ุฑุง ุฏุฏุฏ. ุจุงุฏ ุขูโูุง ุฑุง ุฎูุงุตู ฺฉูู:

```csharp
// Approach-1:
var task1 = Task.Run(() => PrintNumbers(10));

// Approach-2:
var task2 = Task.Factory.StartNew(() => PrintNumbers(10));

// Approach-3:
var task3 = new Task(() => PrintNumbers(10));
task3.Start();

// Approach-4:
var task4 = new Task(PrintNumbersVersion2, 10);
task4.Start();

// Approach-5:
var task5 = Task.Factory.StartNew(PrintNumbersVersion2, 10);
```

---

ูโุจูุฏ ฺฉู ุฏุฑ ูุฑ ุฑูุดุ ูู ฺฉ ููุฏุงุฑ **int** ุงุฑุณุงู ฺฉุฑุฏูโุงู. ุจุง ุงู ุญุงูุ ุฏุฑ ุฏู ููุฑุฏ ุขุฎุฑุ ูุชุฏ ูุฏู (**PrintNumbersVersion2**) ุงูุชุธุงุฑ ฺฉ **object** ุฏุงุดุช.
ุฏุฑ ูุชุฌูุ ุงู ุฏู ุฑูุด ุจุง ูุณุฃูู **boxing** ู **unboxing** ููุงุฌู ูโุดููุฏ. ุฏุฑ ููุงุจูุ ุงู ุฏู ุฑูุด ูุณุจุช ุจู ุฑูุดโูุง ฑุ ฒ ุง ณ **ุฎูุงูุงุชุฑ ู ูุฑุชุจโุชุฑ** ูุณุชูุฏ.

ุฏุฑ ููุงุชุ ุงูุชุฎุงุจ ุจุง ุดูุงุณุช ฺฉู ฺฉุฏุงู ุฑูุด ุฑุง ุชุฑุฌุญ ุฏูุฏ ู ฺฺฏููู ุขู ุฑุง ุณุงุฒูุงูโุฏู ฺฉูุฏ.

---

**ูฺฉุชู:**
ุจุฑุง ุชุฌุฑุจู ุงู ุฑูุดโูุงุ ูพุฑูฺู **Chapter2\_Demo2A\_PassingValues** ุฑุง ุฏุงูููุฏ ฺฉูุฏ ู ุขูโูุง ุฑุง ุงุฌุฑุง ฺฉูุฏ.

---

### **ุจุฑฺฏุฑุฏุงูุฏู ููุงุฏุฑ ุงุฒ Taskูุง** ๐

ููุช ฺฉ **Task** ุฑุง ุงุฌุฑุง ูโฺฉูุฏุ ููฺฉู ุงุณุช ูุงุฒ ุฏุงุดุชู ุจุงุดุฏ ุจู **ููุฏุงุฑ ููุง** ุขู ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดุฏ.
ุฏุฑ ฺูู ุดุฑุงุท ุจุงุฏ ุงุฒ **ูุณุฎู ุฌูุฑฺฉ ฺฉูุงุณ Task** ู ูฺฺฏ **Result** ุงุณุชูุงุฏู ฺฉูุฏ.

ุฏุฑ ุงูุฌุง ฺฉ ููููู ฺฉุฏ:

```csharp
var task = Task<string>.Run(() => "Hello");
var result = task.Result;
WriteLine(result);
```

---

ุจุง ุงู ุญุงูุ **ููุน ุฌูุฑฺฉ** ูโุชูุงูุฏ ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ **ุงุณุชูุชุงุฌ (inferred)** ุดูุฏ. ุฏุฑ ูุชุฌูุ ูโุชูุงูุฏ ุงู ฺฉุฏ ุฑุง ุณุงุฏูโุชุฑ ูู ุจููุณุฏ:

```csharp
var task = Task.Run(() => "Hello");
var result = task.Result;
WriteLine(result);
```

<div align="center">

![Conventions-UsedThis-Book](../../../assets/image/02/Table%202-4.jpeg)
</div>

### **ูฺฉุชูโุง ฺฉู ุจุงุฏ ุจู ุฎุงุทุฑ ุจุณูพุงุฑุฏ** ๐

ุฏุฑ ุจุฎุดโูุง ูุจูุ ูู ุจุฑุง **ฺฉุงูุด ุชุงูพ** ุงุฒ **var** ุงุณุชูุงุฏู ฺฉุฑุฏู. ุฏุฑ ุงุฏุงูู ฺฉ ููููู ฺฉุฏ ูุนุงุฏู ฺฉู **ุงููุงุน ุจูโุตูุฑุช ุตุฑุญ ูุดุฎุต ุดุฏูโุงูุฏ** ุฑุง ูโุจูุฏ:

```csharp
Task<string> task = Task.Run(() => "Hello");
string result = task.Result;
WriteLine(result);
```

---

### **ููุงุด ฒ** ๐

ุจุงุฏ ฺฉ ุจุฑูุงูู ฺฉุงูู ุจุจูู ฺฉู ุฏุฑ ุขู **Taskูุง ุณุงุฎุชู ูโุดููุฏุ ููุงุฏุฑ ุจู ุขูโูุง ุงุฑุณุงู ูโุดูุฏ ู ุฏุฑ ููุงุช ููุฏุงุฑ ูุญุงุณุจูโุดุฏู ุจุงุฒุงุจ ูโฺฏุฑุฏุฏ.**

ุฏุฑ ููุงุด ุฒุฑุ ูู ฺฉ **Task** ุงุฌุงุฏ ูโฺฉูู ฺฉู ุฏู ุนุฏุฏ ุตุญุญ (**ฑฐ** ู **ฒฐ**) ุฑุง ุจุง ูู ุฌูุน ูโฺฉูุฏ. ููุช ุงู **Task** ุชูุงู ุดุฏุ ูุชุฌู ูุญุงุณุจู ุฑุง ุจุงุฒุงุจ ฺฉุฑุฏู ู ุฏุฑ ูพูุฌุฑู **ฺฉูุณูู** ููุงุด ูโุฏูู. ุญุงูุง ุจุฑูุงูู ฺฉุงูู ุฑุง ุจุจูู:

```csharp
using static System.Console;
static int Add(int number1, int number2) => number1 + number2;

WriteLine("Passing and returning values by executing tasks.");
int firstNumber = 10;
int SecondNumber = 20;

var addTask = Task.Run(() => Add(firstNumber, SecondNumber));
var result = addTask.Result;

WriteLine($"{firstNumber}+{SecondNumber}={result}");
WriteLine($"The main thread is completed.");
```

---

### **ุฎุฑูุฌ** ๐ฅ๏ธ

```
Passing and returning values by executing tasks.
10+20=30
The main thread is completed.
```

---

### **ุฌูุณู ูพุฑุณุด ู ูพุงุณุฎ (Q\&A Session)** โ๐ฌ

**ุณูุงู 2.2**
ูโุจูู ฺฉู ุฏุฑ ููุงุด ูุจูุ ุงุฒ ูุชุฏ **ReadKey** ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุจุณุชูโุดุฏู ุจุฑูุงูู **Console** ุงุณุชูุงุฏู ูฺฉุฑุฏุฏ. ุงู ุนูุฏ ุจูุฏุ

**ูพุงุณุฎ:**
ููุช ูโุฎูุงูุฏ ุงุฒ ฺฉ **Task** ูุชุฌู ุจฺฏุฑุฏุ ุจุงุฏ **ุตุจุฑ ฺฉูุฏ** ุชุง ุขู **Task** ุงุฌุฑุง ุฎูุฏ ุฑุง ฺฉุงูู ฺฉูุฏ. ุนู ุจุงุฏ ฺฉ ุนููุงุช **ูุณุฏูุฏฺฉููุฏู (blocking)** ุงูุฌุงู ุฏูุฏ.
ุจุง ุงุณุชูุงุฏู ุงุฒ ูฺฺฏ **Result**ุ ูู ุฏููุงู ููู ฺฉุงุฑ ุฑุง ฺฉุฑุฏู: **thread ูุฑุงุฎูุงููุฏู** ุฑุง ูุณุฏูุฏ ฺฉุฑุฏู ุชุง **Task ูุฑุงุฎูุงูโุดุฏู** ุงุฌุฑุง ู ุชูุงู ุดูุฏ.
ุจูุงุจุฑุงู ุฏฺฏุฑ ูุงุฒ ุจู ูฺ ุณุงุฎุชุงุฑ **ูุณุฏูุฏฺฉููุฏู** ุงุถุงู ูุจูุฏ.

**ุงุฏุฏุงุดุช ููุณูุฏู:**
ูููููโูุง **Task** ููฺูู ูโุชูุงููุฏ ุงุฒ ูุชุฏ **Wait** ุจุฑุง ุงุชูุงู ุงุฌุฑุง **Task** ุงุณุชูุงุฏู ฺฉููุฏ. ุจูโุฒูุฏ ุจุญุซ ุฏุฑุจุงุฑู **ูฺฉุงูุฒูโูุง ูุฎุชูู ุงูุชุธุงุฑ (waiting mechanisms)** ุฎูุงูู ุฏุงุดุช.

---

### **ุฏุฑฺฉ ูุดฺฉู ุฏุฑ ููุงุด ฒ** โ๏ธ

ุชูุฌู ฺฉูุฏ ฺฉู ุฏุฑ ุฎุฑูุฌ ูุจูุ ุฎุท **"The main thread is completed."** ุฏุฑ ุงูุชูุง ุฎุฑูุฌ ุธุงูุฑ ุดุฏ.
ุงฺฏุฑ ุจุฑูุงูู ุฑุง ฺูุฏู ุจุงุฑ ุงุฌุฑุง ฺฉูุฏุ ููุดู ููู ูุชุฌู ุฑุง ูุดุงูุฏู ูโฺฉูุฏ. ุฏููุด ุงู ุงุณุช ฺฉู ุจุง ูุฑุงุฎูุงู ูฺฺฏ **Result**ุ ูู **main thread** ุฑุง ูุฌุจูุฑ ฺฉุฑุฏู ุชุง ููุชุธุฑ ุงุชูุงู **addTask** ุจูุงูุฏ.
ุฏุฑ ูุชุฌูุ ูุชูุงูุณุชู ุงุฒ **ูุฒุงุง ฺฉุงูู ุจุฑูุงููโููุณ ุบุฑููุฒูุงู (asynchronous programming)** ุงุณุชูุงุฏู ฺฉูู. ููู ูุดฺฉู ุฒูุงู ฺฉู ุงุฒ ูุชุฏ **Wait** ูู ุงุณุชูุงุฏู ฺฉูุฏ ุฑุฎ ูโุฏูุฏ.

---

### **ุฌูุณู ูพุฑุณุด ู ูพุงุณุฎ (Q\&A Session)** โ๐ฌ

**ุณูุงู 2.3**
ูุชูุฌู ุดุฏู ฺฉู ุจุง ุงุณุชูุงุฏู ุงุฒ ูุฑุงุฎูุงูโูุง ูุณุฏูุฏฺฉููุฏู ูุงููุฏ:

```csharp
var result = addTask.Result;
```

ุง

```csharp
addTask.Wait();
```

ุดูุง ุฏุฑ ูุงูุน ฺฉุฏ ุฑุง **ููุฒูุงู (synchronous)** ูโฺฉูุฏ. ูพุณ ฺุฑุง ุจุฑูุงููโุง ูุดุงู ุฏุงุฏุฏ ฺฉู ุงุฒ ุงู ูุฑุงุฎูุงูโูุง ูุณุฏูุฏฺฉููุฏู ุงุณุชูุงุฏู ูโฺฉูุฏุ

**ูพุงุณุฎ:**
ูโุฎูุงุณุชู ุดูุง ุงุฒ ูุฌูุฏ ฺูู ูุงุจูุช ุขฺฏุงู ุจุงุดุฏ. ุนูุงูู ุจุฑ ุงูุ ููุงูุน ูพุด ูโุขุฏ ฺฉู **ุชุง ุฒูุงู ฺฉู ูุชุฌู ฺฉ Task ุจู ุฏุณุช ูุงุฏุ ููโุชูุงูุฏ ุงุฏุงูู ุฏูุฏ**. ุฏุฑ ฺูู ุดุฑุงุท ููโุชูุงูุฏ ุงุฒ ูุฑุงุฎูุงูโูุง ูุณุฏูุฏฺฉููุฏู ุงุฌุชูุงุจ ฺฉูุฏ (ุฏุฑ **ููุงุด ณ** ุจู ุงู ููุถูุน ุงุดุงุฑู ุฎูุงูู ฺฉุฑุฏ).

ูพุณ ุงฺฏุฑ ุชุตูู ุจู ุงุณุชูุงุฏู ุงุฒ ุงู ุฑูุดโูุง ฺฏุฑูุชุฏุ ุณุน ฺฉูุฏ ุงุจุชุฏุง ุณุงุฑ ฺฉุฏูุง ฺฉู ูโุชูุงููุฏ **ุจูโุตูุฑุช ุบุฑููุฒูุงู ุงุฌุฑุง ุดููุฏ** ุฑุง ุงุฌุฑุง ฺฉูุฏุ ุณูพุณ ุงุฒ ุงู ูุฑุงุฎูุงูโูุง ุงุณุชูุงุฏู ููุงุฏ.
ุงูุง ูฺฏุฑุงู ูุจุงุดุฏ! ุจูโุฒูุฏ ุจุญุซ ุฏุฑุจุงุฑู **ูุฑุงุฎูุงูโูุง ุบุฑูุณุฏูุฏฺฉููุฏู (nonblocking calls)** ูุฒ ุฎูุงูู ุฏุงุดุช.

---

### **ุจุญุซ ุฏุฑุจุงุฑู ุงูุชุธุงุฑ (Waiting)** โณ

ุฑูุดโูุง ูุฎุชูู ุจุฑุง **ููุชุธุฑ ูุงูุฏู (waiting)** ุฏุฑ ุณุณุชู ูุฌูุฏ ุฏุงุฑุฏ. ุฏุฑ ุงู ุจุฎุดุ ูโุฎูุงูู ุถุฑูุฑุช **ุงูุชุธุงุฑ** ุฑุง ุจุฑุฑุณ ฺฉูู ู ฺูุฏ ุฑูุด ฺฉุงุฑุจุฑุฏ ุจุฑุง ูพุงุฏูโุณุงุฒ ุงู ุงุฏู ูุนุฑู ฺฉูู.

> **ูฺฉุชู:** ุจุฑุง ุจู ุฏุณุช ุขูุฑุฏู ูุชุฌู ุงุฌุฑุง ฺฉ Taskุ ุงฺฏุฑ **thread ูุฑุงุฎูุงููุฏู ุฑุง ูุณุฏูุฏ ฺฉูุฏ**ุ ุงุฒ ูุฒุงุง **ุจุฑูุงููโููุณ ุบุฑููุฒูุงู** ุงุณุชูุงุฏู ูฺฉุฑุฏูโุงุฏ. ุจูุงุจุฑุงู ููู ุงุณุช ฺฉู ุจุฑูุงูู ุฎูุฏ ุฑุง **ุจูโุฏุฑุณุช ุทุฑุงุญ ฺฉูุฏ**.

---

### **ฺุฑุง ููุชุธุฑ ูโูุงููุ** ๐ค

ููุช ฺฉ Task ุฑุง ุงุฌุฑุง ูโฺฉูุฏุ ููฺฉู ุงุณุช ุจุฎูุงูุฏ ูุชุฌู ุขู ุฑุง ุฏุฑุงูุช ฺฉูุฏ.
ุงู ุนู ุจุงุฏ ููุชุธุฑ ุจูุงูุฏ ุชุง Task ุงุฌุฑุง ุฎูุฏ ุฑุง ฺฉุงูู ฺฉูุฏ. ููุงุด ุฒุฑ ุงู ููุถูุน ุฑุง ุฑูุดูโุชุฑ ูโฺฉูุฏ:

---

### **ููุงุด ณ** ๐

ุฏุฑ ุจุฑูุงูู ุฒุฑุ **thread ูุฑุงุฎูุงููุฏู (main thread)** ุฏู **Task ูุชูุงูุช** ุฑุง ูุฑุงุฎูุงู ูโฺฉูุฏ.
ุจุงุฏ ุจุฑูุงูู ุฑุง ุงุฌุฑุง ฺฉูู ู ุจุฑุฎ ุงุฒ ุฎุฑูุฌโูุง ููฺฉู ุฑุง ุชุญูู ฺฉูู:

```csharp
using static System.Console;

WriteLine("The main thread starts.");

var printLuckyNumberTask = Task.Run(
    () =>
    {
    }
);

WriteLine("Wait for your lucky number...");
// Simulating a delay
Thread.Sleep(1);
WriteLine($"---Your lucky number is: {new Random().Next(1,10)}");

var processOrderTask = Task.Run(
    () =>
    {
    }
);

WriteLine("Processing an order...");
// Simulating a delay
Thread.Sleep(200);
WriteLine($"---Your order is processed.");

WriteLine("The end of main.");
```

---

### **ุฎุฑูุฌโูุง** ๐ฅ๏ธ

ุฏุฑ ุงุฏุงููุ ฺูุฏ ููููู ุฎุฑูุฌ ุงุฒ ุงุฌุฑุง ุงู ุจุฑูุงูู ุฑู ุณุณุชู ูู ุขูุฑุฏู ุดุฏู ุงุณุช:

**ุฎุฑูุฌ ฑ:**

```
The main thread starts.
The end of main.
```

**ุฎุฑูุฌ ฒ:**

```
The main thread starts.
The end of main.
Processing an order...
Wait for your lucky number...
```

---

### **ุชุญูู** ๐

ุงู ุฎุฑูุฌโูุง ูุดุงูโุฏููุฏู ูฺฺฏโูุง ุฒุฑ ูุณุชูุฏ:

* **thread ุงุตู (main thread)** ูุจู ุงุฒ ุงูฺฉู **printLuckyNumberTask** ู **processOrderTask** ุงุฌุฑุง ุฎูุฏ ุฑุง ุจู ูพุงุงู ุจุฑุณุงููุฏุ ุชูุงู ุดุฏู ุงุณุช.
* ูฺโฺฉ ุงุฒ ุฎุฑูุฌโูุง ูุดุงู ููโุฏููุฏ ฺฉู Taskูุง ูุฑุงุฎูุงูโุดุฏู ฺฉุงุฑุดุงู ุฑุง ฺฉุงูู ฺฉุฑุฏูโุงูุฏ ุง ูู.

---

### **ฺฺฏููู ููุชุธุฑ ุจูุงููุ** โฑ๏ธ

ูโุฏุงูุฏ ฺฉู ุจุฑุง ูุดุงูุฏู ูุถุนุช ููุง ุงู Taskูุงุ ุจุงุฏ ฺฉู ุจุดุชุฑ ุตุจุฑ ฺฉูุฏ.
ุงูุง **ฺฺฏููู ุจุงุฏ ููุชุธุฑ ุจูุงููุ** ุฑูุดโูุง ูุฎุชูู ูุฌูุฏ ุฏุงุฑุฏ ฺฉู ุฏุฑ ุงุฏุงูู ุจุง ุจุฑุฎ ุงุฒ ุขูโูุง ุขุดูุง ูโุดูู.

---

### **ุงุณุชูุงุฏู ุงุฒ Sleep** ๐ด

ุดุงุฏ ุณุงุฏูโุชุฑู ุฑุงู ุงู ุจุงุดุฏ ฺฉู **thread ุงุตู ุฑุง ูุณุฏูุฏ ฺฉูุฏ** ุชุง Taskูุง ุฏฺฏุฑ ุชูุงู ุดููุฏ.
ุฏุฑ ุงุฏุงูู ฺฉ ููููู ุขูุฑุฏู ุดุฏู ุงุณุช ฺฉู ุฏุฑ ุขู **thread ุงุตู ุฑุง ุจู ูุฏุช 1000 ููโุซุงูู ูุณุฏูุฏ ฺฉุฑุฏูโุงู**:

```csharp
// The previous code is the same
Thread.Sleep(1000);
WriteLine("The end of main.");
```

---

> **ูฺฉุชู:** ูโุชูุงูุฏ ูพุฑูฺู **Chapter2\_discussiononWaiting** ุฑุง ุงุฒ ูุจโุณุงุช **apress** ุฏุงูููุฏ ฺฉูุฏ ุชุง ููู ุจุฎุดโูุง ุจุฑูุงููโูุง ูุทุฑุญโุดุฏู ุฏุฑ ุงู ูุณูุช ุฑุง ุงุฌุฑุง ู ุจุฑุฑุณ ฺฉูุฏ.

---
ุงู ฺฉ ุฎุท ฺฉุฏ ุงุถุงู ุงุญุชูุงู ูุดุงูุฏู ุฎุฑูุฌโุง ุฑุง ุงูุฒุงุด ูโุฏูุฏ ฺฉู ูุดุงู ุฏูุฏ **ุงู ุฏู Task** ุงุฌุฑุง ุฎูุฏ ุฑุง ูุจู ุงุฒ ุงูฺฉู ฺฉูุชุฑู ุงุฒ **main thread** ุฎุงุฑุฌ ุดูุฏุ ุจู ูพุงุงู ุฑุณุงูุฏูโุงูุฏ. ฺฉ ุฎุฑูุฌ ููฺฉู ุจู ุตูุฑุช ุฒุฑ ุงุณุช:

```
The main thread starts.
Processing an order...
Wait for your lucky number...---Your lucky number is: 3---Your order is processed.
The end of main.
```

ูุฒุช ุงุณุชูุงุฏู ุงุฒ ุงู ุฑูุด ูุงุถุญ ุงุณุช. ูโุจูู ฺฉู ููุช **main thread** ุฏุฑ ุญุงูุช **sleep** ุงุณุชุ ุณุงุฑ **Task**ูุง ูโุชูุงููุฏ ฺฉุงุฑ ุฎูุฏ ุฑุง ุงูุฌุงู ุฏููุฏ. ุงู ูุดุงู ูโุฏูุฏ ฺฉู ุฏุฑ ุทูู **sleep**ุ **scheduler** ูโุชูุงูุฏ ุณุงุฑ Taskูุง ุฑุง ุฒูุงูโุจูุฏ ฺฉูุฏ.

ุงูุง ุฏุฑ ููุงุจูุ ุงู ุฑูุด ฺฉ ูุดฺฉู ุขุดฺฉุงุฑ ุฏุงุฑุฏ: ููฺฉู ุงุณุช **thread** ุฑุง ุจุฑุง ูุฏุช ุฒูุงู ุงุถุงู ู ุบุฑุถุฑูุฑ ูุณุฏูุฏ ฺฉูุฏ. ุจู ุนููุงู ูุซุงูุ ุฏุฑ ุณุณุชู ูู ุงฺฏุฑ **main thread** ุฑุง ุจุฑุง ตฐฐ ููโุซุงูู ุง ฺฉูุชุฑ ูุณุฏูุฏ ฺฉููุ ุฎุฑูุฌ ูุดุงุจู ูุดุงูุฏู ูโฺฉูู (ูโฺฏูู โูุดุงุจูโ ูู โููุงูโ ุฒุฑุง ุนุฏุฏ ุชุตุงุฏู ุชููุฏุดุฏู ููุดู ูุชูุงูุช ุงุณุช ฺฉู ุฑูุชุงุฑ ุทุจุน ุงู ุจุฑูุงูู ุงุณุช). ูุดฺฉู ุงู ุงุณุช ฺฉู ฺูู ููโุชูุงูู **ุฒูุงู ุฏูู ุชฺฉูู Taskูุง** ุฑุง ูพุดโุจู ฺฉููุ ุจุงุฏ ุขู ุฑุง ุจุฑุง **ุฒูุงู ููุงุณุจ ูุณุฏูุฏ ฺฉูู**. ุจูุงุจุฑุงู ุงฺฏุฑ ูุฑ ฺฉ ุงุฒ ุงู Taskูุง ุจู ุฏูู ุนูุงูู ุฏฺฏุฑ ุฒูุงู ุจุดุชุฑ ุจุฑุง ุงุชูุงู ูุงุฒ ุฏุงุดุชู ุจุงุดูุฏุ ููฺฉู ุงุณุช ูพุงู ุชฺฉูู Task ุฏุฑ ุฎุฑูุฌ ููุงุด ุฏุงุฏู ูุดูุฏ. ุงู ฺฉ ูุดฺฉู ูุงูุน ุงุณุช!

ูู ูโุฎูุงูู **ุงูุชุธุงุฑ ุบุฑุถุฑูุฑ** ุฏุงุดุชู ุจุงุดู ู ูู ูโุฎูุงูู **ูฺ ุงุทูุงุนุงุช ฺฉูุฏ** ุฑุง ุงุฒ ุฏุณุช ุจุฏูู. ุงุฒ ุงู ููุธุฑุ ุงู ุฑูุด **ุบุฑฺฉุงุฑุขูุฏ** ุงุณุช. ุฏุฑ ูุงูุนุ ูุถุนุช ูโุชูุงูุฏ ุจุฏุชุฑ ุดูุฏ ุงฺฏุฑ ุฑู ุจุฑูุงููโุง ฺฉุงุฑ ฺฉูุฏ ฺฉู ุณุน ุฏุฑ ูุณุฏูุฏ ฺฉุฑุฏู **UI** ุฏุงุฑุฏ. ุจู ููู ุฏููุ ุชฺฉู ุจุฑ ูุชุฏ **Sleep** ููุดู ุงุฏู ุฎูุจ ูุณุช.

---

### **ุงุณุชูุงุฏู ุงุฒ Delay** โฑ๏ธ

ุฏุฑ ฺฉุฏ ูุจูุ ุจุงุฏ ุฏุณุชูุฑ ุฒุฑ ุฑุง:

```csharp
Thread.Sleep(1000);
```

ุฏุฑ **main thread** ุจุง **Task.Delay(1000);** ุฌุงฺฏุฒู ฺฉูู:

```csharp
// The previous code is the same
Task.Delay(1000);
WriteLine("The end of main.");
```

ู ุจุฑูุงูู ุฑุง ุฏูุจุงุฑู ุงุฌุฑุง ฺฉูู. ุจุงุฒ ููุ ุณุณุชู ูู ุฎุฑูุฌโูุง ูุฎุชูู ูุดุงู ูโุฏูุฏุ ฺฉ ุงุฒ ุขูโูุง ุจู ุตูุฑุช ุฒุฑ ุงุณุช:

```
The main thread starts.
Processing an order...
The end of main.
Wait for your lucky number...
```

ุงู ุฎุฑูุฌ ูุดุงู ูโุฏูุฏ ฺฉู **thread ูุฑุงุฎูุงููุฏู** ุจุฑุง ุงุฌุฑุง **printLuckyNumberTask** ู **processOrderTask** ูุณุฏูุฏ ูุดุฏู ุงุณุช. ุจูุงุจุฑุงูุ ูโุจูุฏ ฺฉู ุฎุท **โThe end of main.โ** ูุจู ุงุฒ ูพุฑุฏุงุฒุด ุณูุงุฑุด ุง ููุงุด ุนุฏุฏ ุดุงูุณ ุธุงูุฑ ุดุฏู ุงุณุช.

ุงู ุจู ุดูุง ูฺฉุชูโุง ูโุฏูุฏ:

* ุจุฑุง **pauseูุง ููุฒูุงู (synchronous pauses)** ุงุฒ **Sleep** ุงุณุชูุงุฏู ฺฉูุฏ.
* ุจุฑุง **ุชุฃุฎุฑูุง ุบุฑูุณุฏูุฏฺฉููุฏู (nonblocking delays)** ุฑูุด **Delay** ุฑุง ุชุฑุฌุญ ุฏูุฏ.
  ุงุณุชูุงุฏู ุงุฒ **Delay** ุจู ุดูุง ฺฉูฺฉ ูโฺฉูุฏ **UI ูพุงุณุฎฺฏูุชุฑ** ุจุงุดุฏ.

ุฏุฑ ูุงูุนุ **Visual Studio IDE** ูุฒ ุจู ุดูุง ุงู ูฺฉุชู ุฑุง ฺฏูุดุฒุฏ ูโฺฉูุฏ. ุชูุถุญ ูโุฏูู:
ููุช ุจุดุชุฑ ุฏุฑุจุงุฑู **ุจุฑูุงููโููุณ ุบุฑููุฒูุงู (asynchronous programming)** ุงุฏ ุจฺฏุฑุฏุ ุฎูุงูุฏ ูููุฏ ฺฉู ุงุณุชูุงุฏู ุงุฒ ฺฉูุฏูุงฺูโูุง **async** ู **await** ฺฉุงุฑ ุฑุง ุณุงุฏู ูโฺฉูุฏ.
ุณูพุณ ูโุชูุงูุฏ ฺุฒ ุดุจู ุฒุฑ ุจููุณุฏ:

```csharp
await Task.Delay(1000);
```

ุงูุง ุงฺฏุฑ ุงุฒ **await** ุงุณุชูุงุฏู ูฺฉูุฏ ู ููุท ุจููุณุฏ:

```csharp
Task.Delay(1000);
```

ูพุงู ูุดุฏุงุฑ ุฒุฑ ุฑุง ูุดุงูุฏู ุฎูุงูุฏ ฺฉุฑุฏ:

```
CS4014 Because this call is not awaited, execution of the current 
method continues before the call is completed. Consider applying the โawaitโ operator to the result of the call.
```

<div align="center">

![Conventions-UsedThis-Book](../../../assets/image/02/Table%202-5.jpeg)
</div>

### **ุจุดุชุฑ ุฏุฑุจุงุฑู Sleep ู Delay** โฑ๏ธ

ููุช ุงุฒ ูุชุฏ **Delay** ุงุณุชูุงุฏู ูโฺฉูุฏุ ูโุชูุงูุฏ ุขู ุฑุง ุจู ฺฉ **Task** ุงุฎุชุตุงุต ุฏูุฏ ู ุฏุฑ ุฒูุงู ุจุนุฏ ุจุง **await** ููุชุธุฑ ุจูุงูุฏ:

```csharp
Task task = Task.Delay(1000);
// ุงูุฌุงู ฺฉุงุฑูุง ุฏฺฏุฑ ุฏุฑ ุงูุฌุง
await task;
```

ุนูุงูู ุจุฑ ุงูุ ูุชุฏ **Delay** ุฏุงุฑุง **Overloadูุง ูุฎุชูู** ุงุณุช ู ุจุณุงุฑ ุงุฒ ุขูโูุง ูพุงุฑุงูุชุฑ ุจู ูุงู **CancellationToken** ูโูพุฐุฑูุฏ (ุฏุฑ ูุตู ุจุนุฏ ุจู ุงู ููุถูุน ูพุฑุฏุงุฎุชู ูโุดูุฏ). ุจุง ุงุณุชูุงุฏู ุงุฒ ุงู ูพุงุฑุงูุชุฑุ ูโุชูุงูุฏ **ุงุฒ ูุทุน ูุงฺฏูุงู thread ุฌููฺฏุฑ ฺฉุฑุฏู ู ุขู ุฑุง ุจูโุตูุฑุช ูุฑุชุจ ุฎุงุชูู ุฏูุฏ**.

---

### **ุงุณุชูุงุฏู ุงุฒ ReadKey() ุง ReadLine()** โจ๏ธ

ฺฏุงู ุงููุงุช ูโุจูุฏ ฺฉู ุฏุฑ ุจุฑูุงูู ุงุฒ **ReadKey()ุ Read() ุง ReadLine()** ุงุณุชูุงุฏู ุดุฏู ุงุณุช.
ุงุฏู ุงุตู ุงู ุฑูุดโูุง **ูุณุฏูุฏ ฺฉุฑุฏู ฺฉูุชุฑู ุงุฌุฑุง ุจุฑูุงูู** ุชุง ุฒูุงู ุงุณุช ฺฉู ฺฉุงุฑุจุฑ ูุฑูุฏ ููุฑุฏูุธุฑ ุฑุง ุงุฑุงุฆู ุฏูุฏ.
ุจู ุนููุงู ูุซุงูุ ูโุชูุงูุฏ ุตุจุฑ ฺฉูุฏ ุชุง **printLuckyNumberTask** ู **processOrderTask** ุงุฌุฑุง ุฎูุฏ ุฑุง ฺฉุงูู ฺฉููุฏุ ุณูพุณ ุจุง ูุดุงุฑ ุฏุงุฏู ฺฉ ฺฉูุฏ ุงุฒ ฺฉุจูุฑุฏุ ุฎุฑูุฌ ููุง ุฑุง ุฏุฑุงูุช ฺฉูุฏ.

ููููู ฺฉุฏ:

```csharp
// The previous code is the same
ReadKey();
WriteLine("The end of main");
```

---

### **ุงุณุชูุงุฏู ุงุฒ Wait** โณ

**ููุงุด ฒ** ูุดุงู ุฏุงุฏ ฺฉู ุจุง ุงุณุชูุงุฏู ุงุฒ ูฺฺฏ **Result** ูโุชูุงูุฏ **thread ูุฑุงุฎูุงููุฏู** ุฑุง ุชุง ุชฺฉูู Task ูุณุฏูุฏ ฺฉูุฏ.
ุจุง ุงู ุญุงูุ ุฏุฑ ููู ุณูุงุฑููุง ูุงุฒ ูุณุช ฺฉู **ูุชุฌู ุงุฌุฑุง Task** ุฑุง ุชุญูู ฺฉูุฏ.
ุฏุฑ ูุงูุนุ ููฺฉู ุงุณุช ฺฉ Task **ููุฏุงุฑ ุจุงุฒูฺฏุฑุฏุงูุฏ**.

ุจุงุฏ ฺฉ ุชฺฉูฺฉ ุฏฺฏุฑ ุจุฑุง ุงูุชุธุงุฑ ุฑุง ุจุฑุฑุณ ฺฉูู:

ุจุง ูุฑุงุฎูุงู ูุชุฏ **Wait** ุฑู ฺฉ ููููู Taskุ ูโุชูุงูุฏ ุชุง **ุชฺฉูู ุขู Task** ุตุจุฑ ฺฉูุฏ.
ูููููโุง ฺฉู ุฏุฑ ุขู **Wait** ุฑุง ุจู ุตูุฑุช ุฌุฏุงฺฏุงูู ุฑู **printLuckyNumberTask** ู **processOrderTask** ูุฑุงุฎูุงู ูโฺฉูู:

```csharp
// The previous code is the same
printLuckyNumberTask.Wait();
processOrderTask.Wait();
WriteLine("The end of main.");
```

ุงู ุชุบุฑ ุจุงุนุซ ูโุดูุฏ ฺฉู **ูุฑ ุฏู Task** ุงุฌุฑุง ุฎูุฏ ุฑุง ฺฉุงูู ฺฉููุฏ.

---

### **ุงุณุชูุงุฏู ุงุฒ WaitAll** โ

ุจู ุฌุง ุงูฺฉู ููุชุธุฑ ุชฺฉูู **Taskูุง ุฌุฏุงฺฏุงูู** ุจูุงูุฏุ ูโุชูุงูุฏ ููุชุธุฑ **ฺฏุฑูู ุงุฒ Taskูุง** ุดูุฏ.
ุฏุฑ ุงู ุญุงูุชุ ุงุฒ ูุชุฏ **WaitAll** ุงุณุชูุงุฏู ูโฺฉูุฏ ู **Taskูุง** ฺฉู ูโุฎูุงูุฏ ุจุฑุง ุขูโูุง ููุชุธุฑ ุจูุงูุฏ ุฑุง ุจู ุนููุงู ูพุงุฑุงูุชุฑ ูโุฏูุฏ:

```csharp
// The previous code is the same
Task.WaitAll(printLuckyNumberTask, processOrderTask);
WriteLine("The end of main.");
```

ุงู ุชุบุฑ ูุฒ ูโุชูุงูุฏ ุฎุฑูุฌโุง ุชููุฏ ฺฉูุฏ ฺฉู ูุดุงู ุฏูุฏ **ูุฑ ุฏู Task ุงุฌุฑุง ุฎูุฏ ุฑุง ฺฉุงูู ฺฉุฑุฏูโุงูุฏ**.

---

### **ุงุณุชูุงุฏู ุงุฒ WaitAny** ๐น

ูุฑุถ ฺฉูุฏ ฺูุฏู Task ุฏุงุฑุฏุ ุงูุง ูโุฎูุงูุฏ ููุชุธุฑ ุดูุฏ ุชุง **ูุฑฺฉุฏุงู ุงุฒ ุขูโูุง** ฺฉู ุฒูุฏุชุฑ ุชูุงู ุดุฏุ ุงุฏุงูู ุฏูุฏ.
ุฏุฑ ุงู ุญุงูุช ุงุฒ ูุชุฏ **WaitAny** ุงุณุชูุงุฏู ูโฺฉูุฏ:

```csharp
// The previous code is the same
Task.WaitAny(printLuckyNumberTask, processOrderTask);
WriteLine("The end of main.");
```

ููููู ุฎุฑูุฌ:

```
The main thread starts.
Wait for your lucky number...
Processing an order...---Your lucky number is: 2
The end of main.
```

ุงู ุฎุฑูุฌ ูุดุงู ูโุฏูุฏ ฺฉู ุงู ุจุงุฑ **main thread** ููุชุธุฑ ุชฺฉูู **processOrderTask** ููุงูุฏู ุงุณุช.
<div align="center">

![Conventions-UsedThis-Book](../../../assets/image/02/Table%202-6.jpeg)
</div>

### **ูฺฉุงุช ููู** ๐

ุงู ูุชุฏูุง ุฏุงุฑุง **Overloadูุง ูุฎุชูู** ูุณุชูุฏ.
ุจู ุนููุงู ูุซุงูุ ุฏุฑ ุฒูุงู ูฺฏุงุฑุด ุงู ูุชูุ ูุชุฏ **Wait** ุฏุงุฑุง ุดุด **Overload** ูุชูุงูุช ุงุณุช.
ุจุง ุงุณุชูุงุฏู ุงุฒ ุงู ูุณุฎูโูุง **Overloaded** ูโุชูุงูุฏ **ุญุฏุงฺฉุซุฑ ุฒูุงู ุงูุชุธุงุฑ**ุ ฺฉ ููููู **CancellationToken** ุง ูุฑ ุฏู ุฑุง ูุดุฎุต ฺฉูุฏ ุชุง ุฏุฑ ุญู ุงูุชุธุงุฑ ุขูโูุง ุฑุง ูพุงุด ฺฉูุฏ.

---

### **ุงุณุชูุงุฏู ุงุฒ WhenAny** ๐น

ุจู ุฎุฑูุฌ ูุจู ุฏูุจุงุฑู ูฺฏุงู ฺฉูุฏ. ูโุจูุฏ ฺฉู ุฎุท **โThe end of main.โ** ุจุนุฏ ุงุฒ ุชฺฉูู ุญุฏุงูู ฺฉ ุงุฒ Taskูุง ุธุงูุฑ ุดุฏู ุงุณุช.
ุงฺฏุฑ ุจุฑูุงูู ุฑุง ฺูุฏู ุจุงุฑ ุงุฌุฑุง ฺฉูุฏุ ูฺฺฏุงู ุงู ุฎุท **ูุจู ุงุฒ ุงุชูุงู ุญุฏุงูู ฺฉ ุงุฒ Taskูุง** ุธุงูุฑ ููโุดูุฏ.
ุนูุช ุงู ุงุณุช ฺฉู ุฏุฑ ุญุงูุช **WaitAny**ุ **thread ูุฑุงุฎูุงููุฏู** ุชุง ุชฺฉูู ูุฑฺฉุฏุงู ุงุฒ Taskูุง **ูุณุฏูุฏ ูโุดูุฏ**.

ุฌุงูุจ ุงุณุช ุจุฏุงูุฏ ฺฉู ูุชุฏ ุฏฺฏุฑ ุจู ูุงู **WhenAny** ูุฌูุฏ ุฏุงุฑุฏ ฺฉู **thread ูุฑุงุฎูุงููุฏู ุฑุง ูุณุฏูุฏ ููโฺฉูุฏ**.

ููููู ฺฉุฏ ุฌุงฺฏุฒู **WaitAny ุจุง WhenAny**:

```csharp
// The previous code is the same
Task.WhenAny(printLuckyNumberTask, processOrderTask);
WriteLine("The end of main.");
```

ููููู ุฎุฑูุฌ ูพุณ ุงุฒ ุงู ุชุบุฑ:

```
The main thread starts.
The end of main.
Processing an order...
Wait for your lucky number...
```

ููุงูโุทูุฑ ฺฉู ูุดุงูุฏู ูโฺฉูุฏุ ุฏุฑ ุงู ุญุงูุช **main thread ูุณุฏูุฏ ูุดุฏู ุงุณุช**.

---

### **ุงูุชุธุงุฑ ุจุฑุง ูุบู (Waiting For Cancellation)** โ๏ธ

ฺฏุงู ุงููุงุช ูุงุฒู ุงุณุช ุจุฑุง **ูุบู ุงุญุชูุงู Taskูุง** ุขูุงุฏู ุจุงุดุฏ.
ุฏุฑ ฺูู ุดุฑุงุท ูุงุฒ ุจู **CancellationToken** ุฏุงุฑุฏ.
ุจุง ุชูุฌู ุจู ุงููุช ู ฺฏุณุชุฑุฏฺฏ ุงู ููุถูุนุ ุฏุฑ ูุตู ุฌุฏุงฺฏุงููโุง (ูุตู ต) ุจู ุขู ูพุฑุฏุงุฎุชู ุดุฏู ุงุณุช.

---

### **ุฌูุณู ูพุฑุณุด ู ูพุงุณุฎ (Q\&A Session)** โ๐ฌ

**ุณูุงู 2.4**
ุฏุฑ ุจุนุถ ุจูุงฺฏโูุง ุง ููุงูุงุชุ ูโุจูู ุจู ุฌุง **Thread.Sleep** ุงุฒ **Thread.SpinWait** ุงุณุชูุงุฏู ูโฺฉููุฏ. ุชูุงูุช ุงู ุฏู ฺุณุชุ

**ูพุงุณุฎ:**
ูุชุฏ **SpinWait** ุจุฑุง ูพุงุฏูโุณุงุฒ **Locks** ููุฏ ุงุณุช ุงูุง ุจุฑุง ุจุฑูุงููโูุง ูุนููู ฺฉุงุฑุจุฑุฏ ูุฏุงุฑุฏ.
ููุช ุงุฒ **SpinWait** ุงุณุชูุงุฏู ูโฺฉูุฏุ **scheduler** ฺฉูุชุฑู ุฑุง ุจู Taskูุง ุฏฺฏุฑ ููุชูู ููโฺฉูุฏุ ุนู **ุงุฒ ุชุบุฑ context ุฌููฺฏุฑ ูโุดูุฏ**.

ููฺฉ ุฑุณู: [SpinWait](https://learn.microsoft.com/en-us/dotnet/api/system.threading.thread.spinwait?view=net-9.0)

> ุฏุฑ ููุงุฑุฏ ูุงุฏุฑ ฺฉู ุฌููฺฏุฑ ุงุฒ **context switch** ููุฏ ุงุณุชุ ูุซูุงู ููุช ุชุบุฑ ูุถุนุช ูุฑุจโุงููููุน ุงุณุชุ ุฏุฑ ุญููู ุฎูุฏ ุงุฒ **SpinWait** ุงุณุชูุงุฏู ฺฉูุฏ.
> ฺฉุฏ **SpinWait** ุจุฑุง ุฌููฺฏุฑ ุงุฒ ูุดฺฉูุงุช ฺฉู ุฏุฑ ฺฉุงููพูุชุฑูุง ฺูุฏูพุฑุฏุงุฒูุฏู ุฑุฎ ูโุฏูุฏ ุทุฑุงุญ ุดุฏู ุงุณุช.
> ุจู ุนููุงู ูุซุงูุ ุฏุฑ ฺฉุงููพูุชุฑูุง ุจุง ฺูุฏ ูพุฑุฏุงุฒูุฏู **Intel** ฺฉู ุงุฒ ุชฺฉููููฺ **Hyper-Threading** ุงุณุชูุงุฏู ูโฺฉููุฏุ **SpinWait** ุงุฒ **starvation ูพุฑุฏุงุฒูุฏู** ุฏุฑ ุดุฑุงุท ุฎุงุต ุฌููฺฏุฑ ูโฺฉูุฏ.

---

> **ูฺฉุชู:** ฺฉูุงุณโูุง .NET Framework ูุงููุฏ **Monitor** ุง **ReaderWriterLock** ุจู ุตูุฑุช ุฏุงุฎู ุงุฒ **SpinWait** ุงุณุชูุงุฏู ูโฺฉููุฏ.
> ุจุง ุงู ุญุงูุ ุจู ุฌุง ุงุณุชูุงุฏู ูุณุชูู ุงุฒ ุงู ูุชุฏุ **Microsoft ุชูุตู ูโฺฉูุฏ ุงุฒ ฺฉูุงุณโูุง ููฺฏุงูโุณุงุฒ ุฏุงุฎู** ุงุณุชูุงุฏู ฺฉูุฏ.
> ููฺูู ุชูุตู ูโฺฉูู ุงุฒ ุงู ุฑูุด ุงุณุชูุงุฏู ูฺฉูุฏุ ุฒุฑุง **SpinWait** ฺฉ ุนุฏุฏ ุตุญุญ ุจู ุนููุงู ูพุงุฑุงูุชุฑ ูโูพุฐุฑุฏ ฺฉู ุชุนุฏุงุฏ ุชฺฉุฑุงุฑ ุญููู CPU ุฑุง ูุดุฎุต ูโฺฉูุฏ. ุฏุฑ ูุชุฌูุ **ุฒูุงู ุงูุชุธุงุฑ ุจู ุณุฑุนุช ูพุฑุฏุงุฒูุฏู ูุงุจุณุชู ุงุณุช**.

---

ูโุชูุงูุฏ ุงุฒ ูุชุฏ **SpinUntil** ูุฒ ุงุณุชูุงุฏู ฺฉูุฏ. ุฏุฑ ุฒูุงู ูฺฏุงุฑุด ุงู ูุชูุ ุงู ูุชุฏ ุณู **Overload** ุฏุงุฑุฏ:

* `SpinUntil(Func<Boolean>)`
* `SpinUntil(Func<Boolean>, Int32)`
* `SpinUntil(Func<Boolean>, TimeSpan)`

ูููููโุง ุงุฒ ุณุงุฏูโุชุฑู ูุณุฎู ฺฉู ุชุง ุจุฑุขูุฑุฏู ุดุฏู ฺฉ ุดุฑุท ุฎุงุต **ฺุฑุฎุด ูโฺฉูุฏ**:

```csharp
// Previous code is the same. You can see it by downloading
// the Chapter2_DiscussionOnWaiting project
SpinWait.SpinUntil(() =>
    printLuckyNumberTask.Status == TaskStatus.RanToCompletion
);
WriteLine("The end of main.");
```

ููููู ุฎุฑูุฌ ูพุณ ุงุฒ ุงู ุชุบุฑ:

```
The main thread starts.
Processing an order...
Wait for your lucky number...---Your lucky number is: 8
The end of main.
```

ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ุงู ุจุงุฑ ุฎุฑูุฌ ูุดุงู ูโุฏูุฏ **printLuckyNumberTask ุงุฌุฑุง ุฎูุฏ ุฑุง ฺฉุงูู ฺฉุฑุฏู ุงุณุช**ุ ุงูุง ูุดุฎุต ููโฺฉูุฏ ฺฉู **processOrderTask** ุงุฌุฑุง ุดุฏู ุง ุฎุฑุ ุฒุฑุง ูุง ููุท ูุถุนุช **printLuckyNumberTask** ุฑุง ุจุฑุฑุณ ฺฉุฑุฏู.
<div align="center">

![Conventions-UsedThis-Book](../../../assets/image/02/Table%202-7.jpeg)
</div>

### **ูฺฉุชู ููู** ๐

ูุชุฌู ฺฉูุฏ ุงู ุงุณุช ฺฉู **ุฑูุดโูุง ูุฎุชูู ุจุฑุง ุงูุชุธุงุฑ ูุฌูุฏ ุฏุงุฑุฏ**.
ูโุชูุงูุฏ ุงุฒ ุฑูุด ุงุณุชูุงุฏู ฺฉูุฏ ฺฉู ุจุฑุง ุดูุง **ููุงุณุจโุชุฑ ู ุฑุงุญุชโุชุฑ** ุงุณุช.
ูู ุชููุง ุขู ุฏุณุชู ุงุฒ ูุชุฏูุง ุฑุง ุฐฺฉุฑ ฺฉุฑุฏูโุงู ฺฉู **ฺฉุงู ุจุงุดุฏ ุจุฑุง ุฏุฑฺฉ ุจูู ูุทุงูุจ ุงู ฺฉุชุงุจ**.
ุจู ุงุฏ ุฏุงุดุชู ุจุงุดุฏ ฺฉู ุงู ูุชุฏูุง ูุฒ ุฏุงุฑุง **ูุณุฎูโูุง Overloaded ูุฎุชูู** ูุณุชูุฏ.

---

**ุณูุงู 2.5**
ูุซุงู ุจุฒูุฏ ฺฉู ุจุฎูุงูุฏ ุงุฒ **WhenAny** ุง **WaitAny** ุงุณุชูุงุฏู ฺฉูุฏ. ุจู ุงู ุฏู ฺฉุฏุงู ุฑุง ุชุฑุฌุญ ูโุฏูุฏุ

ูุฑุถ ฺฉูุฏ ุจุง ุฏู **Task ูุชูุงูุช** ฺฉุงุฑ ูโฺฉูุฏ ู ูุฑ Task ุจุง ฺฉ **URL ูุชูุงูุช** ฺฉุงุฑ ูโฺฉูุฏ.
ูุฑุถ ฺฉูุฏ ูุฑ URL ูโุชูุงูุฏ ุจู ุดูุง ฺฉูฺฉ ฺฉูุฏ **ุณูุงูุช ูุนู ฺฉ ูุจโุณุงุช** ุฑุง ุจุฑุฑุณ ฺฉูุฏ.
ูโุฏุงูุฏ ฺฉู ูุฑ ฺฉ ุงุฒ ุงู ููฺฉโูุง ุจุฑุง **ุจุฑุฑุณ ูุถุนุช ูุจโุณุงุช ฺฉุงู ุงุณุช**.
ุจูุงุจุฑุงู ุจุฑูุงูู ุดูุง ูโุชูุงูุฏ **Taskูุง ุฑุง ุงุฌุฑุง ฺฉูุฏ ู ุจู ูุญุถ ุฏุฑุงูุช ุฏุงุฏูโูุง ุงุฏุงูู ุฏูุฏ**.
ุฏุฑ ฺูู ุญุงูุช ูโุชูุงูุฏ ุงุฒ **WhenAny** ุง **WaitAny** ุงุณุชูุงุฏู ฺฉูุฏ.

ูฺฏุฑ ุงูฺฉู ุฏูุงู ฺฉุงู ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏุ ูู ุฏุฑ ฺูู ุดุฑุงุท **WhenAny** ุฑุง ุชุฑุฌุญ ูโุฏููุ ุจู ุฏูุงู ุฒุฑ:

* ุงู ุฑูุด **ุบุฑูุณุฏูุฏฺฉููุฏู (nonblocking)** ุงุณุช.
* ููุฑุฏ ูุจู ุจุฑุง ุฌููฺฏุฑ ุงุฒ **Deadlock** ูุฒ ููู ุงุณุช.
  ุจุฑุง ูุซุงูุ ูุฑุถ ฺฉูุฏ ุจุง ฺูุฏู Task ุณุฑ ู ฺฉุงุฑ ุฏุงุฑุฏ.
  ุงฺฏุฑ **main thread** ููุชุธุฑ ุฏุฑุงูุช ุงุนูุงู ุงุฒ ฺฉ Task ุฏฺฏุฑ ุจุงุดุฏุ ูุซูุงู **taskA** ุง **taskB**ุ ู ูุฑ ุฏู Task ุจู ุฏูุงู ุบุฑูุงุจู ูพุดโุจู ุงุฒ ุงุฌุฑุง ุจุงุฒ ุงุณุชูุฏุ **main thread** ูุฒ ูุณุฏูุฏ ูโุดูุฏ.
  ุฏุฑ ูุงูุนุ ุงุณุชูุงุฏู ุงุฒ **WaitAny** ูโุชูุงูุฏ ููุฌุฑ ุจู **Deadlock** ุดูุฏ.

---

### **ุฎูุงุตู ูุตู** ๐

ุงู ูุตู ฺฉ ูุฑูุฑ ุณุฑุน ุงุฒ **ุงุฌุงุฏ ู ุงุฌุฑุง Taskูุง** ุงุฑุงุฆู ุฏุงุฏ.
ููฺูู **ูฺฉุงูุฒูโูุง ูุฎุชูู ุงูุชุธุงุฑ ุจุฑุง ุชฺฉูู Taskูุง** ุฑุง ุดุฑุญ ุฏุงุฏ.

ุจู ุทูุฑ ุฎูุงุตูุ ุงู ูุตู ุจู ุณูุงูุงุช ุฒุฑ ูพุงุณุฎ ุฏุงุฏ:

* Task ฺุณุช ู ฺฺฏููู ูโุชูุงู ฺฉ Task ุงุฌุงุฏ ฺฉุฑุฏุ
* ฺฺฏููู ูโุชูุงู **ููุฏุงุฑ/ููุงุฏุฑ** ุฑุง ุจู Task ููุชูู ฺฉุฑุฏุ
* ฺฺฏููู ูโุชูุงู **ููุฏุงุฑ ุฑุง ุงุฒ Task ุจุงุฒฺฏุฑุฏุงูุฏ**ุ
* ฺฺฏููู ูโุชูุงู **ูฺฉุงูุฒู ุงูุชุธุงุฑ** ุฑุง ุฏุฑ ุจุฑูุงููโููุณ Task ุจู ฺฉุงุฑ ุจุฑุฏุ โ

### **ุชูุฑูโูุง** ๐๏ธโโ๏ธ

ุจุฑุง ุจุฑุฑุณ ุฏุฑฺฉ ุฎูุฏุ ุณุน ฺฉูุฏ ุชูุฑูโูุง ุฒุฑ ุฑุง ุงูุฌุงู ุฏูุฏ:
<div align="center">

![Conventions-UsedThis-Book](../../../assets/image/02/Table%202-8.jpeg)
</div>

### **ูฺฉุชู ููู** ๐

ููุงูโุทูุฑ ฺฉู ูุจูุงู ฺฏูุชู ุดุฏุ ุจุฑุง ููู ูุซุงูโูุง ฺฉุฏุ **โImplicit Global usingsโ** ุฏุฑ Visual Studio ูุนุงู ุจูุฏ.
ุจู ููู ุฏููุ ุดูุง ูุงู **namespace**ูุง ุฒุฑ ุฑุง ฺฉู ุจู ุตูุฑุช ูพุดโูุฑุถ ุฏุฑ ุฏุณุชุฑุณ ูุณุชูุฏุ ููโุจูุฏ:

* System
* System.Collections.Generic
* System.IO
* System.Linq
* System.Net.Http
* System.Threading
* System.Threading.Tasks

ุงู ุชูุถุญ ุจุฑุง **ุชูุงู ุชูุฑูโูุง ฺฉุชุงุจ** ูุฒ ุตุงุฏู ุงุณุช.

---

### **ุชูุฑูโูุง** ๐๏ธโโ๏ธ

**E2.1**
ุงฺฏุฑ ฺฉุฏ ุฒุฑ ุฑุง ุงุฌุฑุง ฺฉูุฏุ ูโุชูุงูุฏ **ุฎุฑูุฌ ุขู ุฑุง ูพุดโุจู ฺฉูุฏุ**

```csharp
using static System.Console;

Task printHelloTask = new(
    () => WriteLine("Hello!")
);

printHelloTask.Wait(1);
WriteLine("End.");
```

**E2.2**
ุฎุฑูุฌ ุจุฑูุงูู ุฒุฑ ุฑุง ูโุชูุงูุฏ ูพุดโุจู ฺฉูุฏุ

```csharp
using static System.Console;

Task welcomeTask = Task.Run(
    () =>
    {
    }
);

Thread.Sleep(5);
WriteLine("Welcome!");
Thread.Sleep(2);
WriteLine("How are you doing?");
```

**E2.3**
ุฎุฑูุฌ ุจุฑูุงูู ุฒุฑ ุฑุง ูโุชูุงูุฏ ูพุดโุจู ฺฉูุฏุ

```csharp
using static System.Console;

var sayHello = (string msg = "Hello, reader!") => msg;
var displayMsgTask = Task.Run(()=>WriteLine(sayHello()));
displayMsgTask.Wait();
WriteLine("Goodbye.");
```

**E2.4**
ฺฉ ุชุงุจุน ุจููุณุฏ ฺฉู ฺฉ ุนุฏุฏ ุฑุง ฺฏุฑูุชู ู **ูุงฺฉุชูุฑู ุขู ุฑุง ูุญุงุณุจู ฺฉูุฏ**.
ุงู ุชุงุจุน ุฑุง ุฏุฑ ฺฉ **thread ูพุณโุฒููู** ุงุฌุฑุง ฺฉุฑุฏู ู ูุชุฌู ุฑุง ุฏุฑ **ฺฉูุณูู** ููุงุด ุฏูุฏ.
(ูุงุฒ ุจู ุฏุฑ ูุธุฑ ฺฏุฑูุชู ุงุนุชุจุงุฑุณูุฌ ูุฑูุฏ ุง ุดุฑุงุท ุงุณุชุซูุง ุจุฑุง ุงู ุจุฑูุงูู ูุณุช.)

**E2.5**
ุตุญุญ ุง ุบูุท ุจูุฏู ุฌููุงุช ุฒุฑ ุฑุง ูุดุฎุต ฺฉูุฏ:
i) ูุชุฏ **WaitAny** **thread ูุฑุงุฎูุงููุฏู ุฑุง ูุณุฏูุฏ ูโฺฉูุฏ**ุ ุงูุง ูุชุฏ **WhenAny** ุงู ฺฉุงุฑ ุฑุง ููโฺฉูุฏ. \[True]
ii) ุจุฑุง ุงุฌุงุฏ **UI ูพุงุณุฎฺฏูุชุฑ**ุ ุจุงุฏ **Sleep** ุฑุง ุจุฑ **Delay** ุชุฑุฌุญ ุฏูุฏ. \[False]

---

### **ุฑุงูโุญู ุชูุฑูโูุง** โ

**E2.1**
ุดูุง Task ุฑุง ุงุฌุงุฏ ฺฉุฑุฏูโุงุฏ ุงูุง ุขู ุฑุง **ุดุฑูุน ูฺฉุฑุฏูโุงุฏ**ุ ุจูุงุจุฑุงู ุฎุฑูุฌ ุจุฑูุงูู:

```
End.
```

---

**E2.2**
ุจุฑูุงูู ูโุชูุงูุฏ **ฺูุฏู ุฎุฑูุฌ ูุฎุชูู** ุฏุงุดุชู ุจุงุดุฏ.
ุจุง ุชูุฌู ุจู ุงูฺฉู Task ููุชุธุฑ ุชฺฉูู ุงุฌุฑุง ุฎูุฏ ูุณุชุ ุชุฑุชุจ ููุงุด ุฎุฑูุฌโูุง ููฺฉู ุงุณุช ุจุณุชู ุจู ุณุฑุนุช ฺฉุงููพูุชุฑ ูุชูุงูุช ุจุงุดุฏ.
ููููู ุฎุฑูุฌ:

```
How are you doing?
Welcome!
```

ูโุชูุงู ุจุง ุงุถุงูู ฺฉุฑุฏู ุชุฃุฎุฑ ุจุดุชุฑ ุฏุฑ **welcomeTask** ุงุญุชูุงู ูพุงุงู ุฒูุฏุชุฑ main thread ุฑุง ุงูุฒุงุด ุฏุงุฏ:

```csharp
using static System.Console;

Task welcomeTask = Task.Run(
    () =>
    {
    }
);

//Thread.Sleep(5);
Thread.Sleep(200);

WriteLine("Welcome!");
Thread.Sleep(2);
WriteLine("How are you doing?");
```

---

**E2.3**
C# 12 ุงุฌุงุฒู ูโุฏูุฏ ููุงุฏุฑ ูพุดโูุฑุถ ุจุฑุง **ูพุงุฑุงูุชุฑูุง lambda** ุชุนุฑู ุดูุฏ.
ุฎุฑูุฌ ุงู ุจุงุฑ ูพุดโุจูโูพุฐุฑ ุงุณุชุ ุฒุฑุง **main thread** ููุชุธุฑ ุชฺฉูู Task ุงุณุช:

```
Hello, reader!
Goodbye.
```

---

**E2.4**
ูููููโุง ุจุฑุง ูุญุงุณุจู ูุงฺฉุชูุฑู ฑฐ ุจุง ุงุณุชูุงุฏู ุงุฒ Task ูพุณโุฒููู:

```csharp
using static System.Console;

WriteLine("The main thread initiates the task.");
var calculateFactorialTask = Task.Run(() => CalculateFactorial(10));

WriteLine("The main thread resumes to do other things.");
WriteLine($"The factorial of 10 is: {calculateFactorialTask.Result}");

static int CalculateFactorial(int number)
{
    int temp = 1;
    for (int i = 2; i <= number; i++)
    {
        temp *= i;
    }
    return temp;
}
```

ููููู ุฎุฑูุฌ:

```
The main thread initiates the task.
The main thread resumes to do other things.
The factorial of 10 is: 3628800
```

---

**E2.5**
ูพุงุณุฎโูุง:

i) **True**
ii) **False**
