---
layout: layout.njk
title: ูุฌููุนูโูุง (Collections)
---
# ูุตู ููุชู: **ูุฌููุนูโูุง (Collections) ๐**

.NET ฺฉ ูุฌููุนู ุงุณุชุงูุฏุงุฑุฏ ุงุฒ ููุนโูุง ุฑุง ุจุฑุง ุฐุฎุฑูโุณุงุฒ ู ูุฏุฑุช ูุฌููุนูโุง ุงุฒ ุงุดุงุก ุงุฑุงุฆู ูโุฏูุฏ. ุงู ููุนโูุง ุดุงูู ูุณุชโูุง ูุงุจู ุชุบุฑ ุงูุฏุงุฒู (resizable lists)ุ ูุณุชโูุง ูพููุฏ (linked lists)ุ ุฏฺฉุดูุฑโูุง ูุฑุชุจ ู ูุงูุฑุชุจ (sorted ู unsorted dictionaries) ู ููฺูู ุขุฑุงูโูุง (arrays) ูุณุชูุฏ. ุงุฒ ุจู ุงูโูุงุ ุชููุง ุขุฑุงูโูุง ุจุฎุด ุงุฒ ุฒุจุงู C# ุฑุง ุชุดฺฉู ูโุฏููุฏุ ุจูู ูุฌููุนูโูุง ููุท ฺฉูุงุณโูุง ูุณุชูุฏ ฺฉู ูโุชูุงูุฏ ูุงููุฏ ูุฑ ฺฉูุงุณ ุฏฺฏุฑ ูููููโุณุงุฒ (instantiate) ฺฉูุฏ.

ูโุชูุงูู ููุนโูุง ุฏุฑ BCL ุฏุงุชโูุช ุจุฑุง ูุฌููุนูโูุง ุฑุง ุจู ุฏุณุชูโูุง ุฒุฑ ุชูุณู ฺฉูู:

โข ุงูุชุฑูุณโูุง ฺฉู ูพุฑูุชฺฉูโูุง ุงุณุชุงูุฏุงุฑุฏ ูุฌููุนู ุฑุง ุชุนุฑู ูโฺฉููุฏ

โข ฺฉูุงุณโูุง ุขูุงุฏู ุจุฑุง ุงุณุชูุงุฏู ุฏุฑ ูุฌููุนูโูุง (ูุณุชโูุงุ ุฏฺฉุดูุฑโูุง ู ุบุฑู)

โข ฺฉูุงุณโูุง ูพุงู ุจุฑุง ููุดุชู ูุฌููุนูโูุง ูุฎุตูุต ุจุฑูุงูู

ุงู ูุตู ูุฑ ฺฉ ุงุฒ ุงู ุฏุณุชูโูุง ุฑุง ูพูุดุด ูโุฏูุฏุ ุจูโุนูุงูู ฺฉ ุจุฎุด ุงุถุงู ุฏุฑุจุงุฑู ููุนโูุง ฺฉู ุจุฑุง ุชุนู ุจุฑุงุจุฑ ู ุชุฑุชุจ ุนูุงุตุฑ ุงุณุชูุงุฏู ูโุดููุฏุ ุงุฑุงุฆู ูโฺฉูุฏ.

ูุถุงูุง ูุงู (namespaces) ูุฑุจูุท ุจู ูุฌููุนูโูุง ุจู ุดุฑุญ ุฒุฑ ูุณุชูุฏ:

<div align="center">

![Conventions-UsedThis-Book](../../../assets/image/07/Table-7-1.jpeg)
</div>

**ุดูุงุฑูโฺฏุฐุงุฑ (Enumeration) ๐ข**

ุฏุฑ ุนููู ฺฉุงููพูุชุฑุ ูุฌููุนูโูุง ูุฎุชูู ูุฌูุฏ ุฏุงุฑูุฏ ฺฉู ุงุฒ ุณุงุฎุชุงุฑูุง ุฏุงุฏู ุณุงุฏู ูุงููุฏ ุขุฑุงูโูุง (arrays) ุง ูุณุชโูุง ูพููุฏ (linked lists)ุ ุชุง ุณุงุฎุชุงุฑูุง ูพฺุฏูโุชุฑ ูุงููุฏ ุฏุฑุฎุชโูุง ูุฑูุฒ/ุณุงู (red/black trees) ู ูุดุชโุฌุฏููโูุง (hashtables) ุฑุง ุดุงูู ูโุดููุฏ.

ุงฺฏุฑฺู ูพุงุฏูโุณุงุฒ ุฏุงุฎู ู ูฺฺฏโูุง ุฎุงุฑุฌ ุงู ุณุงุฎุชุงุฑูุง ุฏุงุฏู ุจุณุงุฑ ูุชูุงูุช ุงุณุชุ ุงูุง ุชูุงูุง ูพูุงุด (traverse) ูุญุชูุงุช ูุฌููุนูุ ูุงุฒ ุชูุฑุจุงู ุฌูุงู ุงุณุช. BCL ุฏุงุชโูุช ุงู ูุงุฒ ุฑุง ุงุฒ ุทุฑู ฺฉ ุฌูุช ุงูุชุฑูุณ (IEnumerable ู IEnumerator ู ูุณุฎูโูุง Generic ุขูโูุง) ูพุดุชุจุงู ูโฺฉูุฏ ฺฉู ุจู ุณุงุฎุชุงุฑูุง ุฏุงุฏู ูุฎุชูู ุงุฌุงุฒู ูโุฏูุฏ ฺฉ API ูุดุชุฑฺฉ ุจุฑุง ูพูุงุด ุงุฑุงุฆู ุฏููุฏ.

ุงู ุงูุชุฑูุณโูุง ุจุฎุด ุงุฒ ูุฌููุนู ุจุฒุฑฺฏโุชุฑ ุงุฒ ุงูุชุฑูุณโูุง ูุฌููุนู ูุณุชูุฏ ฺฉู ุฏุฑ ุดฺฉู ท-ฑ ูุดุงู ุฏุงุฏู ุดุฏูโุงูุฏ.

<div align="center">

![Conventions-UsedThis-Book](../../../assets/image/07/Table-7-2.jpeg)
</div>

**IEnumerable ู IEnumerator ๐**

ุงูุชุฑูุณ `IEnumerator` ูพุฑูุชฺฉู ูพุงู ู ุณุทุญ ูพุงู ุฑุง ุชุนุฑู ูโฺฉูุฏ ฺฉู ุจุง ุขู ุนูุงุตุฑ ฺฉ ูุฌููุนู ุจูโุตูุฑุช ูพุดโุฑููุฏู (forward-only) ูพูุงุด ุง ุดูุงุฑูโฺฏุฐุงุฑ (enumerate) ูโุดููุฏ. ุชุนุฑู ุขู ุจู ุตูุฑุช ุฒุฑ ุงุณุช:

```csharp
public interface IEnumerator
{
  bool MoveNext();
  object Current { get; }
  void Reset();
}
```

ูุชุฏ `MoveNext` ุนูุตุฑ ูุนู ุง ยซฺฉุฑุณุฑยป (cursor) ุฑุง ุจู ูููุนุช ุจุนุฏ ููุชูู ูโฺฉูุฏ ู ุงฺฏุฑ ุฏฺฏุฑ ุนูุตุฑ ุฏุฑ ูุฌููุนู ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏุ ููุฏุงุฑ `false` ุจุฑูโฺฏุฑุฏุงูุฏ. `Current` ุนูุตุฑ ุฑุง ฺฉู ุฏุฑ ูููุนุช ูุนู ูุฑุงุฑ ุฏุงุฑุฏ ุจุฑูโฺฏุฑุฏุงูุฏ (ูุนูููุงู ุงุฒ ููุน `object` ุจู ููุน ุฎุงุตโุชุฑ ุชุจุฏู ูโุดูุฏ). ูุจู ุงุฒ ุฏุณุชุฑุณ ุจู ุงููู ุนูุตุฑุ ุญุชูุงู ุจุงุฏ `MoveNext` ูุฑุงุฎูุงู ุดูุฏ โ ุงู ฺฉุงุฑ ุงุฌุงุฒู ูโุฏูุฏ ุชุง ูุฌููุนู ุฎุงู ูุฒ ูุฏุฑุช ุดูุฏ. ูุชุฏ `Reset`ุ ุฏุฑ ุตูุฑุช ูพุงุฏูโุณุงุฒุ ฺฉุฑุณุฑ ุฑุง ุจู ุงุจุชุฏุง ูุฌููุนู ุจุงุฒูโฺฏุฑุฏุงูุฏ ุชุง ุงูฺฉุงู ูพูุงุด ูุฌุฏุฏ ูุฑุงูู ุดูุฏ. ูุฌูุฏ `Reset` ุจุดุชุฑ ุจุฑุง ุณุงุฒฺฏุงุฑ ุจุง **Component Object Model (COM)** ุงุณุชุ ูุฑุงุฎูุงู ูุณุชูู ุขู ูุนูููุงู ุงุฌุชูุงุจ ูโุดูุฏ ฺูู ููุดู ูพุดุชุจุงู ููโุดูุฏ ู ุจู ุทูุฑ ฺฉู ูุงุฒู ูุณุชุ ุฒุฑุง ุงุฌุงุฏ ฺฉ ููููู ุฌุฏุฏ ุงุฒ enumerator ุงุบูุจ ุณุงุฏูโุชุฑ ุงุณุช.

ูุนูููุงู ูุฌููุนูโูุง ุฎูุฏุดุงู enumerator ุฑุง ูพุงุฏูโุณุงุฒ ููโฺฉููุฏุ ุจูฺฉู **enumerator** ุฑุง ุงุฒ ุทุฑู ุงูุชุฑูุณ `IEnumerable` ูุฑุงูู ูโฺฉููุฏ:

```csharp
public interface IEnumerable
{
  IEnumerator GetEnumerator();
}
```

ุจุง ุชุนุฑู ฺฉ ูุชุฏ ฺฉู ฺฉ enumerator ุจุงุฒูโฺฏุฑุฏุงูุฏุ `IEnumerable` ุงูุนุทุงูโูพุฐุฑ ุงุฌุงุฏ ูโฺฉูุฏ ุชุง ููุทู ุชฺฉุฑุงุฑ (iteration) ุจู ฺฉูุงุณ ุฏฺฏุฑ ุณูพุฑุฏู ุดูุฏ. ููฺูู ุงู ุจู ุงู ูุนู ุงุณุช ฺฉู ฺูุฏ ูุตุฑูโฺฉููุฏู ูโุชูุงููุฏ ููุฒูุงู ูุฌููุนู ุฑุง ูพูุงุด ฺฉููุฏ ุจุฏูู ุงูฺฉู ุจุง ฺฉุฏฺฏุฑ ุชุฏุงุฎู ุฏุงุดุชู ุจุงุดูุฏ. ูโุชูุงู `IEnumerable` ุฑุง ยซ`IEnumeratorProvider`ยป ุฏุฑ ูุธุฑ ฺฏุฑูุชุ ู ุงู ุงุจุชุฏุงโุชุฑู ุงูุชุฑูุณ ุงุณุช ฺฉู ฺฉูุงุณโูุง ูุฌููุนู ูพุงุฏูโุณุงุฒ ูโฺฉููุฏ.

ููููู ุฒุฑ ุงุณุชูุงุฏู ุณุทุญ ูพุงู ุงุฒ `IEnumerable` ู `IEnumerator` ุฑุง ูุดุงู ูโุฏูุฏ:

```csharp
string s = "Hello";
// ฺูู ุฑุดุชู String ุงูุชุฑูุณ IEnumerable ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉูุฏุ ูโุชูุงูู GetEnumerator ุฑุง ูุฑุงุฎูุงู ฺฉูู:
IEnumerator rator = s.GetEnumerator();
while (rator.MoveNext())
{
  char c = (char) rator.Current;
  Console.Write(c + ".");
}
// ุฎุฑูุฌ: H.e.l.l.o.
```

ุจุง ุงู ุญุงูุ ุจูโูุฏุฑุช ูพุด ูโุขุฏ ฺฉู ูุชุฏูุง ุฑู enumerator ุจู ุงู ุดฺฉู ูุฑุงุฎูุงู ุดููุฏุ ุฒุฑุง C# ฺฉ ูุงูโุจุฑ ูุญู ูุฑุงูู ูโฺฉูุฏ: ุฏุณุชูุฑ `foreach`. ูุซุงู ุจุงูุง ุจุง ุงุณุชูุงุฏู ุงุฒ `foreach` ุจู ุดฺฉู ุฒุฑ ุจุงุฒููุณ ูโุดูุฏ:

```csharp
string s = "Hello";      // ฺฉูุงุณ String ุงูุชุฑูุณ IEnumerable ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉูุฏ
foreach (char c in s)
  Console.Write(c + ".");
```

---

### `IEnumerable<T>` ู `IEnumerator<T>` ๐งฉ

`IEnumerator` ู `IEnumerable` ุชูุฑุจุงู ููุดู ููุฑุงู ุจุง ูุณุฎูโูุง Generic ุฎูุฏ ูพุงุฏูโุณุงุฒ ูโุดููุฏ:

```csharp
public interface IEnumerator<T> : IEnumerator, IDisposable
{
  T Current { get; }
}

public interface IEnumerable<T> : IEnumerable
{
  IEnumerator<T> GetEnumerator();
}
```

ุจุง ุชุนุฑู ูุณุฎูโุง ููุนโุฏุงุฑ (typed) ุงุฒ `Current` ู `GetEnumerator`ุ ุงู ุงูุชุฑูุณโูุง ุงูู ููุน ุงุณุชุง (static type safety) ุฑุง ุชููุช ูโฺฉููุฏุ ุงุฒ ุณุฑุจุงุฑ **boxing** ุฏุฑ ุนูุงุตุฑ ููุน ููุฏุงุฑ (value-type) ุฌููฺฏุฑ ูโฺฉููุฏ ู ุจุฑุง ูุตุฑูโฺฉููุฏู ุฑุงุญุชโุชุฑ ูุณุชูุฏ. ุขุฑุงูโูุง ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ `IEnumerable<T>` ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉููุฏ (ฺฉู T ููุน ุนุถู ุขุฑุงู ุงุณุช).

ุจู ูุทู ุงูู ููุน ุงุณุชุงุ ูุฑุงุฎูุงู ูุชุฏ ุฒุฑ ุจุง ุขุฑุงูโุง ุงุฒ ฺฉุงุฑุงฺฉุชุฑูุง ุจุงุนุซ ุงุฌุงุฏ ุฎุทุง ุฒูุงู ฺฉุงููพุงู ูโุดูุฏ:

```csharp
void Test (IEnumerable<int> numbers) { ... }
```

ฺฉ ุฑูุด ุงุณุชุงูุฏุงุฑุฏ ุฏุฑ ฺฉูุงุณโูุง ูุฌููุนู ุงู ุงุณุช ฺฉู `IEnumerable<T>` ุฑุง ุจูโุตูุฑุช ุนููู (public) ููุงุด ุฏููุฏ ู `IEnumerable` ุบุฑ Generic ุฑุง ุงุฒ ุทุฑู ูพุงุฏูโุณุงุฒ ุตุฑุญ ุงูุชุฑูุณ (explicit interface implementation) ยซูุฎูยป ฺฉููุฏ. ุงู ฺฉุงุฑ ุจู ุงู ุฏูู ุงุณุช ฺฉู ุงฺฏุฑ ูุณุชููุงู `GetEnumerator()` ูุฑุงุฎูุงู ุดูุฏุ ฺฉ `IEnumerator<T>` ุงูู ุงุฒ ูุธุฑ ููุน ุจุงุฒฺฏุฑุฏุงูุฏู ุดูุฏ.

ุจุง ุงู ุญุงูุ ฺฏุงู ุงู ูุงููู ุจุฑุง ุณุงุฒฺฏุงุฑ ุจุง ูุณุฎูโูุง ูุฏู ุดฺฉุณุชู ูโุดูุฏ (ุฒุฑุง Genericูุง ูุจู ุงุฒ C# 2.0 ูุฌูุฏ ูุฏุงุดุชูุฏ). ฺฉ ูุซุงู ุฎูุจ ุขุฑุงูโูุง ูุณุชูุฏ โ ุงูโูุง ุจุงุฏ `IEnumerator` ุบุฑ Generic (ุง ููุงู ูุณุฎู ยซฺฉูุงุณฺฉยป) ุฑุง ุจุฑฺฏุฑุฏุงููุฏ ุชุง ฺฉุฏูุง ูุจู ุฎุฑุงุจ ูุดููุฏ. ุจุฑุง ุจู ุฏุณุช ุขูุฑุฏู `IEnumerator<T>` Genericุ ุจุงุฏ ููุน ุฑุง ุจู ุตูุฑุช ุตุฑุญ ุชุจุฏู (cast) ฺฉูุฏ:

```csharp
int[] data = { 1, 2, 3 };
var rator = ((IEnumerable<int>)data).GetEnumerator();
```

ุฎูุดุจุฎุชุงูู ุจู ูุทู ุฏุณุชูุฑ `foreach`ุ ุจู ูุฏุฑุช ูุงุฒ ุงุณุช ฺูู ฺฉุฏ ููุดุชู ุดูุฏ.

**IEnumerable<T> ู IDisposable โป๏ธ**

`IEnumerator<T>` ุงุฒ `IDisposable` ุงุฑุซโุจุฑ ูโฺฉูุฏ. ุงู ุงูฺฉุงู ุฑุง ุจู enumerator ูโุฏูุฏ ฺฉู ุจู ููุงุจุน ูุงููุฏ ุงุชุตุงู ุจู ูพุงฺฏุงู ุฏุงุฏู (database connections) ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดุฏ ู ุงุทููุงู ุญุงุตู ฺฉูุฏ ฺฉู ุงู ููุงุจุน ูพุณ ุงุฒ ุงุชูุงู ุง ูุทุน ูพูุงุด ุขุฒุงุฏ ูโุดููุฏ. ุฏุณุชูุฑ `foreach` ุงู ูฺฉุชู ุฑุง ุชุดุฎุต ูโุฏูุฏ ู ุนุจุงุฑุช ุฒุฑ ุฑุง:

```csharp
foreach (var element in somethingEnumerable) { ... }
```

ุจู ูุนุงุฏู ููุทู ุฒุฑ ุชุจุฏู ูโฺฉูุฏ:

```csharp
using (var rator = somethingEnumerable.GetEnumerator())
  while (rator.MoveNext())
  {
    var element = rator.Current;
    ...
  }
```

ุจููฺฉ `using` ุชุถูู ูโฺฉูุฏ ฺฉู ููุงุจุน ุจู ุฏุฑุณุช Dispose ุดููุฏ โ ุฏุฑุจุงุฑู `IDisposable` ุฏุฑ ูุตู ฑฒ ุจุดุชุฑ ุชูุถุญ ุฏุงุฏู ูโุดูุฏ.

---

### ุงุณุชูุงุฏู ุงุฒ ุงูุชุฑูุณโูุง ุบุฑ Generic โ

ุจุง ุชูุฌู ุจู ุงูู ููุน ุงุถุงู ฺฉู ุงูุชุฑูุณโูุง ูุฌููุนู Generic ูุงููุฏ `IEnumerable<T>` ุงุฑุงุฆู ูโุฏููุฏุ ุงู ุณุคุงู ูุทุฑุญ ูโุดูุฏ: ุขุง ูุงูุนุงู ูุงุฒ ุจู ุงุณุชูุงุฏู ุงุฒ `IEnumerable` ุบุฑ Generic (ุง `ICollection` ุง `IList`) ูุฌูุฏ ุฏุงุฑุฏุ

ุฏุฑ ููุฑุฏ `IEnumerable`ุ ุจุงุฏ ุงู ุงูุชุฑูุณ ุฑุง ููุฑุงู ุจุง `IEnumerable<T>` ูพุงุฏูโุณุงุฒ ฺฉูุฏุ ุฒุฑุง ูุณุฎู Generic ุงุฒ ูุณุฎู ุบุฑ Generic ุงุฑุซโุจุฑ ูโฺฉูุฏ. ุจุง ุงู ุญุงูุ ุจุณุงุฑ ูุงุฏุฑ ุงุณุช ฺฉู ุจุฎูุงูุฏ ุงู ุงูุชุฑูุณโูุง ุฑุง ุงุฒ ุงุจุชุฏุง ูพุงุฏูโุณุงุฒ ฺฉูุฏุ ุฏุฑ ุงฺฉุซุฑ ููุงุฑุฏ ูโุชูุงูุฏ ุงุฒ ุฑูุดโูุง ุณุทุญ ุจุงูุงุชุฑ ูุงููุฏ **iterator methods**ุ `Collection<T>` ู **LINQ** ุงุณุชูุงุฏู ฺฉูุฏ.

---

### ุจูโุนููุงู ูุตุฑูโฺฉููุฏู ๐

ุฏุฑ ุงฺฉุซุฑ ููุงุฑุฏุ ูโุชูุงูุฏ ุจูโุทูุฑ ฺฉุงูู ุจุง ุงูุชุฑูุณโูุง Generic ฺฉุงุฑ ฺฉูุฏ. ุจุง ุงู ุญุงูุ ุงูุชุฑูุณโูุง ุบุฑ Generic ูููุฒ ฺฏุงู ููุฏ ูุณุชูุฏุ ุฒุฑุง ุชูุงูุง ุงุฑุงุฆู **ฺฉูพุงุฑฺฺฏ ููุน** ุจุฑุง ูุฌููุนูโูุง ุจุง ููู ููุน ุนูุงุตุฑ ุฑุง ุฏุงุฑูุฏ.

ุจุฑุง ูุซุงูุ ูุชุฏ ุฒุฑ ุชุนุฏุงุฏ ุนูุงุตุฑ ููุฌูุฏ ุฏุฑ ูุฑ ูุฌููุนูโุง ุฑุง ุจูโุตูุฑุช ุจุงุฒฺฏุดุช ูโุดูุงุฑุฏ:

```csharp
public static int Count(IEnumerable e)
{
    int count = 0;
    foreach (object element in e)
    {
        var subCollection = element as IEnumerable;
        if (subCollection != null)
            count += Count(subCollection);
        else
            count++;
    }
    return count;
}
```

ฺูู C# ุจุง ุงูุชุฑูุณโูุง Generic ุงูฺฉุงู **covariance** ุฑุง ุงุฑุงุฆู ูโุฏูุฏุ ููฺฉู ุงุณุช ูฺฉุฑ ฺฉูุฏ ูโุชูุงูุณุชู ุจู ุฌุง ุขู `IEnumerable<object>` ุฏุฑุงูุช ฺฉูู. ุงูุง ุงู ุฑูุด ุจุง ุนูุงุตุฑ ููุน ููุฏุงุฑ (value-type) ู ูุฌููุนูโูุง ูุฏู ฺฉู `IEnumerable<T>` ุฑุง ูพุงุฏูโุณุงุฒ ูฺฉุฑุฏูโุงูุฏุ ุดฺฉุณุช ูโุฎูุฑุฏ โ ูุซุงู ุงุฒ ุงู ููุนุ `ControlCollection` ุฏุฑ Windows Forms ุงุณุช.

> โ๏ธ ูฺฉุชู: ุฏุฑ ูุซุงู ุจุงูุงุ ุงุฑุฌุงุนุงุช ฺุฑุฎูโุง (cyclic references) ูโุชูุงููุฏ ุจุงุนุซ ุจุงุฒฺฏุดุช ูุงูุชูุงู ู ฺฉุฑุด ุดุฏู ุจุฑูุงูู ุดููุฏ. ุณุงุฏูโุชุฑู ุฑุงู ุญูุ ุงุณุชูุงุฏู ุงุฒ `HashSet` ุงุณุช (ุจู ุจุฎุด "HashSet<T> ู SortedSet<T>" ุฏุฑ ุตูุญู ณนฒ ูุฑุงุฌุนู ฺฉูุฏ).

---

### ูพุงุฏูโุณุงุฒ ุงูุชุฑูุณโูุง Enumeration ๐๏ธ

ููฺฉู ุงุณุช ุจุฎูุงูุฏ `IEnumerable` ุง `IEnumerable<T>` ุฑุง ุจู ฺฉ ุง ฺูุฏ ุฏูู ุฒุฑ ูพุงุฏูโุณุงุฒ ฺฉูุฏ:

* ูพุดุชุจุงู ุงุฒ ุฏุณุชูุฑ `foreach`
* ููฺฉุงุฑ ุจุง ูุฑ ฺุฒ ฺฉู ูุฌููุนู ุงุณุชุงูุฏุงุฑุฏ ุงูุชุธุงุฑ ุฏุงุฑุฏ
* ุฑุนุงุช ูุงุฒููุฏโูุง ฺฉ ุงูุชุฑูุณ ูุฌููุนู ูพุดุฑูุชูโุชุฑ
* ูพุดุชุจุงู ุงุฒ **collection initializers**

ุจุฑุง ูพุงุฏูโุณุงุฒ `IEnumerable/IEnumerable<T>`ุ ุจุงุฏ ฺฉ **enumerator** ุงุฑุงุฆู ุฏูุฏ. ุณู ุฑูุด ุจุฑุง ุงูุฌุงู ุงู ฺฉุงุฑ ูุฌูุฏ ุฏุงุฑุฏ:

1. ุงฺฏุฑ ฺฉูุงุณุ ูุฌููุนู ุฏฺฏุฑ ุฑุง **wrapper** ูโฺฉูุฏุ ุจุง ุจุงุฒฺฏุฑุฏุงูุฏู enumerator ูุฌููุนู ุฏุงุฎู
2. ุงุฒ ุทุฑู ฺฉ **iterator** ุจุง ุงุณุชูุงุฏู ุงุฒ `yield return`
3. ุจุง ุงุฌุงุฏ ูููููโุง ุงุฒ ูพุงุฏูโุณุงุฒ ุฎูุฏ `IEnumerator/IEnumerator<T>`

---

### ููููู ุงุณุชูุงุฏู ุงุฒ iterator ุจุง `yield return` โจ

```csharp
public class MyCollection : IEnumerable
{
    int[] data = { 1, 2, 3 };
    public IEnumerator GetEnumerator()
    {
        foreach (int i in data)
            yield return i;
    }
}
```

ุฏุฑ ูฺฏุงู ุงููุ ุจู ูุธุฑ ูโุฑุณุฏ `GetEnumerator` ูฺ enumeratorโุง ุจุงุฒ ููโฺฏุฑุฏุงูุฏ! ุงูุง ฺฉุงููพุงูุฑ ููฺฏุงู ูพุฑุฏุงุฒุด `yield return`ุ ฺฉ ฺฉูุงุณ enumerator ูพููุงู ูโุณุงุฒุฏ ู `GetEnumerator` ุฑุง ุทูุฑ ุชุบุฑ ูโุฏูุฏ ฺฉู ุขู ฺฉูุงุณ ุฑุง ูููููโุณุงุฒ ู ุจุงุฒฺฏุฑุฏุงูุฏ.

ุงู ุฑูุด ุณุงุฏูุ ูุฏุฑุชููุฏ ู ุฏุฑ ูพุงุฏูโุณุงุฒ **LINQ-to-Objects** ุจุณุงุฑ ุงุณุชูุงุฏู ูโุดูุฏ.

---

### ูพุงุฏูโุณุงุฒ ูุณุฎู Generic ๐งฉ

```csharp
public class MyGenCollection : IEnumerable<int>
{
    int[] data = { 1, 2, 3 };
    public IEnumerator<int> GetEnumerator()
    {
        foreach (int i in data)
            yield return i;
    }

    // ูพุงุฏูโุณุงุฒ ุตุฑุญ ูุณุฎู ุบุฑ Generic:
    IEnumerator IEnumerable.GetEnumerator() => GetEnumerator();
}
```

ฺูู `IEnumerable<T>` ุงุฒ `IEnumerable` ุงุฑุซโุจุฑ ูโฺฉูุฏุ ุจุงุฏ ูุฑ ุฏู ูุณุฎู Generic ู ุบุฑ Generic ุงุฒ `GetEnumerator` ูพุงุฏูโุณุงุฒ ุดููุฏ. ูุณุฎู ุบุฑ Generic ูุนูููุงู ุจูโุตูุฑุช ุตุฑุญ (explicit) ูพุงุฏูโุณุงุฒ ูโุดูุฏ ุชุง ุจุชูุงูุฏ ูุณุฎู Generic ุฑุง ูุฑุงุฎูุงู ฺฉูุฏุ ุฒุฑุง `IEnumerator<T>` ุงุฒ `IEnumerator` ุงุฑุซโุจุฑ ูโฺฉูุฏ.

---

### ูพุงุฏูโุณุงุฒ ูุณุชูู IEnumerator ๐ง

ุฏุฑ ุจุฑุฎ ููุงุฑุฏุ ูโุชูุงูุฏ ฺฉ ฺฉูุงุณ ุจููุณุฏ ฺฉู ูุณุชููุงู `IEnumerator` ุฑุง ูพุงุฏูโุณุงุฒ ฺฉูุฏ. ูุซุงู ุฒุฑ ฺฉ ูุฌููุนู ุซุงุจุช ุจุง ุงุนุฏุงุฏ 1ุ 2 ู 3 ุฑุง ูุดุงู ูโุฏูุฏ:

```csharp
public class MyIntList : IEnumerable
{
    int[] data = { 1, 2, 3 };
    public IEnumerator GetEnumerator() => new Enumerator(this);

    class Enumerator : IEnumerator
    {
        MyIntList collection;
        int currentIndex = -1;

        public Enumerator(MyIntList items) => this.collection = items;

        public object Current
        {
            get
            {
                if (currentIndex == -1)
                    throw new InvalidOperationException("Enumeration not started!");
                if (currentIndex == collection.data.Length)
                    throw new InvalidOperationException("Past end of list!");
                return collection.data[currentIndex];
            }
        }

        public bool MoveNext()
        {
            if (currentIndex >= collection.data.Length - 1) return false;
            return ++currentIndex < collection.data.Length;
        }

        public void Reset() => currentIndex = -1;
    }
}
```

ูพุงุฏูโุณุงุฒ `Reset` ุงุฎุชุงุฑ ุงุณุช โ ูโุชูุงูุฏ ุจู ุฌุง ุขู `NotSupportedException` ูพุฑุชุงุจ ฺฉูุฏ.

---

### ูพุงุฏูโุณุงุฒ Generic ูุณุชูู โ

```csharp
class MyIntList : IEnumerable<int>
{
    int[] data = { 1, 2, 3 };

    public IEnumerator<int> GetEnumerator() => new Enumerator(this);
    IEnumerator IEnumerable.GetEnumerator() => new Enumerator(this);

    class Enumerator : IEnumerator<int>
    {
        int currentIndex = -1;
        MyIntList collection;

        public Enumerator(MyIntList items) => collection = items;

        public int Current => collection.data[currentIndex];
        object IEnumerator.Current => Current;

        public bool MoveNext() => ++currentIndex < collection.data.Length;
        public void Reset() => currentIndex = -1;

        // ุงุฒ ุขูุฌุง ฺฉู ูุงุฒ ุจู Dispose ูุฏุงุฑูุ ุจูุชุฑ ุงุณุช ุตุฑุญ ูพุงุฏูโุณุงุฒ ุดูุฏ ุชุง ุงุฒ ุฑุงุจุท ุนููู ูุฎู ุจูุงูุฏ
        void IDisposable.Dispose() {}
    }
}
```

ูุณุฎู Generic ุณุฑุนโุชุฑ ุงุณุช ุฒุฑุง `IEnumerator<int>.Current` ูุงุฒ ุจู **casting** ุงุฒ `int` ุจู `object` ูุฏุงุฑุฏ ู ุณุฑุจุงุฑ **boxing** ุฑุง ุญุฐู ูโฺฉูุฏ.

**ุงูุชุฑูุณโูุง ICollection ู IList ๐๏ธ**

ุงฺฏุฑฺู ุงูุชุฑูุณโูุง Enumeration ฺฉ ูพุฑูุชฺฉู ุจุฑุง ูพูุงุด **ููุท ุจู ุฌูู** (forward-only) ุฏุฑ ูุฌููุนูโูุง ูุฑุงูู ูโฺฉููุฏุ ุงูุง ูฺฉุงูุฒู ุจุฑุง ุชุนู ุงูุฏุงุฒู ูุฌููุนูุ ุฏุณุชุฑุณ ุจู ุนุถู ุงุฒ ุทุฑู ุงูุฏุณุ ุง ุชุบุฑ ูุญุชูุงุช ูุฌููุนู ุงุฑุงุฆู ููโุฏููุฏ. ุจุฑุง ฺูู ูุงุจูุชโูุงุ ุฏุงุชโูุช ุงูุชุฑูุณโูุง `ICollection`ุ `IList` ู `IDictionary` ุฑุง ุชุนุฑู ฺฉุฑุฏู ุงุณุช. ูุฑฺฉุฏุงู ุงุฒ ุงู ุงูุชุฑูุณโูุง ูุณุฎูโูุง **Generic** ู **Non-Generic** ุฏุงุฑูุฏุ ุจุง ุงู ุญุงูุ ูุณุฎูโูุง ุบุฑ Generic ุนูุฏุชุงู ุจุฑุง ูพุดุชุจุงู ุงุฒ ฺฉุฏูุง ูุฏู ูุฌูุฏ ุฏุงุฑูุฏ.

ุดฺฉู ท-ฑ ุณูุณูู ูุฑุงุชุจ ุงุฑุซโุจุฑ ุงู ุงูุชุฑูุณโูุง ุฑุง ูุดุงู ุฏุงุฏ. ุณุงุฏูโุชุฑู ุฑุงู ุจุฑุง ุฎูุงุตูโุณุงุฒ ุขูโูุง ุจู ุดุฑุญ ุฒุฑ ุงุณุช:

* `IEnumerable<T>` (ู `IEnumerable`)
  ุญุฏุงูู ูุงุจูุชโูุง ุฑุง ูุฑุงูู ูโฺฉูุฏ (ููุท ูพูุงุด)
* `ICollection<T>` (ู `ICollection`)
  ูุงุจูุชโูุง ูุชูุณุท ุฑุง ุงุฑุงุฆู ูโุฏูุฏ (ูุซูุงู ูฺฺฏ `Count`)
* `IList<T>` / `IDictionary<K,V>` ู ูุณุฎูโูุง ุบุฑ Generic ุขูโูุง
  ุญุฏุงฺฉุซุฑ ูุงุจูุชโูุง ุฑุง ุงุฑุงุฆู ูโุฏููุฏ (ุดุงูู ุฏุณุชุฑุณ ยซุชุตุงุฏูยป ุจู ุนูุงุตุฑ ุจุง ุงูุฏุณ ุง ฺฉูุฏ)

ุจู ูุฏุฑุช ูพุด ูโุขุฏ ฺฉู ูุงุฒ ุฏุงุดุชู ุจุงุดุฏ ูุฑ ฺฉ ุงุฒ ุงู ุงูุชุฑูุณโูุง ุฑุง ุฎูุฏุชุงู ูพุงุฏูโุณุงุฒ ฺฉูุฏ. ุฏุฑ ุงฺฉุซุฑ ููุงูุนุ ููฺฏุงู ููุดุชู ฺฉ ฺฉูุงุณ ูุฌููุนูุ ูโุชูุงูุฏ ุจู ุฌุง ุขู ุงุฒ **subclass** ฺฉุฑุฏู `Collection<T>` ุงุณุชูุงุฏู ฺฉูุฏ (ุจู ุจุฎุด "Customizable Collections and Proxies" ุฏุฑ ุตูุญู ดฐฑ ูุฑุงุฌุนู ฺฉูุฏ). **LINQ** ูุฒ ฺฏุฒูู ุฏฺฏุฑ ุงุฑุงุฆู ูโุฏูุฏ ฺฉู ุจุณุงุฑ ุงุฒ ุณูุงุฑููุง ุฑุง ูพูุดุด ูโุฏูุฏ.

ูุณุฎูโูุง Generic ู Non-Generic ุชูุงูุชโูุง ูุฑุงุชุฑ ุงุฒ ุงูุชุธุงุฑ ูุนููู ุฏุงุฑูุฏุ ุจูโูฺู ุฏุฑ ููุฑุฏ `ICollection`. ุงู ุชูุงูุชโูุง ุนูุฏุชุงู ุชุงุฑุฎ ูุณุชูุฏ: ฺูู Genericูุง ุจุนุฏุงู ูุงุฑุฏ ุดุฏูุฏุ ุงูุชุฑูุณโูุง Generic ุจุง ุจูุฑูโููุฏ ุงุฒ ุชุฌุฑุจู ูพุดู ุชูุณุนู ุงูุชูุฏ ู ุงุนุถุง ูุชูุงูุช (ู ุจูุชุฑ) ุงูุชุฎุงุจ ุดุฏูุฏ.

ุจู ููู ุฏูู:

* `ICollection<T>` ุงุฒ `ICollection` ุงุฑุซโุจุฑ ููโฺฉูุฏ
* `IList<T>` ุงุฒ `IList` ุงุฑุซโุจุฑ ููโฺฉูุฏ
* `IDictionary<TKey, TValue>` ุงุฒ `IDictionary` ุงุฑุซโุจุฑ ููโฺฉูุฏ

ุงูุจุชูุ ฺฉ ฺฉูุงุณ ูุฌููุนู ูโุชูุงูุฏ ูุฑ ุฏู ูุณุฎู ฺฉ ุงูุชุฑูุณ ุฑุง ูพุงุฏูโุณุงุฒ ฺฉูุฏ ุงฺฏุฑ ููุฏ ุจุงุดุฏ (ฺฉู ุงุบูุจ ููุฏ ุงุณุช).

ุฏูู ุธุฑูโุชุฑ ุฏฺฏุฑ ฺฉู ุจุงุนุซ ุดุฏู `IList<T>` ุงุฒ `IList` ุงุฑุซโุจุฑ ูฺฉูุฏ ุงู ุงุณุช ฺฉู ุงฺฏุฑ ุงู ฺฉุงุฑ ุงูุฌุงู ุดูุฏุ ุชุจุฏู ุจู `IList<T>` ููุฌุจ ุจุงุฒฺฏุดุช ฺฉ ุงูุชุฑูุณ ุจุง ุงุนุถุง `Add(T)` ู `Add(object)` ูโุดูุฏุ ฺฉู ุฏุฑ ูุงูุน ุงูู ููุน ุงุณุชุง (static type safety) ุฑุง ููุถ ูโฺฉูุฏุ ุฒุฑุง ูโุชูุงูุณุชุฏ ุจุง ูุฑ ููุน ุดุฆ `Add` ุฑุง ูุฑุงุฎูุงู ฺฉูุฏ.

---

### ุงู ุจุฎุด ุดุงูู ฺู ููุงุฑุฏ ุงุณุช ๐

ุงู ุจุฎุด ุจู `ICollection<T>` ู `IList<T>` ู ูุณุฎูโูุง ุบุฑ Generic ุขูโูุง ูโูพุฑุฏุงุฒุฏุ **ุฏฺฉุดูุฑโูุง** ุฏุฑ ุตูุญู ณนด ุชุญุช ูพูุดุด ูุฑุงุฑ ุฏุงุฑูุฏ.

ุฏุฑ ฺฉุชุงุจุฎุงููโูุง ุฏุงุชโูุชุ ูฺ ููุทู ฺฉูพุงุฑฺูโุง ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ูุงฺูโูุง "collection" ู "list" ูุฌูุฏ ูุฏุงุฑุฏ.
ุจุฑุง ูุซุงูุ ฺูู `IList<T>` ูุณุฎูโุง ุจุง ูุงุจูุช ุจุดุชุฑ ุงุฒ `ICollection<T>` ุงุณุชุ ููฺฉู ุงุณุช ุงูุชุธุงุฑ ุฏุงุดุชู ุจุงุดุฏ ฺฉูุงุณ `List<T>` ุจูโุทูุฑ ูุดุงุจู ุงุฒ ฺฉูุงุณ `Collection<T>` ฺฉุงุฑุจุฑุฏโุชุฑ ุจุงุดุฏุ ุงูุง ุงูโฺฏููู ูุณุช. ุจูุชุฑ ุงุณุช ุงู ุฏู ูุงฺู ุฑุง ุจูโุทูุฑ ฺฉู ูุชุฑุงุฏู ุฏุฑ ูุธุฑ ุจฺฏุฑุฏุ ูฺฏุฑ ุขูฺฉู ููุน ุฎุงุต ูุฏูุธุฑ ุจุงุดุฏ.

---

### ICollection<T> ู ICollection ๐ฆ

`ICollection<T>` ุงูุชุฑูุณ ุงุณุชุงูุฏุงุฑุฏ ุจุฑุง ูุฌููุนูโูุง ุดูุงุฑุดโูพุฐุฑ ุงุณุช. ุงู ุงูุชุฑูุณ ุงูฺฉุงู:

* ุชุนู ุงูุฏุงุฒู ูุฌููุนู (`Count`)
* ุจุฑุฑุณ ูุฌูุฏ ฺฉ ุขุชู ุฏุฑ ูุฌููุนู (`Contains`)
* ฺฉูพ ูุฌููุนู ุจู ุขุฑุงู (`ToArray`)
* ุชุนู ุงูฺฉู ูุฌููุนู ููุท ุฎูุงูุฏู ุงุณุช (`IsReadOnly`)

ู ุจุฑุง ูุฌููุนูโูุง ูุงุจู ููุดุชูุ ุงูฺฉุงู ุงูุฒูุฏู (`Add`)ุ ุญุฐู (`Remove`) ู ูพุงฺฉ ฺฉุฑุฏู (`Clear`) ุนูุงุตุฑ ุฑุง ูุฒ ูุฑุงูู ูโฺฉูุฏ.
ููฺูู ฺูู ุงุฒ `IEnumerable<T>` ุงุฑุซโุจุฑ ูโฺฉูุฏุ ูโุชูุงู ุงุฒ ุฏุณุชูุฑ `foreach` ูุฒ ุจุฑุง ูพูุงุด ุขู ุงุณุชูุงุฏู ฺฉุฑุฏ:

```csharp
public interface ICollection<T> : IEnumerable<T>, IEnumerable
{
    int Count { get; }
    bool Contains(T item);
    void CopyTo(T[] array, int arrayIndex);
    bool IsReadOnly { get; }
    void Add(T item);
    bool Remove(T item);
    void Clear();
}
```

ูุณุฎู ุบุฑ Generic `ICollection` ูุดุงุจู ุงุณุช ู ูุฌููุนูโุง ุดูุงุฑุดโูพุฐุฑ ุงุฑุงุฆู ูโุฏูุฏุ ุงูุง ูุงุจูุช ุชุบุฑ ูุญุชูุงุช ูุฌููุนู ุง ุจุฑุฑุณ ุนุถูุช ุนูุงุตุฑ ุฑุง ูุฏุงุฑุฏ:

```csharp
public interface ICollection : IEnumerable
{
    int Count { get; }
    bool IsSynchronized { get; }
    object SyncRoot { get; }
    void CopyTo(Array array, int index);
}
```

ุงู ูุณุฎู ุบุฑ Generic ููฺูู ูฺฺฏโูุง ุจุฑุง ฺฉูฺฉ ุจู **ุณูฺฉ ฺฉุฑุฏู (synchronization)** ุฏุงุฑุฏ (ูุตู ฑด) โ ุงู ูฺฺฏโูุง ุฏุฑ ูุณุฎู Generic ุญุฐู ุดุฏูุฏ ุฒุฑุง **Thread Safety** ุฏฺฏุฑ ุฐุงุชุงู ุจุฎุด ุงุฒ ูุฌููุนูโูุง ูุญุณูุจ ููโุดูุฏ.

ูุฑ ุฏู ุงูุชุฑูุณ ูุณุจุชุงู ุณุงุฏู ุจุฑุง ูพุงุฏูโุณุงุฒ ูุณุชูุฏ. ุงฺฏุฑ ุจุฎูุงูุฏ ฺฉ `ICollection<T>` ููุท ุฎูุงูุฏู ูพุงุฏูโุณุงุฒ ฺฉูุฏุ ูุชุฏูุง `Add`ุ `Remove` ู `Clear` ุจุงุฏ `NotSupportedException` ูพุฑุชุงุจ ฺฉููุฏ.

ูุนูููุงู ุงู ุงูุชุฑูุณโูุง ููุฑุงู ุจุง `IList` ุง `IDictionary` ูพุงุฏูโุณุงุฒ ูโุดููุฏ.
**ุงูุชุฑูุณโูุง IList<T> ู IList ๐**

`IList<T>` ุงูุชุฑูุณ ุงุณุชุงูุฏุงุฑุฏ ุจุฑุง ูุฌููุนูโูุง ุงุณุช ฺฉู ูโุชูุงู ุจู ุนูุงุตุฑ ุขูโูุง ุจุง **ูููุนุช (ุงูุฏุณ)** ุฏุณุชุฑุณ ุฏุงุดุช. ุนูุงูู ุจุฑ ูุงุจูุชโูุง ฺฉู ุงุฒ `ICollection<T>` ู `IEnumerable<T>` ุจู ุงุฑุซ ุจุฑุฏูุ ุงู ุงูุชุฑูุณ ุงูฺฉุงู **ุฎูุงูุฏู ู ููุดุชู ุนูุตุฑ ุจุง ุงุณุชูุงุฏู ุงุฒ ุงูุฏุณ** ู **ุฏุฑุฌ/ุญุฐู ุนูุตุฑ ุจุฑ ุงุณุงุณ ูููุนุช** ุฑุง ูุฒ ูุฑุงูู ูโฺฉูุฏ:

```csharp
public interface IList<T> : ICollection<T>, IEnumerable<T>, IEnumerable
{
    T this[int index] { get; set; }
    int IndexOf(T item);
    void Insert(int index, T item);
    void RemoveAt(int index);
}
```

ูุชุฏ `IndexOf` ุฌุณุชุฌู ุฎุท (linear search) ุฏุฑ ูุณุช ุงูุฌุงู ูโุฏูุฏ ู ุงฺฏุฑ ุนูุตุฑ ูุดุฎุต ุดุฏู ูพุฏุง ูุดูุฏุ ููุฏุงุฑ `-1` ุจุฑูโฺฏุฑุฏุงูุฏ.

ูุณุฎู ุบุฑ Generic `IList` ุงุนุถุง ุจุดุชุฑ ุฏุงุฑุฏุ ุฒุฑุง ุงุฒ `ICollection` ฺฉูุชุฑ ุงุฑุซโุจุฑ ูโฺฉูุฏ:

```csharp
public interface IList : ICollection, IEnumerable
{
    object this[int index] { get; set; }
    bool IsFixedSize { get; }
    bool IsReadOnly { get; }
    int Add(object value);
    void Clear();
    bool Contains(object value);
    int IndexOf(object value);
    void Insert(int index, object value);
    void Remove(object value);
    void RemoveAt(int index);
}
```

ุฏุฑ ูุณุฎู ุบุฑ Genericุ ูุชุฏ `Add` ฺฉ **ุนุฏุฏ ุตุญุญ (int)** ุจุฑูโฺฏุฑุฏุงูุฏ ฺฉู ูุดุงูโุฏููุฏู **ุงูุฏุณ ุนูุตุฑ ุงุถุงููโุดุฏู** ุงุณุช. ุฏุฑ ููุงุจูุ ูุชุฏ `Add` ุฏุฑ `ICollection<T>` ุฏุงุฑุง ููุน ุจุงุฒฺฏุดุช `void` ุงุณุช.

ฺฉูุงุณ ุนููู `List<T>` ููููู ุจุงุฑุฒ ูพุงุฏูโุณุงุฒ ูุฑ ุฏู ุงูุชุฑูุณ `IList<T>` ู `IList` ุงุณุช. ุขุฑุงูโูุง C# ูุฒ ูุฑ ุฏู ูุณุฎู Generic ู Non-Generic `IList` ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉููุฏุ ุงฺฏุฑฺู ูุชุฏูุง ฺฉู ุจุฑุง ุงุถุงูู ุง ุญุฐู ุนูุงุตุฑ ูุณุชูุฏุ ุงุฒ ุทุฑู ูพุงุฏูโุณุงุฒ ุตุฑุญ ุงูุชุฑูุณ ูพููุงู ุดุฏูโุงูุฏ ู ุฏุฑ ุตูุฑุช ูุฑุงุฎูุงูุ `NotSupportedException` ูพุฑุชุงุจ ูโฺฉููุฏ.

> โ๏ธ ุงฺฏุฑ ุชูุงุด ฺฉูุฏ ุจู ฺฉ **ุขุฑุงู ฺูุฏุจุนุฏ** ุงุฒ ุทุฑู ุงูุฏฺฉุณุฑ `IList` ุฏุณุชุฑุณ ูพุฏุง ฺฉูุฏุ ฺฉ `ArgumentException` ูพุฑุชุงุจ ุฎูุงูุฏ ุดุฏ. ุงู ูฺฉุชู ููฺฉู ุงุณุช ููฺฏุงู ููุดุชู ูุชุฏูุง ูุงููุฏ ุฒุฑ ูุดฺฉูโุณุงุฒ ุดูุฏ:

```csharp
public object FirstOrNull(IList list)
{
    if (list == null || list.Count == 0) return null;
    return list[0];
}
```

ุงู ฺฉุฏ ููฺฉู ุงุณุช ุธุงูุฑุงู ุจโุฎุทุง ุจุงุดุฏุ ุงูุง ุงฺฏุฑ ุจุง ุขุฑุงู ฺูุฏุจุนุฏ ูุฑุงุฎูุงู ุดูุฏุ ฺฉ ุงุณุชุซูุง ูพุฑุชุงุจ ุฎูุงูุฏ ฺฉุฑุฏ. ูโุชูุงู ุฏุฑ ุฒูุงู ุงุฌุฑุง ุจุฑุฑุณ ฺฉุฑุฏ ฺฉู ุขุง ุขุฑุงู ฺูุฏุจุนุฏ ุงุณุช ุง ุฎุฑ:

```csharp
list.GetType().IsArray && list.GetType().GetArrayRank() > 1
```

---

### IReadOnlyCollection<T> ู IReadOnlyList<T> ๐

.NET ุงูุชุฑูุณโูุง **ูุฌููุนู ู ูุณุช ููุท ุฎูุงูุฏู** ูุฒ ุฏุงุฑุฏ ฺฉู ููุท ุงุนุถุง ูุงุฒู ุจุฑุง ุนููุงุช **ููุท ุฎูุงูุฏู** ุฑุง ุงุฑุงุฆู ูโุฏููุฏ:

```csharp
public interface IReadOnlyCollection<out T> : IEnumerable<T>, IEnumerable
{
    int Count { get; }
}

public interface IReadOnlyList<out T> : IReadOnlyCollection<T>,
                                       IEnumerable<T>, IEnumerable
{
    T this[int index] { get; }
}
```

ุงุฒ ุขูุฌุง ฺฉู ูพุงุฑุงูุชุฑ ููุน (`T`) ุชููุง ุฏุฑ **ูููุนุช ุฎุฑูุฌ** ุงุณุชูุงุฏู ูโุดูุฏุ ุจู ุตูุฑุช **Covariant** ุนูุงูุชโฺฏุฐุงุฑ ุดุฏู ุงุณุช. ุงู ุงูฺฉุงู ุฑุง ูโุฏูุฏ ฺฉู ูุซูุงู **ูุณุช ุงุฒ ฺฏุฑุจูโูุง** ุจู ุนููุงู ฺฉ **ูุณุช ููุท ุฎูุงูุฏู ุงุฒ ุญูุงูุงุช** ุชูู ุดูุฏ.

ุฏุฑ ููุงุจูุ `T` ุฏุฑ `ICollection<T>` ู `IList<T>` Covariant ูุณุชุ ุฒุฑุง ุฏุฑ ูุฑ ุฏู ูููุนุช ูุฑูุฏ ู ุฎุฑูุฌ ุงุณุชูุงุฏู ูโุดูุฏ.

ุงู ุงูุชุฑูุณโูุง ููุง **ููุท ุฎูุงูุฏู** ุงุฒ ฺฉ ูุฌููุนู ุง ูุณุช ุงุฑุงุฆู ูโฺฉููุฏุ ูพุงุฏูโุณุงุฒ ูุงูุน ููฺฉู ุงุณุช ูููุฒ ูุงุจู ููุดุชู ุจุงุดุฏ. ุงฺฉุซุฑ ูุฌููุนูโูุง ูุงุจู ุชุบุฑ (Mutable) ูู ุงูุชุฑูุณโูุง ููุท ุฎูุงูุฏู ู ูู ุฎูุงูุฏู/ููุดุชู ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉููุฏ.

ุนูุงูู ุจุฑ ุงูฺฉุงู ฺฉุงุฑ ุจุง ูุฌููุนูโูุง ุจู ุตูุฑุช Covariantุ ุงูุชุฑูุณโูุง ููุท ุฎูุงูุฏู ุงุฌุงุฒู ูโุฏููุฏ ฺฉ ฺฉูุงุณ **ููุง ููุท ุฎูุงูุฏู ุงุฒ ฺฉ ูุฌููุนู ุฎุตูุต ูุงุจู ููุดุชู** ุฑุง ุจู ุตูุฑุช ุนููู ุงุฑุงุฆู ฺฉูุฏ. ุงู ููุถูุน ุฏุฑ ุจุฎุด `ReadOnlyCollection<T>` ุฏุฑ ุตูุญู ดฐถ ูุดุงู ุฏุงุฏู ุดุฏู ุงุณุช.

> `IReadOnlyList<T>` ุจุง ููุน Windows Runtime `IVectorView<T>` ูุทุงุจูุช ุฏุงุฑุฏ.

---

### ฺฉูุงุณ Array ๐๏ธ

ฺฉูุงุณ `Array` ฺฉูุงุณ ูพุงู **ุถูู (implicit)** ุจุฑุง ุชูุงู ุขุฑุงูโูุง ุชฺฉโุจุนุฏ ู ฺูุฏุจุนุฏ ุงุณุช ู ฺฉ ุงุฒ **ุงุณุงุณโุชุฑู ููุนโูุง** ุงุณุช ฺฉู ุงูุชุฑูุณโูุง ุงุณุชุงูุฏุงุฑุฏ ูุฌููุนู ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉูุฏ.

ฺฉูุงุณ `Array` ฺฉูพุงุฑฺฺฏ ููุน ุฑุง ูุฑุงูู ูโฺฉูุฏุ ุจูุงุจุฑุงู ฺฉ ูุฌููุนู ุงุฒ **ูุชุฏูุง ูุดุชุฑฺฉ** ุจุฑุง ุชูุงู ุขุฑุงูโูุงุ ุตุฑูโูุธุฑ ุงุฒ ุงุนูุงู ุง ููุน ุนูุงุตุฑุ ุฏุฑ ุฏุณุชุฑุณ ุงุณุช.

ุงุฒ ุขูุฌุง ฺฉู ุขุฑุงูโูุง ุจุณุงุฑ ุงุณุงุณ ูุณุชูุฏุ C# **ุณูุชฺฉุณ ูฺูโุง ุจุฑุง ุงุนูุงู ู ููุฏุงุฑุฏู ุงููู ุขูโูุง** ุงุฑุงุฆู ูโุฏูุฏ (ฺฉู ุฏุฑ ูุตูโูุง ฒ ู ณ ุชูุถุญ ุฏุงุฏู ุดุฏ). ููุช ุขุฑุงูโุง ุจุง ุณูุชฺฉุณ C# ุงุนูุงู ูโุดูุฏุ **CLR ุจู ุทูุฑ ุถูู** ฺฉูุงุณ `Array` ุฑุง ุฒุฑููุนโุฏู ูโฺฉูุฏ ู ฺฉ **Pseudo-Type** ููุงุณุจ ุจุฑุง ุงุจุนุงุฏ ู ููุน ุนูุงุตุฑ ุขุฑุงู ุงุฌุงุฏ ูโฺฉูุฏ. ุงู Pseudo-Type ุงูุชุฑูุณโูุง Generic ููุนโุฏุงุฑ ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉูุฏุ ูุงููุฏ `IList<string>`.

CLR ููฺูู ููฺฏุงู ุณุงุฎุช ุขุฑุงูโูุง ุจู ุขูโูุง ุจู ุตูุฑุช ูฺู ูฺฏุงู ูโฺฉูุฏ ู **ูุถุง ูุชูุงู ุฏุฑ ุญุงูุธู** ุจุฑุง ุขูโูุง ุงุฎุชุตุงุต ูโุฏูุฏ. ุงู ฺฉุงุฑ ุจุงุนุซ ูโุดูุฏ **ุฏุณุชุฑุณ ุจุง ุงูุฏุณ ุจู ุขุฑุงูโูุง ุจุณุงุฑ ฺฉุงุฑุขูุฏ** ุจุงุดุฏุ ุงูุง ุงุฌุงุฒู ุชุบุฑ ุงูุฏุงุฒู ุจุนุฏ ุงุฒ ุณุงุฎุช ุฑุง ููโุฏูุฏ.

ฺฉูุงุณ `Array` ุงูุชุฑูุณโูุง ูุฌููุนู ุฑุง ุชุง `IList<T>` ูพุงุฏูโุณุงุฒ ูโฺฉูุฏุ ูู ุฏุฑ ูุณุฎู Generic ู ูู ุบุฑ Generic. ุฎูุฏ `IList<T>` ุจู ุตูุฑุช ุตุฑุญ ูพุงุฏูโุณุงุฒ ุดุฏู ุชุง **ูุชุฏูุง ูุงููุฏ Add ู Remove** ฺฉู ุจุฑุง ุขุฑุงูโูุง ุจุง ุทูู ุซุงุจุช ูุงููุงุณุจ ูุณุชูุฏุ ุงุฒ ุฑุงุจุท ุนููู `Array` ูพููุงู ุจูุงููุฏ ู ุฏุฑ ุตูุฑุช ูุฑุงุฎูุงู ุงุณุชุซูุง ูพุฑุชุงุจ ฺฉููุฏ.

ฺฉูุงุณ `Array` ฺฉ ูุชุฏ **ุงุณุชุงุชฺฉ `Resize`** ูุฒ ุงุฑุงุฆู ูโุฏูุฏุ ุงูุง ุงู ูุชุฏ ุจุง **ุงุฌุงุฏ ฺฉ ุขุฑุงู ุฌุฏุฏ ู ฺฉูพ ฺฉุฑุฏู ูุฑ ุนูุตุฑ** ฺฉุงุฑ ูโฺฉูุฏ. ุงู ุฑูุด ูู ุชููุง ูุงฺฉุงุฑุขูุฏ ุงุณุชุ ุจูฺฉู ูุฑุงุฌุน ุจู ุขุฑุงู ุงุตู ุฏุฑ ุจุฎุดโูุง ุฏฺฏุฑ ุจุฑูุงูู ููฺูุงู ุจู ูุณุฎู ุงููู ุงุดุงุฑู ุฎูุงููุฏ ฺฉุฑุฏ. ุฑุงู ุญู ุจูุชุฑ ุจุฑุง ูุฌููุนูโูุง ูุงุจู ุชุบุฑุ ุงุณุชูุงุฏู ุงุฒ ฺฉูุงุณ `List<T>` ุงุณุช (ฺฉู ุฏุฑ ุจุฎุด ุจุนุฏ ุชูุถุญ ุฏุงุฏู ูโุดูุฏ).

ุขุฑุงู ูโุชูุงูุฏ ุดุงูู ุนูุงุตุฑ **Value-Type** ุง **Reference-Type** ุจุงุดุฏ. ุนูุงุตุฑ Value-Type ุฏุฑ ูุญู ุขุฑุงู ุฐุฎุฑู ูโุดููุฏุ ุจูุงุจุฑุงู ฺฉ ุขุฑุงู ุงุฒ ุณู ุนุฏุฏ ุตุญุญ ุทููุงู (ูุฑ ฺฉุฏุงู ธ ุจุงุช) **ฒด ุจุงุช ุญุงูุธู ูุชูุงู** ุงุดุบุงู ูโฺฉูุฏ. ุงูุง ุนูุตุฑ Reference-Type ุชููุง ุจู ุงูุฏุงุฒู ฺฉ ูุฑุฌุน ูุถุง ุขุฑุงู ุฑุง ุงุดุบุงู ูโฺฉูุฏ (ด ุจุงุช ุฏุฑ ูุญุท ณฒ ุจุช ุง ธ ุจุงุช ุฏุฑ ูุญุท ถด ุจุช).

ุดฺฉู ท-ฒ ุชุฃุซุฑ ุงู ููุถูุน ุฑุง ุฏุฑ ุญุงูุธู ูุดุงู ูโุฏูุฏ:

```csharp
StringBuilder[] builders = new StringBuilder[5];
builders[0] = new StringBuilder("builder1");
builders[1] = new StringBuilder("builder2");
builders[2] = new StringBuilder("builder3");

long[] numbers = new long[3];
numbers[0] = 12345;
numbers[1] = 54321;
```

<div align="center">

![Conventions-UsedThis-Book](../../../assets/image/07/Table-7-3.jpeg)
</div>

ฺูู `Array` ฺฉ ฺฉูุงุณ ุงุณุชุ **ุขุฑุงูโูุง ููุดู ุฎูุฏุดุงู ููุน ูุฑุฌุน (Reference Type) ูุณุชูุฏ**โุตุฑูโูุธุฑ ุงุฒ ููุน ุนูุงุตุฑ ุขุฑุงู. ุงู ุจุฏุงู ูุนูุงุณุช ฺฉู ุฏุณุชูุฑ ุฒุฑ:

```csharp
arrayB = arrayA
```

ููุฌุฑ ุจู ุงุฌุงุฏ **ุฏู ูุชุบุฑ ูโุดูุฏ ฺฉู ุจู ููุงู ุขุฑุงู ุงุฑุฌุงุน ูโุฏููุฏ**.

ุจู ููู ุชุฑุชุจุ **ุฏู ุขุฑุงู ูุฌุฒุง ููุดู ุฏุฑ ุขุฒููู ุจุฑุงุจุฑ ุดฺฉุณุช ุฎูุงููุฏ ุฎูุฑุฏ**ุ ูฺฏุฑ ุงูฺฉู ุงุฒ ฺฉ **ููุงุณูโฺฉููุฏู ุจุฑุงุจุฑ ุณุงุฎุชุงุฑ (Structural Equality Comparer)** ุงุณุชูุงุฏู ฺฉูุฏ ฺฉู ูุฑ ุนูุตุฑ ุขุฑุงู ุฑุง ููุงุณู ูโฺฉูุฏ:

```csharp
object[] a1 = { "string", 123, true };
object[] a2 = { "string", 123, true };

Console.WriteLine(a1 == a2);                         // False
Console.WriteLine(a1.Equals(a2));                    // False

IStructuralEquatable se1 = a1;
Console.WriteLine(se1.Equals(a2, StructuralComparisons.StructuralEqualityComparer));   // True
```

ุขุฑุงูโูุง ูโุชูุงููุฏ ุจุง ูุฑุงุฎูุงู ูุชุฏ `Clone` ฺฉูพ ุดููุฏ:

```csharp
arrayB = arrayA.Clone();
```

ุงูุง ุงู ฺฉ **ฺฉูพ ุณุทุญ (Shallow Clone)** ุงุฌุงุฏ ูโฺฉูุฏุ ุนู ููุท **ุญุงูุธูโุง ฺฉู ุฎูุฏ ุขุฑุงู ุงุดุบุงู ฺฉุฑุฏู ุงุณุช** ฺฉูพ ูโุดูุฏ. ุงฺฏุฑ ุขุฑุงู ุดุงูู **ุงุดุงุก Value-Type** ุจุงุดุฏุ ุฎูุฏ ููุงุฏุฑ ฺฉูพ ูโุดููุฏุ ุงูุง ุงฺฏุฑ ุดุงูู **ุงุดุงุก Reference-Type** ุจุงุดุฏุ ููุท **ุงุฑุฌุงุนุงุช (References)** ฺฉูพ ูโุดููุฏุ ุฏุฑ ูุชุฌู ุฏู ุขุฑุงูโุง ุฎูุงูุฏ ุฏุงุดุช ฺฉู ุงุนุถุง ุขูโูุง ุจู **ููุงู ุงุดุงุก** ุงุดุงุฑู ูโฺฉููุฏ.

ุดฺฉู ท-ณ ุงุซุฑ ุงู ููุถูุน ุฑุง ููฺฏุงู ุงูุฒูุฏู ฺฉุฏ ุฒุฑ ุจู ูุซุงู ูุดุงู ูโุฏูุฏ:

```csharp
StringBuilder[] builders2 = builders;
StringBuilder[] shallowClone = (StringBuilder[]) builders.Clone();
```

<div align="center">

![Conventions-UsedThis-Book](../../../assets/image/07/Table-7-4.jpeg)
</div>

ุจุฑุง ุงุฌุงุฏ ฺฉ **ฺฉูพ ุนูู (Deep Copy)**โฺฉู ุฏุฑ ุขู **ุฒุฑ ุงุดุงุก Reference-Type** ูุฒ ุชฺฉุฑุงุฑ ูโุดููุฏโุจุงุฏ ุงุฒ ุขุฑุงู ุนุจูุฑ ฺฉุฑุฏู ู ูุฑ ุนูุตุฑ ุฑุง ุจูโุตูุฑุช ุฏุณุช ฺฉูพ ฺฉูุฏ. ููุงู ููุงูู ุจุฑุง ุณุงุฑ ุงููุงุน ูุฌููุนูโูุง ุฏุฑ .NET ูุฒ ุตุฏู ูโฺฉูุฏ.

ุงฺฏุฑฺู `Array` ุนูุฏุชุงู ุจุฑุง ุงุณุชูุงุฏู ุจุง **ุงูุฏฺฉุณโูุง ณฒ ุจุช** ุทุฑุงุญ ุดุฏูุ ุงูุง ุงุฒ **ุงูุฏฺฉุณโูุง ถด ุจุช** ูุฒ ูพุดุชุจุงู ูุญุฏูุฏ ุฏุงุฑุฏ (ฺฉู ุจู ุตูุฑุช ุชุฆูุฑ ุงูฺฉุงู ุฏุณุชุฑุณ ุจู ุชุง $2^{64}$ ุนูุตุฑ ุฑุง ูโุฏูุฏ) ุงุฒ ุทุฑู ฺูุฏู ูุชุฏ ฺฉู ูู **Int32** ู ูู **Int64** ุฑุง ูโูพุฐุฑูุฏ. ุงู ุงูุฑููุฏูุง ุฏุฑ ุนูู ุจโูุงุฏู ูุณุชูุฏุ ุฒุฑุง **CLR ุงุฌุงุฒู ููโุฏูุฏ ูฺ ุดุกโุงุฒ ุฌููู ุขุฑุงูโูุงโุจุฒุฑฺฏโุชุฑ ุงุฒ ุฏู ฺฏฺฏุงุจุงุช ุจุงุดุฏ** (ฺู ุฏุฑ ูุญุท ณฒ ุจุช ู ฺู ถด ุจุช).

ุจุณุงุฑ ุงุฒ ูุชุฏูุง ฺฉู ุงูุชุธุงุฑ ุฏุงุฑุฏ ุฏุฑ ฺฉูุงุณ `Array` **ูุชุฏ ููููู (Instance Method)** ุจุงุดูุฏุ ุฏุฑ ูุงูุน **ูุชุฏูุง ุงุณุชุงุชฺฉ** ูุณุชูุฏ. ุงู ุชุตูู ุทุฑุงุญ ฺฉู ุนุฌุจ ุงุณุช ู ุจู ุงู ูุนูุงุณุช ฺฉู ููฺฏุงู ุฌุณุชุฌู ฺฉ ูุชุฏ ุฏุฑ `Array` ุจุงุฏ ูู **ูุชุฏูุง ุงุณุชุงุชฺฉ** ู ูู **ูุชุฏูุง ููููู** ุฑุง ุจุฑุฑุณ ฺฉูุฏ.

---

### ุงุฌุงุฏ ู ุงูุฏฺฉุณโฺฏุฐุงุฑ ุขุฑุงูโูุง ๐๏ธ

ุณุงุฏูโุชุฑู ุฑุงู ุจุฑุง ุงุฌุงุฏ ู ุงูุฏฺฉุณ ฺฉุฑุฏู ุขุฑุงูโูุงุ ุงุณุชูุงุฏู ุงุฒ ุณุงุฎุชุงุฑูุง ุฒุจุงู C# ุงุณุช:

```csharp
int[] myArray = { 1, 2, 3 };
int first = myArray[0];
int last = myArray[myArray.Length - 1];
```

ููฺูู ูโุชูุงูุฏ ฺฉ ุขุฑุงู ุฑุง **ูพูุง (Dynamic)** ุจุง ุงุณุชูุงุฏู ุงุฒ `Array.CreateInstance` ุจุณุงุฒุฏ. ุงู ุฑูุด ุจู ุดูุง ุงูฺฉุงู ูโุฏูุฏ ููุน ุนูุตุฑ ู **ุจุนุฏ (Rank)** ุฑุง ุฏุฑ ุฒูุงู ุงุฌุฑุง ูุดุฎุต ฺฉูุฏ ู ููฺูู ุขุฑุงูโูุง **ุบุฑ ุตูุฑ-ูุจูุง** ุงุฌุงุฏ ฺฉูุฏ. ุขุฑุงูโูุง ุบุฑ ุตูุฑ-ูุจูุง ุจุง **.NET Common Language Specification (CLS)** ุณุงุฒฺฏุงุฑ ูุณุชูุฏ ู ูุจุงุฏ ุจูโุนููุงู ุงุนุถุง ุนููู ุฏุฑ ฺฉุชุงุจุฎุงููโูุง ฺฉู ููฺฉู ุงุณุช ุชูุณุท ุจุฑูุงููโุง ุฏุฑ F# ุง Visual Basic ุงุณุชูุงุฏู ุดููุฏุ ุงุฑุงุฆู ุดููุฏ.

ูุชุฏูุง `GetValue` ู `SetValue` ุงุฌุงุฒู ูโุฏููุฏ ุนูุงุตุฑ ุขุฑุงูโูุง ูพูุง ุง ูุนููู ุฑุง ุฏุณุชุฑุณ ุง ููุฏุงุฑุฏู ฺฉูุฏ:

```csharp
// ุงุฌุงุฏ ุขุฑุงู ุฑุดุชูโุง ุจุง 2 ุนูุตุฑ
Array a = Array.CreateInstance(typeof(string), 2);
a.SetValue("hi", 0);       // โ a[0] = "hi";
a.SetValue("there", 1);    // โ a[1] = "there";
string s = (string)a.GetValue(0);  // โ s = a[0];

// ุชุจุฏู ุจู ุขุฑุงู C#:
string[] cSharpArray = (string[])a;
string s2 = cSharpArray[0];
```

ุขุฑุงูโูุง ุตูุฑ-ูุจูุง ฺฉู ุจูโุตูุฑุช ูพูุง ุงุฌุงุฏ ูโุดููุฏุ ูโุชูุงููุฏ ุจู ุขุฑุงูโุง ุงุฒ ููุน ูุดุงุจู ุง **ุณุงุฒฺฏุงุฑ** ุฏุฑ C# ุชุจุฏู ุดููุฏ. ุจุฑุง ูุซุงูุ ุงฺฏุฑ `Apple` ุงุฒ `Fruit` ุงุฑุซโุจุฑ ฺฉูุฏุ ูโุชูุงู `Apple[]` ุฑุง ุจู `Fruit[]` ุชุจุฏู ฺฉุฑุฏ. ุงู ูุณุฆูู ุฏูู ุงุณุชูุงุฏู ุงุฒ ฺฉูุงุณ `Array` ุจู ุฌุง `object[]` ุจุฑุง ููุน ฺฉููุงุฎุช ุฑุง ุชูุถุญ ูโุฏูุฏุ ุฒุฑุง `object[]` ุจุง **ุขุฑุงูโูุง ฺูุฏุจุนุฏ ู Value-Type** ุณุงุฒฺฏุงุฑ ูุณุช.

`GetValue` ู `SetValue` ููฺูู ุฑู ุขุฑุงูโูุง ุณุงุฎุชู ุดุฏู ุชูุณุท ฺฉุงููพุงูุฑ ูุฒ ฺฉุงุฑ ูโฺฉููุฏ ู ุฒูุงู ฺฉู ูโุฎูุงูุฏ **ูุชุฏ ุจููุณุฏ ฺฉู ุจุง ูุฑ ููุน ู ุจุนุฏ ุงุฒ ุขุฑุงู ฺฉุงุฑ ฺฉูุฏ** ููุฏ ูุณุชูุฏ. ุจุฑุง ุขุฑุงูโูุง ฺูุฏุจุนุฏุ ุขูโูุง **ุขุฑุงูโุง ุงุฒ ุงูุฏฺฉุณโูุง** ูโูพุฐุฑูุฏ:

```csharp
public object GetValue(params int[] indices)
public void SetValue(object value, params int[] indices)
```

ูุซุงู ุฒุฑุ **ุงููู ุนูุตุฑ ูุฑ ุขุฑุงูโุง ุฑุง ุจุฏูู ุชูุฌู ุจู ุจุนุฏ ุขู ฺุงูพ ูโฺฉูุฏ**:

```csharp
void WriteFirstValue(Array a)
{
    Console.Write(a.Rank + "-dimensional; ");
    int[] indexers = new int[a.Rank]; // ุฎูุฏฺฉุงุฑ ุตูุฑ-ูุจูุง
    Console.WriteLine("First value is " + a.GetValue(indexers));
}

void Demo()
{
    int[] oneD = { 1, 2, 3 };
    int[,] twoD = { {5,6}, {8,9} };
    WriteFirstValue(oneD);   // 1-dimensional; first value is 1
    WriteFirstValue(twoD);   // 2-dimensional; first value is 5
}
```

---

ุจุฑุง **ุขุฑุงูโูุง ุจุง ููุน ูุงุดูุงุฎุชู ุงูุง ุจุนุฏ ูุดุฎุต**ุ **Generics** ุฑุงูฺฉุงุฑ ุณุงุฏูโุชุฑ ู ฺฉุงุฑุขูุฏุชุฑ ุงุฑุงุฆู ูโุฏููุฏ:

```csharp
void WriteFirstValue<T>(T[] array)
{
    Console.WriteLine(array[0]);
}
```

ูุชุฏ `SetValue` ุฏุฑ ุตูุฑุช ูุงุณุงุฒฺฏุงุฑ ุจูุฏู ููุน ุนูุตุฑ ุจุง ุขุฑุงูุ ุงุณุชุซูุง ูพุฑุชุงุจ ูโฺฉูุฏ.

ููฺฏุงู ุงุฌุงุฏ ุขุฑุงูโฺู ุจุง **ุณูุชฺฉุณ ุฒุจุงู** ู ฺู ุจุง `Array.CreateInstance`โุนูุงุตุฑ ุขุฑุงู **ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ุจู ููุฏุงุฑ ูพุดโูุฑุถุดุงู ููุฏุงุฑุฏู ูโุดููุฏ**. ุจุฑุง ุขุฑุงูโูุง Reference-Typeุ ุงู ููุฏุงุฑุฏู ุจุง `null` ุงูุฌุงู ูโุดูุฏุ ุจุฑุง ุขุฑุงูโูุง Value-Typeุ ุงุนุถุง ุจู ุตูุฑุช ุจุชโุจูโุจุช ุตูุฑ ูโุดููุฏ.

ฺฉูุงุณ `Array` ููฺูู ูุชุฏ `Clear` ุฑุง ุงุฑุงุฆู ูโุฏูุฏ ุชุง ุจูโุตูุฑุช ุงุฎุชุงุฑ ุขุฑุงู ุฑุง ูพุงฺฉุณุงุฒ ฺฉูุฏ:

```csharp
public static void Clear(Array array, int index, int length);
```

ุงู ูุชุฏ ุงูุฏุงุฒู ุขุฑุงู ุฑุง ุชุบุฑ ููโุฏูุฏุ ุจุฑ ุฎูุงู `ICollection<T>.Clear` ฺฉู ุชุนุฏุงุฏ ุนูุงุตุฑ ุฑุง ุจู ุตูุฑ ฺฉุงูุด ูโุฏูุฏ.

---

### ูพูุงุด ุขุฑุงูโูุง ๐

ุขุฑุงูโูุง ุจูโุฑุงุญุช ุจุง **foreach** ูพูุงุด ูโุดููุฏ:

```csharp
int[] myArray = { 1, 2, 3 };
foreach (int val in myArray)
    Console.WriteLine(val);
```

ููฺูู ูโุชูุงู ุงุฒ **ูุชุฏ ุงุณุชุงุชฺฉ `Array.ForEach`** ุงุณุชูุงุฏู ฺฉุฑุฏ:

```csharp
public static void ForEach<T>(T[] array, Action<T> action);
public delegate void Action<T>(T obj);
```

ูุซุงู ุจุงุฒููุณ ุดุฏู ุจุง `Array.ForEach`:

```csharp
Array.ForEach(new[] { 1, 2, 3 }, Console.WriteLine);
```

ู ุฏุฑ C# 12ุ ูโุชูุงู ุงู ุฑุง ุณุงุฏูโุชุฑ ฺฉุฑุฏ:

```csharp
Array.ForEach([1, 2, 3], Console.WriteLine);
```

### ุทูู ู ุจุนุฏ ุขุฑุงู ๐

ฺฉูุงุณ `Array` ูุชุฏูุง ู ูฺฺฏโูุง ุฒุฑ ุฑุง ุจุฑุง **ูพุฑุณโูุฌู ุฏุฑุจุงุฑู ุทูู ู ุจุนุฏ** ุขุฑุงู ุงุฑุงุฆู ูโุฏูุฏ:

```csharp
public int  GetLength(int dimension);
public long GetLongLength(int dimension);
public int  Length { get; }
public long LongLength { get; }

public int GetLowerBound(int dimension);
public int GetUpperBound(int dimension);
public int Rank { get; }    // ุชุนุฏุงุฏ ุจุนุฏูุง ุขุฑุงู ุฑุง ุจุงุฒ ูโฺฏุฑุฏุงูุฏ
```

* `GetLength` ู `GetLongLength` ุทูู ฺฉ ุจุนุฏ ูุดุฎุต (0 ุจุฑุง ุขุฑุงูโูุง ุชฺฉโุจุนุฏ) ุฑุง ุจุงุฒ ูโฺฏุฑุฏุงููุฏ.
* `Length` ู `LongLength` ุชุนุฏุงุฏ ฺฉู ุนูุงุตุฑ ุขุฑุงู ุฑุง ุฏุฑ **ุชูุงู ุงุจุนุงุฏ** ุจุงุฒูโฺฏุฑุฏุงููุฏ.
* `GetLowerBound` ู `GetUpperBound` ุฏุฑ ุขุฑุงูโูุง **ุบุฑ ุตูุฑ-ูุจูุง** ฺฉุงุฑุจุฑุฏ ุฏุงุฑูุฏ. `GetUpperBound` ููุงู ูุชุฌูโ `GetLowerBound + GetLength` ุจุฑุง ฺฉ ุจุนุฏ ูุดุฎุต ุฑุง ุจุงุฒูโฺฏุฑุฏุงูุฏ.

---

### ุฌุณุชุฌู ุฏุฑ ุขุฑุงู ๐

ฺฉูุงุณ `Array` ูุฌููุนูโุง ุงุฒ ูุชุฏูุง ุฑุง ุจุฑุง ูพุฏุง ฺฉุฑุฏู ุนูุงุตุฑ ุฏุฑ **ุขุฑุงูโูุง ุชฺฉโุจุนุฏ** ุงุฑุงุฆู ูโุฏูุฏ:

* **ูุชุฏูุง BinarySearch**
  ุจุฑุง ุฌุณุชุฌู ุณุฑุน ุฏุฑ ฺฉ ุขุฑุงู ูุฑุชุจ ุจุฑุง ฺฉ ุนูุตุฑ ูุดุฎุต.

* **ูุชุฏูุง IndexOf / LastIndexOf**
  ุจุฑุง ุฌุณุชุฌู ุขุฑุงูโูุง ูุงูุฑุชุจ ุจุฑุง ฺฉ ุนูุตุฑ ุฎุงุต.

* **ูุชุฏูุง Find / FindLast / FindIndex / FindLastIndex / FindAll / Exists / TrueForAll**
  ุจุฑุง ุฌุณุชุฌู ุขุฑุงูโูุง ูุงูุฑุชุจ ุจุฑ ุงุณุงุณ ูุนุงุฑ ฺฉ **Predicate<T>**.

ูฺฉุงุช ููู:

* ูฺโฺฉ ุงุฒ ูุชุฏูุง ุฌุณุชุฌู ุขุฑุงูุ ุฏุฑ ุตูุฑุช ูพุฏุง ูุดุฏู ุนูุตุฑุ **ุงุณุชุซูุง ูพุฑุชุงุจ ููโฺฉููุฏ**.

  * ูุชุฏูุง ฺฉู **int** ุจุงุฒูโฺฏุฑุฏุงููุฏุ ููุฏุงุฑ `-1` ุจุงุฒูโฺฏุฑุฏุงููุฏ (ูุฑุถ ุจุฑ ุตูุฑ-ูุจูุง ุจูุฏู ุขุฑุงู).
  * ูุชุฏูุง ฺฉู ููุน **Generic** ุจุงุฒูโฺฏุฑุฏุงููุฏุ ููุฏุงุฑ ูพุดโูุฑุถ ุขู ููุน ุฑุง ุจุฑูโฺฏุฑุฏุงููุฏ (ูุซูุงู `0` ุจุฑุง `int` ุง `null` ุจุฑุง `string`).

* **BinarySearch** ุณุฑุน ุงุณุชุ ุงูุง ููุท ุฑู ุขุฑุงูโูุง ูุฑุชุจ ฺฉุงุฑ ูโฺฉูุฏ ู ูุงุฒ ุฏุงุฑุฏ ุนูุงุตุฑ **ุชุฑุชุจโูพุฐุฑ ุจุงุดูุฏ**. ุงู ูุชุฏูุง ูโุชูุงููุฏ ฺฉ ุดุก `IComparer` ุง `IComparer<T>` ุฏุฑุงูุช ฺฉููุฏ ุชุง ุชุฑุชุจ ุนูุงุตุฑ ุฑุง ุชุนู ฺฉูุฏ (ุจุงุฏ ุจุง ุชุฑุชุจ ฺฉู ููฺฏุงู ูุฑุชุจโุณุงุฒ ุงููู ุงุณุชูุงุฏู ุดุฏูุ ุณุงุฒฺฏุงุฑ ุจุงุดุฏ). ุฏุฑ ุตูุฑุช ุนุฏู ุงุฑุงุฆูุ ุงูฺฏูุฑุชู ูุฑุชุจโุณุงุฒ ูพุดโูุฑุถ ููุน ุงุณุชูุงุฏู ูโุดูุฏ (ุจุฑุงุณุงุณ `IComparable` / `IComparable<T>`).

* **IndexOf / LastIndexOf** ุตุฑูุงู ุขุฑุงู ุฑุง ูพูุงุด ูโฺฉููุฏ ู ูููุนุช **ุงููู ุง ุขุฎุฑู ุนูุตุฑ ูุทุงุจู** ุฑุง ุจุงุฒูโฺฏุฑุฏุงููุฏ.

* ูุชุฏูุง ูุจุชู ุจุฑ **Predicate** ุงุฌุงุฒู ูโุฏููุฏ **Delegate** ุง **Lambda Expression** ุชุตูู ุจฺฏุฑุฏ ฺฉู ุขุง ุนูุตุฑ ูุดุฎุต ุจุง ูุนุงุฑ ููุฑุฏูุธุฑ ูุทุงุจูุช ุฏุงุฑุฏ ุง ุฎุฑ.

```csharp
public delegate bool Predicate<T>(T obj);
```

ูุซุงู:

```csharp
string[] names = { "Rodney", "Jack", "Jill" };
string match = Array.Find(names, ContainsA);
Console.WriteLine(match); // Jack

bool ContainsA(string name) { return name.Contains("a"); }
```

ููุงู ูุซุงู ุจุง **Lambda Expression**:

```csharp
string[] names = { "Rodney", "Jack", "Jill" };
string match = Array.Find(names, n => n.Contains("a")); // Jack
```

* `FindAll` ุขุฑุงูโุง ุดุงูู **ุชูุงู ุนูุงุตุฑ ูุทุงุจู ุจุง Predicate** ุจุงุฒูโฺฏุฑุฏุงูุฏ ู ูุดุงุจู `Enumerable.Where` ุฏุฑ `System.Linq` ุงุณุชุ ุจุง ุงู ุชูุงูุช ฺฉู ุฎุฑูุฌ ุจู ุตูุฑุช ุขุฑุงู ุงุณุชุ ูู `IEnumerable<T>`.

* `Exists` ุจุงุฒ ูโฺฏุฑุฏุงูุฏ `true` ุงฺฏุฑ **ูุฑ ุนุถู ุขุฑุงู** ูุนุงุฑ Predicate ุฑุง ุจุฑุขูุฑุฏู ฺฉูุฏุ ูุดุงุจู `Any` ุฏุฑ `System.Linq.Enumerable`.

* `TrueForAll` ุจุงุฒ ูโฺฏุฑุฏุงูุฏ `true` ุงฺฏุฑ **ููู ุนูุงุตุฑ** ูุนุงุฑ Predicate ุฑุง ุจุฑุขูุฑุฏู ฺฉููุฏุ ูุดุงุจู `All` ุฏุฑ `System.Linq.Enumerable`.

### ูุฑุชุจโุณุงุฒ ุขุฑุงู ๐๏ธ

ฺฉูุงุณ `Array` ฺูุฏู ูุชุฏ **ูุฑุชุจโุณุงุฒ ุฏุงุฎู** ุฏุงุฑุฏ:

```csharp
// ูุฑุชุจโุณุงุฒ ฺฉ ุขุฑุงู ุชฺฉโุจุนุฏ:
public static void Sort<T>(T[] array);
public static void Sort(Array array);

// ูุฑุชุจโุณุงุฒ ุฌูุช ุขุฑุงูโูุง:
public static void Sort<TKey,TValue>(TKey[] keys, TValue[] items);
public static void Sort(Array keys, Array items);
```

ูุฑ ฺฉ ุงุฒ ุงู ูุชุฏูุง ุจูโุตูุฑุช **Overload** ูโุชูุงููุฏ ูพุงุฑุงูุชุฑูุง ุฒุฑ ุฑุง ูู ุจฺฏุฑูุฏ:

* `int index` โ ุดุฑูุน ูุฑุชุจโุณุงุฒ ุงุฒ ุงูุฏฺฉุณ ูุดุฎุต
* `int length` โ ุชุนุฏุงุฏ ุนูุงุตุฑ ุจุฑุง ูุฑุชุจโุณุงุฒ
* `IComparer<T> comparer` โ ุดุก ุชุนูโฺฉููุฏู ุชุฑุชุจ ุนูุงุตุฑ
* `Comparison<T> comparison` โ Delegate ุชุนูโฺฉููุฏู ุชุฑุชุจ ุนูุงุตุฑ

ูุซุงู ุณุงุฏู:

```csharp
int[] numbers = { 3, 2, 1 };
Array.Sort(numbers);  // ุขุฑุงู ุญุงูุง { 1, 2, 3 }
```

ูุชุฏูุง **ุฌูุช ุขุฑุงูโุง**ุ ุนูุงุตุฑ ูุฑ ุฏู ุขุฑุงู ุฑุง **ุจูโุตูุฑุช ููโุฒูุงู ูุฑุชุจ** ูโฺฉููุฏ ู ุชุฑุชุจ ุฑุง ุจุฑุงุณุงุณ ุขุฑุงู ุงูู ุงุนูุงู ูโฺฉููุฏ:

```csharp
int[] numbers = { 3, 2, 1 };
string[] words = { "three", "two", "one" };
Array.Sort(numbers, words);
// numbers โ { 1, 2, 3 }
// words   โ { "one", "two", "three" }
```

> โ๏ธ ูฺฉุชู: `Array.Sort` ูุงุฒ ุฏุงุฑุฏ ฺฉู ุนูุงุตุฑ ุขุฑุงู `IComparable` ุฑุง ูพุงุฏูโุณุงุฒ ฺฉููุฏ. ุงฺฏุฑ ุนูุงุตุฑ ูุงุจู ููุงุณู ุฐุงุช ูุจุงุดูุฏ ุง ุจุฎูุงูุฏ ุชุฑุชุจ ูพุดโูุฑุถ ุฑุง ุชุบุฑ ุฏูุฏุ ุจุงุฏ **Comparison ุณูุงุฑุด** ุง ุดุก `IComparer<T>` ุงุฑุงุฆู ุฏูุฏ.

ูุซุงู ุจุง **Comparison Delegate**:

```csharp
public delegate int Comparison<T>(T x, T y);
```

* ุงฺฏุฑ `x` ูุจู ุงุฒ `y` ุจุงุดุฏ โ ุนุฏุฏ ููู ุจุงุฒูโฺฏุฑุฏุงูุฏ
* ุงฺฏุฑ `x` ุจุนุฏ ุงุฒ `y` ุจุงุดุฏ โ ุนุฏุฏ ูุซุจุช ุจุงุฒูโฺฏุฑุฏุงูุฏ
* ุงฺฏุฑ ุจุฑุงุจุฑ ุจุงุดูุฏ โ `0` ุจุงุฒูโฺฏุฑุฏุงูุฏ

ูุซุงู ุนูู:

```csharp
int[] numbers = { 1, 2, 3, 4, 5 };
Array.Sort(numbers, (x, y) => x % 2 == y % 2 ? 0 : x % 2 == 1 ? -1 : 1);
// numbers โ { 1, 3, 5, 2, 4 }
```

* ุจู ุฌุง `Array.Sort` ูโุชูุงูุฏ ุงุฒ **LINQ** ู ูุชุฏูุง `OrderBy` ู `ThenBy` ุงุณุชูุงุฏู ฺฉูุฏ.
  ุงู ุฑูุด **ุขุฑุงู ุงุตู ุฑุง ุชุบุฑ ููโุฏูุฏ** ู ุฎุฑูุฌ ุฑุง ุจู ุตูุฑุช ฺฉ `IEnumerable<T>` ูุฑุชุจโุดุฏู ุงุฑุงุฆู ูโุฏูุฏ.

---

### ูุนฺฉูุณ ฺฉุฑุฏู ุนูุงุตุฑ ๐

ฺฉูุงุณ `Array` ูุชุฏูุง ุจุฑุง ูุนฺฉูุณ ฺฉุฑุฏู ุชูุงู ุง ุจุฎุด ุงุฒ ุขุฑุงู ุงุฑุงุฆู ูโุฏูุฏ:

```csharp
public static void Reverse(Array array);
public static void Reverse(Array array, int index, int length);
```

---

### ฺฉูพ ฺฉุฑุฏู ุขุฑุงู ๐

ฺฉูุงุณ `Array` ฺูุงุฑ ุฑูุด ุจุฑุง **ฺฉูพ ุณุทุญ** ุฏุงุฑุฏ: `Clone`ุ `CopyTo`ุ `Copy` ู `ConstrainedCopy`

* `Clone` ู `CopyTo` โ **ูุชุฏูุง ูููููโุง**

* `Copy` ู `ConstrainedCopy` โ **ูุชุฏูุง ุงุณุชุงุชฺฉ**

* `Clone` โ ุขุฑุงู ุฌุฏุฏ (ุณุทุญ) ุจุงุฒูโฺฏุฑุฏุงูุฏ

* `CopyTo` ู `Copy` โ ุจุฎุด ูุชูุงู ุงุฒ ุขุฑุงู ุฑุง ฺฉูพ ูโฺฉููุฏ

  * ุจุฑุง ุขุฑุงูโูุง ฺูุฏุจุนุฏุ ุจุงุฏ **ุงูุฏฺฉุณ ฺูุฏุจุนุฏ ุฑุง ุจู ุงูุฏฺฉุณ ุฎุท** ุชุจุฏู ฺฉูุฏ
  * ูุซุงู: ุฎุงูู ูุณุท `[1,1]` ุฏุฑ ุขุฑุงู 3ร3 โ `1 * 3 + 1 = 4`
  * ูุญุฏูุฏูโูุง ููุจุน ู ููุตุฏ ูโุชูุงููุฏ **ูููพูุดุงู ุฏุงุดุชู ุจุงุดูุฏ** ุจุฏูู ูุดฺฉู

* `ConstrainedCopy` โ ุนููุงุช **ุงุชู**ุ ุงฺฏุฑ ููู ุนูุงุตุฑ ูุชูุงููุฏ ฺฉูพ ุดููุฏุ ุนููุงุช ุจุงุฒฺฏุฑุฏุงูุฏู ูโุดูุฏ

* `AsReadOnly` โ **Wrapper** ุจุงุฒูโฺฏุฑุฏุงูุฏ ฺฉู ุงุฒ ุชุบุฑ ุนูุงุตุฑ ุฌููฺฏุฑ ูโฺฉูุฏ

### ุชุจุฏู ู ุชุบุฑ ุงูุฏุงุฒู ุขุฑุงู ๐๐

ฺฉูุงุณ `Array` ูุชุฏูุง ุจุฑุง **ุชุจุฏู ุนูุงุตุฑ ุขุฑุงู** ู **ุชุบุฑ ุงูุฏุงุฒู ุขุฑุงู** ุงุฑุงุฆู ูโุฏูุฏ:

* `Array.ConvertAll` โ ฺฉ ุขุฑุงู ุฌุฏุฏ ุงุฒ ููุน `TOutput` ุงุฌุงุฏ ูโฺฉูุฏ ู ุนูุงุตุฑ ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ **Delegate ุชุจุฏูโฺฉููุฏู** ฺฉูพ ูโฺฉูุฏ.
  ุชุนุฑู Delegate ุจู ุดฺฉู ุฒุฑ ุงุณุช:

```csharp
public delegate TOutput Converter<TInput, TOutput>(TInput input);
```

ูุซุงู:

```csharp
float[] reals = { 1.3f, 1.5f, 1.8f };
int[] wholes = Array.ConvertAll(reals, r => Convert.ToInt32(r));
// wholes โ { 1, 2, 2 }
```

* `Array.Resize` โ ุจุง ุงุฌุงุฏ ุขุฑุงู ุฌุฏุฏ ู ฺฉูพ ุนูุงุตุฑุ ุขุฑุงู ุฑุง ุชุบุฑ ุงูุฏุงุฒู ูโุฏูุฏ ู ูุชุฌู ุฑุง ุงุฒ ุทุฑู ูพุงุฑุงูุชุฑ ูุฑุฌุน ุจุงุฒูโฺฏุฑุฏุงูุฏ.
  โ๏ธ ุชูุฌู: ุณุงุฑ ูุฑุงุฌุน ุจู ุขุฑุงู ุงุตู **ุชุบุฑ ููโฺฉููุฏ**.

> ูุถุง ูุงู `System.Linq` ูู ุชุนุฏุงุฏ ุฒุงุฏ **Extension Method** ุจุฑุง ุชุจุฏู ุขุฑุงู ุงุฑุงุฆู ูโุฏูุฏ ฺฉู ุฎุฑูุฌ ุขู `IEnumerable<T>` ุงุณุช ู ูโุชูุงู ุฏูุจุงุฑู ุจุง `ToArray` ุจู ุขุฑุงู ุชุจุฏู ฺฉุฑุฏ.

---

### ูุณุชโูุงุ ุตูโูุงุ ูพุดุชูโูุง ู ูุฌููุนูโูุง ๐๐

.NET ูุฌููุนูโุง ุงุฒ ฺฉูุงุณโูุง **ูุฌููุนูโุง ุขูุงุฏู** ุงุฑุงุฆู ูโุฏูุฏ ฺฉู ุฑุงุจุทโูุง ูุนุฑูโุดุฏู ุฏุฑ ุงู ูุตู ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉููุฏ.
ุงู ุจุฎุด ุฑู **ูุฌููุนูโูุง ุดุจู ูุณุช** ุชูุฑฺฉุฒ ุฏุงุฑุฏ ู ูู ูุฌููุนูโูุง ุฏฺฉุดูุฑุ ฺฉู ุจุนุฏุงู ุฏุฑ ูุตู ยซDictionariesยป ุจุฑุฑุณ ูโฺฉูู.

* ุจุฑุง ุงฺฉุซุฑ ฺฉูุงุณโูุงุ ูโุชูุงูุฏ ูุณุฎู **Generic** ุง **Non-Generic** ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ.
* ฺฉูุงุณโูุง Generic ุงุฒ ูุธุฑ **ุงูุนุทุงูโูพุฐุฑ ู ุนููฺฉุฑุฏ** ุจูุชุฑูุฏ ู ูุณุฎู ุบุฑุฌูุฑฺฉ ูุนูููุงู ููุท ุจุฑุง **ุณุงุฒฺฏุงุฑ ุจุง ูุณุฎูโูุง ูุฏู** ูุงุฒู ุงุณุช.
* ุงุฒ ุจู ุงู ฺฉูุงุณโูุงุ `List<T>` ูพุฑฺฉุงุฑุจุฑุฏุชุฑู ุงุณุช.

---

### ฺฉูุงุณโูุง List<T> ู ArrayList ๐

* ฺฉูุงุณ Generic `List<T>` ู Non-Generic `ArrayList` ุขุฑุงูโุง **ูพูุง** ุงุฒ ุงุดุงุก ูุฑุงูู ูโฺฉููุฏ.
* `ArrayList` โ ูพุงุฏูโุณุงุฒ `IList`
* `List<T>` โ ูพุงุฏูโุณุงุฒ `IList` ู `IList<T>` (ู ูุณุฎู ููุท ุฎูุงูุฏู `IReadOnlyList<T>`)

> ุชูุงูุช ุจุง ุขุฑุงูโูุง: ุชูุงู ุงู ุฑุงุจุทโูุง **ุนููู ูพุงุฏูโุณุงุฒ** ุดุฏูโุงูุฏ ู ูุชุฏูุง ูุงููุฏ `Add` ู `Remove` **ูุณุชููุงู ูุงุจู ุงุณุชูุงุฏู** ูุณุชูุฏ.

#### ุฌุฒุฆุงุช ุฏุงุฎู

* `List<T>` ู `ArrayList` ฺฉ **ุขุฑุงู ุฏุงุฎู** ุฏุงุฑูุฏ ฺฉู ููฺฏุงู ูพุฑ ุดุฏูุ ุฌุงฺฏุฒู ุจุง ุขุฑุงู ุจุฒุฑฺฏโุชุฑ ูโุดูุฏ.
* ุงูุฒูุฏู ุนูุตุฑ โ ุณุฑุน (ูุนูููุงู ุฌุง ุฎุงู ุฏุฑ ุงูุชูุง ูุฌูุฏ ุฏุงุฑุฏ)
* ุฏุฑุฌ ุนูุตุฑ โ ฺฉูุฏ (ฺูู ููู ุนูุงุตุฑ ุจุนุฏ ุงุฒ ููุทู ุฏุฑุฌ ุจุงุฏ ุฌุงุจุฌุง ุดููุฏ)
* ุญุฐู ุนูุตุฑ โ ฺฉูุฏุ ุจูโุฎุตูุต ุฏุฑ ุงุจุชุฏุง ุขุฑุงู
* ุฌุณุชุฌู โ ุณุฑุน ุจุง `BinarySearch`ุ ุฏุฑ ุบุฑ ุงู ุตูุฑุช ฺฉูุฏ (ฺูู ุจุงุฏ ููู ุนูุงุตุฑ ุจุฑุฑุณ ุดููุฏ)

> ุงฺฏุฑ `T` ฺฉ ููุน ููุฏุงุฑ (Value Type) ุจุงุดุฏุ `List<T>` ฺูุฏู ุจุฑุงุจุฑ ุณุฑุนโุชุฑ ุงุฒ `ArrayList` ุงุณุชุ ฺูู ุงุฒ **Boxing/Unboxing** ุฌููฺฏุฑ ูโฺฉูุฏ.

---

### ุณุงุฒูุฏูโูุง ู ูุชุฏูุง ููู `List<T>` โ๏ธ

```csharp
public class List<T> : IList<T>, IReadOnlyList<T>
{
  public List();                          // ุขุฑุงู ุฎุงู
  public List(IEnumerable<T> collection); // ฺฉูพ ุงุฒ ูุฌููุนู ููุฌูุฏ
  public List(int capacity);               // ูุดุฎุต ฺฉุฑุฏู ุธุฑูุช ุงููู

  // ุงูุฒูุฏู ู ุฏุฑุฌ
  public void Add(T item);
  public void AddRange(IEnumerable<T> collection);
  public void Insert(int index, T item);
  public void InsertRange(int index, IEnumerable<T> collection);

  // ุญุฐู
  public bool Remove(T item);
  public void RemoveAt(int index);
  public void RemoveRange(int index, int count);
  public int RemoveAll(Predicate<T> match);

  // ุฏุณุชุฑุณ ุจุง ุงูุฏฺฉุณ
  public T this[int index] { get; set; }
  public List<T> GetRange(int index, int count);
  public Enumerator<T> GetEnumerator();

  // ฺฉูพ ู ุชุจุฏู
  public T[] ToArray();
  public void CopyTo(T[] array);
  public void CopyTo(T[] array, int arrayIndex);
  public void CopyTo(int index, T[] array, int arrayIndex, int count);
  public ReadOnlyCollection<T> AsReadOnly();
  public List<TOutput> ConvertAll<TOutput>(Converter<T,TOutput> converter);

  // ุณุงุฑ ูุชุฏูุง
  public void Reverse();      // ูุนฺฉูุณ ฺฉุฑุฏู ุชุฑุชุจ ุนูุงุตุฑ
  public int Capacity { get; set; }  // ฺฏุณุชุฑุด ุขุฑุงู ุฏุงุฎู
  public void TrimExcess();   // ฺฉุงูุด ุขุฑุงู ุฏุงุฎู ุจู ุงูุฏุงุฒู ูุงูุน
  public void Clear();        // ุญุฐู ุชูุงู ุนูุงุตุฑุ Count=0
}
```

* `List<T>` ููฺูู **ูุณุฎูโูุง ูููููโุง ุชูุงู ูุชุฏูุง ุฌุณุชุฌู ู ูุฑุชุจโุณุงุฒ ุขุฑุงู** ุฑุง ุฏุงุฑุฏ.

---

### ูุซุงู ุนูู ุจุง List<T> ๐ฏ

```csharp
var words = new List<string>();          // ูุณุช ุฑุดุชูโุง
words.Add("melon");
words.Add("avocado");
words.AddRange(["banana", "plum"]);
words.Insert(0, "lemon");                // ุฏุฑุฌ ุฏุฑ ุงุจุชุฏุง
words.InsertRange(0, ["peach", "nashi"]); // ุฏุฑุฌ ฺูุฏฺฏุงูู ุฏุฑ ุงุจุชุฏุง
words.Remove("melon");
words.RemoveAt(3);                        // ุญุฐู ุนูุตุฑ ฺูุงุฑู
words.RemoveRange(0, 2);                  // ุญุฐู ุฏู ุนูุตุฑ ุงูู
words.RemoveAll(s => s.StartsWith("n")); // ุญุฐู ุชูุงู ุฑุดุชูโูุง ุจุง ุดุฑูุน 'n'

Console.WriteLine(words[0]);              // ุงููู ุนูุตุฑ
Console.WriteLine(words[words.Count-1]);  // ุขุฎุฑู ุนูุตุฑ
foreach(string s in words) Console.WriteLine(s); // ุชูุงู ุนูุงุตุฑ

List<string> subset = words.GetRange(1, 2);      // ุงุฒ ุฏูู ุชุง ุณูู
string[] wordsArray = words.ToArray();          // ุชุจุฏู ุจู ุขุฑุงู
string[] existing = new string[1000];
words.CopyTo(0, existing, 998, 2);             // ฺฉูพ ุฏู ุนูุตุฑ ุงูู ุจู ุขุฑุงู ููุฌูุฏ
List<string> upperCaseWords = words.ConvertAll(s => s.ToUpper());
List<int> lengths = words.ConvertAll(s => s.Length);
```

---

### ุชูุงูุช ุจุง ArrayList โ๏ธ

```csharp
ArrayList al = new ArrayList();
al.Add("hello");
string first = (string)al[0];              // ูุงุฒ ุจู cast
string[] strArr = (string[])al.ToArray(typeof(string));
```

* ฺูู castูุง ุชูุณุท ฺฉุงููพุงูุฑ **ฺฺฉ ููโุดููุฏ** ู ููฺฉู ุงุณุช ุฏุฑ ุฒูุงู ุงุฌุฑุง ุฎุทุง ุจุฏููุฏ:

```csharp
int first = (int)al[0]; // Exception ุฏุฑ ุฒูุงู ุงุฌุฑุง
```

* `ArrayList` ูุดุงุจู `List<object>` ุนูู ูโฺฉูุฏ ู ุจุฑุง **ูุณุชโูุง ฺูุฏ ููุน** ููุงุณุจ ุงุณุช.
* ูุฒุช ุงูุชุฎุงุจ `ArrayList` ุฏุฑ ุงู ุญุงูุช: **ุณูููุช ุงุณุชูุงุฏู ุจุง Reflection** ูุณุจุช ุจู `List<object>`

> ุงฺฏุฑ `System.Linq` ุฑุง ูุงุฑุฏ ฺฉูุฏุ ูโุชูุงูุฏ ฺฉ `ArrayList` ุฑุง ุจู ฺฉ `List<T>` ุฌูุฑฺฉ ุชุจุฏู ฺฉูุฏ:

```csharp
ArrayList al = new ArrayList();
al.AddRange(new[] { 1, 5, 9 });
List<int> list = al.Cast<int>().ToList();
```

* `Cast` ู `ToList` ูุชุฏูุง **Extension** ุฏุฑ `System.Linq.Enumerable` ูุณุชูุฏ.

### LinkedList<T> ๐

`LinkedList<T>` ฺฉ **ูุณุช ูพููุฏ ุฏูุทุฑูู (doubly linked list)** ุฌูุฑฺฉ ุงุณุช.

#### ุณุงุฎุชุงุฑ

* ุดุงูู **ฺฏุฑูโูุง (nodes)** ุงุณุช ฺฉู ูุฑ ฺฏุฑู ุดุงูู ุณู ฺุฒ ุงุณุช:

  1. **ููุฏุงุฑ (Value)**
  2. **ุงุฑุฌุงุน ุจู ฺฏุฑู ูุจู (Previous)**
  3. **ุงุฑุฌุงุน ุจู ฺฏุฑู ุจุนุฏ (Next)**

> ุดฺฉู ุณุงุฏู:

```
null <- [Node1] <-> [Node2] <-> [Node3] -> null
```

#### ูุฒุช ุงุตู

* ุฏุฑุฌ ุนูุตุฑ ุฏุฑ ูุฑ ููุทู ุงุฒ ูุณุช **ุจุณุงุฑ ุณุฑุน ู ฺฉุงุฑุขูุฏ** ุงุณุชุ ุฒุฑุง ููุท ฺฉุงูุณุช ฺฉ ฺฏุฑู ุฌุฏุฏ ุจุณุงุฒุฏ ู ฺูุฏ ุงุฑุฌุงุน ุฑุง ุจูโุฑูุฒุฑุณุงู ฺฉูุฏ.

#### ูุญุฏูุฏุช

* **ุฏุณุชุฑุณ ูุณุชูู ุจุง ุงูุฏฺฉุณ ูุฌูุฏ ูุฏุงุฑุฏ**.
* ุจุฑุง ุงูุชู ูฺฉุงู ุฏุฑุฌ ุง ุฌุณุชุฌู ฺฉ ุนูุตุฑุ ุจุงุฏ ุงุฒ ุงุจุชุฏุง ุง ุงูุชูุง ูุณุช ูพูุงุด ฺฉูุฏ.
* **ุฌุณุชุฌู ุจุงูุฑ ุง ุฏุณุชุฑุณ ุชุตุงุฏู ุจู ุนูุงุตุฑ ุงูฺฉุงูโูพุฐุฑ ูุณุช**.

> ุจูุงุจุฑุงู `LinkedList<T>` ุฒูุงู ููุงุณุจ ุงุณุช ฺฉู **ุนููุงุช ุฏุฑุฌ ู ุญุฐู ุฏุฑ ูุงูู ูุณุช** ุฒุงุฏ ุงูุฌุงู ูโุดูุฏ ู ูุงุฒ ุจู **ุฏุณุชุฑุณ ูุณุชูู ุจู ุนูุงุตุฑ ฺฉูุชุฑ** ุงุณุช.
<div align="center">

![Conventions-UsedThis-Book](../../../assets/image/07/Table-7-5.jpeg)
</div>

### LinkedList<T> ๐ โ ุงุฏุงูู

`LinkedList<T>` ูพุงุฏูโุณุงุฒ ูโุดูุฏ ุงุฒ **IEnumerable<T> ู ICollection<T>** (ู ูุณุฎูโูุง ุบุฑุฌูุฑฺฉ ุขูโูุง) ุงูุง **IList<T> ูพุงุฏูโุณุงุฒ ููโุดูุฏ**ุ ฺูู **ุฏุณุชุฑุณ ุจุฑ ุงุณุงุณ ุงูุฏฺฉุณ ูพุดุชุจุงู ููโุดูุฏ**.

#### ฺฏุฑูโูุง

ฺฏุฑูโูุง ูุณุช ุจุง ฺฉูุงุณ ุฒุฑ ูพุงุฏูโุณุงุฒ ูโุดููุฏ:

```csharp
public sealed class LinkedListNode<T>
{
  public LinkedList<T> List { get; }      // ุงุฑุฌุงุน ุจู ูุณุช ูุงูุฏ
  public LinkedListNode<T> Next { get; }  // ฺฏุฑู ุจุนุฏ
  public LinkedListNode<T> Previous { get; } // ฺฏุฑู ูุจู
  public T Value { get; set; }            // ููุฏุงุฑ ุฐุฎุฑูโุดุฏู
}
```

#### ุงูุฒูุฏู ฺฏุฑูโูุง

ูโุชูุงูุฏ ูููุนุช ฺฏุฑู ุฌุฏุฏ ุฑุง **ูุณุจุช ุจู ฺฏุฑูโุง ุฏฺฏุฑ** ุง **ุฏุฑ ุงุจุชุฏุง/ุงูุชูุง ูุณุช** ูุดุฎุต ฺฉูุฏ:

```csharp
public void AddFirst(LinkedListNode<T> node);
public LinkedListNode<T> AddFirst(T value);
public void AddLast(LinkedListNode<T> node);
public LinkedListNode<T> AddLast(T value);
public void AddAfter(LinkedListNode<T> node, LinkedListNode<T> newNode);
public LinkedListNode<T> AddAfter(LinkedListNode<T> node, T value);
public void AddBefore(LinkedListNode<T> node, LinkedListNode<T> newNode);
public LinkedListNode<T> AddBefore(LinkedListNode<T> node, T value);
```

#### ุญุฐู ฺฏุฑูโูุง

ูุชุฏูุง ูุดุงุจู ุจุฑุง ุญุฐู ุนูุงุตุฑ ูุฌูุฏ ุฏุงุฑุฏ:

```csharp
public void Clear();
public void RemoveFirst();
public void RemoveLast();
public bool Remove(T value);
public void Remove(LinkedListNode<T> node);
```

#### ุฎูุงุต ุนููู

ูุณุช ุฏุงุฎู LinkedList<T> ุดุงูู **ุชุนุฏุงุฏ ุนูุงุตุฑ** ู **ุณุฑ ู ุชู ูุณุช** ุงุณุช ู ุจุง ุฎูุงุต ุฒุฑ ุฏุฑ ุฏุณุชุฑุณ ูุฑุงุฑ ุฏุงุฑุฏ:

```csharp
public int Count { get; }                     // ุณุฑุน
public LinkedListNode<T> First { get; }       // ุณุฑุน
public LinkedListNode<T> Last { get; }        // ุณุฑุน
```

#### ุฌุณุชุฌู

LinkedList<T> ูุชุฏูุง ุฌุณุชุฌู ุฒุฑ ุฑุง ุงุฑุงุฆู ูโุฏูุฏ (ุจุง ูพูุงุด ุฏุงุฎู ูุณุช):

```csharp
public bool Contains(T value);
public LinkedListNode<T> Find(T value);
public LinkedListNode<T> FindLast(T value);
```

#### ฺฉูพ ู ูพูุงุด

ุจุฑุง ูพุฑุฏุงุฒุด ุงูุฏฺฉุณโุจูุฏโุดุฏู ู ุงุณุชูุงุฏู ุงุฒ `foreach`:

```csharp
public void CopyTo(T[] array, int index);
public Enumerator<T> GetEnumerator();
```

#### ูุซุงู ุนูู

```csharp
var tune = new LinkedList<string>();
tune.AddFirst("do");                            // do
tune.AddLast("so");                             // do - so
tune.AddAfter(tune.First, "re");                // do - re - so
tune.AddAfter(tune.First.Next, "mi");           // do - re - mi - so
tune.AddBefore(tune.Last, "fa");                // do - re - mi - fa - so
tune.RemoveFirst();                             // re - mi - fa - so
tune.RemoveLast();                              // re - mi - fa
LinkedListNode<string> miNode = tune.Find("mi");
tune.Remove(miNode);                            // re - fa
tune.AddFirst(miNode);                          // mi - re - fa

foreach (string s in tune) 
    Console.WriteLine(s);
```

> ุงู ูุซุงู ูุดุงู ูโุฏูุฏ ฺฺฏููู ูโุชูุงู ุนูุงุตุฑ ุฑุง ุงุถุงููุ ุญุฐู ู ุฌุณุชุฌู ฺฉุฑุฏ ู ุงุฒ ูพูุงุด foreach ุจุฑุง ฺุงูพ ุงุณุชูุงุฏู ฺฉุฑุฏ.
>
### Queue<T> ู Stack<T> โณ๐

#### Queue<T> โ ุตู (FIFO)

`Queue<T>` ู ูุณุฎู ุบุฑุฌูุฑฺฉ `Queue` ูพุงุฏูโุณุงุฒ ูโุดููุฏ ุงุฒ **Enumerable ู ICollection** ู ููุงูุฏู ฺฉ ุณุงุฎุชุงุฑ ุฏุงุฏู **First-In-First-Out (FIFO)** ูุณุชูุฏ:

* **Enqueue(T item)** โ ุงุถุงูู ฺฉุฑุฏู ุจู ุงูุชูุง ุตู
* **Dequeue()** โ ุญุฐู ู ุจุงุฒฺฏุฑุฏุงูุฏู ุนูุตุฑ ุงุฒ ุงุจุชุฏุง ุตู
* **Peek()** โ ูุดุงูุฏู ุนูุตุฑ ุงุจุชุฏุง ุตู ุจุฏูู ุญุฐู ุขู
* **Count** โ ุชุนุฏุงุฏ ุนูุงุตุฑ ููุฌูุฏ
* **ToArray()** โ ฺฉูพ ุนูุงุตุฑ ุจู ฺฉ ุขุฑุงู ุจุฑุง ุฏุณุชุฑุณ ุชุตุงุฏู

ูุซุงู:

```csharp
var q = new Queue<int>();
q.Enqueue(10);
q.Enqueue(20);
int[] data = q.ToArray();       // ฺฉูพ ุจู ุขุฑุงู
Console.WriteLine(q.Count);     // 2
Console.WriteLine(q.Peek());    // 10
Console.WriteLine(q.Dequeue()); // 10
Console.WriteLine(q.Dequeue()); // 20
Console.WriteLine(q.Dequeue()); // Exception (ุตู ุฎุงู)
```

> ุตูโูุง ูุนูููุงู ุจุง ุขุฑุงู ุฏุงุฎู ูพุงุฏูโุณุงุฒ ูโุดููุฏ ู ุงูุฏุณโูุง ุณุฑ ู ุชู ุตู ุจุงุนุซ ุณุฑุน ุจูุฏู ุนููุงุช Enqueue/Dequeue ูโุดููุฏ.

---

#### Stack<T> โ ูพุดุชู (LIFO)

`Stack<T>` ู ูุณุฎู ุบุฑุฌูุฑฺฉ `Stack` ููุงูุฏู ฺฉ ุณุงุฎุชุงุฑ ุฏุงุฏู **Last-In-First-Out (LIFO)** ูุณุชูุฏ:

* **Push(T item)** โ ุงูุฒูุฏู ุจู ุจุงูุง ูพุดุชู
* **Pop()** โ ุญุฐู ู ุจุงุฒฺฏุฑุฏุงูุฏู ุนูุตุฑ ุงุฒ ุจุงูุง ูพุดุชู
* **Peek()** โ ูุดุงูุฏู ุนูุตุฑ ุจุงูุง ูพุดุชู ุจุฏูู ุญุฐู ุขู
* **Count** โ ุชุนุฏุงุฏ ุนูุงุตุฑ
* **ToArray()** โ ฺฉูพ ุนูุงุตุฑ ุจุฑุง ุฏุณุชุฑุณ ุชุตุงุฏู

ูุซุงู:

```csharp
var s = new Stack<int>();
s.Push(1);                      // Stack = 1
s.Push(2);                      // Stack = 1,2
s.Push(3);                      // Stack = 1,2,3
Console.WriteLine(s.Count);     // 3
Console.WriteLine(s.Peek());    // 3
Console.WriteLine(s.Pop());     // 3
Console.WriteLine(s.Pop());     // 2
Console.WriteLine(s.Pop());     // 1
Console.WriteLine(s.Pop());     // Exception
```

> ูพุดุชูโูุง ูู ูุดุงุจู ุตูโูุง ุจุง ุขุฑุงู ุฏุงุฎู ูพุงุฏูโุณุงุฒ ูโุดููุฏ ู ุฏุฑ ุตูุฑุช ูุงุฒ ุจู ุชุบุฑ ุงูุฏุงุฒูุ ุขุฑุงู ุฏุงุฎู ุจุฒุฑฺฏโุชุฑ ุฌุงฺฏุฒู ูโุดูุฏ.

---

#### BitArray โ ุขุฑุงู ุจุช ๐ขโซ

`BitArray` ฺฉ **ูุฌููุนู ุฏูุงูฺฉ ุงุฒ ููุงุฏุฑ bool** ุงุณุช ฺฉู **ูุฑ ุนูุตุฑ ููุท ฺฉ ุจุช ุญุงูุธู ุงุดุบุงู ูโฺฉูุฏ** ู ูุณุจุช ุจู ุขุฑุงู ูุนููู bool ุง List<bool> ุจุณุงุฑ ุญุงูุธูโฺฉุงุฑุขูุฏ ุงุณุช.

* ุฏุณุชุฑุณ ุจู ุจุชโูุง ุจุง **Indexer**:

```csharp
var bits = new BitArray(2);
bits[1] = true;
```

* ุนููุงุชโูุง ุจุช ุจู ุจุช: **And, Or, Xor, Not**

```csharp
bits.Xor(bits);               // XOR ุจุชโูุง ุจุง ุฎูุฏุดุงู
Console.WriteLine(bits[1]);   // False
```

> BitArray ุจุฑุง ุฐุฎุฑู ู ูพุฑุฏุงุฒุด ูุฌููุนูโูุง ุจุฒุฑฺฏ ุจุช ุจุณุงุฑ ููุงุณุจ ุงุณุช.

### HashSet<T> ู SortedSet<T> ๐น๐ธ

#### ูฺฺฏโูุง ูุดุชุฑฺฉ

`HashSet<T>` ู `SortedSet<T>` ูุฌููุนูโูุง ุงุฒ ุนูุงุตุฑ ฺฉุชุง ูุณุชูุฏ ฺฉู ฺูุฏ ูฺฺฏ ููู ุฏุงุฑูุฏ:

* **Contains** ุจุณุงุฑ ุณุฑุน ุจุง ุงุณุชูุงุฏู ุงุฒ **hash lookup** ุงุฌุฑุง ูโุดูุฏ.
* **ุนูุงุตุฑ ุชฺฉุฑุงุฑ ุฐุฎุฑู ููโุดููุฏ** ู ุงุถุงูู ฺฉุฑุฏู ุชฺฉุฑุงุฑ ูุงุฏุฏู ฺฏุฑูุชู ูโุดูุฏ.
* **ุฏุณุชุฑุณ ุจู ุนูุตุฑ ุจุง ูููุนุช (index) ุงูฺฉุงูโูพุฐุฑ ูุณุช.**

#### ุชูุงูุช ุงุตู

* `SortedSet<T>` ุนูุงุตุฑ ุฑุง ูุฑุชุจ ูฺฏู ูโุฏุงุฑุฏ.
* `HashSet<T>` ุชุฑุชุจ ุนูุงุตุฑ ุฑุง ุญูุธ ููโฺฉูุฏ.

ูุฑ ุฏู ูพุงุฏูโุณุงุฒ `ISet<T>`, `ICollection<T>` ู ุงุฒ .NET 5 ุจู ุจุนุฏ `IReadOnlySet<T>` ุฑุง ุฏุงุฑูุฏ.

* `HashSet<T>` โ ุจุง **Hashtable** ูพุงุฏูโุณุงุฒ ูโุดูุฏ.
* `SortedSet<T>` โ ุจุง **Red-Black Tree** ูพุงุฏูโุณุงุฒ ูโุดูุฏ.

ูุชุฏูุง ูพุงู ุดุงูู `Contains`, `Add`, `Remove` ู `RemoveWhere` ูุณุชูุฏ.

---

#### ูุซุงู HashSet<T>

```csharp
var letters = new HashSet<char>("the quick brown fox");
Console.WriteLine(letters.Contains('t')); // true
Console.WriteLine(letters.Contains('j')); // false

foreach (char c in letters)
    Console.Write(c); // ุนูุงุตุฑ ุจุฏูู ุชฺฉุฑุงุฑ: the quickbrownfx
```

---

#### ุนููุงุช ูุฌููุนูโุง (Set Operations)

**ุชุบุฑ ุฏููุฏู ูุฌููุนู (Destructive):**

* `UnionWith(IEnumerable<T> other)` โ ุชุฑฺฉุจ
* `IntersectWith(IEnumerable<T> other)` โ ุงุดุชุฑุงฺฉ
* `ExceptWith(IEnumerable<T> other)` โ ุญุฐู ุนูุงุตุฑ ูุดุฎุต
* `SymmetricExceptWith(IEnumerable<T> other)` โ ููุท ุนูุงุตุฑ ฺฉุชุง ุฏุฑ ฺฉ ุงุฒ ูุฌููุนูโูุง

ูุซุงู:

```csharp
var letters = new HashSet<char>("the quick brown fox");
letters.IntersectWith("aeiou"); // ููุท ุญุฑูู ุตุฏุงุฏุงุฑ
foreach (char c in letters) Console.Write(c); // euio
```

* ุฑูุดโูุง **ุบุฑุชุบุฑ (Non-destructive)** ุจุฑุง ุจุฑุฑุณ ูุฌููุนู:
  `IsSubsetOf`, `IsProperSubsetOf`, `IsSupersetOf`, `IsProperSupersetOf`, `Overlaps`, `SetEquals`

---

#### SortedSet<T> ูฺฺฏโูุง ุงุถุงูู

* `GetViewBetween(T lowerValue, T upperValue)` โ ุจุงุฒู ุงุฒ ุนูุงุตุฑ
* `Reverse()` โ ุจุงุฒฺฏุฑุฏุงูุฏู ุชุฑุชุจ ูุนฺฉูุณ
* `Min` ู `Max` โ ฺฉูฺฺฉโุชุฑู ู ุจุฒุฑฺฏโุชุฑู ุนูุตุฑ
* ูพุฐุฑุด `IComparer<T>` ุฏุฑ ุณุงุฒูุฏู ุจุฑุง ุณูุงุฑุดโุณุงุฒ ุชุฑุชุจ

ูุซุงู:

```csharp
var letters = new SortedSet<char>("the quick brown fox");
foreach (char c in letters) Console.Write(c); // bcefhiknoqrtuwx
foreach (char c in letters.GetViewBetween('f', 'i'))
    Console.Write(c); // fhi
```

---

### ูฺฉุชู ููู

* ูุฑ ุฏู ูุฌููุนู ูุงุจู ุชฺฉุฑุงุฑ (`IEnumerable<T>`) ูุณุชูุฏุ ุจูุงุจุฑุงู ูโุชูุงู ูุฑ ููุน ูุฌููุนู ุง ูุณุช ุฑุง ุจู ุนููุงู ุขุฑฺฏููุงู ุฏุฑ ุนููุงุช ูุฌููุนูโุง ุงุณุชูุงุฏู ฺฉุฑุฏ.

<div align="center">

![Conventions-UsedThis-Book](../../../assets/image/07/Table-7-6.jpeg)
</div>

ุฏุฑ **ููุงุฏ Big-O**ุ ุฒูุงู ุจุงุฒุงุจ (retrieval) ุจุฑ ุงุณุงุณ ฺฉูุฏ ุจุฑุง ุงููุงุน ุฏฺฉุดูุฑโูุง ุจู ุดุฑุญ ุฒุฑ ุงุณุช:

| ุณุงุฎุชุงุฑ ุฏุงุฏู                                              | ุฒูุงู ุจุงุฒุงุจ (Big-O)                         |
| -------------------------------------------------------- | -------------------------------------------- |
| **Hashtable**, **Dictionary**, **OrderedDictionary**     | O(1) โ ุชูุฑุจุงู ููุฑ                          |
| **SortedDictionary**, **SortedList**                     | O(log n) โ ูฺฏุงุฑุชู                          |
| **ListDictionary** ู ุงููุงุน ุบุฑ ุฏฺฉุดูุฑ ูุงููุฏ **List<T>** | O(n) โ ุฎุทุ ุนู ุจุงุฏ ููู ุนูุงุตุฑ ุฑุง ุจุฑุฑุณ ฺฉุฑุฏ |

**ุชูุถุญ:**

* `n` ุชุนุฏุงุฏ ุนูุงุตุฑ ููุฌูุฏ ุฏุฑ ูุฌููุนู ุงุณุช.
* ุฏฺฉุดูุฑโูุง ูุจุชู ุจุฑ ูุด (Hashtable, Dictionary) ุชูุฑุจุงู ุซุงุจุช ูุณุชูุฏ ฺูู ุงุฒ hashing ุจุฑุง ุงูุชู ฺฉูุฏ ุงุณุชูุงุฏู ูโฺฉููุฏ.
* ุฏฺฉุดูุฑโูุง ูุฑุชุจ (SortedDictionary/SortedList) ุงุฒ ุฏุฑุฎุช ุง ุณุงุฎุชุงุฑ ูุฑุชุจ ุงุณุชูุงุฏู ูโฺฉููุฏุ ุจูุงุจุฑุงู ุฌุณุชุฌู ูฺฏุงุฑุชู ุงุณุช.
* ูุณุชโูุง ุณุงุฏู ุง ListDictionary ุจุงุฏ ุนูุตุฑ ุจู ุนูุตุฑ ุฌุณุชุฌู ฺฉููุฏุ ุจูุงุจุฑุงู ุฒูุงู ุจุงุฒุงุจ ุฎุท ุงุณุช.

ุฏุฑ ุงู ุจุฎุดุ ุชูุถุญ ุฏุงุฏู ุดุฏู ฺฉู **IDictionary\<TKey, TValue>** ู ูุณุฎูโ ุบุฑุฌูุฑฺฉ ุขู **IDictionary** ฺฺฏููู ฺฉุงุฑ ูโฺฉููุฏ ู ฺฉูุงุณโูุง ูุนููู ูุงููุฏ **Dictionary\<TKey, TValue>** ู **Hashtable** ุงุฒ ฺู ูฺฉุงูุณู ุงุณุชูุงุฏู ูโฺฉููุฏ. ุฏุฑ ุงุฏุงูู ุฎูุงุตู ู ูฺฉุงุช ููู ุขูุฑุฏู ุดุฏู ุงุณุช:

---

### ฑ. ุฑุงุจุท IDictionary\<TKey,TValue>

ุฑุงุจุท **IDictionary\<TKey,TValue>** ุงุณุชุงูุฏุงุฑุฏ ุจุฑุง ูุฌููุนูโูุง ฺฉูุฏ/ููุฏุงุฑ ุงุฑุงุฆู ูโุฏูุฏ ู ุงูฺฉุงูุงุช ุฒุฑ ุฑุง ุฏุงุฑุฏ:

```csharp
public interface IDictionary<TKey, TValue> : ICollection<KeyValuePair<TKey, TValue>>, IEnumerable
{
    bool ContainsKey(TKey key);
    bool TryGetValue(TKey key, out TValue value);
    void Add(TKey key, TValue value);
    bool Remove(TKey key);
    TValue this[TKey key] { get; set; } // ุฏุณุชุฑุณ ุจู ููุฏุงุฑ ุจุฑ ุงุณุงุณ ฺฉูุฏ
    ICollection<TKey> Keys { get; }     // ูุฌููุนู ฺฉูุฏูุง
    ICollection<TValue> Values { get; } // ูุฌููุนู ููุงุฏุฑ
}
```

* **Add**: ฺฉ ุนูุตุฑ ุฌุฏุฏ ุงุถุงูู ูโฺฉูุฏุ ุงฺฏุฑ ฺฉูุฏ ุชฺฉุฑุงุฑ ุจุงุดุฏุ ุงุณุชุซูุงุก ูโุฏูุฏ.
* **Indexer (`this[TKey]`)**: ุงฺฏุฑ ฺฉูุฏ ููุฌูุฏ ูุจุงุดุฏุ ุงุณุชุซูุงุก ูพุฑุชุงุจ ูโฺฉูุฏ.
* **TryGetValue**: ุณุน ูโฺฉูุฏ ููุฏุงุฑ ุฑุง ุฏุฑุงูุช ฺฉูุฏุ ุงฺฏุฑ ฺฉูุฏ ูุจุงุดุฏ `false` ุจุฑูโฺฏุฑุฏุงูุฏ.
* **ContainsKey**: ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ฺฉูุฏ ูุฌูุฏ ุฏุงุฑุฏ ุง ูู.

---

### ฒ. ุฑุงุจุท IReadOnlyDictionary\<TKey,TValue>

* ููุท ุฏุณุชุฑุณ ุฎูุงูุฏู (Read-Only) ุจู ุงุนุถุง ุฏฺฉุดูุฑ ุฑุง ุงุฑุงุฆู ูโุฏูุฏ.

---

### ณ. ูุณุฎู ุบุฑุฌูุฑฺฉ IDictionary

* ููฺฏุงู ุฏุณุชุฑุณ ุจู ฺฉูุฏ ุบุฑููุฌูุฏ ุจุง **indexer** ููุฏุงุฑ `null` ุจุงุฒูโฺฏุฑุฏุงูุฏ (ุจู ุฌุง ุงุณุชุซูุงุก).
* ุงุฒ ูุชุฏ **Contains** ุจุฑุง ุจุฑุฑุณ ูุฌูุฏ ฺฉูุฏ ุงุณุชูุงุฏู ูโฺฉูุฏ.
* ููฺฏุงู enumerationุ ุงุฒ ุณุงุฎุชุงุฑ **DictionaryEntry** ุงุณุชูุงุฏู ูโฺฉูุฏ:

```csharp
public struct DictionaryEntry
{
    public object Key { get; set; }
    public object Value { get; set; }
}
```

---

### ด. Dictionary\<TKey,TValue> ู Hashtable

* **Dictionary\<TKey,TValue>** ฺฉูุงุณ ุนููู ู ูพุฑฺฉุงุฑุจุฑุฏ ุงุณุชุ ูุจุชู ุจุฑ **Hashtable**.
* ูุณุฎู ุบุฑุฌูุฑฺฉ ุขู **Hashtable** ุงุณุช.
* ฺฉูุฏูุง ุจุง ุงุณุชูุงุฏู ุงุฒ **GetHashCode** ุจู ูุด ุชุจุฏู ูโุดููุฏ ู ุณูพุณ ุฏุฑ "bucket" ููุงุณุจ ูุฑุงุฑ ูโฺฏุฑูุฏ.
* ุงฺฏุฑ ฺูุฏ ููุฏุงุฑ ุฏุฑ ฺฉ bucket ุจุงุดูุฏุ ุฌุณุชุฌู ุฎุท ุฏุฑ ุขู bucket ุงูุฌุงู ูโุดูุฏ.
* ฺฉูุฏูุง ุจุงุฏ ูุงุจูุช ูุญุงุณุจู hash ู ุจุฑุฑุณ ุจุฑุงุจุฑ ุฑุง ุฏุงุดุชู ุจุงุดูุฏ.

#### ูุซุงู ุงุณุชูุงุฏู ุงุฒ Dictionary\<TKey,TValue>

```csharp
var d = new Dictionary<string,int>();
d.Add("One", 1);
d["Two"] = 2;     // ุงุถุงูู ฺฉุฑุฏู
d["Two"] = 22;    // ุจุฑูุฒุฑุณุงู
Console.WriteLine(d["Two"]);               // 22
Console.WriteLine(d.ContainsKey("One"));   // true
int val = 0;
if (!d.TryGetValue("onE", out val))
    Console.WriteLine("No val");           // "No val"
```

* ฺฉูุฏูุง **ุชฺฉุฑุงุฑ ููโุชูุงููุฏ ุจุงุดูุฏ**.
* ุนูุงุตุฑ ูุฑุชุจ ุง ุจู ุชุฑุชุจ ุงุถุงูู ุดุฏู **ุฐุฎุฑู ููโุดููุฏ**.

---

### ต. ูฺฉุงุช ุนููฺฉุฑุฏ

* ุงุณุชูุงุฏู ุงุฒ **StringComparer.OrdinalIgnoreCase** ุจุฑุง ฺฉูุฏูุง ุฑุดุชูโุง ูโุชูุงูุฏ ุจุฑุงุจุฑ ุจุฏูู ุญุณุงุณุช ุจู ุญุฑูู ุงุฌุงุฏ ฺฉูุฏ.
* ูุดุฎุต ฺฉุฑุฏู ุธุฑูุช ุงููู ุฏฺฉุดูุฑ ูโุชูุงูุฏ ุงุฒ resize ุฏุงุฎู ุฌููฺฏุฑ ฺฉูุฏ ู ุนููฺฉุฑุฏ ุฑุง ุจูุชุฑ ฺฉูุฏ.

### ๐๏ธ OrderedDictionary

ฺฉ **OrderedDictionary** ฺฉ ุฏฺฉุดูุฑ ุบุฑุฌูุฑฺฉ ุงุณุช ฺฉู ุนูุงุตุฑ ุฑุง ุฏุฑ ููุงู ุชุฑุชุจ ฺฉู ุงุถุงูู ุดุฏูโุงูุฏ ูฺฏู ูโุฏุงุฑุฏ. ุจุง ุงุณุชูุงุฏู ุงุฒ **OrderedDictionary** ูโุชูุงูุฏ ุจู ุนูุงุตุฑ ูู ุงุฒ ุทุฑู **ุงูุฏุณ (index)** ู ูู ุงุฒ ุทุฑู **ฺฉูุฏ (key)** ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดุฏ.
ฺฉ **OrderedDictionary**ุ ุฏฺฉุดูุฑ ูุฑุชุจ (sorted) ูุณุช.
ฺฉ **OrderedDictionary** ุชุฑฺฉุจ ุงุฒ **Hashtable** ู **ArrayList** ุงุณุช. ุงู ุนู ุชูุงู ูุงุจูุชโูุง **Hashtable** ุฑุง ุฏุงุฑุฏุ ุจู ุนูุงูู ุชูุงุจุน ูุงููุฏ **RemoveAt** ู ฺฉ ุงูุฏุณุฑ ุนุฏุฏ. ููฺูู ูฺฺฏโูุง **Keys** ู **Values** ุฑุง ุงุฑุงุฆู ูโุฏูุฏ ฺฉู ุนูุงุตุฑ ุฑุง ุฏุฑ ุชุฑุชุจ ุงุตูโุดุงู ุจุงุฒ ูโฺฏุฑุฏุงููุฏ.
ุงู ฺฉูุงุณ ุฏุฑ **.NET 2.0** ูุนุฑู ุดุฏุ ุงูุง ุจูโุทูุฑ ุนุฌุจุ ูุณุฎู ุฌูุฑฺฉ ูุฏุงุฑุฏ.

---

### ๐ ListDictionary ู HybridDictionary

**ListDictionary** ุงุฒ ฺฉ **ูุณุช ูพููุฏ ุชฺฉโุฌูุชู (singly linked list)** ุจุฑุง ุฐุฎุฑู ุฏุงุฏูโูุง ุงุณุชูุงุฏู ูโฺฉูุฏ. ุงู ุฏฺฉุดูุฑ **ูุฑุชุจโุณุงุฒ** ุงูุฌุงู ููโุฏูุฏุ ุงูุง ุชุฑุชุจ ูุฑูุฏ ุงุตู ุนูุงุตุฑ ุฑุง ุญูุธ ูโฺฉูุฏ.
**ListDictionary** ุจุง ูุณุชโูุง ุจุฒุฑฺฏ ุจุณุงุฑ ฺฉูุฏ ุงุณุช ู ุชููุง ูุฒุช ูุงูุน ุขูุ ฺฉุงุฑุง ุจุงูุง ุจุง ูุณุชโูุง ุจุณุงุฑ ฺฉูฺฺฉ (ฺฉูุชุฑ ุงุฒ ฑฐ ุนูุตุฑ) ุงุณุช.

**HybridDictionary** ฺฉ **ListDictionary** ุงุณุช ฺฉู ููฺฏุงู ุฑุณุฏู ุจู ุงูุฏุงุฒู ุฎุงุต ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุจู **Hashtable** ุชุจุฏู ูโุดูุฏ ุชุง ูุดฺฉูุงุช ุนููฺฉุฑุฏ **ListDictionary** ุฑูุน ุดูุฏ. ุงุฏู ุงู ุงุณุช ฺฉู ููุช ุฏฺฉุดูุฑ ฺฉูฺฺฉ ุงุณุชุ ูุตุฑู ุญุงูุธู ฺฉู ุจุงุดุฏ ู ููุช ุฏฺฉุดูุฑ ุจุฒุฑฺฏ ุงุณุชุ ุนููฺฉุฑุฏ ููุงุณุจ ุฏุงุดุชู ุจุงุดุฏ. ุจุง ุงู ุญุงูุ ุจุง ุชูุฌู ุจู ุณุฑุจุงุฑ ุชุจุฏู ุจู ุฏู ุญุงูุชโู ุงู ูุงูุนุช ฺฉู **Dictionary** ุฏุฑ ูุฑ ุฏู ุญุงูุช ุณูฺฏู ุง ฺฉูุฏ ูุณุชโุงุณุชูุงุฏู ุงุฒ **Dictionary** ุงุฒ ุงุจุชุฏุง ูู ุงูุชุฎุงุจ ูุนููู ุงุณุช.
ูุฑ ุฏู ฺฉูุงุณ ููุท ุฏุฑ ูุณุฎู ุบุฑุฌูุฑฺฉ ุงุฑุงุฆู ูโุดููุฏ.

---

### ๐ Sorted Dictionaries

**BCL** ุฏุงุชโูุช ุฏู ฺฉูุงุณ ุฏฺฉุดูุฑ ุงุฑุงุฆู ูโุฏูุฏ ฺฉู ุจู ุตูุฑุช ุฏุงุฎู ููุดู ุจุฑ ุงุณุงุณ **ฺฉูุฏ** ูุฑุชุจ ูุณุชูุฏ:

* **SortedDictionary\<TKey,TValue>**
* **SortedList\<TKey,TValue>**

(ุฏุฑ ุงู ุจุฎุดุ `<TKey,TValue>` ุฑุง ุจู `<,>` ุฎูุงุตู ูโฺฉูู.)

**SortedDictionary<,>** ุงุฒ **ุฏุฑุฎุช ูุฑูุฒ/ุณุงู (red/black tree)** ุงุณุชูุงุฏู ูโฺฉูุฏ: ฺฉ ุณุงุฎุชุงุฑ ุฏุงุฏู ุทุฑุงุญโุดุฏู ุจุฑุง ุนููฺฉุฑุฏ ูพุงุฏุงุฑ ุฏุฑ ูุฑ ุณูุงุฑู ุฏุฑุฌ ุง ุจุงุฒุงุจ.
**SortedList<,>** ุจู ุตูุฑุช ุฏุงุฎู ุจุง ฺฉ ุฌูุช ุขุฑุงู ูุฑุชุจ ูพุงุฏูโุณุงุฒ ุดุฏู ุงุณุช ู ุฏุณุชุฑุณ ุณุฑุน (ุจุง ุฌุณุชุฌู ุฏูุฏู) ุงุฑุงุฆู ูโุฏูุฏุ ุงูุง ุนููฺฉุฑุฏ ุฏุฑุฌ ุถุนู ุฏุงุฑุฏ (ฺูู ููุงุฏุฑ ููุฌูุฏ ุจุงุฏ ุจุฑุง ุงุถุงูู ฺฉุฑุฏู ุนูุตุฑ ุฌุฏุฏ ุฌุงุจูโุฌุง ุดููุฏ).

**SortedDictionary<,>** ุจุณุงุฑ ุณุฑุนโุชุฑ ุงุฒ **SortedList<,>** ุฏุฑ ุฏุฑุฌ ุนูุงุตุฑ ุจู ุตูุฑุช ุชุตุงุฏู ุงุณุช (ุฎุตูุตุงู ุจุง ูุณุชโูุง ุจุฒุฑฺฏ). ุจุง ุงู ุญุงูุ **SortedList<,>** ูุงุจูุช ุงุถุงูู ุฏุงุฑุฏ: ุฏุณุชุฑุณ ุจู ุนูุงุตุฑ ูู ุงุฒ ุทุฑู **ุงูุฏุณ** ู ูู ุงุฒ ุทุฑู **ฺฉูุฏ**. ุจุง ฺฉ **SortedList** ูโุชูุงูุฏ ูุณุชููุงู ุจู ุนูุตุฑ nุงู ุฏุฑ ุชุฑุชุจ ูุฑุชุจโุณุงุฒ ุจุฑูุฏ (ุงุฒ ุทุฑู ุงูุฏุณ ุฏุฑ ูฺฺฏโูุง **Keys/Values**). ุจุฑุง ุงูุฌุงู ููู ฺฉุงุฑ ุจุง **SortedDictionary<,>**ุ ุจุงุฏ ุจู ุตูุฑุช ุฏุณุช ุฑู n ุนูุตุฑ ุดูุงุฑุด ฺฉูุฏ. (ุง ูโุชูุงูุฏ ฺฉ ฺฉูุงุณ ุจููุณุฏ ฺฉู **SortedDictionary** ุฑุง ุจุง ฺฉ ฺฉูุงุณ ูุณุช ุชุฑฺฉุจ ฺฉูุฏ.)

ูฺโฺฉ ุงุฒ ุงู ุณู ูุฌููุนู ุงุฌุงุฒู ฺฉูุฏูุง ุชฺฉุฑุงุฑ ุฑุง ููโุฏููุฏ (ููุงููุฏ ููู ุฏฺฉุดูุฑโูุง).

ููฺูู ฺฉ ูุณุฎู ุบุฑุฌูุฑฺฉ ูุดุงุจู ุจุง ุนููฺฉุฑุฏ ฺฉุณุงู ุจู ูุงู **SortedList** ูุฌูุฏ ุฏุงุฑุฏ.

---

### ๐ ูุซุงู ุงุณุชูุงุฏู ุงุฒ SortedList

ูุซุงู ุฒุฑ ุจุง ุงุณุชูุงุฏู ุงุฒ **reflection**ุ ุชูุงู ูุชุฏูุง ุชุนุฑูโุดุฏู ุฏุฑ `System.Object` ุฑุง ุฏุฑ ฺฉ **SortedList** ุจุง ฺฉูุฏ ูุงู ูุชุฏ ุจุงุฑฺฏุฐุงุฑ ูโฺฉูุฏ ู ุณูพุณ ฺฉูุฏูุง ู ููุงุฏุฑ ุขูโูุง ุฑุง ุดูุงุฑุด ูโฺฉูุฏ:

```csharp
// MethodInfo ุฏุฑ ูุถุง ูุงู System.Reflection ุงุณุช
var sorted = new SortedList<string, MethodInfo>();
foreach (MethodInfo m in typeof(object).GetMethods())
    sorted[m.Name] = m;

foreach (string name in sorted.Keys)
    Console.WriteLine(name);

foreach (MethodInfo m in sorted.Values)
    Console.WriteLine(m.Name + " returns a " + m.ReturnType);
```

ูุชุฌู ุดูุงุฑุด ุงูู:

```
Equals
GetHashCode
GetType
ReferenceEquals
ToString
```

ูุชุฌู ุดูุงุฑุด ุฏูู:

```
Equals returns a System.Boolean
GetHashCode returns a System.Int32
GetType returns a System.Type
ReferenceEquals returns a System.Boolean
ToString returns a System.String
```

ุชูุฌู ฺฉูุฏ ฺฉู ุฏฺฉุดูุฑ ุงุฒ ุทุฑู **ุงูุฏุณุฑ (indexer)** ูพุฑ ุดุฏ. ุงฺฏุฑ ุจู ุฌุง ุขู ุงุฒ ูุชุฏ **Add** ุงุณุชูุงุฏู ูโฺฉุฑุฏูุ ุฎุทุง ุฑุฎ ูโุฏุงุฏ ฺูู ฺฉูุงุณ `object` ูุชุฏ **Equals** ุฑุง overload ฺฉุฑุฏู ู ููโุชูุงู ููุงู ฺฉูุฏ ุฑุง ุฏูุจุงุฑ ุงุถุงูู ฺฉุฑุฏ. ุจุง ุงุณุชูุงุฏู ุงุฒ ุงูุฏุณุฑุ ูุฑูุฏ ุจุนุฏ ุฌุงฺฏุฒู ูุฑูุฏ ูุจู ูโุดูุฏ ู ุงู ุฎุทุง ุฌููฺฏุฑ ูโุดูุฏ.

ููฺูู ูโุชูุงูุฏ ฺูุฏู ุนุถู ุจุง ฺฉ ฺฉูุฏ ุฑุง ุจุง ุชุจุฏู ูุฑ ููุฏุงุฑ ุจู ฺฉ **ูุณุช** ุฐุฎุฑู ฺฉูุฏ:

```csharp
SortedList<string, List<MethodInfo>>
```

ุฏุฑ ุงุฏุงูู ูุซุงูุ ุจุงุฒุงุจ `MethodInfo` ุจุง ฺฉูุฏ `"GetHashCode"` ููุงููุฏ ฺฉ ุฏฺฉุดูุฑ ูุนููู ุงูุฌุงู ูโุดูุฏ:

```csharp
Console.WriteLine(sorted["GetHashCode"]);  // Int32 GetHashCode()
```

ููู ฺฉุงุฑูุง ฺฉู ุชุงฺฉููู ุงูุฌุงู ุฏุงุฏูโุงูุ ุจุง **SortedDictionary<,>** ูุฒ ูุงุจู ุงุฌุฑุง ุงุณุช. ุงูุง ุฏู ุฎุท ุฒุฑุ ฺฉู ุขุฎุฑู ฺฉูุฏ ู ููุฏุงุฑ ุฑุง ุจุงุฒุงุจ ูโฺฉููุฏุ ููุท ุจุง **SortedList** ฺฉุงุฑ ูโฺฉููุฏ:

```csharp
Console.WriteLine(sorted.Keys[sorted.Count - 1]);           // ToString
Console.WriteLine(sorted.Values[sorted.Count - 1].IsVirtual); // True
```

### ๐๏ธ Collections ูุงุจู ุณูุงุฑุดโุณุงุฒ ู ูพุฑุงฺฉุณโูุง

ฺฉูุงุณโูุง ูุฌููุนูโุง ฺฉู ุฏุฑ ุจุฎุดโูุง ูุจู ุจุฑุฑุณ ุดุฏุ ุฑุงุญุช ูุณุชูุฏ ฺูู ูโุชูุงูุฏ ูุณุชููุงู ูููููโุณุงุฒ (instantiate) ฺฉูุฏุ ุงูุง **ุงูฺฉุงู ฺฉูุชุฑู ุฑูุชุงุฑ ููฺฏุงู ุงูุฒูุฏู ุง ุญุฐู ฺฉ ุขุชู** ุฑุง ุจู ุดูุง ููโุฏููุฏ. ุฏุฑ ุจุฑูุงููโูุง ุจุง ูุฌููุนูโูุง ููโุชุงูพ (strongly typed)ุ ฺฏุงู ุจู ุงู ฺฉูุชุฑู ูุงุฒ ุฏุงุฑุฏุ ุจุฑุง ูุซุงู:

* ๐น ุงุฌุฑุง ฺฉ **ุฑูุฏุงุฏ (event)** ููฺฏุงู ุงูุฒูุฏู ุง ุญุฐู ุขุชู
* ๐น ุจูโุฑูุฒุฑุณุงู **ูฺฺฏโูุง (properties)** ุจู ุฎุงุทุฑ ุขุชู ุงุถุงูู ุง ุญุฐูโุดุฏู
* ๐น ุชุดุฎุต ฺฉ **ุนููุงุช ุบุฑูุฌุงุฒ ุงูุฒูุฏู/ุญุฐู** ู ูพุฑุชุงุจ ุงุณุชุซูุง (exception) (ูุซูุงู ุงฺฏุฑ ุนููุงุช ููุงูู ุชุฌุงุฑ ุฑุง ููุถ ฺฉูุฏ)

**.NET BCL** ฺฉูุงุณโูุง ุจุฑุง ุงู ููุธูุฑ ุงุฑุงุฆู ูโุฏูุฏ ฺฉู ุฏุฑ ูุถุง ูุงู `System.Collections.ObjectModel` ูุฑุงุฑ ุฏุงุฑูุฏ. ุงูโูุง ุฏุฑ ุงุตู **ูพุฑุงฺฉุณโูุง ุง wrapperูุง** ูุณุชูุฏ ฺฉู `IList<T>` ุง `IDictionary<,>` ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉููุฏ ู ูุชุฏูุง ุฑุง ุจู ฺฉ ูุฌููุนู ุฒุฑู ูุฏุงุช ูโฺฉููุฏ. ูุฑ ุนููุงุช **Add**ุ **Remove** ุง **Clear** ุงุฒ ุทุฑู ฺฉ ูุชุฏ ูุฌุงุฒ (virtual) ูุฏุงุช ูโุดูุฏ ฺฉู ููฺฏุงู override ุดุฏู ุจู ุนููุงู ฺฉ โุฏุฑฺฏุงูโ ุนูู ูโฺฉูุฏ.

ฺฉูุงุณโูุง ูุฌููุนู ูุงุจู ุณูุงุฑุดโุณุงุฒ ูุนูููุงู ุจุฑุง **ูุฌููุนูโูุง ุนููู (publicly exposed)** ุงุณุชูุงุฏู ูโุดููุฏุ ูุซูุงู ฺฉ ูุฌููุนู ุงุฒ ฺฉูุชุฑูโูุง ฺฉู ุจู ุตูุฑุช ุนููู ุฏุฑ ฺฉ ฺฉูุงุณ `System.Windows.Form` ุฏุฑ ุฏุณุชุฑุณ ุงุณุช.

---

### ๐ฆ Collection<T> ู CollectionBase

ฺฉูุงุณ **Collection<T>** ฺฉ **wrapper ูุงุจู ุณูุงุฑุดโุณุงุฒ** ุจุฑุง `List<T>` ุงุณุช.
ุนูุงูู ุจุฑ ูพุงุฏูโุณุงุฒ `IList<T>` ู `IList`ุ ฺูุงุฑ ูุชุฏ ูุฌุงุฒ ู ฺฉ ูฺฺฏ ูุญุงูุธุชโุดุฏู (protected) ุงุถุงูู ุงุฑุงุฆู ูโุฏูุฏ:

```csharp
public class Collection<T> :
    IList<T>, ICollection<T>, IEnumerable<T>, IList, ICollection, IEnumerable
{
    // ...
    protected virtual void ClearItems();
    protected virtual void InsertItem(int index, T item);
    protected virtual void RemoveItem(int index);
    protected virtual void SetItem(int index, T item);
    protected IList<T> Items { get; }
}
```

ูุชุฏูุง ูุฌุงุฒุ **ุฏุฑฺฏุงู** ุจุฑุง โhook inโ ฺฉุฑุฏู ุดูุง ูุฑุงูู ูโฺฉููุฏ ุชุง ุฑูุชุงุฑ ูพุดโูุฑุถ ูุณุช ุฑุง ุชุบุฑ ุง ุชููุช ฺฉูุฏ. ูฺฺฏ ูุญุงูุธุชโุดุฏู **Items** ุจู ูพุงุฏูโุณุงุฒ ุงุฌุงุฒู ูโุฏูุฏ ุจู **ูุณุช ุฏุงุฎู (inner list)** ุฏุณุชุฑุณ ูุณุชูู ุฏุงุดุชู ุจุงุดุฏ ู ุจุฏูู ูุนุงู ุดุฏู ูุชุฏูุง ูุฌุงุฒุ ุชุบุฑุงุช ุฏุงุฎู ุงุฌุงุฏ ฺฉูุฏ.

ูุงุฒู ูุณุช ูุชุฏูุง ูุฌุงุฒ override ุดููุฏุ ูโุชูุงู ุชุง ุฒูุงู ฺฉู ูุงุฒ ุจู ุชุบุฑ ุฑูุชุงุฑ ูพุดโูุฑุถ ูุณุช ูุฌูุฏ ุฏุงุฑุฏุ ุขูโูุง ุฑุง ุฏุณุชโูุฎูุฑุฏู ฺฏุฐุงุดุช. ูุซุงู ุฒุฑ ุงุณุชูุงุฏู ูุนููู **Collection<T>** ุฑุง ูุดุงู ูโุฏูุฏ:

```csharp
Zoo zoo = new Zoo();
zoo.Animals.Add(new Animal("Kangaroo", 10));
zoo.Animals.Add(new Animal("Mr Sea Lion", 20));
foreach (Animal a in zoo.Animals) Console.WriteLine(a.Name);

public class Animal
{
    public string Name;
    public int Popularity;
    public Animal(string name, int popularity)
    {
        Name = name; Popularity = popularity;
    }
}

public class AnimalCollection : Collection<Animal>
{
    // AnimalCollection ูู ุงฺฉููู ฺฉ ูุณุช ฺฉุงูู ุงุฒ ุญูุงูุงุช ุงุณุช.
    // ูุงุฒ ุจู ฺฉุฏ ุงุถุงู ูุณุช.
}

public class Zoo
{
    public readonly AnimalCollection Animals = new AnimalCollection();
}
```

ููุงูุทูุฑ ฺฉู ูโุจููุ **AnimalCollection** ุงุฒ ูุธุฑ ุนููฺฉุฑุฏ ุชูุงูุช ุจุง ฺฉ `List<Animal>` ุณุงุฏู ูุฏุงุฑุฏุ ููุด ุขู ูุฑุงูู ฺฉุฑุฏู ูพุงูโุง ุจุฑุง **ฺฏุณุชุฑุด ุขูุฏู** ุงุณุช.

---

### ๐ ุงูุฒูุฏู ูฺฺฏ Zoo ุจู ุญูุงูุงุช ู override ูุชุฏูุง ูุฌุงุฒ

ุงฺฉููู ูโุฎูุงูู ุจู ฺฉูุงุณ `Animal` ูฺฺฏ `Zoo` ุงุถุงูู ฺฉูู ุชุง ูุฑุฌุน ุจู ุจุงุบโูุญุด ุฎูุฏ ุฑุง ุฏุงุดุชู ุจุงุดุฏ ู ููู ูุชุฏูุง ูุฌุงุฒ `Collection<Animal>` ุฑุง override ฺฉูู ุชุง ุงู ูฺฺฏ ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ูุฏุฑุช ุดูุฏ:

```csharp
public class Animal
{
    public string Name;
    public int Popularity;
    public Zoo Zoo { get; internal set; }
    public Animal(string name, int popularity)
    {
        Name = name; Popularity = popularity;
    }
}

public class AnimalCollection : Collection<Animal>
{
    Zoo zoo;
    public AnimalCollection(Zoo zoo) { this.zoo = zoo; }

    protected override void InsertItem(int index, Animal item)
    {
        base.InsertItem(index, item);
        item.Zoo = zoo;
    }

    protected override void SetItem(int index, Animal item)
    {
        base.SetItem(index, item);
        item.Zoo = zoo;
    }

    protected override void RemoveItem(int index)
    {
        this[index].Zoo = null;
        base.RemoveItem(index);
    }

    protected override void ClearItems()
    {
        foreach (Animal a in this) a.Zoo = null;
        base.ClearItems();
    }
}

public class Zoo
{
    public readonly AnimalCollection Animals;
    public Zoo() { Animals = new AnimalCollection(this); }
}
```

**ูฺฉุชู ููู:** `Collection<T>` ููฺูู ฺฉ ุณุงุฒูุฏู ูโูพุฐุฑุฏ ฺฉู ฺฉ `IList<T>` ููุฌูุฏ ุฑุง ุฏุฑุงูุช ูโฺฉูุฏ. ุจุฑุฎูุงู ุณุงุฑ ฺฉูุงุณโูุง ูุฌููุนูุ ูุณุช ุงุฑุงุฆูโุดุฏู **proxied** ูโุดูุฏ ูู ฺฉูพุ ุจูุงุจุฑุงู ุชุบุฑุงุช ุจุนุฏ ุฏุฑ ูุณุช ุงุตูุ ุฏุฑ `Collection<T>` ูุฒ ููุนฺฉุณ ูโุดูุฏ (ูุฑฺูุฏ ูุชุฏูุง ูุฌุงุฒ ุขู ูุนุงู ููโุดููุฏ). ุจู ููู ุชุฑุชุจุ ุชุบุฑุงุช ุงุนูุงูโุดุฏู ุงุฒ ุทุฑู `Collection<T>`ุ ูุณุช ุฒุฑู ุฑุง ุชุบุฑ ูโุฏูุฏ.

---

### โ๏ธ CollectionBase

**CollectionBase** ูุณุฎู ุบุฑุฌูุฑฺฉ `Collection<T>` ุงุณุช. ุงู ฺฉูุงุณ ุจุดุชุฑ ูุงุจูุชโูุง ูุดุงุจู `Collection<T>` ุฑุง ุงุฑุงุฆู ูโุฏูุฏ ุงูุง ุงุณุชูุงุฏู ุงุฒ ุขู **ุฏุณุชโููพุงฺฏุฑุชุฑ** ุงุณุช.
ุจู ุฌุง ูุชุฏูุง ูุงูุจ **InsertItem**ุ **RemoveItem**ุ **SetItem** ู **ClearItems**ุ **CollectionBase** ุฏุงุฑุง ูุชุฏูุง โhookโ ุงุณุช ฺฉู ุชุนุฏุงุฏ ูุชุฏูุง ุฑุง ุฏู ุจุฑุงุจุฑ ูโฺฉูุฏ:

* `OnInsert`, `OnInsertComplete`
* `OnSet`, `OnSetComplete`
* `OnRemove`, `OnRemoveComplete`
* `OnClear`, `OnClearComplete`

ฺูู **CollectionBase** ุบุฑุฌูุฑฺฉ ุงุณุชุ ููฺฏุงู subclass ฺฉุฑุฏู ุจุงุฏ ูุชุฏูุง ุชุงูพโุดุฏู ูุฒ ูพุงุฏูโุณุงุฒ ฺฉูุฏุ ุญุฏุงูู ฺฉ **ุงูุฏุณุฑ ุชุงูพโุดุฏู (typed indexer)** ู ูุชุฏ **Add**.

### ๐๏ธ KeyedCollection\<TKey,TItem> ู DictionaryBase

ฺฉูุงุณ **KeyedCollection\<TKey,TItem>** ุงุฒ `Collection<TItem>` ูุดุชู ุดุฏู ู ูู **ูฺฺฏโูุง ุงุถุงูู ูโฺฉูุฏ** ู ูู **ูฺฺฏโูุง ุฑุง ุญุฐู ูโฺฉูุฏ**.

* ุขูฺู ุงุถุงูู ูโฺฉูุฏ: **ุงูฺฉุงู ุฏุณุชุฑุณ ุจู ุขุชูโูุง ุงุฒ ุทุฑู ฺฉูุฏ (key)**ุ ุฏุฑุณุช ูุงููุฏ ฺฉ ุฏฺฉุดูุฑ.
* ุขูฺู ุญุฐู ูโฺฉูุฏ: **ุงูฺฉุงู proxy ฺฉุฑุฏู ูุณุช ุฏุงุฎู ุฎูุฏ**.

ฺฉ ูุฌููุนู keyed ุดุจุงูุชโูุง ุจู `OrderedDictionary` ุฏุงุฑุฏุ ุฒุฑุง **ูุณุช ุฎุท ุฑุง ุจุง ฺฉ Hashtable ุชุฑฺฉุจ ูโฺฉูุฏ**. ุจุง ุงู ุญุงูุ ุจุฑุฎูุงู `OrderedDictionary`ุ **IDictionary ุฑุง ูพุงุฏูโุณุงุฒ ููโฺฉูุฏ** ู ููููู ฺฉูุฏ/ููุฏุงุฑ (key/value) ุฑุง ูพุดุชุจุงู ููโฺฉูุฏ. **ฺฉูุฏูุง ุงุฒ ุฎูุฏ ุขุชูโูุง ฺฏุฑูุชู ูโุดููุฏ**ุ ุงุฒ ุทุฑู ูุชุฏ ุงูุชุฒุงุน `GetKeyForItem`. ุงู ุนู **enumeration** ฺฉ ูุฌููุนู keyed ุฏููุงู ูุงููุฏ enumeration ฺฉ ูุณุช ูุนููู ุงุณุช.

ูโุชูุงูุฏ **KeyedCollection\<TKey,TItem>** ุฑุง ุจูโุนููุงู `Collection<TItem>` ุจู ุงุถุงูู **ุฌุณุชุฌู ุณุฑุน ุจุฑ ุงุณุงุณ ฺฉูุฏ** ุฏุฑ ูุธุฑ ุจฺฏุฑุฏ.

ฺูู ุงู ฺฉูุงุณ ุงุฒ `Collection<>` ูุดุชู ุดุฏูุ ุชูุงู ุนููฺฉุฑุฏูุง Collection<> ุฑุง ุจู ุงุฑุซ ูโุจุฑุฏุ ุจู ุฌุฒ ุงูฺฉุงู ุชุนู ฺฉ ูุณุช ููุฌูุฏ ุฏุฑ ุณุงุฒูุฏู. ุงุนุถุง ุงุถุงู ฺฉู ุชุนุฑู ูโฺฉูุฏ ุจู ุตูุฑุช ุฒุฑ ูุณุชูุฏ:

```csharp
public abstract class KeyedCollection<TKey, TItem> : Collection<TItem>
{
    // ...
    protected abstract TKey GetKeyForItem(TItem item);
    protected void ChangeItemKey(TItem item, TKey newKey);
    // ุฌุณุชุฌู ุณุฑุน ุจุฑ ุงุณุงุณ ฺฉูุฏ - ุนูุงูู ุจุฑ ุฌุณุชุฌู ุจุฑ ุงุณุงุณ ุงูุฏุณ
    public TItem this[TKey key] { get; }
    protected IDictionary<TKey, TItem> Dictionary { get; }
}
```

* ูุชุฏ `GetKeyForItem` ุชูุณุท ูพุงุฏูโุณุงุฒ override ูโุดูุฏ ุชุง **ฺฉูุฏ ฺฉ ุขุชู ุฑุง ุงุฒ ุดุก ุฒุฑู** ุฏุฑุงูุช ฺฉูุฏ.
* ูุชุฏ `ChangeItemKey` ุจุงุฏ **ููฺฏุงู ุชุบุฑ ฺฉูุฏ ุขุชู** ูุฑุงุฎูุงู ุดูุฏ ุชุง ุฏฺฉุดูุฑ ุฏุงุฎู ุจูโุฑูุฒุฑุณุงู ุดูุฏ.
* ูฺฺฏ `Dictionary` ุฏฺฉุดูุฑ ุฏุงุฎู ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ ฺฉู ุจุฑุง **ูพุงุฏูโุณุงุฒ ุฌุณุชุฌู** ุงุณุชูุงุฏู ูโุดูุฏ ู ููฺฏุงู ุงูุฒูุฏู ุงููู ุขุชู ุณุงุฎุชู ูโุดูุฏ. ูโุชูุงู ุฑูุชุงุฑ ุงุฌุงุฏ ุฏฺฉุดูุฑ ุฏุงุฎู ุฑุง ุจุง ุชุนู **creation threshold** ุฏุฑ ุณุงุฒูุฏู ุชุบุฑ ุฏุงุฏุ ุจู ุทูุฑ ฺฉู ุชุง ุฑุณุฏู ุจู ุขุณุชุงููุ ุฌุณุชุฌู ุจุง ุฎุท ุงูุฌุงู ุดูุฏ.

ฺฉ ุฏูู ุฎูุจ ุจุฑุง ุชุนู ูฺฉุฑุฏู **creation threshold** ุงู ุงุณุช ฺฉู ุฏุงุดุชู ุฏฺฉุดูุฑ ูุนุชุจุฑ ูโุชูุงูุฏ ุฏุฑ **ุฏุฑุงูุช ICollection<> ุงุฒ ฺฉูุฏูุง** ููุฏ ุจุงุดุฏุ ุงุฒ ุทุฑู ูฺฺฏ `Keys` ุฏฺฉุดูุฑ. ุงู ูุฌููุนู ุณูพุณ ูโุชูุงูุฏ ุจู ฺฉ ูฺฺฏ ุนููู ููุชูู ุดูุฏ.

---

### ๐พ ูุซุงู: ุงุณุชูุงุฏู ุงุฒ KeyedCollection ุจุฑุง Zoo

ูุชุฏุงููโุชุฑู ฺฉุงุฑุจุฑุฏ `KeyedCollection<,>` ูุฑุงูู ฺฉุฑุฏู **ูุฌููุนูโุง ุงุฒ ุขุชูโูุง ุจุง ุฏุณุชุฑุณ ูู ุงุฒ ุทุฑู ุงูุฏุณ ู ูู ุงุฒ ุทุฑู ูุงู** ุงุณุช.

```csharp
public class Animal
{
    string name;
    public string Name
    {
        get { return name; }
        set {
            if (Zoo != null) Zoo.Animals.NotifyNameChange(this, value);
            name = value;
        }
    }
    public int Popularity;
    public Zoo Zoo { get; internal set; }

    public Animal(string name, int popularity)
    {
        Name = name; Popularity = popularity;
    }
}

public class AnimalCollection : KeyedCollection<string, Animal>
{
    Zoo zoo;
    public AnimalCollection(Zoo zoo) { this.zoo = zoo; }

    internal void NotifyNameChange(Animal a, string newName) =>
        this.ChangeItemKey(a, newName);

    protected override string GetKeyForItem(Animal item) => item.Name;

    // ูุชุฏูุง ุฒุฑ ูุดุงุจู ูุซุงู ูุจู ูพุงุฏูโุณุงุฒ ูโุดููุฏ:
    protected override void InsertItem(int index, Animal item)...
    protected override void SetItem(int index, Animal item)...
    protected override void RemoveItem(int index)...
    protected override void ClearItems()...
}

public class Zoo
{
    public readonly AnimalCollection Animals;
    public Zoo() { Animals = new AnimalCollection(this); }
}
```

ูุซุงู ุงุณุชูุงุฏู ุงุฒ ุขู:

```csharp
Zoo zoo = new Zoo();
zoo.Animals.Add(new Animal("Kangaroo", 10));
zoo.Animals.Add(new Animal("Mr Sea Lion", 20));
Console.WriteLine(zoo.Animals[0].Popularity);               // 10
Console.WriteLine(zoo.Animals["Mr Sea Lion"].Popularity);   // 20
zoo.Animals["Kangaroo"].Name = "Mr Roo";
Console.WriteLine(zoo.Animals["Mr Roo"].Popularity);        // 10
```

---

### ๐๏ธ DictionaryBase

ูุณุฎู ุบุฑุฌูุฑฺฉ `KeyedCollection`ุ ฺฉูุงุณ **DictionaryBase** ุงุณุช. ุงู ฺฉูุงุณ ูุฏู **ุฑูฺฉุฑุฏ ูุชูุงูุช** ุฏุงุฑุฏ:

* `IDictionary` ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉูุฏ
* ุงุฒ ูุชุฏูุง hook ุฏุณุชโููพุงฺฏุฑ ูุงููุฏ CollectionBase ุงุณุชูุงุฏู ูโฺฉูุฏ:
  `OnInsert`, `OnInsertComplete`, `OnSet`, `OnSetComplete`, `OnRemove`, `OnRemoveComplete`, `OnClear`, `OnClearComplete` ู ููฺูู `OnGet`.

ูุฒุช ุงุตู ูพุงุฏูโุณุงุฒ IDictionary ูุณุจุช ุจู KeyedCollection ุงู ุงุณุช ฺฉู **ูุงุฒ ุจู subclass ฺฉุฑุฏู ุจุฑุง ุฏุณุชุฑุณ ุจู ฺฉูุฏูุง ูุณุช**. ุงูุง ฺูู ูุฏู DictionaryBase ุฏุฑ ุงุตู subclass ุดุฏู ุงุณุชุ ุงู ูุฒุช ฺูุฏุงู ฺฉุงุฑุจุฑุฏ ูุฏุงุฑุฏ.

ูุฏู ุจูุจูุฏ ุงูุชู ุฏุฑ **KeyedCollection** ุงุญุชูุงูุงู ุจู ุงู ุฏูู ุงุณุช ฺฉู ฺูุฏ ุณุงู ุจุนุฏ ููุดุชู ุดุฏู ู ุงุฒ ุชุฌุฑุจุงุช ฺฏุฐุดุชู ุจูุฑูโููุฏ ุจูุฏู ุงุณุช.
**DictionaryBase** ุจุดุชุฑ ุจุฑุง **ุณุงุฒฺฏุงุฑ ุจุง ูุณุฎูโูุง ูุฏู (backward compatibility)** ููุฏ ุงุณุช.

### ๐ ReadOnlyCollection<T>

ฺฉูุงุณ **ReadOnlyCollection<T>** ฺฉ **wrapper** ุง **proxy** ุงุณุช ฺฉู ฺฉ **ููุง ููุท-ุฎูุงูุฏู** ุงุฒ ฺฉ ูุฌููุนู ุฑุง ูุฑุงูู ูโฺฉูุฏ. ุงู ูฺฺฏ ุจู ุดูุง ุงุฌุงุฒู ูโุฏูุฏ ุชุง ฺฉ ฺฉูุงุณ **ุฏุณุชุฑุณ ุนููู ููุท-ุฎูุงูุฏู** ุจู ฺฉ ูุฌููุนู ุฑุง ุงุฑุงุฆู ุฏูุฏุ ุฏุฑ ุญุงู ฺฉู ุฎูุฏ ฺฉูุงุณ ูููุฒ ูโุชูุงูุฏ ูุฌููุนู ุฑุง ุจูโุตูุฑุช ุฏุงุฎู ุจูโุฑูุฒุฑุณุงู ฺฉูุฏ.

ฺฉ ูุฌููุนู ููุท-ุฎูุงูุฏูุ **ูุฌููุนู ูุฑูุฏ ุฑุง ุฏุฑ ุณุงุฒูุฏู ุฎูุฏ ุฏุฑุงูุช ูโฺฉูุฏ** ู ฺฉ **ุงุฑุฌุงุน ุฏุงุฆู** ุจู ุขู ูฺฏู ูโุฏุงุฑุฏ. ุงู ฺฉูุงุณ **ูุณุฎูโุง ุงุณุชุง ุงุฒ ูุฌููุนู ูุฑูุฏ ููโุณุงุฒุฏ**ุ ุจูุงุจุฑุงู ุชุบุฑุงุช ุจุนุฏ ุฏุฑ ูุฌููุนู ูุฑูุฏ ุงุฒ ุทุฑู wrapper ููุท-ุฎูุงูุฏู ูุงุจู ูุดุงูุฏู ุงุณุช.

ุจุฑุง ูุซุงูุ ูุฑุถ ฺฉูุฏ ฺฉูุงุณ ุดูุง ูโุฎูุงูุฏ **ุฏุณุชุฑุณ ุนููู ููุท-ุฎูุงูุฏู** ุจู ูุณุช ุงุฒ ุฑุดุชูโูุง ุจู ูุงู `Names` ูุฑุงูู ฺฉูุฏ:

```csharp
public class Test
{
    List<string> names = new List<string>();
    public IReadOnlyList<string> Names => names;
}
```

ุจุง ุงูฺฉู `Names` ฺฉ ุฑุงุจุท ููุท-ุฎูุงูุฏู ุจุงุฒูโฺฏุฑุฏุงูุฏุ ูุตุฑูโฺฉููุฏู ูููุฒ ูโุชูุงูุฏ ุฏุฑ ุฒูุงู ุงุฌุฑุง ุจู `List<string>` ุง `IList<string>` **downcast** ฺฉูุฏ ู ุณูพุณ ูุชุฏูุง `Add`ุ `Remove` ุง `Clear` ุฑุง ูุฑุงุฎูุงู ฺฉูุฏ.

ุฑุงูโุญู **ReadOnlyCollection<T>** ุงู ูุดฺฉู ุฑุง ุจู ุตูุฑุช ูุญฺฉูโุชุฑ ุญู ูโฺฉูุฏ:

```csharp
public class Test
{
    List<string> names = new List<string>();
    public ReadOnlyCollection<string> Names { get; private set; }

    public Test() => Names = new ReadOnlyCollection<string>(names);

    public void AddInternally() => names.Add("test");
}
```

ุฏุฑ ุงู ุญุงูุชุ ุชููุง ุงุนุถุง ุฏุงุฎู ฺฉูุงุณ **Test** ูโุชูุงููุฏ ูุณุช `names` ุฑุง ุชุบุฑ ุฏููุฏ:

```csharp
Test t = new Test();
Console.WriteLine(t.Names.Count);       // 0
t.AddInternally();
Console.WriteLine(t.Names.Count);       // 1
t.Names.Add("test");                    // ุฎุทุง ฺฉุงููพุงู
((IList<string>)t.Names).Add("test");   // NotSupportedException
```

---

### ๐ก๏ธ Immutable Collections

ูุจูุงู ุชูุถุญ ุฏุงุฏู ฺฉู ฺฺฏููู **ReadOnlyCollection<T>** ฺฉ ููุง ููุท-ุฎูุงูุฏู ุงุฌุงุฏ ูโฺฉูุฏ. ูุญุฏูุฏ ฺฉุฑุฏู ุชูุงูุง ููุดุชู (mutate) ฺฉ ูุฌููุนู ุง ูุฑ ุดุก ุฏฺฏุฑุ **ุณุงุฏูโุณุงุฒ ูุฑูโุงูุฒุงุฑ ู ฺฉุงูุด ุจุงฺฏโูุง** ุฑุง ุจู ุฏูุจุงู ุฏุงุฑุฏ.

**ูุฌููุนูโูุง immutable** ุงู ุงุตู ุฑุง ฺฏุณุชุฑุด ูโุฏููุฏ ู **ูุฌููุนูโูุง ุงุฑุงุฆู ูโฺฉููุฏ ฺฉู ูพุณ ุงุฒ ููุฏุงุฑุฏู ุงููู ุงุตูุงู ูุงุจู ุชุบุฑ ูุณุชูุฏ**. ุงฺฏุฑ ุจุฎูุงูุฏ ุขุชู ุจู ฺฉ ูุฌููุนู immutable ุงุถุงูู ฺฉูุฏุ ุจุงุฏ ฺฉ **ูุฌููุนู ุฌุฏุฏ ุจุณุงุฒุฏ** ู ูุฌููุนู ูุฏู ุจุฏูู ุชุบุฑ ุจุงู ุจูุงูุฏ.

---

#### โก ูุฒุงุง Immutable Collections

* **ุงุฒ ุจู ุจุฑุฏู ุชุนุฏุงุฏ ุฒุงุฏ ุงุฒ ุจุงฺฏโูุง** ฺฉู ุจุง ุชุบุฑ ูุถุนุช ุงุฌุงุฏ ูโุดููุฏ.
* **ุณุงุฏูโุณุงุฒ ููุงุฒโุณุงุฒ ู ฺูุฏูุฎ** (multithreading) ุจุง ุงุฌุชูุงุจ ุงุฒ ุจุดุชุฑ ูุดฺฉูุงุช thread-safety ฺฉู ุฏุฑ ูุตูโูุง 14ุ 22 ู 23 ุชูุถุญ ุฏุงุฏู ูโุดููุฏ.
* **ุณุงุฏูโุชุฑ ฺฉุฑุฏู ููุทู ู ุชุญูู ฺฉุฏ**.

#### โ ูุนุงุจ

* ูุฑฺฏุงู ูุงุฒ ุจู ุชุบุฑ ุจุงุดุฏุ ุจุงุฏ **ฺฉู ุดุก ุฌุฏุฏ ุณุงุฎุชู ุดูุฏ** ฺฉู ููฺฉู ุงุณุช **ูุฒูู ุนููฺฉุฑุฏ** ุจู ููุฑุงู ุฏุงุดุชู ุจุงุดุฏ. ุจุง ุงู ุญุงูุ **ุงุณุชุฑุงุชฺโูุง ุจุฑุง ฺฉุงูุด ุงู ูุฒูู** ูุฌูุฏ ุฏุงุฑุฏุ ุงุฒ ุฌููู ูุงุจูุช **ุงุณุชูุงุฏู ูุฌุฏุฏ ุงุฒ ุจุฎุดโูุง ุงุฒ ุณุงุฎุชุงุฑ ุงููู**.

---

ูุฌููุนูโูุง immutable ุจุฎุด ุงุฒ **.NET** ูุณุชูุฏ (ุฏุฑ .NET Frameworkุ ุงุฒ ุทุฑู ูพฺฉุฌ NuGet ุจู ูุงู `System.Collections.Immutable` ูุงุจู ุฏุณุชุฑุณโุงูุฏ). ููู ูุฌููุนูโูุง ุฏุฑ namespace ุฒุฑ ุชุนุฑู ุดุฏูโุงูุฏ:

```text
System.Collections.Immutable
```

<div align="center">

![Conventions-UsedThis-Book](../../../assets/image/07/Table-7-7.jpeg)
</div>

### ๐งฑ ImmutableArray<T> ู ImmutableList<T>

ุงููุงุน **ImmutableArray<T>** ู **ImmutableList<T>** ูุฑ ุฏู ูุณุฎูโูุง **immutable** ุงุฒ **List<T>** ูุณุชูุฏ. ูุฑ ุฏู ฺฉุงุฑ ูุดุงุจู ุงูุฌุงู ูโุฏููุฏุ ุงูุง **ูฺฺฏโูุง ุนููฺฉุฑุฏ ูุชูุงูุช** ุฏุงุฑูุฏ ฺฉู ุฏุฑ ุจุฎุด ยซImmutable Collections and Performanceยป ุฏุฑ ุตูุญู 409 ุจุฑุฑุณ ุดุฏู ุงุณุช.

ูุฌููุนูโูุง immutable ฺฉ **ุฑุงุจุท ุนููู ูุดุงุจู ูุณุฎูโูุง ูุงุจู ุชุบุฑ** ุฎูุฏ ุงุฑุงุฆู ูโฺฉููุฏ. ุชูุงูุช ฺฉูุฏ ุงู ุงุณุช ฺฉู **ูุชุฏูุง ฺฉู ุจู ูุธุฑ ูโุฑุณุฏ ูุฌููุนู ุฑุง ุชุบุฑ ูโุฏููุฏ** (ูุซู `Add` ุง `Remove`) ุฏุฑ ูุงูุน **ูุฌููุนู ุงุตู ุฑุง ุชุบุฑ ููโุฏููุฏ**ุ ุจูฺฉู **ฺฉ ูุฌููุนู ุฌุฏุฏ ุจุง ุขุชู ุงุถุงูู ุง ุญุฐู ุดุฏู** ุจุฑูโฺฏุฑุฏุงููุฏ. ุจู ุงู ุฑูุชุงุฑ **nondestructive mutation** ฺฏูุชู ูโุดูุฏ.

ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู **ูุฌููุนูโูุง immutable ุงุฒ ุงุถุงูู ุง ุญุฐู ุขุชูโูุง ุฌููฺฏุฑ ูโฺฉููุฏ**ุ ุงูุง ุงู **ูุญุฏูุฏุช ุฑู ุฎูุฏ ุขุชูโูุง ุงุนูุงู ููโุดูุฏ**. ุจุฑุง ุจูุฑู ฺฉุงูู ุงุฒ **immutable ุจูุฏู**ุ ุจุงุฏ ุงุทููุงู ุญุงุตู ฺฉูุฏ ฺฉู ููุท **ุขุชูโูุง immutable** ุฏุฑ ูุฌููุนู immutable ูุฑุงุฑ ูโฺฏุฑูุฏ.

---

### ๐๏ธ ุงุฌุงุฏ Immutable Collections

ูุฑ ููุน ูุฌููุนู immutable ฺฉ ูุชุฏ **Create<T>()** ุงุฑุงุฆู ูโุฏูุฏ ฺฉู **ููุงุฏุฑ ุงููู ุงุฎุชุงุฑ** ุฑุง ูโูพุฐุฑุฏ ู **ฺฉ ูุฌููุนู immutable ููุฏุงุฑุฏูโุดุฏู** ุจุฑูโฺฏุฑุฏุงูุฏ:

```csharp
ImmutableArray<int> array = ImmutableArray.Create<int>(1, 2, 3);
```

ููฺูู ูุชุฏ **CreateRange<T>** ูุฌูุฏ ุฏุงุฑุฏ ฺฉู ูุดุงุจู `Create<T>` ุนูู ูโฺฉูุฏุ ุชูุงูุช ุขู ุฏุฑ ุงู ุงุณุช ฺฉู **ูพุงุฑุงูุชุฑ ุขู ุงุฒ ููุน IEnumerable<T>** ุงุณุชุ ูู `params T[]`.

ูโุชูุงูุฏ ฺฉ **ูุฌููุนู immutable** ุฑุง ุงุฒ ฺฉ `IEnumerable<T>` ููุฌูุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ **extension methodูุง ููุงุณุจ** ุจุณุงุฒุฏ (`ToImmutableArray`ุ `ToImmutableList`ุ `ToImmutableDictionary` ู ุบุฑู):

```csharp
var list = new[] { 1, 2, 3 }.ToImmutableList();
```

---

### ๐ ุฏุณุชฺฉุงุฑ Immutable Collections

ูุชุฏ **Add** ฺฉ **ูุฌููุนู ุฌุฏุฏ** ุดุงูู **ุนูุงุตุฑ ููุฌูุฏ ุจูโุนูุงูู ุนูุตุฑ ุฌุฏุฏ** ุจุฑูโฺฏุฑุฏุงูุฏ:

```csharp
var oldList = ImmutableList.Create<int>(1, 2, 3);
ImmutableList<int> newList = oldList.Add(4);

Console.WriteLine(oldList.Count);   // 3  (ุชุบุฑ ูฺฉุฑุฏู)
Console.WriteLine(newList.Count);   // 4
```

ูุชุฏ **Remove** ูุฒ ุจู ููู ุดฺฉู ุนูู ูโฺฉูุฏ ู ฺฉ ูุฌููุนู ุฌุฏุฏ ุจุง ุขุชู ุญุฐูโุดุฏู ุจุฑูโฺฏุฑุฏุงูุฏ.

ุงุถุงูู ุง ุญุฐู ูฺฉุฑุฑ ุจู ุงู ุฑูุด **ูุงฺฉุงุฑุขูุฏ ุงุณุช**ุ ุฒุฑุง ุจุฑุง ูุฑ ุนููุงุช ฺฉ ูุฌููุนู immutable ุฌุฏุฏ ุณุงุฎุชู ูโุดูุฏ.
ุฑุงู ุจูุชุฑ ุงุณุชูุงุฏู ุงุฒ **AddRange** ุง **RemoveRange** ุงุณุช ฺฉู ฺฉ `IEnumerable<T>` ุงุฒ ุขุชูโูุง ูโูพุฐุฑุฏ ู ููู ุขุชูโูุง ุฑุง **ฺฉุฌุง ุงุถุงูู ุง ุญุฐู ูโฺฉูุฏ**:

```csharp
var anotherList = oldList.AddRange(new[] { 4, 5, 6 });
```

ููฺูู **ImmutableList** ู **ImmutableArray** ูุชุฏูุง **Insert** ู **InsertRange** ุจุฑุง ุฏุฑุฌ ุขุชู ุฏุฑ ุงูุฏุณ ูุดุฎุตุ **RemoveAt** ุจุฑุง ุญุฐู ุฏุฑ ุงูุฏุณ ูุดุฎุต ู **RemoveAll** ุจุฑ ุงุณุงุณ predicate ุงุฑุงุฆู ูโุฏููุฏ.

---

### ๐๏ธ Builders

ุจุฑุง ูุงุฒูุง ููุฏุงุฑุฏู ูพฺุฏูโุชุฑุ ูุฑ ฺฉูุงุณ ูุฌููุนู immutable ุฏุงุฑุง **Builder** ูุชูุงุธุฑ ุงุณุช.
Builders ุจู ูุญุงุธ ุนููฺฉุฑุฏ ูุดุงุจู ฺฉ **ูุฌููุนู mutable** ูุณุชูุฏ. ูพุณ ุงุฒ ููุฏุงุฑุฏูุ ุจุง ูุฑุงุฎูุงู `.ToImmutable()` ุฑู Builderุ ฺฉ ูุฌููุนู immutable ุฌุฏุฏ ุฏุฑุงูุช ูโฺฉูุฏ:

```csharp
ImmutableArray<int>.Builder builder = ImmutableArray.CreateBuilder<int>();
builder.Add(1);
builder.Add(2);
builder.Add(3);
builder.RemoveAt(0);

ImmutableArray<int> myImmutable = builder.ToImmutable();
```

ููฺูู ูโุชูุงูุฏ **ฺูุฏู ุชุบุฑ ุฑุง ุฑู ฺฉ ูุฌููุนู immutable ููุฌูุฏ ุจูโุตูุฑุช ฺฏุฑูู** ุงูุฌุงู ุฏูุฏ:

```csharp
var builder2 = myImmutable.ToBuilder();
builder2.Add(4);      // ฺฉุงุฑุขูุฏ
builder2.Remove(2);   // ฺฉุงุฑุขูุฏ
// ุชุบุฑุงุช ุจุดุชุฑ ุฑู builder...
ImmutableArray<int> myImmutable2 = builder2.ToImmutable(); // ูุฌููุนู ุฌุฏุฏ ุจุง ุชูุงู ุชุบุฑุงุช
```

---

### โก Immutable Collections ู ุนููฺฉุฑุฏ

ุจุดุชุฑ ูุฌููุนูโูุง immutable ุงุฒ **ุฏุฑุฎุช AVL** ุฏุงุฎู ุงุณุชูุงุฏู ูโฺฉููุฏุ ฺฉู ุงุฌุงุฒู ูโุฏูุฏ ุนููุงุช **add/remove** ุงุฒ ุจุฎุดโูุง ุงุฒ ุณุงุฎุชุงุฑ ุฏุงุฎู ูุจู ุงุณุชูุงุฏู ฺฉููุฏ ู **ฺฉู ูุฌููุนู ุฏูุจุงุฑู ุณุงุฎุชู ูุดูุฏ**. ุงู ุจุงุนุซ ูโุดูุฏ **ูุฒูู ุนููุงุช add/remove ุงุฒ ุจุฒุฑฺฏ (ุฏุฑ ูุฌููุนูโูุง ุจุฒุฑฺฏ) ุจู ูุชูุณุท ฺฉุงูุด ุงุจุฏ**ุ ุงูุง ุฎูุงูุฏู ุฏุงุฏูโูุง ฺฉู ฺฉูุฏุชุฑ ุฎูุงูุฏ ุดุฏ.
ูุชุฌู ููุง ุงู ุงุณุช ฺฉู ุจุดุชุฑ ูุฌููุนูโูุง immutable **ุจุฑุง ุฎูุงูุฏู ู ููุดุชู ฺฉูุฏุชุฑ** ุงุฒ ูุณุฎูโูุง mutable ูุณุชูุฏ.

* ุจุดุชุฑู ุชุงุซุฑ ุฑู **ImmutableList<T>** ุงุณุชุ ฺฉู **ุฎูุงูุฏู ู ุงูุฒูุฏู ุขุชู** ุฏุฑ ุขู **10 ุชุง 200 ุจุฑุงุจุฑ ฺฉูุฏุชุฑ ุงุฒ List<T>** ุงุณุช (ุจุณุชู ุจู ุงูุฏุงุฒู ูุณุช).
* ุจู ููู ุฏูู **ImmutableArray<T>** ูุฌูุฏ ุฏุงุฑุฏ: ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉ **ุขุฑุงู ุฏุงุฎู**ุ ุนููฺฉุฑุฏ ุฎูุงูุฏู ุจุฏูู ฺฉุงูุด ุณุฑุนุช ุงูุฌุงู ูโุดูุฏ (ูุดุงุจู ุขุฑุงู mutable ูุนููู). ุงูุง ุงูุฒูุฏู ุขุชูโูุง ฺฉูุฏุชุฑ ุงุฒ ุญุช ImmutableList<T> ุงุณุชุ ุฒุฑุง ุณุงุฎุชุงุฑ ูุจู ูุงุจู ุงุณุชูุงุฏู ูุฌุฏุฏ ูุณุช.

ุจูุงุจุฑุงูุ **ImmutableArray<T>** ุฒูุงู ูุทููุจ ุงุณุช ฺฉู ุจุฎูุงูุฏ **ุนููฺฉุฑุฏ ุฎูุงูุฏู ุจุฏูู ูุญุฏูุฏุช** ุฏุงุดุชู ุจุงุดุฏ ู ุงูุชุธุงุฑ **ุงุถุงูู/ุญุฐู ูฺฉุฑุฑ ุขุชูโูุง** ุฑุง ูุฏุงุดุชู ุจุงุดุฏ (ุจุฏูู ุงุณุชูุงุฏู ุงุฒ Builder).
<div align="center">

![Conventions-UsedThis-Book](../../../assets/image/07/Table-7-8.jpeg)
</div>

### โ ูุฒูู ุญุฐู ุฏุฑ ImmutableArray

ูุฑุงุฎูุงู **Remove** ุฑู **ImmutableArray** ฺฏุฑุงูโุชุฑ ุงุฒ ูุฑุงุฎูุงู ููุงู ูุชุฏ ุฑู **List<T>** ุงุณุช โ ุญุช ุฏุฑ **ุจุฏุชุฑู ุญุงูุช** ฺฉู ุงููู ุนูุตุฑ ุญุฐู ุดูุฏ โ ุฒุฑุง **ุงุฌุงุฏ ูุฌููุนู ุฌุฏุฏ ูุดุงุฑ ุงุถุงู ุฑู Garbage Collector ูุงุฑุฏ ูโฺฉูุฏ**.

ุจุง ูุฌูุฏ ุงูฺฉู ูุฌููุนูโูุง immutable ุจูโุทูุฑ ฺฉู **ูุฒูู ุนููฺฉุฑุฏ ูุงุจู ุชูุฌู** ุฏุงุฑูุฏุ ุงูุง ุจุงุฏ **ูุฒุงู ูุงูุน ุฑุง ุฏุฑฺฉ ฺฉุฑุฏ**. ุจุฑุง ูุซุงูุ ฺฉ ุนููุงุช **Add** ุฑู ฺฉ **ImmutableList** ุจุง ฺฉ ูููู ุนูุตุฑุ ุงุญุชูุงูุงู **ฺฉูุชุฑ ุงุฒ ฺฉ ูฺฉุฑูุซุงูู** ุฏุฑ ฺฉ ููพโุชุงูพ ูุนููู ุทูู ูโฺฉุดุฏุ ู ฺฉ ุนููุงุช ุฎูุงูุฏู ุฏุฑ **ฺฉูุชุฑ ุงุฒ 100 ูุงููุซุงูู** ุงูุฌุงู ูโุดูุฏ.

ููฺูู ุงฺฏุฑ ูุงุฒ ุจุงุดุฏ **ุนููุงุช ููุดุชู ุฏุฑ ุญููู** ุงูุฌุงู ุดูุฏุ ูโุชูุงู ุจุง ุงุณุชูุงุฏู ุงุฒ **Builder** ุงุฒ ูุฒูู ุชุฌูุน ุฌููฺฏุฑ ฺฉุฑุฏ.

---

### โก ฺฉุงูุด ูุฒููโูุง ุฏุฑ Immutable Collections

ุนูุงูู ุฒุฑ ุจู ฺฉุงูุด ูุฒููโูุง ฺฉูฺฉ ูโฺฉููุฏ:

* **Immutable ุจูุฏู** ุงูฺฉุงู **ููุฒูุงู ู ูพุฑุฏุงุฒุด ููุงุฒ ุณุงุฏู** ุฑุง ูุฑุงูู ูโฺฉูุฏ (Chapter 23)ุ ุจูุงุจุฑุงู ูโุชูุงู ุงุฒ ููู ูุณุชูโูุง ูพุฑุฏุงุฒูุฏู ุงุณุชูุงุฏู ฺฉุฑุฏ. ูพุฑุฏุงุฒุด ููุงุฒ ุจุง ุญุงูุช mutable ุจูโุฑุงุญุช ููุฌุฑ ุจู ุฎุทุง ูโุดูุฏ ู ูุงุฒ ุจู ูููโูุง ุง ูุฌููุนูโูุง ููุฒูุงู ุฏุงุฑุฏ ฺฉู ูุฑ ุฏู ุนููฺฉุฑุฏ ุฑุง ฺฉุงูุด ูโุฏููุฏ.
* ุจุง **Immutable ุจูุฏู** ูุงุฒ ุจู **ฺฉูพ ุญูุงุธุช (defensive copy)** ุงุฒ ูุฌููุนูโูุง ุง ุณุงุฎุชุงุฑูุง ุฏุงุฏู ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุชุบุฑุงุช ุบุฑููุชุธุฑู ูุณุช. ุงู ฺฉ ุงุฒ ุฏูุงู ุงุณุช ฺฉู ุฏุฑ ููุดุชู ุจุฎุดโูุง ุงุฎุฑ **Visual Studio** ุงุฒ ูุฌููุนูโูุง immutable ุงุณุชูุงุฏู ุดุฏ.
* ุฏุฑ ุงฺฉุซุฑ ุจุฑูุงููโูุง ูุนูููุ ุชุนุฏุงุฏ ฺฉู ุงุฒ ูุฌููุนูโูุง ุฏุงุฑุง ุขุชู ฺฉุงู ูุณุชูุฏ ฺฉู ุชูุงูุช ููููุณ ุจุงุดุฏ.

ุนูุงูู ุจุฑ **Visual Studio**ุ **Microsoft Roslyn** ูุฒ ุจุง ุงุณุชูุงุฏู ุงุฒ ูุฌููุนูโูุง immutable ุณุงุฎุชู ุดุฏู ุงุณุชุ ฺฉู ูุดุงู ูโุฏูุฏ ูุฒุงุง ูโุชูุงููุฏ ุจุฑ ูุฒููโูุง ุบุงูุจ ุดููุฏ.

---

### โ๏ธ Frozen Collections

ุงุฒ **.NET 8**ุ ูุถุง ูุงู **System.Collections.Frozen** ุดุงูู ุฏู ฺฉูุงุณ **ูุฌููุนู ููุทโุฎูุงูุฏู** ุงุณุช:

* `FrozenDictionary<TKey,TValue>`
* `FrozenSet<T>`

ุงู ูุฌููุนูโูุง ูุดุงุจู **ImmutableDictionary\<K,V>** ู **ImmutableHashSet<T>** ูุณุชูุฏุ ุงูุง **ูุชุฏูุง ุจุฑุง nondestructive mutation** (ูุซู Add ุง Remove) ูุฏุงุฑูุฏ ู ุจูุงุจุฑุงู **ุนููฺฉุฑุฏ ุฎูุงูุฏู ุจูููโุง ุฏุงุฑูุฏ**.

ุจุฑุง ุงุฌุงุฏ ฺฉ **Frozen Collection**ุ ุงุจุชุฏุง ุจุง ฺฉ ูุฌููุนู ุง ุฏูุจุงูู ุดุฑูุน ูโฺฉูุฏ ู ุณูพุณ ุงุฒ **extension method**ูุง `ToFrozenDictionary` ุง `ToFrozenSet` ุงุณุชูุงุฏู ูโฺฉูุฏ:

```csharp
int[] numbers = { 10, 20, 30 };
FrozenSet<int> frozen = numbers.ToFrozenSet();
Console.WriteLine(frozen.Contains(10));  // True
```

ูุฌููุนูโูุง frozen ุจุฑุง **ุฌุณุชุฌููุง ฺฉู ุฏุฑ ุงุจุชุฏุง ุจุฑูุงูู ููุฏุงุฑุฏู ูโุดููุฏ ู ุฏุฑ ุทูู ุจุฑูุงูู ุงุณุชูุงุฏู ูโุดููุฏ** ุนุงู ูุณุชูุฏ:

```csharp
class Disassembler
{
    public readonly static IReadOnlyDictionary<string,string> OpCodeLookup =
        new Dictionary<string, string>()
        {
            { "ADC", "Add with Carry" },
            { "ADD", "Add" },
            { "AND", "Logical AND" },
            { "ANDN", "Logical AND NOT" },
            ...
        }
        .ToFrozenDictionary();
    ...
}
```

ูุฌููุนูโูุง frozen **ุฑุงุจุท ุงุณุชุงูุฏุงุฑุฏ dictionary/set** ู ูุณุฎูโูุง ููุทโุฎูุงูุฏู ุขูโูุง ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉููุฏ. ุฏุฑ ูุซุงู ุจุงูุงุ **FrozenDictionary\<string,string>** ุจูโุนููุงู **ููุฏ ุงุฒ ููุน IReadOnlyDictionary\<string,string>** ุฏุฑ ุฏุณุชุฑุณ ูุฑุงุฑ ฺฏุฑูุชู ุงุณุช.

---

### โ๏ธ Plugging in Equality and Order

ุฏุฑ ุจุฎุดโูุง **โEquality Comparisonโ** (ุตูุญู 226) ู **โOrder Comparisonโ** (ุตูุญู 355) ูพุฑูุชฺฉูโูุง ุงุณุชุงูุฏุงุฑุฏ .NET ุชูุถุญ ุฏุงุฏู ุดุฏ ฺฉู ฺฉ ููุน ุฑุง **ูุงุจู ููุงุณูุ ูุงุจู ูุด ู equatable** ูโฺฉููุฏ.

ฺฉ ููุน ฺฉู ุงู ูพุฑูุชฺฉูโูุง ุฑุง ูพุงุฏูโุณุงุฒ ฺฉูุฏุ ูโุชูุงูุฏ ุจูโุทูุฑ ุตุญุญ ุฏุฑ **dictionary** ุง **sorted list** ุงุณุชูุงุฏู ุดูุฏ:

* ููุน ฺฉู **Equals** ู **GetHashCode** ูุชุงุฌ ูุนูุงุฏุงุฑ ุจุฑูโฺฏุฑุฏุงูุฏุ ูโุชูุงูุฏ ุจูโุนููุงู **ฺฉูุฏ ุฏุฑ Dictionary ุง Hashtable** ุงุณุชูุงุฏู ุดูุฏ.
* ููุน ฺฉู **IComparable / IComparable<T>** ูพุงุฏูโุณุงุฒ ฺฉูุฏุ ูโุชูุงูุฏ ุจูโุนููุงู **ฺฉูุฏ ุฏุฑ ูุฑ dictionary ุง ูุณุช ูุฑุชุจ ุดุฏู** ุงุณุชูุงุฏู ุดูุฏ.

ูพุงุฏูโุณุงุฒ ูพุดโูุฑุถ ูุนูููุงู ุฑูุชุงุฑ ุทุจุน ููุน ุฑุง ุจุงุฒุชุงุจ ูโุฏูุฏุ ุงูุง ฺฏุงู ุงููุงุช ูุงุฒู ุงุณุช ุฑูุชุงุฑ ูุชูุงูุช ุฏุงุดุชู ุจุงุดุฏ. ุจุฑุง ูุซุงู:

* ฺฉ dictionary ุจุง **ฺฉูุฏูุง string ุจุฏูู ุญุณุงุณุช ุจู ุญุฑูู**
* ุง ฺฉ **sorted list ุงุฒ ูุดุชุฑุงูุ ูุฑุชุจโุดุฏู ุจุฑ ุงุณุงุณ ฺฉุฏูพุณุช**

ุจู ููู ุฏููุ .NET ูุฌููุนูโุง ุงุฒ **โplug-inโ ูพุฑูุชฺฉูโูุง** ุฑุง ุชุนุฑู ฺฉุฑุฏู ุงุณุช. ุงู ูพุฑูุชฺฉูโูุง ุฏู ฺฉุงุฑ ุงูุฌุงู ูโุฏููุฏ:

* ุงูฺฉุงู **ุฌุงฺฏุฒู ุฑูุชุงุฑ ูพุดโูุฑุถ ุจุฑุง ููุงุณู ู ุจุฑุงุจุฑ**
* ุงุณุชูุงุฏู ุงุฒ dictionary ุง ูุฌููุนู ูุฑุชุจ ุจุง **ููุน ฺฉูุฏ ฺฉู ุจูโุทูุฑ ุฐุงุช equatable ุง comparable ูุณุช**

ูพุฑูุชฺฉูโูุง plug-in ุดุงูู **interfaceูุง ุฒุฑ** ูุณุชูุฏ:

**IEqualityComparer ู IEqualityComparer<T>**

* ุงูุฌุงู **ููุงุณู ู ูุดูฺฏ ุฌุงฺฏุฒู**
* ุชูุณุท **Hashtable ู Dictionary** ุดูุงุฎุชู ูโุดูุฏ

**IComparer ู IComparer<T>**

* ุงูุฌุงู **ููุงุณู ุชุฑุชุจ ุฌุงฺฏุฒู**
* ุชูุณุท **sorted dictionaries ู collections** ุดูุงุฎุชู ูโุดูุฏุ ููฺูู ุชูุณุท **Array.Sort**

ูุฑ interface ูู **ูุณุฎู generic ู nongeneric** ุฏุงุฑุฏ.
ููฺููุ **IEqualityComparer** ุดุงูู ฺฉ **ูพุงุฏูโุณุงุฒ ูพุดโูุฑุถ ุฏุฑ ฺฉูุงุณ EqualityComparer** ุงุณุช.
ุนูุงูู ุจุฑ ุงูุ **interfaceูุง ุจู ูุงู IStructuralEquatable ู IStructuralComparable** ูุฌูุฏ ุฏุงุฑูุฏ ฺฉู ุงูฺฉุงู **ููุงุณูโูุง ุณุงุฎุชุงุฑ (structural comparisons)** ุฑุง ุจุฑุง ฺฉูุงุณโูุง ู ุขุฑุงูโูุง ูุฑุงูู ูโฺฉููุฏ.

---

### โ๏ธ IEqualityComparer ู EqualityComparer

ฺฉ **equality comparer** ุงู ุงูฺฉุงู ุฑุง ูุฑุงูู ูโฺฉูุฏ ฺฉู ุฑูุชุงุฑ **ุจุฑุงุจุฑ ู ูุดูฺฏ ุบุฑูพุดโูุฑุถ** ุฌุงฺฏุฒู ุดูุฏุ ุนูุฏุชุงู ุจุฑุง ฺฉูุงุณโูุง **Dictionary** ู **Hashtable**.

ุจู ุงุฏ ุจุงูุฑุฏ ฺฉู ฺฉ **dictionary ูุจุชู ุจุฑ hashtable** ุจู ุฏู ุณุคุงู ุจุฑุง ูุฑ ฺฉูุฏ ูุงุฒ ุฏุงุฑุฏ:

* ุขุง ุงู ฺฉูุฏ **ููุงููุฏ ฺฉูุฏ ุฏฺฏุฑ** ุงุณุชุ
* **HashCode ุตุญุญ** ุขู ฺุณุชุ

ฺฉ equality comparer ุจู ุงู ุฏู ุณุคุงู ูพุงุณุฎ ูโุฏูุฏ ุจุง ูพุงุฏูโุณุงุฒ **interfaceูุง IEqualityComparer**:

```csharp
public interface IEqualityComparer<T>
{
    bool Equals(T x, T y);
    int GetHashCode(T obj);
}

public interface IEqualityComparer   // ูุณุฎู nongeneric
{
    bool Equals(object x, object y);
    int GetHashCode(object obj);
}
```

ุจุฑุง ููุดุชู **comparer ุณูุงุฑุด**ุ ูโุชูุงูุฏ ฺฉ ุง ูุฑ ุฏู interface ุฑุง ูพุงุฏูโุณุงุฒ ฺฉูุฏ (ูพุงุฏูโุณุงุฒ ูุฑ ุฏู ุญุฏุงฺฉุซุฑ ุณุงุฒฺฏุงุฑ ุฑุง ูุฑุงูู ูโฺฉูุฏ).

ฺูู ุงู ฺฉุงุฑ ฺฉู ููุชโฺฏุฑ ุงุณุชุ ฺฉ ุฌุงฺฏุฒู ุงุณุชูุงุฏู ุงุฒ **ฺฉูุงุณ ุงูุชุฒุงุน EqualityComparer** ุงุณุช:

```csharp
public abstract class EqualityComparer<T> : IEqualityComparer, IEqualityComparer<T>
{
    public abstract bool Equals(T x, T y);
    public abstract int GetHashCode(T obj);

    bool IEqualityComparer.Equals(object x, object y);
    int IEqualityComparer.GetHashCode(object obj);
    public static EqualityComparer<T> Default { get; }
}
```

ฺฉูุงุณ **EqualityComparer** ูุฑ ุฏู interface ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉูุฏ ู ุชููุง ฺฉุงุฑ ฺฉู ุดูุง ุจุงุฏ ุงูุฌุงู ุฏูุฏุ **override ฺฉุฑุฏู ุฏู ูุชุฏ ุงูุชุฒุงุน** ุงุณุช.

---

### ๐งพ ูุซุงู: Customer ู EqualityComparer ุณูุงุฑุด

ูุซูุงู ฺฉ ฺฉูุงุณ **Customer** ุจุง ุฏู ููุฏ ุฏุงุฑู ู ฺฉ equality comparer ูโููุณู ฺฉู ูุฑ ุฏู **ูุงู ู ูุงู ุฎุงููุงุฏฺฏ** ุฑุง ููุงุณู ฺฉูุฏ:

```csharp
public class Customer
{
    public string LastName;
    public string FirstName;
    public Customer(string last, string first)
    {
        LastName = last;
        FirstName = first;
    }
}

public class LastFirstEqComparer : EqualityComparer<Customer>
{
    public override bool Equals(Customer x, Customer y)
        => x.LastName == y.LastName && x.FirstName == y.FirstName;
    public override int GetHashCode(Customer obj)
        => (obj.LastName + ";" + obj.FirstName).GetHashCode();
}
```

ุญุงูุง ุฏู customer ุงุฌุงุฏ ูโฺฉูู:

```csharp
Customer c1 = new Customer("Bloggs", "Joe");
Customer c2 = new Customer("Bloggs", "Joe");
```

ฺูู **object.Equals** ุฑุง override ูฺฉุฑุฏูโุงูุ ุฑูุชุงุฑ ูพุดโูุฑุถ **reference equality** ุงุนูุงู ูโุดูุฏ:

```csharp
Console.WriteLine(c1 == c2);       // False
Console.WriteLine(c1.Equals(c2));  // False
```

ุฏุฑ ุงุณุชูุงุฏู ุงุฒ Dictionary ุจุฏูู ุชุนู equality comparerุ ููู ุฑูุชุงุฑ ูพุดโูุฑุถ ุงุนูุงู ูโุดูุฏ:

```csharp
var d = new Dictionary<Customer, string>();
d[c1] = "Joe";
Console.WriteLine(d.ContainsKey(c2));  // False
```

ุงูุง ุจุง ุงุณุชูุงุฏู ุงุฒ equality comparer ุณูุงุฑุด:

```csharp
var eqComparer = new LastFirstEqComparer();
var d = new Dictionary<Customer, string>(eqComparer);
d[c1] = "Joe";
Console.WriteLine(d.ContainsKey(c2));  // True
```

โ๏ธ ูฺฉุชู: ููฺฏุงู ุงุณุชูุงุฏู ุงุฒ Dictionary ุจุง ฺฉ **comparer ุณูุงุฑุด**ุ ุจุงุฏ ูุฑุงูุจ ุจุงุดุฏ ฺฉู **FirstName ุง LastName ูุดุชุฑ ุชุบุฑ ูฺฉูุฏ**ุ ฺูู ุชุบุฑ HashCode ุจุงุนุซ ุดฺฉุณุชู Dictionary ูโุดูุฏ.

---

### โ EqualityComparer<T>.Default

ูุฑุงุฎูุงู `EqualityComparer<T>.Default` ฺฉ **equality comparer ุนููู** ุจุฑูโฺฏุฑุฏุงูุฏ ฺฉู ูโุชูุงู ุขู ุฑุง ุจู ุฌุง **object.Equals** ุงุณุชูุงุฏู ฺฉุฑุฏ.
ูุฒุช ุขู ุงู ุงุณุช ฺฉู ุงุจุชุฏุง ุจุฑุฑุณ ูโฺฉูุฏ ุขุง **T IEquatable<T>** ูพุงุฏูโุณุงุฒ ฺฉุฑุฏู ุงุณุช ุง ุฎุฑุ ู ุงฺฏุฑ ฺฉุฑุฏู ุจุงุดุฏุ ุขู ูพุงุฏูโุณุงุฒ ุฑุง ูุฑุงุฎูุงู ูโฺฉูุฏ ู ุงุฒ **boxing overhead** ุฌููฺฏุฑ ูโฺฉูุฏ.

ูุซุงู:

```csharp
static bool Foo<T>(T x, T y)
{
    bool same = EqualityComparer<T>.Default.Equals(x, y);
    ...
}
```

---

### ๐งฉ ReferenceEqualityComparer.Instance (.NET 5+)

ุงุฒ **.NET 5**ุ `ReferenceEqualityComparer.Instance` ฺฉ **equality comparer** ุจุฑูโฺฏุฑุฏุงูุฏ ฺฉู ููุดู **referential equality** ุฑุง ุงุนูุงู ูโฺฉูุฏ.
ุฏุฑ ููุฑุฏ **value types**ุ ูุชุฏ **Equals** ุขู ููุดู **false** ุจุฑูโฺฏุฑุฏุงูุฏ.

### ๐ท๏ธ IComparer ู Comparer

**Comparers** ุจุฑุง ุฌุงฺฏุฒู ููุทู **ูุฑุชุจโุณุงุฒ ุณูุงุฑุด** ุฏุฑ **dictionaries ู collectionูุง ูุฑุชุจ** ุงุณุชูุงุฏู ูโุดููุฏ.

ุชูุฌู ฺฉูุฏ ฺฉู **comparerูุง ุจุฑุง ุฏฺฉุดูุฑโูุง ุจุฏูู ุชุฑุชุจ** ูุงููุฏ **Dictionary** ู **Hashtable** ฺฉุงุฑุจุฑุฏ ูุฏุงุฑูุฏโฺุฑุง ฺฉู ุงูโูุง ูุงุฒ ุจู **IEqualityComparer** ุจุฑุง ฺฏุฑูุชู hashcode ุฏุงุฑูุฏ.
ุจู ููู ุชุฑุชุจุ ฺฉ **equality comparer** ุจุฑุง ุฏฺฉุดูุฑโูุง ุง collectionูุง ูุฑุชุจ ฺฉุงุฑุจุฑุฏ ูุฏุงุฑุฏ.

ุชุนุงุฑู interface **IComparer** ุจู ุดุฑุญ ุฒุฑ ุงุณุช:

```csharp
public interface IComparer
{
    int Compare(object x, object y);
}

public interface IComparer<in T>
{
    int Compare(T x, T y);
}
```

ููุงููุฏ **equality comparers**ุ ฺฉ ฺฉูุงุณ ุงูุชุฒุงุน ูุฌูุฏ ุฏุงุฑุฏ ฺฉู ูโุชูุงูุฏ ุขู ุฑุง subclass ฺฉูุฏ ุจู ุฌุง ูพุงุฏูโุณุงุฒ ูุณุชูู interfaceูุง:

```csharp
public abstract class Comparer<T> : IComparer, IComparer<T>
{
    public static Comparer<T> Default { get; }
    public abstract int Compare(T x, T y);          // ุชูุณุท ุดูุง ูพุงุฏูโุณุงุฒ ูโุดูุฏ
    int IComparer.Compare(object x, object y);     // ุจุฑุง ุดูุง ูพุงุฏูโุณุงุฒ ุดุฏู
}
```

---

### ูุซุงู: ูุฑุชุจโุณุงุฒ Wish ุจุฑ ุงุณุงุณ Priority

```csharp
class Wish
{
    public string Name;
    public int Priority;
    public Wish(string name, int priority)
    {
        Name = name;
        Priority = priority;
    }
}

class PriorityComparer : Comparer<Wish>
{
    public override int Compare(Wish x, Wish y)
    {
        if (object.Equals(x, y)) return 0;    // ุจูููโุณุงุฒ
        if (x == null) return -1;
        if (y == null) return 1;
        return x.Priority.CompareTo(y.Priority);
    }
}
```

โ ูฺฉุชู: ุจุฑุฑุณ `object.Equals` ุงุทููุงู ูโุฏูุฏ ฺฉู ูฺโฺฏุงู ุจุง ุฑูุด `Equals` ุชูุงูุถ ูพุฏุง ูฺฉูู. ุงุณุชูุงุฏู ุงุฒ ูุชุฏ **static object.Equals** ุจูุชุฑ ุงุฒ `x.Equals` ุงุณุช ฺูู ุญุช ููุช `x` ุจุฑุงุจุฑ null ุงุณุชุ ฺฉุงุฑ ูโฺฉูุฏ.

ูุฑุชุจโุณุงุฒ ฺฉ ูุณุช ุจุง ุงุณุชูุงุฏู ุงุฒ **PriorityComparer**:

```csharp
var wishList = new List<Wish>();
wishList.Add(new Wish("Peace", 2));
wishList.Add(new Wish("Wealth", 3));
wishList.Add(new Wish("Love", 2));
wishList.Add(new Wish("3 more wishes", 1));

wishList.Sort(new PriorityComparer());

foreach (Wish w in wishList)
    Console.Write(w.Name + " | ");
// OUTPUT: 3 more wishes | Love | Peace | Wealth |
```

---

### ูุซุงู: ูุฑุชุจโุณุงุฒ ุฑุดุชูโูุง ุจุฑุง ุฏูุชุฑฺู ุชููู

```csharp
class SurnameComparer : Comparer<string>
{
    string Normalize(string s)
    {
        s = s.Trim().ToUpper();
        if (s.StartsWith("MC")) s = "MAC" + s.Substring(2);
        return s;
    }
    public override int Compare(string x, string y)
        => Normalize(x).CompareTo(Normalize(y));
}
```

ุงุณุชูุงุฏู ุฏุฑ ฺฉ **SortedDictionary**:

```csharp
var dic = new SortedDictionary<string, string>(new SurnameComparer());
dic.Add("MacPhail", "second!");
dic.Add("MacWilliam", "third!");
dic.Add("McDonald", "first!");

foreach (string s in dic.Values)
    Console.Write(s + " ");  // first! second! third!
```

---

### ๐ค StringComparer

`StringComparer` ฺฉ ฺฉูุงุณ plug-in ูพุดโูุฑุถ ุจุฑุง **ุจุฑุงุจุฑ ู ููุงุณู ุฑุดุชูโูุง** ุงุณุช ฺฉู ุงูฺฉุงู ุชุนู **ุฒุจุงู ู ุญุณุงุณุช ุจู ุญุฑูู ุจุฒุฑฺฏ/ฺฉูฺฺฉ** ุฑุง ูโุฏูุฏ.
ุงู ฺฉูุงุณ ูู **IEqualityComparer** ู ูู **IComparer** (ูุณุฎูโูุง generic ู nongeneric) ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉูุฏุ ุจูุงุจุฑุงู ูโุชูุงู ุงุฒ ุขู ุจุง ูุฑ ููุน dictionary ุง collection ูุฑุชุจ ุงุณุชูุงุฏู ฺฉุฑุฏ.

ฺูู StringComparer ุงูุชุฒุงุน ุงุณุชุ ูููููโูุง ุงุฒ ุทุฑู **static properties** ุขู ุจุฏุณุช ูโุขูุฏ:

```csharp
public static StringComparer CurrentCulture { get; }
public static StringComparer CurrentCultureIgnoreCase { get; }
public static StringComparer InvariantCulture { get; }
public static StringComparer InvariantCultureIgnoreCase { get; }
public static StringComparer Ordinal { get; }
public static StringComparer OrdinalIgnoreCase { get; }
public static StringComparer Create(CultureInfo culture, bool ignoreCase);
```

ูุซุงู: ุฏฺฉุดูุฑ ุญุณุงุณ ุจู ุญุฑูู ฺฉู `"Joe"` ู `"JOE"` ุฑุง ุจุฑุงุจุฑ ูโุฏุงูุฏ:

```csharp
var dict = new Dictionary<string, int>(StringComparer.OrdinalIgnoreCase);
```

ูุซุงู ูุฑุชุจโุณุงุฒ ุขุฑุงูโุง ุจุง ุฒุจุงู **ุงูฺฏูุณ ุงุณุชุฑุงูุง**:

```csharp
string[] names = { "Tom", "HARRY", "sheila" };
CultureInfo ci = new CultureInfo("en-AU");
Array.Sort<string>(names, StringComparer.Create(ci, false));
```

ูุณุฎูโุง culture-aware ุงุฒ **SurnameComparer**:

```csharp
class SurnameComparer : Comparer<string>
{
    StringComparer strCmp;
    public SurnameComparer(CultureInfo ci)
    {
        // ุงุฌุงุฏ string comparer ุญุณุงุณ ุจู ูุฑููฺฏ ู ุญุณุงุณ ุจู ุญุฑูู
        strCmp = StringComparer.Create(ci, false);
    }

    string Normalize(string s)
    {
        s = s.Trim();
        if (s.ToUpper().StartsWith("MC")) s = "MAC" + s.Substring(2);
        return s;
    }

    public override int Compare(string x, string y)
    {
        return strCmp.Compare(Normalize(x), Normalize(y));
    }
}
```

---

### โ๏ธ IStructuralEquatable ู IStructuralComparable

ููุงูโุทูุฑ ฺฉู ุฏุฑ ูุตู ถ ฺฏูุชูุ **structูุง ุจู ุทูุฑ ูพุดโูุฑุถ** ููุงุณู ุณุงุฎุชุงุฑ ุฏุงุฑูุฏ: ุฏู struct ุจุฑุงุจุฑ ูุณุชูุฏ ุงฺฏุฑ ุชูุงู ููุฏูุงุดุงู ุจุฑุงุจุฑ ุจุงุดูุฏ.
ฺฏุงู ุงููุงุชุ **ุจุฑุงุจุฑ ู ูุฑุชุจโุณุงุฒ ุณุงุฎุชุงุฑ** ุจุฑุง ุงููุงุน ุฏฺฏุฑ ูุงููุฏ ุขุฑุงูโูุง ูุฒ ููุฏ ุงุณุช.

```csharp
public interface IStructuralEquatable
{
    bool Equals(object other, IEqualityComparer comparer);
    int GetHashCode(IEqualityComparer comparer);
}

public interface IStructuralComparable
{
    int CompareTo(object other, IComparer comparer);
}
```

**IEqualityComparer / IComparer** ฺฉู ูพุงุณ ุฏุงุฏู ูโุดููุฏุ ุฑู **ูุฑ ุนูุตุฑ ุงุฒ ุดุก ูุฑฺฉุจ** ุงุนูุงู ูโุดููุฏ.

ูุซุงู ููุงุณู ุขุฑุงูโูุง:

```csharp
int[] a1 = { 1, 2, 3 };
int[] a2 = { 1, 2, 3 };
IStructuralEquatable se1 = a1;

Console.Write(a1.Equals(a2));                                  // False
Console.Write(se1.Equals(a2, EqualityComparer<int>.Default));  // True
```

ูุซุงู ุฏฺฏุฑ:

```csharp
string[] a1 = "the quick brown fox".Split();
string[] a2 = "THE QUICK BROWN FOX".Split();
IStructuralEquatable se1 = a1;
bool isTrue = se1.Equals(a2, StringComparer.InvariantCultureIgnoreCase);
```
