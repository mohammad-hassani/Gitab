# ูุตู ฺูุงุฑู: ุณ ุดุงุฑูพ ูพุดุฑูุชู

ุฏุฑ ุงู ูุตูุ ุจู ุณุฑุงุบ ูุจุงุญุซ ูพุดุฑูุชู ุฒุจุงู C# ูโุฑูู ฺฉู ุจุฑ ูพุงู ููุงูู ุจูุง ุดุฏูโุงูุฏ ฺฉู ุฏุฑ ูุตูโูุง 2 ู 3 ุจุฑุฑุณ ฺฉุฑุฏู.
ฺูุงุฑ ุจุฎุด ุงูู ุฑุง ุจุงุฏ ุจู ุตูุฑุช ูพูุณุชู ู ูพุดุช ุณุฑ ูู ูุทุงูุนู ฺฉูุฏุ ุงูุง ุจุฎุดโูุง ุจุงูโูุงูุฏู ุฑุง ูโุชูุงูุฏ ุจู ูุฑ ุชุฑุชุจ ุจุฎูุงูุฏ.

### Delegates (ููุงูุฏฺฏุงู) ๐จ

ฺฉ delegate ฺฉ ุดุก ุงุณุช ฺฉู ูโุฏุงูุฏ ฺฺฏููู ฺฉ ูุชุฏ ุฑุง ูุฑุงุฎูุงู ฺฉูุฏ.

ููุน delegate ุชุนู ูโฺฉูุฏ ฺฉู ูููููโูุง delegate ูโุชูุงููุฏ ฺู ููุน ูุชุฏูุง ุฑุง ูุฑุงุฎูุงู ฺฉููุฏ. ุจู ุทูุฑ ูุดุฎุตุ ฺฉ delegate ููุน ุจุงุฒฺฏุดุช ูุชุฏ ู ุงููุงุน ูพุงุฑุงูุชุฑูุง ูุชุฏ ุฑุง ุชุนุฑู ูโฺฉูุฏ.

ูุซุงู: ุชุนุฑู ฺฉ ููุน delegate ุจู ูุงู Transformer:

```c#
delegate int Transformer(int x);
```

ุงู delegate ุจุง ูุฑ ูุชุฏ ฺฉู ุจุงุฒฺฏุดุช ุงุฒ ููุน int ุฏุงุดุชู ุจุงุดุฏ ู ฺฉ ูพุงุฑุงูุชุฑ int ุจฺฏุฑุฏ ุณุงุฒฺฏุงุฑ ุงุณุช. ูุซู ุงู:

```c#
int Square(int x) { return x * x; }
```

ุง ุจู ุตูุฑุช ฺฉูุชุงูโุชุฑ (expression-bodied):

```c#
int Square(int x) => x * x;
```

**ุณุงุฎุชู ู ุงุณุชูุงุฏู ุงุฒ ฺฉ delegate ๐๏ธ**

ุงุฎุชุตุงุต ฺฉ ูุชุฏ ุจู ฺฉ ูุชุบุฑ delegateุ ุจุงุนุซ ุงุฌุงุฏ ฺฉ ููููู delegate ูโุดูุฏ:

```c#
Transformer t = Square;
```

ูุฑุงุฎูุงู ฺฉ ููููู delegate ุฏููุงู ูุซู ูุฑุงุฎูุงู ฺฉ ูุชุฏ ุงุณุช:

```c#
int answer = t(3);   // answer ุจุฑุงุจุฑ ุจุง 9
```

ูุซุงู ฺฉุงูู:

```c#
Transformer t = Square;   // ุงุฌุงุฏ ููููู delegate
int result = t(3);        // ูุฑุงุฎูุงู delegate
Console.WriteLine(result); // ุฎุฑูุฌ: 9

int Square(int x) => x * x;

delegate int Transformer(int x);  // ุชุนุฑู ููุน delegate
```

**ููููู ุงุตู delegate ๐ฏ**

ฺฉ ููููู delegate ูุงูุนุงู ุจู ุนููุงู ููุงูุฏูโ caller ุนูู ูโฺฉูุฏ:
caller (ูุฑุงุฎูุงููุฏู) delegate ุฑุง ูุฑุงุฎูุงู ูโฺฉูุฏ ู ุณูพุณ delegateุ ูุชุฏ ูุฏู ุฑุง ูุฑุงุฎูุงู ูโฺฉูุฏ.

ุงู ูุงุณุทูโฺฏุฑ (indirection) ุจุงุนุซ ูโุดูุฏ ฺฉู caller ุงุฒ ูุชุฏ ูุฏู ุฌุฏุง ู ูุณุชูู ุจุงุดุฏ.

**ูฺฉุชูโูุง ููู โ**

ุฏุณุชูุฑ:

```
Transformer t = Square;
```

ุฏุฑ ูุงูุน ฺฉ ูุงูโุจูุฑ (shorthand) ุจุฑุง ุงู ุงุณุช:

```c#
Transformer t = new Transformer(Square);
```

ุนุจุงุฑุช:

```
t(3)
```

ูุงูโุจูุฑ ุงุณุช ุจุฑุง:

```
t.Invoke(3)
```

ุงุฒ ูุธุฑ ููุ ููุช ุจู Square ุจุฏูู ูพุฑุงูุชุฒ ู ุขุฑฺฏููุงู ุงุดุงุฑู ูโฺฉููุ ุฏุฑ ุญุงู ูุดุฎุต ฺฉุฑุฏู ฺฉ method group ูุณุชู.
ุงฺฏุฑ ูุชุฏ overload ุดุฏู ุจุงุดุฏุ ฺฉุงููพุงูุฑ C# ุจุฑ ุงุณุงุณ ุงูุถุง delegate ุงูุชุฎุงุจ ูโฺฉูุฏ ฺฉู ฺฉุฏุงู overload ููุงุณุจ ุงุณุช.

**Delegate ุดุจู ุจู Callback ๐**

ฺฉ delegate ูุดุงุจู ฺุฒ ุงุณุช ฺฉู ุฏุฑ ุงุตุทูุงุญ ุนููู callback ูุงูุฏู ูโุดูุฏ.
ุงู ููููู ุณุงุฒูโูุง ูุซู function pointers ุฏุฑ ุฒุจุงู C ุฑุง ูุฒ ุฏุฑ ุจุฑ ูโฺฏุฑุฏ.

### ููุดุชู ูุชุฏูุง ูพูุงฺฏู ุจุง ุงุณุชูุงุฏู ุงุฒ Delegateูุง โจ

ฺฉ ูุชุบุฑ ุงุฒ ููุน delegate ุฏุฑ ุฒูุงู ุงุฌุฑุง (runtime) ุจู ฺฉ ูุชุฏ ูุณุจุช ุฏุงุฏู ูโุดูุฏ. ุงู ูฺฺฏ ุจุฑุง ููุดุชู ูุชุฏูุง ูพูุงฺฏู (plug-in methods) ุจุณุงุฑ ฺฉุงุฑุจุฑุฏ ุงุณุช.

ุฏุฑ ูุซุงู ุฒุฑุ ูุง ฺฉ ูุชุฏ ฺฉูฺฉ (utility method) ุจู ูุงู Transform ุฏุงุฑู ฺฉู ฺฉ ุนูู transform ุฑุง ุฑู ูุฑ ุนุถู ุงุฒ ฺฉ ุขุฑุงูโ ุนุฏุฏ (integer array) ุงุนูุงู ูโฺฉูุฏ. ุงู ูุชุฏ Transform ฺฉ ูพุงุฑุงูุชุฑ ุงุฒ ููุน delegate ุฏุงุฑุฏ ฺฉู ูโุชูุงูุฏ ุจุฑุง ูุดุฎุต ฺฉุฑุฏู ูพูุงฺฏู transform ุงุฒ ุขู ุงุณุชูุงุฏู ฺฉูุฏ:

```c#
int[] values = { 1, 2, 3 };
Transform (values, Square);      // ุงุชุตุงู ูุชุฏ Square ุจู Transform
foreach (int i in values)
  Console.Write (i + "  ");      // ุฎุฑูุฌ: 1   4   9

void Transform (int[] values, Transformer t)
{
  for (int i = 0; i < values.Length; i++)
    values[i] = t (values[i]);
}

int Square (int x) => x * x;
int Cube (int x) => x * x * x;

delegate int Transformer (int x);
```

๐น ุฏุฑ ุงูุฌุง ุงฺฏุฑ ุฏุฑ ุฎุท ุฏูู ุจูโุฌุง Square ุงุฒ Cube ุงุณุชูุงุฏู ฺฉููุ ุชุจุฏู ุฑู ุงุนุฏุงุฏ ุจูโุตูุฑุช ูฺฉุนุจ (ุชูุงู ุณูู) ุงูุฌุงู ูโุดูุฏ.

๐น ูุชุฏ Transform ฺฉ higher-order function ุงุณุชุ ฺูู ฺฉ ุชุงุจุน (delegate) ุฑุง ุจูโุนููุงู ุขุฑฺฏููุงู ูโฺฏุฑุฏ. (ูุฑ ูุชุฏ ฺฉู ฺฉ delegate ุฑุง ุจุฑฺฏุฑุฏุงูุฏ ูุฒ ฺฉ higher-order function ูุญุณูุจ ูโุดูุฏ.)

### ุงูุฏุงู ูุชุฏ ุฏุฑ Delegateูุง: Instance ู Static โก

ฺฉ ูุชุฏ ูุฏู (target method) ุจุฑุง ฺฉ delegate ูโุชูุงูุฏ ูุญู (local)ุ ุงุณุชุง (static) ุง ูููููโุง (instance) ุจุงุดุฏ.

ูุซุงู ฺฉ ูุชุฏ static ุจูโุนููุงู ูุฏู delegate:

```c#
Transformer t = Test.Square;
Console.WriteLine (t(10));      // 100

class Test 
{ 
    public static int Square (int x) => x * x; 
}

delegate int Transformer (int x);
```

ูุซุงู ฺฉ ูุชุฏ instance ุจูโุนููุงู ูุฏู delegate:

```c#
Test test = new Test();
Transformer t = test.Square;
Console.WriteLine (t(10));      // 100

class Test 
{ 
    public int Square (int x) => x * x; 
}

delegate int Transformer (int x);
```

๐ ุฒูุงู ฺฉู ฺฉ ูุชุฏ instance ุจู ฺฉ delegate ุงุฎุชุตุงุต ุฏุงุฏู ูโุดูุฏุ ุขู delegate ููุท ุจู ุฎูุฏ ูุชุฏ ุงุดุงุฑู ููโฺฉูุฏุ ุจูฺฉู ูููููโุง ุงุฒ ฺฉูุงุณ ฺฉู ูุชุฏ ุจู ุขู ุชุนูู ุฏุงุฑุฏ ุฑุง ูู ูฺฏูโุฏุงุฑ ูโฺฉูุฏ.

**ุฎุงุตุช Target ุฏุฑ ฺฉูุงุณ System.Delegate ๐ฏ**

ฺฉูุงุณ System.Delegate ฺฉ ูฺฺฏ ุจู ูุงู Target ุฏุงุฑุฏ ฺฉู ุงู ููููู (instance) ุฑุง ูุดุงู ูโุฏูุฏ (ู ุงฺฏุฑ delegate ุจู ฺฉ ูุชุฏ static ุงุดุงุฑู ฺฉูุฏุ ููุฏุงุฑุด null ุฎูุงูุฏ ุจูุฏ).

ูุซุงู:

```c#
MyReporter r = new MyReporter();
r.Prefix = "%Complete: ";

ProgressReporter p = r.ReportProgress;
p(99);                                 // %Complete: 99

Console.WriteLine (p.Target == r);     // True
Console.WriteLine (p.Method);          // Void ReportProgress(Int32)

r.Prefix = "";
p(99);                                 // 99

public delegate void ProgressReporter (int percentComplete);

class MyReporter
{
  public string Prefix = "";
  public void ReportProgress (int percentComplete)
    => Console.WriteLine (Prefix + percentComplete);
}
```

โ ฺูู ููููู (instance) ุฏุฑ ุฎุงุตุช Target ุฐุฎุฑู ูโุดูุฏุ ุทูู ุนูุฑ ุขู ุญุฏุงูู ุจู ุงูุฏุงุฒู ุทูู ุนูุฑ delegate ฺฏุณุชุฑุด ูโุงุจุฏ.

๐ ุฌูุนโุจูุฏ:

+ Delegateูุง ุจู ูุง ุงุฌุงุฒู ูโุฏููุฏ ฺฉู ูุชุฏูุง ุฑุง ูุซู ูุชุบุฑูุง ูพุงุณ ุจุฏูู.

+ ูโุชูุงููุฏ ุจู ูุชุฏูุง static ุง instance ูุชุตู ุดููุฏ.

+ ุฎุงุตุช Target ุชุถูู ูโฺฉูุฏ ฺฉู ููููู ูุฑุจูุท ุจู ูุชุฏ instance ุชุง ููุช delegate ุฒูุฏู ุงุณุชุ ุจุงู ุจูุงูุฏ.

๐ก ุงู ููููู ูพุงูโุง ุฏุฑ ุทุฑุงุญ ูพูุงฺฏูโูุงุ ฺฉุงูโุจฺฉโูุง ู ุจุฑูุงููโููุณ ุดุกฺฏุฑุงุณุช.

### ููุงูุฏฺฏุงู ฺูุฏูพุฎุด (Multicast Delegates) ๐ฏ

ุชูุงู ูููููโูุง delegate ุฏุฑ ุณโุดุงุฑูพ ุฏุงุฑุง ูุงุจูุช ฺูุฏูพุฎุด (multicast) ูุณุชูุฏ. ุงู ุนู ฺฉ ูููููโ delegate ูโุชูุงูุฏ ูู ููุท ุจู ฺฉ ูุชุฏุ ุจูฺฉู ุจู ฺฉ ูุณุช ุงุฒ ูุชุฏูุง ุงุดุงุฑู ฺฉูุฏ.

ุนููฺฏุฑูุง + ู += ุจุฑุง ุชุฑฺฉุจ ฺฉุฑุฏู ูููููโูุง delegate ุงุณุชูุงุฏู ูโุดููุฏ:

```c#
SomeDelegate d = SomeMethod1;
d += SomeMethod2;
```

ุฎุท ุขุฎุฑ ุงุฒ ูุธุฑ ุนููฺฉุฑุฏ ุฏููุงู ูุนุงุฏู ุงู ุงุณุช:

```c#
d = d + SomeMethod2;
```

ุงฺฉููู ููุช d ูุฑุงุฎูุงู ุดูุฏุ ูู SomeMethod1 ู ูู SomeMethod2 ุงุฌุฑุง ูโุดููุฏ.
โ ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ูุชุฏูุง ุจู ุชุฑุชุจ ฺฉู ุงุถุงูู ุดุฏูโุงูุฏ ูุฑุงุฎูุงู ูโุดููุฏ.

ุนููฺฏุฑูุง - ู -= ูู ุจุฑุง ุญุฐู ฺฉ ูุชุฏ ุงุฒ ูุณุช ูุชุฏูุง ฺฉ delegate ุงุณุชูุงุฏู ูโุดููุฏ:

```
d -= SomeMethod1;
```

ุงฺฉููู ูุฑุงุฎูุงู d ุจุงุนุซ ูโุดูุฏ ููุท SomeMethod2 ุงุฌุฑุง ุดูุฏ.

๐ ูฺฉุชู ููู:

+ ููุช ุฑู ฺฉ ูุชุบุฑ delegate ฺฉู ููุฏุงุฑุด null ุงุณุชุ ุนูู + ุง += ุงูุฌุงู ุฏูุฏุ ุจุงุฒ ูู ฺฉุงุฑ ูโฺฉูุฏ ู ูุนุงุฏู ุงู ุงุณุช ฺฉู ุจู ุขู ููุฏุงุฑ ุฌุฏุฏ ุจุฏูุฏ:

```c#
SomeDelegate d = null;
d += SomeMethod1;   // ูุนุงุฏู ุจุง: d = SomeMethod1 ููุช d ุจุฑุงุจุฑ null ุงุณุช
```

+ ุจู ุทูุฑ ูุดุงุจูุ ุงฺฏุฑ ุฑู ฺฉ delegate ฺฉู ููุท ฺฉ ูุชุฏ ุฑุง ูฺฏู ุฏุงุดุชู ุจุงุดุฏ ุนูู -= ฺฉูุฏุ ูุชุฌูโุงุด ูุนุงุฏู ุงุฎุชุตุงุต ููุฏุงุฑ null ุจู ุขู ูุชุบุฑ ุฎูุงูุฏ ุจูุฏ.

โก ฺฉ ูฺฉุชู ููู ุฏฺฏุฑ:
Delegates ุฏุฑ ุณโุดุงุฑูพ immutable ูุณุชูุฏ. ุนู ููุช ุดูุง += ุง -= ุฑุง ุงุณุชูุงุฏู ูโฺฉูุฏุ ุฏุฑ ูุงูุน ฺฉ ูููููโ ุฌุฏุฏ ุงุฒ delegate ุณุงุฎุชู ูโุดูุฏ ู ุจู ูุชุบุฑ ููุฌูุฏ ุงุฎุชุตุงุต ุฏุงุฏู ูโุดูุฏ.

๐ข ุงฺฏุฑ ฺฉ delegate ฺูุฏูพุฎุด (multicast delegate) ุฏุงุฑุง ููุน ุจุงุฒฺฏุดุช ุบุฑ ุงุฒ void ุจุงุดุฏุ ููุฏุงุฑ ุจุงุฒฺฏุดุช ฺฉู ุดูุง ุฏุฑุงูุช ูโฺฉูุฏ ูุฑุจูุท ุจู ุขุฎุฑู ูุชุฏ ุงุณุช ฺฉู ุงุฌุฑุง ุดุฏู ุงุณุช. ูุชุฏูุง ูุจู ููฺูุงู ุงุฌุฑุง ูโุดููุฏุ ุงูุง ููุฏุงุฑ ุจุงุฒฺฏุดุช ุขูโูุง ูุงุฏุฏู ฺฏุฑูุชู ูโุดูุฏ.
(ุจู ููู ุฏููุ ุฏุฑ ุจุดุชุฑ ููุงุฑุฏ ฺฉู ุงุฒ multicast delegate ุงุณุชูุงุฏู ูโุดูุฏุ ุขูโูุง void ุจุฑูโฺฏุฑุฏุงููุฏ.)

๐งฉ ุชูุงู ุงููุงุน delegate ุจู ุทูุฑ ุถูู ุงุฒ System.MulticastDelegate ุงุฑุซโุจุฑ ูโฺฉููุฏ ฺฉู ุฎูุฏุด ุงุฒ System.Delegate ุงุฑุซโุจุฑ ูโฺฉูุฏ.
ฺฉุงููพุงูุฑ ุณโุดุงุฑูพ ุชูุงู ุนููุงุช +ุ -ุ += ู -= ุฑู delegateูุง ุฑุง ุจู ูุชุฏูุง ุงุณุชุงุชฺฉ Combine ู Remove ุงุฒ ฺฉูุงุณ System.Delegate ุชุจุฏู ูโฺฉูุฏ.

#### ูุซุงู Multicast Delegate ๐๏ธ

ูุฑุถ ฺฉูุฏ ฺฉ ูุชุฏ ููุดุชูโุงุฏ ฺฉู ุงุฌุฑุง ุขู ุฒูุงู ุฒุงุฏ ูโุจุฑุฏ. ุงู ูุชุฏ ูโุชูุงูุฏ ุจู ุทูุฑ ููุธู ูุฒุงู ูพุดุฑูุช ฺฉุงุฑ ุฑุง ุจู ูุฑุงุฎูุงููุฏู ฺฏุฒุงุฑุด ุฏูุฏุ ุงู ฺฉุงุฑ ุจุง ูุฑุงุฎูุงู ฺฉ delegate ุงูุฌุงู ูโุดูุฏ.

ุฏุฑ ูุซุงู ุฒุฑุ ูุชุฏ HardWork ฺฉ ูพุงุฑุงูุชุฑ ุงุฒ ููุน delegate ุจู ูุงู ProgressReporter ุฏุฑุงูุช ูโฺฉูุฏ ู ุงุฒ ุขู ุจุฑุง ูุดุงู ุฏุงุฏู ูพุดุฑูุช ุงุณุชูุงุฏู ูโฺฉูุฏ:

```c#
public delegate void ProgressReporter(int percentComplete);

public class Util
{
    public static void HardWork(ProgressReporter p)
    {
        for (int i = 0; i < 10; i++)
        {
            p(i * 10);                           // ูุฑุงุฎูุงู delegate
            System.Threading.Thread.Sleep(100);  // ุดุจูโุณุงุฒ ฺฉุงุฑ ุณูฺฏู
        }
    }
}
```

ุจุฑุง ูุงูุชูุฑ ฺฉุฑุฏู ูุฒุงู ูพุดุฑูุชุ ูโุชูุงูู ฺฉ ูููููโ Multicast Delegate ุจู ูุงู p ุจุณุงุฒู ุชุง ูพุดุฑูุช ููโุฒูุงู ุชูุณุท ุฏู ูุชุฏ ูุณุชูู ุจุฑุฑุณ ุดูุฏ:

```c#
ProgressReporter p = WriteProgressToConsole;
p += WriteProgressToFile;

Util.HardWork(p);

void WriteProgressToConsole(int percentComplete)
    => Console.WriteLine(percentComplete);

void WriteProgressToFile(int percentComplete)
    => System.IO.File.WriteAllText("progress.txt",
                                    percentComplete.ToString());
```

๐ ุฏุฑ ุงูุฌุง ฺู ุงุชูุงู ูโุงูุชุฏุ

1. ุงุจุชุฏุง ฺฉ delegate ุงุฒ ููุน ProgressReporter ุณุงุฎุชู ูโุดูุฏ ู ุจู ูุชุฏ WriteProgressToConsole ุงุดุงุฑู ูโฺฉูุฏ.

2. ุณูพุณ ุจุง ุนููฺฏุฑ +=ุ ูุชุฏ WriteProgressToFile ูู ุจู ุขู ุงุถุงูู ูโุดูุฏ.
ุนู delegate p ุงฺฉููู ฺฉ multicast delegate ุงุณุช.

3. ูุฑ ุจุงุฑ ฺฉู ูุชุฏ HardWork ูพุดุฑูุช ุฑุง ฺฏุฒุงุฑุด ูโุฏูุฏ (p(i * 10))ุ ูุฑ ุฏู ูุชุฏ ุงุฌุฑุง ูโุดููุฏ:

+ WriteProgressToConsole ููุฏุงุฑ ูพุดุฑูุช ุฑุง ุฑู ฺฉูุณูู ฺุงูพ ูโฺฉูุฏ.

+ WriteProgressToFile ููุฏุงุฑ ูพุดุฑูุช ุฑุง ุฏุฑ ฺฉ ูุงู progress.txt ุฐุฎุฑู ูโฺฉูุฏ.

๐ ูุชุฌู ููุง:

+ ุดูุง ููุฒูุงู ุฏุฑ ฺฉูุณูู ูโุจูุฏ ฺฉู ูพุดุฑูุช ฺฉุงุฑ ฺูุฏ ุฏุฑุตุฏ ุงุณุช.

+ ฺฉ ูุงู ูุชู ูู ุฏุงุฑุฏ ฺฉู ููุงู ุงุทูุงุนุงุช ุฑุง ุฐุฎุฑู ูโฺฉูุฏ.

### ุงููุงุน Delegate ุนููู (Generic Delegate Types) โก

ฺฉ delegate ูโุชูุงูุฏ ุดุงูู ูพุงุฑุงูุชุฑูุง ุนููู (Generic Type Parameters) ุจุงุดุฏ:

```c#
public delegate T Transformer<T>(T arg);
```

ุจุง ฺูู ุชุนุฑู ูโุชูุงูู ฺฉ ูุชุฏ ุงุจุฒุงุฑ ุนููู (Utility Method) ุจููุณู ฺฉู ุฑู ูุฑ ููุน ุฏุงุฏูโุง ฺฉุงุฑ ฺฉูุฏ:

```c#
int[] values = { 1, 2, 3 };
Util.Transform(values, Square);      // ุงุชุตุงู ูุชุฏ Square

foreach (int i in values)
    Console.Write(i + "  ");         // ุฎุฑูุฌ: 1   4   9

int Square(int x) => x * x;

public class Util
{
    public static void Transform<T>(T[] values, Transformer<T> t)
    {
        for (int i = 0; i < values.Length; i++)
            values[i] = t(values[i]);
    }
}
```

### Delegates ุขูุงุฏู: Func ู Action โ

ุจุง ูุนุฑู generic delegatesุ ุงู ุงูฺฉุงู ูุฑุงูู ุดุฏ ฺฉู ูุฌููุนูโุง ฺฉูฺฺฉ ุงุฒ delegateูุง ุทุฑุงุญ ุดููุฏ ฺฉู ุขูโูุฏุฑ ุนููู ู ุงูุนุทุงูโูพุฐุฑ ุจุงุดูุฏ ฺฉู ุจุฑุง ูุชุฏูุง ุจุง ูุฑ ููุน ุฎุฑูุฌ ู ูุฑ ุชุนุฏุงุฏ (ูุนููู) ุขุฑฺฏููุงู ูุงุจู ุงุณุชูุงุฏู ุจุงุดูุฏ.

ุงู delegateูุง ููุงู Func ู Action ูุณุชูุฏ ฺฉู ุฏุฑ ูุถุง ูุงู System ุชุนุฑู ุดุฏูโุงูุฏ:

```c#
delegate TResult Func<out TResult>();                
delegate TResult Func<in T, out TResult>(T arg);          
delegate TResult Func<in T1, in T2, out TResult>(T1 arg1, T2 arg2);
// ... ุงุฏุงูู ุฏุงุฑุฏ ุชุง 16 ูพุงุฑุงูุชุฑ

delegate void Action();
delegate void Action<in T>(T arg);
delegate void Action<in T1, in T2>(T1 arg1, T2 arg2);
// ... ุงุฏุงูู ุฏุงุฑุฏ ุชุง 16 ูพุงุฑุงูุชุฑ
```

๐ ุงูโูุง ุจุณุงุฑ ุนููู ู ูุฏุฑุชููุฏ ูุณุชูุฏ.

**ุฌุงฺฏุฒู Transformer ุจุง Func ๐**

ุฏุฑ ูุซุงู ูุจูุ ุจู ุฌุง ุชุนุฑู delegate ุงุฎุชุตุงุต Transformerุ ูโุชูุงูุณุชู ุงุฒ Func ุงุณุชูุงุฏู ฺฉูู:

```c#
public static void Transform<T>(T[] values, Func<T, T> transformer)
{
    for (int i = 0; i < values.Length; i++)
        values[i] = transformer(values[i]);
}
```

ุฏุฑ ุงูุฌุง:

+ Func<T, T> ุนู ฺฉ delegate ฺฉู ฺฉ ูุฑูุฏ ุงุฒ ููุน T ูโฺฏุฑุฏ ู ุฎุฑูุฌ ูู ุงุฒ ููุงู ููุน T ุจุฑูโฺฏุฑุฏุงูุฏ.

+ ุฏููุงู ููุงู ฺุฒ ุงุณุช ฺฉู ูุจูุงู ุจุง Transformer<T> ุณุงุฎุชู ุจูุฏู.

**ูุญุฏูุฏุชโูุง ๐ง**

ุชููุง ุณูุงุฑููุง ุนูู ฺฉู Func ู Action ูพูุดุด ููโุฏููุฏุ ููุงุฑุฏ ูุณุชูุฏ ฺฉู ุดุงูู ูพุงุฑุงูุชุฑูุง ref/out ุง pointer ุจุงุดูุฏ.

**ูฺฉุชู ุชุงุฑุฎ ๐ฐ๏ธ**

ุฒูุงู ฺฉู C# ุจุฑุง ุงููู ุจุงุฑ ูุนุฑู ุดุฏุ ูููุฒ generics ูุฌูุฏ ูุฏุงุดุช. ุจู ููู ุฏููุ Func ู Action ูู ูุฌูุฏ ูุฏุงุดุชูุฏ.
ุจู ููู ุฎุงุทุฑุ ุจุฎุด ุฒุงุฏ ุงุฒ ฺฉุชุงุจุฎุงููโ .NET ุงุฒ delegateูุง ุณูุงุฑุด ุงุณุชูุงุฏู ูโฺฉูุฏุ ูู ุงุฒ Func ู Action.

### ููุงุณู Delegateโูุง ู Interfaceโูุง โ๏ธ

ูุฑ ูุณุฆููโุง ฺฉู ุจุง ฺฉ delegate ุญู ูโุดูุฏุ ูโุชูุงูุฏ ุจุง ฺฉ interface ูู ุญู ุดูุฏ.

ุจูโุนููุงู ูุซุงูุ ูโุชูุงูู ูููููโ ุงูููโูุงู ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉ interface ุจู ูุงู ITransformer ุจุงุฒููุณ ฺฉููุ ุจู ุฌุง ุงูฺฉู ุงุฒ delegate ุงุณุชูุงุฏู ฺฉูู:

```c#
int[] values = { 1, 2, 3 };
Util.TransformAll(values, new Squarer());

foreach (int i in values)
    Console.WriteLine(i);

public interface ITransformer
{
    int Transform(int x);
}

public class Util
{
    public static void TransformAll(int[] values, ITransformer t)
    {
        for (int i = 0; i < values.Length; i++)
            values[i] = t.Transform(values[i]);
    }
}

class Squarer : ITransformer
{
    public int Transform(int x) => x * x;
}
```

ฺู ุฒูุงู delegate ุงูุชุฎุงุจ ุจูุชุฑ ุงุฒ interface ุงุณุชุ โ

ุทุฑุงุญ ุจุง delegate ููฺฉู ุงุณุช ุงูุชุฎุงุจ ุจูุชุฑ ุจุงุดุฏ ุงฺฏุฑ ฺฉ ุง ฺูุฏ ููุฑุฏ ุฒุฑ ุจุฑูุฑุงุฑ ุจุงุดูุฏ:

+ ๐น interface ููุท ฺฉ ูุชุฏ ุชุนุฑู ฺฉุฑุฏู ุจุงุดุฏ.

+ ๐น ูุงุฒ ุจู multicast (ุงุชุตุงู ฺูุฏ ูุชุฏ ุจู ฺฉ delegate) ุฏุงุดุชู ุจุงุดู.

+ ๐น ฺฉ subscriber ูุฌุจูุฑ ุจุงุดุฏ ฺูุฏ ุจุงุฑ ฺฉ interface ุฑุง ูพุงุฏูโุณุงุฒ ฺฉูุฏ.

**ุจุฑุฑุณ ูุซุงู ๐**

ุฏุฑ ูุซุงู ITransformer:

+ ูุง ูุงุฒ ุจู multicast ูุฏุงุฑู.

+ ุงูุง interface ููุท ฺฉ ูุชุฏ (Transform) ุชุนุฑู ฺฉุฑุฏู ุงุณุช.

+ ุงุฒ ุทุฑู ููฺฉู ุงุณุช ุจุฎูุงูู ฺูุฏู ุชุจุฏู ูุฎุชูู (ูุซูุงู ูุฑุจุน ุง ูฺฉุนุจ) ุฑุง ูพุงุฏูโุณุงุฒ ฺฉูู.

ุฏุฑ ฺูู ุญุงูุชุ ุงฺฏุฑ ุงุฒ interface ุงุณุชูุงุฏู ฺฉููุ ูุฌุจูุฑ ูโุดูู ุจุฑุง ูุฑ ุชุจุฏู ฺฉ ฺฉูุงุณ ุฌุฏุงฺฏุงูู ุจุณุงุฒูุ ฺูู ฺฉ ฺฉูุงุณ ููุท ฺฉ ุจุงุฑ ูโุชูุงูุฏ ITransformer ุฑุง ูพุงุฏูโุณุงุฒ ฺฉูุฏ. ุงู ฺฉุงุฑ ุฏุณุชโููพุงฺฏุฑ ู ุชฺฉุฑุงุฑ ูโุดูุฏ.

ูุซูุงู:

```c#
int[] values = { 1, 2, 3 };
Util.TransformAll(values, new Cuber());

foreach (int i in values)
    Console.WriteLine(i);

class Squarer : ITransformer
{
    public int Transform(int x) => x * x;
}

class Cuber : ITransformer
{
    public int Transform(int x) => x * x * x;
}
```

๐ ูุชุฌู:

+ ุจุง delegateูุงุ ูพุงุฏูโุณุงุฒ ุณุงุฏูโุชุฑ ู ููุนุทูโุชุฑ ุงุณุช (ูโุชูุงูู ุจูโุฑุงุญุช ูุชุฏูุง ูุฎุชูู ูุซู ูุฑุจุน ุง ูฺฉุนุจ ุฑุง ูพุงุณ ุจุฏูู).

+ ุจุง interfaceูุงุ ูุฌุจูุฑู ุจุฑุง ูุฑ ุนููฺฏุฑ ฺฉ ฺฉูุงุณ ุฌุฏุฏ ุจุณุงุฒู.
  
### ุณุงุฒฺฏุงุฑ Delegate ูุง โ๏ธ

#### ุณุงุฒฺฏุงุฑ ููุน (Type Compatibility) ๐ท๏ธ

ุชูุงู ููุนโูุง delegate ุจุง ูู ูุงุณุงุฒฺฏุงุฑ ูุณุชูุฏุ ุญุช ุงฺฏุฑ ุงูุถุง (signature) ุขูโูุง ฺฉ ุจุงุดุฏ:

```c#
D1 d1 = Method1;
D2 d2 = d1;   // โ ุฎุทุง ุฒูุงู ฺฉุงููพุงู

void Method1() { }

delegate void D1();
delegate void D2();
```

๐น ุงูุง ุงู ุญุงูุช ูุฌุงุฒ ุงุณุช:

```
D2 d2 = new D2(d1);   // โ ุฏุฑุณุช
```

**ููุงุณูโ ุจุฑุงุจุฑ (Equality) โ**

ุฏู ูููููโ delegate ููุช ุจุฑุงุจุฑ ูุญุณูุจ ูโุดููุฏ ฺฉู ุจู ฺฉ ูุชุฏ ฺฉุณุงู ุงุดุงุฑู ฺฉููุฏ:

```c#
D d1 = Method1;
D d2 = Method1;

Console.WriteLine(d1 == d2);   // True

void Method1() { }

delegate void D();
```

๐น ุฏุฑ ููุฑุฏ multicast delegateโูุง ููุ ุจุฑุงุจุฑ ููุช ุจุฑูุฑุงุฑ ุงุณุช ฺฉู ุจู ููุงู ูุชุฏูุง ู ุจู ููุงู ุชุฑุชุจ ุงุดุงุฑู ฺฉููุฏ.

#### ุณุงุฒฺฏุงุฑ ูพุงุฑุงูุชุฑ (Parameter Compatibility) ๐

ููุช ฺฉ ูุชุฏ ุฑุง ูุฑุงุฎูุงู ูโฺฉูุฏุ ูโุชูุงูุฏ ุขุฑฺฏููุงู ุจุฏูุฏ ฺฉู ุงุฒ ููุน ุฎุงุตโุชุฑ ุงุฒ ูพุงุฑุงูุชุฑ ูุชุฏ ุจุงุดุฏ. ุงู ุฑูุชุงุฑ ูุนููู polymorphism ุงุณุช.

ุจู ููู ุฏููุ ฺฉ delegate ูู ูโุชูุงูุฏ ูพุงุฑุงูุชุฑูุง ุฎุงุตโุชุฑ ุงุฒ ูุชุฏ ูุฏู ุฎูุฏ ุฏุงุดุชู ุจุงุดุฏ. ุงู ูฺฺฏ ุฑุง contravariance ูโูุงููุฏ.

ูุซุงู:

```c#
StringAction sa = new StringAction(ActOnObject);
sa("hello");

void ActOnObject(object o) => Console.WriteLine(o);   // ุฎุฑูุฌ: hello

delegate void StringAction(string s);
```

๐น ุฏุฑ ุงูุฌุง StringAction ฺฉ ูุชุฏ ุฑุง ุจุง ูพุงุฑุงูุชุฑ string ูุฑุงุฎูุงู ูโฺฉูุฏ.
๐น ุงูุง ูุชุฏ ฺฉู ูุงูุนุง ุงุฌุฑุง ูโุดูุฏ (ActOnObject) ูพุงุฑุงูุชุฑุด ุงุฒ ููุน object ุงุณุช.
๐น ุฏุฑ ุงู ุญุงูุชุ ุขุฑฺฏููุงู string ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ุชุจุฏู ุจู object (upcast) ูโุดูุฏ.

**3. ุงุฑุชุจุงุท ุจุง ุงูฺฏู ุงุณุชุงูุฏุงุฑุฏ Event ๐ฏ**

ุงูฺฏู ุงุณุชุงูุฏุงุฑุฏ event ุฏุฑ C# ุทูุฑ ุทุฑุงุญ ุดุฏู ุงุณุช ฺฉู ุงุฒ contravariance ุงุณุชูุงุฏู ฺฉูุฏ.

+ ูููโ ฺฉูุงุณโูุง ุฑูุฏุงุฏ ุงุฒ ฺฉูุงุณ ูพุงูโ ูุดุชุฑฺฉ EventArgs ุงุฑุซโุจุฑ ูโฺฉููุฏ.

+ ุจูุงุจุฑุงู ูโุชูุงูุฏ ฺฉ ูุชุฏ ุฏุงุดุชู ุจุงุดุฏ ฺฉู ุชูุณุท ุฏู delegate ูุฎุชูู ูุฑุงุฎูุงู ุดูุฏ:

  + ฺฉ ุฑูุฏุงุฏ MouseEventArgs ูพุงุณ ุจุฏูุฏ ๐ฑ๏ธ

  + ุฏฺฏุฑ KeyEventArgs ูพุงุณ ุจุฏูุฏ โจ๏ธ

ุงู ฺฉุงุฑ ุงูุนุทุงูโูพุฐุฑ ุจุงูุง ุฏุฑ ูุฏุฑุช ุฑูุฏุงุฏูุง ุจู ุดูุง ูโุฏูุฏ.

๐ ุฎูุงุตู:

+ delegate type ูุง ุญุช ุจุง ุงูุถุง ฺฉุณุงู ูู ูุงุณุงุฒฺฏุงุฑ ูุณุชูุฏ.

+ multicast delegateูุง ุจุฑุงุจุฑูุฏ ุงฺฏุฑ ุฏููุง ููุงู ูุชุฏูุง ู ุชุฑุชุจ ุฑุง ุฏุงุดุชู ุจุงุดูุฏ.

+ contravariance ุงุฌุงุฒู ูโุฏูุฏ ูุชุฏ ูุฏูุ ูพุงุฑุงูุชุฑ ุนุงูโุชุฑ ุงุฒ delegate ุฏุงุดุชู ุจุงุดุฏ.

+ event pattern ุงุฒ ููู ูฺฺฏ ุจุฑุง ูพุดุชุจุงู ุงุฒ ุงููุงุน ูุฎุชูู ุฑูุฏุงุฏูุง ุงุณุชูุงุฏู ูโฺฉูุฏ.

#### ุณุงุฒฺฏุงุฑ ููุน ุจุงุฒฺฏุดุช ุฏุฑ Delegateูุง (Return Type Compatibility) ๐

ููุงูโุทูุฑ ฺฉู ููุช ฺฉ ูุชุฏ ุฑุง ูุฑุงุฎูุงู ูโฺฉูุฏ ููฺฉู ุงุณุช ููุน ุฎุงุตโุชุฑ ุงุฒ ฺุฒ ฺฉู ุงูุชุธุงุฑ ุฏุงุดุชุฏ ุจุฑฺฏุฑุฏุฏ (ุฑูุชุงุฑ ูุนููู polymorphism)ุ ุฏุฑ ููุฑุฏ delegateโูุง ูู ููู ููุถูุน ุตุงุฏู ุงุณุช.

ุนู ูุชุฏ ูุฏู ฺฉ delegate ูโุชูุงูุฏ ููุน ุจุงุฒฺฏุดุช ุฎุงุตโุชุฑ ุงุฒ ฺุฒ ฺฉู delegate ุชุนุฑู ฺฉุฑุฏู ุฏุงุดุชู ุจุงุดุฏ.
ุงู ูฺฺฏ ุฑุง covariance ูโูุงููุฏ.

ูุซุงู: Covariance ุฏุฑ ููุน ุจุงุฒฺฏุดุช ๐

```c#
ObjectRetriever o = new ObjectRetriever(RetrieveString);
object result = o();
Console.WriteLine(result);   // hello

string RetrieveString() => "hello";

delegate object ObjectRetriever();
```

๐น ุงูุฌุง ObjectRetriever ุงูุชุธุงุฑ ุฏุงุฑุฏ ูุชุฏ ฺฉู ุจู ุขู ูุชุตู ุงุณุชุ ฺฉ object ุจุฑฺฏุฑุฏุงูุฏ.
๐น ุงูุง ุฏุฑ ูุงูุนุชุ ูุชุฏ RetrieveString ฺฉ string ุจุฑูโฺฏุฑุฏุงูุฏ.
๐น ฺูู string ุฒุฑฺฉูุงุณ object ุงุณุชุ ุงู ูุฌุงุฒ ุงุณุช โ.

๐ ูพุณ: ููุน ุจุงุฒฺฏุดุช delegate ูุง covariant ุงุณุช.

#### ูุงุฑุงูุณ ุฏุฑ Delegateูุง ุฌูุฑฺฉ โ๏ธ

ุฏุฑ ูุตู ณ ฺฏูุชู ฺฉู ุงูุชุฑูุณโูุง ุฌูุฑฺฉ ูโุชูุงููุฏ ุงุฒ covariant ู contravariant ุงุณุชูุงุฏู ฺฉููุฏ.
ุงู ูุงุจูุช ุจุฑุง delegateโูุง ุฌูุฑฺฉ ูู ูุฌูุฏ ุฏุงุฑุฏ.

**ููุงูู ุฎูุจ ุจุฑุง ุชุนุฑู delegate ุฌูุฑฺฉ:**

ุงฺฏุฑ ูพุงุฑุงูุชุฑ ููุน (Type Parameter) ููุท ุฏุฑ ุฎุฑูุฌ ุงุณุชูุงุฏู ูโุดูุฏ โ ุจุง out (covariant) ุนูุงูุชโฺฏุฐุงุฑ ุดูุฏ.

ุงฺฏุฑ ูพุงุฑุงูุชุฑ ููุน ููุท ุฏุฑ ูุฑูุฏ ุงุณุชูุงุฏู ูโุดูุฏ โ ุจุง in (contravariant) ุนูุงูุชโฺฏุฐุงุฑ ุดูุฏ.

**ูุซุงู ฑ: Covariance ุฏุฑ ุฌูุฑฺฉโูุง (ุจุง Func) ๐ค**

ุฏุฑ ูุถุง ูุงู System ุฏุงุฑู:

```c#
delegate TResult Func<out TResult>();
```

ุงู ุจุงุนุซ ูโุดูุฏ ุจุชูุงูู ุจููุณู:

```c#
Func<string> x = () => "Hello!";
Func<object> y = x;   // โ ูุฌุงุฒ ุจู ุฎุงุทุฑ covariance
```

๐น ุนู ูโุชูุงูู Func<string> ุฑุง ุจู Func<object> ุชุจุฏู ฺฉูู ฺูู string ุฒุฑฺฉูุงุณ object ุงุณุช.

**ูุซุงู ฒ: Contravariance ุฏุฑ ุฌูุฑฺฉโูุง (ุจุง Action) ๐ฅ**

ุจุงุฒ ูู ุฏุฑ ูุถุง ูุงู System:

```c#
delegate void Action<in T>(T arg);
```

ุงู ุจุงุนุซ ูโุดูุฏ:

```c#
Action<object> x = obj => Console.WriteLine(obj);
Action<string> y = x;   // โ ูุฌุงุฒ ุจู ุฎุงุทุฑ contravariance
```

๐น ุนู ูโุชูุงูู Action<object> ุฑุง ุจู Action<string> ุชุจุฏู ฺฉูู ฺูู ูุชุฏ ฺฉู ุงูุชุธุงุฑ ุฏุฑุงูุช object ุฏุงุฑุฏุ ูโุชูุงูุฏ string ูู ุจฺฏุฑุฏ.

๐ ุฎูุงุตู:

+ ููุน ุจุงุฒฺฏุดุช delegate ูโุชูุงูุฏ ุฎุงุตโุชุฑ ุงุฒ ููุน ุชุนุฑูโุดุฏู ุจุงุดุฏ โ ุงู covariance ุงุณุช.

+ ุฏุฑ delegate ุฌูุฑฺฉ:

  + ููุน ุฎุฑูุฌ (out) โ covariant ๐ค

  + ููุน ูุฑูุฏ (in) โ contravariant ๐ฅ

ุงู ุจุงุนุซ ูโุดูุฏ ุชุจุฏูโูุง ุจู delegateูุง ุจูโุตูุฑุช ุทุจุน ู ุจุฑ ุงุณุงุณ ุงุฑุซโุจุฑ ุงูุฌุงู ุดููุฏ.

### ุฑูุฏุงุฏูุง (Events)

ููฺฏุงู ุงุณุชูุงุฏู ุงุฒ **delegates**ุ ุฏู ููุด ูุนูููุงู ุธุงูุฑ ูโุดููุฏ: **broadcaster** ู **subscriber**.

+ **Broadcaster** ููุน ุงุณุช ฺฉู ุฏุงุฑุง ฺฉ ููุฏ delegate ูโุจุงุดุฏ. ุงู ููุน ุชุตูู ูโฺฏุฑุฏ ฺฉู ฺู ุฒูุงู ูพุงู ุฑุง ูพุฎุด ฺฉูุฏุ ุจุง **invoke** ฺฉุฑุฏู delegate.
+ **Subscribers** ุฏุฑุงูุชโฺฉููุฏฺฏุงู ูุฏู ูุชุฏ ูุณุชูุฏ. ฺฉ subscriber ุชุตูู ูโฺฏุฑุฏ ฺู ุฒูุงู ุดุฑูุน ุจู ฺฏูุด ุฏุงุฏู ฺฉูุฏ ู ฺู ุฒูุงู ุขู ุฑุง ูุชููู ฺฉูุฏุ ุจุง ุงุณุชูุงุฏู ุงุฒ ุนููฺฏุฑูุง `+=` ู `-=` ุฑู delegate ูุฑุจูุท ุจู broadcaster. ฺฉ subscriber ุฏุฑุจุงุฑู ุฏฺฏุฑ subscribers ุงุทูุงุน ูุฏุงุฑุฏ ู ุฏุฑ ุนููฺฉุฑุฏ ุขูโูุง ุฏุฎุงูุช ููโฺฉูุฏ.

### ุฑูุฏุงุฏูุง ุฏุฑ C# ูพุดุฑูุชู โก

ุฑูุฏุงุฏูุง ฺฉ ูฺฺฏ ุฒุจุงู ูุณุชูุฏ ฺฉู ุงู ุงูฺฏู ุฑุง ุฑุณู ูโฺฉููุฏ. ฺฉ **event** ฺฉ ุณุงุฎุชุงุฑ ุงุณุช ฺฉู ุชููุง ุฒุฑูุฌููุนูโุง ุงุฒ ูุงุจูุชโูุง delegate ุฑุง ฺฉู ุจุฑุง ูุฏู **broadcaster/subscriber** ูุงุฒู ุงุณุชุ ุฏุฑ ูุนุฑุถ ูุฑุงุฑ ูโุฏูุฏ. ูุฏู ุงุตู ุฑูุฏุงุฏูุง ุฌููฺฏุฑ ุงุฒ ุฏุฎุงูุช subscribers ุฏุฑ ุนููฺฉุฑุฏ ฺฉุฏฺฏุฑ ุงุณุช.

ุณุงุฏูโุชุฑู ุฑูุด ุจุฑุง ุชุนุฑู ฺฉ ุฑูุฏุงุฏุ ุงุณุชูุงุฏู ุงุฒ ฺฉูุฏูุงฺู **event** ูุจู ุงุฒ ฺฉ ุนุถู delegate ุงุณุช:

```csharp
// ุชุนุฑู delegate
public delegate void PriceChangedHandler(decimal oldPrice, decimal newPrice);

public class Broadcaster
{
    // ุชุนุฑู ุฑูุฏุงุฏ
    public event PriceChangedHandler PriceChanged;
}
```

ฺฉุฏ ฺฉู ุฏุงุฎู ููุน **Broadcaster** ูุฑุงุฑ ุฏุงุฑุฏุ ุฏุณุชุฑุณ ฺฉุงูู ุจู **PriceChanged** ุฏุงุฑุฏ ู ูโุชูุงูุฏ ุขู ุฑุง ูุงููุฏ ฺฉ delegate ูุนููู ูุฏุฑุช ฺฉูุฏ. ฺฉุฏูุง ุฎุงุฑุฌ ุงุฒ **Broadcaster** ุชููุง ูโุชูุงููุฏ ุนููุงุช `+=` ู `-=` ุฑุง ุฑู ุฑูุฏุงุฏ **PriceChanged** ุงูุฌุงู ุฏููุฏ.

โ ุงุฏุงููโ ูุชู ุฑุง ุงุฑุณุงู ฺฉูุฏ ุชุง ุชุฑุฌูู ุจุนุฏ ุฑุง ุขูุงุฏู ฺฉูู.

### ฺฺฏููู ุฑูุฏุงุฏูุง ุฏุฑ ุฏุฑูู ฺฉุงุฑ ูโฺฉููุฏุ ๐

ููุช ฺฉ ุฑูุฏุงุฏ ุจู ุดฺฉู ุฒุฑ ุชุนุฑู ูโฺฉูุฏ:

```csharp
public class Broadcaster
{
    public event PriceChangedHandler PriceChanged;
}
```

ุณู ุงุชูุงู ุฏุฑ ูพุดุช ุตุญูู ุฑุฎ ูโุฏูุฏ:

1๏ธโฃ ุงุจุชุฏุงุ **ฺฉุงููพุงูุฑ** ุชุนุฑู ุฑูุฏุงุฏ ุฑุง ุจู ฺุฒ ุดุจู ุจู ฺฉุฏ ุฒุฑ ุชุฑุฌูู ูโฺฉูุฏ:

```csharp
PriceChangedHandler priceChanged;   // delegate ุฎุตูุต

public event PriceChangedHandler PriceChanged
{
    add    { priceChanged += value; }
    remove { priceChanged -= value; }
}
```

ฺฉูุฏูุงฺูโูุง **add** ู **remove** ูุดุงูโุฏููุฏู **accessorูุง ุฑูุฏุงุฏ ุตุฑุญ** ูุณุชูุฏโฺฉู ุนููฺฉุฑุฏ ุดุจู ุจู **accessorูุง property** ุฏุงุฑูุฏ. ุจุนุฏุงู ุฏุฑุจุงุฑู ูุญูู ููุดุชู ุงูโูุง ุชูุถุญ ุฎูุงูู ุฏุงุฏ.

2๏ธโฃ ุฏููุ ฺฉุงููพุงูุฑ ุฏุงุฎู ฺฉูุงุณ **Broadcaster** ุจู ุฏูุจุงู ุงุฑุฌุงุนุงุช ุจู **PriceChanged** ูโฺฏุฑุฏุฏ ฺฉู ุนููุงุช ุฏฺฏุฑ ุบุฑ ุงุฒ `+=` ุง `-=` ุงูุฌุงู ูโุฏููุฏ ู ุขูโูุง ุฑุง ุจู ููุฏ delegate ุฒุฑู ุนู **priceChanged** ูุฏุงุช ูโฺฉูุฏ.

3๏ธโฃ ุณููุ ฺฉุงููพุงูุฑ ุนููุงุช `+=` ู `-=` ุฑู ุฑูุฏุงุฏ ุฑุง ุจู ูุฑุงุฎูุงู **add** ู **remove** accessorูุง ุฑูุฏุงุฏ ุชุฑุฌูู ูโฺฉูุฏ. ุฌุงูุจ ุงุณุช ุจุฏุงูุฏ ฺฉู ุงู ฺฉุงุฑ ุจุงุนุซ ูโุดูุฏ ุฑูุชุงุฑ `+=` ู `-=` ููุช ุฑู ุฑูุฏุงุฏูุง ุงุนูุงู ูโุดููุฏุ ููุญุตุฑุจูโูุฑุฏ ุจุงุดุฏ: ุจุฑุฎูุงู ุณุงุฑ ุณูุงุฑููุงุ ุงูโูุง ุชููุง ฺฉ ูุงูุจุฑ ุจุฑุง `+` ู `-` ุจู ููุฑุงู ุงูุชุณุงุจ ูุณุชูุฏ.

ูุซุงู ุฑุง ุฏุฑ ูุธุฑ ุจฺฏุฑุฏ ๐

ฺฉูุงุณ **Stock** ุฑูุฏุงุฏ **PriceChanged** ุฎูุฏ ุฑุง ูุฑ ุจุงุฑ ฺฉู ููุช ุณูุงู ุชุบุฑ ูโฺฉูุฏุ ูุนุงู ูโฺฉูุฏ:

```csharp
public delegate void PriceChangedHandler(decimal oldPrice, decimal newPrice);

public class Stock
{
    string symbol;
    decimal price;
    public Stock(string symbol) => this.symbol = symbol;
    public event PriceChangedHandler PriceChanged;
    public decimal Price
    {
        get => price;
        set
        {
            if (price == value) return;   // ุฎุฑูุฌ ุงฺฏุฑ ฺุฒ ุชุบุฑ ูฺฉุฑุฏู
            decimal oldPrice = price;
            price = value;
            if (PriceChanged != null)      // ุงฺฏุฑ ูุณุช ูุฑุงุฎูุงู ุฎุงู ูุณุช
                PriceChanged(oldPrice, price); // ุฑูุฏุงุฏ ูุนุงู ุดูุฏ
        }
    }
}
```

ุงฺฏุฑ ฺฉูุฏูุงฺู **event** ุฑุง ุญุฐู ฺฉูู ู **PriceChanged** ุจู ฺฉ ููุฏ ูุนููู delegate ุชุจุฏู ุดูุฏุ ุจุงุฒ ูู ูุซุงู ูุง ููุงู ูุชุงุฌ ุฑุง ุฎูุงูุฏ ุฏุงุฏ. ุงูุง ฺฉูุงุณ **Stock** ฺฉูุชุฑ ููุงูู ุฎูุงูุฏ ุจูุฏุ ุฒุฑุง subscribers ูโุชูุงููุฏ ุจุง ฺฉุฏฺฏุฑ ุชุฏุงุฎู ุงุฌุงุฏ ฺฉููุฏุ ูุซูุงู:

+ ุฌุงฺฏุฒู ฺฉุฑุฏู ุฏฺฏุฑ subscribers ุจุง ุงูุชุณุงุจ ูุฌุฏุฏ **PriceChanged** ุจู ุฌุง ุงุณุชูุงุฏู ุงุฒ ุนููฺฏุฑ `+=`.
+ ูพุงฺฉ ฺฉุฑุฏู ุชูุงู subscribers ุจุง ุงูุชุณุงุจ **PriceChanged** ุจู `null`.
+ ุงุฑุณุงู ูพุงู ุจู subscribers ุฏฺฏุฑ ุจุง invoke ฺฉุฑุฏู delegate.

### ุงูฺฏู ุงุณุชุงูุฏุงุฑุฏ ุฑูุฏุงุฏูุง ๐๏ธ

ุฏุฑ ุชูุฑุจุงู ููู ููุงุฑุฏ ฺฉู ุฑูุฏุงุฏูุง ุฏุฑ ฺฉุชุงุจุฎุงููโูุง .NET ุชุนุฑู ูโุดููุฏุ ุชุนุฑู ุขูโูุง ูุทุงุจู ฺฉ ุงูฺฏู ุงุณุชุงูุฏุงุฑุฏ ุงุณุช ุชุง ฺฉูพุงุฑฺฺฏ ุจู ฺฉุฏูุง ฺฉุชุงุจุฎุงูู ู ฺฉุงุฑุจุฑ ุญูุธ ุดูุฏ. ุฏุฑ ูุฑฺฉุฒ ุงู ุงูฺฏูุ ฺฉูุงุณ **System.EventArgs** ูุฑุงุฑ ุฏุงุฑุฏุ ฺฉ ฺฉูุงุณ ุงุฒ ูพุด ุชุนุฑูโุดุฏู ุฏุฑ .NET ฺฉู ูฺ ุนุถู ูุฏุงุฑุฏ (ุจู ุฌุฒ ููุฏ ุงุณุชุงุชฺฉ **Empty**). **EventArgs** ฺฉูุงุณ ูพุงูโุง ุจุฑุง ุงูุชูุงู ุงุทูุงุนุงุช ูุฑุจูุท ุจู ฺฉ ุฑูุฏุงุฏ ุงุณุช.

ุฏุฑ ูุซุงู Stock ูุงุ ุจุฑุง ุงูุชูุงู ููุช ูุฏู ู ุฌุฏุฏ ููฺฏุงู ูุนุงู ุดุฏู ุฑูุฏุงุฏ **PriceChanged**ุ ฺฉูุงุณ EventArgs ุฑุง ุจู ุตูุฑุช ุฒุฑ subclass ูโฺฉูู:

```csharp
public class PriceChangedEventArgs : System.EventArgs
{
    public readonly decimal LastPrice;
    public readonly decimal NewPrice;

    public PriceChangedEventArgs(decimal lastPrice, decimal newPrice)
    {
        LastPrice = lastPrice;
        NewPrice = newPrice;
    }
}
```

ุจุฑุง ุงุณุชูุงุฏู ูุฌุฏุฏุ subclass EventArgs ูุนูููุงู ุจุฑ ุงุณุงุณ ุงุทูุงุนุงุช ฺฉู ุดุงูู ูโุดูุฏ ูุงูฺฏุฐุงุฑ ูโุดูุฏุ ูู ุจุฑ ุงุณุงุณ ุฑูุฏุงุฏ ฺฉู ุจุฑุง ุขู ุงุณุชูุงุฏู ูโุดูุฏ. ุฏุงุฏูโูุง ูุนูููุงู ุจู ุตูุฑุช property ุง ููุฏ ููุทโุฎูุงูุฏู ุงุฑุงุฆู ูโุดููุฏ.

### ุงูุชุฎุงุจ ุง ุชุนุฑู delegate ุจุฑุง ุฑูุฏุงุฏ ๐ฏ

ุณู ูุงุนุฏู ูุฌูุฏ ุฏุงุฑุฏ:

1๏ธโฃ ููุน ุจุงุฒฺฏุดุช ุจุงุฏ **void** ุจุงุดุฏ.
2๏ธโฃ ุฏู ุขุฑฺฏููุงู ุฏุฑุงูุช ฺฉูุฏ: ุขุฑฺฏููุงู ุงูู ุงุฒ ููุน **object** ู ุขุฑฺฏููุงู ุฏูู ฺฉ subclass ุงุฒ **EventArgs**. ุขุฑฺฏููุงู ุงูู ูุดุงูโุฏููุฏู broadcaster ู ุขุฑฺฏููุงู ุฏูู ุดุงูู ุงุทูุงุนุงุช ุงุถุงู ุจุฑุง ุงูุชูุงู ุงุณุช.
3๏ธโฃ ูุงู delegate ุจุงุฏ ุจุง **EventHandler** ูพุงุงู ุงุจุฏ.

.NET ฺฉ delegate ุนููู ุจู ูุงู **System.EventHandler<>** ุจุฑุง ฺฉูฺฉ ุจู ุงู ฺฉุงุฑ ุชุนุฑู ฺฉุฑุฏู ุงุณุช:

```csharp
public delegate void EventHandler<TEventArgs>(object source, TEventArgs e);
```

ูุจู ุงุฒ ูุฌูุฏ genericูุง ุฏุฑ ุฒุจุงู (ูุจู ุงุฒ C# 2.0)ุ ุจุงุฏ delegate ุณูุงุฑุด ุฑุง ุจู ุตูุฑุช ุฒุฑ ูโููุดุชู:

```csharp
public delegate void PriceChangedHandler(object sender, PriceChangedEventArgs e);
```

ุจู ุฏูุงู ุชุงุฑุฎุ ุจุดุชุฑ ุฑูุฏุงุฏูุง ุฏุฑ ฺฉุชุงุจุฎุงููโูุง .NET ุงุฒ ุงู ุฑูุด ุงุณุชูุงุฏู ูโฺฉููุฏ.

### ุชุนุฑู ุฑูุฏุงุฏ ุจุง delegate ุงูุชุฎุงุจโุดุฏู ๐ง

```csharp
public class Stock
{
    ...
    public event EventHandler<PriceChangedEventArgs> PriceChanged;
}
```

### ููุดุชู ูุชุฏ ูุญุงูุธุชโุดุฏู ู virtual ุจุฑุง ูุนุงู ฺฉุฑุฏู ุฑูุฏุงุฏ

ูุงู ุงู ูุชุฏ ุจุงุฏ ููุงู ูุงู ุฑูุฏุงุฏ ุจุงุดุฏุ ุจุง ูพุดููุฏ **On**ุ ู ฺฉ ุขุฑฺฏููุงู **EventArgs** ุฏุฑุงูุช ฺฉูุฏ:

```csharp
public class Stock
{
    ...
    public event EventHandler<PriceChangedEventArgs> PriceChanged;

    protected virtual void OnPriceChanged(PriceChangedEventArgs e)
    {
        if (PriceChanged != null) PriceChanged(this, e);
    }
}
```

ุจุฑุง ุนููฺฉุฑุฏ ููุงูู ุฏุฑ ุณูุงุฑููุง ฺูุฏูุฎ (multithreaded)ุ ุจูุชุฑ ุงุณุช delegate ุฑุง ูุจู ุงุฒ ุชุณุช ู ูุฑุงุฎูุงู ุจู ฺฉ ูุชุบุฑ ูููุช ุงูุชุณุงุจ ุฏูุฏ:

```csharp
var temp = PriceChanged;
if (temp != null) temp(this, e);
```

ููฺูู ูโุชูุงู ุจุง ุงุณุชูุงุฏู ุงุฒ **null-conditional operator** ููุงู ฺฉุงุฑ ุฑุง ุจุฏูู ูุชุบุฑ ูููุช ุงูุฌุงู ุฏุงุฏ:

```csharp
PriceChanged?.Invoke(this, e);
```

ุงู ุฑูุด ูู **thread-safe** ู ูู ูุฎุชุตุฑ ุงุณุช ู ุจูุชุฑู ุฑูุด ุนููู ุจุฑุง ูุฑุงุฎูุงู ุฑูุฏุงุฏูุง ูุญุณูุจ ูโุดูุฏ.

### ูุซุงู ฺฉุงูู ๐ป

```csharp
using System;

Stock stock = new Stock("THPW");
stock.Price = 27.10M;

// ุซุจุช ุจุฑุง ุฑูุฏุงุฏ PriceChanged
stock.PriceChanged += stock_PriceChanged;
stock.Price = 31.59M;

void stock_PriceChanged(object sender, PriceChangedEventArgs e)
{
    if ((e.NewPrice - e.LastPrice) / e.LastPrice > 0.1M)
        Console.WriteLine("Alert, 10% stock price increase!");
}

public class PriceChangedEventArgs : EventArgs
{
    public readonly decimal LastPrice;
    public readonly decimal NewPrice;

    public PriceChangedEventArgs(decimal lastPrice, decimal newPrice)
    {
        LastPrice = lastPrice; NewPrice = newPrice;
    }
}

public class Stock
{
    string symbol;
    decimal price;
    public Stock(string symbol) => this.symbol = symbol;
    public event EventHandler<PriceChangedEventArgs> PriceChanged;

    protected virtual void OnPriceChanged(PriceChangedEventArgs e)
    {
        PriceChanged?.Invoke(this, e);
    }

    public decimal Price
    {
        get => price;
        set
        {
            if (price == value) return;
            decimal oldPrice = price;
            price = value;
            OnPriceChanged(new PriceChangedEventArgs(oldPrice, price));
        }
    }
}
```

### ุงุณุชูุงุฏู ุงุฒ EventHandler ุบุฑ ุนููู

ููุช ุฑูุฏุงุฏ ูุงุฒ ุจู ุงูุชูุงู ุงุทูุงุนุงุช ุงุถุงู ูุฏุงุฑุฏุ ูโุชูุงู ุงุฒ **EventHandler** ุบุฑ generic ุงุณุชูุงุฏู ฺฉุฑุฏ. ุฏุฑ ุงู ูุซุงูุ ฺฉูุงุณ **Stock** ุจุงุฒููุณ ุดุฏู ุชุง ุฑูุฏุงุฏ **PriceChanged** ูพุณ ุงุฒ ุชุบุฑ ููุช ูุนุงู ุดูุฏ ู ุชููุง ูุงุฒ ุงุณุช ุจุฏุงูู ุฑูุฏุงุฏ ุฑุฎ ุฏุงุฏู ุงุณุชุ ุจุฏูู ูุงุฒ ุจู ุงุทูุงุนุงุช ุงุถุงู. ููฺูู ุงุฒ **EventArgs.Empty** ุงุณุชูุงุฏู ูโฺฉูู ุชุง ุงุฒ ุงุฌุงุฏ ุบุฑุถุฑูุฑ ฺฉ ููููู EventArgs ุฌููฺฏุฑ ุดูุฏ:

```csharp
public class Stock
{
    string symbol;
    decimal price;

    public Stock(string symbol) { this.symbol = symbol; }
    public event EventHandler PriceChanged;

    protected virtual void OnPriceChanged(EventArgs e)
    {
        PriceChanged?.Invoke(this, e);
    }

    public decimal Price
    {
        get { return price; }
        set
        {
            if (price == value) return;
            price = value;
            OnPriceChanged(EventArgs.Empty);
        }
    }
}
```

**Accessorูุง ุฑูุฏุงุฏูุง ๐**

Accessorูุง ฺฉ ุฑูุฏุงุฏุ ูพุงุฏูโุณุงุฒโูุง ุนููฺฏุฑูุง `+=` ู `-=` ุขู ูุณุชูุฏ. ุจู ุทูุฑ ูพุดโูุฑุถุ ุงู accessors ุจู ุตูุฑุช ุถูู ุชูุณุท ฺฉุงููพุงูุฑ ูพุงุฏูโุณุงุฒ ูโุดููุฏ. ุจู ูุซุงู ุฒุฑ ุชูุฌู ฺฉูุฏ:

```csharp
public event EventHandler PriceChanged;
```

ฺฉุงููพุงูุฑ ุงู ุฑุง ุจู ุดฺฉู ุฒุฑ ุชุจุฏู ูโฺฉูุฏ:

+ ฺฉ ููุฏ delegate ุฎุตูุต
+ ฺฉ ุฌูุช ุชุงุจุน accessor ุนููู ุจุฑุง ุฑูุฏุงุฏ (**add\_PriceChanged** ู **remove\_PriceChanged**) ฺฉู ุนููุงุช `+=` ู `-=` ุฑุง ุจู ููุฏ delegate ุฎุตูุต ูุฏุงุช ูโฺฉููุฏ

ุดูุง ูโุชูุงูุฏ ุงู ุฑููุฏ ุฑุง ุจุง ุชุนุฑู **explicit event accessors** ุจู ุฏุณุช ุจฺฏุฑุฏ. ุฏุฑ ุงูุฌุง ูพุงุฏูโุณุงุฒ ุฏุณุช ุฑูุฏุงุฏ **PriceChanged** ุงุฒ ูุซุงู ูุจู ุขูุฏู ุงุณุช:

```csharp
private EventHandler priceChanged;   // ุชุนุฑู ฺฉ delegate ุฎุตูุต
public event EventHandler PriceChanged
{
    add    { priceChanged += value; }
    remove { priceChanged -= value; }
}
```

ุงู ูุซุงู ุงุฒ ูุธุฑ ุนููฺฉุฑุฏ ุจุง ูพุงุฏูโุณุงุฒ ูพุดโูุฑุถ C# ฺฉุณุงู ุงุณุช (ุจู ุฌุฒ ุงูฺฉู C# ููฺูู ุงูู ุฏุฑ ุจุฑุงุจุฑ ฺูุฏูุฎ ุฑุง ุจุง ุงูฺฏูุฑุชู lock-free compare-and-swap ุชุถูู ูโฺฉูุฏ). ุจุง ุชุนุฑู ุฏุณุช accessorsุ ุจู C# ูโฺฏูู ฺฉู ููุทู ูพุดโูุฑุถ ููุฏ ู accessor ุฑุง ุชููุฏ ูฺฉูุฏ.

ุจุง ุงุณุชูุงุฏู ุงุฒ explicit event accessorsุ ูโุชูุงู ุงุณุชุฑุงุชฺโูุง ูพฺุฏูโุชุฑ ุจุฑุง ุฐุฎุฑู ู ุฏุณุชุฑุณ ุจู delegate ุฒุฑู ุงุนูุงู ฺฉุฑุฏ. ุณู ุณูุงุฑู ฺฉู ุงู ฺฉุงุฑุจุฑุฏ ุฏุงุฑุฏ:

1๏ธโฃ ููุช accessors ุชููุง ุจู ุนููุงู ูุงุณุทู ุจุฑุง ฺฉูุงุณ ุฏฺฏุฑ ูุณุชูุฏ ฺฉู ุฑูุฏุงุฏ ุฑุง ูพุฎุด ูโฺฉูุฏ.
2๏ธโฃ ููุช ฺฉูุงุณ ุชุนุฏุงุฏ ุฒุงุฏ ุฑูุฏุงุฏ ุฏุงุฑุฏ ุงูุง ุงุบูุจ ุชููุง ุชุนุฏุงุฏ ฺฉู subscriber ูุฌูุฏ ุฏุงุฑุฏุ ูุซู ฺฉูุชุฑูโูุง ููุฏูุฒ. ุฏุฑ ุงู ููุงุฑุฏ ุจูุชุฑ ุงุณุช delegateูุง subscribers ุฑุง ุฏุฑ ฺฉ **dictionary** ุฐุฎุฑู ฺฉููุ ุฒุฑุง dictionary ุญุงูุธู ฺฉูุชุฑ ูุณุจุช ุจู ุฏูโูุง ููุฏ delegate ุฎุงู ูุตุฑู ูโฺฉูุฏ.
3๏ธโฃ ููฺฏุงู ูพุงุฏูโุณุงุฒ explicit ฺฉ interface ฺฉู ุฑูุฏุงุฏ ุฑุง ุชุนุฑู ฺฉุฑุฏู ุงุณุช.

ูููููโุง ุจุฑุง ููุฑุฏ ุณูู:

```csharp
public interface IFoo { event EventHandler Ev; }

class Foo : IFoo
{
    private EventHandler ev;
    event EventHandler IFoo.Ev
    {
        add    { ev += value; }
        remove { ev -= value; }
    }
}
```

ุจุฎุดโูุง **add** ู **remove** ฺฉ ุฑูุฏุงุฏ ุจู ูุชุฏูุง **add\_XXX** ู **remove\_XXX** ฺฉุงููพุงู ูโุดููุฏ.

---

**Modifierูุง ุฑูุฏุงุฏูุง โก**

ูุซู ูุชุฏูุงุ ุฑูุฏุงุฏูุง ูโุชูุงููุฏ **virtual**ุ **overridden**ุ **abstract** ุง **sealed** ุจุงุดูุฏ. ููฺูู ูโุชูุงููุฏ **static** ุจุงุดูุฏ:

```csharp
public class Foo
{
    public static event EventHandler<EventArgs> StaticEvent;
    public virtual event EventHandler<EventArgs> VirtualEvent;
}
```

---

**Lambda Expressions ฮป**

ฺฉ **lambda expression** ูุชุฏ ุจุฏูู ูุงู ุงุณุช ฺฉู ุจู ุฌุง ฺฉ instance delegate ููุดุชู ูโุดูุฏ. ฺฉุงููพุงูุฑ ุจูุงูุงุตูู ุขู ุฑุง ุจู ฺฉ ุงุฒ ููุงุฑุฏ ุฒุฑ ุชุจุฏู ูโฺฉูุฏ:

+ ฺฉ instance delegate
+ ุง ฺฉ **expression tree** ุงุฒ ููุน `Expression<TDelegate>` ฺฉู ฺฉุฏ ุฏุงุฎู lambda ุฑุง ุจู ุตูุฑุช ฺฉ ูุฏู ุดุก ูุงุจู ูพูุงุด ููุงุด ูโุฏูุฏ. ุงู ุงุฌุงุฒู ูโุฏูุฏ lambda ุจุนุฏุงู ุฏุฑ ุฒูุงู ุงุฌุฑุง ุชูุณุฑ ุดูุฏ.

ูุซุงู:

```csharp
Transformer sqr = x => x * x;
Console.WriteLine(sqr(3));   // ุฎุฑูุฌ: 9
delegate int Transformer(int i);
```

ฺฉุงููพุงูุฑ lambdaูุง ุงู ููุน ุฑุง ุจุง ููุดุชู ฺฉ ูุชุฏ ุฎุตูุต ู ุงูุชูุงู ฺฉุฏ expression ุจู ุขู ูุชุฏ ุญู ูโฺฉูุฏ.

ูุฑู ฺฉู ฺฉ lambda:

```
(parameters) => expression-or-statement-block
```

ุงฺฏุฑ ููุท ฺฉ ูพุงุฑุงูุชุฑ ุจุง ููุน ูุงุจู ุงุณุชูุชุงุฌ ุฏุงุดุชู ุจุงุดูุ ูโุชูุงู ูพุฑุงูุชุฒูุง ุฑุง ุญุฐู ฺฉุฑุฏ.

ูุซุงู:

```csharp
x => x * x;
```

ูุฑ ูพุงุฑุงูุชุฑ lambda ูุชูุงุธุฑ ุจุง ูพุงุฑุงูุชุฑ delegate ุงุณุช ู ููุน expression (ฺฉู ููฺฉู ุงุณุช **void** ุจุงุดุฏ) ูุชูุงุธุฑ ุจุง ููุน ุจุงุฒฺฏุดุช delegate ุงุณุช.

ูโุชูุงู expression ุฑุง ุจู ุตูุฑุช ฺฉ ุจููฺฉ statement ูุฒ ููุดุช:

```csharp
x => { return x * x; };
```

ุงุบูุจ lambdaูุง ููุฑุงู ุจุง **Func** ู **Action** ุงุณุชูุงุฏู ูโุดููุฏ:

```csharp
Func<int,int> sqr = x => x * x;
```

ูุซุงู ุจุง ุฏู ูพุงุฑุงูุชุฑ:

```csharp
Func<string,string,int> totalLength = (s1, s2) => s1.Length + s2.Length;
int total = totalLength("hello", "world");   // total = 10
```

ุงฺฏุฑ ูุงุฒ ุจู ุงุณุชูุงุฏู ุงุฒ ูพุงุฑุงูุชุฑูุง ูุณุชุ ูโุชูุงู ุขูโูุง ุฑุง ุจุง underscore ุฏูุฑ ุงูุฏุงุฎุช (ุงุฒ C# 9):

```csharp
Func<string,string,int> totalLength = (_,_) => ...
```

ูุซุงู ุจุฏูู ุขุฑฺฏููุงู:

```csharp
Func<string> greeter = () => "Hello, world";
```

ุงุฒ C# 10 ุจู ุจุนุฏุ ูโุชูุงู ุงุฒ **implicit typing** ุจุฑุง lambda ุงุณุชูุงุฏู ฺฉุฑุฏ:

```csharp
var greeter = () => "Hello, world";
```

### ูุดุฎุต ฺฉุฑุฏู ุตุฑุญ ููุน ูพุงุฑุงูุชุฑ ู ููุน ุจุงุฒฺฏุดุช Lambda ๐ง

ฺฉุงููพุงูุฑ ูุนูููุงู ูโุชูุงูุฏ ููุน ูพุงุฑุงูุชุฑูุง lambda ุฑุง ุจู ุตูุฑุช ุฒูููโุง ุงุณุชูุชุงุฌ ฺฉูุฏ. ููุช ุงู ุงูฺฉุงู ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏุ ุจุงุฏ ููุน ูุฑ ูพุงุฑุงูุชุฑ ุฑุง ุจู ุตูุฑุช ุตุฑุญ ูุดุฎุต ฺฉูุฏ. ุจู ุฏู ูุชุฏ ุฒุฑ ุชูุฌู ฺฉูุฏ:

```csharp
void Foo<T>(T x) { }
void Bar<T>(Action<T> a) { }
```

ฺฉุฏ ุฒุฑ **ฺฉุงููพุงู ููโุดูุฏ**ุ ุฒุฑุง ฺฉุงููพุงูุฑ ููโุชูุงูุฏ ููุน `x` ุฑุง ุงุณุชูุชุงุฌ ฺฉูุฏ:

```csharp
Bar(x => Foo(x));   // ููุน x ฺุณุชุ
```

ูโุชูุงู ุจุง ูุดุฎุต ฺฉุฑุฏู ุตุฑุญ ููุน `x` ูุดฺฉู ุฑุง ุญู ฺฉุฑุฏ:

```csharp
Bar((int x) => Foo(x));
```

ุงู ูุซุงู ุณุงุฏู ุฑุง ูโุชูุงู ุจู ุฏู ุฑูุด ุฏฺฏุฑ ูุฒ ุงุตูุงุญ ฺฉุฑุฏ:

```csharp
Bar<int>(x => Foo(x));  // ูุดุฎุต ฺฉุฑุฏู type parameter ุจุฑุง Bar
Bar<int>(Foo);          // ููุงููุฏ ุจุงูุงุ ุจุง ุงุณุชูุงุฏู ุงุฒ method group
```

ูุซุงู ุฏฺฏุฑ ุงุฒ ุงุณุชูุงุฏู explicit ุจุฑุง ููุน ูพุงุฑุงูุชุฑ (C# 10):

```csharp
var sqr = (int x) => x * x;
```

ฺฉุงููพุงูุฑ `sqr` ุฑุง ุจู ููุน `Func<int,int>` ุงุณุชูุชุงุฌ ูโฺฉูุฏ. ุจุฏูู ูุดุฎุต ฺฉุฑุฏู `int`ุ ุงุณุชูุชุงุฌ ููุน ุดฺฉุณุช ูโุฎูุฑุฏ: ฺฉุงููพุงูุฑ ูโุฏุงูุฏ ฺฉู sqr ุจุงุฏ ุงุฒ ููุน `Func<T,T>` ุจุงุดุฏุ ุงูุง ููโุฏุงูุฏ T ฺุณุช.

ุงุฒ C# 10 ุจู ุจุนุฏ ูโุชูุงู ููุน ุจุงุฒฺฏุดุช lambda ุฑุง ูุฒ ูุดุฎุต ฺฉุฑุฏ:

```csharp
var sqr = int (int x) => x;
```

ูุดุฎุต ฺฉุฑุฏู ููุน ุจุงุฒฺฏุดุช ูโุชูุงูุฏ ุนููฺฉุฑุฏ ฺฉุงููพุงูุฑ ุฑุง ุฏุฑ lambdaูุง ูพฺุฏู ู ุชู ุฏุฑ ุชู ุจูุจูุฏ ุฏูุฏ.

---

### ูพุงุฑุงูุชุฑูุง ูพุดโูุฑุถ Lambda (C# 12) ๐ฏ

ูุงููุฏ ูุชุฏูุง ูุนููู ฺฉู ูโุชูุงููุฏ ูพุงุฑุงูุชุฑ ุงุฎุชุงุฑ ุฏุงุดุชู ุจุงุดูุฏ:

```csharp
void Print(string message = "") => Console.WriteLine(message);
```

lambdaูุง ูุฒ ูโุชูุงููุฏ ูพุงุฑุงูุชุฑ ุงุฎุชุงุฑ ุฏุงุดุชู ุจุงุดูุฏ:

```csharp
var print = (string message = "") => Console.WriteLine(message);
print("Hello");
print();
```

ุงู ูฺฺฏ ุจุฑุง ฺฉุชุงุจุฎุงููโูุง ูุงููุฏ **ASP.NET Minimal API** ููุฏ ุงุณุช.

---

### ุฏุณุชุฑุณ ุจู ูุชุบุฑูุง ุฎุงุฑุฌ (Outer Variables) ๐

ฺฉ lambda ูโุชูุงูุฏ ุจู ูุฑ ูุชุบุฑ ฺฉู ุฏุฑ ูุญู ุชุนุฑูุด ูุงุจู ุฏุณุชุฑุณ ุงุณุชุ ุงุฑุฌุงุน ุฏูุฏ. ุงู ูุชุบุฑูุง **outer variables** ูุงูุฏู ูโุดููุฏ ู ูโุชูุงููุฏ ุดุงูู ูุชุบุฑูุง ูุญูุ ูพุงุฑุงูุชุฑูุง ู ููุฏูุง ุจุงุดูุฏ:

```csharp
int factor = 2;
Func<int, int> multiplier = n => n * factor;
Console.WriteLine(multiplier(3));   // ุฎุฑูุฌ: 6
```

ูุชุบุฑูุง ฺฉู ุชูุณุท lambda ุงุฑุฌุงุน ูโุดููุฏุ **captured variables** ูุงูุฏู ูโุดููุฏ. lambda ฺฉู ูุชุบุฑูุง ุฑุง capture ูโฺฉูุฏุ **closure** ูุงูุฏู ูโุดูุฏ.

ูุชุบุฑูุง capture ุดุฏู ููฺฏุงู ูุฑุงุฎูุงู delegate ุงุฑุฒุงุจ ูโุดููุฏุ ูู ููฺฏุงู capture ุดุฏู:

```csharp
int factor = 2;
Func<int, int> multiplier = n => n * factor;
factor = 10;
Console.WriteLine(multiplier(3));  // ุฎุฑูุฌ: 30
```

lambdaูุง ูโุชูุงููุฏ ุฎูุฏุดุงู ูุชุบุฑูุง capture ุดุฏู ุฑุง ุจูโุฑูุฒุฑุณุงู ฺฉููุฏ:

```csharp
int seed = 0;
Func<int> natural = () => seed++;
Console.WriteLine(natural());  // 0
Console.WriteLine(natural());  // 1
Console.WriteLine(seed);       // 2
```

ูุชุบุฑูุง capture ุดุฏู ุทูู ุนูุฑุดุงู ุชุง ุทูู ุนูุฑ delegate ุงุฏุงูู ูพุฏุง ูโฺฉูุฏ. ูุซุงู:

```csharp
static Func<int> Natural()
{
    int seed = 0;
    return () => seed++;  // ุจุฑูโฺฏุฑุฏุงูุฏ ฺฉ closure
}

static void Main()
{
    Func<int> natural = Natural();
    Console.WriteLine(natural()); // 0
    Console.WriteLine(natural()); // 1
}
```

ุงฺฏุฑ ูุชุบุฑ ูุญู ุฑุง ุฏุงุฎู ุฎูุฏ lambda ุจุณุงุฒูุ ูุฑ ูุฑุงุฎูุงู delegate ฺฉ ูุชุบุฑ ุฌุฏุฏ ุงุฌุงุฏ ูโฺฉูุฏ:

```csharp
static Func<int> Natural()
{
    return () => { int seed = 0; return seed++; };
}

static void Main()
{
    Func<int> natural = Natural();
    Console.WriteLine(natural());  // 0
    Console.WriteLine(natural());  // 0
}
```

ูพุงุฏูโุณุงุฒ capture ุฏุงุฎู ุจุง **hoisting** ุงูุฌุงู ูโุดูุฏ: ูุชุบุฑูุง capture ุดุฏู ุจู ููุฏูุง ฺฉ ฺฉูุงุณ ุฎุตูุต ููุชูู ูโุดููุฏ ู ููฺฏุงู ูุฑุงุฎูุงู ูุชุฏุ ฺฉูุงุณ ุงุฌุงุฏ ุดุฏู ู ุจู delegate ูุงุจุณุชู ูโุดูุฏ.

---

### Lambdaูุง ุงุณุชุงุชฺฉ โก

ุฒูุงู ฺฉู lambda ูุชุบุฑูุง ูุญูุ ูพุงุฑุงูุชุฑูุงุ ููุฏูุง instance ุง **this** ุฑุง capture ูโฺฉูุฏุ ฺฉุงููพุงูุฑ ููฺฉู ุงุณุช ฺฉูุงุณ ุฎุตูุต ุงุฌุงุฏ ฺฉูุฏ ุชุง ุงุฑุฌุงุน ุจู ุฏุงุฏูโูุง ุฐุฎุฑู ุดูุฏ. ุงู ุจุงุนุซ ูุตุฑู ุญุงูุธู ูโุดูุฏ.

ุงุฒ C# 9 ุจู ุจุนุฏ ูโุชูุงู ุจุง **static** ฺฉุฑุฏู lambdaุ local function ุง anonymous methodุ ุงุฒ capture ุดุฏู state ุฌููฺฏุฑ ฺฉุฑุฏ:

```csharp
Func<int, int> multiplier = static n => n * 2;
```

ุงฺฏุฑ ุจุนุฏุงู lambda ุจุฎูุงูุฏ ูุชุบุฑ ุฑุง capture ฺฉูุฏุ ฺฉุงููพุงูุฑ ุฎุทุง ูโุฏูุฏ:

```csharp
int factor = 2;
Func<int, int> multiplier = static n => n * factor;  // ฺฉุงููพุงู ููโุดูุฏ
```

lambda ุจุฏูู captureุ ฺฉ instance delegate ฺฉุด ุดุฏู ุฑุง ูุฌุฏุฏุงู ุงุณุชูุงุฏู ูโฺฉูุฏ ู ูุฒููโุง ูุฏุงุฑุฏ.

lambdaูุง ุงุณุชุงุชฺฉ ูููุฒ ูโุชูุงููุฏ ุจู ูุชุบุฑูุง ู ุซุงุจุชโูุง static ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดูุฏ. **static** ุชููุง ููุด ุจุฑุฑุณ ุฏุงุฑุฏ ู ุชุงุซุฑ ุจุฑ IL ุชููุฏุดุฏู ูุฏุงุฑุฏุ ุจุฏูู ุขูุ ฺฉุงููพุงูุฑ ุฏุฑ ุตูุฑุช ูุงุฒ closure ุชููุฏ ูโฺฉูุฏุ ุงูุง ุญุช ุขู ุฒูุงู ุชุฑููุฏูุง ุจุฑุง ฺฉุงูุด ูุฒูู ุฏุงุฑุฏ.

### ฺฏุฑูุชู ูุชุบุฑูุง ุชฺฉุฑุงุฑ (Capturing iteration variables) ๐

ููุช ุฏุฑ ฺฉ ุญูููโ `for` ูุชุบุฑ ุชฺฉุฑุงุฑ (iteration variable) ุฑุง **Capture** ูโฺฉูุฏุ ุฒุจุงู C# ุจุง ุขู ุทูุฑ ุฑูุชุงุฑ ูโฺฉูุฏ ฺฉู ุงูฺฏุงุฑ **ุจุฑูู ุงุฒ ุญููู ุชุนุฑู ุดุฏู ุจุงุดุฏ**. ุนู ุฏุฑ ูุฑ ุชฺฉุฑุงุฑุ ููุงู ูุชุบุฑ ฺฏุฑูุชู ูโุดูุฏ. ุจู ููู ุฏูู ุจุฑูุงููโ ุฒุฑ ุจูโุฌุง ููุงุด `012`ุ ููุฏุงุฑ `333` ุฑุง ฺุงูพ ูโฺฉูุฏ:

```csharp
Action[] actions = new Action[3];
for (int i = 0; i < 3; i++)
    actions[i] = () => Console.Write(i);

foreach (Action a in actions) a();     // 333
```

ูุฑ **closure** (ุจุฎุด ูพุฑุฑูฺฏ ุดุฏู) ููุงู ูุชุบุฑ `i` ุฑุง ูโฺฏุฑุฏ. ุงู ููุทู ุงุณุชุ ฺูู `i` ูุชุบุฑ ุงุณุช ฺฉู ููุฏุงุฑุด ุจู ุชฺฉุฑุงุฑูุง ุญููู ุจุงู ูโูุงูุฏุ ุญุช ูโุชูุงูุฏ ุฏุงุฎู ุจุฏููโ ุญูููุ ููุฏุงุฑ `i` ุฑุง ุชุบุฑ ุฏูุฏ. ูุชุฌู ุงู ุงุณุช ฺฉู ููุช **delegate**ูุง ุจุนุฏุงู ูุฑุงุฎูุงู ูโุดููุฏุ ููฺฏ ููุฏุงุฑ `i` ุฏุฑ ูุญุธูโ ูุฑุงุฎูุงู ุฑุง ูโุจููุฏุ ุนู `3`. ุจุฑุง ุฏุฑฺฉ ุจูุชุฑุ ุญููู ุฑุง ุงูโุทูุฑ ุจุงุฒููุณ ฺฉูุฏ:

```csharp
Action[] actions = new Action[3];
int i = 0;
actions[0] = () => Console.Write(i);
i = 1;
actions[1] = () => Console.Write(i);
i = 2;
actions[2] = () => Console.Write(i);
i = 3;
foreach (Action a in actions) a();    // 333
```

ุฑุงูโุญู ุจุฑุง ููุงุด `012` ุงู ุงุณุช ฺฉู ูุชุบุฑ ุชฺฉุฑุงุฑ ุฑุง ุจู ฺฉ **ูุชุบุฑ ูุญู ุฌุฏุฏ** ฺฉู ุฏุฑ ููุงู ูุญุฏูุฏูโ ุญููู ูุฑุงุฑ ุฏุงุฑุฏุ ุงูุชุณุงุจ ุฏูู:

```csharp
Action[] actions = new Action[3];
for (int i = 0; i < 3; i++)
{
    int loopScopedi = i;
    actions[i] = () => Console.Write(loopScopedi);
}
foreach (Action a in actions) a();     // 012
```

ฺูู ุฏุฑ ูุฑ ุชฺฉุฑุงุฑุ ฺฉ ูุชุบุฑ ุฌุฏุฏ `loopScopedi` ุณุงุฎุชู ูโุดูุฏุ ูุฑ **closure** ฺฉ ูุชุบุฑ ูุชูุงูุช ุฑุง ูโฺฏุฑุฏ. โจ

> **ูฺฉุชู:** ูุจู ุงุฒ ูุณุฎูโ C# 5.0ุ ุญูููโูุง `foreach` ูู ููู ุฑูุชุงุฑ ุฑุง ุฏุงุดุชูุฏ ู ุจุงุนุซ ุณุฑุฏุฑฺฏู ูโุดุฏูุฏ. ฺูู ูุชุบุฑ ุฏุฑ `foreach` ุชุบุฑูุงูพุฐุฑ ุงุณุชุ ุงูุชุธุงุฑ ูโุฑูุช ูุญู ุจุงุดุฏุ ูู ูุจูุฏ. ุฎูุดุจุฎุชุงูู ุงู ููุถูุน ุงุตูุงุญ ุดุฏู ู ุญุงูุง ูโุชูุงูุฏ ูุชุบุฑูุง `foreach` ุฑุง ุจุฏูู ูฺฏุฑุงู Capture ฺฉูุฏ. โ

---

### ููุงุณูโ **Lambda Expressions** ู **Local Methods** ๐

ุนููฺฉุฑุฏ **local methods** (ุจุฎุด ยซLocal methodsยป ุฏุฑ ุตูุญู 106) ุดุจุงูุช ุฒุงุฏ ุจู **lambda expressions** ุฏุงุฑุฏุ ุงูุง ุณู ูุฒุช ุฏุงุฑูุฏ:

1. ูโุชูุงููุฏ **ุจุงุฒฺฏุดุช (recursive)** ุจุงุดูุฏ (ุฎูุฏุดุงู ุฑุง ุตุฏุง ุจุฒููุฏ) ุจุฏูู ูุงุฒ ุจู ุฑูุดโูุง ูพฺุฏู.
2. ูุงุฒ ุจู ูุดุฎุต ฺฉุฑุฏู ููุน delegate ูุฏุงุฑูุฏ ู ฺฉุฏ ุดููุบ ููโุดูุฏ.
3. **ฺฉุงุฑุง ุจุดุชุฑ** ุฏุงุฑูุฏ ฺูู ุณุฑุจุงุฑ delegate ุฑุง ุญุฐู ูโฺฉููุฏ.

**Local methods** ุจูููโุชุฑ ูุณุชูุฏ ฺูู ุงุฒ ูุงุณุทูโ delegate ุงุณุชูุงุฏู ููโฺฉููุฏ (ุงู ฺฉุงุฑ ุจุงุนุซ ุตุฑู ููุฏุงุฑ CPU ู ุญุงูุธู ูโุดูุฏ). ููฺูู ูโุชูุงููุฏ ุจู ูุชุบุฑูุง ูุญู ูุชุฏ ูุงูุฏ ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดูุฏ ุจุฏูู ุงูฺฉู ฺฉุงููพุงูุฑ ูุฌุจูุฑ ุจู **hoist ฺฉุฑุฏู** ุขูโูุง ุฏุฑ ฺฉ ฺฉูุงุณ ูุฎู ุจุงุดุฏ.

ุงูุง ุฏุฑ ุจุณุงุฑ ุงุฒ ููุงุฑุฏ ุดูุง ุจู delegate ูุงุฒ ุฏุงุฑุฏุ ูุซู ููุช ฺฉู ูโุฎูุงูุฏ ูุชุฏ ุจุง ูพุงุฑุงูุชุฑ ุงุฒ ููุน delegate ุฑุง ุตุฏุง ุจุฒูุฏ:

```csharp
public void Foo(Func<int, bool> predicate) { ... }
```

(ูููููโูุง ุจุดุชุฑ ุฏุฑ ูุตู 8 ุฎูุงูุฏ ุฏุฏ.) ุฏุฑ ุงู ููุงูุนุ ุงุณุชูุงุฏู ุงุฒ **lambda** ูุนูููุงู ฺฉูุชุงูโุชุฑ ู ุชูุฒุชุฑ ุงุณุช.

---

### ูุชุฏูุง ูุงุดูุงุณ (Anonymous Methods) ๐ถ๏ธ

**Anonymous methods** ูุงุจูุช ุฏุฑ C# 2.0 ุจูุฏูุฏ ฺฉู ุชุง ุญุฏ ุฒุงุฏ ุจุง **lambda expressions** ุฏุฑ C# 3.0 ุฌุงฺฏุฒู ุดุฏูุฏ. ูุชุฏูุง ูุงุดูุงุณ ูุซู lambda ูุณุชูุฏุ ุงูุง ุงูฺฉุงูุงุช ุฒุฑ ุฑุง ูุฏุงุฑูุฏ:

+ **ูพุงุฑุงูุชุฑูุง ููุนโุฏู ุถูู (implicitly typed)**
+ **ููุดุชุงุฑ ุจู ุดฺฉู expression** (ููุดู ุจุงุฏ ุจู ุตูุฑุช ุจููฺฉ ุจุงูู ุจุงุดูุฏ)
+ ุชูุงูุง **ุชุจุฏู ุจู Expression Tree** ุจุง `Expression<T>`

ูุซุงู:

```csharp
delegate int Transformer(int i);
Transformer sqr = delegate (int x) { return x * x; };
Console.WriteLine(sqr(3));  // 9
```

ุงู ูุนุงุฏู ููุดุชุงุฑ ุฒุฑ ุจุง lambda ุงุณุช:

```csharp
Transformer sqr = (int x) => { return x * x; };
// ุง ุณุงุฏูโุชุฑ:
Transformer sqr = x => x * x;
```

ูุชุฏูุง ูุงุดูุงุณ ูู ูุซู lambdaูุง ูุชุบุฑูุง ุจุฑูู ุฑุง Capture ูโฺฉููุฏ ู ุญุช ูโุชูุงููุฏ ุจุง ฺฉูููโ ฺฉูุฏ `static` ุดุจู lambdaูุง ุงุณุชุงุชฺฉ ุฑูุชุงุฑ ฺฉููุฏ.

ูฺฺฏ ุฎุงุต ุขูโูุง ุงู ุงุณุช ฺฉู **ูโุชูุงู ูพุงุฑุงูุชุฑูุง ุฑุง ฺฉุงููุงู ุญุฐู ฺฉุฑุฏ**ุ ุญุช ุงฺฏุฑ delegate ุขูโูุง ุฑุง ุงูุชุธุงุฑ ุฏุงุดุชู ุจุงุดุฏ. ุงู ุจุฑุง ุชุนุฑู event ุจุง handler ุฎุงู ููุฏ ุงุณุช:

```csharp
public event EventHandler Clicked = delegate { };
```

ุงู ฺฉุงุฑ ุจุงุนุซ ูโุดูุฏ ูุจู ุงุฒ ุตุฏุง ุฒุฏู event ูุงุฒ ุจู ุจุฑุฑุณ null ูุฏุงุดุชู ุจุงุดุฏ. ููฺูู ููุดุชู ุฒุฑ ูู ูุนุชุจุฑ ุงุณุช:

```csharp
// ูพุงุฑุงูุชุฑูุง ุญุฐู ุดุฏูโุงูุฏ:
Clicked += delegate { Console.WriteLine("clicked"); };
```

---

### ุฏุณุชูุฑุงุช try ู ูุฏุฑุช ุงุณุชุซูุงูุง (try Statements and Exceptions) โ๏ธ

ฺฉ ุฏุณุชูุฑ `try` ฺฉ ุจููฺฉ ฺฉุฏ ุฑุง ูุดุฎุต ูโฺฉูุฏ ฺฉู ููฺฉู ุงุณุช ุฎุทุง ุฑุฎ ุฏูุฏ ุง ูุงุฒ ุจู ูพุงฺฉุณุงุฒ ุฏุงุดุชู ุจุงุดุฏ. ุจููฺฉ `try` ุจุงุฏ ุญุฏุงูู ุจุง ฺฉ `catch` ุง ฺฉ `finally` (ุง ูุฑ ุฏู) ููุฑุงู ุจุงุดุฏ:

+ **catch** ุฒูุงู ุงุฌุฑุง ูโุดูุฏ ฺฉู ุฎุทุง ุฏุฑ ุจููฺฉ try ุฑุฎ ุฏูุฏ.
+ **finally** ููุดู ุจุนุฏ ุงุฒ ุฎุฑูุฌ ุงุฒ try (ุง catch) ุงุฌุฑุง ูโุดูุฏ ู ูุนูููุงู ุจุฑุง ฺฉุงุฑูุง ูพุงฺฉุณุงุฒ ูุซู ุจุณุชู ุงุชุตุงูุงุช ุดุจฺฉู ุงุณุช.

`catch` ุจู ุดุก `Exception` ุฏุณุชุฑุณ ุฏุงุฑุฏ ฺฉู ุงุทูุงุนุงุช ุฎุทุง ุฑุง ูฺฏู ูโุฏุงุฑุฏ. ุดูุง ูโุชูุงูุฏ ุฎุทุง ุฑุง ูุฏุฑุช ฺฉูุฏ ุง ุฏูุจุงุฑู ูพุฑุชุงุจ ฺฉูุฏ (ุจุฑุง ูุงฺฏ ฺฉุฑุฏู ุง ุจุงูุง ุจุฑุฏู ุณุทุญ ุฎุทุง).

ูุซุงู:

```csharp
try
{
    // ููฺฉู ุงุณุช ุฎุทุง ุฑุฎ ุฏูุฏ
}
catch (ExceptionA ex)
{
    // ูุฏุฑุช ุฎุทุง ููุน ExceptionA
}
catch (ExceptionB ex)
{
    // ูุฏุฑุช ุฎุทุง ููุน ExceptionB
}
finally
{
    // ูพุงฺฉุณุงุฒ
}
```

ุจุฑูุงููโ ุฒุฑ ุฑุง ุฏุฑ ูุธุฑ ุจฺฏุฑุฏ:

```csharp
int y = Calc(0);
Console.WriteLine(y);

int Calc(int x) => 10 / x;
```

ฺูู `x` ุตูุฑ ุงุณุชุ ุฎุทุง `DivideByZeroException` ุฑุฎ ูโุฏูุฏ ู ุจุฑูุงูู ูุชููู ูโุดูุฏ. ุญุงูุง ุจุง `try/catch`:

```csharp
try
{
    int y = Calc(0);
    Console.WriteLine(y);
}
catch (DivideByZeroException ex)
{
    Console.WriteLine("x cannot be zero");
}
Console.WriteLine("program completed");

int Calc(int x) => 10 / x;
```

ุฎุฑูุฌ:

```
x cannot be zero
program completed
```

ุฏุฑ ุนููุ ุจูุชุฑ ุงุณุช **ุฎุทุงูุง ูุงุจู ูพุดฺฏุฑ ุฑุง ูุจู ุงุฒ ูููุน ุจุฑุฑุณ ฺฉูุฏ**ุ ูุซูุงู ุชูุณู ุจุฑ ุตูุฑ ุฑุง ฺฺฉ ฺฉูุฏุ ฺูู **exceptionูุง ูุฒููโุจุฑ ูุณุชูุฏ** (ุตุฏูุง ุณฺฉู ูพุฑุฏุงุฒูุฏู ุง ุจุดุชุฑ).

ููุช exception ุฑุฎ ูโุฏูุฏุ CLR ุจุฑุฑุณ ูโฺฉูุฏ:

+ ุงฺฏุฑ `catch` ุณุงุฒฺฏุงุฑ ูพุฏุง ุดุฏ: ููุงู ุฑุง ุงุฌุฑุง ูโฺฉูุฏุ ุณูพุณ `finally` ู ุจุฑูุงูู ุงุฏุงูู ูโุงุจุฏ.
+ ุงฺฏุฑ ูพุฏุง ูุดุฏ: `finally` ุงุฌุฑุง ูโุดูุฏ (ุงฺฏุฑ ุจุงุดุฏ) ู CLR ุจู ุนูุจ ุฏุฑ stack ุฏูุจุงู `try` ูโฺฏุฑุฏุฏ.
+ ุงฺฏุฑ ูฺ ุชุงุจุน ูุณุฆููุช ูฺฏุฑูุช: ุจุฑูุงูู ูุชููู ูโุดูุฏ.

---

### ุจุฎุด catch (ุจุฎุด ฺฏุฑูุชู ุงุณุชุซูุงูุง) ๐ก๏ธ

ฺฉ **catch clause** ูุดุฎุต ูโฺฉูุฏ ฺฉู ฺู ููุน ุงุณุชุซูุง (**Exception**) ุจุงุฏ ฺฏุฑูุชู ุดูุฏ. ุงู ููุน ุจุงุฏ ุง **System.Exception** ุจุงุดุฏ ุง ฺฉ ุฒุฑฺฉูุงุณ ุงุฒ **System.Exception**.

ุงฺฏุฑ **System.Exception** ุฑุง ุจฺฏุฑุฏุ ุชูุงู ุฎุทุงูุง ููฺฉู ุฑุง ุฎูุงูุฏ ฺฏุฑูุช. ุงู ฺฉุงุฑ ุฏุฑ ุดุฑุงุท ุฒุฑ ููุฏ ุงุณุช:

+ ููุช ุจุฑูุงููโุชุงู ูโุชูุงูุฏ ุจุฏูู ุชูุฌู ุจู ููุน ุฎุงุต ุงุณุชุซูุงุ ุจูุจูุฏ ุงุจุฏ.
+ ููุช ูุตุฏ ุฏุงุฑุฏ ุงุณุชุซูุง ุฑุง ุฏูุจุงุฑู ูพุฑุชุงุจ ฺฉูุฏ (ูุซูุงู ุจุนุฏ ุงุฒ ุซุจุช ุง **Log** ฺฉุฑุฏู ุขู).
+ ููุช ููุฏูุฑ ุฎุทุง ุดูุง ุขุฎุฑู ุฎุท ุฏูุงุน ูุจู ุงุฒ ูพุงุงู ุจุฑูุงูู ุงุณุช.

ุงูุง ุฏุฑ ุญุงูุช ูุนูููุ ุจูุชุฑ ุงุณุช ููุนโูุง ุฎุงุต ุงุณุชุซูุง ุฑุง ุจฺฏุฑุฏ ุชุง ูุฌุจูุฑ ูุดูุฏ ุจุง ุดุฑุงุท ุฑูุจูโุฑู ุดูุฏ ฺฉู ููุฏูุฑ ุดูุง ุจุฑุง ุขู ุทุฑุงุญ ูุดุฏู ุงุณุช (ูุซูุงู **OutOfMemoryException**).

ุจุฑุง ูุฏุฑุช ฺูุฏ ููุน ุงุณุชุซูุงุ ูโุชูุงูุฏ ุงุฒ ฺูุฏู ุจุฎุด **catch** ุงุณุชูุงุฏู ฺฉูุฏ (ูุฑฺูุฏ ุฏุฑ ุงู ูุซุงู ูโุชูุงู ุจู ุฌุง ูุฏุฑุช ุงุณุชุซูุงุ ุจุฑุฑุณ ูุฑูุฏโูุง ุฑุง ุงูุฌุงู ุฏุงุฏ):

```csharp
class Test
{
  static void Main (string[] args)
  {
    try
    {
      byte b = byte.Parse (args[0]);
      Console.WriteLine (b);
    }
    catch (IndexOutOfRangeException)
    {
      Console.WriteLine ("Please provide at least one argument");
    }
    catch (FormatException)
    {
      Console.WriteLine ("That's not a number!");
    }
    catch (OverflowException)
    {
      Console.WriteLine ("You've given me more than a byte!");
    }
  }
}
```

ุจุฑุง ูุฑ ุงุณุชุซูุง ููุท ฺฉ **catch** ุงุฌุฑุง ูโุดูุฏ. ุงฺฏุฑ ูโุฎูุงูุฏ ฺฉ ููุฏูุฑ ฺฉู ูุซู **System.Exception** ุฏุงุดุชู ุจุงุดุฏุ ุจุงุฏ ููุฏูุฑูุง ุฎุงุตโุชุฑ ุฑุง ูุจู ุงุฒ ุขู ูุฑุงุฑ ุฏูุฏ.

ฺฏุงู ูุงุฒ ูุฏุงุฑุฏ ุจู ูฺฺฏโูุง ุงุณุชุซูุง ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดุฏ. ุฏุฑ ุงู ุญุงูุช ูโุชูุงูุฏ ูุชุบุฑ ุฑุง ุญุฐู ฺฉูุฏ:

```csharp
catch (OverflowException)   // ุจุฏูู ูุชุบุฑ
{
  ...
}
```

ุญุช ูโุชูุงูุฏ ูู ูุชุบุฑ ู ูู ููุน ุฑุง ุญุฐู ฺฉูุฏ (ุจู ุงู ูุนู ฺฉู ููู ุงุณุชุซูุงูุง ฺฏุฑูุชู ูโุดููุฏ):

```csharp
catch { ... }
```

---

### Exception filters (ููุชุฑูุง ุงุณุชุซูุง) ๐

ูโุชูุงูุฏ ุฏุฑ ุจุฎุด **catch** ฺฉ ููุชุฑ ุงุณุชุซูุง ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉููู **when** ูุดุฎุต ฺฉูุฏ:

```csharp
catch (WebException ex) when (ex.Status == WebExceptionStatus.Timeout)
{
  ...
}
```

ุฏุฑ ุงู ูุซุงูุ ุงฺฏุฑ **WebException** ูพุฑุชุงุจ ุดูุฏุ ุนุจุงุฑุช ุจูู ุจุนุฏ ุงุฒ **when** ุงุฑุฒุงุจ ูโุดูุฏ. ุงฺฏุฑ ูุชุฌู **false** ุจุงุดุฏุ ุงู **catch** ูุงุฏุฏู ฺฏุฑูุชู ุดุฏู ู ุจู ุณุฑุงุบ **catch**ูุง ุจุนุฏ ูโุฑูุฏ.

ุจุง **exception filters** ูโุชูุงู ฺฉ ููุน ุงุณุชุซูุง ุฑุง ฺูุฏ ุจุงุฑ ุจุง ุดุฑุงุท ูุชูุงูุช ฺฏุฑูุช:

```csharp
catch (WebException ex) when (ex.Status == WebExceptionStatus.Timeout)
{ ... }
catch (WebException ex) when (ex.Status == WebExceptionStatus.SendFailure)
{ ... }
```

ุนุจุงุฑุช ุจูู ุฏุฑ **when** ุญุช ูโุชูุงูุฏ ุดุงูู ูุชุฏูุง ุจุงุดุฏ ฺฉู ุนููุงุช ุฌุงูุจ ุงูุฌุงู ูโุฏููุฏุ ูุงููุฏ ุซุจุช ุฎุทุง ุจุฑุง ุงูุฏุงู ุนุจโุงุจ.

---

### ุจุฎุด finally (ุจุฎุด ูพุงุงู) ๐งน

ุจุฎุด **finally** ููุดู ุงุฌุฑุง ูโุดูุฏโฺู ุงุณุชุซูุง ุฑุฎ ุฏูุฏ ฺู ููุ ู ฺู **try** ุจู ุทูุฑ ฺฉุงูู ุงุฌุฑุง ุดูุฏ ุง ุฎุฑ. ูุนูููุงู ุงุฒ **finally** ุจุฑุง ฺฉุฏูุง ูพุงฺฉโุณุงุฒ ุงุณุชูุงุฏู ูโฺฉูู.

ุจุฎุด **finally** ุจุนุฏ ุงุฒ ูุฑ ฺฉ ุงุฒ ุงู ุญุงูุชโูุง ุงุฌุฑุง ูโุดูุฏ:

+ ุจุนุฏ ุงุฒ ุงุชูุงู ฺฉ **catch** (ุง ุฒูุงู ฺฉู ฺฉ ุงุณุชุซูุง ุฌุฏุฏ ูพุฑุชุงุจ ุดูุฏ).
+ ุจุนุฏ ุงุฒ ุงุชูุงู ุจููฺฉ **try** (ุง ุฒูุงู ฺฉู ุงุณุชุซูุง ุฑุฎ ุฏูุฏ ฺฉู ููุฏูุฑ ุจุฑุงุด ูุฌูุฏ ูุฏุงุฑุฏ).
+ ุฒูุงู ฺฉู ฺฉูุชุฑู ุจุง ฺฉ ุฏุณุชูุฑ ูพุฑุด (ูุซู **return** ุง **goto**) ุงุฒ ุจููฺฉ **try** ุฎุงุฑุฌ ุดูุฏ.

ุชููุง ููุงุฑุฏ ฺฉู ูโุชูุงููุฏ ูุงูุน ุงุฌุฑุง **finally** ุดููุฏุ ฺฉ ุญููู ุจโููุงุช ุง ูพุงุงู ูุงฺฏูุงู ูพุฑุฏุงุฒุด ุงุณุช.

ุจุฎุด **finally** ุจู ุจุฑูุงููโุชุงู ูุธู ู ูุทุนุช ุงุถุงูู ูโฺฉูุฏ. ุฏุฑ ูุซุงู ุฒุฑุ ูุงู ฺฉู ุจุงุฒ ุดุฏู ููุดู ุจุณุชู ูโุดูุฏุ ุตุฑูโูุธุฑ ุงุฒ ุงูฺฉู:

+ ุจููฺฉ **try** ุจู ุทูุฑ ุนุงุฏ ุชูุงู ุดูุฏ.
+ ุงุฌุฑุง ุจู ุฏูู ุฎุงู ุจูุฏู ูุงู (**EndOfStream**) ุฒูุฏุชุฑ ุจุงุฒฺฏุฑุฏุฏ.
+ ฺฉ **IOException** ููฺฏุงู ุฎูุงูุฏู ูุงู ุฑุฎ ุฏูุฏ:

```csharp
void ReadFile()
{
  StreamReader reader = null;    // ุฏุฑ ูุถุง ูุงู System.IO
  try
  {
    reader = File.OpenText ("file.txt");
    if (reader.EndOfStream) return;
    Console.WriteLine (reader.ReadToEnd());
  }
  finally
  {
    if (reader != null) reader.Dispose();
  }
}
```

ุฏุฑ ุงู ูุซุงูุ ูุงู ุฑุง ุจุง ูุฑุงุฎูุงู **Dispose** ุฑู **StreamReader** ุจุณุชู. ูุฑุงุฎูุงู **Dispose** ุฑู ฺฉ ุดุก ุฏุฑ ุฏุงุฎู **finally** ฺฉ ุฑูุด ุงุณุชุงูุฏุงุฑุฏ ุงุณุช ู ุฏุฑ #C ุจุง ุฏุณุชูุฑ **using** ูุฒ ูพุดุชุจุงู ูโุดูุฏ.

---

### ุฏุณุชูุฑ `using` โป๏ธ

ุจุณุงุฑ ุงุฒ ฺฉูุงุณโูุง ููุงุจุน ูุฏุฑุชโูุดุฏู (Unmanaged Resources) ูุงููุฏ **ุฏุณุชฺฏุฑูโูุง ูุงู (File Handles)**ุ **ุฏุณุชฺฏุฑูโูุง ฺฏุฑุงูฺฉ (Graphics Handles)** ุง **ุงุชุตุงูุงุช ูพุงฺฏุงู ุฏุงุฏู (Database Connections)** ุฑุง ุฏุฑ ุฎูุฏ ุฌุง ูโุฏููุฏ. ุงู ฺฉูุงุณโูุง ุงูุชุฑูุณ **`System.IDisposable`** ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉููุฏ ฺฉู ุชููุง ฺฉ ูุชุฏ ุจุฏูู ูพุงุฑุงูุชุฑ ุจู ูุงู **`Dispose`** ุฏุงุฑุฏ ู ุจุฑุง ูพุงฺฉโุณุงุฒ ุงู ููุงุจุน ุงุณุชูุงุฏู ูโุดูุฏ.

ุฏุณุชูุฑ **`using`** ฺฉ ูฺฏุงุฑุด ุณุงุฏู ู ุดฺฉู ุจุฑุง ูุฑุงุฎูุงู **`Dispose`** ุฑู ฺฉ ุดุก ูพุงุฏูโุณุงุฒ **`IDisposable`**ุ ุฏุฑูู ฺฉ ุจููฺฉ **`finally`** ูุฑุงูู ูโฺฉูุฏ.

ุจูโุนููุงู ูุซุงู:

```csharp
using (StreamReader reader = File.OpenText("file.txt"))
{
    ...
}
```

ุงู ูุทุนูโฺฉุฏ ุฏููุงู ูุนุงุฏู ุฒุฑ ุงุณุช:

```csharp
StreamReader reader = File.OpenText("file.txt");
try
{
    ...
}
finally
{
    if (reader != null)
        ((IDisposable)reader).Dispose();
}
```

---

### ุงุนูุงูโูุง `using` (Using Declarations) โ๏ธ

ุงฺฏุฑ ุฏุฑ **C# 8 ู ูุณุฎูโูุง ุจุงูุงุชุฑ**ุ ุจุฑุงฺฉุชโูุง ู ุจููฺฉ ฺฉุฏ ุจุนุฏ ุงุฒ ุฏุณุชูุฑ **`using`** ุญุฐู ุดููุฏุ ุงู ุฏุณุชูุฑ ุชุจุฏู ุจู **ุงุนูุงู using** ูโุดูุฏ. ุฏุฑ ุงู ุญุงูุชุ ููุจุน ุฒูุงู ุขุฒุงุฏ ูโุดูุฏ ฺฉู ุงุฌุฑุง ุจุฑูุงูู ุงุฒ ุจููฺฉ ูุญุตูุฑฺฉููุฏู ุฎุงุฑุฌ ฺฏุฑุฏุฏ.

ูุซุงู:

```csharp
if (File.Exists("file.txt"))
{
    using var reader = File.OpenText("file.txt");
    Console.WriteLine(reader.ReadLine());
    ...
}
```

ุฏุฑ ุงู ุญุงูุชุ **`reader`** ุฒูุงู Dispose ูโุดูุฏ ฺฉู ุงุฌุฑุง ุจุฑูุงูู ุงุฒ ุจููฺฉ **`if`** ุฎุงุฑุฌ ุดูุฏ.

---

### ูพุฑุชุงุจ ุงุณุชุซูุง (Throwing Exceptions) ๐

ุงุณุชุซูุงูุง (Exceptions) ูโุชูุงููุฏ ูู ุชูุณุท **ุฒูุงู ุงุฌุฑุง (Runtime)** ู ูู ุฏุฑ **ฺฉุฏูุง ฺฉุงุฑุจุฑ** ูพุฑุชุงุจ ุดููุฏ. ุฏุฑ ูุซุงู ุฒุฑุ ูุชุฏ **`Display`** ฺฉ ุงุณุชุซูุง **`System.ArgumentNullException`** ุฑุง ูพุฑุชุงุจ ูโฺฉูุฏ:

```csharp
try { Display(null); }
catch (ArgumentNullException ex)
{
    Console.WriteLine("Caught the exception");
}

void Display(string name)
{
    if (name == null)
        throw new ArgumentNullException(nameof(name));
    Console.WriteLine(name);
}
```

ุงุฒ ุขูโุฌุง ฺฉู ุจุฑุฑุณ ุขุฑฺฏููุงู ุจุฑุง ููุฏุงุฑ **null** ู ูพุฑุชุงุจ **`ArgumentNullException`** ุจุณุงุฑ ุฑุงุฌ ุงุณุชุ ุงุฒ **.NET 6** ฺฉ ูุงูโุจุฑ ุงุฑุงุฆู ุดุฏู ุงุณุช:

```csharp
void Display(string name)
{
    ArgumentNullException.ThrowIfNull(name);
    Console.WriteLine(name);
}
```

ุชูุฌู ฺฉูุฏ ฺฉู ุฏุฑ ุงู ุฑูุดุ ูุงุฒ ุจู ูุดุฎุต ฺฉุฑุฏู ูุงู ูพุงุฑุงูุชุฑ ูุฏุงุฑู. ุฏูู ุงู ููุถูุน ุฏุฑ ุจุฎุด **CallerArgumentExpression** (ุตูุญู 247) ุชูุถุญ ุฏุงุฏู ุฎูุงูุฏ ุดุฏ.

---

### ุนุจุงุฑุชโูุง `throw` (Throw Expressions) ๐ฏ

ุนุจุงุฑุช **`throw`** ูโุชูุงูุฏ ุจูโุนููุงู ฺฉ **ุนุจุงุฑุช (Expression)** ุฏุฑ ูุชุฏูุง **Expression-bodied** ุงุณุชูุงุฏู ุดูุฏ:

```csharp
public string Foo() => throw new NotImplementedException();
```

ููฺูู ูโุชูุงูุฏ ุฏุฑ ฺฉ **ุนุจุงุฑุช ุดุฑุท ุณูโุชุง (Ternary Conditional Expression)** ุธุงูุฑ ุดูุฏ:

```csharp
string ProperCase(string value) =>
    value == null ? throw new ArgumentException("value") :
    value == "" ? "" :
    char.ToUpper(value[0]) + value.Substring(1);
```

---

### ูพุฑุชุงุจ ุฏูุจุงุฑู ุงุณุชุซูุง (Rethrowing an Exception) ๐

ูโุชูุงูุฏ ฺฉ ุงุณุชุซูุง ุฑุง ฺฏุฑูุชู ู ุฏูุจุงุฑู ูพุฑุชุงุจ ฺฉูุฏ:

```csharp
try
{
    ...
}
catch (Exception ex)
{
    // Log error
    ...
    throw; // ูพุฑุชุงุจ ุฏูุจุงุฑู ููุงู ุงุณุชุซูุง
}
```

ุงฺฏุฑ ุจูโุฌุง **`throw`** ุงุฒ **`throw ex`** ุงุณุชูุงุฏู ฺฉููุ ุจุฑูุงูู ููฺูุงู ฺฉุงุฑ ูโฺฉูุฏ ุงูุง ุฎุงุตุช **`StackTrace`** ุฏฺฏุฑ ูุณุฑ ุฎุทุง ุงุตู ุฑุง ูุดุงู ููโุฏูุฏ.

ูพุฑุชุงุจ ุฏูุจุงุฑู ุจู ุดูุง ุงุฌุงุฒู ูโุฏูุฏ ุฎุทุง ุฑุง **ุซุจุช (Log)** ฺฉูุฏ ุจุฏูู ุงูฺฉู ุขู ุฑุง ูุงุฏุฏู ุจฺฏุฑุฏุ ุง ุฒูุงู ฺฉู ุดุฑุงุท ูุฑุงุชุฑ ุงุฒ ุงูุชุธุงุฑ ุงุณุชุ ุงุฒ ุงุฏุงูู ูุฏุฑุช ุฎุทุง ุตุฑูโูุธุฑ ฺฉูุฏ.

ฺฉ ุฏฺฏุฑ ุงุฒ ุณูุงุฑููุง ุฑุงุฌุ ูพุฑุชุงุจ ฺฉ ุงุณุชุซูุง **ุฎุงุตโุชุฑ** ุงุณุช:

```csharp
try
{
    // Parse a DateTime from XML element data
}
catch (FormatException ex)
{
    throw new XmlException("Invalid DateTime", ex);
}
```

ุฏูุช ฺฉูุฏ ฺฉู ููฺฏุงู ุณุงุฎุช **`XmlException`**ุ ุงุณุชุซูุง ุงุตู **`ex`** ุฑุง ุจูโุนููุงู ุขุฑฺฏููุงู ุฏูู ูพุงุณ ุฏุงุฏู. ุงู ุขุฑฺฏููุงู ุฎุงุตุช **`InnerException`** ุฑุง ููุฏุงุฑุฏู ูโฺฉูุฏ ู ุฏุฑ ุงุดฺฉุงูโุฒุฏุง ฺฉูฺฉ ุฒุงุฏ ูโฺฉูุฏ. ุชูุฑุจุงู ููู ุงููุงุน ุงุณุชุซูุง ฺูู ุณุงุฒูุฏูโุง ุฏุงุฑูุฏ.

---

### ูพุฑุชุงุจ ฺฉ ุงุณุชุซูุง ฺฉูโุชุฑ (Less-Specific Exception)

ุงู ุฑูุด ุฒูุงู ููุฏ ุงุณุช ฺฉู ุฏุฑ ุญุงู ุนุจูุฑ ุงุฒ ฺฉ **ูุฑุฒ ุงุนุชูุงุฏ (Trust Boundary)** ูุณุชุฏ ุชุง ุงุฒ ุงูุดุง ุงุทูุงุนุงุช ูู ุจุฑุง ููุงุฌูุงู ุจุงูููู ุฌููฺฏุฑ ฺฉูุฏ.

---

### ูฺฺฏโูุง ฺฉูุฏ **System.Exception** โ๏ธ

ูููโุชุฑู ูฺฺฏโูุง **System.Exception** ุจู ุดุฑุญ ุฒุฑ ูุณุชูุฏ:

+ **StackTrace**
  ุฑุดุชูโุง (**string**) ฺฉู ุชูุงู ูุชุฏูุง ุฑุง ฺฉู ุงุฒ ููุทู ุดุฑูุน ุฑุฎุฏุงุฏ ุงุณุชุซูุง ุชุง ุจููฺฉ **catch** ูุฑุงุฎูุงู ุดุฏูโุงูุฏุ ููุงุด ูโุฏูุฏ.

+ **Message**
  ุฑุดุชูโุง ฺฉู ุชูุถุญ ุฎุทุง ุฑุง ุฏุฑ ุฎูุฏ ูฺฏู ูโุฏุงุฑุฏ.

+ **InnerException**
  ุงุณุชุซูุง ุฏุงุฎู (ุฏุฑ ุตูุฑุช ูุฌูุฏ) ฺฉู ุจุงุนุซ ุงุฌุงุฏ ุงุณุชุซูุง ุจุฑูู ุดุฏู ุงุณุช. ุงู ุงุณุชุซูุง ุฎูุฏ ูโุชูุงูุฏ ุดุงูู **InnerException** ุฏฺฏุฑ ูุฒ ุจุงุดุฏ.

> ุฏุฑ ุฒุจุงู C# ุชูุงู ุงุณุชุซูุงูุง ุฏุฑ ุฒูุงู ุงุฌุฑุง (**runtime exceptions**) ุงุชูุงู ูโุงูุชูุฏ ู ูุนุงุฏู ุจุฑุง ุงุณุชุซูุงูุง ุจุฑุฑุณโุดุฏู ุฏุฑ ุฒูุงู ฺฉุงููพุงู (**compile-time checked exceptions**) ูุงููุฏ Java ูุฌูุฏ ูุฏุงุฑุฏ.

---

### ุงููุงุน ุฑุงุฌ ุงุณุชุซูุงูุง ๐จ

ุงููุงุน ุฒุฑ ุงุฒ ุงุณุชุซูุงูุง ุจูโุทูุฑ ฺฏุณุชุฑุฏู ุฏุฑ ุณุฑุงุณุฑ **CLR** ู ฺฉุชุงุจุฎุงููโูุง **.NET** ุงุณุชูุงุฏู ูโุดููุฏ. ุดูุง ูโุชูุงูุฏ ุขูโูุง ุฑุง ุฎูุฏุชุงู ูพุฑุชุงุจ ฺฉูุฏ ุง ุงุฒ ุขูโูุง ุจูโุนููุงู ฺฉูุงุณ ูพุงู ุจุฑุง ุณุงุฎุช ุงููุงุน ุณูุงุฑุด ุงุณุชุซูุง ุงุณุชูุงุฏู ููุงุฏ:

+ **System.ArgumentException**
  ุฒูุงู ูพุฑุชุงุจ ูโุดูุฏ ฺฉู ฺฉ ุชุงุจุน ุจุง ุขุฑฺฏููุงู ูุงูุนุชุจุฑ ูุฑุงุฎูุงู ุดูุฏ. ูุนูููุงู ูุดุงูโุฏููุฏู ฺฉ ุฎุทุง ุจุฑูุงููโููุณ ุงุณุช.

+ **System.ArgumentNullException**
  ุฒุฑฺฉูุงุณ **ArgumentException** ฺฉู ููุช ฺฉ ุขุฑฺฏููุงู ุชุงุจุน ุจูโุทูุฑ ุบุฑููุชุธุฑู **null** ุจุงุดุฏุ ูพุฑุชุงุจ ูโุดูุฏ.

+ **System.ArgumentOutOfRangeException**
  ุฒุฑฺฉูุงุณ **ArgumentException** ฺฉู ููุช ฺฉ ุขุฑฺฏููุงู (ูุนูููุงู ุนุฏุฏ) ุฎู ุจุฒุฑฺฏ ุง ุฎู ฺฉูฺฺฉ ุจุงุดุฏุ ูพุฑุชุงุจ ูโุดูุฏ. ุจุฑุง ูุซุงูุ ุงุฑุณุงู ฺฉ ุนุฏุฏ ููู ุจู ุชุงุจุน ฺฉู ููุท ููุงุฏุฑ ูุซุจุช ุฑุง ูโูพุฐุฑุฏ.

+ **System.InvalidOperationException**
  ุฒูุงู ูพุฑุชุงุจ ูโุดูุฏ ฺฉู ูุถุนุช ฺฉ ุดุก ุจุฑุง ุงุฌุฑุง ููููุชโุขูุฒ ูุชุฏ ููุงุณุจ ูุจุงุดุฏุ ุจุฏูู ุชูุฌู ุจู ููุฏุงุฑ ุขุฑฺฏููุงูโูุง. ูุซุงูโูุง ุดุงูู ุฎูุงูุฏู ฺฉ ูุงู ุจุงุฒูุดุฏู ุง ุฏุฑุงูุช ุนูุตุฑ ุจุนุฏ ุงุฒ ฺฉ ุดูุงุฑูุฏู (**Enumerator**) ุงุณุช ฺฉู ูุณุช ุฒุฑู ุขู ุฏุฑ ูุงูู ุงุฌุฑุง ุชุบุฑ ฺฉุฑุฏู ุงุณุช.

+ **System.NotSupportedException**
  ุฒูุงู ูพุฑุชุงุจ ูโุดูุฏ ฺฉู ฺฉ ูุงุจูุช ุฎุงุต ูพุดุชุจุงู ููโุดูุฏ. ูุซุงู ููุงุณุจ: ูุฑุงุฎูุงู ูุชุฏ **Add** ุฑู ูุฌููุนูโุง ฺฉู **IsReadOnly** ุขู **true** ุงุณุช.

+ **System.NotImplementedException**
  ุฒูุงู ูพุฑุชุงุจ ูโุดูุฏ ฺฉู ฺฉ ุชุงุจุน ูููุฒ ูพุงุฏูโุณุงุฒ ูุดุฏู ุงุณุช.

+ **System.ObjectDisposedException**
  ุฒูุงู ูพุฑุชุงุจ ูโุดูุฏ ฺฉู ุฑู ุดุฆ ฺฉู ูุจูุงู **Dispose** ุดุฏูุ ูุชุฏ ูุฑุงุฎูุงู ุดูุฏ.

ฺฉ ุฏฺฏุฑ ุงุฒ ุงุณุชุซูุงูุง ุฑุงุฌ **NullReferenceException** ุงุณุช. ุงู ุงุณุชุซูุง ุชูุณุท **CLR** ุฒูุงู ูพุฑุชุงุจ ูโุดูุฏ ฺฉู ุชูุงุด ฺฉูุฏ ุจู ุนุถู ุงุฒ ุดุฆ ฺฉู ููุฏุงุฑ ุขู **null** ุงุณุช ุฏุณุชุฑุณ ูพุฏุง ฺฉูุฏ (ฺฉู ูุดุงูโุฏููุฏู ูุฌูุฏ ุจุงฺฏ ุฏุฑ ฺฉุฏ ุดูุงุณุช). ุจุฑุง ุชุณุชุ ูโุชูุงูุฏ ุจูโุทูุฑ ูุณุชูู ุงู ุงุณุชุซูุง ุฑุง ูพุฑุชุงุจ ฺฉูุฏ:

```csharp
throw null;
```

---

### ุงูฺฏู ูุชุฏูุง **TryXXX** ๐

ููฺฏุงู ููุดุชู ฺฉ ูุชุฏุ ุฒูุงู ฺฉู ูุดฺฉู ูพุด ูโุขุฏุ ุฏู ุงูุชุฎุงุจ ุฏุงุฑุฏ: ุง ฺฉ ฺฉุฏ ุฎุทุง ุจุฑฺฏุฑุฏุงูุฏ ุง ฺฉ ุงุณุชุซูุง ูพุฑุชุงุจ ฺฉูุฏ. ุจูโุทูุฑ ฺฉูุ ุฒูุงู ฺฉู ุฎุทุง ุฎุงุฑุฌ ุงุฒ ุฑููุฏ ุนุงุฏ ุจุฑูุงูู ุจุงุดุฏ ุง ุฒูุงู ฺฉู ุงูุชุธุงุฑ ูุฏุงุฑุฏ ูุฑุงุฎูุงููุฏู ุจุชูุงูุฏ ุจุง ุขู ููุงุจูู ฺฉูุฏุ ุงุณุชุซูุง ูพุฑุชุงุจ ูโฺฉูุฏ.

ุจุงุงูโุญุงูุ ฺฏุงู ุจูุชุฑ ุงุณุช ูุฑ ุฏู ุงูุชุฎุงุจ ุฑุง ุจู ูุตุฑูโฺฉููุฏู ุงุฑุงุฆู ุฏูุฏ. ูุซุงู ุงุฒ ุงู ููุฑุฏ ููุน **int** ุงุณุช ฺฉู ุฏู ูุณุฎู ุงุฒ ูุชุฏ **Parse** ุฑุง ุงุฑุงุฆู ูโุฏูุฏ:

```csharp
public int Parse(string input);
public bool TryParse(string input, out int returnValue);
```

ุงฺฏุฑ **Parse** ุดฺฉุณุช ุจุฎูุฑุฏุ ฺฉ ุงุณุชุซูุง ูพุฑุชุงุจ ูโฺฉูุฏุ ุงูุง **TryParse** ุฏุฑ ุงู ุญุงูุช ููุฏุงุฑ **false** ุจุฑูโฺฏุฑุฏุงูุฏ.

ูโุชูุงูุฏ ุงู ุงูฺฏู ุฑุง ุจุง ุงู ุฑูุด ูพุงุฏูโุณุงุฒ ฺฉูุฏ ฺฉู ูุชุฏ **XXX** ุฏุฑ ููุงุช ูุชุฏ **TryXXX** ุฑุง ูุฑุงุฎูุงู ฺฉูุฏ:

```csharp
public return-type XXX(input-type input)
{
    return-type returnValue;
    if (!TryXXX(input, out returnValue))
        throw new YYYException(...);
    return returnValue;
}
```

---

### ุฌุงฺฏุฒูโูุง ุงุณุชุซูุงูุง ๐๏ธ

ููุงููุฏ **int.TryParse**ุ ฺฉ ุชุงุจุน ูโุชูุงูุฏ ุจุง ุจุฑฺฏุฑุฏุงูุฏู ฺฉ ฺฉุฏ ุฎุทุง ุงุฒ ุทุฑู ููุฏุงุฑ ุจุงุฒฺฏุดุช ุง ูพุงุฑุงูุชุฑ ุจู ุชุงุจุน ูุฑุงุฎูุงููุฏูุ ุดฺฉุณุช ุฑุง ุงุทูุงุน ุฏูุฏ. ุงฺฏุฑฺู ุงู ุฑูุด ุจุฑุง ุฎุทุงูุง ุณุงุฏู ู ูุงุจู ูพุดโุจู ฺฉุงุฑุขูุฏ ุงุณุชุ ุงูุง ููฺฏุงู ููุงุฌูู ุจุง ุฎุทุงูุง ุบุฑูุนููู ุง ุบุฑูุงุจู ูพุดโุจู ุฏุณุชโููพุงฺฏุฑ ูโุดูุฏุ ุงูุถุง ูุชุฏูุง ุฑุง ุดููุบ ูโฺฉูุฏ ู ูพฺุฏฺฏโูุง ุบุฑุถุฑูุฑ ุงุฌุงุฏ ูโููุงุฏ.

ููฺูู ุงู ุฑูุด ุจุฑุง ุชูุงุจุน ฺฉู ูุชุฏ ูุณุชูุฏ (ูุงููุฏ ุนููฺฏุฑูุง ูุซู ุนููฺฏุฑ ุชูุณู ุง ูฺฺฏโูุง **Properties**) ูุงุจู ุงุณุชูุงุฏู ูุณุช. ฺฉ ุฌุงฺฏุฒู ุฏฺฏุฑ ูุฑุงุฑ ุฏุงุฏู ุฎุทุง ุฏุฑ ฺฉ ูุญู ูุดุชุฑฺฉ ุงุณุช ฺฉู ุชูุงู ุชูุงุจุน ุฏุฑ ุฒูุฌุฑู ูุฑุงุฎูุงู ุจุชูุงููุฏ ุขู ุฑุง ุจุจููุฏ (ูุซูุงู ฺฉ ูุชุฏ **static** ฺฉู ุฎุทุง ูุนู ุฑุง ุฏุฑ ูุฑ ูุฎ ุฐุฎุฑู ฺฉูุฏ). ุจุง ุงู ุญุงูุ ุงู ุฑูุด ูุงุฒููุฏ ูุดุงุฑฺฉุช ูุฑ ุชุงุจุน ุฏุฑ ุงูฺฏู ุงูุชุดุงุฑ ุฎุทุง ุงุณุช ฺฉู ูู ุฏุณุชโููพุงฺฏุฑ ู ูู ูุณุชุนุฏ ุฎุทุง ุฎูุงูุฏ ุจูุฏ.

---

### ุดูุงุฑุด (Enumeration) ู ูพูุงุดฺฏุฑูุง (Iterators) ๐

#### ุดูุงุฑุด (Enumeration)

**Enumerator (ุดูุงุฑุดโฺฏุฑ)** ฺฉ ูฺฉุงูโููุง (cursor) **ููุท ุฎูุงูุฏู** ู **ููุท ุฑู ุจู ุฌูู** ุฑู ฺฉ ุฏูุจุงูู ุงุฒ ููุงุฏุฑ ุงุณุช. ุฏุฑ ุฒุจุงู #Cุ ฺฉ ููุน (type) ุจูโุนููุงู ุดูุงุฑุดโฺฏุฑ ุดูุงุฎุชู ูโุดูุฏ ุงฺฏุฑ ฺฉ ุงุฒ ุดุฑุงุท ุฒุฑ ุฑุง ุฏุงุดุชู ุจุงุดุฏ:

+ ฺฉ ูุชุฏ ุนููู (public) ุจุฏูู ูพุงุฑุงูุชุฑ ุจู ูุงู `MoveNext` ู ฺฉ ูฺฺฏ (property) ุจู ูุงู `Current` ุฏุงุดุชู ุจุงุดุฏ.
+ ูุงุณุท `System.Collections.Generic.IEnumerator<T>` ุฑุง ูพุงุฏูโุณุงุฒ ฺฉูุฏ.
+ ูุงุณุท `System.Collections.IEnumerator` ุฑุง ูพุงุฏูโุณุงุฒ ฺฉูุฏ.

**ุนุจุงุฑุช foreach** ุฑู ฺฉ **Enumerable object (ุดุก ุดูุงุฑุดโูพุฐุฑ)** ูพูุงุด ูโฺฉูุฏ.
ฺฉ **Enumerable object** ููุงุด ููุทู ฺฉ ุฏูุจุงูู ุงุณุช. ุงู ุดุก ุฎูุฏุด ูฺฉุงูโููุง ูุณุชุ ุจูฺฉู **ูฺฉุงูโููุง ุชููุฏ ูโฺฉูุฏ**. ุฏุฑ #Cุ ฺฉ ููุน ุจูโุนููุงู ุดูุงุฑุดโูพุฐุฑ ุดูุงุฎุชู ูโุดูุฏ ุงฺฏุฑ ฺฉ ุงุฒ ุดุฑุงุท ุฒุฑ ุฑุง ุฏุงุดุชู ุจุงุดุฏ (ุจุฑุฑุณโูุง ุจู ููู ุชุฑุชุจ ุงูุฌุงู ูโุดูุฏ):

+ ฺฉ ูุชุฏ ุนููู ุจุฏูู ูพุงุฑุงูุชุฑ ุจู ูุงู `GetEnumerator` ุฏุงุดุชู ุจุงุดุฏ ฺฉู ฺฉ ุดูุงุฑุดโฺฏุฑ ุจุฑฺฏุฑุฏุงูุฏ.
+ ูุงุณุท `System.Collections.Generic.IEnumerable<T>` ุฑุง ูพุงุฏูโุณุงุฒ ฺฉูุฏ.
+ ูุงุณุท `System.Collections.IEnumerable` ุฑุง ูพุงุฏูโุณุงุฒ ฺฉูุฏ.
+ (ุงุฒ #C ูุณุฎู 9 ุจู ุจุนุฏ) ุจุชูุงูุฏ ุจู ฺฉ ูุชุฏ ุชูุณุนูโุง (extension method) ุจู ูุงู `GetEnumerator` ฺฉู ฺฉ ุดูุงุฑุดโฺฏุฑ ุจุฑูโฺฏุฑุฏุงูุฏุ ูุชุตู ุดูุฏ (ุจุฎุด **"Extension Methods"** ุฏุฑ ุตูุญู 217 ุฑุง ุจุจูุฏ).

**ุงูฺฏู ุดูุงุฑุด** ุจู ุดฺฉู ุฒุฑ ุงุณุช:

```csharp
class Enumerator   // ูุนูููุงู ูุงุณุท IEnumerator ุง IEnumerator<T> ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉูุฏ
{
  public IteratorVariableType Current { get {...} }
  public bool MoveNext() {...}
}

class Enumerable   // ูุนูููุงู ูุงุณุท IEnumerable ุง IEnumerable<T> ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉูุฏ
{
  public Enumerator GetEnumerator() {...}
}
```

**ููููู ูพูุงุด ุณุทุญ ุจุงูุง** ุฑู ฺฉุงุฑุงฺฉุชุฑูุง ฺฉููู `"beer"` ุจุง ุงุณุชูุงุฏู ุงุฒ `foreach`:

```csharp
foreach (char c in "beer")
  Console.WriteLine(c);
```

**ููููู ูพูุงุด ุณุทุญ ูพุงู** ุฑู ฺฉุงุฑุงฺฉุชุฑูุง `"beer"` ุจุฏูู ุงุณุชูุงุฏู ุงุฒ `foreach`:

```csharp
using (var enumerator = "beer".GetEnumerator())
  while (enumerator.MoveNext())
  {
    var element = enumerator.Current;
    Console.WriteLine(element);
  }
```

> ุงฺฏุฑ ุดูุงุฑุดโฺฏุฑ ูุงุณุท `IDisposable` ุฑุง ูพุงุฏูโุณุงุฒ ฺฉูุฏุ ุนุจุงุฑุช `foreach` ูุงููุฏ ฺฉ ุนุจุงุฑุช `using` ุนูู ฺฉุฑุฏู ู **ุจูโุทูุฑ ุถูู** ุดุก ุดูุงุฑุดโฺฏุฑ ุฑุง ุขุฒุงุฏ (dispose) ูโฺฉูุฏ.

ุฌุฒุฆุงุช ุจุดุชุฑ ุฏุฑ ููุฑุฏ ูุงุณุทโูุง ุดูุงุฑุด ุฏุฑ **ูุตู 7** ุชูุถุญ ุฏุงุฏู ุดุฏู ุงุณุช.

---

#### ููุฏุงุฑุฏู ุงููู ูุฌููุนูโูุง (Collection Initializers) ู ุนุจุงุฑุงุช ูุฌููุนูโุง (Collection Expressions) ๐

ุดูุง ูโุชูุงูุฏ ุฏุฑ ฺฉ ูุฑุญููุ ฺฉ ุดุก ุดูุงุฑุดโูพุฐุฑ ุฑุง ุงุฌุงุฏ ู ููุฏุงุฑุฏู ฺฉูุฏ:

```csharp
using System.Collections.Generic;
var list = new List<int> { 1, 2, 3 };
```

ุงุฒ ูุณุฎู #C 12 ุจู ุจุนุฏุ ูโุชูุงูุฏ ุงู ฺฉุงุฑ ุฑุง ฺฉูุชุงูโุชุฑ ุงูุฌุงู ุฏูุฏ (ุจุง ุงุณุชูุงุฏู ุงุฒ **ุจุฑุงฺฉุชโูุง**):

```csharp
using System.Collections.Generic;
List<int> list = [1, 2, 3];
```

**ุนุจุงุฑุงุช ูุฌููุนูโุง** **ูุฏูโููุน (target-typed)** ูุณุชูุฏุ ุนู ููุน `[1, 2, 3]` ุจู ููุน ูุชุบุฑ ฺฉู ุจู ุขู ุงูุชุณุงุจ ุฏุงุฏู ูโุดูุฏ ุจุณุชฺฏ ุฏุงุฑุฏ. ูุซุงู:

```csharp
int[] array = [1, 2, 3];
Span<int> span = [1, 2, 3];
```

ุญุช ูโุชูุงูุฏ ููฺฏุงู ูุฑุงุฎูุงู ูุชุฏูุง ูู ููุน ุฑุง ุญุฐู ฺฉูุฏ ุงฺฏุฑ ฺฉุงููพุงูุฑ ุจุชูุงูุฏ ุขู ุฑุง ุงุณุชูุจุงุท ฺฉูุฏ:

```csharp
Foo([1, 2, 3]);

void Foo(List<int> numbers) { ... }
```

ฺฉุงููพุงูุฑ ุงู ฺฉุฏ ุฑุง ุจู ุงู ุดฺฉู ุชุฑุฌูู ูโฺฉูุฏ:

```csharp
using System.Collections.Generic;
List<int> list = new List<int>();
list.Add(1);
list.Add(2);
list.Add(3);
```

ุงู ููุถูุน ูุงุฒููุฏ ุงู ุงุณุช ฺฉู ุดุก ุดูุงุฑุดโูพุฐุฑ ูุงุณุท `System.Collections.IEnumerable` ุฑุง ูพุงุฏูโุณุงุฒ ฺฉูุฏ ู ฺฉ ูุชุฏ `Add` ุจุง ุชุนุฏุงุฏ ูพุงุฑุงูุชุฑ ููุงุณุจ ุฏุงุดุชู ุจุงุดุฏ. (ุฏุฑ ุนุจุงุฑุงุช ูุฌููุนูโุงุ ฺฉุงููพุงูุฑ ุงุฒ ุงูฺฏููุง ุฏฺฏุฑ ูู ุจุฑุง ุงุฌุงุฏ ูุฌููุนูโูุง ููุท ุฎูุงูุฏู ูพุดุชุจุงู ูโฺฉูุฏ.)

ููฺูู ูโุชูุงูุฏ ุฏฺฉุดูุฑโูุง ุฑุง ูู ุจู ููู ุดฺฉู ููุฏุงุฑุฏู ฺฉูุฏ (ุจุฎุด **"Dictionaries"** ุฏุฑ ุตูุญู 394 ุฑุง ุจุจูุฏ):

```csharp
var dict = new Dictionary<int, string>()
{
  { 5, "five" },
  { 10, "ten" }
};
```

ุง ุจู ุดฺฉู ฺฉูุชุงูโุชุฑ:

```csharp
var dict = new Dictionary<int, string>()
{
  [3] = "three",
  [10] = "ten"
};
```

ุงู ุฑูุด ูู ุชููุง ุจุฑุง ุฏฺฉุดูุฑโูุงุ ุจูฺฉู ุจุฑุง ูุฑ ููุน ฺฉู **Indexer** ุฏุงุดุชู ุจุงุดุฏุ ูุนุชุจุฑ ุงุณุช.

---

#### ูพูุงุดฺฏุฑูุง (Iterators) โ๏ธ

ุฏุฑ ุญุงู ฺฉู ุนุจุงุฑุช `foreach` **ูุตุฑูโฺฉููุฏู** ฺฉ ุดูุงุฑุดโฺฏุฑ ุงุณุชุ **Iterator (ูพูุงุดฺฏุฑ)** **ุชููุฏฺฉููุฏู** ฺฉ ุดูุงุฑุดโฺฏุฑ ุงุณุช.
ูุซุงู ุฒุฑ ฺฉ ูพูุงุดฺฏุฑ ุงุณุช ฺฉู ฺฉ ุฏูุจุงูู ุงุฒ ุงุนุฏุงุฏ ูุจููุงฺ ุฑุง ุชููุฏ ูโฺฉูุฏ (ูุฑ ุนุฏุฏ ุญุงุตู ุฌูุน ุฏู ุนุฏุฏ ูุจู ุงุณุช):

```csharp
using System;
using System.Collections.Generic;
foreach (int fib in Fibs(6))
  Console.Write(fib + "  ");

IEnumerable<int> Fibs(int fibCount)
{
  for (int i = 0, prevFib = 1, curFib = 1; i < fibCount; i++)
  {
    yield return prevFib;
    int newFib = prevFib + curFib;
    prevFib = curFib;
    curFib = newFib;
  }
}
```

**ุฎุฑูุฌ:**

```
1  1  2  3  5  8
```

ุฏุฑ ุญุงู ฺฉู ุฏุณุชูุฑ `return` ูโฺฏูุฏ: **"ุงู ููุฏุงุฑ ุงุณุช ฺฉู ุงุฒ ุงู ูุชุฏ ุฎูุงุณุชู ุจูุฏ"**ุ ุฏุณุชูุฑ `yield return` ูโฺฏูุฏ: **"ุงู ุนูุตุฑ ุจุนุฏ ุงุณุช ฺฉู ุงุฒ ุงู ุดูุงุฑุดโฺฏุฑ ุฎูุงุณุชู ุจูุฏ"**.
ุฏุฑ ูุฑ ุฏุณุชูุฑ `yield`ุ ฺฉูุชุฑู ุจู ูุฑุงุฎูุงููุฏู ุจุฑูโฺฏุฑุฏุฏุ ุงูุง **ูุถุนุช ูุชุฏ ุญูุธ ูโุดูุฏ** ุชุง ููุช ูุฑุงุฎูุงููุฏู ุนูุตุฑ ุจุนุฏ ุฑุง ุฏุฑุฎูุงุณุช ฺฉุฑุฏุ ูุชุฏ ุงุฒ ููุงูโุฌุง ุงุฏุงูู ุงุจุฏ. ุงู ูุถุนุช ุจู ุนูุฑ ุดูุงุฑุดโฺฏุฑ ูุงุจุณุชู ุงุณุช ู ุจุนุฏ ุงุฒ ุงุชูุงู ูพูุงุด ุขุฒุงุฏ ูโุดูุฏ.

ฺฉุงููพุงูุฑ ูุชุฏูุง ูพูุงุดฺฏุฑ ุฑุง ุจู ฺฉูุงุณโูุง ุฎุตูุต ุชุจุฏู ูโฺฉูุฏ ฺฉู ูุงุณุทโูุง `IEnumerable<T>` ู/ุง `IEnumerator<T>` ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉููุฏ.
ููุทู ููุฌูุฏ ุฏุฑ ุจููฺฉ ูพูุงุดฺฏุฑ ุฏุฑ ูุชุฏ `MoveNext` ู ูฺฺฏ `Current` ฺฉูุงุณ ุชููุฏุดุฏู ุชูุณุท ฺฉุงููพุงูุฑ ูุฑุงุฑ ุฏุงุฏู ูโุดูุฏ. **ุงู ุนู ููุช ูุชุฏ ูพูุงุดฺฏุฑ ุฑุง ุตุฏุง ูโุฒูุฏุ ูฺ ฺฉุฏ ุงุฌุฑุง ููโุดูุฏุ ุชููุง ฺฉ ููููู ุงุฒ ฺฉูุงุณ ุณุงุฎุชู ูโุดูุฏ!**
ฺฉุฏ ุดูุง ุชููุง ููุช ุงุฌุฑุง ูโุดูุฏ ฺฉู ูพูุงุด ุดุฑูุน ุดูุฏุ ูุนูููุงู ุจุง ฺฉ ุนุจุงุฑุช `foreach`.

> ูพูุงุดฺฏุฑูุง ูโุชูุงููุฏ ูุชุฏูุง ูุญู (local methods) ูู ุจุงุดูุฏ (ุจุฎุด **"Local methods"** ุฏุฑ ุตูุญู 106 ุฑุง ุจุจูุฏ).

---

### ูุนูุง **Iterator** (ุชฺฉุฑุงุฑฺฉููุฏู) ๐

ฺฉ **Iterator** ุง ยซุชฺฉุฑุงุฑฺฉููุฏูยป ูุชุฏุ ูฺฺฏ (Property) ุง ุงูุฏฺฉุณุฑ ุงุณุช ฺฉู ุดุงูู ฺฉ ุง ฺูุฏ ุฏุณุชูุฑ `yield` ุงุณุช. ฺฉ **Iterator** ุจุงุฏ ฺฉ ุงุฒ ฺูุงุฑ ุฑุงุจุท (Interface) ุฒุฑ ุฑุง ุจุฑฺฏุฑุฏุงูุฏุ ุฏุฑ ุบุฑ ุงู ุตูุฑุช ฺฉุงููพุงูุฑ ุฎุทุง ุชููุฏ ูโฺฉูุฏ:

```csharp
// ุฑุงุจุทโูุง Enumerable
System.Collections.IEnumerable
System.Collections.Generic.IEnumerable<T>

// ุฑุงุจุทโูุง Enumerator
System.Collections.IEnumerator
System.Collections.Generic.IEnumerator<T>
```

**Iterator** ุจุณุชู ุจู ุงูฺฉู ฺฉ ุฑุงุจุท **Enumerable** ุง **Enumerator** ุจุฑูโฺฏุฑุฏุงูุฏุ ุฑูุชุงุฑ ูุชูุงูุช ุฏุงุฑุฏ. ุชูุถุญ ฺฉุงูู ุงู ููุถูุน ุฏุฑ ูุตู ท ุขูุฏู ุงุณุช.

---

### ุงุณุชูุงุฏู ุงุฒ ฺูุฏู ุฏุณุชูุฑ `yield`

ุฏุฑ ฺฉ **Iterator** ูโุชูุงู ฺูุฏู ุฏุณุชูุฑ `yield` ุงุณุชูุงุฏู ฺฉุฑุฏ:

```csharp
foreach (string s in Foo())
    Console.WriteLine(s); // ฺุงูพ ูโฺฉูุฏ: "One", "Two", "Three"

IEnumerable<string> Foo()
{
    yield return "One";
    yield return "Two";
    yield return "Three";
}
```

---

### ุงุณุชูุงุฏู ุงุฒ `yield break`

ุฏุฑ ฺฉ ุจููฺฉ **Iterator** ุงุณุชูุงุฏู ุงุฒ ุฏุณุชูุฑ `return` ูุฌุงุฒ ูุณุช. ุจุฑุง ุฎุฑูุฌ ุฒูุฏููฺฏุงู ุงุฒ **Iterator** (ุจุฏูู ุจุฑฺฏุฑุฏุงูุฏู ุนูุงุตุฑ ุจุดุชุฑ) ุจุงุฏ ุงุฒ `yield break` ุงุณุชูุงุฏู ฺฉูุฏ:

```csharp
IEnumerable<string> Foo(bool breakEarly)
{
    yield return "One";
    yield return "Two";
    if (breakEarly)
        yield break;
    yield return "Three";
}
```

---

### **Iteratorูุง** ู ุจููฺฉโูุง **try/catch/finally** โ๏ธ

+ ุงุณุชูุงุฏู ุงุฒ `yield return` ุฏุฑ ฺฉ ุจููฺฉ `try` ฺฉู ุดุงูู ุจุฎุด `catch` ุจุงุดุฏุ **ูุฌุงุฒ ูุณุช**:

```csharp
IEnumerable<string> Foo()
{
    try { yield return "One"; } // ุบุฑูุฌุงุฒ
    catch { ... }
}
```

+ ููฺูู ุงุณุชูุงุฏู ุงุฒ `yield return` ุฏุฑ ุจุฎุดโูุง `catch` ุง `finally` ูุฒ ูุฌุงุฒ ูุณุช.
  ุฏูู ุงู ูุญุฏูุฏุชโูุง ุงู ุงุณุช ฺฉู ฺฉุงููพุงูุฑ ุจุงุฏ **Iteratorูุง** ุฑุง ุจู ฺฉูุงุณโูุง ูุนููู ุจุง ูุชุฏูุง `MoveNext`ุ `Current` ู `Dispose` ุชุจุฏู ฺฉูุฏ ู ูุฏุฑุช ุจูุงฺฉโูุง ุฎุทุง ูพฺุฏฺฏ ุฒุงุฏ ุงุฌุงุฏ ูโฺฉูุฏ.

+ ุงูุง ูโุชูุงูุฏ ุฏุฑ ุจููฺฉ `try` ฺฉู **ููุท** ุดุงูู ฺฉ ุจุฎุด `finally` ุงุณุช ุงุฒ `yield return` ุงุณุชูุงุฏู ฺฉูุฏ:

```csharp
IEnumerable<string> Foo()
{
    try { yield return "One"; } // ูุฌุงุฒ
    finally { ... }
}
```

ฺฉุฏ ููุฌูุฏ ุฏุฑ ุจููฺฉ `finally` ุฒูุงู ุงุฌุฑุง ูโุดูุฏ ฺฉู ุดูุงุฑูุฏู (**Enumerator**) ูุตุฑูโฺฉููุฏู ุจู ุงูุชูุง ุชูุงู ุจุฑุณุฏ ุง ุงุฒ ุจู ุจุฑูุฏ. ุฏุณุชูุฑ `foreach` ุจูโุตูุฑุช ุถูู ุดูุงุฑูุฏู ุฑุง Dispose ูโฺฉูุฏ ุงฺฏุฑ ุฒูุฏุชุฑ ุงุฒ ุญููู ุฎุงุฑุฌ ุดูุฏุ ุจูุงุจุฑุงู ุงู ุฑูุด ุงูู ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ุดูุงุฑูุฏูโูุงุณุช.

---

### ุงุญุชุงุท ููฺฏุงู ุงุณุชูุงุฏู ุงุฒ **Enumeratorูุง** ุจูโุตูุฑุช ุฏุณุช ๐

ุงฺฏุฑ ุดูุงุฑูุฏู ุฑุง ุจูโุตูุฑุช ุฏุณุช ุงุณุชูุงุฏู ูโฺฉูุฏ ู ูุจู ุงุฒ ูพุงุงู ฺฉุงุฑ ุขู ุฑุง ุฑูุง ฺฉูุฏ ุจุฏูู ุงูฺฉู Dispose ฺฉูุฏุ ุจููฺฉ `finally` ุงุฌุฑุง ููโุดูุฏ. ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุงู ูุดฺฉูุ ุดูุงุฑูุฏูโูุง ุฑุง ุฏุฑูู ฺฉ ุฏุณุชูุฑ `using` ูุฑุงุฑ ุฏูุฏ:

```csharp
string firstElement = null;
var sequence = Foo();
using (var enumerator = sequence.GetEnumerator())
    if (enumerator.MoveNext())
        firstElement = enumerator.Current;
```

---

### ุชุฑฺฉุจ ุชูุงูโูุง (Composing Sequences) ๐งฉ

**Iteratorูุง** ูุงุจูุช ุชุฑฺฉุจ ุจุงูุง ุฏุงุฑูุฏ. ูุซุงู ุฒุฑ ุชููุง ุงุนุฏุงุฏ **ูุจููุงฺ ุฒูุฌ** ุฑุง ุชููุฏ ูโฺฉูุฏ:

```csharp
using System;
using System.Collections.Generic;

foreach (int fib in EvenNumbersOnly(Fibs(6)))
    Console.WriteLine(fib);

IEnumerable<int> Fibs(int fibCount)
{
    for (int i = 0, prevFib = 1, curFib = 1; i < fibCount; i++)
    {
        yield return prevFib;
        int newFib = prevFib + curFib;
        prevFib = curFib;
        curFib = newFib;
    }
}

IEnumerable<int> EvenNumbersOnly(IEnumerable<int> sequence)
{
    foreach (int x in sequence)
        if ((x % 2) == 0)
            yield return x;
}
```

ูฺฉุชู ููู ุงู ุงุณุช ฺฉู **ูุฑ ุนูุตุฑ ุฏููุงู ุฒูุงู ูุญุงุณุจู ูโุดูุฏ ฺฉู ุฏุฑุฎูุงุณุช ุดูุฏ**ุ ุนู ููุท ููฺฏุงู ูุฑุงุฎูุงู ูุชุฏ `MoveNext()` ููุฏุงุฑ ุฌุฏุฏ ุชููุฏ ูโุดูุฏ. (ุดฺฉู ด-ฑ ูุฑุขูุฏ ุฏุฑุฎูุงุณุช ู ุฎุฑูุฌ ุฏุงุฏูโูุง ุฑุง ุฏุฑ ุทูู ุฒูุงู ูุดุงู ูโุฏูุฏ.)

<div align="center">

![Conventions-UsedThis-Book](../../../assets/image/04/Table-4-1.jpeg)
</div>

### ุชุฑฺฉุจโูพุฐุฑ ุงูฺฏู Iterator ุฏุฑ LINQ ู ุงููุงุน ููุฏุงุฑ ุชู (Nullable Value Types) โจ

ุชุฑฺฉุจโูพุฐุฑ ุง **Composability** ุฏุฑ ุงูฺฏู **Iterator** (ุชฺฉุฑุงุฑฺฉููุฏู) ุจุณุงุฑ ููุฏ ู ฺฉุงุฑุจุฑุฏ ุงุณุชุ ูุฎุตูุตุงู ุฏุฑ **LINQ**. ูุง ุงู ููุถูุน ุฑุง ุฏูุจุงุฑู ุฏุฑ ูุตู ธ ุจูโุทูุฑ ฺฉุงูู ุจุฑุฑุณ ุฎูุงูู ฺฉุฑุฏ.

---

## ุงููุงุน ููุฏุงุฑ ุชู (Nullable Value Types) ๐

ุฏุฑ ุฒุจุงู C#ุ **Reference Types** (ุงููุงุน ูุฑุฌุน) ูโุชูุงููุฏ ูุดุงูโุฏููุฏู ฺฉ ููุฏุงุฑ ููุฌูุฏ ูุจุงุดูุฏุ ุนู ููุฏุงุฑ ุขูโูุง ูโุชูุงูุฏ `null` ุจุงุดุฏ:

```csharp
string s = null;   // ูุดฺฉู ูุฏุงุฑุฏุ ููุน ูุฑุฌุน
```

ุงูุง **Value Types** (ุงููุงุน ููุฏุงุฑ) ุจูโุตูุฑุช ุนุงุฏ ููโุชูุงููุฏ `null` ุจุงุดูุฏ ู ุงฺฏุฑ ุชูุงุด ฺฉูุฏุ ุฎุทุง ฺฉุงููพุงู ุฏุฑุงูุช ูโฺฉูุฏ:

```csharp
int i = null;   // ุฎุทุง ฺฉุงููพุงูุ ููุน ููุฏุงุฑ ููโุชูุงูุฏ null ุจุงุดุฏ
```

ุจุฑุง ุงูโฺฉู ฺฉ **Value Type** ูุงุจูุช ุฏุงุดุชู ููุฏุงุฑ ุชู ุฑุง ุฏุงุดุชู ุจุงุดุฏุ ุจุงุฏ ุงุฒ ฺฉ ุณุงุฎุชุงุฑ ุฎุงุต ุจู ูุงู **Nullable Type** ุงุณุชูุงุฏู ฺฉูุฏ. ุจุฑุง ุชุนุฑู ฺฉ ููุน Nullable ฺฉุงู ุงุณุช ุจุนุฏ ุงุฒ ููุน ุฏุงุฏู ุงุฒ ุนูุงูุช `?` ุงุณุชูุงุฏู ฺฉูุฏ:

```csharp
int? i = null;                  // ุตุญุญุ ููุน Nullable
Console.WriteLine(i == null);   // ุฎุฑูุฌ True
```

---

## ุณุงุฎุชุงุฑ Nullable<T> ๐

ุฏุฑ ูุงูุน `T?` ูุนุงุฏู `System.Nullable<T>` ุงุณุช. ุงู ฺฉ **Struct** ุณุจฺฉ ู ุชุบุฑูุงูพุฐุฑ (**Immutable**) ุงุณุช ฺฉู ููุท ุดุงูู ุฏู ููุฏ ุงุณุช:

+ **Value**: ููุฏุงุฑ ุฐุฎุฑู ุดุฏู
+ **HasValue**: ูุดุงู ูโุฏูุฏ ฺฉู ุขุง ููุฏุงุฑ ููุฌูุฏ ุงุณุช ุง ุฎุฑ

ุชุนุฑู ุณุงุฏู ุขู ุจู ุดฺฉู ุฒุฑ ุงุณุช:

```csharp
public struct Nullable<T> where T : struct
{
    public T Value { get; }
    public bool HasValue { get; }
    public T GetValueOrDefault();
    public T GetValueOrDefault(T defaultValue);
    ...
}
```

ููููู ฺฉุฏ:

```csharp
int? i = null;
Console.WriteLine(i == null);  // True
```

ุงู ฺฉุฏ ุฏุฑ ูพุดุช ุตุญูู ุจู ุดฺฉู ุฒุฑ ุชุฑุฌูู ูโุดูุฏ:

```csharp
Nullable<int> i = new Nullable<int>();
Console.WriteLine(!i.HasValue);   // True
```

> ุชูุฌู: ุงฺฏุฑ ููุฏุงุฑ **HasValue** ุจุฑุงุจุฑ **false** ุจุงุดุฏ ู ุดูุง ุจุฎูุงูุฏ **Value** ุฑุง ุจุฎูุงูุฏุ ฺฉ **InvalidOperationException** ุฑุฎ ูโุฏูุฏ.
> ูุชุฏ **GetValueOrDefault()** ุฏุฑ ุตูุฑุช ฺฉู **HasValue = true** ุจุงุดุฏ ููุฏุงุฑ **Value** ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏุ ูฺฏุฑูู ููุฏุงุฑ ูพุดโูุฑุถ ุง ููุฏุงุฑ ฺฉู ุดูุง ูุดุฎุต ฺฉุฑุฏูโุงุฏ ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ.

**ูฺฉุชู ููู**: ููุฏุงุฑ ูพุดโูุฑุถ ุจุฑุง ูุฑ **T?** ุจุฑุงุจุฑ `null` ุงุณุช.

---

## ุชุจุฏูโูุง ุถูู ู ุตุฑุญ (Implicit ู Explicit Conversions) ๐

ุชุจุฏู ฺฉ ููุฏุงุฑ `T` ุจู `T?` **ุถูู** ุงุณุช (ุงุญุชุงุฌ ุจู ุนูู ุฎุงุต ูุฏุงุฑุฏ).
ุงูุง ุชุจุฏู ุงุฒ `T?` ุจู `T` **ุตุฑุญ** ุงุณุช ู ูุงุฒ ุจู **Cast** ุฏุงุฑุฏ:

```csharp
int? x = 5;         // ุชุจุฏู ุถูู
int y = (int)x;     // ุชุจุฏู ุตุฑุญ
```

ุฏุฑ ูุงูุนุ ุชุจุฏู ุตุฑุญ ุฏููุงู ูุนุงุฏู ุฏุณุชุฑุณ ุจู ูฺฺฏ **Value** ุงุณุช.
ุจูุงุจุฑุงูุ ุงฺฏุฑ **HasValue = false** ุจุงุดุฏ ู ุดูุง ุจุฎูุงูุฏ Cast ฺฉูุฏุ ุงุณุชุซูุง **InvalidOperationException** ุงุฌุงุฏ ูโุดูุฏ.

---

## Boxing ู Unboxing ุฏุฑ Nullable Types ๐

ููฺฏุงู ฺฉู ฺฉ **T?** ุฌุนุจูโุจูุฏ (**Box**) ูโุดูุฏุ ููุฏุงุฑ ุฐุฎุฑูโุดุฏู ุฏุฑ **Heap** ููุท **T** ุงุณุชุ ูู **T?**. ุงู ุจูููโุณุงุฒ ููฺฉู ุงุณุช ุฒุฑุง **Reference Types** ูโุชูุงููุฏ ุจูโุทูุฑ ุทุจุน `null` ุฑุง ููุงุด ุฏููุฏ.

ููฺูู ูโุชูุงูุฏ **Unboxing** ุง ุฎุงุฑุฌ ฺฉุฑุฏู ุงุฒ ุฌุนุจู ุฑุง ุจุง ุนููฺฏุฑ `as` ุงูุฌุงู ุฏูุฏ. ุงฺฏุฑ ุนููุงุช ูุงูููู ุจุงุดุฏุ ูุชุฌู `null` ุฎูุงูุฏ ุจูุฏ:

```csharp
object o = "string";
int? x = o as int?;
Console.WriteLine(x.HasValue);   // False
```

### ุนููฺฏุฑูุง ุงุฑุชูุง (Operator Lifting) ๐๏ธ

ุณุงุฎุชุงุฑ **Nullable<T>** ุนููฺฏุฑูุง ูุซู `<`ุ `>` ุง ุญุช `==` ุฑุง ุชุนุฑู ููโฺฉูุฏ. ุจุง ุงู ุญุงูุ ฺฉุฏ ุฒุฑ ุจุฏูู ูฺ ูุดฺฉู ฺฉุงููพุงู ู ุงุฌุฑุง ูโุดูุฏ:

```csharp
int? x = 5;
int? y = 10;
bool b = x < y;      // true
```

ุงู ููุถูุน ุจู ุงู ุฏูู ุงุณุช ฺฉู ฺฉุงููพุงูุฑ ุนููฺฏุฑ **ฺฉูุชุฑ ุงุฒ** ุฑุง ุงุฒ ููุน ูพุงู (ุฏุฑ ุงูุฌุง `int`) ูุฑุถ ฺฏุฑูุชู ุง ุจู ุงุตุทูุงุญ **ุงุฑุชูุง ุฏุงุฏู** ุงุณุช. ุงุฒ ูุธุฑ ูููููุ ุนุจุงุฑุช ููุงุณู ุจุงูุง ุจู ุดฺฉู ุฒุฑ ุชุฑุฌูู ูโุดูุฏ:

```csharp
bool b = (x.HasValue && y.HasValue) ? (x.Value < y.Value) : false;
```

ุจู ุนุจุงุฑุช ุฏฺฏุฑุ ุงฺฏุฑ ูุฑ ุฏู ูุชุบุฑ `x` ู `y` ููุฏุงุฑ ุฏุงุดุชู ุจุงุดูุฏุ ููุงุณู ุจุง ุงุณุชูุงุฏู ุงุฒ ุนููฺฏุฑ ฺฉูุชุฑ ุงุฒ ููุน `int` ุงูุฌุงู ูโุดูุฏุ ุฏุฑ ุบุฑ ุงู ุตูุฑุชุ ูุชุฌู `false` ุฎูุงูุฏ ุจูุฏ.

ุงุฑุชูุง ุนููฺฏุฑ ุจู ุงู ูุนูุงุณุช ฺฉู ุดูุง ูโุชูุงูุฏ ุจู ุทูุฑ ุถูู ุงุฒ ุนููฺฏุฑูุง ููุน `T` ุฑู ููุน `T?` ุงุณุชูุงุฏู ฺฉูุฏ. ููฺูู ูโุชูุงูุฏ ุนููฺฏุฑูุง ูุฎุตูุต ุจู `T?` ุชุนุฑู ฺฉูุฏ ุชุง ุฑูุชุงุฑ ุฎุงุต ุฏุฑ ุจุฑุงุจุฑ ููุงุฏุฑ `null` ุฏุงุดุชู ุจุงุดูุฏุ ุงูุง ุฏุฑ ุจุดุชุฑ ููุงูุน ุจูุชุฑ ุงุณุช ุจู ฺฉุงููพุงูุฑ ุงุนุชูุงุฏ ฺฉูุฏ ุชุง ุจู ุทูุฑ ุฎูุฏฺฉุงุฑ ููุทู ูุฑุจูุท ุจู `nullable` ุฑุง ูพุงุฏูโุณุงุฒ ฺฉูุฏ. ฺูุฏ ูุซุงู:

```csharp
int? x = 5;
int? y = null;

// ูุซุงูโูุง ุนููฺฏุฑ ุจุฑุงุจุฑ
Console.WriteLine (x == y);    // False
Console.WriteLine (x == null); // False
Console.WriteLine (x == 5);    // True
Console.WriteLine (y == null); // True
Console.WriteLine (y == 5);    // False
Console.WriteLine (y != 5);    // True

// ูุซุงูโูุง ุนููฺฏุฑ ููุงุณูโุง
Console.WriteLine (x < 6);     // True
Console.WriteLine (y < 6);     // False
Console.WriteLine (y > 6);     // False

// ูุซุงูโูุง ุณุงุฑ ุนููฺฏุฑูุง
Console.WriteLine (x + 5);     // 10
Console.WriteLine (x + y);     // null (ุฎุท ุฎุงู ฺุงูพ ูโุดูุฏ)
```

---

### ุฑูุชุงุฑ ุนููฺฏุฑูุง ุจุง ููุงุฏุฑ `null` ุฏุฑ Nullable ๐งฉ

ฺฉุงููพุงูุฑ ุจุณุชู ุจู ููุน ุนููฺฏุฑุ ููุทู ูุชูุงูุช ุจุฑุง ุจุฑุฎูุฑุฏ ุจุง ููุงุฏุฑ `null` ุฏุฑ ูุธุฑ ูโฺฏุฑุฏ. ุฏุฑ ุงุฏุงููุ ููุงูู ูุฑุจูุท ุจู ูุฑ ุฏุณุชู ุงุฒ ุนููฺฏุฑูุง ุชูุถุญ ุฏุงุฏู ุดุฏู ุงุณุช.

#### 1. ุนููฺฏุฑูุง ุจุฑุงุจุฑ (`==` ู `!=`)

ุงู ุนููฺฏุฑูุง ุฏููุงู ูุดุงุจู ููุนโูุง **Reference** ุจุง ููุงุฏุฑ `null` ุฑูุชุงุฑ ูโฺฉููุฏ:

+ ุฏู ููุฏุงุฑ `null` ุจุฑุงุจุฑ ูุณุชูุฏ:

```csharp
Console.WriteLine (null == null);                       // True
Console.WriteLine ((bool?)null == (bool?)null);         // True
```

+ ุงฺฏุฑ ููุท ฺฉ ุงุฒ ุนููููุฏูุง `null` ุจุงุดุฏุ ุจุฑุงุจุฑ ูุณุชูุฏ.
+ ุงฺฏุฑ ูุฑ ุฏู ููุฏุงุฑ ุฏุงุดุชู ุจุงุดูุฏุ ููุงุฏุฑ ุขูโูุง ููุงุณู ูโุดูุฏ.

---

#### 2. ุนููฺฏุฑูุง ููุงุณูโุง (`<`, `<=`, `>=`, `>`)

ููุงุณู ููุงุฏุฑ `null` ุจโูุนูุง ุงุณุชุ ุจูุงุจุฑุงู ููุงุณู ูุฑ ููุฏุงุฑ `null` ุจุง `null` ุง ููุฏุงุฑ ุบุฑ `null` ูุชุฌู **false** ุฎูุงูุฏ ุจูุฏ:

```csharp
bool b = x < y;    // ุชุฑุฌูู ุดุฏู:
bool b = (x.HasValue && y.HasValue) 
         ? (x.Value < y.Value)
         : false;
// b ุจุฑุงุจุฑ false ุงุณุช (ุจุง ูุฑุถ x=5 ู y=null)
```

---

#### 3. ุณุงุฑ ุนููฺฏุฑูุง (`+`, `-`, `*`, `/`, `%`, `&`, `|`, `^`, `<<`, `>>`, `+`, `++`, `--`, `!`, `~`)

ูุฑฺฏุงู ฺฉ ุงุฒ ุนููููุฏูุง `null` ุจุงุดุฏุ ูุชุฌู ูุฒ `null` ุฎูุงูุฏ ุจูุฏ. ุงู ุงูฺฏู ุจุฑุง ฺฉุงุฑุจุฑุงู SQL ุขุดูุงุณุช:

```csharp
int? c = x + y;   // ุชุฑุฌูู ุดุฏู:
int? c = (x.HasValue && y.HasValue)
         ? (int?) (x.Value + y.Value) 
         : null;
// c ุจุฑุงุจุฑ null ุงุณุช (ุจุง ูุฑุถ x=5 ู y=null)
```

ุชููุง ุงุณุชุซูุง ุฒูุงู ุงุณุช ฺฉู ุนููฺฏุฑูุง `&` ู `|` ุฑู ููุน `bool?` ุงุนูุงู ุดููุฏ ฺฉู ุจูโุฒูุฏ ุชูุถุญ ุฏุงุฏู ูโุดูุฏ.

---

### ุชุฑฺฉุจ ุงููุงุน Nullable ู Non-Nullable ๐งฎ

ุดูุง ูโุชูุงูุฏ ุงููุงุน `nullable` ู `non-nullable` ุฑุง ุจุง ูู ุชุฑฺฉุจ ฺฉูุฏุ ฺูู ุชุจุฏู ุถูู ุงุฒ `T` ุจู `T?` ูุฌูุฏ ุฏุงุฑุฏ:

```csharp
int? a = null;
int b = 2;
int? c = a + b;   // c ุจุฑุงุจุฑ null ุงุณุช - ูุนุงุฏู a + (int?)b
```

---

### ููุนโูุง Nullable ู ุนููฺฏุฑูุง `&` ู `|` ุจุฑุง `bool?` ๐น

ููฺฏุงู ฺฉู ุนููฺฏุฑูุง `&` ู `|` ุจุฑุง ุนููููุฏูุง ุงุฒ ููุน **bool?** ุงุณุชูุงุฏู ูโุดููุฏุ ููุฏุงุฑ `null` ุจูโุนููุงู ฺฉ **ููุฏุงุฑ ูุงุดูุงุฎุชู** ุฏุฑ ูุธุฑ ฺฏุฑูุชู ูโุดูุฏ. ุจูุงุจุฑุงู:

+ `null | true` ุจุฑุงุจุฑ **true** ุงุณุชุ ุฒุฑุง:

  + ุงฺฏุฑ ููุฏุงุฑ ูุงุดูุงุฎุชู false ุจุงุดุฏุ ูุชุฌู true ุงุณุช.
  + ุงฺฏุฑ ููุฏุงุฑ ูุงุดูุงุฎุชู true ุจุงุดุฏุ ูุชุฌู true ุงุณุช.

+ ุจูโุทูุฑ ูุดุงุจูุ `null & false` ุจุฑุงุจุฑ **false** ุงุณุช. ุงู ุฑูุชุงุฑ ุจุฑุง ฺฉุงุฑุจุฑุงู SQL ุขุดูุงุณุช.

ูุซุงู ุฏฺฏุฑ:

```csharp
bool? n = null;
bool? f = false;
bool? t = true;

Console.WriteLine (n | n);    // (null)
Console.WriteLine (n | f);    // (null)
Console.WriteLine (n | t);    // True
Console.WriteLine (n & n);    // (null)
Console.WriteLine (n & f);    // False
Console.WriteLine (n & t);    // (null)
```

---

### Nullable Value Types ู ุนููฺฏุฑูุง ฺฉูฺฉ (`??` ู Null-Conditional) โก

ููุนโูุง **nullable** ุจูโุฎูุจ ุจุง ุนููฺฏุฑ **Null Coalescing (`??`)** ฺฉุงุฑ ูโฺฉููุฏ:

```csharp
int? x = null;
int y = x ?? 5;        // y ุจุฑุงุจุฑ 5

int? a = null, b = 1, c = 2;
Console.WriteLine (a ?? b ?? c);  // 1 (ุงููู ููุฏุงุฑ ุบุฑ-null)
```

ุงุณุชูุงุฏู ุงุฒ `??` ุฑู ฺฉ ููุฏุงุฑ nullable ูุนุงุฏู ูุฑุงุฎูุงู ูุชุฏ `GetValueOrDefault` ุจุง ฺฉ ููุฏุงุฑ ูพุดโูุฑุถ ุงุณุชุ ุจุง ุงู ุชูุงูุช ฺฉู ุงฺฏุฑ ูุชุบุฑ null ูุจุงุดุฏุ ุนุจุงุฑุช ูพุดโูุฑุถ ูุฑฺฏุฒ ุงุฑุฒุงุจ ููโุดูุฏ.

ููฺูู **Null-Conditional Operator (`?.`)** ุจุง ููุนโูุง nullable ุจู ุฎูุจ ฺฉุงุฑ ูโฺฉูุฏ:

```csharp
System.Text.StringBuilder sb = null;
int? length = sb?.ToString().Length;  // length ุจุฑุงุจุฑ null ูโุดูุฏ
```

ูโุชูุงูู ุงู ุฑุง ุจุง `??` ุชุฑฺฉุจ ฺฉูู ุชุง ุจู ุฌุง null ููุฏุงุฑ ุตูุฑ ุจุฑฺฏุฑุฏุงูู:

```csharp
int length = sb?.ToString().Length ?? 0;  // ุงฺฏุฑ sb null ุจุงุดุฏุ ูุชุฌู 0 ุงุณุช
```

---

### ุณูุงุฑููุง ุงุณุชูุงุฏู ุงุฒ ููุนโูุง Nullable ๐ก

ฺฉ ุงุฒ ุฑุงุฌโุชุฑู ฺฉุงุฑุจุฑุฏูุง ุจุฑุง **nullable value types** ููุงุด ููุงุฏุฑ ูุงุดูุงุฎุชู ุงุณุช. ุงู ุญุงูุช ุจูโูฺู ุฏุฑ ุจุฑูุงููโููุณ ูพุงฺฏุงู ุฏุงุฏู ุฑุงุฌ ุงุณุชุ ุฌุง ฺฉู ฺฉ ฺฉูุงุณ ุจู ุฌุฏูู ุจุง ุณุชููโูุง nullable ูฺฏุงุดุช ูโุดูุฏ.

ุงฺฏุฑ ุณุชููโูุง ุงุฒ ููุน **string** ุจุงุดูุฏุ ูุดฺฉู ูุฌูุฏ ูุฏุงุฑุฏ ุฒุฑุง string ููุน ูุฑุฌุน ุงุณุช ู ูโุชูุงูุฏ null ุจุงุดุฏ. ุงูุง ุงฺฉุซุฑ ุณุชููโูุง SQL ุจู ููุน struct ุฏุฑ CLR ูฺฏุงุดุช ูโุดููุฏุ ุจูุงุจุฑุงู ุงุณุชูุงุฏู ุงุฒ ููุนโูุง nullable ุจุณุงุฑ ููุฏ ุงุณุช:

```csharp
// ูฺฏุงุดุช ุจู ุฌุฏูู Customer ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู
public class Customer
{
  ...
  public decimal? AccountBalance;
}
```

ููฺููุ ููุน nullable ูโุชูุงูุฏ ุจุฑุง ููุงุด **ููุฏ ูพุดุชุจุงู (backing field)** ฺฉ property ูุญุท (ambient property) ุงุณุชูุงุฏู ุดูุฏ. ฺฉ **ambient property** ุงฺฏุฑ null ุจุงุดุฏุ ููุฏุงุฑ parent ุฎูุฏ ุฑุง ุจุงุฒูโฺฏุฑุฏุงูุฏ:

```csharp
public class Row
{
  ...
  Grid parent;
  Color? color;

  public Color Color
  {
    get { return color ?? parent.Color; }
    set { color = value == parent.Color ? (Color?)null : value; }
  }
}
```

---

### ุฌุงฺฏุฒูโูุง ุจุฑุง Nullable Value Types โ๏ธ

ูุจู ุงุฒ ุงูฺฉู nullable value types ุจุฎุด ุงุฒ ุฒุจุงู C# ุจุงุดูุฏ (ูุจู ุงุฒ C# 2.0)ุ ุงุณุชุฑุงุชฺโูุง ูุฎุชูู ุจุฑุง ูุฏุฑุช ุขูโูุง ูุฌูุฏ ุฏุงุดุช. ฺฉ ุงุฒ ุงู ุงุณุชุฑุงุชฺโูุง ุงู ุจูุฏ ฺฉู ฺฉ ููุฏุงุฑ ุฎุงุต ุบุฑ-null ุฑุง ุจูโุนููุงู **magic value** ุง ููุฏุงุฑ null ูุฑุถ ฺฉูู.

ูุซุงูโูุง:

```csharp
// String.IndexOf ููุช ฺฉุงุฑุงฺฉุชุฑ ูพุฏุง ูุดูุฏุ -1 ุจุฑูโฺฏุฑุฏุงูุฏ
int i = "Pink".IndexOf('b');
Console.WriteLine(i);  // -1

// Array.IndexOf ููุช ุนูุตุฑ ูพุฏุง ูุดูุฏ (ู ุขุฑุงู ุงุฒ ุงูุฏุณ 1 ุดุฑูุน ุดูุฏ):
Array a = Array.CreateInstance(typeof(string), new int[] {2}, new int[] {1});
a.SetValue("a", 1);
a.SetValue("b", 2);
Console.WriteLine(Array.IndexOf(a, "c"));  // 0
```

ูุดฺฉู ุงูุชุฎุงุจ **magic value**:

+ ูุฑ ููุน ููุฏุงุฑ ูโุชูุงูุฏ null ุฑุง ุจู ุดูู ูุชูุงูุช ููุงุด ุฏูุฏ. ุฏุฑ ููุงุจูุ nullable value types ฺฉ ุงูฺฏู ฺฉููุงุฎุช ุจุฑุง ููู ููุนโูุง ุงุฑุงุฆู ูโฺฉูุฏ.
+ ููฺฉู ุงุณุช ููุฏุงุฑ ูุดุฎุต ุจุฑุง null ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏ.
+ ูุฑุงููุด ฺฉุฑุฏู ุชุณุช ููุฏุงุฑ (ูุซู HasValue) ุจุงุนุซ ุจุฑูุฒ ุฎุทุง ูโุดูุฏุ ุงูุง ุจุง nullable value types ุงู ุฎุทุง ุจูโุตูุฑุช **InvalidOperationException** ุฑู ููุงู ุฎุท ุฑุฎ ูโุฏูุฏ.
+ ูุงุจูุช null ุจูุฏู ฺฉ ููุฏุงุฑ ุฏุฑ ููุน ุขู ูุญุงุธ ููโุดูุฏ. ููุนโูุง ูุฏู ุจุฑูุงูู ุฑุง ูุดุฎุต ูโฺฉููุฏ ู ุจู ฺฉุงููพุงูุฑ ุงูฺฉุงู ุจุฑุฑุณ ุตุญุช ู ุฑุนุงุช ููุงุนุฏ ฺฉููุงุฎุช ุฑุง ูโุฏููุฏ.

### ููุนโูุง Nullable Reference Types ๐ข

ุฏุฑ ุญุงู ฺฉู **nullable value types** ุงูฺฉุงู null ุจูุฏู ุฑุง ุจู ููุนโูุง ููุฏุงุฑ (value types) ุงุถุงูู ูโฺฉููุฏุ **nullable reference types** (ุงุฒ C# 8 ุจู ุจุนุฏ) ุจุฑุนฺฉุณ ุนูู ูโฺฉููุฏ: ุขูโูุง ููุฏุงุฑ ุงุฒ **non-nullability** ุฑุง ุจู ููุนโูุง ูุฑุฌุน (reference types) ุงุถุงูู ูโฺฉููุฏ ุชุง ุงุฒ ุจุฑูุฒ **NullReferenceException** ุฌููฺฏุฑ ฺฉููุฏ.

ุงู ูุงุจูุช ฺฉ **ุณุทุญ ุงูู** ุงุถุงูู ูโฺฉูุฏ ฺฉู ุตุฑูุงู ุชูุณุท **ฺฉุงููพุงูุฑ** ุงุนูุงู ูโุดูุฏ ู ุจู ุตูุฑุช **ูุดุฏุงุฑูุง (warnings)** ุฒูุงู ุธุงูุฑ ูโุดูุฏ ฺฉู ฺฉุงููพุงูุฑ ุชุดุฎุต ุฏูุฏ ฺฉุฏ ููฺฉู ุงุณุช ุจุงุนุซ NullReferenceException ุดูุฏ.

---

### ูุนุงูโุณุงุฒ Nullable Reference Types โ๏ธ

ุจุฑุง ูุนุงู ฺฉุฑุฏู nullable reference typesุ ูโุชูุงูุฏ ฺฉ ุงุฒ ุงู ุฑูุดโูุง ุฑุง ุงุณุชูุงุฏู ฺฉูุฏ:

1. ุงุถุงูู ฺฉุฑุฏู ุนูุตุฑ `<Nullable>` ุจู ูุงู `.csproj` ูพุฑูฺู (ุจุฑุง ฺฉู ูพุฑูฺู):

```xml
<PropertyGroup>
  <Nullable>enable</Nullable>
</PropertyGroup>
```

2. ุง/ู ุงุณุชูุงุฏู ุงุฒ ุฏุณุชูุฑุงูุนููโูุง ุฒุฑ ุฏุฑ ฺฉุฏุ ุฏุฑ ูฺฉุงูโูุง ฺฉู ูโุฎูุงูุฏ ุงุนูุงู ุดูุฏ:

```csharp
#nullable enable    // ูุนุงูโุณุงุฒ nullable reference types ุงุฒ ุงู ููุทู ุจู ุจุนุฏ
#nullable disable   // ุบุฑูุนุงูโุณุงุฒ nullable reference types ุงุฒ ุงู ููุทู ุจู ุจุนุฏ
#nullable restore   // ุจุงุฒฺฏุฑุฏุงูุฏู ุชูุธูุงุช ุจู ุญุงูุช ูพุฑูฺู
```

---

### ุชุนุฑู ููุนโูุง Nullable Reference

ูพุณ ุงุฒ ูุนุงู ุดุฏูุ **non-nullability** ุจู ุตูุฑุช ูพุดโูุฑุถ ุงุนูุงู ูโุดูุฏ. ุจุฑุง ุงูฺฉู ฺฉ **reference type** ุจุชูุงูุฏ ููุฏุงุฑ null ุจฺฏุฑุฏุ ุจุงุฏ ุงุฒ ุนูุงูุช `?` ุงุณุชูุงุฏู ฺฉูุฏ. ูุซุงู:

```csharp
#nullable enable

string s1 = null;   // ูุดุฏุงุฑ ฺฉุงููพุงูุฑ! โ
string? s2 = null;  // ุตุญุญ โ: s2 ฺฉ nullable reference type ุงุณุช
```

ุชูุฌู ฺฉูุฏ ฺฉู **string ู string?** ุฏุฑ ุฒูุงู ุงุฌุฑุง ุชูุงูุช ูุฏุงุฑูุฏุ ุจุฑ ุฎูุงู **nullable value types** ฺฉู ฺุฒ ูุงูุน ุจู ุณุณุชู ููุน ุงุถุงูู ูโฺฉููุฏ (`Nullable<T>`).

---

### ูุดุฏุงุฑูุง ู ููุฏุงุฑุฏู ุงููู

ุงฺฏุฑ ฺฉ ููุฏ non-nullable ุจุฏูู ููุฏุงุฑุฏู ุงููู ุชุนุฑู ุดูุฏุ ฺฉุงููพุงูุฑ ูุดุฏุงุฑ ูโุฏูุฏ:

```csharp
class Foo { string x; }   // ูุดุฏุงุฑ: x ููุฏุงุฑุฏู ูุดุฏู
```

ูุดุฏุงุฑ ุจุง ููุฏุงุฑุฏู ุงููู ููุฏ ุง ููุฏุงุฑุฏู ุฏุฑ ุณุงุฒูุฏู ุญุฐู ูโุดูุฏ.

---

### ุนููฺฏุฑ Null-Forgiving (`!`) โ๏ธ

ฺฉุงููพุงูุฑ ููฺฏุงู ุฏุณุชุฑุณ ุจู ฺฉ **nullable reference type** ฺฉู ุงุญุชูุงู NullReferenceException ุฏุงุฑุฏุ ูุดุฏุงุฑ ูโุฏูุฏ:

```csharp
void Foo(string? s) => Console.Write(s.Length);  // ูุดุฏุงุฑ
```

ุจุฑุง ุญุฐู ูุดุฏุงุฑุ ูโุชูุงู ุงุฒ **null-forgiving operator** ุงุณุชูุงุฏู ฺฉุฑุฏ:

```csharp
void Foo(string? s) => Console.Write(s!.Length);
```

โ๏ธ ุงู ุฑูุด ุฎุทุฑูุงฺฉ ุงุณุช ู ููฺฉู ุงุณุช ููุงู **NullReferenceException** ฺฉู ูโุฎูุงุณุชู ุฌููฺฏุฑ ฺฉูู ุฑุง ุงุฌุงุฏ ฺฉูุฏ. ุฑูุด ุงููโุชุฑ:

```csharp
void Foo(string? s)
{
    if (s != null) 
        Console.Write(s.Length);
}
```

ฺฉุงููพุงูุฑ ุจุง ุชุญูู ุฌุฑุงู ุจุฑูุงูู (static flow analysis) ูโุชูุงูุฏ ุชุดุฎุต ุฏูุฏ ฺฉู ุฏุณุชุฑุณ ุงูู ุงุณุช ู ูุดุฏุงุฑูุง ุฑุง ูุฏูุฏ.

---

### ูุญุฏูุฏุชโูุง ู ุชุญูู ฺฉุงููพุงูุฑ

ฺฉุงููพุงูุฑ ุชูุงูุง ฺฉุงูู ุจุฑุง ุชุดุฎุต ุฎุทุฑ NullReferenceException ูุฏุงุฑุฏ. ูุซูุงู ููโุชูุงูุฏ ุชุดุฎุต ุฏูุฏ ฺฉู ุนูุงุตุฑ ฺฉ ุขุฑุงู ููุฏุงุฑุฏู ุดุฏูโุงูุฏ ุง ูู:

```csharp
var strings = new string[10];
Console.WriteLine(strings[0].Length);  // ูฺ ูุดุฏุงุฑ ุชููุฏ ููโุดูุฏ
```

---

### ุชูฺฉฺฉ Annotation ู Warning Contexts ๐๏ธ

ูุนุงู ฺฉุฑุฏู nullable reference types ุจุง ุฏุณุชูุฑ `#nullable enable` ุง `<Nullable>enable</Nullable>` ุฏู ฺฉุงุฑ ุงูุฌุงู ูโุฏูุฏ:

1. **nullable annotation context**: ููู ูุชุบุฑูุง reference-type ุฑุง non-nullable ูุฑุถ ูโฺฉูุฏ ูฺฏุฑ ุขูฺฉู ุจุง `?` ูุดุฎุต ุดููุฏ.
2. **nullable warning context**: ฺฉุงููพุงูุฑ ููฺฏุงู ููุงุฌูู ุจุง ฺฉุฏ ฺฉู ุงุญุชูุงู NullReferenceException ุฏุงุฑุฏุ ูุดุฏุงุฑ ูโุฏูุฏ.

ูโุชูุงู ุงู ุฏู ููุฑุฏ ุฑุง ุฌุฏุงฺฏุงูู ูุนุงู ฺฉุฑุฏ:

```csharp
#nullable enable annotations  // ููุท annotation context ูุนุงู ุงุณุช
#nullable enable warnings     // ููุท warning context ูุนุงู ุงุณุช
```

ุง ุฏุฑ ูุงู ูพุฑูฺู:

```xml
<Nullable>annotations</Nullable>
<!-- OR -->
<Nullable>warnings</Nullable>
```

ูุนุงู ฺฉุฑุฏู ููุท **annotation context** ุจุฑุง ฺฉูุงุณ ุง ุงุณูุจู ูุฏู ูโุชูุงูุฏ ุงููู ฺฏุงู ููุงุณุจ ุจุฑุง ุงูุฒูุฏู nullable reference types ุจุฏูู ููุงุฌูู ุจุง ูุดุฏุงุฑูุง ุจุงุดุฏ.

---

### ุชุจุฏู ูุดุฏุงุฑูุง ุจู ุฎุทุง โก

ุฏุฑ ูพุฑูฺูโูุง ุฌุฏุฏุ ูโุชูุงู nullable context ุฑุง ุงุฒ ุงุจุชุฏุง ูุนุงู ฺฉุฑุฏ ู ุญุช ูุดุฏุงุฑูุง ุฑุง ุจู ุฎุทุง ุชุจุฏู ูููุฏ ุชุง ูพุฑูฺู ุชุง ุฒูุงู ฺฉู ุชูุงู ูุดุฏุงุฑูุง null ุฑูุน ูุดุฏูโุงูุฏุ **ูุงุจู ฺฉุงููพุงู ูุจุงุดุฏ**:

```xml
<PropertyGroup>
  <Nullable>enable</Nullable>
  <WarningsAsErrors>CS8600;CS8602;CS8603</WarningsAsErrors>
</PropertyGroup>
```

### ูุชุฏูุง ุชูุณุนูโุงูุชู (Extension Methods) โจ

**ูุชุฏูุง ุชูุณุนูโุงูุชู** ุงูฺฉุงู ุงูุฒูุฏู ูุชุฏูุง ุฌุฏุฏ ุจู ฺฉ ููุน ููุฌูุฏ ุฑุง ุจุฏูู ุชุบุฑ ุฏุฑ ุชุนุฑู ุงุตู ุขู ููุน ูุฑุงูู ูโฺฉููุฏ.

---

### ุชุนุฑู Extension Method

ฺฉ **extension method** ุฏุฑ ูุงูุน ฺฉ **ูุชุฏ static** ุฏุฑ ฺฉ ฺฉูุงุณ **static** ุงุณุช ฺฉู **ูพุงุฑุงูุชุฑ ุงูู ุขู ุจุง ฺฉูุฏูุงฺู `this` ูุดุฎุต ุดุฏู** ู ููุน ุงู ูพุงุฑุงูุชุฑุ ููุงู ููุน ุงุณุช ฺฉู ูโุฎูุงูู ฺฏุณุชุฑุด ุฏูู:

```csharp
public static class StringHelper
{
    public static bool IsCapitalized(this string s)
    {
        if (string.IsNullOrEmpty(s)) return false;
        return char.IsUpper(s[0]);
    }
}
```

ุงู ูุชุฏ ุฑุง ูโุชูุงู ุจู ุตูุฑุช **ูุชุฏ ููููู (instance method)** ุฑู ุฑุดุชูโูุง ูุฑุงุฎูุงู ฺฉุฑุฏ:

```csharp
Console.WriteLine("Perth".IsCapitalized());  // True
```

ฺฉุงููพุงูุฑ ุงู ฺฉุฏ ุฑุง ุจู ูุฑุงุฎูุงู ูุนููู **static** ุชุจุฏู ูโฺฉูุฏ:

```csharp
Console.WriteLine(StringHelper.IsCapitalized("Perth"));
```

---

### ฺฏุณุชุฑุด ุงูุชุฑูุณโูุง

ูโุชูุงู ุงู ูุชุฏูุง ุฑุง ุฑู **interface**ูุง ูุฒ ุงุนูุงู ฺฉุฑุฏ:

```csharp
public static T First<T>(this IEnumerable<T> sequence)
{
    foreach (T element in sequence)
        return element;
    throw new InvalidOperationException("No elements!");
}

Console.WriteLine("Seattle".First());  // S
```

---

### ุฒูุฌุฑูโุณุงุฒ ูุชุฏูุง ุชูุณุนูโุงูุชู (Extension Method Chaining)

ูุซู ูุชุฏูุง ูููููุ ูโุชูุงู extension methodูุง ุฑุง **ุฒูุฌุฑูโุง** ูุฑุงุฎูุงู ฺฉุฑุฏ:

```csharp
public static class StringHelper
{
    public static string Pluralize(this string s) { ... }
    public static string Capitalize(this string s) { ... }
}

string x = "sausage".Pluralize().Capitalize();   // "Sausages"
string y = StringHelper.Capitalize(StringHelper.Pluralize("sausage")); // ูุนุงุฏู x
```

---

### ุญู ุงุจูุงู ู ููุงุนุฏ ุฏุณุชุฑุณ

1. **Namespace**:
   ุจุฑุง ุฏุณุชุฑุณ ุจู extension methodุ ฺฉูุงุณ ุขู ุจุงุฏ ุฏุฑ **scope** ุจุงุดุฏ (ูุนูููุงู ุจุง import namespace):

```csharp
using Utils;  // ฺฉูุงุณ StringHelper ุฏุฑ namespace Utils ูุฑุงุฑ ุฏุงุฑุฏ
```

2. **Extension method vs Instance method**:
   ูุฑ ูุชุฏ ูููููโ ุณุงุฒฺฏุงุฑุ **ุงูููุช ุจุดุชุฑ ูุณุจุช ุจู extension method ุฏุงุฑุฏ**. ุจุฑุง ูุฑุงุฎูุงู extension method ุฏุฑ ุงู ุดุฑุงุทุ ุจุงุฏ ุงุฒ **ูุฑุงุฎูุงู static** ุงุณุชูุงุฏู ฺฉุฑุฏ:

```csharp
class Test
{
    public void Foo(object x) { }   // ููุดู ุจุฑูุฏู ุงุณุช
}

static class Extensions
{
    public static void Foo(this Test t, int x) { }
}

// ูุฑุงุฎูุงู:
Extensions.Foo(new Test(), 42);   // ุจุงุฏ ุงุฒ ุฑูุด static ุงุณุชูุงุฏู ุดูุฏ
```

3. **Extension method vs Extension method**:
   ุงฺฏุฑ ุฏู ูุชุฏ extension ุจุง ุงูุถุง ฺฉุณุงู ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏุ ุจุฑุง ุฑูุน ุงุจูุงู ุจุงุฏ ุจู ุตูุฑุช **static** ูุฑุงุฎูุงู ุดูุฏ.
   ุงฺฏุฑ ฺฉ ุงุฒ ูุชุฏูุง ุขุฑฺฏููุงูโูุง ุฎุงุตโุชุฑ ุฏุงุดุชู ุจุงุดุฏุ ูุชุฏ ุฎุงุตโุชุฑ ุจุฑูุฏู ุงุณุช.

```csharp
static class StringHelper
{
    public static bool IsCapitalized(this string s) { ... }
}
static class ObjectHelper
{
    public static bool IsCapitalized(this object s) { ... }
}

bool test1 = "Perth".IsCapitalized();  // ูุฑุงุฎูุงู StringHelper
```

---

### ฺฉุงูุด ุณุทุญ ฺฉ ูุชุฏ ุชูุณุนูโุงูุชู (Demoting an Extension Method)

ูุฑุถ ฺฉูุฏ ฺฉ ูุชุฏ ุชูุณุนูโุงูุชู ุฏุฑ ฺฉุชุงุจุฎุงูู ุดุฎุต ุซุงูุซ ุจุง ฺฉ ูุชุฏ ุฌุฏุฏ ุฏุฑ ฺฉุชุงุจุฎุงูู .NET ุชุฏุงุฎู ุฏุงุฑุฏ. ูโุชูุงู ุจุฏูู ุญุฐู ุขูุ ุขู ุฑุง **ุจู ฺฉ ูุชุฏ static ูุนููู ุชุจุฏู ฺฉุฑุฏ**:

+ ฺฉุงู ุงุณุช `this` ุฑุง ุงุฒ ูพุงุฑุงูุชุฑ ุงูู ุญุฐู ฺฉูู.
+ ูููโ ูุฑุงุฎูุงูโูุง ฺฉู ูุจูุงู ุจุง extension method ุจูุฏูโุงูุฏุ ููฺฏุงู ฺฉุงููพุงู ุฏูุจุงุฑู ุจู **ูุฑุงุฎูุงู static** ุชุจุฏู ูโุดููุฏ.
+ ูุตุฑูโฺฉููุฏฺฏุงู ฺฉุชุงุจุฎุงูู ููุท ุฒูุงู ุชุญุช ุชุฃุซุฑ ูุฑุงุฑ ูโฺฏุฑูุฏ ฺฉู ุฏูุจุงุฑู ูพุฑูฺู ุฑุง ฺฉุงููพุงู ฺฉููุฏ.

---

### ููุนโูุง ูุงุดูุงุณ (Anonymous Types) ู ุชุงูพูโูุง (Tuples) ุฏุฑ C# ๐ข

---

## ฑ. ููุนโูุง ูุงุดูุงุณ (Anonymous Types) โจ

ฺฉ **ููุน ูุงุดูุงุณ**ุ ฺฉูุงุณ ุณุงุฏูโุง ุงุณุช ฺฉู **ฺฉุงููพุงูุฑ ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุงุฌุงุฏ ูโฺฉูุฏ** ุชุง ูุฌููุนูโุง ุงุฒ ููุงุฏุฑ ุฑุง ุฐุฎุฑู ฺฉูุฏ.

### ูุญูู ุชุนุฑู

```csharp
var dude = new { Name = "Bob", Age = 23 };
```

ฺฉุงููพุงูุฑ ุชูุฑุจุงู ุงู ุฑุง ุจู ุตูุฑุช ุฒุฑ ุชุฑุฌูู ูโฺฉูุฏ:

```csharp
internal class AnonymousGeneratedTypeName
{
    private string name;
    private int age;
    public AnonymousGeneratedTypeName(string name, int age)
    {
        this.name = name; this.age = age;
    }
    public string Name => name;
    public int Age => age;
    // ูุชุฏูุง Equalsุ GetHashCode ู ToString ุจุงุฒููุณ ุดุฏูโุงูุฏ
}
```

> โ๏ธ ุจุงุฏ ููุดู ุงุฒ `var` ุจุฑุง ุงุฑุฌุงุน ุจู ููุน ูุงุดูุงุณ ุงุณุชูุงุฏู ฺฉุฑุฏุ ฺูู **ูุงู ูุฏุงุฑุฏ**.

---

### ููุงุนุฏ ู ูฺฉุงุช ููู

1. **ุงุณุชูุชุงุฌ ูุงู ูฺฺฏโูุง:**
   ุงฺฏุฑ ฺฉ ุนุจุงุฑุช ุดุงูู **ุดูุงุณูโุง ููุฌูุฏ** ุจุงุดุฏุ ูุงู ูฺฺฏ ูโุชูุงูุฏ ุงุฒ ุขู ุงุณุชุฎุฑุงุฌ ุดูุฏ:

```csharp
int Age = 23;
var dude = new { Name = "Bob", Age, Age.ToString().Length };
// ูุนุงุฏู:
var dude = new { Name = "Bob", Age = Age, Length = Age.ToString().Length };
```

2. **ุจุฑุงุจุฑ ุจูุฏู ููุน ูุงุดูุงุณ:**
   ุฏู ููููู ูุงุดูุงุณ ุจุง **ูฺฺฏโูุง ฺฉุณุงู ุฏุฑ ููุงู ุงุณูุจู**ุ ููุน ฺฉุณุงู ุฏุงุฑูุฏ:

```csharp
var a1 = new { X = 2, Y = 4 };
var a2 = new { X = 2, Y = 4 };
Console.WriteLine(a1.GetType() == a2.GetType());  // True
```

3. **ููุงุณู ููุงุฏุฑ:**

   + `Equals` โ ููุงุณู ุฏุงุฏูโูุง (ุณุงุฎุชุงุฑ)
   + `==` โ ููุงุณู ูุฑุฌุน (referential)

```csharp
Console.WriteLine(a1.Equals(a2));  // True
Console.WriteLine(a1 == a2);       // False
```

4. **ุขุฑุงูโุง ุงุฒ ููุน ูุงุดูุงุณ:**

```csharp
var dudes = new[]
{
    new { Name = "Bob", Age = 30 },
    new { Name = "Tom", Age = 40 }
};
```

5. **ุบุฑ ูุงุจู ุชุบุฑ ุจูุฏู (Immutable)**
   ุงุฒ C# 10 ุจู ุจุนุฏ ูโุชูุงู ุจุง `with` ฺฉ ูุณุฎู ุฌุฏุฏ ุจุง ุชุบุฑุงุช ุณุงุฎุช ุจุฏูู ุชุฎุฑุจ ูุณุฎู ุงุตู:

```csharp
var a1 = new { A = 1, B = 2, C = 3, D = 4, E = 5 };
var a2 = a1 with { E = 10 };
Console.WriteLine(a2);  // { A = 1, B = 2, C = 3, D = 4, E = 10 }
```

> ููุนโูุง ูุงุดูุงุณ ุจุณุงุฑ ฺฉุงุฑุจุฑุฏ ุฏุฑ **LINQ** ูุณุชูุฏ.

---

## ฒ. ุชุงูพูโูุง (Tuples) ๐น

**ุชุงูพูโูุง** ูุดุงุจู ููุนโูุง ูุงุดูุงุณ ูุณุชูุฏุ ุงูุง ุงูฺฉุงู ุจุงุฒฺฏุฑุฏุงูุฏู ฺูุฏ ููุฏุงุฑ ุงุฒ ฺฉ ูุชุฏ ุฑุง ุจุฏูู ูพุงุฑุงูุชุฑ `out` ูโุฏููุฏ.

### ุชุนุฑู ุณุงุฏู

```csharp
var bob = ("Bob", 23);  // ุงููุงูโูุง ูุงูโฺฏุฐุงุฑ ูุดุฏูโุงูุฏ
Console.WriteLine(bob.Item1);  // Bob
Console.WriteLine(bob.Item2);  // 23
```

+ ุชุงูพูโูุง **Value Type** ูุณุชูุฏ ู ุงููุงูโูุงุดุงู ูุงุจู ุชุบุฑ ุงุณุช:

```csharp
var joe = bob;    // ฺฉูพ ุงุฒ bob
joe.Item1 = "Joe";
Console.WriteLine(bob);  // (Bob, 23)
Console.WriteLine(joe);  // (Joe, 23)
```

### ุชุนุฑู ุจุง ููุน ูุดุฎุต

```csharp
(string, int) bob = ("Bob", 23);
```

+ ูโุชูุงู ุชุงูพู ุฑุง ุงุฒ ูุชุฏ ุจุงุฒฺฏุฑุฏุงูุฏ:

```csharp
(string, int) GetPerson() => ("Bob", 23);
(string, int) person = GetPerson();
Console.WriteLine(person.Item1);  // Bob
Console.WriteLine(person.Item2);  // 23
```

### ุณุงุฒฺฏุงุฑ ุจุง ุฌูุฑฺฉโูุง

```csharp
Task<(string,int)>
Dictionary<(string,int), Uri>
IEnumerable<(int id, string name)>   // ุงูฺฉุงู ูุงูโฺฏุฐุงุฑ ุงููุงูโูุง
```

---

### ูุงูโฺฏุฐุงุฑ ุงููุงูโูุง ุชุงูพู ู ูฺฉุงุช ูพุดุฑูุชู ๐ข

---

## ฑ. ูุงูโฺฏุฐุงุฑ ุงููุงูโูุง ููฺฏุงู ุงุฌุงุฏ ุชุงูพู

ูโุชูุงู ุงููุงูโูุง ุฑุง ุจุง ูุงูโูุง ูุนูโุฏุงุฑ ูุดุฎุต ฺฉุฑุฏ:

```csharp
var tuple = (name: "Bob", age: 23);
Console.WriteLine(tuple.name);  // Bob
Console.WriteLine(tuple.age);   // 23
```

ููู ฺฉุงุฑ ููฺฏุงู **ูุดุฎุต ฺฉุฑุฏู ููุน ุชุงูพู** ูุฒ ููฺฉู ุงุณุช:

```csharp
(string name, int age) GetPerson() => ("Bob", 23);
var person = GetPerson();
Console.WriteLine(person.name);  // Bob
Console.WriteLine(person.age);   // 23
```

---

## ฒ. ุงุณุชูุงุฏู ุงุฒ ุฑฺฉูุฑุฏูุง (Records) ุจุฑุง ููุน ุจุงุฒฺฏุดุช ููโุชุฑ

ุจู ุฌุง ุชุงูพู ูโุชูุงู ุงุฒ **ุฑฺฉูุฑุฏูุง** ุงุณุชูุงุฏู ฺฉุฑุฏ ุชุง ููุน ุจุงุฒฺฏุดุช **ูู ู ูุงุจู ุชุบุฑ** ุฏุงุดุชู ุจุงุดู:

```csharp
record Person(string Name, int Age);

Person GetPerson() => new("Bob", 23);
var person = GetPerson();
Console.WriteLine(person.Name);  // Bob
Console.WriteLine(person.Age);   // 23
```

ูุฒุงุง:

+ ููุน ุจุงุฒฺฏุดุช ูุงูโฺฏุฐุงุฑ ุดุฏู ู ูุงุจู ุจุงุฒุณุงุฒ/refactor ุงุณุช.
+ ฺฉุงูุด ุชฺฉุฑุงุฑ ฺฉุฏ.
+ ุชุดูู ุจู ุทุฑุงุญ ุฎูุจ ู ุงุตูู OOP.

---

## ณ. ุงุณุชูุชุงุฌ ุฎูุฏฺฉุงุฑ ูุงู ุงููุงูโูุง

ูุซุงู:

```csharp
var now = DateTime.Now;
var tuple = (now.Day, now.Month, now.Year);
Console.WriteLine(tuple.Day);  // OK
```

> ฺฉุงููพุงูุฑ ุงุฒ ูุงู ููุฏ ุง ูพุฑุงูพุฑุช ุจุฑุง ุงููุงูโูุง ุงุณุชูุงุฏู ูโฺฉูุฏ.

---

## ด. ุณุงุฒฺฏุงุฑ ููุน (Type Compatibility) ู ุงุดุชุจุงูุงุช ูุญุชูู

ุชุงูพูโูุง ููุท ุงุฒ ูุธุฑ **ููุน ุงููุงูโูุง** ุจุง ูู ุณุงุฒฺฏุงุฑูุฏุ **ูุงู ุงููุงูโูุง ุงููุช ูุฏุงุฑุฏ**:

```csharp
(string name, int age, char sex) bob1 = ("Bob", 23, 'M');
(string age, int sex, char name) bob2 = bob1;  // ุจุฏูู ุฎุทุง!
Console.WriteLine(bob2.name);  // M
Console.WriteLine(bob2.age);   // Bob
Console.WriteLine(bob2.sex);   // 23
```

> โ๏ธ ุงู ูโุชูุงูุฏ ููุฌุฑ ุจู ูุชุงุฌ ฺฏุฌโฺฉููุฏู ุดูุฏ.

---

## ต. ุญุฐู ูุงู ุงููุงูโูุง ุฏุฑ ุฒูุงู ุงุฌุฑุง (Type Erasure)

+ ุชุงูพูโูุง ุงุฒ `ValueTuple<>` ุงุณุชูุงุฏู ูโฺฉููุฏ ู ุฏุฑ runtime **ูุงู ุงููุงูโูุง ุฑุง ูุฏุงุฑูุฏ**.
+ ููุท ุฏุฑ ุณูุฑุณ ฺฉุฏ ู ฺฉุงููพุงูุฑ ูุฌูุฏ ุฏุงุฑูุฏ.
+ ุฏุฑ ุจุดุชุฑ ุงุจุฒุงุฑูุง ูุซู **Debugging** ุง **Reflection** ูุงูโูุง ูุงุจู ูุดุงูุฏู ูุณุชูุฏ.

---

## ถ. ุงุฌุงุฏ alias ุจุฑุง ุชุงูพูโูุง (C# 12)

ูโุชูุงู ุจุง `using` ุจุฑุง ุชุงูพูโูุง ูุงู ูุณุชุนุงุฑ ุชุนุฑู ฺฉุฑุฏ:

```csharp
using Point = (int, int);
Point p = (3, 4);

// ุจุง ูุงู ุงููุงู:
using Point = (int X, int Y);  // Legal
Point p2 = (3, 4);
```

---

## ท. ุงุณุชูุงุฏู ุงุฒ ValueTuple.Create

ูโุชูุงู ุชุงูพู ุฑุง ุจุง ูุชุฏ ฺฉุงุฑุฎุงููโุง ูุฒ ุณุงุฎุช:

```csharp
ValueTuple<string,int> bob1 = ValueTuple.Create("Bob", 23);
(string,int) bob2           = ValueTuple.Create("Bob", 23);
(string name,int age) bob3  = ValueTuple.Create("Bob", 23);
```

---

### ุชุฌุฒู (Deconstructing) ุชุงูพูโูุง ๐งฉ

ุชุงูพูโูุง ุจูโุตูุฑุช ุถูู ุงุฒ **ุงูฺฏู ุชุฌุฒู (deconstruction pattern)** ูพุดุชุจุงู ูโฺฉููุฏ (ุฑุฌูุน ฺฉูุฏ ุจู ุจุฎุด ยซDeconstructorsยป ุฏุฑ ุตูุญู ฑฑฐ)ุ ุจูุงุจุฑุงู ูโุชูุงูุฏ ุจู ุฑุงุญุช ฺฉ ุชุงูพู ุฑุง ุจู ูุชุบุฑูุง ุฌุฏุงฺฏุงูู ุชูุณู ฺฉูุฏ. ุจู ูุซุงู ุฒุฑ ุชูุฌู ฺฉูุฏ:

```csharp
var bob = ("Bob", 23);
string name = bob.Item1;
int age = bob.Item2;
```

ุจุง ุงุณุชูุงุฏู ุงุฒ **deconstructor ุชุงูพู**ุ ูโุชูุงู ฺฉุฏ ุฑุง ุณุงุฏูโุชุฑ ููุดุช:

```csharp
var bob = ("Bob", 23);
(string name, int age) = bob;   // ุชุฌุฒู ุชุงูพู bob ุจู
                                // ูุชุบุฑูุง ุฌุฏุงฺฏุงูู (name ู age)
Console.WriteLine(name);
Console.WriteLine(age);
```

ูุญู (syntax) ุชุฌุฒู ุดุจู ุจู ูุญู ุงุนูุงู ุชุงูพู ุจุง **ุนูุงุตุฑ ูุงูโฺฏุฐุงุฑโุดุฏู** ุงุณุชุ ุงูุง ุชูุงูุช ุฏุงุฑุฏ:

```csharp
(string name, int age)      = bob;   // ุชุฌุฒู ฺฉ ุชุงูพู
(string name, int age) bob2 = bob;   // ุงุนูุงู ฺฉ ุชุงูพู ุฌุฏุฏ
```

ูุซุงู ุฏฺฏุฑ ููฺฏุงู ูุฑุงุฎูุงู ฺฉ ูุชุฏ ุจุง **ุงุณุชูุงุฏู ุงุฒ ุงุณุชูุชุงุฌ ููุน (var)**:

```csharp
var (name, age, sex) = GetBob();
Console.WriteLine(name);  // Bob
Console.WriteLine(age);   // 23
Console.WriteLine(sex);   // M

(string name, int age, char sex) GetBob() => ("Bob", 23, 'M');
```

ููฺูู ูโุชูุงูุฏ ูุณุชููุงู **ููุฏุงุฑุฏู ุจู ููุฏูุง ู ุฎุตูุตุงุช** (fields and properties) ุงูุฌุงู ุฏูุฏุ ฺฉู ฺฉ ุฑูุด ฺฉูุชุงู ุจุฑุง ููุฏุงุฑุฏู ฺูุฏู ููุฏ ุง property ุฏุฑ ุณุงุฒูุฏู (constructor) ูุฑุงูู ูโฺฉูุฏ:

```csharp
class Point
{
    public readonly int X, Y;
    public Point(int x, int y) => (X, Y) = (x, y);
}
```

---

### ููุงุณู ุจุฑุงุจุฑ (Equality Comparison) โ๏ธ

ูุงููุฏ **anonymous types**ุ ูุชุฏ **Equals** ุฏุฑ ุชุงูพูโูุง ฺฉ ููุงุณู ุณุงุฎุชุงุฑ (structural equality) ุงูุฌุงู ูโุฏูุฏุ ุนู ุฏุงุฏูโูุง ุฏุงุฎู ููุงุณู ูโุดููุฏ ูู ูุฑุงุฌุน (references):

```csharp
var t1 = ("one", 1);
var t2 = ("one", 1);
Console.WriteLine(t1.Equals(t2));  // True
```

ุนูุงูู ุจุฑ ุงูุ **ValueTuple<>** ุนููฺฏุฑูุง `==` ู `!=` ุฑุง ุจุงุฒุชุนุฑู ฺฉุฑุฏู ุงุณุช:

```csharp
Console.WriteLine(t1 == t2);  // True (ุงุฒ C# 7.3 ุจู ุจุนุฏ)
```

ุชุงูพูโูุง ููฺูู **ูุชุฏ GetHashCode** ุฑุง ุจุงุฒุชุนุฑู ูโฺฉููุฏุ ุจูุงุจุฑุงู ูโุชูุงู ุงุฒ ุขูโูุง ุจูโุนููุงู **ฺฉูุฏ ุฏุฑ ุฏฺฉุดูุฑโูุง** ุงุณุชูุงุฏู ฺฉุฑุฏ. ููุงุณู ุจุฑุงุจุฑ ุฑุง ุฏุฑ ุจุฎุด ยซEquality Comparisonยป ุตูุญู ณดด ู ุฏฺฉุดูุฑโูุง ุฑุง ุฏุฑ ูุตู ท ุจูโุทูุฑ ููุตู ุจุฑุฑุณ ฺฉุฑุฏูโุงู.

ููุนโูุง **ValueTuple<>** ููฺูู ุฑุงุจุท **IComparable** ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉููุฏ (ุฑุฌูุน ฺฉูุฏ ุจู ยซOrder Comparisonยป ุตูุญู ณตต)ุ ุจูุงุจุฑุงู ูโุชูุงู ุงุฒ ุขูโูุง ุจูโุนููุงู ฺฉูุฏ ูุฑุชุจโุณุงุฒ ุงุณุชูุงุฏู ฺฉุฑุฏ.

---

### ฺฉูุงุณโูุง System.Tuple ๐๏ธ

ุฏุฑ ูุถุง ูุงู **System**ุ ุฎุงููุงุฏูโุง ุงุฒ ููุนโูุง generic ุจู ูุงู **Tuple** ูุฌูุฏ ุฏุงุฑุฏ (ูู ValueTuple). ุงูโูุง ุงุฒ ุณุงู ฒฐฑฐ ูุนุฑู ุดุฏูุฏ ู ุจูโุตูุฑุช ฺฉูุงุณ ุชุนุฑู ุดุฏูโุงูุฏุ ุฏุฑ ุญุงู ฺฉู **ValueTuple** ุจูโุตูุฑุช struct ูุณุชูุฏ.

ุฏุฑ ุนููุ ุชุนุฑู ุชุงูพูโูุง ุจูโุตูุฑุช ฺฉูุงุณุ ุงุดุชุจุงู ูุญุณูุจ ุดุฏุ ฺุฑุง ฺฉู ุฏุฑ ุณูุงุฑููุง ุฑุงุฌ ุงุณุชูุงุฏู ุงุฒ ุชุงูพูุ **struct** ฺฉู ุจูุชุฑ ุนูู ูโฺฉูุฏ ู ุงุฒ ุชุฎุตุต ุญุงูุธู ุงุถุงู ุฌููฺฏุฑ ูโฺฉูุฏ. ุจู ููู ุฏููุ ููุช ูุงฺฉุฑูุณุงูุช ูพุดุชุจุงู ุฒุจุงู ุจุฑุง ุชุงูพูโูุง ุฏุฑ C# 7 ุงุถุงูู ฺฉุฑุฏุ **Tuple** ูุฏู ุฑุง ฺฉูุงุฑ ฺฏุฐุงุดุช ู ุจู **ValueTuple** ุฌุฏุฏ ุฑู ุขูุฑุฏ.

ุจุง ุงู ุญุงูุ ูููุฒ ููฺฉู ุงุณุช ุฏุฑ ฺฉุฏูุง ูุจู ุงุฒ C# 7 ุจุง ฺฉูุงุณโูุง Tuple ุจุฑุฎูุฑุฏ ฺฉูุฏ. ุงูโูุง ูพุดุชุจุงู ุฒุจุงู ุฎุงุต ูุฏุงุฑูุฏ ู ุจู ุดฺฉู ุฒุฑ ุงุณุชูุงุฏู ูโุดููุฏ:

```csharp
Tuple<string, int> t = Tuple.Create("Bob", 23);  // ูุชุฏ ฺฉุงุฑุฎุงููโุง (Factory method)
Console.WriteLine(t.Item1);  // Bob
Console.WriteLine(t.Item2);  // 23
```

---

### ุฑฺฉูุฑุฏูุง (Records) ๐

ุฑฺฉูุฑุฏ ฺฉ ููุน ุฎุงุต ุงุฒ **ฺฉูุงุณ ุง struct** ุงุณุช ฺฉู ุจุฑุง ฺฉุงุฑ ุจุง ุฏุงุฏูโูุง **ุบุฑูุงุจู ุชุบุฑ (immutable/read-only)** ุทุฑุงุญ ุดุฏู ุงุณุช.

ูฺฺฏ ููุฏ ุขูุ **ุชุบุฑ ุบุฑูุฎุฑุจ (nondestructive mutation)** ุงุณุชุ ุจุง ุงู ุญุงูุ ุฑฺฉูุฑุฏูุง ุจุฑุง ุงุฌุงุฏ ุงููุงุน ฺฉู ุตุฑูุงู ุฏุงุฏูโูุง ุฑุง ูฺฏู ูโุฏุงุฑูุฏ ุง ุชุฑฺฉุจ ูโฺฉููุฏ ูุฒ ููุฏ ูุณุชูุฏ. ุฏุฑ ููุงุฑุฏ ุณุงุฏูุ ุฑฺฉูุฑุฏูุง **ฺฉุฏูุง ุงุถุงู ุฑุง ุญุฐู ูโฺฉููุฏ** ู ุฏุฑ ุนู ุญุงูุ **ููุงุณู ุจุฑุงุจุฑ ููุงุณุจ ุจุฑุง ุงููุงุน ุบุฑูุงุจู ุชุบุฑ** ุฑุง ุฑุนุงุช ูโฺฉููุฏ.

ุฑฺฉูุฑุฏูุง ุตุฑูุงู ฺฉ **ููููู ุฒูุงู ฺฉุงููพุงู ุฏุฑ C#** ูุณุชูุฏ ู ุฏุฑ ุฒูุงู ุงุฌุฑุงุ CLR ุขูโูุง ุฑุง ุจูโุตูุฑุช ฺฉูุงุณ ุง struct ูุนููู ูโุจูุฏ (ุจุง ฺูุฏ ุนุถู ุงุถุงู ยซุชุฑฺฉุจโุดุฏูยป ุชูุณุท ฺฉุงููพุงูุฑ).

---

### ููุฏูู ๐

ููุดุชู **ุงููุงุน ุบุฑูุงุจู ุชุบุฑ (immutable types)** ฺฉู ุฏุฑ ุขูโูุง ููุฏูุง ูพุณ ุงุฒ ููุฏุงุฑุฏู ุงููู ูุงุจู ุชุบุฑ ูุจุงุดูุฏุ ฺฉ ุงุณุชุฑุงุชฺ ุฑุงุฌ ุจุฑุง ุณุงุฏูโุชุฑ ฺฉุฑุฏู ูุฑูโุงูุฒุงุฑ ู ฺฉุงูุด ุจุงฺฏโูุง ุงุณุช. ุงู ููุถูุน ููฺูู ุจุฎุด ุงุตู **ุจุฑูุงููโููุณ ุชุงุจุน (functional programming)** ุงุณุชุ ุฌุง ฺฉู ุงุฒ ุญุงูุช ูุงุจู ุชุบุฑ ุงุฌุชูุงุจ ูโุดูุฏ ู ุชูุงุจุน ุจูโุนููุงู ุฏุงุฏู ุฏุฑ ูุธุฑ ฺฏุฑูุชู ูโุดููุฏ. LINQ ูุฒ ุงุฒ ุงู ุงุตู ุงููุงู ฺฏุฑูุชู ุงุณุช.

ุจุฑุง ยซุชุบุฑยป ฺฉ ุดุก ุบุฑูุงุจู ุชุบุฑุ ุจุงุฏ ฺฉ ููููู ุฌุฏุฏ ุจุณุงุฒุฏ ู ุฏุงุฏูโูุง ุฑุง ุจุง ุชุบุฑุงุช ููุฑุฏ ูุธุฑ ุฎูุฏ ููุชูู ฺฉูุฏ (**ุชุบุฑ ุบุฑูุฎุฑุจ โ nondestructive mutation**). ุงุฒ ูุธุฑ ฺฉุงุฑุงุ ุงู ฺฉุงุฑ ุจู ุงูุฏุงุฒูโุง ฺฉู ูฺฉุฑ ูโฺฉูุฏ ูุงฺฉุงุฑุขูุฏ ูุณุชุ ุฒุฑุง **ฺฉูพ ุณุทุญ (shallow copy)** ููุดู ฺฉุงู ุงุณุช ู ูุงุฒ ุจู **ฺฉูพ ุนูู (deep copy)** ฺฉู ุดุงูู ุฒุฑุดโูุง ู ูุฌููุนูโูุง ูุฒ ุจุงุดุฏุ ูุณุชุ ฺุฑุง ฺฉู ุฏุงุฏูโูุง ุบุฑูุงุจู ุชุบุฑ ูุณุชูุฏ. ุงูุง ุงุฒ ูุธุฑ ุญุฌู ฺฉุฏููุณุ ูพุงุฏูโุณุงุฒ ุชุบุฑ ุบุฑูุฎุฑุจ ูโุชูุงูุฏ ุจุณุงุฑ ูพุฑุฒุญูุช ุจุงุดุฏุ ุจูโูฺู ููุช ุชุนุฏุงุฏ ุฒุงุฏ property ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ. **ุฑฺฉูุฑุฏูุง (records)** ุงู ูุดฺฉู ุฑุง ุจุง ฺฉ **ุงูฺฏู ูพุดุชุจุงูโุดุฏู ุชูุณุท ุฒุจุงู** ุญู ูโฺฉููุฏ.

ูุณุฆูู ุฏูู ุงู ุงุณุช ฺฉู ุจุฑูุงููโููุณุงูโุจูโูฺู ุจุฑูุงููโููุณุงู ุชุงุจุนโฺฏุงู ุงุฒ ุงููุงุน ุบุฑูุงุจู ุชุบุฑ ุตุฑูุงู ุจุฑุง **ุชุฑฺฉุจ ุฏุงุฏูโูุง** ุงุณุชูุงุฏู ูโฺฉููุฏ (ุจุฏูู ุงูุฒูุฏู ุฑูุชุงุฑ). ุชุนุฑู ฺูู ุงููุงุน ฺฉุงุฑ ุจุดุชุฑ ุงุฒ ุขูฺู ุจุงุฏ ุจุงุดุฏ ูโุจุฑุฏุ ุฒุฑุง ูุงุฒู ุงุณุช **ฺฉ ุณุงุฒูุฏู (constructor)** ุฏุงุดุชู ุจุงุดุฏ ุชุง ูุฑ ูพุงุฑุงูุชุฑ ุฑุง ุจู ูุฑ property ุนููู ุงุฎุชุตุงุต ุฏูุฏ (ฺฉ **deconstructor** ูุฒ ููฺฉู ุงุณุช ููุฏ ุจุงุดุฏ). ุจุง ุฑฺฉูุฑุฏูุงุ ฺฉุงููพุงูุฑ ุงู ฺฉุงุฑ ุฑุง ุจุฑุง ุดูุง ุงูุฌุงู ูโุฏูุฏ.

ุฏุฑ ููุงุชุ ฺฉ ุงุฒ ูุชุงุฌ ุบุฑูุงุจู ุชุบุฑ ุจูุฏู ฺฉ ุดุก ุงู ุงุณุช ฺฉู **ููุช ุขู ุชุบุฑ ููโฺฉูุฏ**ุ ุจูุงุจุฑุงู ุจุฑุง ุงู ููุนโูุงุ ูพุงุฏูโุณุงุฒ **ุจุฑุงุจุฑ ุณุงุฎุชุงุฑ (structural equality)** ุจุดุชุฑ ููุฏ ุงุณุช ุชุง **ุจุฑุงุจุฑ ูุฑุฌุน (referential equality)**. ุจุฑุงุจุฑ ุณุงุฎุชุงุฑ ุนู ุฏู ููููู ุฒูุงู ุจุฑุงุจุฑูุฏ ฺฉู **ุฏุงุฏูโูุง ุขูโูุง ฺฉุณุงู ุจุงุดุฏ** (ูุงููุฏ ุชุงูพูโูุง). ุฑฺฉูุฑุฏูุง ุจูโุตูุฑุช ูพุดโูุฑุถ ุจุฑุงุจุฑ ุณุงุฎุชุงุฑ ุฑุง ูุฑุงูู ูโฺฉููุฏโุตุฑูโูุธุฑ ุงุฒ ุงูโฺฉู ููุน ุฒุฑู ฺฉูุงุณ ุจุงุดุฏ ุง structโุจุฏูู ูฺ ฺฉุฏ ุงุถุงู.

---

### ุชุนุฑู ุฑฺฉูุฑุฏ ๐ท๏ธ

ุชุนุฑู ฺฉ ุฑฺฉูุฑุฏ ุดุจู ุชุนุฑู **ฺฉูุงุณ ุง struct** ุงุณุช ู ูโุชูุงูุฏ ุดุงูู ููุงู ููุน ุงุนุถุง ุจุงุดุฏุ ุงุฒ ุฌููู ููุฏูุงุ propertyูุงุ ูุชุฏูุง ู ุบุฑู. ุฑฺฉูุฑุฏูุง ูโุชูุงููุฏ **interfaceูุง** ุฑุง ูพุงุฏูโุณุงุฒ ฺฉููุฏ ู ุฑฺฉูุฑุฏูุง ูุจุชู ุจุฑ ฺฉูุงุณ ูโุชูุงููุฏ ุงุฒ ุฑฺฉูุฑุฏูุง ุฏฺฏุฑ ุงุฑุซโุจุฑ ฺฉููุฏ.

ุจูโุตูุฑุช ูพุดโูุฑุถุ **ููุน ุฒุฑู ุฑฺฉูุฑุฏ ฺฉูุงุณ ุงุณุช**:

```csharp
record Point { }   // Point ฺฉ ฺฉูุงุณ ุงุณุช
```

ุงุฒ C# 10 ุจู ุจุนุฏุ ููุน ุฒุฑู ุฑฺฉูุฑุฏ ูโุชูุงูุฏ struct ูุฒ ุจุงุดุฏ:

```csharp
record struct Point { }   // Point ฺฉ struct ุงุณุช
```

(ุงุณุชูุงุฏู ุงุฒ `record class` ูุฒ ูุงููู ุงุณุช ู ููุงู ูุนู `record` ุฑุง ุฏุงุฑุฏ.)

ฺฉ ุฑฺฉูุฑุฏ ุณุงุฏู ููฺฉู ุงุณุช ููุท ุชุนุฏุงุฏ **property ุจุง init-only** ุฏุงุดุชู ุจุงุดุฏ ู ุงุญุชูุงูุงู ฺฉ **ุณุงุฒูุฏู**:

```csharp
record Point
{
    public Point(double x, double y) => (X, Y) = (x, y);
    public double X { get; init; }
    public double Y { get; init; }    
}
```

ุณุงุฒูุฏู ูุง ุงุฒ ฺฉ **ูุงูุจุฑ (shortcut)** ุงุณุชูุงุฏู ูโฺฉูุฏ ฺฉู ุฏุฑ ุจุฎุด ูุจู ุชูุถุญ ุฏุงุฏู ุดุฏ:

```csharp
(X, Y) = (x, y);
```

ุงู ุฏุฑ ูุงูุน ูุนุงุฏู ุงุณุช ุจุง:

```csharp
{ this.X = x; this.Y = y; }
```

---

### ฺฉุงุฑูุง ฺฉุงููพุงูุฑ ููฺฏุงู ุชุนุฑู ุฑฺฉูุฑุฏ โ๏ธ

ูพุณ ุงุฒ ฺฉุงููพุงูุ C# ุชุนุฑู ุฑฺฉูุฑุฏ ุฑุง ุจู ฺฉูุงุณ (ุง struct) ุชุจุฏู ูโฺฉูุฏ ู ูุฑุงุญู ุงุถุงู ุฒุฑ ุฑุง ุงูุฌุงู ูโุฏูุฏ:

+ ููุดุชู **ุณุงุฒูุฏู ฺฉูพ (copy constructor)** ูุญุงูุธุชโุดุฏู ู ฺฉ **ูุชุฏ Clone ูพููุงู** ุจุฑุง ุชุณูู ุชุบุฑ ุบุฑูุฎุฑุจ
+ ุจุงุฒุชุนุฑู/ุจุงุฑฺฏุฐุงุฑ ูุฌุฏุฏ ูุชุฏูุง ูุฑุชุจุท ุจุง ุจุฑุงุจุฑ ุจุฑุง ูพุงุฏูโุณุงุฒ **ุจุฑุงุจุฑ ุณุงุฎุชุงุฑ**
+ ุจุงุฒุชุนุฑู ูุชุฏ **ToString()** (ุจุฑุง ููุงุด propertyูุง ุนูููุ ูุดุงุจู anonymous types)

ูุซุงู ุชูุฑุจุงู ุจุฑุงุจุฑ ุจุง ุขูฺู ุจุงูุง ุชุนุฑู ุดุฏ:

```csharp
class Point
{  
    public Point(double x, double y) => (X, Y) = (x, y);
    public double X { get; init; }
    public double Y { get; init; }    

    protected Point(Point original)  // ุณุงุฒูุฏู ฺฉูพ
    {
        this.X = original.X; this.Y = original.Y;
    }

    // ูุงู ุนุฌุจ ุชููุฏ ุดุฏู ุชูุณุท ฺฉุงููพุงูุฑ
    public virtual Point <Clone>$() => new Point(this);  // ูุชุฏ Clone

    // ฺฉุฏ ุงุถุงู ุจุฑุง ุจุงุฒุชุนุฑู Equals, ==, !=, GetHashCode, ToString()
    // ...
}
```

---

### ูุณุช ูพุงุฑุงูุชุฑูุง ๐

ูฺ ฺุฒ ูุงูุน ูุฑุงุฑ ุฏุงุฏู **ูพุงุฑุงูุชุฑูุง ุงุฎุชุงุฑ (optional)** ุฏุฑ ุณุงุฒูุฏู ููโุดูุฏุ ุงูุง ฺฉ ุงูฺฏู ุฎูุจ (ุจูโูฺู ุฏุฑ ฺฉุชุงุจุฎุงููโูุง ุนููู) ุงู ุงุณุช ฺฉู ุขูโูุง ุฑุง **ุงุฒ ุณุงุฒูุฏู ุญุฐู ฺฉุฑุฏู ู ุตุฑูุงู ุจูโุตูุฑุช propertyูุง init-only** ุงุฑุงุฆู ุฏูุฏ:

```csharp
new Foo(123, 234) { Optional2 = 345 };

record Foo
{
    public Foo(int required1, int required2) { ... }
    public int Required1 { get; init; }
    public int Required2 { get; init; }
    public int Optional1 { get; init; }
    public int Optional2 { get; init; }
}
```

ูุฒุช ุงู ุงูฺฏู ุงู ุงุณุช ฺฉู ูโุชูุงู **propertyูุง init-only ุฌุฏุฏ** ุงุถุงูู ฺฉุฑุฏ ุจุฏูู ุงูฺฉู **ุณุงุฒฺฏุงุฑ ุจุงูุฑ ุจุง ูุณุฎูโูุง ูุฏู** ุฑุง ูุฎุชู ฺฉูุฏ.

---

### ฺฉูุชุงูโุณุงุฒ ุชุนุฑู ุฑฺฉูุฑุฏ ุจุง ูุณุช ูพุงุฑุงูุชุฑูุง โก

ุชุนุฑู ุฑฺฉูุฑุฏ ุฑุง ูโุชูุงู ุจุง **ูุณุช ูพุงุฑุงูุชุฑูุง** ฺฉูุชุงู ฺฉุฑุฏ:

```csharp
record Point(double X, double Y)
{
    // ูโุชูุงูุฏ ุงุนุถุง ฺฉูุงุณ ุงุถุงู ูุฒ ุชุนุฑู ฺฉูุฏ...
}
```

ูพุงุฑุงูุชุฑูุง ูโุชูุงููุฏ ุดุงูู **modifiers** ูุงููุฏ `in` ู `params` ุจุงุดูุฏุ ุงูุง ูู `out` ุง `ref`. ุงฺฏุฑ ูุณุช ูพุงุฑุงูุชุฑ ูุดุฎุต ุดูุฏุ ฺฉุงููพุงูุฑ ฺฉุงุฑูุง ุงุถุงู ุฒุฑ ุฑุง ุงูุฌุงู ูโุฏูุฏ:

+ ููุดุชู ฺฉ property **init-only** ุจุฑุง ูุฑ ูพุงุฑุงูุชุฑ
+ ููุดุชู **ุณุงุฒูุฏู ุงุตู (primary constructor)** ุจุฑุง ููุฏุงุฑุฏู propertyูุง
+ ููุดุชู ฺฉ **deconstructor**

ุจูุงุจุฑุงู ุงฺฏุฑ ุฑฺฉูุฑุฏ ุฎูุฏ ุฑุง ุณุงุฏู ุชุนุฑู ฺฉูู:

```csharp
record Point(double X, double Y);
```

ฺฉุงููพุงูุฑ ุชูุฑุจุงู ููุงู ฺฉุฏ ุฑุง ุชููุฏ ูโฺฉูุฏ ฺฉู ุฏุฑ ุจุฎุด ูุจู ุฏุฏู. ุชููุง ุชูุงูุช ุฌุฒุฆ ุงู ุงุณุช ฺฉู ูุงู ูพุงุฑุงูุชุฑูุง ุฏุฑ ุณุงุฒูุฏู ุงุตู `X` ู `Y` ุฎูุงูุฏ ุจูุฏุ ูู `x` ู `y`:

```csharp
public Point(double X, double Y)  // ุณุงุฒูุฏู ุงุตู
{
    this.X = X; this.Y = Y;
}
```

---

### ูุงุจูุชโูุง ุงุถุงู ูุณุช ูพุงุฑุงูุชุฑูุง

+ ูพุงุฑุงูุชุฑูุง `X` ู `Y` ุจูโุตูุฑุช ุฌุงุฏู ุฏุฑ ูุฑ **initializer** ููุฏ ุง property ุฏุฑ ุฑฺฉูุฑุฏ ุฏุฑ ุฏุณุชุฑุณ ูุณุชูุฏ
+ ฺฉุงููพุงูุฑ **ฺฉ deconstructor** ูุฒ ุชููุฏ ูโฺฉูุฏ:

```csharp
public void Deconstruct(out double X, out double Y)
{
    X = this.X; Y = this.Y;
}
```

+ ุฑฺฉูุฑุฏูุง ุจุง ูุณุช ูพุงุฑุงูุชุฑ ุฑุง ูโุชูุงู **ุจูโุนููุงู subclass** ุชุนุฑู ฺฉุฑุฏ:

```csharp
record Point3D(double X, double Y, double Z) : Point(X, Y);
```

ฺฉู ฺฉุงููพุงูุฑ ุชููุฏ ูโฺฉูุฏ:

```csharp
class Point3D : Point
{
    public double Z { get; init; }
    public Point3D(double X, double Y, double Z) : base(X, Y)
        => this.Z = Z;
}
```

ูุณุช ูพุงุฑุงูุชุฑูุง ฺฉ **ูุงูุจุฑ ุนุงู** ุจุฑุง ฺฉูุงุณโูุง ูุณุชูุฏ ฺฉู ุตุฑูุงู **ฺูุฏ ููุฏุงุฑ ุฑุง ฺฏุฑููโุจูุฏ ูโฺฉููุฏ (product type ุฏุฑ ุจุฑูุงููโููุณ ุชุงุจุน)** ู ุจุฑุง **ูููููโุณุงุฒ ุณุฑุน (prototyping)** ููุฏ ูุณุชูุฏ. ุงูุจุชู ููฺฏุงู ูุงุฒ ุจู **ุงุถุงูู ฺฉุฑุฏู ููุทู ุจู accessors init** (ูุซูุงู ุงุนุชุจุงุฑุณูุฌ ูพุงุฑุงูุชุฑ) ฺูุฏุงู ููุงุณุจ ูุณุชูุฏ.

### ูุงุจูุช ุชุบุฑูพุฐุฑ ุฏุฑ ุฑฺฉูุฑุฏูุง Struct ๐

ููุช ฺฉู **ูุณุช ูพุงุฑุงูุชุฑ** ุฏุฑ ฺฉ **record struct** ุชุนุฑู ูโฺฉูุฏุ ฺฉุงููพุงูุฑ ุจูโุตูุฑุช ูพุดโูุฑุถ **propertyูุง ูุงุจู ููุดุชู (writable)** ุงุฌุงุฏ ูโฺฉูุฏุ ูู propertyูุง **init-only**ุ ูฺฏุฑ ุงูฺฉู ุชุนุฑู ุฑฺฉูุฑุฏ ุฑุง ุจุง ฺฉููู ฺฉูุฏ `readonly` ูพุดโูุฑุถ ฺฉูุฏ:

```csharp
readonly record struct Point(double X, double Y);
```

ุฏูู ุงู ุฑูุชุงุฑ ุงู ุงุณุช ฺฉู ุฏุฑ **ุณูุงุฑููุง ูุนููู**ุ ูุฒุงุง ุงูู **ุบุฑูุงุจู ุชุบุฑ ุจูุฏู (immutability)** ุงุฒ ุงู ูุงุด ูโุดูุฏ ฺฉู **ุฎุงูู ุง ูุญุท ูฺฏูุฏุงุฑูุฏู struct ุบุฑูุงุจู ุชุบุฑ ุงุณุช**ุ ูู ุฎูุฏ struct.

ุฏุฑ ูุซุงู ุฒุฑุ ุญุช ุงฺฏุฑ ููุฏ `X` ูุงุจู ููุดุชู ุจุงุดุฏุ ูุงุฏุฑ ุจู ุชุบุฑ ุขู ูุณุชู:

```csharp
var test = new Immutable();
test.Field.X++;  // ุบุฑูุฌุงุฒุ ุฒุฑุง Field readonly ุงุณุช
test.Prop.X++;   // ุบุฑูุฌุงุฒุ ุฒุฑุง Prop ููุท { get; } ุฏุงุฑุฏ

class Immutable
{
    public readonly Mutable Field;
    public Mutable Prop { get; }
}

struct Mutable { public int X, Y; }
```

ู ุงฺฏุฑ ุจุฎูุงูู ฺฉุงุฑ ูุงููุฏ ุฒุฑ ุงูุฌุงู ุฏูู:

```csharp
var test = new Immutable();
Mutable m = test.Prop;
m.X++;
```

ุชูุงู ฺฉุงุฑ ฺฉู ุงูุฌุงู ูโุฏูู ุงู ุงุณุช ฺฉู ฺฉ **ูุชุบุฑ ูุญู (local variable)** ุฑุง ุชุบุฑ ูโุฏููุ ฺฉู ูุณุฎูโุง ฺฉูพ ุงุฒ `test.Prop` ุงุณุช. ุชุบุฑ ฺฉ ูุชุบุฑ ูุญู ูโุชูุงูุฏ ฺฉ **ุจูููโุณุงุฒ ููุฏ** ุจุงุดุฏ ู ูุฒุงุง **ุณุณุชู ููุน ุบุฑูุงุจู ุชุบุฑ** ุฑุง ููุถ ููโฺฉูุฏ.

ุงุฒ ุทุฑู ุฏฺฏุฑุ ุงฺฏุฑ `Field` ฺฉ ููุฏ ูุงุจู ููุดุชู ู `Prop` ฺฉ property ูุงุจู ููุดุชู ุจุงุดุฏุ ูโุชูุงูู ุจู ุฑุงุญุช **ูุญุชูุงุช ุขูโูุง ุฑุง ุฌุงฺฏุฒู ฺฉูู**โุตุฑูโูุธุฑ ุงุฒ ุงูฺฉู struct `Mutable` ฺฺฏููู ุชุนุฑู ุดุฏู ุงุณุช.

### ุชุบุฑุงุช ุบุฑูุฎุฑุจ (Nondestructive Mutation) ๐โจ

ูููโุชุฑู ฺฉุงุฑ ฺฉู ฺฉุงููพุงูุฑ ุจุง **ุชูุงู ุฑฺฉูุฑุฏูุง** ุงูุฌุงู ูโุฏูุฏุ ุงุฌุงุฏ ฺฉ **ฺฉูพโฺฉููุฏู (copy constructor)** ู ฺฉ **ูุชุฏ ูพููุงู Clone** ุงุณุช. ุงู ุงูฺฉุงู ุฑุง ูุฑุงูู ูโฺฉูุฏ ฺฉู ุจุชูุงูุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ **ฺฉููู ฺฉูุฏ `with`**ุ ฺฉ ุชุบุฑ ุบุฑูุฎุฑุจ ุฑู ุฑฺฉูุฑุฏ ุงูุฌุงู ุฏูุฏ:

```csharp
Point p1 = new Point(3, 3);
Point p2 = p1 with { Y = 4 };
Console.WriteLine(p2);       // Point { X = 3, Y = 4 }

record Point(double X, double Y);
```

ุฏุฑ ุงู ูุซุงูุ `p2` ูุณุฎูโุง **ฺฉูพ ุงุฒ `p1`** ุงุณุชุ ูู ุจุง ููุฏุงุฑ **Y = 4**. ูุฒุช ุงู ุฑูุด ููุช ูุงุถุญโุชุฑ ูโุดูุฏ ฺฉู ุฑฺฉูุฑุฏ ุชุนุฏุงุฏ ุฒุงุฏ property ุฏุงุดุชู ุจุงุดุฏ:

```csharp
Test t1 = new Test(1,2,3,4,5,6,7,8);
Test t2 = t1 with { A = 10, C = 30 };
Console.WriteLine(t2);

record Test(int A, int B, int C, int D, int E, int F, int G, int H);
```

ุฎุฑูุฌ ุจู ุดฺฉู ุฒุฑ ุฎูุงูุฏ ุจูุฏ:

```
Test { A = 10, B = 2, C = 30, D = 4, E = 5, F = 6, G = 7, H = 8 }
```

### ูุฑุงุญู ุชุบุฑ ุบุฑูุฎุฑุจ ๐๏ธ

1๏ธโฃ ุงุจุชุฏุงุ **ฺฉูพโฺฉููุฏู** ุฑฺฉูุฑุฏ ุฑุง clone ูโฺฉูุฏ. ุจูโุทูุฑ ูพุดโูุฑุถุ ูุฑ ฺฉ ุงุฒ ููุฏูุง ุฏุงุฎู ุฑฺฉูุฑุฏ ฺฉูพ ูโุดููุฏุ ฺฉู ฺฉ **ูุณุฎู ุฏูู** ุงุฌุงุฏ ูโฺฉูุฏ ู ุงุฒ ุงุฌุฑุง ููุทู ุฏุฑ accessorูุง init ุฌููฺฏุฑ ูโฺฉูุฏ. ุชูุงู ููุฏูุง ุดุงูู **ุนูููุ ุฎุตูุต ู ููุฏูุง ูพููุงู ูพุดุช propertyูุง ุงุชููุงุชฺฉ** ุฏุฑ ฺฉูพ ฺฏูุฌุงูุฏู ูโุดููุฏ.

2๏ธโฃ ุณูพุณุ ูุฑ property ุฏุฑ **ูุณุช ููุฏุงุฑุฏู ุงุนุถุง (member initializer)** ุจูโุฑูุฒุฑุณุงู ูโุดูุฏุ ุงู ุจุงุฑ ุจุง ุงุณุชูุงุฏู ุงุฒ **init accessor**.

ฺฉุงููพุงูุฑ ฺฉุฏ ุฒุฑ ุฑุง:

```csharp
Test t2 = t1 with { A = 10, C = 30 };
```

ุจู ฺุฒ ุดุจู ุจู ุงู ุชุจุฏู ูโฺฉูุฏ:

```csharp
Test t2 = new Test(t1);  // ุงุณุชูุงุฏู ุงุฒ copy constructor ุจุฑุง clone ฺฉุฑุฏู t1 ููุฏ ุจู ููุฏ
t2.A = 10;               // ุจูโุฑูุฒุฑุณุงู property A
t2.C = 30;               // ุจูโุฑูุฒุฑุณุงู property C
```

> โ๏ธ ููุงูโุทูุฑ ฺฉู ูโุจูุฏุ ููุดุชู ูุณุชูู ุงู ฺฉุฏ ุฏุฑ ุญุงูุช ุนุงุฏ **ฺฉุงููพุงู ููโุดูุฏ** ฺูู A ู C propertyูุง **init-only** ูุณุชูุฏ. ุนูุงูู ุจุฑ ุงูุ copy constructor **protected** ุงุณุช ู C# ุจุฑุง ุฏูุฑ ุฒุฏู ุงู ูุญุฏูุฏุชุ ุขู ุฑุง ุงุฒ ุทุฑู ูุชุฏ ูพููุงู `<Clone>$` ูุฑุงุฎูุงู ูโฺฉูุฏ.

### ุชุนุฑู ฺฉูพโฺฉููุฏู ุณูุงุฑุด โ๏ธ

ุงฺฏุฑ ูุงุฒู ุจุงุดุฏุ ูโุชูุงูุฏ **copy constructor ุฎูุฏุชุงู** ุฑุง ุชุนุฑู ฺฉูุฏ. ฺฉุงููพุงูุฑ ุงุฒ ุชุนุฑู ุดูุง ุงุณุชูุงุฏู ุฎูุงูุฏ ฺฉุฑุฏ:

```csharp
protected Point(Point original)
{
    this.X = original.X; 
    this.Y = original.Y;
}
```

ููุดุชู ฺฉูพโฺฉููุฏู ุณูุงุฑุด ููุฏ ุงุณุช ุงฺฏุฑ ุฑฺฉูุฑุฏ ุดูุง ุญุงู **ุฒุฑ-ุงุดุงุก ุง ูุฌููุนูโูุง ูุงุจู ุชุบุฑ** ุจุงุดุฏ ฺฉู ุจุงุฏ clone ุดููุฏุ ุง ููุฏูุง ูุญุงุณุจูโุดุฏูโุง ุฏุงุดุชู ุจุงุดุฏ ฺฉู ูโุฎูุงูุฏ ูพุงฺฉ ุดููุฏ. โ๏ธ ุชูุฌู ฺฉูุฏ ฺฉู ุชููุง ูโุชูุงูุฏ **ุฌุงฺฏุฒู** ฺฉูุฏุ ูู **ุจูุจูุฏ ุฏูุฏ**.

ุฏุฑ **Subclass ฺฉุฑุฏู ุฑฺฉูุฑุฏ ุฏฺฏุฑ**ุ copy constructor ูุณุฆูู **ฺฉูพ ููุท ููุฏูุง ุฎูุฏุด** ุงุณุช. ุจุฑุง ฺฉูพ ููุฏูุง ุฑฺฉูุฑุฏ ูพุงูุ ุงุฒ **delegate ุจู base** ุงุณุชูุงุฏู ฺฉูุฏ:

```csharp
protected Point(Point original) : base(original)
{
    ...
}
```

### ุงุนุชุจุงุฑุณูุฌ propertyูุง โ

ุจุง propertyูุง **ุตุฑุญ**ุ ูโุชูุงูุฏ ููุทู ุงุนุชุจุงุฑุณูุฌ ุฑุง ุฏุฑ **init accessor** ุจููุณุฏ. ุจู ุนููุงู ูุซุงูุ ูุทูุฆู ูโุดูู X ูฺโฺฏุงู **NaN** ูุจุงุดุฏ:

```csharp
record Point
{
    public Point(double x, double y) => (X, Y) = (x, y);
    double _x;
    public double X
    { 
        get => _x;
        init
        {
            if (double.IsNaN(value))
                throw new ArgumentException("X Cannot be NaN");
            _x = value;
        }
    }
    public double Y { get; init; }    
}
```

ุจุง ุงู ุทุฑุงุญุ ุงุนุชุจุงุฑุณูุฌ ูู **ุฏุฑ ุฒูุงู ุณุงุฎุช ุฑฺฉูุฑุฏ** ู ูู **ุฏุฑ ุฒูุงู ุชุบุฑ ุบุฑูุฎุฑุจ** ุงูุฌุงู ูโุดูุฏ:

```csharp
Point p1 = new Point(2,3);
Point p2 = p1 with { X = double.NaN };   // ูพุฑุชุงุจ Exception
```

ฺฉูพโฺฉููุฏู ุฎูุฏฺฉุงุฑุ **ุชูุงู ููุฏูุง ู propertyูุง ุงุชููุงุชฺฉ** ุฑุง ฺฉูพ ูโฺฉูุฏ:

```csharp
protected Point(Point original)
{
    _x = original._x; 
    Y = original.Y;
}
```

ฺฉูพ ฺฉุฑุฏู `_x` ุงุฒ ุทุฑู **accessor** ุงูุฌุงู ููโุดูุฏุ ูู ูุดฺฉู ุงุฌุงุฏ ููโฺฉูุฏ ฺูู ููุฏุงุฑ ูุจูุงู ุจุง **init accessor** ุจูโุตูุฑุช ุงูู ููุฏุงุฑุฏู ุดุฏู ุงุณุช.

### ููุฏูุง ูุญุงุณุจูโุดุฏู ู ุงุฑุฒุงุจ Lazy โก

ฺฉ ุงุฒ ุงูฺฏููุง ุฑุงุฌ ุฏุฑ **ุจุฑูุงููโููุณ ุชุงุจุน (Functional)** ฺฉู ุจุง ุฑฺฉูุฑุฏูุง ุบุฑูุงุจู ุชุบุฑ ุฎูุจ ฺฉุงุฑ ูโฺฉูุฏุ **lazy evaluation** ุงุณุช: ููุฏุงุฑ ุชููุง ููุช ูุญุงุณุจู ูโุดูุฏ ฺฉู ูุงุฒู ุจุงุดุฏ ู ุณูพุณ ุจุฑุง ุงุณุชูุงุฏู ุจุนุฏ **ฺฉุด** ูโุดูุฏ.

ูุซูุงู ูโุฎูุงูู property ุฏุฑ ุฑฺฉูุฑุฏ Point ุชุนุฑู ฺฉูู ฺฉู ูุงุตูู ุงุฒ ูุจุฏุฃ (0,0) ุฑุง ุจุฑฺฏุฑุฏุงูุฏ:

```csharp
record Point(double X, double Y)
{
    public double DistanceFromOrigin => Math.Sqrt(X*X + Y*Y);
}
```

ุจุฑุง ุจูููโุณุงุฒ ู ุฌููฺฏุฑ ุงุฒ ูุญุงุณุจู ูฺฉุฑุฑุ ูโุชูุงูู ููุฏุงุฑ ุขู ุฑุง **lazy** ุฏุฑ ฺฉ ููุฏ ุฐุฎุฑู ฺฉูู:

```csharp
record Point
{
    double? _distance;
    public double X { get; init; }
    public double Y { get; init; }
    public double DistanceFromOrigin => _distance ??= Math.Sqrt(X*X + Y*Y);
}
```

โ ุฏุฑ ุงู ุญุงูุชุ `_distance` ุชููุง **ฺฉ ุจุงุฑ ูุญุงุณุจู** ูโุดูุฏ ู ุชุบุฑ `X` ุง `Y` ุจุงุนุซ ูพุงฺฉ ุดุฏู ููุฏุงุฑ ฺฉุด ุดุฏู ูโุดูุฏ.

```csharp
Point p1 = new Point(2,3);
Console.WriteLine(p1.DistanceFromOrigin);   // 3.605551275463989
Point p2 = p1 with { Y = 4 };
Console.WriteLine(p2.DistanceFromOrigin);   // 4.47213595499958
```

ูุฒุช ุฏฺฏุฑ ุงู ุงุณุช ฺฉู **copy constructor ุฎูุฏฺฉุงุฑ** ูุฒ ููุฏ ฺฉุด ุดุฏู `_distance` ุฑุง ฺฉูพ ูโฺฉูุฏุ ุจูุงุจุฑุงู ุงฺฏุฑ propertyูุง ุฏฺฏุฑ ฺฉู ุฏุฑ ูุญุงุณุจุงุช ุฏุฎู ูุณุชูุฏุ ุชุบุฑ ฺฉููุฏุ **ููุฏุงุฑ ฺฉุด ุดุฏู ุงุฒ ุจู ููโุฑูุฏ**.

ุงฺฏุฑ ูุฎูุงูุฏ ุงู ุฑูุชุงุฑ ุฑุง ุฏุงุดุชู ุจุงุดุฏุ ูโุชูุงูุฏ ุฏุฑ **init accessor** ููุฏุงุฑ ฺฉุด ุฑุง ูพุงฺฉ ฺฉูุฏ ุง ฺฉ **copy constructor ุณูุงุฑุด** ุจููุณุฏ ฺฉู ููุฏ ฺฉุด ุฑุง ูุงุฏุฏู ุจฺฏุฑุฏ.

---

### ุณุงุฒูุฏูโูุง ุงููู (Primary Constructors) ๐๏ธโจ

ููุช ฺฉ **ุฑฺฉูุฑุฏ** ุจุง **ูุณุช ูพุงุฑุงูุชุฑูุง** ุชุนุฑู ูโฺฉูุฏุ ฺฉุงููพุงูุฑ ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ **propertyูุง** ุฑุง ุชุนุฑู ูโฺฉูุฏ ู ฺฉ **ุณุงุฒูุฏู ุงููู (primary constructor)** ู ฺฉ **deconstructor** ุงุฌุงุฏ ูโฺฉูุฏ. ููุงูโุทูุฑ ฺฉู ุฏุฏูุ ุงู ุฑูุด ุฏุฑ ููุงุฑุฏ ุณุงุฏู ุฎูุจ ฺฉุงุฑ ูโฺฉูุฏ ู ุฏุฑ ููุงุฑุฏ ูพฺุฏูโุชุฑ ูโุชูุงูุฏ ูุณุช ูพุงุฑุงูุชุฑูุง ุฑุง ุญุฐู ฺฉุฑุฏู ู propertyูุง ู ุณุงุฒูุฏู ุฑุง ุจูโุตูุฑุช ุฏุณุช ุจููุณุฏ.

C# ููฺูู ฺฉ ฺฏุฒูู **ูุงูโุฑุงู ููุฏ** ุงุฑุงุฆู ูโุฏูุฏุ ุงฺฏุฑ ุจุฎูุงูุฏ ุจุง **ูุนูุง ุนุฌุจ ุณุงุฒูุฏูโูุง ุงููู** ฺฉูุงุฑ ุจุงุฏุ ูโุชูุงูุฏ ฺฉ **ูุณุช ูพุงุฑุงูุชุฑ ุชุนุฑู ฺฉูุฏ** ู ุฏุฑ ุนู ุญุงู ุจุฑุฎ ุง ููู propertyูุง ุฑุง ุฎูุฏุชุงู ุชุนุฑู ฺฉูุฏ:

```csharp
record Student(string ID, string LastName, string GivenName)
{
    public string ID { get; } = ID;
}
```

ุฏุฑ ุงู ุญุงูุชุ ูุง property **ID** ุฑุง **ุจูโุทูุฑ ุฏุณุช ูุฏุฑุช ฺฉุฑุฏู** ู ุขู ุฑุง ุจู ุตูุฑุช **read-only** ุชุนุฑู ฺฉุฑุฏู (ุจู ุฌุง init-only)ุ ุจูุงุจุฑุงู ุงู property ุฏฺฏุฑ ุฏุฑ **ุชุบุฑ ุบุฑูุฎุฑุจ (nondestructive mutation)** ุดุฑฺฉุช ููโฺฉูุฏ.

ุงฺฏุฑ ูฺโููุช ูุงุฒ ุจู ุชุบุฑ ุบุฑูุฎุฑุจ ฺฉ property ูุฏุงุฑุฏุ ุชุนุฑู ุขู ุจู ุตูุฑุช **read-only** ุงุฌุงุฒู ูโุฏูุฏ ุฏุงุฏูโูุง ูุญุงุณุจูโุดุฏู ุฑุง ุจุฏูู ูุงุฒ ุจู ููุดุชู ูฺฉุงูุณู ุชุงุฒูโุณุงุฒ ุฐุฎุฑู ฺฉูุฏ.

โ๏ธ ุฏูุช ฺฉูุฏ ฺฉู ูุงุฒู ุจูุฏ **ฺฉ ููุฏุงุฑุฏู ุงููู ุจุฑุง property** ุงุฑุงุฆู ุฏูู:

```csharp
public string ID { get; } = ID;
```

ุฒูุงู ฺฉู **ุชุนุฑู property ุฑุง ุจู ุนูุฏู ูโฺฏุฑุฏ**ุ ูุณุฆูู ููุฏุงุฑุฏู ุขู ูุณุชุฏ ู **ุณุงุฒูุฏู ุงููู ุฏฺฏุฑ ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ุขู ุฑุง ููุฏุงุฑุฏู ููโฺฉูุฏ**. (ุงู ุฏููุงู ูุดุงุจู ุฑูุชุงุฑ ฺฉูุงุณโูุง ู structูุง ุจุง ุณุงุฒูุฏูโูุง ุงููู ุงุณุช.) ููฺูู ุชูุฌู ฺฉูุฏ ฺฉู **ID ุฏุฑ ุงูุฌุง ุจู ูพุงุฑุงูุชุฑ ุณุงุฒูุฏู ุงููู ุงุดุงุฑู ุฏุงุฑุฏุ ูู ุจู property.**

---

### ุฑฺฉูุฑุฏูุง struct ู ุจุงุฒุชุนุฑู property ุจู ุนููุงู field ๐งฑ

ุจุง **record struct**ุ ูุงููู ุงุณุช ฺฉู property ุฑุง ุจู ุนููุงู **field** ุจุงุฒุชุนุฑู ฺฉูุฏ:

```csharp
record struct Student(string ID)
{
    public string ID = ID;
}
```

ุทุจู **ูุนูุง ุณุงุฒูุฏูโูุง ุงููู ุฏุฑ ฺฉูุงุณโูุง ู structูุง**ุ ูพุงุฑุงูุชุฑูุง ุณุงุฒูุฏู ุงููู (ูุซู IDุ LastName ู GivenName) **ุจูโุทูุฑ ุฌุงุฏู ุฏุฑ ุชูุงู initializerูุง field ู property ูุงุจู ุฏุณุชุฑุณ ูุณุชูุฏ**. ูุซุงู:

```csharp
record Student(string ID, string LastName, string FirstName)
{
    public string ID { get; } = ID;
    readonly int _enrollmentYear = int.Parse(ID.Substring(0, 4));
}
```

ุฏุฑ ุงู ูุซุงูุ `_enrollmentYear` ุงุฒ ฺูุงุฑ ุฑูู ุงูู **ID** ูุญุงุณุจู ุดุฏู ุงุณุช. ฺูู property **ID read-only** ุงุณุชุ ูโุชูุงู ุขู ุฑุง ุงูู ุฏุฑ ฺฉ **field read-only** ุฐุฎุฑู ฺฉุฑุฏุ ุจุฏูู ุงูฺฉู ุชุบุฑ ุบุฑูุฎุฑุจ ูุดฺฉู ุงุฌุงุฏ ฺฉูุฏ.

โ๏ธ ุงูุง ุฏุฑ ุฏูุง ูุงูุนุ ุจุฏูู **ุณุงุฒูุฏู ุตุฑุญ**ุ ูฺ ูฺฉุงู ูุฑฺฉุฒ ุจุฑุง ุงุนุชุจุงุฑุณูุฌ ID ู ูพุฑุชุงุจ **exception ูุนูโุฏุงุฑ** ูุฌูุฏ ูุฏุงุฑุฏ.

---

### ุงุนุชุจุงุฑุณูุฌ ุจุง init-only accessors โ

ุจุฑุง ุงูุฌุงู **ุงุนุชุจุงุฑุณูุฌ** ุฑู propertyูุงุ ุจุงุฏ ุงุฒ **init-only accessor ุตุฑุญ** ุงุณุชูุงุฏู ฺฉูุฏ:

```csharp
record Person(string Name)
{
    string _name = Name;
    public string Name
    {
        get => _name;
        init => _name = value ?? throw new ArgumentNullException("Name");
    }
}
```

โ๏ธ ฺูู **Name ฺฉ property ุงุชููุงุชฺฉ ูุณุช**ุ ููโุชูุงู initializer ุชุนุฑู ฺฉุฑุฏ. ุจูุชุฑู ฺฉุงุฑ ุงู ุงุณุช ฺฉู initializer ุฑุง ุฑู **field ูพุดุช property** ูุฑุงุฑ ุฏูุฏุ ุงูุง ุงู ุจุงุนุซ ูโุดูุฏ ฺฉู **check null ูุงุฏุฏู ฺฏุฑูุชู ุดูุฏ**:

```csharp
var p = new Person(null);    // ููููุชโุขูุฒ! (check ูุงุฏุฏู ฺฏุฑูุชู ุดุฏ)
```

ูุดฺฉู ุงุตู ุงู ุงุณุช ฺฉู **ููโุชูุงู ุจุฏูู ููุดุชู ุณุงุฒูุฏูุ ูพุงุฑุงูุชุฑ ุณุงุฒูุฏู ุงููู ุฑุง ุจู property ุงุฎุชุตุงุต ุฏุงุฏ**. ุฑุงูโุญู ุณุงุฏู ุงู ุงุณุช ฺฉู **ูุณุช ูพุงุฑุงูุชุฑ ุฑุง ุญุฐู ฺฉุฑุฏู ู ฺฉ ุณุงุฒูุฏู ูุนููู ุจููุณุฏ**:

```csharp
record Person
{
    public Person(string name) => Name = name;  // ุงุฎุชุตุงุต ุจู PROPERTY
    string _name;
    public string Name { get => _name; init => ... }
}
```

---

### ุฑฺฉูุฑุฏูุง ู ููุงุณู ุจุฑุงุจุฑ (Equality) โ๏ธ

ูุงููุฏ **structูุงุ anonymous types ู tuples**ุ ุฑฺฉูุฑุฏูุง **structural equality** ุฑุง ุจู ุตูุฑุช ูพุดโูุฑุถ ุงุฑุงุฆู ูโฺฉููุฏุ ุนู ุฏู ุฑฺฉูุฑุฏ **ุจุฑุงุจุฑูุฏ ุงฺฏุฑ ููุฏูุง ู propertyูุง ุงุชููุงุชฺฉ ุขููุง ุจุฑุงุจุฑ ุจุงุดูุฏ**:

```csharp
var p1 = new Point(1,2);
var p2 = new Point(1,2);
Console.WriteLine(p1.Equals(p2));   // True

record Point(double X, double Y);
```

ุนููฺฏุฑ **==** ูุฒ ุจุง ุฑฺฉูุฑุฏูุง ฺฉุงุฑ ูโฺฉูุฏ (ูุงููุฏ tuples):

```csharp
Console.WriteLine(p1 == p2);         // True
```

โ๏ธ ุงุฌุฑุง ูพุดโูุฑุถ ุจุฑุงุจุฑ ุจุฑุง ุฑฺฉูุฑุฏูุง ููฺฉู ุงุณุช ุขุณุจโูพุฐุฑ ุจุงุดุฏุ ุจูโุฎุตูุต ุงฺฏุฑ ุฑฺฉูุฑุฏ ุญุงู **ููุงุฏุฑ lazyุ transientุ ุขุฑุงูโูุง ุง collectionูุง** ุจุงุดุฏ ฺฉู ูุงุฒ ุจู ูุฏุฑุช ูฺู ุจุฑุง ููุงุณู ุฏุงุฑูุฏ. ุฎูุดุจุฎุชุงููุ ุงุตูุงุญ ุขู ูุณุจุชุงู ุณุงุฏู ุงุณุช ู ูุงุฒ ุจู ฺฉุงุฑ ุฒุงุฏ ูุฏุงุฑุฏ.

---

### ููุดุชู Equals ุณูุงุฑุด ๐๏ธ

ุจุฑ ุฎูุงู ฺฉูุงุณโูุง ู structูุงุ **ููโุชูุงูุฏ object.Equals ุฑุง override ฺฉูุฏ**ุ ุฏุฑ ุนูุถ ุจุงุฏ ฺฉ ูุชุฏ **public Equals** ุจุง ุงู **ุงูุถุง** ุชุนุฑู ฺฉูุฏ:

```csharp
record Point(double X, double Y)
{
    double _someOtherField;
    public virtual bool Equals(Point other) =>
        other != null && X == other.X && Y == other.Y;
}
```

+ ูุชุฏ **Equals** ุจุงุฏ **virtual** ุจุงุดุฏุ ูู override.
+ ููุน ูพุงุฑุงูุชุฑ ุจุงุฏ **ููุน ุฑฺฉูุฑุฏ ูุงูุน** ุจุงุดุฏ (ุฏุฑ ุงู ูุซุงู Pointุ ูู object).
+ ููุช ุงูุถุง ุฏุฑุณุช ุจุงุดุฏุ ฺฉุงููพุงูุฑ ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ูุชุฏ ุดูุง ุฑุง patch ูโฺฉูุฏ.

ุฏุฑ ูุซุงู ุจุงูุงุ ููุทู ุจุฑุงุจุฑ ุฑุง ุชุบุฑ ุฏุงุฏู ุชุง ููุท **X ู Y** ููุงุณู ุดููุฏ ู `_someOtherField` ูุงุฏุฏู ฺฏุฑูุชู ุดูุฏ.

ุงฺฏุฑ ุฑฺฉูุฑุฏ ุฏฺฏุฑ ุฑุง **subclass** ฺฉูุฏุ ูโุชูุงูุฏ **base.Equals** ุฑุง ูุฑุงุฎูุงู ฺฉูุฏ:

```csharp
public virtual bool Equals(Point other) => base.Equals(other) && ...
```

โ ูฺฉุชู ููู: ุงฺฏุฑ ููุทู ุจุฑุงุจุฑ ุฑุง ุฎูุฏุชุงู ูพุงุฏู ฺฉูุฏุ ุจุงุฏ **GetHashCode** ุฑุง ูุฒ override ฺฉูุฏ. ุฎูุดุจุฎุชุงูู ุฏุฑ ุฑฺฉูุฑุฏูุง ูุงุฒ ุจู overload ฺฉุฑุฏู **!= ุง ==** ู ูพุงุฏูโุณุงุฒ **IEquatable<T>** ูุณุชุ ููู ุงูโูุง ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ุงูุฌุงู ูโุดูุฏ.

ููุถูุน **ููุงุณู ุจุฑุงุจุฑ ุฑฺฉูุฑุฏูุง** ุจู ุตูุฑุช ฺฉุงูู ุฏุฑ ุจุฎุด ยซEquality Comparisonยป ุตูุญู 344 ูพูุดุด ุฏุงุฏู ุดุฏู ุงุณุช.

### ุงูฺฏููุง (Patterns) ๐งฉโจ

ุฏุฑ ูุตู ณุ ูุดุงู ุฏุงุฏู ฺฉู ฺฺฏููู ูโุชูุงู ุงุฒ ุนููฺฏุฑ **is** ุจุฑุง ุจุฑุฑุณ ููููุช **ุชุจุฏู ูุฑุฌุน (reference conversion)** ุงุณุชูุงุฏู ฺฉุฑุฏ:

```csharp
if (obj is string)
    Console.WriteLine(((string)obj).Length);
```

ุง ุจู ุดฺฉู ฺฉูุชุงูโุชุฑ:

```csharp
if (obj is string s)
    Console.WriteLine(s.Length);
```

ุงู ุฑูุด ฺฉูุชุงูุ ฺฉ ุงุฒ **ุงูฺฏููุง (type pattern)** ุฑุง ุจู ฺฉุงุฑ ูโฺฏุฑุฏ. ุนููฺฏุฑ **is** ููฺูู ุงุฒ ุงูฺฏููุง ุฏฺฏุฑ ูพุดุชุจุงู ูโฺฉูุฏ ฺฉู ุฏุฑ ูุณุฎูโูุง ุงุฎุฑ C# ูุนุฑู ุดุฏูโุงูุฏุ ูุงููุฏ **property pattern**:

```csharp
if (obj is string { Length: 4 })
    Console.WriteLine("A string with 4 characters");
```

ุงูฺฏููุง ุฏุฑ ุฒูููโูุง ุฒุฑ ูพุดุชุจุงู ูโุดููุฏ:

+ ุจุนุฏ ุงุฒ ุนููฺฏุฑ **is** `(variable is pattern)`
+ ุฏุฑ **switch statements**
+ ุฏุฑ **switch expressions**

ูุง ูุจูุงู **type pattern** (ู ุจู ุทูุฑ ุฎูุงุตูุ **tuple pattern**) ุฑุง ุฏุฑ ุจุฎุดโูุง ยซSwitching on typesยป ุตูุญู 89 ู ยซThe is operatorยป ุตูุญู 130 ูพูุดุด ุฏุงุฏูโุงู. ุฏุฑ ุงู ุจุฎุดุ ุงูฺฏููุง ูพุดุฑูุชูโุชุฑ ูุนุฑู ุดุฏู ุฏุฑ ูุณุฎูโูุง ุฌุฏุฏ C# ุฑุง ุจุฑุฑุณ ูโฺฉูู.

ุจุฑุฎ ุงุฒ ุงูฺฏููุง ุชุฎุตุตโุชุฑ ุนูุฏุชุงู ุจุฑุง ุงุณุชูุงุฏู ุฏุฑ **switch statements/expressions** ุทุฑุงุญ ุดุฏูโุงูุฏ ู ูุงุฒ ุจู **when clauses** ุฑุง ฺฉุงูุด ูโุฏููุฏ ู ุงูฺฉุงู ุงุณุชูุงุฏู ุงุฒ **switch** ุฑุง ุฏุฑ ููุงูุน ูุฑุงูู ูโฺฉููุฏ ฺฉู ูุจูุงู ุงูฺฉุงู ุขู ูุจูุฏ.

โ๏ธ ุจู ุงุฏ ุฏุงุดุชู ุจุงุดุฏ ฺฉู ููุดู ูโุชูุงูุฏ **switch expressionูุง ูพฺุฏู** ุฑุง ุจุง **if ุณุงุฏู** ุฌุงฺฏุฒู ฺฉูุฏุ ุง ุฏุฑ ุจุฑุฎ ููุงุฑุฏ ุงุฒ **ุนููฺฏุฑ ุดุฑุท ุณูโุชุง (ternary operator)** ุงุณุชูุงุฏู ฺฉูุฏุ ูุนูููุงู ุจุฏูู ูุงุฒ ุจู ฺฉุฏ ุงุถุงู ุฒุงุฏ.

---

### ุงูฺฏู ุซุงุจุช (Constant Pattern) ๐ข

ุงูฺฏู ุซุงุจุช ุจู ุดูุง ุงูฺฉุงู ูโุฏูุฏ ูุณุชููุงู ุจุง ฺฉ **ุซุงุจุช (constant)** ูุทุงุจูุช ุฏูุฏ ู ููฺฏุงู ฺฉุงุฑ ุจุง ููุน **object** ููุฏ ุงุณุช:

```csharp
void Foo(object obj)
{
    if (obj is 3) ...
}
```

ุงู ุนุจุงุฑุช ุจุง ฺฉุฏ ุฒุฑ ูุนุงุฏู ุงุณุช:

```csharp
obj is int && (int)obj == 3
```

โ๏ธ ฺูู ุงู ฺฉ ุนููฺฏุฑ **static** ุงุณุชุ C# ุงุฌุงุฒู ููโุฏูุฏ ฺฉู ูุณุชููุงู ุจุง **==** ฺฉ object ุฑุง ุจุง ฺฉ constant ููุงุณู ฺฉูุฏุ ุฒุฑุง ฺฉุงููพุงูุฑ ุจุงุฏ ููุนโูุง ุฑุง ุงุฒ ูุจู ุจุฏุงูุฏ.

ุจู ุชููุงุ ุงู ุงูฺฏู ฺฉุงุฑุจุฑุฏ ูุญุฏูุฏ ุฏุงุฑุฏุ ุฒุฑุง ุฌุงฺฏุฒู ููุทู ุขู ุงู ุงุณุช:

```csharp
if (3.Equals(obj)) ...
```

ุจู ุฒูุฏ ุฎูุงูู ุฏุฏ ฺฉู **ุงูฺฏู ุซุงุจุช** ุจุง **pattern combinators** ุจุณุงุฑ ฺฉุงุฑุจุฑุฏโุชุฑ ูโุดูุฏ.

---

### ุงูฺฏููุง ุฑุงุจุทูโุง (Relational Patterns) ๐

ุงุฒ C# 9 ุจู ุจุนุฏุ ูโุชูุงูุฏ ุงุฒ ุนููฺฏุฑูุง `<`, `>`, `<=`, `>=` ุฏุฑ ุงูฺฏููุง ุงุณุชูุงุฏู ฺฉูุฏ:

```csharp
if (x is > 100) Console.WriteLine("x is greater than 100");
```

ุงู ุงูฺฏู ุฏุฑ **switch** ุจุณุงุฑ ููุฏ ูโุดูุฏ:

```csharp
string GetWeightCategory(decimal bmi) => bmi switch
{
    < 18.5m => "underweight",
    < 25m => "normal",
    < 30m => "overweight",
    _ => "obese"
};
```

โ๏ธ ุงูฺฏููุง ุฑุงุจุทูโุง ุญุช ุฒูุงู ฺฉู ูุชุบุฑ ุงุฒ ููุน **object** ุจุงุดุฏ ฺฉุงุฑ ูโฺฉููุฏุ ุงูุง ุจุงุฏ ุฏุฑ ุงุณุชูุงุฏู ุงุฒ **ุซุงุจุชโูุง ุนุฏุฏ** ุจุณุงุฑ ุฏูุช ฺฉูุฏ:

```csharp
object obj = 2m;                  // obj ุงุฒ ููุน decimal ุงุณุช
Console.WriteLine(obj is < 3m);   // True
Console.WriteLine(obj is < 3);    // False
```

---

### ุชุฑฺฉุจโฺฉููุฏูโูุง ุงูฺฏู (Pattern Combinators) ๐

ุงุฒ C# 9 ุจู ุจุนุฏุ ูโุชูุงูุฏ ุงุฒ ฺฉูุฏูุงฺูโูุง **and, or, not** ุจุฑุง ุชุฑฺฉุจ ุงูฺฏููุง ุงุณุชูุงุฏู ฺฉูุฏ:

```csharp
bool IsJanetOrJohn(string name) => name.ToUpper() is "JANET" or "JOHN";
bool IsVowel(char c) => c is 'a' or 'e' or 'i' or 'o' or 'u';
bool Between1And9(int n) => n is >= 1 and <= 9;
bool IsLetter(char c) => c is >= 'a' and <= 'z' or >= 'A' and <= 'Z';
```

+ ูุงููุฏ ุนููฺฏุฑูุง `&&` ู `||`ุ **and** ุงูููุช ุจุงูุงุชุฑ ูุณุจุช ุจู **or** ุฏุงุฑุฏ ู ูโุชูุงู ุจุง ูพุฑุงูุชุฒ ุงู ุชุฑุชุจ ุฑุง ุชุบุฑ ุฏุงุฏ.

ฺฉ ุชุฑููุฏ ููุฏ ุงู ุงุณุช ฺฉู **not combinator** ุฑุง ุจุง **type pattern** ุชุฑฺฉุจ ฺฉูุฏ ุชุง ุจุฑุฑุณ ฺฉูุฏ ุขุง ฺฉ object **ุงุฒ ููุน ุฎุงุต ูุณุช**:

```csharp
if (obj is not string) ...
```

ุงู ุญุงูุช ุฒุจุงุชุฑ ุงุฒ ููุดุชู ุฒุฑ ุงุณุช:

```csharp
if (!(obj is string)) ...
```

### ุงูฺฏู `var` ๐ข

ุงูฺฏู **var** ููุน **type pattern** ุงุณุช ฺฉู ุฏุฑ ุขู ุจู ุฌุง ูุงู ููุนุ ุงุฒ ฺฉููู ฺฉูุฏ **var** ุงุณุชูุงุฏู ูโฺฉูุฏ. ุงู ุชุจุฏู ููุดู ูููู ุงุณุช ู ูุฏู ุขู ููุท **ุงูฺฉุงู ุงุณุชูุงุฏู ูุฌุฏุฏ ุงุฒ ูุชุบุฑ ุงุณุช ฺฉู ูพุณ ุงุฒ ุขู ูโุขุฏ**:

```csharp
bool IsJanetOrJohn(string name) => 
    name.ToUpper() is var upper && (upper == "JANET" || upper == "JOHN");
```

ุงู ูุนุงุฏู ฺฉุฏ ุฒุฑ ุงุณุช:

```csharp
bool IsJanetOrJohn(string name)
{
    string upper = name.ToUpper();
    return upper == "JANET" || upper == "JOHN";
}
```

๐ก ุชูุงูุง **ูุนุฑู ู ุงุณุชูุงุฏู ูุฌุฏุฏ ฺฉ ูุชุบุฑ ูุงู** (ูุซู `upper`) ุฏุฑ ฺฉ ูุชุฏ ุจุง **expression-bodied** ุจุณุงุฑ ฺฉุงุฑุจุฑุฏ ุงุณุชุ ุจู ูฺู ุฏุฑ **lambda expressions**.
โ๏ธ ูุชุฃุณูุงููุ ุงู ุงูฺฏู ุนูุฏุชุงู ุฒูุงู ููุฏ ุงุณุช ฺฉู ูุชุฏ ููุฑุฏ ูุธุฑ **ููุน ุจุงุฒฺฏุดุช bool** ุฏุงุดุชู ุจุงุดุฏ.

---

### ุงูฺฏููุง Tuple ู Positional ๐ฆ

**Tuple pattern** (ูุนุฑูโุดุฏู ุฏุฑ C# 8) ุจุฑุง ูุทุงุจูุช ุจุง **tuples** ุงุณุชูุงุฏู ูโุดูุฏ:

```csharp
var p = (2, 3);
Console.WriteLine(p is (2, 3));  // True
```

ูโุชูุงูุฏ ุงุฒ ุขู ุจุฑุง **switch** ุฑู ฺูุฏ ููุฏุงุฑ ุงุณุชูุงุฏู ฺฉูุฏ:

```csharp
int AverageCelsiusTemperature(Season season, bool daytime) =>
    (season, daytime) switch
    {
        (Season.Spring, true) => 20,
        (Season.Spring, false) => 16,
        (Season.Summer, true) => 27,
        (Season.Summer, false) => 22,
        (Season.Fall, true) => 18,
        (Season.Fall, false) => 12,
        (Season.Winter, true) => 10,
        (Season.Winter, false) => -2,
        _ => throw new Exception("Unexpected combination")
    };

enum Season { Spring, Summer, Fall, Winter };
```

โก **Tuple pattern** ุฏุฑ ูุงูุน ฺฉ **ุญุงูุช ูฺู ุงุฒ positional pattern** ุงุณุช (C# 8+) ฺฉู ุจุง ูุฑ ููุน ฺฉู ูุชุฏ **Deconstruct** ุงุฑุงุฆู ุฏูุฏุ ฺฉุงุฑ ูโฺฉูุฏ.

ูุซุงู ุจุง **record Point** ู **deconstructor ุชููุฏ ุดุฏู ุชูุณุท ฺฉุงููพุงูุฑ**:

```csharp
var p = new Point(2, 2);
Console.WriteLine(p is (2, 2));  // True
record Point(int X, int Y);      // ุฏุงุฑุง deconstructor ุชููุฏ ุดุฏู ุชูุณุท ฺฉุงููพุงูุฑ
```

ูโุชูุงูุฏ ููฺฏุงู **match**ุ ูุชุบุฑูุง ุฑุง **deconstruct** ฺฉูุฏ:

```csharp
Console.WriteLine(p is (var x, var y) && x == y);  // True
```

ูุซุงู **switch expression** ฺฉู **type pattern** ุฑุง ุจุง **positional pattern** ุชุฑฺฉุจ ูโฺฉูุฏ:

```csharp
string Print(object obj) => obj switch 
{
    Point(0, 0) => "Empty point",
    Point(var x, var y) when x == y => "Diagonal",
    ...
};
```

---

### ุงูฺฏููุง Property ๐ท๏ธ

**Property pattern** (C# 8+) ุจุฑ ุงุณุงุณ ฺฉ ุง ฺูุฏ **ููุฏุงุฑ property** ฺฉ object ูุทุงุจูุช ูโุฏูุฏ.
ูุซุงู ุณุงุฏู ูุจูุงู ุจุง **is operator** ุฏุงุดุชู:

```csharp
if (obj is string { Length:4 }) ...
```

โ๏ธ ุงู ุชููุง ฺฉู ุงุฒ ููุดุชู ฺฉุฏ ุฒุฑ ุตุฑููโุฌู ูโฺฉูุฏ:

```csharp
if (obj is string s && s.Length == 4) ...
```

ุจุง **switch statements** ู **expressions**ุ property patterns ฺฉุงุฑุจุฑุฏ ุจุดุชุฑ ูพุฏุง ูโฺฉููุฏ.

ูุซุงู ุจุง ฺฉูุงุณ **System.Uri**:

```csharp
bool ShouldAllow(Uri uri) => uri switch
{
    { Scheme: "http",  Port: 80  } => true,
    { Scheme: "https", Port: 443 } => true,
    { Scheme: "ftp",   Port: 21  } => true,
    { IsLoopback: true } => true,
    _ => false
};
```

ูโุชูุงูุฏ **propertyูุง ุฑุง ุชู ุฏุฑ ุชู (nested)** ฺฉูุฏุ ฺฉู ุงุฒ C# 10 ุจู ุจุนุฏ ูโุชูุงู ุณุงุฏูโุณุงุฒ ฺฉุฑุฏ:

```csharp
{ Scheme.Length: 4, Port: 80 } => true,
```

ููฺูู ูโุชูุงู ุงุฒ **ุงูฺฏููุง ุฏฺฏุฑ ุฏุงุฎู property patterns** ุงุณุชูุงุฏู ฺฉุฑุฏุ ูุซู **relational patterns**:

```csharp
{ Host: { Length: < 1000 }, Port: > 0 } => true,
```

ุดุฑุงุท ูพฺุฏูโุชุฑ ุฑุง ูโุชูุงู ุจุง **when clause** ุจุงู ฺฉุฑุฏ:

```csharp
{ Scheme: "http" } when string.IsNullOrWhiteSpace(uri.Query) => true,
```

ูโุชูุงูุฏ **property pattern ุฑุง ุจุง type pattern ุชุฑฺฉุจ ฺฉูุฏ** ู ูุชุบุฑ ูุนุฑู ฺฉูุฏ:

```csharp
Uri { Scheme: "http", Port: 80 } httpUri => httpUri.Host.Length < 1000,
```

ู ููู ูุชุบุฑ ุฑุง ูโุชูุงู ุฏุฑ **when clause** ุงุณุชูุงุฏู ฺฉุฑุฏ:

```csharp
Uri { Scheme: "http", Port: 80 } httpUri 
    when httpUri.Host.Length < 1000 => true,
```

ูฺฉุชู ุฌุงูุจ: ูโุชูุงู ูุชุบุฑูุง ุฑุง ุฏุฑ ุณุทุญ property ูุฒ ูุนุฑู ฺฉุฑุฏ:

```csharp
{ Scheme: "http", Port: 80, Host: string host } => host.Length < 1000,
```

ุชุงูพ ุถูู ูุฒ ูุฌุงุฒ ุงุณุชุ ุนู ูโุชูุงูุฏ **string** ุฑุง ุจุง **var** ุฌุงฺฏุฒู ฺฉูุฏ:

```csharp
bool ShouldAllow(Uri uri) => uri switch
{
    { Scheme: "http",  Port: 80, Host: var host } => host.Length < 1000,
    { Scheme: "https", Port: 443 } => true,
    { Scheme: "ftp",   Port: 21  } => true,
    { IsLoopback: true } => true,
    _ => false
};
```

โ๏ธ ุฏุฑ ุจุณุงุฑ ุงุฒ ููุงุฑุฏุ ุตุฑููโุฌู ุฏุฑ ุชุนุฏุงุฏ ฺฉุงุฑุงฺฉุชุฑูุง ุฒุงุฏ ูุณุช. ุฌุงฺฏุฒู ุณุงุฏูโุชุฑ ูโุชูุงูุฏ ุงู ุจุงุดุฏ:

```csharp
{ Scheme: "http", Port: 80 } => uri.Host.Length < 1000,
```

ุง:

```csharp
{ Scheme: "http", Port: 80, Host: { Length: < 1000 } } => ...
```

### ุงูฺฏููุง List ๐

**List patterns** (ูุนุฑูโุดุฏู ุฏุฑ C# 11) ุฑู ูุฑ ููุน collection ูุงุจู ุดูุงุฑุด (**Count** ุง **Length**) ู ุจุง **indexer ุนุฏุฏ** ฺฉุงุฑ ูโฺฉููุฏ.

ฺฉ **list pattern** ุจุง ุงุณุชูุงุฏู ุงุฒ ุจุฑุงฺฉุชโูุง `[ ]` ุชุนุฑู ูโุดูุฏ:

```csharp
int[] numbers = { 0, 1, 2, 3, 4 };
Console.Write(numbers is [0, 1, 2, 3, 4]);   // True
```

+ ุนูุงูุช **underscore `_`** ุจุฑุง ูุทุงุจูุช ุจุง ฺฉ ุนูุตุฑ ุจุง ูุฑ ููุฏุงุฑ ุงุณุชูุงุฏู ูโุดูุฏ:

```csharp
Console.Write(numbers is [0, 1, _, _, 4]);   // True
```

+ ูโุชูุงูุฏ ุงุฒ **var pattern** ุจุฑุง ฺฏุฑูุชู ฺฉ ุนูุตุฑ ุงุณุชูุงุฏู ฺฉูุฏ:

```csharp
Console.Write(numbers is [0, 1, var x, 3, 4] && x > 1);   // True
```

+ **ุฏู ููุทู `..`** ุจุฑุง ูุดุฎุต ฺฉุฑุฏู ฺฉ **slice** ุงุณุชูุงุฏู ูโุดูุฏ ฺฉู ุตูุฑ ุง ฺูุฏ ุนูุตุฑ ุฑุง ูุทุงุจูุช ูโุฏูุฏ:

```csharp
Console.Write(numbers is [0, .., 4]);    // True
```

+ ุจุง ุขุฑุงูโูุง ุง ุณุงุฑ ุงููุงุน ฺฉู ุงุฒ **indices ู ranges** ูพุดุชุจุงู ูโฺฉููุฏุ ูโุชูุงู slice ุฑุง ุจุง var pattern ุชุฑฺฉุจ ฺฉุฑุฏ:

```csharp
Console.Write(numbers is [0, .. var mid, 4] && mid.Contains(2)); // True
```

โ๏ธ ฺฉ **list pattern** ูโุชูุงูุฏ ุญุฏุงฺฉุซุฑ ฺฉ slice ุฏุงุดุชู ุจุงุดุฏ.

---

### Attributes ๐ท๏ธ

**Attributes** ูฺฉุงูุฒู **extensible** ุจุฑุง ุงุถุงูู ฺฉุฑุฏู ุงุทูุงุนุงุช **ุณูุงุฑุด** ุจู ุนูุงุตุฑ ฺฉุฏ ูุณุชูุฏ (assemblyุ ููุนุ memberุ return valueุ parameter ู generic type parameters).

+ ุจุฑุง ุชุนุฑู ฺฉ attributeุ ุงุฒ ฺฉ ฺฉูุงุณ ฺฉู ุงุฒ `System.Attribute` ุงุฑุซโุจุฑ ูโฺฉูุฏ ุงุณุชูุงุฏู ูโฺฉูู.
+ ุจุฑุง ุงุนูุงู attributeุ ูุงู ููุน ุขู ุฑุง ุฏุฑ **ุจุฑุงฺฉุชโูุง `[ ]`** ูุจู ุงุฒ ุนูุตุฑ ฺฉุฏ ูุฑุงุฑ ูโุฏูู:

```csharp
[ObsoleteAttribute]
public class Foo {...}
```

โก ุจู ุฏูู ุงูฺฉู convention ุชูุงู attributeูุง ุจุง `Attribute` ุฎุชู ูโุดููุฏุ ูโุชูุงู suffix ุฑุง ุญุฐู ฺฉุฑุฏ:

```csharp
[Obsolete]
public class Foo {...}
```

+ ูพุงุฑุงูุชุฑูุง attribute ุจู ุฏู ุฏุณุชู ุชูุณู ูโุดููุฏ:

  1. **Positional**: ูุฑุจูุท ุจู ูพุงุฑุงูุชุฑูุง public constructor attribute
  2. **Named**: ูุฑุจูุท ุจู ููุฏูุง ุง propertyูุง ุนููู attribute

ูุซุงู ุจุง XmlTypeAttribute:

```csharp
[XmlType("Customer", Namespace="http://oreilly.com")]
public class CustomerEntity { ... }
```

+ **Positional**: `"Customer"`
+ **Named**: `Namespace="http://oreilly.com"`

---

### ุงุนูุงู Attributes ุจู Assembly ู Fieldูุง ๐๏ธ

+ ูโุชูุงู ฺฉ attribute ุฑุง ุจู **assembly** ูุชุตู ฺฉุฑุฏ:

```csharp
[assembly: AssemblyFileVersion("1.2.3.4")]
```

+ ุจุฑุง ุงุนูุงู attribute ุจู **backing field** ฺฉ property ุฎูุฏฺฉุงุฑ:

```csharp
[field:NonSerialized]
public int MyProperty { get; set; }
```

---

### Attributes ุฑู Lambda Expressions โก

ุงุฒ C# 10 ุจู ุจุนุฏุ ูโุชูุงู attributeูุง ุฑุง ุจู **methodุ ูพุงุฑุงูุชุฑูุง ู return value** lambda ุงุถุงูู ฺฉุฑุฏ:

```csharp
Action<int> a = [Description("Method")]
               [return: Description("Return value")]
               ([Description("Parameter")] int x) => Console.Write(x);
```

+ ุงู ูฺฺฏ ุจุฑุง ูุฑููุฑฺฉโูุง ูุซู **ASP.NET** ููุฏ ุงุณุช ู ูุงุฒ ุจู ุชุนุฑู method ุฌุฏุงฺฏุงูู ุฑุง ุงุฒ ุจู ูโุจุฑุฏ.
+ ุจุฑุง ุฏุณุชุฑุณ ุจู ุงู attributeูุง:

```csharp
var methodAtt = a.GetMethodInfo().GetCustomAttributes();
var paramAtt  = a.GetMethodInfo().GetParameters()[0].GetCustomAttributes();
var returnAtt = a.GetMethodInfo().ReturnParameter.GetCustomAttributes();
```

โ๏ธ ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุงุจูุงู ุณูุชฺฉุณุ **ูพุงุฑุงูุชุฑ lambda ููุดู ุจุงุฏ ุฏุงุฎู ูพุฑุงูุชุฒ ุจุงุดุฏ**.
โ ุงุนูุงู attribute ุฑู **expression-tree lambdas** ูุฌุงุฒ ูุณุช.

### ูุดุฎุต ฺฉุฑุฏู ฺูุฏ Attribute ููุฒูุงู ๐ท๏ธ

ูโุชูุงู ฺูุฏ **attribute** ุฑุง ุจู ฺฉ ุนูุตุฑ ฺฉุฏ ูุณุจุช ุฏุงุฏ. ุงู ฺฉุงุฑ ุฑุง ูโุชูุงู ุจู ุณู ุฑูุด ุงูุฌุงู ุฏุงุฏ:

1. ุชูุงู attributeูุง ุฏุฑ ฺฉ ุฌูุช ุจุฑุงฺฉุช `[ ]`ุ ุจุง ฺฉุงูุง ุฌุฏุง ุดุฏู:

```csharp
[Serializable, Obsolete, CLSCompliant(false)]
public class Bar { ... }
```

2. ูุฑ attribute ุฏุฑ ฺฉ ุฌูุช ุจุฑุงฺฉุช ุฌุฏุงฺฏุงูู:

```csharp
[Serializable]
[Obsolete]
[CLSCompliant(false)]
public class Bar { ... }
```

3. ุชุฑฺฉุจ ุงุฒ ุฏู ุฑูุด ุจุงูุง:

```csharp
[Serializable, Obsolete]
[CLSCompliant(false)]
public class Bar { ... }
```

ููู ูุซุงูโูุง ุจุงูุง ุงุฒ ูุธุฑ ูุนูุง **ฺฉุณุงู** ูุณุชูุฏ. โ

---

### Caller Info Attributes ๐

ุณู **attribute ูฺู** ูุฌูุฏ ุฏุงุฑุฏ ฺฉู ูโุชูุงู ูพุงุฑุงูุชุฑูุง ุงุฎุชุงุฑ ุฑุง ุจุง ุขูโูุง ุนูุงูุช ุฒุฏ ุชุง ฺฉุงููพุงูุฑ ุงุทูุงุนุงุช **caller** ุฑุง ุฏุฑ ููุฏุงุฑ ูพุดโูุฑุถ ูพุงุฑุงูุชุฑ ูุฑุงุฑ ุฏูุฏ:

+ `[CallerMemberName]`: ูุงู ุนุถู ูุฑุงุฎูุงููุฏู
+ `[CallerFilePath]`: ูุณุฑ ูุงู ููุจุน ูุฑุงุฎูุงููุฏู
+ `[CallerLineNumber]`: ุดูุงุฑู ุฎุท ูุฑุงุฎูุงููุฏู

ูุซุงู:

```csharp
using System;
using System.Runtime.CompilerServices;

class Program
{
    static void Main() => Foo();

    static void Foo(
        [CallerMemberName] string memberName = null,
        [CallerFilePath] string filePath = null,
        [CallerLineNumber] int lineNumber = 0)
    {
        Console.WriteLine(memberName);
        Console.WriteLine(filePath);
        Console.WriteLine(lineNumber);
    }
}
```

ูุฑุถ ฺฉูุฏ ูุงู ุฏุฑ `c:\source\test\Program.cs` ุงุณุชุ ุฎุฑูุฌ:

```
Main
c:\source\test\Program.cs
6
```

+ ุงู ูฺฺฏ ุจุฑุง **logging** ู **INotifyPropertyChanged** ุจุณุงุฑ ููุฏ ุงุณุช.
+ ูุซุงู ุงุณุชูุงุฏู ุฏุฑ ฺฉูุงุณ ุจุง PropertyChanged:

```csharp
public class Foo : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged = delegate { };

    void RaisePropertyChanged([CallerMemberName] string propertyName = null)
        => PropertyChanged(this, new PropertyChangedEventArgs(propertyName));

    string customerName;
    public string CustomerName
    {
        get => customerName;
        set
        {
            if (value == customerName) return;
            customerName = value;
            RaisePropertyChanged();  // ุชุจุฏู ูโุดูุฏ ุจู: RaisePropertyChanged("CustomerName");
        }
    }
}
```

---

### CallerArgumentExpression (C# 10) โ๏ธ

+ `[CallerArgumentExpression]` ุซุจุช **ุนุจุงุฑุช ูพุงุฑุงูุชุฑ** ุฏุฑ ูุญู ูุฑุงุฎูุงู ุฑุง ููฺฉู ูโฺฉูุฏ.

ูุซุงู:

```csharp
Print(Math.PI * 2);

void Print(double number,
           [CallerArgumentExpression("number")] string expr = null)
    => Console.WriteLine(expr);
// ุฎุฑูุฌ: Math.PI * 2
```

+ ุญุช ฺฉุงููุชโูุง ูู ุฏุฑ ุฑุดุชู ูุฑุงุฑ ูโฺฏุฑูุฏ:

```csharp
Print(Math.PI /*(ฯ)*/ * 2);
// ุฎุฑูุฌ: Math.PI /*(ฯ)*/ * 2
```

ฺฉุงุฑุจุฑุฏ ุงุตู: **ฺฉุชุงุจุฎุงููโูุง validation ู assertion**:

```csharp
Assert(2 + 2 == 5);

void Assert(bool condition,
            [CallerArgumentExpression("condition")] string message = null)
{
    if (!condition) throw new Exception("Assertion failed: " + message);
}
```

+ ููููู ุฏฺฏุฑ: `ArgumentNullException.ThrowIfNull` ุฏุฑ .NET 6:

```csharp
ArgumentNullException.ThrowIfNull(message);
```

โ๏ธ ูโุชูุงู `[CallerArgumentExpression]` ุฑุง ฺูุฏ ุจุงุฑ ุงุณุชูุงุฏู ฺฉุฑุฏ ุชุง ฺูุฏ ุนุจุงุฑุช ูพุงุฑุงูุชุฑ ุซุจุช ุดูุฏ.

---

### Dynamic Binding ๐

+ **Dynamic binding** ุฒูุงู **resolve ฺฉุฑุฏู typeุ member ู operator** ุฑุง ุจู **runtime** ููฺฉูู ูโฺฉูุฏ.
+ ููุฏ ุฏุฑ interoperating ุจุง **dynamic languages** ุง **COM** ู ููฺูู ุฒูุงู ฺฉู ูโุฎูุงูุฏ ุงุฒ **reflection** ุงุณุชูุงุฏู ฺฉูุฏ.

```csharp
dynamic d = GetSomeObject();
d.Quack();  // ฺฉุงููพุงูุฑ ุจุฑุฑุณ ููโฺฉูุฏุ ุงุฌุฑุง ุฏุฑ ุฒูุงู runtime
```

+ ุฏุฑ dynamic bindingุ ฺฉุงููพุงูุฑ **binding** ุฑุง ุจู runtime ูุงฺฏุฐุงุฑ ูโฺฉูุฏุ ุจุฑุฎูุงู **static binding** ฺฉู ุฏุฑ ุฒูุงู ฺฉุงููพุงู ุฑุฎ ูโุฏูุฏ.

### **Static Binding ุฏุฑ ููุงุจู Dynamic Binding โก**

ุฏุฑ C#ุ **binding** ุนู ุงุชุตุงู ูุงู ฺฉ ุนุถู (ูุงููุฏ ูุชุฏ) ุจู ูพุงุฏูโุณุงุฒ ุขู.

---

#### **Static Binding (Binding ุงุณุชุง) ๐๏ธ**

+ ุงุชุตุงู ุฏุฑ **ุฒูุงู ฺฉุงููพุงู** ุงูุฌุงู ูโุดูุฏ.
+ ฺฉุงููพุงูุฑ ุจุงุฏ **ููุน ูุชุบุฑูุง ุฑุง ุจุฏุงูุฏ** ุชุง ุจุชูุงูุฏ ูุชุฏูุง ุง ุนููฺฏุฑูุง ุฑุง ูพุฏุง ฺฉูุฏ.
+ ูุซุงู:

```csharp
Duck d = new Duck();
d.Quack();  // ฺฉุงููพุงูุฑ ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ฺฉูุงุณ Duck ูุชุฏ Quack ุฏุงุฑุฏ ุง ุฎุฑ
```

+ ุงฺฏุฑ ููุน ูุชุบุฑ `object` ุจุงุดุฏุ ุฏุณุชุฑุณ ุจู ูุชุฏ ูุงูููู ุฎูุงูุฏ ุจูุฏ:

```csharp
object d = new Duck();
d.Quack();  // ุฎุทุง ฺฉุงููพุงู
```

---

#### **Dynamic Binding (Binding ูพูุง) ๐**

+ ุงุชุตุงู ุฏุฑ **ุฒูุงู ุงุฌุฑุง (runtime)** ุงูุฌุงู ูโุดูุฏ.
+ ููุน ูุชุบุฑ `dynamic` ุงุณุช ู ฺฉุงููพุงูุฑ ูุฑุถ ูโฺฉูุฏ **ููฺฉู ุงุณุช ูุชุฏ ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ**:

```csharp
dynamic d = new Duck();
d.Quack();  // ุจุฑุฑุณ ู ุงุชุตุงู ุฏุฑ ุฒูุงู ุงุฌุฑุง ุงูุฌุงู ูโุดูุฏ
```

+ ุงฺฏุฑ ููุน ูุงูุน ูุชุบุฑ ูุชุฏ ูุฏุงุดุชู ุจุงุดุฏุ **RuntimeBinderException** ูพุฑุชุงุจ ูโุดูุฏ:

```csharp
dynamic d = 5;
d.Hello();  // RuntimeBinderException
```

---

#### **ุงููุงุน Dynamic Binding**

1. **Custom Binding** ๐ง

   + ุฒูุงู ฺฉู ุดุก dynamicุ ุงูุชุฑูุณ `IDynamicMetaObjectProvider` ุฑุง ูพุงุฏูโุณุงุฒ ฺฉูุฏ.
   + ุจุฑุง ฺฉูุชุฑู ุฑูุชุงุฑ ูุชุฏูุง ุฏุฑ ุฒุจุงูโูุง ุฏุงูุงูฺฉ ูุซู IronPython ุง IronRuby ุงุณุชูุงุฏู ูโุดูุฏ.
   + ูุซุงู:

```csharp
using System;
using System.Dynamic;

dynamic d = new Duck();
d.Quack();  // "Quack method was called"
d.Waddle(); // "Waddle method was called"

public class Duck : DynamicObject
{
    public override bool TryInvokeMember(InvokeMemberBinder binder, object[] args, out object result)
    {
        Console.WriteLine(binder.Name + " method was called");
        result = null;
        return true;
    }
}
```

2. **Language Binding** ๐

   + ุฒูุงู ฺฉู ุดุก dynamicุ `IDynamicMetaObjectProvider` ุฑุง ูพุงุฏูโุณุงุฒ ูฺฉูุฏ.
   + ููุฏ ุจุฑุง ุฏูุฑ ุฒุฏู ูุญุฏูุฏุชโูุง ุณุณุชู ููุน .NET ู ุงุฌุชูุงุจ ุงุฒ ฺฉูพ ฺฉุฏ ุจุฑุง ูุฑ ููุน ุฏุงุฏู.
   + ูุซุงู ูุญุงุณุจู ูุงูฺฏู:

```csharp
int x = 3, y = 4;
Console.WriteLine(Mean(x, y));
dynamic Mean(dynamic a, dynamic b) => (a + b) / 2;
```

โ๏ธ **ูฺฉุชู:** ุฏุฑ dynamic bindingุ ุงููุช ููุน **compile-time** ุงุฒ ุจู ูโุฑูุฏุ ูู ุงููุช ููุน **runtime** ุญูุธ ูโุดูุฏ.

---

#### **ููุงุด Runtime ุดุก dynamic**

```csharp
dynamic x = "hello";
Console.WriteLine(x.GetType().Name);  // String
x = 123;
Console.WriteLine(x.GetType().Name);  // Int32
```

+ `dynamic` ุงุฒ ูุธุฑ ุณุงุฎุชุงุฑ ุจุง `object` ฺฉุณุงู ุงุณุชุ ููุท ุงุฌุงุฒู ุนููุงุช ุฏุงูุงูฺฉ ูโุฏูุฏ.

```csharp
object o = new System.Text.StringBuilder();
dynamic d = o;
d.Append("hello");
Console.WriteLine(o);  // hello
```

+ ุฏุฑ runtimeุ ุงุนุถุง dynamic ุจุง Attribute ูุดุฎุต ูโุดููุฏ:

```csharp
public class Test
{
    public dynamic Foo;
}
// ูุนุงุฏู ุจุง:
public class Test
{
    [System.Runtime.CompilerServices.DynamicAttribute]
    public object Foo;
}
```

---

#### **ุชุจุฏูโูุง Dynamic ๐**

+ dynamic ูุงุจูุช ุชุจุฏู ุถูู ุจุง ููู ููุนโูุง ุฑุง ุฏุงุฑุฏ:

```csharp
int i = 7;
dynamic d = i;
long j = d;   // ุจุฏูู ูุงุฒ ุจู cast
```

+ ุงฺฏุฑ ุชุจุฏู ุถูู ููฺฉู ูุจุงุดุฏุ **RuntimeBinderException** ูพุฑุชุงุจ ูโุดูุฏ:

```csharp
short k = d;  // RuntimeBinderException
```

---

#### **ููุงุณู var ู dynamic**

| ูฺฺฏ          | `var`                      | `dynamic`                    |
| -------------- | -------------------------- | ---------------------------- |
| ุฒูุงู ุชุนู ููุน | Compile-time               | Runtime                      |
| ูุซุงู           | `var y = "hello";`         | `dynamic x = "hello";`       |
| ุฑูุชุงุฑ ุงูุชุณุงุจ   | ุฎุทุง ฺฉุงููพุงู ุฏุฑ ููุน ูุงุฏุฑุณุช | ุฎุทุง ุฒูุงู ุงุฌุฑุง ุฏุฑ ููุน ูุงุฏุฑุณุช |

ูุซุงู:

```csharp
dynamic x = "hello";
var y = x;        // y ูุฒ dynamic ุงุณุช
int z = y;        // Runtime error
```

+ `var` ูโฺฏูุฏ: "ุจฺฏุฐุงุฑ ููุน ุชูุณุท ฺฉุงููพุงูุฑ ูุดุฎุต ุดูุฏ"
+ `dynamic` ูโฺฏูุฏ: "ุจฺฏุฐุงุฑ ููุน ุชูุณุท runtime ูุดุฎุต ุดูุฏ"

### **Dynamic Expressions ุฏุฑ C# ๐**

ุฏุฑ C#ุ ุชูุฑุจุง ููู ุงุนุถุง ฺฉ ุดุก (fields, properties, methods, events, constructors, indexers, operators ู conversions) ุฑุง ูโุชูุงู **ุจู ุตูุฑุช ุฏุงูุงูฺฉ** ูุฑุงุฎูุงู ฺฉุฑุฏ.

---

#### **ูุชุฌู ูุชุฏูุง void**

+ ููโุชูุงูุฏ ูุชุฌู ฺฉ **ุนุจุงุฑุช dynamic ุจุง ููุน ุจุงุฒฺฏุดุช void** ุฑุง ูุตุฑู ฺฉูุฏ.
+ ุชูุงูุช ุจุง static typing: ุฎุทุง **ุฏุฑ ุฒูุงู ุงุฌุฑุง** ุฑุฎ ูโุฏูุฏ:

```csharp
dynamic list = new List<int>();
var result = list.Add(5);  // RuntimeBinderException
```

---

#### **ุชุฃุซุฑ cascading dynamic**

+ ูุฑ ุนุจุงุฑุช ฺฉู ุดุงูู **ุนููููุฏ dynamic** ุจุงุดุฏุ ูุนูููุง ุฎูุฏุด dynamic ุฎูุงูุฏ ุจูุฏ:

```csharp
dynamic x = 2;
var y = x * 3;  // ููุน static y: dynamic
```

+ ุงุณุชุซูุงูุง:

  1. **ฺฉุณุช ุจู ููุน static**:

```csharp
dynamic x = 2;
var y = (int)x;  // y ุงุฒ ููุน int
```

2. **ุตุฏุง ุฒุฏู constructor** ููุดู static ุงุณุช:

```csharp
dynamic capacity = 10;
var sb = new System.Text.StringBuilder(capacity);  // sb ุงุฒ ููุน StringBuilder
```

---

### **Dynamic Calls ุจุฏูู Dynamic Receiver**

+ ูุนูููโุชุฑู ุญุงูุชุ **receiver ุฏุงูุงูฺฉ** ุงุณุช:

```csharp
dynamic x = ...;
x.Foo();  // x receiver ุงุณุช
```

+ ุงูุง ูโุชูุงู **ูุชุฏูุง statically known** ุฑุง ุจุง ุขุฑฺฏููุงูโูุง dynamic ูุฑุงุฎูุงู ฺฉุฑุฏ.
+ ูุซุงู ุจุง overload resolution:

```csharp
class Program
{
    static void Foo(int x) => Console.WriteLine("int");
    static void Foo(string x) => Console.WriteLine("string");

    static void Main()
    {
        dynamic x = 5;
        dynamic y = "watermelon";
        Foo(x);  // int
        Foo(y);  // string
    }
}
```

+ ุงฺฏุฑ ูุงู ูุชุฏ ุง ุชุนุฏุงุฏ ูพุงุฑุงูุชุฑูุง ุฏุฑุณุช ูุจุงุดุฏุ **ุฎุทุง ฺฉุงููพุงู** ุฏุฑุงูุช ูโฺฉูู.

---

### **ุงุณุชูุงุฏู ุงุฒ Static Types ุฏุฑ Dynamic Binding**

+ ุญุช ุฏุฑ binding ุฏุงูุงูฺฉุ ุงฺฏุฑ ุจุฑุฎ ุขุฑฺฏููุงูโูุง **static type ูุดุฎุต** ุฏุงุดุชู ุจุงุดูุฏุ ุงุณุชูุงุฏู ูโุดูุฏ:

```csharp
class Program
{
    static void Foo(object x, object y) { Console.WriteLine("oo"); }
    static void Foo(object x, string y) { Console.WriteLine("os"); }
    static void Foo(string x, object y) { Console.WriteLine("so"); }
    static void Foo(string x, string y) { Console.WriteLine("ss"); }

    static void Main()
    {
        object o = "hello";
        dynamic d = "goodbye";
        Foo(o, d);  // os
    }
}
```

---

### **ุชูุงุจุน ุบุฑูุงุจู ูุฑุงุฎูุงู Dynamically โ**

+ ุจุฑุฎ ุชูุงุจุน ููโุชูุงููุฏ ุจุง dynamic ูุฑุงุฎูุงู ุดููุฏ:

  1. **Extension methods** (ุจุง syntax extension)
  2. **ุงุนุถุง interface** ุฏุฑ ุตูุฑุช ฺฉู ูุงุฒ ุจู cast ุจู ุขู interface ุจุงุดุฏ
  3. **Base members ฺฉู ุชูุณุท subclass ูพููุงู ุดุฏูโุงูุฏ**

+ ุฏูู: dynamic binding ููุท ุจู **ูุงู ูุชุฏ ู receiver** ูุงุฒ ุฏุงุฑุฏุ ุงูุง ุฏุฑ ุงู ุณู ููุฑุฏุ **ููุน ุงุถุงู compile-time-only** ูุฒ ุฏุฎู ุงุณุช ู ุฏุฑ runtime ููุฌูุฏ ูุณุช.

---

#### **ูุซุงู: ูุฑุงุฎูุงู ุนุถู Interface ุจุง dynamic**

```csharp
interface IFoo { void Test(); }
class Foo : IFoo { void IFoo.Test() {} }

IFoo f = new Foo();
dynamic d = f;
d.Test();  // Runtime exception
```

+ cast ุจู interface ุฏุฑ ุฒูุงู ฺฉุงููพุงู ูุดุฎุต ูโฺฉูุฏ ฺฉู binding ุจุงุฏ ุฑู IFoo ุงูุฌุงู ุดูุฏุ ุงูุง ุฏุฑ runtime ุงู ุงุทูุงุนุงุช ุงุฒ ุฏุณุช ูโุฑูุฏ.

---

#### **ุฑุงูฺฉุงุฑ: ฺฉุชุงุจุฎุงูู Uncapsulator โก**

+ ฺฉุชุงุจุฎุงูู open-source ุจุฑุง **dynamic ุจูุชุฑ**ุ ุญู ูุดฺฉู ูุฑุงุฎูุงู ุงุนุถุง interfaceุ base types ู static members ุจู ุตูุฑุช ุฏุงูุงูฺฉ.
+ ูุซุงู:

```csharp
IFoo f = new Foo();
dynamic uf = f.Uncapsulate();
uf.Test();  // ุญุงูุง ฺฉุงุฑ ูโฺฉูุฏ
```

+ ูุงุจูุชโูุง Uncapsulator:

  + Cast ุจู base types ู interfaces
  + ูุฑุงุฎูุงู static members ุจู ุตูุฑุช ุฏุงูุงูฺฉ
  + ุฏุณุชุฑุณ ุจู ุงุนุถุง ุบุฑ ุนููู (nonpublic members)

### ุจุงุฑฺฏุฐุงุฑ ูุฌุฏุฏ ุนููฺฏุฑูุง (Operator Overloading) โ๏ธ

ุดูุง ูโุชูุงูุฏ ุนููฺฏุฑูุง ุฑุง ุจุงุฑฺฏุฐุงุฑ ูุฌุฏุฏ ฺฉูุฏ ุชุง ูุญู (syntax) ุทุจุนโุชุฑ ุจุฑุง ููุนโูุง ุณูุงุฑุด ูุฑุงูู ุดูุฏ. ุจุงุฑฺฏุฐุงุฑ ูุฌุฏุฏ ุนููฺฏุฑูุง ุจุดุชุฑ ุจุฑุง ูพุงุฏูโุณุงุฒ `struct`ูุง ุณูุงุฑุด ฺฉู ููุงุงูฺฏุฑ ููุนโูุง ุฏุงุฏูโุง ูุณุจุชุงู ุงุจุชุฏุง ูุณุชูุฏุ ููุงุณุจ ุงุณุช. ุจูโุนููุงู ูุซุงูุ ฺฉ ููุน ุนุฏุฏ ุณูุงุฑุด ฺฏุฒููโ ุจุณุงุฑ ููุงุณุจ ุจุฑุง ุจุงุฑฺฏุฐุงุฑ ูุฌุฏุฏ ุนููฺฏุฑูุง ุงุณุช.

ุนููฺฏุฑูุง ููุงุฏู ุฒุฑ ูุงุจู ุจุงุฑฺฏุฐุงุฑ ูุฌุฏุฏ ูุณุชูุฏ:

```
+ (unary) - (unary) ! ห ++ --
+ % >>
>= & == <= * / | ^ << != > < 
```

ุนููฺฏุฑูุง ุฒุฑ ูุฒ ูุงุจู ุจุงุฑฺฏุฐุงุฑ ูุฌุฏุฏ ูุณุชูุฏ:

+ ุชุจุฏูโูุง ุถูู ู ุตุฑุญ (ุจุง ฺฉููุงุช ฺฉูุฏ `implicit` ู `explicit`)
+ ุนููฺฏุฑูุง `true` ู `false` (ูู ููุงุฏุฑ ุซุงุจุช)

ุนููฺฏุฑูุง ุฒุฑ ุจูโุตูุฑุช ุบุฑูุณุชูู ุจุงุฑฺฏุฐุงุฑ ูโุดููุฏ:

+ ุนููฺฏุฑูุง ุชุฑฺฉุจ (`+=, /=` ู ุบุฑู) ุจูโุทูุฑ ุถูู ุจุง ุจุงุฒููุณ ุนููฺฏุฑูุง ุบุฑุชุฑฺฉุจ (`+, /`) ุจุงุฒููุณ ูโุดููุฏ.
+ ุนููฺฏุฑูุง ุดุฑุท `&&` ู `||` ุจูโุทูุฑ ุถูู ุจุง ุจุงุฒููุณ ุนููฺฏุฑูุง ุจุช `&` ู `|` ุจุงุฒููุณ ูโุดููุฏ.

---

### ุชูุงุจุน ุนููฺฏุฑ (Operator Functions) ๐๏ธ

ุจุฑุง ุจุงุฑฺฏุฐุงุฑ ฺฉ ุนููฺฏุฑุ ุจุงุฏ ฺฉ **ุชุงุจุน ุนููฺฏุฑ** ุชุนุฑู ฺฉูุฏ. ููุงูู ุชูุงุจุน ุนููฺฏุฑ ุจู ุดุฑุญ ุฒุฑ ุงุณุช:

+ ูุงู ุชุงุจุน ุจุง ฺฉููู ฺฉูุฏ `operator` ู ุณูพุณ ููุงุฏ ุนููฺฏุฑ ูุดุฎุต ูโุดูุฏ.
+ ุชุงุจุน ุนููฺฏุฑ ุจุงุฏ `static` ู `public` ุจุงุดุฏ.
+ ูพุงุฑุงูุชุฑูุง ุชุงุจุน ุนููฺฏุฑ ูุดุงูโุฏููุฏูโ ุนููููุฏูุง ูุณุชูุฏ.
+ ููุน ุจุงุฒฺฏุดุช ุชุงุจุน ุนููฺฏุฑ ูุดุงูโุฏููุฏูโ ูุชุฌูโ ฺฉ ุนุจุงุฑุช ุงุณุช.
+ ุญุฏุงูู ฺฉ ุงุฒ ุนููููุฏูุง ุจุงุฏ ุงุฒ ููุน ุจุงุดุฏ ฺฉู ุชุงุจุน ุนููฺฏุฑ ุฏุฑ ุขู ุชุนุฑู ุดุฏู ุงุณุช.

ูุซุงู ุฒุฑ ฺฉ `struct` ุจู ูุงู `Note` ุชุนุฑู ูโฺฉูุฏ ฺฉู ููุงุงูฺฏุฑ ฺฉ ูุช ููุณู ุงุณุช ู ุณูพุณ ุนููฺฏุฑ `+` ุฑุง ุจุงุฑฺฏุฐุงุฑ ูโฺฉูุฏ:

```csharp
public struct Note
{
    int value;
    public Note (int semitonesFromA) { value = semitonesFromA; }

    public static Note operator + (Note x, int semitones)
    {
        return new Note (x.value + semitones);
    }
}
```

ุงู ุจุงุฑฺฏุฐุงุฑ ุจู ูุง ุงุฌุงุฒู ูโุฏูุฏ ฺฉ `int` ุฑุง ุจู ฺฉ `Note` ุงุถุงูู ฺฉูู:

```csharp
Note B = new Note (2);
Note CSharp = B + 2;
```

ุจุงุฑฺฏุฐุงุฑ ฺฉ ุนููฺฏุฑุ ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ุนููฺฏุฑ ุชุฑฺฉุจ ูุชูุงุธุฑ ุฑุง ูุฒ ุจุงุฑฺฏุฐุงุฑ ูโฺฉูุฏ. ุฏุฑ ูุซุงู ูุงุ ฺูู `+` ุฑุง ุจุงุฒููุณ ฺฉุฑุฏูุ ูโุชูุงูู ุงุฒ `+=` ูู ุงุณุชูุงุฏู ฺฉูู:

```csharp
CSharp += 2;
```

ููุงููุฏ ูุชุฏูุง ู ูพุฑุงูพุฑุชโูุงุ C# ุงุฌุงุฒู ูโุฏูุฏ ุชูุงุจุน ุนููฺฏุฑ ฺฉู ุดุงูู ฺฉ ุนุจุงุฑุช ูุณุชูุฏ ุจุง **ูุญู ุจุฏูู-ุนุจุงุฑุช (expression-bodied syntax)** ฺฉูุชุงูโุชุฑ ููุดุชู ุดููุฏ:

```csharp
public static Note operator + (Note x, int semitones)
    => new Note (x.value + semitones);
```

---

### ุนููฺฏุฑูุง Checked โ๏ธ

ุงุฒ C# 11 ุจู ุจุนุฏุ ููฺฏุงู ุชุนุฑู ุชุงุจุน ุนููฺฏุฑุ ูโุชูุงู ูุณุฎูโ `checked` ุขู ุฑุง ูุฒ ุชุนุฑู ฺฉุฑุฏ:

```csharp
public static Note operator + (Note x, int semitones)
    => new Note (x.value + semitones);

public static Note operator checked + (Note x, int semitones)
    => checked (new Note (x.value + semitones));
```

ูุณุฎูโ `checked` ุฏุงุฎู ุนุจุงุฑุชโูุง ุง ุจููฺฉโูุง `checked` ูุฑุงุฎูุงู ูโุดูุฏ:

```csharp
Note B = new Note (2);
Note other = checked (B + int.MaxValue);  // ูพุฑุชุงุจ OverflowException
```

---

### ุจุงุฑฺฏุฐุงุฑ ุนููฺฏุฑูุง ุจุฑุงุจุฑ ู ููุงุณู โ๏ธ

ุนููฺฏุฑูุง ุจุฑุงุจุฑ ู ููุงุณู ฺฏุงู ููฺฏุงู ููุดุชู `struct`ูุง ู ุฏุฑ ููุงุฑุฏ ูุงุฏุฑ ููฺฏุงู ููุดุชู ฺฉูุงุณโูุง ุจุงุฒููุณ ูโุดููุฏ. ููุงูู ู ุงูุฒุงูุงุช ุฎุงุต ุจุฑุง ุจุงุฑฺฏุฐุงุฑ ุงู ุนููฺฏุฑูุง ูุฌูุฏ ุฏุงุฑุฏ ฺฉู ุฏุฑ ูุตู ถ ุชูุถุญ ุฏุงุฏู ุดุฏู ุงุณุช. ุฎูุงุตู ุงู ููุงูู:

**ุฌูุชโุจูุฏ (Pairing)**
ฺฉุงููพุงูุฑ C# ุงุทููุงู ูโุฏูุฏ ฺฉู ุนููฺฏุฑูุง ููุทู ุฌูุช ุดุฏูุ ูุฑ ุฏู ุชุนุฑู ุดุฏู ุจุงุดูุฏ: `(== !=), (< >), (<= >=)`

**Equals ู GetHashCode**
ุฏุฑ ุจุดุชุฑ ููุงุฑุฏุ ุงฺฏุฑ `==` ู `!=` ุฑุง ุจุงุฑฺฏุฐุงุฑ ูโฺฉูุฏุ ุจุงุฏ ูุชุฏูุง `Equals` ู `GetHashCode` ุชุนุฑู ุดุฏู ุฏุฑ `object` ุฑุง ุจุงุฒููุณ ฺฉูุฏ ุชุง ุฑูุชุงุฑ ูุนูุงุฏุงุฑ ุฏุงุดุชู ุจุงุดุฏ. ุงฺฏุฑ ุงู ฺฉุงุฑ ุฑุง ูฺฉูุฏุ ฺฉุงููพุงูุฑ ูุดุฏุงุฑ ูโุฏูุฏ.

**IComparable ู IComparable<T>**
ุงฺฏุฑ `< >` ู `<= >=` ุฑุง ุจุงุฑฺฏุฐุงุฑ ูโฺฉูุฏุ ุจูุชุฑ ุงุณุช `IComparable` ู `IComparable<T>` ุฑุง ูพุงุฏูโุณุงุฒ ฺฉูุฏ.

---

### ุชุจุฏูโูุง ุถูู ู ุตุฑุญ ุณูุงุฑุด ๐

ุชุจุฏูโูุง ุถูู ู ุตุฑุญ ูุฒ ุนููฺฏุฑูุง ูุงุจู ุจุงุฑฺฏุฐุงุฑ ูุณุชูุฏ. ุงู ุชุจุฏูโูุง ูุนูููุงู ุจุฑุง ุณุงุฏู ู ุทุจุน ฺฉุฑุฏู ุชุจุฏู ุจู ููุนโูุง ูุฑุชุจุท (ูุซูุงู ููุนโูุง ุนุฏุฏ) ุงุณุชูุงุฏู ูโุดููุฏ.

ุจุฑุง ุชุจุฏู ุจู ููุนโูุง ฺฉูุชุฑ ูุฑุชุจุทุ ุฑูุดโูุง ุฒุฑ ููุงุณุจโุชุฑ ูุณุชูุฏ:

+ ููุดุชู ฺฉ ุณุงุฒูุฏู ฺฉู ูพุงุฑุงูุชุฑ ุขู ุงุฒ ููุน ูุจุฏุฃ ุจุงุดุฏ.
+ ููุดุชู ูุชุฏูุง `ToXXX` ู (static) `FromXXX` ุจุฑุง ุชุจุฏู ุจู ููุนโูุง.

ููุงูโุทูุฑ ฺฉู ุฏุฑ ุจุญุซ ููุนโูุง ุชูุถุญ ุฏุงุฏู ุดุฏุ ุฏูู ุงุตู ุชุจุฏูโูุง ุถูู ุงู ุงุณุช ฺฉู ุชุถูู ูโฺฉููุฏ ุนููุงุช ููููุชโุขูุฒ ุจุงุดุฏ ู ุงุทูุงุนุงุช ุงุฒ ุฏุณุช ูุฑูุฏ. ุฏุฑ ููุงุจูุ ุชุจุฏู ุตุฑุญ ุฒูุงู ูุงุฒู ุงุณุช ฺฉู ุดุฑุงุท ุฒูุงู ุงุฌุฑุง ูุดุฎุต ฺฉูุฏ ุขุง ุชุจุฏู ูููู ุงุณุช ุง ุงุทูุงุนุงุช ููฺฉู ุงุณุช ุงุฒ ุฏุณุช ุจุฑูุฏ.

ูุซุงู ุฒุฑ ุชุจุฏู ุจู ููุน ููุณู `Note` ู `double` (ููุงุด ูุฑฺฉุงูุณ ุจุฑ ุญุณุจ ูุฑุชุฒ) ุฑุง ูุดุงู ูโุฏูุฏ:

```csharp
// ุชุจุฏู ุจู ูุฑุชุฒ
public static implicit operator double (Note x)
    => 440 * Math.Pow(2, (double)x.value / 12);

// ุชุจุฏู ุงุฒ ูุฑุชุฒ (ุฏูู ุชุง ูุฒุฏฺฉโุชุฑู ููโูพุฑุฏู)
public static explicit operator Note (double x)
    => new Note((int)(0.5 + 12 * (Math.Log(x/440) / Math.Log(2))));
```

```csharp
Note n = (Note)554.37;  // ุชุจุฏู ุตุฑุญ
double x = n;           // ุชุจุฏู ุถูู
```

ุจุง ุชูุฌู ุจู ุฑุงูููุงโูุง ุฎูุฏุ ุงู ูุซุงู ููฺฉู ุงุณุช ุจูุชุฑ ุจุงุดุฏ ุจุง ูุชุฏ `ToFrequency` ู ูุชุฏ ุงุณุชุงุชฺฉ `FromFrequency` ูพุงุฏูโุณุงุฒ ุดูุฏุ ุจู ุฌุง ุงุณุชูุงุฏู ุงุฒ ุนููฺฏุฑูุง ุถูู ู ุตุฑุญ.

ุชุจุฏูโูุง ุณูุงุฑุด ุชูุณุท ุนููฺฏุฑูุง `as` ู `is` ูุงุฏุฏู ฺฏุฑูุชู ูโุดููุฏ:

```csharp
Console.WriteLine(554.37 is Note);   // False
Note n = 554.37 as Note;             // ุฎุทุง
```

### ุจุงุฑฺฏุฐุงุฑ ูุฌุฏุฏ ุนููฺฏุฑูุง true ู false โ

ุนููฺฏุฑูุง `true` ู `false` ุจู ูุฏุฑุช ุฏุฑ ููุนโูุง ุจุงุฑฺฏุฐุงุฑ ูโุดููุฏ ฺฉู ุจู ูุญุงุธ ยซุฑูุญยป ุจูู ูุณุชูุฏ ูู ุชุจุฏู ุจู `bool` ูุฏุงุฑูุฏ. ูููููโ ุขู ููุน ุงุณุช ฺฉู ููุทู ุณูโุญุงูุชู (three-state logic) ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉูุฏ. ุจุง ุจุงุฑฺฏุฐุงุฑ ุงู ุนููฺฏุฑูุงุ ุงู ููุน ูโุชูุงูุฏ ุจูโุทูุฑ ฺฉูพุงุฑฺู ุจุง ุฏุณุชูุฑุงุช ุดุฑุท ู ุนููฺฏุฑูุง ฺฉุงุฑ ฺฉูุฏุ ูุงููุฏ: `if`, `do`, `while`, `for`, `&&`, `||` ู `?:`.

ุณุงุฎุชุงุฑ `System.Data.SqlTypes.SqlBoolean` ุงู ูุงุจูุช ุฑุง ุงุฑุงุฆู ูโุฏูุฏ:

```csharp
SqlBoolean a = SqlBoolean.Null;
if (a)
    Console.WriteLine("True");
else if (!a)
    Console.WriteLine("False");
else
    Console.WriteLine("Null");
```

ุฎุฑูุฌ:

```
Null
```

ฺฉุฏ ุฒุฑ ุจุงุฒูพุงุฏูโุณุงุฒ ุจุฎุดโูุง ููุฑุฏ ูุงุฒ `SqlBoolean` ุจุฑุง ูุดุงู ุฏุงุฏู ุนููฺฏุฑูุง `true` ู `false` ุงุณุช:

```csharp
public struct SqlBoolean
{
    public static bool operator true(SqlBoolean x)
        => x.m_value == True.m_value;
    public static bool operator false(SqlBoolean x)
        => x.m_value == False.m_value;

    public static SqlBoolean operator !(SqlBoolean x)
    {
        if (x.m_value == Null.m_value) return Null;
        if (x.m_value == False.m_value) return True;
        return False;
    }

    public static readonly SqlBoolean Null = new SqlBoolean(0);
    public static readonly SqlBoolean False = new SqlBoolean(1);
    public static readonly SqlBoolean True = new SqlBoolean(2);

    private SqlBoolean(byte value) { m_value = value; }
    private byte m_value;
}
```

---

### ฺูุฏุฑุฎุช ุงุณุชุง (Static Polymorphism) ๐

ุฏุฑ ุจุฎุด ยซCalling Static Virtual/Abstract Interface Membersยป ุตูุญู ธฒถุ ูฺฺฏ ูพุดุฑูุชูโุง ูุนุฑู ุดุฏ ฺฉู ุฏุฑ ุขู ฺฉ ุฑุงุจุท (interface) ูโุชูุงูุฏ ุงุนุถุง `static virtual` ุง `static abstract` ุชุนุฑู ฺฉูุฏ ฺฉู ุชูุณุท ฺฉูุงุณโูุง ู `struct`ูุง ุจูโุตูุฑุช ุงุนุถุง ุงุณุชุง ูพุงุฏูโุณุงุฒ ูโุดููุฏ.

ุณูพุณ ุฏุฑ ุจุฎุด ยซGeneric Constraintsยป ุตูุญู ฑถณ ูุดุงู ุฏุงุฏู ุดุฏ ฺฉู ุงุนูุงู ูุญุฏูุฏุช ุฑุงุจุท ุฑู ูพุงุฑุงูุชุฑ ููุนุ ุงูฺฉุงู ุฏุณุชุฑุณ ูุชุฏ ุจู ุงุนุถุง ุขู ุฑุงุจุท ุฑุง ูุฑุงูู ูโฺฉูุฏ. ุฏุฑ ุงู ุจุฎุดุ ูุดุงู ุฎูุงูู ุฏุงุฏ ฺฉู ฺฺฏููู ุงู ูุงุจูุช ฺูุฏุฑุฎุช ุงุณุชุง ุฑุง ููฺฉู ูโุณุงุฒุฏ ู ูฺฺฏโูุง ูุงููุฏ ุฑุงุถุงุช ุนููู (generic math) ุฑุง ูุนุงู ูโฺฉูุฏ.

ุจุฑุง ูููููุ ุฑุงุจุท ุฒุฑ ฺฉ ูุชุฏ ุงุณุชุง ุชุนุฑู ูโฺฉูุฏ ฺฉู ฺฉ ููููู ุชุตุงุฏู ุงุฒ ููุน `T` ุงุฌุงุฏ ูโฺฉูุฏ:

```csharp
interface ICreateRandom<T>
{
    static abstract T CreateRandom();  // ุงุฌุงุฏ ฺฉ ููููู ุชุตุงุฏู ุงุฒ T
}
```

ูุฑุถ ฺฉูุฏ ูโุฎูุงูู ุงู ุฑุงุจุท ุฑุง ุฏุฑ ุฑฺฉูุฑุฏ ุฒุฑ ูพุงุฏูโุณุงุฒ ฺฉูู:

```csharp
record Point(int X, int Y);
```

ุจุง ฺฉูฺฉ ฺฉูุงุณ `System.Random` (ฺฉู ูุชุฏ `Next` ุขู ฺฉ ุนุฏุฏ ุตุญุญ ุชุตุงุฏู ุชููุฏ ูโฺฉูุฏ)ุ ูโุชูุงูู ูุชุฏ ุงุณุชุง `CreateRandom` ุฑุง ุจู ุงู ุตูุฑุช ูพุงุฏูโุณุงุฒ ฺฉูู:

```csharp
record Point(int X, int Y) : ICreateRandom<Point>
{
    static Random rnd = new();
    public static Point CreateRandom() => new Point(rnd.Next(), rnd.Next());
}
```

ุจุฑุง ูุฑุงุฎูุงู ุงู ูุชุฏ ุงุฒ ุทุฑู ุฑุงุจุทุ ุงุฒ ูพุงุฑุงูุชุฑ ููุน ูุญุฏูุฏ ุดุฏู ุงุณุชูุงุฏู ูโฺฉูู. ูุชุฏ ุฒุฑ ฺฉ ุขุฑุงู ุฏุงุฏูโ ุชุณุช ุจุง ุงู ุฑูุด ุงุฌุงุฏ ูโฺฉูุฏ:

```csharp
T[] CreateTestData<T>(int count) where T : ICreateRandom<T>
{
    T[] result = new T[count];
    for (int i = 0; i < count; i++)
        result[i] = T.CreateRandom();
    return result;
}
```

ูุซุงู ุงุณุชูุงุฏู:

```csharp
Point[] testData = CreateTestData<Point>(50);  // ุงุฌุงุฏ ตฐ ููุทู ุชุตุงุฏู
```

ูุฑุงุฎูุงู ูุชุฏ ุงุณุชุง `CreateRandom` ุฏุฑ `CreateTestData` ฺูุฏุฑุฎุช ุงุณุชุ ุฒุฑุง ููโุชููุง ุจุง `Point` ุจูฺฉู ุจุง ูุฑ ููุน ฺฉู `ICreateRandom<T>` ุฑุง ูพุงุฏูโุณุงุฒ ฺฉุฑุฏู ุจุงุดุฏุ ฺฉุงุฑ ูโฺฉูุฏ. ุงู ุจุง ฺูุฏุฑุฎุช ูููููโุง ูุชูุงูุช ุงุณุชุ ุฒุฑุง ุจุฑุง ูุฑุงุฎูุงู `CreateRandom` ูุงุฒ ุจู ูููููโุง ุงุฒ `ICreateRandom<T>` ูุฏุงุฑูุ ุจูฺฉู ุขู ุฑุง ุฑู ููุน ุฎูุฏ ูุฑุงุฎูุงู ูโฺฉูู.

---

### ุนููฺฏุฑูุง ฺูุฏุฑุฎุช (Polymorphic Operators) โก

ุงุฒ ุขูุฌุง ฺฉู ุนููฺฏุฑูุง ุงุณุงุณุงู ุชูุงุจุน ุงุณุชุง ูุณุชูุฏ (ุตูุญู ฒตถ)ุ ูโุชูุงู ุขูโูุง ุฑุง ูุฒ ุจูโุนููุงู ุงุนุถุง ุงุณุชุงุ ูุฌุงุฒ ุง ุฑุงุจุท ุชุนุฑู ฺฉุฑุฏ:

```csharp
interface IAddable<T> where T : IAddable<T>
{
    abstract static T operator + (T left, T right);
}
```

ูุญุฏูุฏุช ููุน ุฎูุฏุงุฑุฌุงุน (self-referencing type constraint) ุฏุฑ ุงู ุชุนุฑู ุฑุงุจุท ุจุฑุง ุฑุนุงุช ููุงูู ฺฉุงููพุงูุฑ ุฏุฑ ุจุงุฑฺฏุฐุงุฑ ุนููฺฏุฑ ุถุฑูุฑ ุงุณุช. ุจู ุฎุงุทุฑ ุจุงูุฑุฏ ฺฉู ููฺฏุงู ุชุนุฑู ุชุงุจุน ุนููฺฏุฑุ ุญุฏุงูู ฺฉ ุงุฒ ุนููููุฏูุง ุจุงุฏ ุงุฒ ููุน ุจุงุดุฏ ฺฉู ุชุงุจุน ุฏุฑ ุขู ุชุนุฑู ุดุฏู ุงุณุช. ุฏุฑ ุงู ูุซุงูุ ุนููููุฏูุง ุงุฒ ููุน `T` ูุณุชูุฏุ ุฏุฑ ุญุงู ฺฉู ููุน ุดุงูู `IAddable<T>` ุงุณุชุ ุจูุงุจุฑุงู ูุงุฒ ุจู ูุญุฏูุฏุช ููุน ุฎูุฏุงุฑุฌุงุน ุฏุงุฑู ุชุง `T` ุจุชูุงูุฏ ุจูโุนููุงู `IAddable<T>` ุฏุฑ ูุธุฑ ฺฏุฑูุชู ุดูุฏ.

ูพุงุฏูโุณุงุฒ ุฑุงุจุท ุจู ุงู ุตูุฑุช ุงุณุช:

```csharp
record Point(int X, int Y) : IAddable<Point>
{
    public static Point operator + (Point left, Point right) =>
        new Point(left.X + right.X, left.Y + right.Y);
}
```

ุจุง ูพุงุฑุงูุชุฑ ููุน ูุญุฏูุฏ ุดุฏูุ ูโุชูุงูู ูุชุฏ ุจููุณู ฺฉู ุนููฺฏุฑ ุฌูุน ุฑุง ุจูโุตูุฑุช ฺูุฏุฑุฎุช ูุฑุงุฎูุงู ฺฉูุฏ:

```csharp
T Sum<T>(params T[] values) where T : IAddable<T>
{
    T total = values[0];
    for (int i = 1; i < values.Length; i++)
        total += values[i];
    return total;
}
```

ูุฑุงุฎูุงู ุนููฺฏุฑ `+` (ุงุฒ ุทุฑู `+=`) ฺูุฏุฑุฎุช ุงุณุชุ ุฒุฑุง ุจู `IAddable<T>` ูุชุตู ูโุดูุฏุ ูู `Point`. ุจูุงุจุฑุงู ูุชุฏ `Sum` ุจุง ุชูุงู ููุนโูุง ฺฉู `IAddable<T>` ุฑุง ูพุงุฏูโุณุงุฒ ฺฉุฑุฏูโุงูุฏ ฺฉุงุฑ ูโฺฉูุฏ.

ุงูุจุชูุ ุฑุงุจุท ูุงููุฏ `IAddable<T>` ุฒูุงู ููุฏุชุฑ ุงุณุช ฺฉู ุฏุฑ runtime ุฏุงุชโูุช ุชุนุฑู ุดูุฏ ู ููู ููุนโูุง ุนุฏุฏ .NET ุขู ุฑุง ูพุงุฏูโุณุงุฒ ฺฉููุฏ. ุฎูุดุจุฎุชุงูู ุงุฒ .NET 7ุ ูุถุง ูุงู `System.Numerics` ูุณุฎูโุง ูพุดุฑูุชูโุชุฑ ุงุฒ `IAddable` ุฑุง ููุฑุงู ุจุง ุณุงุฑ ุฑุงุจุทโูุง ุฑุงุถ ุงุฑุงุฆู ูโุฏูุฏโฺฉู ุจุดุชุฑ ุขูโูุง ุชุญุช ูพูุดุด `INumber<TSelf>` ูุณุชูุฏ.

### ุฑุงุถุงุช ุนููู (Generic Math) โ

ูุจู ุงุฒ .NET 7ุ ฺฉุฏ ฺฉู ุนููุงุช ุญุณุงุจ ุงูุฌุงู ูโุฏุงุฏุ ุจุงุฏ ุจุฑุง ฺฉ ููุน ุนุฏุฏ ูุดุฎุต ููุดุชู ูโุดุฏ:

```csharp
int Sum(params int[] numbers)   // ููุท ุจุง int ฺฉุงุฑ ูโฺฉูุฏ
{
    // ุจุง doubleุ decimal ู ุบุฑู ฺฉุงุฑ ููโฺฉูุฏ
    int total = 0;
    foreach (int n in numbers)
        total += n;
    return total;
}
```

ุฏุฑ .NET 7ุ ุฑุงุจุท `INumber<TSelf>` ูุนุฑู ุดุฏ ุชุง ุนููุงุช ุญุณุงุจ ุฑุง ุฏุฑ ุชูุงู ููุนโูุง ุนุฏุฏ ฺฉูพุงุฑฺู ฺฉูุฏ. ุงู ุนู ุญุงูุง ูโุชูุงู ูุณุฎูโ ุนููู (generic) ูุชุฏ ุจุงูุง ุฑุง ููุดุช:

```csharp
T Sum<T>(params T[] numbers) where T : INumber<T>
{
    T total = T.Zero;
    foreach (T n in numbers)
        total += n;  // ุนููฺฏุฑ ุฌูุน ุจุฑุง ูุฑ ููุน ุนุฏุฏ ูุฑุงุฎูุงู ูโุดูุฏ
    return total;
}

int intSum = Sum(3, 5, 7);
double doubleSum = Sum(3.2, 5.3, 7.1);
decimal decimalSum = Sum(3.2m, 5.3m, 7.1m);
```

ุชูุงู ููุนโูุง ุนุฏุฏ ุตุญุญ ู ุงุนุดุงุฑ ุฏุฑ .NET (ู ููฺูู `char`) ุฑุงุจุท `INumber<TSelf>` ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉููุฏ. ุงู ุฑุงุจุท ุฑุง ูโุชูุงู ุจูโุนููุงู ฺฉ ุฑุงุจุท ฺฉู (umbrella interface) ุชุตูุฑ ฺฉุฑุฏ ฺฉู ุดุงูู ุฑุงุจุทโูุง ุฌุฒุฆโุชุฑ ุจุฑุง ูุฑ ููุน ุนููุงุช ุญุณุงุจ (ุฌูุนุ ุชูุฑูุ ุถุฑุจุ ุชูุณูุ ุจุงูโูุงูุฏูุ ููุงุณู ู ุบุฑู) ู ููฺูู ุฑุงุจุทโูุง ุจุฑุง ูพุงุฑุณูฺฏ ู ูุงูุจโุจูุฏ ุงุณุช.

ูุซุงู ุงุฒ ฺูู ุฑุงุจุท:

```csharp
public interface IAdditionOperators<TSelf, TOther, TResult>
    where TSelf : IAdditionOperators<TSelf, TOther, TResult>?
{
    static abstract TResult operator + (TSelf left, TOther right);
    public static virtual TResult operator checked + 
        (TSelf left, TOther right) => left + right;  // ูุฑุงุฎูุงู ุนููฺฏุฑ ุจุงูุง
}
```

ุนููฺฏุฑ ุงุณุชุง ู ุงูุชุฒุงุน `+` ููุงู ฺุฒ ุงุณุช ฺฉู ุจุงุนุซ ูโุดูุฏ ุนููฺฏุฑ `+=` ุฏุงุฎู ูุชุฏ `Sum` ฺฉุงุฑ ฺฉูุฏ. ููฺูู ุชูุฌู ฺฉูุฏ ฺฉู ุงุณุชูุงุฏู ุงุฒ `static virtual` ุฑู ุนููฺฏุฑ `checked`ุ ุฑูุชุงุฑ ูพุดโูุฑุถ ุจุฑุง ูพุงุฏูโุณุงุฒุงู ฺฉู ูุณุฎูโ `checked` ุนููฺฏุฑ ุฌูุน ุฑุง ุงุฑุงุฆู ููโฺฉููุฏุ ูุฑุงูู ูโฺฉูุฏ.

ูุถุง ูุงู `System.Numerics` ููฺูู ุดุงูู ุฑุงุจุทโูุง ุงุณุช ฺฉู ุจุฎุด ุงุฒ `INumber` ูุณุชูุฏ ู ูุฎุตูุต ุนููุงุช ููุนโูุง ุฎุงุต ุงุฒ ุงุนุฏุงุฏ (ูุซู ุงุนุฏุงุฏ ุงุนุดุงุฑ) ูุณุชูุฏ.

ุจูโุนููุงู ูุซุงูุ ุจุฑุง ูุญุงุณุจูโ **ูุงูฺฏู ูุฑุจุนุงุช (Root Mean Square)** ูโุชูุงูู ุฑุงุจุท `IRootFunctions<T>` ุฑุง ุจู ููุฑุณุช ูุญุฏูุฏุชโูุง ุงุถุงูู ฺฉูู ุชุง ูุชุฏ ุงุณุชุง `RootN` ุขู ุจุฑุง `T` ุฏุฑ ุฏุณุชุฑุณ ุจุงุดุฏ:

```csharp
T RMS<T>(params T[] values) where T : INumber<T>, IRootFunctions<T>
{
    T total = T.Zero;
    for (int i = 0; i < values.Length; i++)
        total += values[i] * values[i];

    // ุงุณุชูุงุฏู ุงุฒ T.CreateChecked ุจุฑุง ุชุจุฏู values.Length (ููุน int) ุจู T
    T count = T.CreateChecked(values.Length);
    return T.RootN(total / count, 2);  // ูุญุงุณุจู ุฑุดู ุฏูู (ูุฑุจุน)
}
```

---

### ฺฉุฏ ูุงุงูู ู ุงุดุงุฑูโฺฏุฑูุง (Unsafe Code and Pointers) โ๏ธ

C# ุงูฺฉุงู ุฏุณุชุฑุณ ูุณุชูู ุจู ุญุงูุธู ุฑุง ุงุฒ ุทุฑู ุงุดุงุฑูโฺฏุฑูุง ุฏุฑ ุจููฺฉโูุง ฺฉุฏ `unsafe` ูุฑุงูู ูโฺฉูุฏ. ููุนโูุง ุงุดุงุฑูโฺฏุฑ ุจุฑุง ุชุนุงูู ุจุง APIูุง ุจูู (native)ุ ุฏุณุชุฑุณ ุจู ุญุงูุธู ุฎุงุฑุฌ ุงุฒ heap ูุฏุฑุชโุดุฏูุ ู ูพุงุฏูโุณุงุฒ ุจูููโุณุงุฒโูุง ฺฉูฺฺฉ ุฏุฑ ููุงุท ุญุณุงุณ ุนููฺฉุฑุฏ ููุฏ ูุณุชูุฏ.

ูพุฑูฺูโูุง ฺฉู ุดุงูู ฺฉุฏ ูุงุงูู ูุณุชูุฏุ ุจุงุฏ ุฏุฑ ูุงู ูพุฑูฺู `<AllowUnsafeBlocks>true</AllowUnsafeBlocks>` ุฑุง ูุดุฎุต ฺฉููุฏ.

#### ุงุตูู ุงููู ุงุดุงุฑูโฺฏุฑูุง (Pointer Basics)

ุจุฑุง ูุฑ ููุน ููุฏุงุฑ ุง ูุฑุฌุน `V`ุ ููุน ุงุดุงุฑูโฺฏุฑ ูุชูุงุธุฑ `V*` ูุฌูุฏ ุฏุงุฑุฏ. ฺฉ ููููู ุงุฒ ุงุดุงุฑูโฺฏุฑ ุขุฏุฑุณ ฺฉ ูุชุบุฑ ุฑุง ูฺฏู ูโุฏุงุฑุฏ. ููุนโูุง ุงุดุงุฑูโฺฏุฑ ูโุชูุงููุฏ ุจู ุตูุฑุช ูุงุงูู ุจู ูุฑ ููุน ุงุดุงุฑูโฺฏุฑ ุฏฺฏุฑ ุชุจุฏู (cast) ุดููุฏ.

ุนููฺฏุฑูุง ุงุตู ุงุดุงุฑูโฺฏุฑ ุนุจุงุฑุชโุงูุฏ ุงุฒ:
<div align="center">

![Conventions-UsedThis-Book](../../../assets/image/04/Table-4-2.jpeg)
</div>

### ฺฉุฏ ูุงุงูู ู ุงุดุงุฑูโฺฏุฑูุง (ุงุฏุงูู) โก

ููุงููุฏ ุฒุจุงู Cุ ุงุถุงูู ฺฉุฑุฏู (ุง ฺฉู ฺฉุฑุฏู) ฺฉ ุขูุณุช ุนุฏุฏ ุตุญุญ ุจู ฺฉ ุงุดุงุฑูโฺฏุฑุ ฺฉ ุงุดุงุฑูโฺฏุฑ ุฏฺฏุฑ ุชููุฏ ูโฺฉูุฏ. ฺฉู ฺฉุฑุฏู ฺฉ ุงุดุงุฑูโฺฏุฑ ุงุฒ ุฏฺฏุฑ ฺฉ ุนุฏุฏ ุตุญุญ ถด ุจุช ุชููุฏ ูโฺฉูุฏ (ุฏุฑ ูุฑ ุฏู ูพูุชูุฑู ณฒ ู ถด ุจุช).

---

### ฺฉุฏ ูุงุงูู (Unsafe Code) ๐ก๏ธ

ุจุง ุนูุงูุชโฺฏุฐุงุฑ ฺฉ ููุนุ ุนุถู ููุนุ ุง ุจููฺฉ ุฏุณุชูุฑ ุจุง ฺฉูุฏูุงฺู `unsafe`ุ ุงุฌุงุฒู ุฏุงุฑุฏ ุงุฒ ููุนโูุง ุงุดุงุฑูโฺฏุฑ ุงุณุชูุงุฏู ฺฉูุฏ ู ุนููุงุช ุงุดุงุฑูโฺฏุฑ ุจู ุณุจฺฉ C ุฑู ุญุงูุธู ุงูุฌุงู ุฏูุฏ. ูุซุงู ุฒุฑ ุงุณุชูุงุฏู ุงุฒ ุงุดุงุฑูโฺฏุฑูุง ุจุฑุง ูพุฑุฏุงุฒุด ุณุฑุน ฺฉ ุจุชโููพ ุฑุง ูุดุงู ูโุฏูุฏ:

```csharp
unsafe void BlueFilter(int[,] bitmap)
{
    int length = bitmap.Length;
    fixed (int* b = bitmap)
    {
        int* p = b;
        for (int i = 0; i < length; i++)
            *p++ &= 0xFF;
    }
}
```

ฺฉุฏ ูุงุงูู ูโุชูุงูุฏ ุณุฑุนโุชุฑ ุงุฒ ูพุงุฏูโุณุงุฒ ุงูู ูุดุงุจู ุงุฌุฑุง ุดูุฏ. ุฏุฑ ุงู ูุซุงูุ ูุณุฎู ุงูู ูุงุฒ ุจู ุญูููโ ุชู ุฏุฑ ุชู ุจุง ุงูุฏุณโุฏู ุขุฑุงู ู ุจุฑุฑุณ ุญุฏูุฏ ุฏุงุดุช. ููฺููุ ูุชุฏ ูุงุงูู C# ูโุชูุงูุฏ ุณุฑุนโุชุฑ ุงุฒ ูุฑุงุฎูุงู ฺฉ ุชุงุจุน C ุฎุงุฑุฌ ุจุงุดุฏุ ฺูู ุณุฑุจุงุฑ ุชุฑฺฉ ูุญุท ุงุฌุฑุง ูุฏุฑุชโุดุฏู ูุฌูุฏ ูุฏุงุฑุฏ.

---

### ุฏุณุชูุฑ fixed ๐

ุฏุณุชูุฑ `fixed` ุจุฑุง **ุณูุฌุงู ฺฉุฑุฏู (pin)** ฺฉ ุด ูุฏุฑุชโุดุฏู ูุงููุฏ ุจุชโููพ ุงุณุชูุงุฏู ูโุดูุฏ. ุฏุฑ ุทูู ุงุฌุฑุง ุจุฑูุงููุ ุจุณุงุฑ ุงุฒ ุงุดุง ุงุฒ heap ุชุฎุตุต ู ุขุฒุงุฏ ูโุดููุฏ. ุจุฑุง ุฌููฺฏุฑ ุงุฒ ูุฏุฑุฑูุช ุง ุชฺฉูโุชฺฉู ุดุฏู ุญุงูุธูุ ุฌูุนโุขูุฑูุฏู ุฒุจุงูู (GC) ุงุดุง ุฑุง ุฌุงุจูโุฌุง ูโฺฉูุฏ. ุงฺฏุฑ ุขุฏุฑุณ ฺฉ ุด ุชุบุฑ ฺฉูุฏุ ุงุดุงุฑู ุจู ุขู ุจโูุงุฏู ุงุณุชุ ุจูุงุจุฑุงู `fixed` ุจู GC ูโฺฏูุฏ ุด ุฑุง ุฌุงุจูโุฌุง ูฺฉูุฏ. ุงุณุชูุงุฏู ุจุด ุงุฒ ุญุฏ ุงุฒ ุจููฺฉโูุง `fixed` ูโุชูุงูุฏ ุฑู ฺฉุงุฑุง ุฒูุงู ุงุฌุฑุง ุชุงุซุฑ ุจฺฏุฐุงุฑุฏุ ุจูุงุจุฑุงู ุจูุชุฑ ุงุณุช ุงุฒ ุขูโูุง ฺฉูุชุงู ุงุณุชูุงุฏู ฺฉูุฏ ู ุงุฒ ุชุฎุตุต ุญุงูุธู ุฏุฑูู ุจููฺฉ `fixed` ุฎูุฏุฏุงุฑ ฺฉูุฏ.

ุฏุฑูู ุฏุณุชูุฑ `fixed`ุ ูโุชูุงูุฏ ฺฉ ุงุดุงุฑูโฺฏุฑ ุจู ูุฑ ููุน ููุฏุงุฑุ ุขุฑุงูโุง ุงุฒ ููุนโูุง ููุฏุงุฑุ ุง ุฑุดุชู ุฏุฑุงูุช ฺฉูุฏ. ุฏุฑ ููุฑุฏ ุขุฑุงูโูุง ู ุฑุดุชูโูุงุ ุงุดุงุฑูโฺฏุฑ ุฏุฑ ูุงูุน ุจู ุงููู ุนูุตุฑ ุงุดุงุฑู ูโฺฉูุฏ ฺฉู ุงุฒ ููุน ููุฏุงุฑ ุงุณุช.

ูููููโุง ุงุฒ ุณูุฌุงู ฺฉุฑุฏู ููุน ููุฏุงุฑ ุฏุงุฎู ููุน ูุฑุฌุน:

```csharp
Test test = new Test();
unsafe
{
    fixed (int* p = &test.X)   // ุณูุฌุงู ฺฉุฑุฏู test
    {
        *p = 9;
    }
}
Console.WriteLine(test.X);

class Test { public int X; }
```

ุชูุถุญุงุช ุจุดุชุฑ ุฏุฑุจุงุฑูโ `fixed` ุฏุฑ ุจุฎุด ยซMapping a Struct to Unmanaged Memoryยป ุตูุญู นนท ุขูุฏู ุงุณุช.

---

### ุนููฺฏุฑ ุงุดุงุฑูโฺฏุฑ ุจู ุนุถู (Pointer-to-Member Operator) ๐

ุนูุงูู ุจุฑ ุนููฺฏุฑูุง `&` ู `*`ุ C# ุนููฺฏุฑ ุณุจฺฉ C++ ุนู `->` ุฑุง ูุฒ ุงุฑุงุฆู ูโุฏูุฏ ฺฉู ูโุชูุงู ุงุฒ ุขู ุฑู `struct`ูุง ุงุณุชูุงุฏู ฺฉุฑุฏ:

```csharp
Test test = new Test();
unsafe
{
    Test* p = &test;
    p->X = 9;
    System.Console.WriteLine(test.X);
}
struct Test { public int X; }
```

---

### ฺฉูุฏูุงฺู stackalloc ๐

ุจุง ุงุณุชูุงุฏู ุงุฒ `stackalloc` ูโุชูุงูุฏ ุญุงูุธูโุง ุฑุง ุจูโุทูุฑ ูุณุชูู ุฏุฑ **ุงุณุชฺฉ** ุงุฎุชุตุงุต ุฏูุฏ. ฺูู ุฑู ุงุณุชฺฉ ุชุฎุตุต ูโุงุจุฏุ ุทูู ุนูุฑ ุขู ูุญุฏูุฏ ุจู ุงุฌุฑุง ูุชุฏ ุงุณุชุ ููุงููุฏ ูุชุบุฑูุง ูุญู ุฏฺฏุฑ ฺฉู ุชูุณุท lambdaุ iterator ุง ูุชุฏ async ุงูุฒุงุด ุทูู ุนูุฑ ูุงูุชูโุงูุฏ. ุจููฺฉ ูโุชูุงูุฏ ุงุฒ ุนููฺฏุฑ `[]` ุจุฑุง ุฏุณุชุฑุณ ุจู ุญุงูุธู ุงุณุชูุงุฏู ฺฉูุฏ:

```csharp
int* a = stackalloc int[10];
for (int i = 0; i < 10; ++i)
    Console.WriteLine(a[i]);
```

ุฏุฑ ูุตู ฒณุ ูุดุงู ุฏุงุฏู ูโุดูุฏ ฺฺฏููู ูโุชูุงู ุจุง `Span<T>` ุญุงูุธู ุงุฎุชุตุงุตโุงูุชู ุฑู ุงุณุชฺฉ ุฑุง ุจุฏูู ุงุณุชูุงุฏู ุงุฒ `unsafe` ูุฏุฑุช ฺฉุฑุฏ:

```csharp
Span<int> a = stackalloc int[10];
for (int i = 0; i < 10; ++i)
    Console.WriteLine(a[i]);
```

---

### ุจุงูุฑูุง ุจุง ุงูุฏุงุฒู ุซุงุจุช (Fixed-Size Buffers) ๐งฑ

ฺฉูุฏูุงฺู `fixed` ฺฉุงุฑุจุฑุฏ ุฏฺฏุฑ ูุฒ ุฏุงุฑุฏ: ุงุฌุงุฏ ุจุงูุฑูุง ุจุง ุงูุฏุงุฒู ุซุงุจุช ุฏุฑูู `struct`ูุง (ููุฏ ุจุฑุง ูุฑุงุฎูุงู ุชูุงุจุน unmanagedุ ูุตู ฒด).

```csharp
unsafe struct UnsafeUnicodeString
{
    public short Length;
    public fixed byte Buffer[30];   // ุชุฎุตุต ณฐ ุจุงุช
}

unsafe class UnsafeClass
{
    UnsafeUnicodeString uus;

    public UnsafeClass(string s)
    {
        uus.Length = (short)s.Length;
        fixed (byte* p = uus.Buffer)
            for (int i = 0; i < s.Length; i++)
                p[i] = (byte)s[i];
    }
}

new UnsafeClass("Christian Troy");
```

ูฺฉุงุช ููู:

+ ุจุงูุฑูุง ุจุง ุงูุฏุงุฒู ุซุงุจุช ุขุฑุงู ูุณุชูุฏุ ุงฺฏุฑ `Buffer` ุขุฑุงู ุจูุฏุ ุดุงูู ูุฑุฌุน ุจู ุดุก ุฑู heap ูุฏุฑุชโุดุฏู ูโุดุฏุ ูู ณฐ ุจุงุช ุฏุงุฎู ุฎูุฏ `struct`.
+ ฺฉูุฏูุงฺู `fixed` ุฏุฑ ุงู ูุซุงู ููฺูู ุดุก ุฑู heap (ููููู `UnsafeClass`) ุฑุง ุณูุฌุงู ูโฺฉูุฏ. ุจูุงุจุฑุงู `fixed` ุฏู ูุนูุง ุฏุงุฑุฏ: **ุซุงุจุช ุฏุฑ ุงูุฏุงุฒู** ู **ุซุงุจุช ุฏุฑ ูฺฉุงู**. ุงุบูุจ ุจุง ูู ุงุณุชูุงุฏู ูโุดููุฏุ ุฒุฑุง ฺฉ ุจุงูุฑ ุจุง ุงูุฏุงุฒู ุซุงุจุช ุจุงุฏ ุฏุฑ ูฺฉุงู ุซุงุจุช ุจุงุดุฏ ุชุง ูุงุจู ุงุณุชูุงุฏู ุจุงุดุฏ.

### ุงุดุงุฑูโฺฏุฑ void (`void*`) ๐น

ฺฉ **ุงุดุงุฑูโฺฏุฑ void** (`void*`) ูฺ ูุฑุถ ุฏุฑุจุงุฑู ููุน ุฏุงุฏู ูพุงู ูุฏุงุฑุฏ ู ุจุฑุง ุชูุงุจุน ฺฉู ุจุง ุญุงูุธู ุฎุงู ฺฉุงุฑ ูโฺฉููุฏ ููุฏ ุงุณุช. ุชุจุฏู ุถูู ุงุฒ ูุฑ ููุน ุงุดุงุฑูโฺฏุฑ ุจู `void*` ูุฌูุฏ ุฏุงุฑุฏ.

ูฺฉุงุช ููู:

+ ฺฉ `void*` ูุงุจู **ุฏุณุชุฑุณ ูุณุชูู (dereference)** ูุณุช.
+ ุนููุงุช ุญุณุงุจ ุฑู ุงุดุงุฑูโฺฏุฑูุง void ุงูฺฉุงูโูพุฐุฑ ูุณุช.

ูุซุงู:

```csharp
short[] a = { 1, 1, 2, 3, 5, 8, 13, 21, 34, 55 };
unsafe
{
    fixed (short* p = a)
    {
        // sizeof ุงูุฏุงุฒู ููุน ููุฏุงุฑ ุฑุง ุจุฑุญุณุจ ุจุงุช ุจุฑูโฺฏุฑุฏุงูุฏ
        Zap(p, a.Length * sizeof(short));
    }
}

foreach (short x in a)
    Console.WriteLine(x);   // ููู ููุงุฏุฑ ุตูุฑ ฺุงูพ ูโุดููุฏ

unsafe void Zap(void* memory, int byteCount)
{
    byte* b = (byte*)memory;
    for (int i = 0; i < byteCount; i++)
        *b++ = 0;
}
```

---

### ุงุนุฏุงุฏ ุจุง ุงูุฏุงุฒู ุจูู (Native-Sized Integers) ๐งฎ

ููุนโูุง `nint` ู `nuint` (ูุนุฑู ุดุฏู ุฏุฑ C# 9) ุงูุฏุงุฒูโุง ูุทุงุจู ูุถุง ุขุฏุฑุณ ูพุฑุฏุงุฒุด ุฏุฑ ุฒูุงู ุงุฌุฑุง ุฏุงุฑูุฏ (ุฏุฑ ุนููุ ณฒ ุง ถด ุจุช). ุงู ููุนโูุง ูุงููุฏ ุงุนุฏุงุฏ ุงุณุชุงูุฏุงุฑุฏ ุฑูุชุงุฑ ูโฺฉููุฏ ู ุงุฒ ุนููุงุช ุญุณุงุจ ู ุจุฑุฑุณ ุณุฑุฑุฒ (overflow) ูพุดุชุจุงู ฺฉุงูู ุฏุงุฑูุฏ:

```csharp
nint x = 123, y = 234;
checked
{
    nint sum = x + y, product = x * y;
    Console.WriteLine(product);
}
```

ูฺฺฏโูุง:

+ ูโุชูุงู ุจู ุขูโูุง ููุงุฏุฑ ุตุญุญ ณฒ ุจุช ุฏุงุฏุ ุงูุง ูู ถด ุจุช (ููฺฉู ุงุณุช ุฏุฑ ุฒูุงู ุงุฌุฑุง ุณุฑุฑุฒ ุฑุฎ ุฏูุฏ).
+ ุชุจุฏู ุจู ุง ุงุฒ ุฏฺฏุฑ ููุนโูุง ุนุฏุฏ ุตุญุญ ุจุง cast ุตุฑุญ ุงูฺฉุงูโูพุฐุฑ ุงุณุช.
+ ูโุชูุงู ุงุฒ ุขูโูุง ุจุฑุง ููุงุด ุขุฏุฑุณ ุญุงูุธู ุง ุขูุณุช ุจุฏูู ุงุณุชูุงุฏู ุงุฒ ุงุดุงุฑูโฺฏุฑ ุงุณุชูุงุฏู ฺฉุฑุฏ.
+ `nuint` ุจุฑุง ููุงุด ุทูู ฺฉ ุจูุงฺฉ ุญุงูุธู ููุงุณุจ ุงุณุช.

ูุซุงู ุจุฑุง ุจูุจูุฏ ฺฉุงุฑุง ููฺฏุงู ฺฉุงุฑ ุจุง ุงุดุงุฑูโฺฏุฑูุง:

```csharp
unsafe nint AddressDif(char* x, char* y) => (nint)x - (nint)y;
```

ฺฉ ูุซุงู ูุงูุน ุงุฒ ฺฉุงุฑุจุฑุฏ `nint` ู `nuint` ุฏุฑ ฺฉูุงุฑ ุงุดุงุฑูโฺฏุฑูุงุ ูพุงุฏูโุณุงุฒ `Buffer.MemoryCopy` ุงุณุช.

---

### ุฑูุชุงุฑ ุฒูุงู ุงุฌุฑุง ุฏุฑ .NET 7+ โ๏ธ

ุฏุฑ ูพุฑูฺูโูุง ฺฉู ูุฏู ุขูโูุง .NET 7 ุง ุจุงูุงุชุฑ ุงุณุชุ `nint` ู `nuint` ูุนุงุฏู `System.IntPtr` ู `System.UIntPtr` ุนูู ูโฺฉููุฏุ ูุดุงุจู ุงูฺฉู `int` ูุนุงุฏู `System.Int32` ุงุณุช.

+ `IntPtr` ู `UIntPtr` ุงุฒ .NET 7 ุจู ุจุนุฏ ูุงุจูุช ุงูุฌุงู ุนููุงุช ุญุณุงุจ ู ุจุฑุฑุณ ุณุฑุฑุฒ ุจุง ฺฉุงููพุงูุฑ C# ุฑุง ุฏุงุฑูุฏ.
+ ุงุถุงูู ุดุฏู ูุงุจูุช ุญุณุงุจ checked ุจู IntPtr/UIntPtr ฺฉ ุชุบุฑ ูู ุดฺฉุณุชู ุณุงุฒฺฏุงุฑ ูุญุณูุจ ูโุดูุฏุ ุงูุง ุงุซุฑ ุขู ูุญุฏูุฏ ุงุณุช ู ููุท ุฏุฑ ุตูุฑุช ฺฉู ูพุฑูฺู ุฏูุจุงุฑู ุจุง ูุฏู .NET 7+ ฺฉุงููพุงู ุดูุฏุ ููฺฉู ุงุณุช ุฑุฎ ุฏูุฏ.

---

### ุฑูุชุงุฑ ุฒูุงู ุงุฌุฑุง ุฏุฑ .NET 6 ุง ูพุงูโุชุฑ โก

ุฏุฑ ูพุฑูฺูโูุง ฺฉู ูุฏู ุขูโูุง .NET 6 ุง ูพุงูโุชุฑ ุงุณุชุ `nint` ู `nuint` ูููุฒ ุงุฒ `IntPtr` ู `UIntPtr` ุงุณุชูุงุฏู ูโฺฉููุฏ.

+ ฺูู ููุนโูุง ูุฏู `IntPtr` ู `UIntPtr` ุงฺฉุซุฑ ุนููุงุช ุญุณุงุจ ุฑุง ูพุดุชุจุงู ููโฺฉููุฏุ ฺฉุงููพุงูุฑ ุฎูุงูุง ุฑุง ูพุฑ ูโฺฉูุฏ ุชุง ุฑูุชุงุฑ `nint`/`nuint` ูุดุงุจู .NET 7+ ุดูุฏ.
+ ูโุชูุงู ุชุตูุฑ ฺฉุฑุฏ ฺฉู ฺฉ ูุชุบุฑ `nint`/`nuint` ูุงููุฏ `IntPtr`/`UIntPtr` ุจุง ฺฉ ยซฺฉูุงู ูฺูยป ุงุณุช ฺฉู ฺฉุงููพุงูุฑ ุขู ุฑุง ุจูโุนููุงู ฺฉ IntPtr/UIntPtr ูุฏุฑู ูโุดูุงุณุฏ.
+ ุงู ฺฉูุงู ุฏุฑ ุตูุฑุช ุชุจุฏู ุจู IntPtr/UIntPtr ุงุฒ ุจู ูโุฑูุฏ:

```csharp
nint x = 123;
Console.WriteLine(x * x);   // ุฏุฑุณุช: ุถุฑุจ ูพุดุชุจุงู ูโุดูุฏ
IntPtr y = x;
Console.WriteLine(y * y);   // ุฎุทุง ฺฉุงููพุงู: ุนููฺฏุฑ * ูพุดุชุจุงู ููโุดูุฏ
```

---

### ุงุดุงุฑูโฺฏุฑูุง ุชุงุจุน (Function Pointers) ๐

ฺฉ **ุงุดุงุฑูโฺฏุฑ ุชุงุจุน** (ูุนุฑู ุฏุฑ C# 9) ูุงููุฏ delegate ุงุณุช ุงูุง ุจุฏูู ูุงุณุทู ููููู delegateุ ูุณุชููุงู ุจู ุขุฏุฑุณ ฺฉ ูุชุฏ ุงุดุงุฑู ูโฺฉูุฏ.

ูฺฺฏโูุง:

+ ููุท ุจู ูุชุฏูุง ุงุณุชุง (static) ุงุดุงุฑู ูโฺฉูุฏ.
+ ูุงุจูุช multicast ูุฏุงุฑุฏ.
+ ูุงุฒููุฏ ุฒููู `unsafe` ุงุณุช (ุฒุฑุง ุงุฒ ุจุฑุฑุณ ููุน ุฒูุงู ุงุฌุฑุง ุนุจูุฑ ูโฺฉูุฏ).
+ ูุฏู ุงุตู: ุณุงุฏูโุณุงุฒ ู ุจูููโุณุงุฒ ุชุนุงูู ุจุง APIูุง unmanaged.

ุชุนุฑู ููุน ุงุดุงุฑูโฺฏุฑ ุชุงุจุน:

```csharp
delegate*<int, char, string, void>   // void ููุน ุจุงุฒฺฏุดุช ุงุณุช
```

ูุทุงุจู ุชุงุจุน ุฒุฑ:

```csharp
void SomeFunction(int x, char y, string z)
```

ุนููฺฏุฑ `&` ฺฉ ุงุดุงุฑูโฺฏุฑ ุชุงุจุน ุงุฒ ฺฏุฑูู ูุชุฏ ุงุฌุงุฏ ูโฺฉูุฏ. ูุซุงู ฺฉุงูู:

```csharp
unsafe
{
    delegate*<string, int> functionPointer = &GetLength;
    int length = functionPointer("Hello, world");
    static int GetLength(string s) => s.Length;
}
```

ูฺฉุงุช ููู:

+ `functionPointer` ฺฉ ุดุก ูุณุช ฺฉู ุจุชูุงู ุฑู ุขู `Invoke` ูุฑุงุฎูุงู ฺฉุฑุฏ.
+ ูุณุชููุงู ุจู ุขุฏุฑุณ ุญุงูุธู ูุชุฏ ูุฏู ุงุดุงุฑู ูโฺฉูุฏ:

```csharp
Console.WriteLine((IntPtr)functionPointer);
```

+ ูุงููุฏ ูุฑ ุงุดุงุฑูโฺฏุฑ ุฏฺฏุฑุ ุจุฑุฑุณ ููุน ุฒูุงู ุงุฌุฑุง ูุฏุงุฑุฏ.
+ ููููู ุฒุฑ ูุชุฌู ุชุงุจุน ุฑุง ุจู `decimal` ุชุจุฏู ูโฺฉูุฏ ู ููฺฉู ุงุณุช ุญุงูุธู ุชุตุงุฏู ุฏุฑ ุฎุฑูุฌ ุฏุฎู ุดูุฏ:

```csharp
var pointer2 = (delegate*<string, decimal>)(IntPtr)functionPointer;
Console.WriteLine(pointer2("Hello, unsafe world"));
```

### `[SkipLocalsInit]` โก

ููุช C# ฺฉ ูุชุฏ ุฑุง ฺฉุงููพุงู ูโฺฉูุฏุ ฺฉ flag ุชููุฏ ูโฺฉูุฏ ฺฉู ุจู runtime ูโฺฏูุฏ ูุชุบุฑูุง ูุญู ูุชุฏ ุฑุง ุจู ููุงุฏุฑ ูพุดโูุฑุถุดุงู ููุฏุงุฑุฏู ฺฉูุฏ (ุจุง ุตูุฑ ฺฉุฑุฏู ุญุงูุธู).

ุงุฒ C# 9 ุจู ุจุนุฏุ ูโุชูุงูุฏ ุงุฒ ฺฉุงููพุงูุฑ ุจุฎูุงูุฏ ุงู flag ุฑุง ุชููุฏ ูฺฉูุฏ ุจุง ุงุนูุงู **attribute** `[SkipLocalsInit]` ุฑู ฺฉ ูุชุฏ (ุฏุฑ namespace `System.Runtime.CompilerServices`):

```csharp
[SkipLocalsInit]
void Foo() ...
```

ูโุชูุงูุฏ ุงู attribute ุฑุง ุฑู ฺฉ ููุน (type) ุงุนูุงู ฺฉูุฏโฺฉู ูุนุงุฏู ุงุนูุงู ุขู ุฑู ููู ูุชุฏูุง ุขู ููุน ุงุณุชโุง ุญุช ุฑู ฺฉู ฺฉ ูุงฺูู (module) ฺฉู ูุญุชูุง ฺฉ assembly ุงุณุช:

```csharp
[module: System.Runtime.CompilerServices.SkipLocalsInit]
```

ุฏุฑ ุณูุงุฑููุง ุงูู ูุนูููุ `[SkipLocalsInit]` ุชุฃุซุฑ ุฒุงุฏ ุฑู ุนููฺฉุฑุฏ ุง ฺฉุงุฑฺฉุฑุฏ ูุฏุงุฑุฏุ ฺูู **ูุงููู ุชุฎุตุต ูุทุน (definite assignment)** ุฏุฑ C# ูุงุฒ ุฏุงุฑุฏ ฺฉู ูุชุบุฑูุง ูุญู ูุจู ุงุฒ ุฎูุงูุฏู ุดุฏู ููุฏุงุฑุฏู ุดููุฏ. ุงู ุจุฏุงู ูุนูุงุณุช ฺฉู JIT optimizer ุงุญุชูุงูุงู ููุงู ฺฉุฏ ูุงุดู ุฑุง ุชููุฏ ูโฺฉูุฏุ ฺู attribute ุงุนูุงู ุดุฏู ุจุงุดุฏ ุง ูู.

ุงูุง ุฏุฑ ุฒููู unsafeุ ุงุณุชูุงุฏู ุงุฒ `[SkipLocalsInit]` ูโุชูุงูุฏ ุจุงุฑ CLR ุจุฑุง ููุฏุงุฑุฏู ุงููู ูุชุบุฑูุง ูุญู ุงุฒ ููุน value ุฑุง ฺฉุงูุด ุฏูุฏ ู ุจุงุนุซ **ุงูุฒุงุด ุฌุฒุฆ ุนููฺฉุฑุฏ** ุดูุฏุ ูุฎุตูุตุงู ุฏุฑ ูุชุฏูุง ฺฉู ุงุณุชูุงุฏู ุฒุงุฏ ุงุฒ ุงุณุชฺฉ ุฏุงุฑูุฏ (ูุซูุงู ุจุง stackalloc ุจุฒุฑฺฏ). ูุซุงู ุฒุฑ ุญุงูุธู ููุฏุงุฑุฏูโูุดุฏู ุฑุง ฺุงูพ ูโฺฉูุฏ ููุช `[SkipLocalsInit]` ุงุนูุงู ุดุฏู ุจุงุดุฏ (ุจู ุฌุง ุตูุฑ):

```csharp
[SkipLocalsInit]
unsafe void Foo()
{
    int local;
    int* ptr = &local;
    Console.WriteLine(*ptr);

    int* a = stackalloc int[100];
    for (int i = 0; i < 100; ++i) Console.WriteLine(a[i]);
}
```

ุฌุงูุจ ุงู ฺฉู ูโุชูุงู ุจู ููุงู ูุชุฌู ุฏุฑ ูุญุท โุงููโ ุจุง ุงุณุชูุงุฏู ุงุฒ `Span<T>` ุฑุณุฏ:

```csharp
[SkipLocalsInit]
void Foo()
{
    Span<int> a = stackalloc int[100];
    for (int i = 0; i < 100; ++i) Console.WriteLine(a[i]);
}
```

ุจูุงุจุฑุงูุ ุงุณุชูุงุฏู ุงุฒ `[SkipLocalsInit]` ูุงุฒ ุฏุงุฑุฏ ฺฉู ูพุฑูฺู ุดูุง ุจุง `<AllowUnsafeBlocks>` ุจุฑุงุจุฑ `true` ฺฉุงููพุงู ุดูุฏโุญุช ุงฺฏุฑ ูฺ ูุชุฏ unsafe ุนูุงูุชโฺฏุฐุงุฑ ูุดุฏู ุจุงุดุฏ.

---

### ุฏุณุชูุฑุงุช ูพุดโูพุฑุฏุงุฒูุฏู (Preprocessor Directives) ๐๏ธ

ุฏุณุชูุฑุงุช ูพุดโูพุฑุฏุงุฒูุฏู ุจู ฺฉุงููพุงูุฑ ุงุทูุงุนุงุช ุงุถุงู ุฏุฑุจุงุฑู ุจุฎุดโูุง ฺฉุฏ ูโุฏููุฏ. ุฑุงุฌโุชุฑู ุขูโูุง **ุฏุณุชูุฑุงุช ุดุฑุท** ูุณุชูุฏ ฺฉู ุฑุงู ุจุฑุง ุดุงูู ุง ุญุฐู ุจุฎุดโูุง ุงุฒ ฺฉุฏ ุฏุฑ ุฒูุงู ฺฉุงููพุงู ูุฑุงูู ูโฺฉููุฏ:

```csharp
#define DEBUG

class MyClass
{
    int x;
    void Foo()
    {
        #if DEBUG
            Console.WriteLine("Testing: x = {0}", x);
        #endif
    }
    ...
}
```

ุฏุฑ ุงู ูุซุงูุ ุฏุณุชูุฑ ุฏุงุฎู `Foo` ูุดุฑูุท ุจู ูุฌูุฏ ุณูุจู `DEBUG` ฺฉุงููพุงู ูโุดูุฏ. ุงฺฏุฑ ุณูุจู `DEBUG` ุญุฐู ุดูุฏุ ุฏุณุชูุฑ ฺฉุงููพุงู ููโุดูุฏ.

ูโุชูุงู ุณูุจูโูุง ูพุดโูพุฑุฏุงุฒูุฏู ุฑุง ุฏุฑ ูุงู ุณูุฑุณ ุชุนุฑู ฺฉุฑุฏ ุง ุฏุฑ ุณุทุญ ูพุฑูฺู ุฏุฑ ูุงู `.csproj`:

```xml
<PropertyGroup>
    <DefineConstants>DEBUG;ANOTHERSYMBOL</DefineConstants>
</PropertyGroup>
```

ุจุง ุฏุณุชูุฑุงุช `#if` ู `#elif` ูโุชูุงู ุงุฒ ุนููฺฏุฑูุง `||`ุ `&&` ู `!` ุจุฑุง ุงูุฌุงู ุนููุงุช **orุ and ู not** ุฑู ฺูุฏ ุณูุจู ุงุณุชูุงุฏู ฺฉุฑุฏ. ูุซุงู:

```csharp
#if TESTMODE && !DEBUG
    ...
#endif
```

ุชูุฌู ฺฉูุฏ ฺฉู ุงู ฺฉ ุนุจุงุฑุช ูุนููู C# ูุณุช ู ุณูุจูโูุง ูฺ ุงุฑุชุจุงุท ุจุง ูุชุบุฑูุงโฺู static ู ฺู ุบุฑโูุฏุงุฑูุฏ.

---

### `#error` ู `#warning` โ๏ธ

ุงู ุฏุณุชูุฑุงุช ุงุฒ ุณูุกุงุณุชูุงุฏู ุชุตุงุฏู ุงุฒ ุฏุณุชูุฑุงุช ุดุฑุท ุฌููฺฏุฑ ูโฺฉููุฏุ ุจุง ุงุฌุงุฏ **ูุดุฏุงุฑ ุง ุฎุทุง ุชูุณุท ฺฉุงููพุงูุฑ** ุฏุฑ ุตูุฑุช ูุฌููุนู ูุงูุทููุจ ุงุฒ ุณูุจูโูุง.

ุฌุฏูู ด-ฑ ููุฑุณุช ุฏุณุชูุฑุงุช ูพุดโูพุฑุฏุงุฒูุฏู ุฑุง ุงุฑุงุฆู ูโุฏูุฏ.
<div align="center">

![Conventions-UsedThis-Book](../../../assets/image/04/Table-4-3.jpeg)
</div>

### Conditional Attributes ๐ฏ

ฺฉ **attribute** ฺฉู ุจุง `Conditional` ุชุฒุฆู ุดุฏู ุจุงุดุฏุ ุชููุง ุฏุฑ ุตูุฑุช ฺฉุงููพุงู ูโุดูุฏ ฺฉู **ุณูุจู ูพุดโูพุฑุฏุงุฒูุฏู ูุดุฎุต ุดุฏู** ููุฌูุฏ ุจุงุดุฏ:

```csharp
// file1.cs
#define DEBUG
using System;
using System.Diagnostics;

[Conditional("DEBUG")]
public class TestAttribute : Attribute {}

// file2.cs
#define DEBUG
[Test]
class Foo
{
    [Test]
    string s;
}
```

ฺฉุงููพุงูุฑ ุชููุง ุฒูุงู attributeูุง `[Test]` ุฑุง ุฏุฑ ูุงู `file2.cs` ูุงุฑุฏ ูโฺฉูุฏ ฺฉู ุณูุจู `DEBUG` ุฏุฑ ูุญุฏูุฏู ุขู ูุงู ุชุนุฑู ุดุฏู ุจุงุดุฏ.

---

### Pragma Warning โ๏ธ

ฺฉุงููพุงูุฑ ููุช ฺุฒ ุฏุฑ ฺฉุฏ ุดูุง ุฑุง ุบุฑุนูุฏ ุชุดุฎุต ุฏูุฏุ ฺฉ **ูุดุฏุงุฑ (warning)** ุงุฌุงุฏ ูโฺฉูุฏ. ุจุฑ ุฎูุงู ุฎุทุงูุงุ ูุดุฏุงุฑูุง ูุนูููุงู ูุงูุน ฺฉุงููพุงู ุดุฏู ุจุฑูุงูู ููโุดููุฏ.

ูุดุฏุงุฑูุง ฺฉุงููพุงูุฑ ุจุณุงุฑ ููุฏูุฏ ุจุฑุง ุดูุงุณุง ุจุงฺฏโูุงุ ุงูุง ููุช ูุดุฏุงุฑูุง ฺฉุงุฐุจ ุฒุงุฏ ุดููุฏุ ููุฏ ุจูุฏูุดุงู ฺฉุงูุด ูโุงุจุฏ. ุฏุฑ ุจุฑูุงููโูุง ุจุฒุฑฺฏุ ุญูุธ **ูุณุจุช ุณฺฏูุงู ุจู ููุฒ** ุจุฑุง ูุดุงูุฏู ูุดุฏุงุฑูุง ูุงูุน ุถุฑูุฑ ุงุณุช.

ุจุฑุง ุงู ููุธูุฑุ ูโุชูุงูุฏ ูุดุฏุงุฑูุง ุฑุง ุจูโุตูุฑุช ุงูุชุฎุงุจ ุจุง ุฏุณุชูุฑ `#pragma warning` ุบุฑูุนุงู ฺฉูุฏ. ูุซุงู:

```csharp
public class Foo
{
    static void Main() { }

    #pragma warning disable 414
    static string Message = "Hello";   // ุงู ูุดุฏุงุฑ ุบุฑูุนุงู ุดุฏ
    #pragma warning restore 414
}
```

ุงฺฏุฑ ุดูุงุฑู ูุดุฏุงุฑ ุฏุฑ ุฏุณุชูุฑ `#pragma warning` ุญุฐู ุดูุฏุ ููู ูุดุฏุงุฑูุง ุบุฑูุนุงู ุง ูุนุงู ูโุดููุฏ.
ุจุง ุฏูุช ุฏุฑ ุงุณุชูุงุฏู ุงุฒ ุงู ุฏุณุชูุฑุ ูโุชูุงู ูพุฑูฺู ุฑุง ุจุง ุณูุฆฺ `/warnaserror` ฺฉุงููพุงู ฺฉุฑุฏโฺฉู ุจุงุนุซ ูโุดูุฏ ูุฑ ูุดุฏุงุฑ ุจุงููุงูุฏู ุจู ฺฉ **ุฎุทุง** ุชุจุฏู ุดูุฏ.

---

### ูุณุชูุฏุณุงุฒ XML ๐

ฺฉ **ฺฉุงููุช ูุณุชูุฏุณุงุฒ (documentation comment)**ุ ุชฺฉูโุง ุงุฒ XML ุงุณุช ฺฉู ฺฉ ููุน ุง ุนุถู ุฑุง ูุณุชูุฏ ูโฺฉูุฏ. ุงู ฺฉุงููุช ุฏุฑุณุช ูุจู ุงุฒ ุชุนุฑู ููุน ุง ุนุถู ูุฑุงุฑ ูโฺฏุฑุฏ ู ุจุง ุณู ุงุณูุด `///` ุดุฑูุน ูโุดูุฏ:

```csharp
/// <summary>Cancels a running query.</summary>
public void Cancel() { ... }
```

ฺฉุงููุชโูุง ฺูุฏุฎุท ุจู ุงู ุตูุฑุช ูุณุชูุฏ:

```csharp
/// <summary>
/// Cancels a running query
/// </summary>
public void Cancel() { ... }
```

ุง ุจู ุงู ุดฺฉู (ุจุง ุณุชุงุฑู ุงุถุงู):

```csharp
/** 
    <summary> Cancels a running query. </summary>
*/
public void Cancel() { ... }
```

ุงฺฏุฑ ฺฏุฒูู ุฒุฑ ุจู ูุงู `.csproj` ุงุถุงูู ุดูุฏ:

```xml
<PropertyGroup>
    <DocumentationFile>SomeFile.xml</DocumentationFile>
</PropertyGroup>
```

ฺฉุงููพุงูุฑ **ฺฉุงููุชโูุง ูุณุชูุฏุณุงุฒ** ุฑุง ุงุณุชุฎุฑุงุฌ ู ุฏุฑ ูุงู XML ูุดุฎุต ุดุฏู ุฌูุนโุขูุฑ ูโฺฉูุฏ. ฺฉุงุฑุจุฑุฏูุง:

+ ุงฺฏุฑ ุฏุฑ ููุงู ูููุฏุฑ ุงุณูุจู ฺฉุงููพุงูโุดุฏู ูุฑุงุฑ ฺฏุฑุฏุ ุงุจุฒุงุฑูุง ูุซู **Visual Studio** ู **LINQPad** ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ูุงู XML ุฑุง ูโุฎูุงููุฏ ู ุงุฒ ุขู ุจุฑุง ุงุฑุงุฆู IntelliSense ุงุณุชูุงุฏู ูโฺฉููุฏ.
+ ุงุจุฒุงุฑูุง ุฌุงูุจ (ูุซู Sandcastle ู NDoc) ูโุชูุงููุฏ ูุงู XML ุฑุง ุจู HTML ุชุจุฏู ฺฉููุฏ.

---

### ุชฺฏโูุง ุงุณุชุงูุฏุงุฑุฏ XML ุจุฑุง ูุณุชูุฏุณุงุฒ ๐

ุชฺฏโูุง ุงุณุชุงูุฏุงุฑุฏ XML ฺฉู Visual Studio ู ุงุจุฒุงุฑูุง ุชููุฏ ูุณุชูุฏุงุช ูโุดูุงุณูุฏ:

+ `<summary>`
  ุชูุถุญ ฺฉูุชุงู ฺฉู IntelliSense ููุงุด ูโุฏูุฏุ ูุนูููุงู ฺฉ ุฌููู ุง ุนุจุงุฑุช ฺฉูุชุงู ุงุณุช.
+ `<remarks>`
  ูุชู ุงุถุงู ฺฉู ููุน ุง ุนุถู ุฑุง ุดุฑุญ ูโุฏูุฏ. ุงุจุฒุงุฑูุง ูุณุชูุฏุณุงุฒ ุงู ูุชู ุฑุง ุฏุฑ ุชูุถุญ ฺฉู ุงุฏุบุงู ูโฺฉููุฏ.
+ `<param>`
  ุชูุถุญ ูพุงุฑุงูุชุฑ ฺฉ ูุชุฏ:

  ```xml
  <param name="name">...</param>
  ```

* `<returns>`
  ุชูุถุญ ููุฏุงุฑ ุจุฑฺฏุดุช ฺฉ ูุชุฏ.
+ `<exception>`
  ูุณุช ุงุณุชุซูุงูุง ฺฉู ูุชุฏ ูโุชูุงูุฏ ูพุฑุชุงุจ ฺฉูุฏ:

  ```xml
  <exception cref="type">...</exception>
  ```

* `<example>`
  ูุซุงู ุนูู (ุดุงูู ุชูุถุญ ู ฺฉุฏ ููููู):

  ```xml
  <example>
      <code>...</code>
  </example>
  ```

* `<c>` ู `<code>`

  + `<c>`: ูุทุนู ฺฉุฏ ุฎุท ุฏุงุฎู ูุซุงู.
  + `<code>`: ููููู ฺฉุฏ ฺูุฏุฎุท ุฏุงุฎู ูุซุงู.
+ `<see>`
  ุงุฑุฌุงุน ุฏุงุฎู ุจู ฺฉ ููุน ุง ุนุถู ุฏฺฏุฑ:

  ```xml
  <see cref="member">...</see>
  ```

* `<seealso>`
  ุงุฑุฌุงุน ูุชูุงุจู ุจู ููุน ุง ุนุถู ุฏฺฏุฑุ ูุนูููุงู ุฏุฑ ุจุฎุด โSee Alsoโ.
+ `<paramref>`
  ุงุฑุฌุงุน ุจู ูพุงุฑุงูุชุฑ ุฏุฑ `<summary>` ุง `<remarks>`:

  ```xml
  <paramref name="name"/>
  ```

* `<list>`
  ุงุฌุงุฏ ูุณุช ุจููุชโุฏุงุฑุ ุดูุงุฑูโุฏุงุฑ ุง ุฌุฏูู:

  ```xml
  <list type="bullet|number|table">
      <listheader>
          <term>...</term>
          <description>...</description>
      </listheader>
      <item>
          <term>...</term>
          <description>...</description>
      </item>
  </list>
  ```

* `<para>`
  ุงุฌุงุฏ ฺฉ ูพุงุฑุงฺฏุฑุงู ุฌุฏุง:

  ```xml
  <para>...</para>
  ```

* `<include>`
  ุงุฏุบุงู ฺฉ ูุงู XML ุฎุงุฑุฌ ฺฉู ูุณุชูุฏุงุช ุฑุง ุฏุงุฑุฏ:

  ```xml
  <include file='filename' path='tagpath[@name="id"]'>...</include>
  ```

### User-Defined Tags ๐ท๏ธ

ฺุฒ ุจูโุฎุตูุต ุฏุฑ ููุฑุฏ ุชฺฏโูุง ูพุดโูุฑุถ XML ฺฉู ุชูุณุท ฺฉุงููพุงูุฑ C# ุดูุงุฎุชู ูโุดููุฏ ูุฌูุฏ ูุฏุงุฑุฏ ู ุดูุง ุขุฒุงุฏ ูุณุชุฏ **ุชฺฏโูุง ุฎูุฏุชุงู** ุฑุง ุชุนุฑู ฺฉูุฏ.

ุชููุง ูพุฑุฏุงุฒุด ูฺูโุง ฺฉู ฺฉุงููพุงูุฑ ุงูุฌุงู ูโุฏูุฏ ูุฑุจูุท ุจู:

+ `<param>`: ฺฉู ูุงู ูพุงุฑุงูุชุฑ ุฑุง ุจุฑุฑุณ ูโฺฉูุฏ ู ูุทูุฆู ูโุดูุฏ ุชูุงู ูพุงุฑุงูุชุฑูุง ูุชุฏ ูุณุชูุฏุณุงุฒ ุดุฏู ุจุงุดูุฏ.
+ ุตูุช `cref`: ฺฉู ุจุฑุฑุณ ูโฺฉูุฏ ุงู ุตูุช ุจู ฺฉ ููุน ุง ุนุถู ูุงูุน ุงุฑุฌุงุน ูโุฏูุฏ ู ุขู ุฑุง ุจู ฺฉ **ID ฺฉุงููุงู ูุงุฌุฏ ุดุฑุงุท** ุงุฒ ููุน ุง ุนุถู ฺฏุณุชุฑุด ูโุฏูุฏ.

ููฺูู ูโุชูุงูุฏ ุงุฒ ุตูุช `cref` ุฏุฑ ุชฺฏโูุง ุฎูุฏุชุงู ุงุณุชูุงุฏู ฺฉูุฏุ ฺฉุงููพุงูุฑ ููุงู ุจุฑุฑุณ ู ฺฏุณุชุฑุด ุฑุง ุงูุฌุงู ูโุฏูุฏุ ุฏุฑุณุช ูุงููุฏ ุชฺฏโูุง ูพุดโูุฑุถ `<exception>`, `<permission>`, `<see>`, ู `<seealso>`.

---

### Type or Member Cross-References ๐

ูุงูโูุง ููุน ู ุงุฑุฌุงุนุงุช ูุชูุงุจู ุจู ููุน ุง ุนุถู ุจู **IDูุง ฺฉุชุง** ุชุจุฏู ูโุดููุฏ ฺฉู ููุน ุง ุนุถู ุฑุง ูุดุฎุต ูโฺฉููุฏ.

ุงู ูุงูโูุง ุดุงูู ุฏู ุจุฎุด ูุณุชูุฏ:

1. **ูพุดโููุฏ (prefix)** ฺฉู ูุดุฎุต ูโฺฉูุฏ ID ฺู ฺุฒ ุฑุง ููุงูุฏฺฏ ูโฺฉูุฏ.
2. **ุงูุถุง (signature)** ููุน ุง ุนุถู.

ุฏุฑ ุงุฏุงููุ ูพุดโููุฏูุง ุงุนุถุง (member prefixes) ูุนุฑู ูโุดููุฏ:
<div align="center">

![Conventions-UsedThis-Book](../../../assets/image/04/Table-4-4.jpeg)
</div>

### ูููููโุง ุงุฒ Type ู Member IDs ๐

ููุงุนุฏ ฺฉู ูุดุฎุต ูโฺฉููุฏ **ุงูุถุงูุง (signatures)** ฺฺฏููู ุชููุฏ ูโุดููุฏุ ูุณุชูุฏ ุดุฏูโุงูุฏุ ุงฺฏุฑฺู ูุณุจุชุงู ูพฺุฏู ูุณุชูุฏ.

ุฏุฑ ุงูุฌุง ฺฉ ูุซุงู ุงุฒ ฺฉ ููุน ู IDูุง ุชููุฏุดุฏู ุขู ุขูุฑุฏู ุดุฏู ุงุณุช:

```csharp
// ูุถุงูุง ูุงู (Namespaces) ุงูุถุง ูุณุชูู ูุฏุงุฑูุฏ
namespace NS
{
    /// T:NS.MyClass
    class MyClass
    {
        /// F:NS.MyClass.aField
        string aField;

        /// P:NS.MyClass.aProperty
        short aProperty { get { ... } set { ... } }

        /// T:NS.MyClass.NestedType
        class NestedType { ... }

        /// M:NS.MyClass.X()
        void X() { ... }

        /// M:NS.MyClass.Y(System.Int32,System.Double@,System.Decimal@)
        void Y(int p1, ref double p2, out decimal p3) { ... }

        /// M:NS.MyClass.Z(System.Char[],System.Single[0:,0:])
        void Z(char[] p1, float[,] p2) { ... }

        /// M:NS.MyClass.op_Addition(NS.MyClass,NS.MyClass)
        public static MyClass operator + (MyClass c1, MyClass c2) { ... }

        /// M:NS.MyClass.op_Implicit(NS.MyClass)~System.Int32
        public static implicit operator int(MyClass c) { ... }

        /// M:NS.MyClass.#ctor
        MyClass() { ... }

        /// M:NS.MyClass.Finalize
        ~MyClass() { ... }

        /// M:NS.MyClass.#cctor
        static MyClass() { ... }
    }
}
```

+ `T:` ูพุดโููุฏ ุจุฑุง **Type**
+ `F:` ูพุดโููุฏ ุจุฑุง **Field**
+ `P:` ูพุดโููุฏ ุจุฑุง **Property**
+ `M:` ูพุดโููุฏ ุจุฑุง **Method**

IDูุง ุดุงูู **ูุถุง ูุงูุ ูุงู ฺฉูุงุณุ ู ูุงู ุนุถู** ูุณุชูุฏ ู ุจุฑุง ูุชุฏูุงุ ูพุงุฑุงูุชุฑูุง ู ููุน ุจุงุฒฺฏุดุช ูุฒ ุฏููุงู ูุดุฎุต ูโุดููุฏ.

ุงู ุณุณุชู ุจู **ฺฉุงููพุงูุฑ ู ุงุจุฒุงุฑูุง ูุณุชูุฏุณุงุฒ** ุงุฌุงุฒู ูโุฏูุฏ ุชุง ุงุฑุฌุงุนุงุช ุฏุงุฎู ู ุฎุงุฑุฌ ุฑุง ุจูโุฏุฑุณุช ูพฺฏุฑ ฺฉููุฏ ู ุฎุทุงูุง ุงุญุชูุงู ุฑุง ุชุดุฎุต ุฏููุฏ.
