<!doctype html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ุงุฏุงูู ู Task ูุง ุชู ุฏุฑ ุชู</title>
  <meta name="description" content="ุชุฑุฌููโูุง ูุงุฑุณ ฺฉุชุงุจโูุง ูู โ ุณุฑุนุ ูููุงู ู ูุงุจู ุงุชฺฉุง.">
  <link rel="stylesheet" href="/styles/main.css">
<link rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
<style>
@font-face {
  font-family: 'Vazir';
  src: url('/fonts/Vazir-FD-WOL.ttf') format('truetype');
  font-display: swap;
}
body {
  font-family: 'Vazir', sans-serif;
}
</style>

</head>
<body>
  <!-- ูุฏุฑ ูุดุชุฑฺฉ -->
 <header class="header">
  <div class="container nav-wrap">
    <a href="/" class="brand">
      <img src="/icone/logo.svg" alt="Gitab logo" width="26" height="26">
      <span>Gitab</span>
    </a>

    <nav class="nav">
      <a href="/" aria-current="page">ุฎุงูู</a>
      <a href="/books/list-books">ฺฉุชุงุจโูุง</a>
      <a href="#">ูุชุฑุฌูู</a>
      <a href="#">ููฺฉุงุฑ</a>
      <a href="#">ุฏุฑุจุงุฑู ูุง</a>
    </nav>

    <div class="nav-actions">
     <button id="themeToggle" class="icon-btn theme-btn" data-icon="moon" aria-label="ุชุบุฑ ุชู">
        <img src="/icone/sun.svg" class="icon-sun" alt="ุฑูุดู">
        <img src="/icone/moon.svg" class="icon-moon" alt="ุชุงุฑฺฉ">
      </button>
  <a class="icon-btn" href="https://github.com/hheydarian/Gitab" target="_blank" title="GitHub">
    <img src="/icone/github.svg" alt="GitHub">
  </a>
      <!-- ุฏฺฉูู ููู ุจุฑุง ููุจุงู -->
      <button class="menu-toggle" aria-label=" ููู">
        <img src="/icone/menu.svg" alt="menu">
      </button>
    </div>
  </div> 
  

</header>

 

<main class="site-main book-page ">
  <h1>ูุตู ุณูู: ุงุฏุงูู ู Taskูุง ุชู ุฏุฑ ุชู ๐งต</h1>
<p>ุงู ูุตู ูุฑูุฑ ุจุฑ Task Continuationsุ Taskูุง ุชู ุฏุฑ ุชู (Nested Tasks) ู ููุถูุนุงุช ูุฑุชุจุท ุงุฑุงุฆู ูโุฏูุฏ.</p>
<p>ุดูุง ุฎูุงูุฏ ุขููุฎุช ฺฺฏููู ูโุชูุงู ฺฉุงุฑูุง ุฑุง ูพุณ ุงุฒ ุงุชูุงู ฺฉ Task ุงุฏุงูู ุฏุงุฏ ู ฺฺฏููู Taskูุง ูโุชูุงููุฏ ุฏุงุฎู ฺฉุฏฺฏุฑ ุงุฌุฑุง ุดููุฏ ุชุง ุณุงุฎุชุงุฑ ุจุฑูุงูู ููุธู ู ุจููู ุจุงู ุจูุงูุฏ.</p>
<h2>ูุธุงู ุงุฏุงููโุฏููุฏู (Continuation Tasks) ๐</h2>
<p>ูุฑุถ ฺฉูุฏ ุฏู ูุธูู ุฏุงุฑู ุจู ูุงู Task A ู Task B. ุงฺฏุฑ ุจุฎูุงูุฏ ุงุฌุฑุง Task B ุฑุง ุชููุง ุจุนุฏ ุงุฒ Task A ุดุฑูุน ฺฉูุฏุ ุงุญุชูุงูุงู ูโุฎูุงูุฏ ุงุฒ callbackูุง ุงุณุชูุงุฏู ฺฉูุฏ. ุงูุง TPL ุงู ฺฉุงุฑ ุฑุง ุจุณุงุฑ ุณุงุฏู ูโฺฉูุฏ. ุงู ูุงุจูุช ุงุฒ ุทุฑู ฺฉ <strong>ูุธูู ุงุฏุงููโุฏููุฏู (continuation task)</strong> ูุฑุงูู ูโุดูุฏ ฺฉู ฺุฒ ุฌุฒ ฺฉ <strong>ูุธูู ุบุฑููุฒูุงู (asynchronous task)</strong> ูุณุช. ุงุฏู ููุงู ุงุณุช: ููุช ฺฉ <strong>ูุธูู ูพุดู (antecedent task)</strong> ุจู ูพุงุงู ุฑุณุฏุ ูุธูู ุจุนุฏ ฺฉู ูโุฎูุงูุฏ ุงุฏุงูู ุฏูุฏุ ูุฑุงุฎูุงู ูโุดูุฏ. ุฏุฑ ูุซุงู ูุงุ Task A ููุงู <strong>ูุธูู ูพุดู</strong> ู Task B ููุงู <strong>ูุธูู ุงุฏุงููโุฏููุฏู</strong> ุงุณุช.</p>
<p>ุงุฌุงุฒู ุฏูุฏ ูฺฺฏโูุง ููู ฺฉ <strong>ูุธูู ุงุฏุงููโุฏููุฏู</strong> ุฑุง ุฎูุงุตู ฺฉูู:<br>
โข ฺฉ <strong>ูุธูู ุงุฏุงููโุฏููุฏู</strong> ุชูุณุท ฺฉ ูุธูู ุฏฺฏุฑ ูุฑุงุฎูุงู ูโุดูุฏ. ูโุชูุงูุฏ ุฒูุงู ุดุฑูุน ุดูุฏ ฺฉู ูุธูู ูุจู (ุนู <strong>ูุธูู ูพุดู</strong>) ฺฉุงูู ุดุฏู ุจุงุดุฏ. ุงู ุนู ุงุฏุงููโูุง ฺุฒ ุฌุฒ <strong>ุฒูุฌุฑูโุณุงุฒ ูุธุงู</strong> ูุณุชูุฏ.<br>
โข ุจุง ุงุณุชูุงุฏู ุงุฒ ุงู ูููููุ ูโุชูุงูุฏ <strong>ุฏุงุฏูโูุง (ู ุญุช ุงุณุชุซูุงูุง)</strong> ุฑุง ุงุฒ ฺฉ ูุธูู ูพุดู ุจู ูุธูู ุงุฏุงููโุฏููุฏู ููุชูู ฺฉูุฏ.<br>
โข ุงฺฏุฑ ฺฉ ูุธูู ุบุฑููุฒูุงู ุฏุงุฏูโุง ุจุฑฺฏุฑุฏุงูุฏุ ูโุชูุงูุฏ ุงุฒ ูุธูู ุงุฏุงููโุฏููุฏู ุจุฑุง <strong>ุฏุฑุงูุช ู/ุง ูพุฑุฏุงุฒุด ุขู ุฏุงุฏูโูุง ุจุฏูู ูุณุฏูุฏ ฺฉุฑุฏู ูุฎ ุงุตู</strong> ุงุณุชูุงุฏู ฺฉูุฏ. ุงู ูฺฺฏุ <strong>ุงูุนุทุงูโูพุฐุฑ ุจุงูุง ูุธุงู ุงุฏุงููโุฏููุฏู</strong> ุฑุง ูุดุงู ูโุฏูุฏ.<br>
โข ุงุฏุงููโูุง ูโุชูุงููุฏ ุจู ฺฉ ุง ฺูุฏ <strong>ูุธูู ูพุดู</strong> ูุชุตู ุดููุฏ.<br>
โข ูโุชูุงูุฏ ฺฉ ุง ฺูุฏ <strong>ูุธูู ุงุฏุงููโุฏููุฏู</strong> ุฑุง ูุฑุงุฎูุงู ฺฉูุฏ.<br>
โข ูโุชูุงูุฏ <strong>ฺฉูุชุฑู ูุธูู ุงุฏุงููโุฏููุฏู</strong> ุฑุง ุฏุฑ ุฏุณุช ุจฺฏุฑุฏ. ุจุฑุง ูุซุงูุ ุงฺฏุฑ ุณู ูุธูู ุจู ูุงูโูุง Task Aุ Task B ู Task C ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏุ ูโุชูุงูุฏ ุชุตูู ุจฺฏุฑุฏ ฺฉู Task C ุชููุง ุจุนุฏ ุงุฒ ุงุชูุงู ูุฑ ุฏู Task A ู Task B ุงุฏุงูู ุงุจุฏ. ุง ูโุชูุงูุฏ ุชุนู ฺฉูุฏ ฺฉู Task C ูุงุฒู ูุณุช ููุชุธุฑ ูุฑ ุฏู ุจุงุดุฏ ู ุจู ูุญุถ ุงุชูุงู ูุฑ ฺฉุฏุงูุ ุงุฏุงูู ุงุจุฏ.<br>
โข ููฺูู ูโุชูุงูุฏ ฺฉ <strong>ูุธูู ุงุฏุงููโุฏููุฏู ุฑุง ูุบู (cancel)</strong> ฺฉูุฏ. ุงู ูฺฺฏ ุงุบูุจ ุฏุฑ ุดุฑุงุท ุงุถุทุฑุงุฑ ุง ุฒูุงู ฺฉู ุจุง ฺฉ ุจุงฺฏ ูฺฉุฑุฑ ุฏุฑ ุงุฌุฑุง ุจุฑูุงูู ููุงุฌู ูโุดูุฏุ ููุฏ ุงุณุช.</p>
<hr>
<h3>ุงุฏุงูู ุณุงุฏู (Simple Continuation) ๐ฝ๏ธ</h3>
<p>ูุฑุถ ฺฉูุฏ ูุฑุฏ ุจู ูุงู Jack ูโุฎูุงูุฏ ุฏูุณุชุงูุด ุฑุง ุจู ฺฉ <strong>ูููุงู ุดุงู</strong> ุฏุนูุช ฺฉูุฏ. ุฏุฑ ุณุทุญ ุจุงูุงุ ูุนุงูุช ฺฉู ุฑุง ูโุชูุงู ุจู ุฏู ูุธูู ุชูุณู ฺฉุฑุฏ:<br>
โข ุฏุนูุช ุงุฒ ุฏูุณุชุงู<br>
โข ุณูุงุฑุด ุบุฐุง</p>
<p>ูุฑุถ ฺฉูู Jack ุงุจุชุฏุง ุฏูุณุชุงูุด ุฑุง ุงุฒ ุทุฑู ุชููู ุฏุนูุช ูโฺฉูุฏ. ูพุณ ุงุฒ ุงุชูุงู ุฏุนูุชุ ุงู ูโุฏุงูุฏ ฺูุฏ ููุฑ ูุฑุงุฑ ุงุณุช ุฏุฑ ูููุงู ุดุฑฺฉุช ฺฉููุฏ. ุจุฑ ุงุณุงุณ ุงู ุงุทูุงุนุงุชุ ุญุงูุง ุบุฐุง ุฑุง ุณูุงุฑุด ูโุฏูุฏ. ููุงูโุทูุฑ ฺฉู ูโุจูุฏุ <strong>ุฏุนูุช ุงุฒ ุฏูุณุชุงู</strong> ููุงู <strong>ูุธูู ูพุดู</strong> ู <strong>ุณูุงุฑุด ุบุฐุง</strong> ููุงู <strong>ูุธูู ุงุฏุงููโุฏููุฏู</strong> ุงุณุช.</p>
<p>ุจุงุฏ ุจุฑูุงููโุง ุจููุณู ุชุง ุงู ุณูุงุฑู ุฑุง ุดุจูโุณุงุฒ ฺฉูุฏ.</p>
<p>ุจุฑุง <strong>ูุธูู ุงุฏุงููโุฏููุฏู</strong>ุ ุดูุง ุงุณุชูุงุฏู ุงุฒ ูุชุฏ <code>ContinueWith</code> ุฑุง ูุดุงูุฏู ุฎูุงูุฏ ฺฉุฑุฏ. ุงู ูุชุฏ ฺฉ <strong>ูุธูู ุงุฏุงููโุฏููุฏู</strong> ุงุฌุงุฏ ูโฺฉูุฏ ฺฉู ุฒูุงู ุงุฌุฑุง ูโุดูุฏ ฺฉู <strong>ูุธูู ูุฏู</strong> ฺฉุงูู ุดุฏู ุจุงุดุฏ. ุงู ูุชุฏ ฺูุฏู <strong>ุจุงุฑฺฏุฐุงุฑ ุงุถุงู (overload)</strong> ุฏุงุฑุฏ. ุฏุฑ ุงู ูุซุงูุ ูู ุณุงุฏูโุชุฑู ูุณุฎูโ <code>ContinueWith</code> ุฑุง ุงุณุชูุงุฏู ฺฉุฑุฏูโุงู ฺฉู ฺฉ <strong>Action<Task></strong> ุจู ุนููุงู ูพุงุฑุงูุชุฑ ูโูพุฐุฑุฏ. ุจู ููู ุฏูู ุดูุง ฺฉุฏ ุฒุฑ ุฑุง ูุดุงูุฏู ูโฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> orderTask = inviteTask.ContinueWith(previousTask =&gt;
{
    WriteLine(previousTask.Result);
    <span class="hljs-comment">// ุดุจูโุณุงุฒ ฺฉ ุชุฃุฎุฑ ุจุฑุง ุชููุฏ ุงุฒ ฺฉ ูููุนุช ูุงูุน</span>
    Thread.Sleep(<span class="hljs-number">1000</span>);
    WriteLine(<span class="hljs-string">&quot;Food is ordered now.&quot;</span>);
}
);
</code></pre>
<p>ููุงูโุทูุฑ ฺฉู ูโุจูุฏุ ฺฉ ุชููู ฺฉ ุซุงููโุง ุฏุงุฎู <code>orderTask</code> ฺฏุฐุงุดุชู ุดุฏู ุงุณุช. ุงฺฏุฑฺู ุงู ฺฉุงุฑ ูุงุฒู ูุจูุฏุ ุงูุง ุงู ุฎุท ฺฉุฏ ุจุฑุง ุดุจูโุณุงุฒ <strong>ุชุฃุฎุฑ ุจู ูุธูู ุฏุนูุช ุงุฒ ุฏูุณุชุงู ู ุณูุงุฑุด ุบุฐุง</strong> ูฺฏู ุฏุงุดุชู ุดุฏู ุงุณุช.</p>
<div align="center">
<p><img src="../../../assets/image/03/Table%203-1.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ูฺฉุชู ููู โ๏ธ</p>
<p>ุจุฑุง ุงูฺฉู ุฎุฑูุฌ ฺฉุงูู ุจุฑูุงูู ุฑุง ูุดุงู ุฏููุ ุฏุฑ ุงู ูุซุงู ุงุฒ ูุชุฏ <code>ReadLine</code> ุงุณุชูุงุฏู ฺฉุฑุฏูโุงู ุชุง ุงุฒ ูพุงุงู ุฒูุฏููฺฏุงู ุจุฑูุงูู ฺฉูุณูู ุฌููฺฏุฑ ุดูุฏ. ููู ูฺฉุชู ุฒูุงู ฺฉู ูู ุงุฒ <code>ReadKey</code> ุง <code>ReadLine</code> ุฏุฑ ูุซุงูโูุง ุฏฺฏุฑ ุงู ฺฉุชุงุจ ุงุณุชูุงุฏู ูโฺฉูู ูุฒ ุตุฏู ูโฺฉูุฏ.</p>
<hr>
<h3>ููุงุด 1 (Demonstration 1) ๐ป</h3>
<p>ุฏุฑ ุงูุฌุง ููุงุด ฺฉุงูู ุจุฑูุงูู ุขูุฏู ุงุณุช:</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> <span class="hljs-keyword">static</span> System.Console;

WriteLine(<span class="hljs-string">&quot;The host is planning a party.&quot;</span>);

<span class="hljs-keyword">var</span> inviteTask = Task.Run(() =&gt; <span class="hljs-string">&quot;Invitation is done.&quot;</span>);

<span class="hljs-keyword">var</span> orderTask = inviteTask.ContinueWith(previousTask =&gt;
{
    WriteLine(previousTask.Result);
    <span class="hljs-comment">// ุดุจูโุณุงุฒ ุชุฃุฎุฑ ุจุฑุง ุชููุฏ ุงุฒ ฺฉ ูููุนุช ูุงูุน</span>
    Thread.Sleep(<span class="hljs-number">1000</span>);
    WriteLine(<span class="hljs-string">&quot;Food is ordered now.&quot;</span>);
});

WriteLine(<span class="hljs-string">&quot;The host is decorating the house.&quot;</span>);

ReadLine();
</code></pre>
<h4>ุฎุฑูุฌ (Output) ๐ฅ๏ธ</h4>
<p>ููููู ุฎุฑูุฌ ุจุฑุง ุดูุง ุจู ุงู ุดฺฉู ุฎูุงูุฏ ุจูุฏ:</p>
<pre class="hljs"><code>The host is planning a party.
The host is decorating the house.
Invitation is done.
Food is ordered now.
</code></pre>
<hr>
<h3>ุชุญูู (Analysis) ๐</h3>
<p>ุฎุฑูุฌ ุจุงูุง ูฺฺฏโูุง ุฒุฑ ุฑุง ุชุฃุฏ ูโฺฉูุฏ:<br>
โข <strong>ูุฎ ุงุตู (main thread)</strong> ุฏุฑ ููฺฏุงู ุงุฌุฑุง <strong>ูุธูู ุงุฏุงููโุฏููุฏู</strong> ูุณุฏูุฏ ูุดุฏู ุจูุฏ. ุจู ููู ุฏูู ุฎุท <code>&quot;The host is decorating the house.&quot;</code> ูุจู ุงุฒ ุฎุท <code>&quot;Invitation is done.&quot;</code> ููุงุด ุฏุงุฏู ุดุฏ.<br>
โข ูโุชูุงู ุฏุฏ ฺฉู <strong>ูุธูู ุงุฏุงููโุฏููุฏู</strong> ุจุนุฏ ุงุฒ ุงุชูุงู <strong>ูุธูู ูพุดู</strong> ุขุบุงุฒ ุดุฏ ู ููฺูู <strong>ุฏุงุฏูโูุง ุจุฑฺฏุดุช ุงุฒ ูุธูู ูุงูุฏ/ูพุดู</strong> ุฑุง ุจู ุฏุฑุณุช ูพุฑุฏุงุฒุด ฺฉุฑุฏ.<br>
โข ุฏุฑ ุงู ูุซุงูุ ุฒูุงู ฺฉู ูุธูู ุงุฏุงููโุฏููุฏู ุฎุท <code>WriteLine(previousTask.Result);</code> ุฑุง ูพุฑุฏุงุฒุด ฺฉุฑุฏุ ุบุฑูุณุฏูุฏ ฺฉููุฏู ุจูุฏ. ฺุฑุงุ ุฒุฑุง ูุธูู ูุจู ุงุฒ ูุจู ฺฉุงูู ุดุฏู ุจูุฏ ู ูุชุฌู ุขู ููุฑุงู ุฏุฑ ุฏุณุชุฑุณ ุจูุฏ.</p>
<hr>
<h3>ุงุฏุงููโูุง ุดุฑุท (Conditional Continuations) โ๏ธ</h3>
<p>ููุงุด 1 ฺฉ ููููู ุณุงุฏู ุงุฒ <strong>ูุธูู ุงุฏุงููโุฏููุฏู</strong> ุฑุง ูุดุงู ุฏุงุฏ. ุจุง ุงู ุญุงูุ ุดูุง ูโุชูุงูุฏ ฺฉูุชุฑู ุจุดุชุฑ ุจุฑ ูุฑุขูุฏ ุงุฏุงูู ุฏุงุดุชู ุจุงุดุฏ. ุจุงุฏ ุงู ููููู ุฑุง ุจุง ุจุฑุฎ <strong>ูุทุงูุนุงุช ููุฑุฏ (case studies)</strong> ุจุฑุฑุณ ฺฉูู.</p>
<h4>ูุทุงูุนู ููุฑุฏ 1 (Case Study 1) ๐</h4>
<p>ุญุช ูพุณ ุงุฒ ุฏุนูุช ูููุงูโูุงุ ููฺฉู ุงุณุช ูุฒุจุงู ุจู ุฏูุงู ูุงฺฏุฒุฑ ูุฌุจูุฑ ุดูุฏ <strong>ุชุงุฑุฎ ูููุงู ุฑุง ุชุบุฑ ุฏูุฏ</strong>. ุฏุฑ ุงู ุญุงูุชุ ุจู ุฌุง ุณูุงุฑุด ุบุฐุงุ ูุฑุถ ฺฉูู ูุฒุจุงู <strong>ุจู ูููุงู ุงุทูุงุน ูโุฏูุฏ</strong> ู ุชุงุฑุฎ ูููุงู ุฑุง ุฌุงุจูโุฌุง ูโฺฉูุฏ. ุขุง ูโุชูุงูุฏ ุจุฑูุงููโุง ุจููุณุฏ ฺฉู ุงู ูุถุนุช ุฑุง ุดุจูโุณุงุฒ ฺฉูุฏุ</p>
<p>ูุทุนุงู ูโุชูุงูุฏ. ุงูุง ุงุฌุงุฒู ุฏูุฏ <strong>ุชฺฉูฺฉ ุจุง ุงุณุชูุงุฏู ุงุฒ enumeration ุจู ูุงู <code>TaskContinuationOptions</code></strong> ุจู ุดูุง ูุดุงู ุฏูู ฺฉู ุงู ูุถุนุช ุฑุง ูุฏุฑุช ูโฺฉูุฏ. ุชุตูุฑ ุฒุฑ (Figure 3-1) ุงุฒ Visual Studio <strong>ุงุนุถุง ูุฎุชูู <code>TaskContinuationOptions</code></strong> ุฑุง ูุดุงู ูโุฏูุฏ:</p>
<div align="center">
<p><img src="../../../assets/image/03/Table%203-2.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ูฺฉุชู ููู โ๏ธ</p>
<p>ุจุญุซ ุฏุฑ ููุฑุฏ ูููโ ุงุนุถุง <code>TaskContinuationOptions</code> ุจุงุนุซ ุญุฌู ุดุฏู ุจโููุฑุฏ ฺฉุชุงุจ ูโุดูุฏ. ุงฺฏุฑ ุนูุงููโููุฏ ูุณุชุฏุ ูโุชูุงูุฏ ุจุง ุจุงุฒ ฺฉุฑุฏู ุขูโูุง ุฏุฑ Visual Studio ุง ุงุฒ ููฺฉ ุขููุงู ุฒุฑ ุงุทูุงุนุงุช ุจุดุชุฑ ฺฉุณุจ ฺฉูุฏ:<br>
<a href="https://learn.microsoft.com/en-us/dotnet/api/system.threading.tasks.taskcontinuationoptions?view=net-8.0">TaskContinuationOptions โ Microsoft Docs</a><br>
ุจุง ุงู ุญุงูุ ูฺฉุฑ ูโฺฉูู ุจุง ุฏุฏู ูุงู ุงู ุงุนุถุง ูุฒ ูโุชูุงูุฏ <strong>ุชุตูุฑ ฺฉู ุงุฒ ุนููฺฉุฑุฏ ุขูโูุง</strong> ุจู ุฏุณุช ุขูุฑุฏ.</p>
<hr>
<p>ฺูู ูุซุงู ูุง ุจุง ฺฉ <strong>ูุถุนุช ุงุณุชุซูุง (exceptional situation)</strong> ุณุฑูฺฉุงุฑ ุฏุงุฑุฏุ ูุตุฏ ุฏุงุฑู ุงุฒ ฺฏุฒููโูุง <code>NotOnFaulted</code> ู <code>OnlyOnFaulted</code> ุงุณุชูุงุฏู ฺฉูู. ุดูุง ูโุชูุงูุฏ ุจูโุทูุฑ ุงูู ูุฑุถ ฺฉูุฏ ฺฉู ฺฏุฒููโ <code>NotOnFaulted</code> ุจุฑุง ูุถุนุช <strong>ุนุงุฏ</strong> ู ฺฏุฒููโ ุฏฺฏุฑ ุจุฑุง ูุถุนุช <strong>ุงุณุชุซูุง</strong> ุงุณุชูุงุฏู ุฎูุงูุฏ ุดุฏ.</p>
<p>ูุจู ุงุฒ ุงูฺฉู ุจุฑูุงูู ฺฉุงูู ุฑุง ุจุจูุฏุ ุจุงุฏ ุจฺฏูู ุจุฑุง ุงุฌุงุฏ ฺฉ <strong>ูุถุนุช ุงุณุชุซูุง</strong>ุ ุงุฒ ฺฉ ููุทู ุณุงุฏู (dummy logic) ุงุณุชูุงุฏู ฺฉุฑุฏูโุงู. ุงู ููุทู ุจู ุงู ุตูุฑุช ุงุณุช: <strong>ูุธูู ูพุดู (inviteTask)</strong> ฺฉ ุนุฏุฏ ุชููุฏ ูโฺฉูุฏ. ุงฺฏุฑ ุนุฏุฏ <strong>ุฒูุฌ</strong> ุจุงุดุฏุ ฺฉ <strong>ุงุณุชุซูุง (exception)</strong> ุฑุฎ ูโุฏูุฏ. ุฏุฑ ุบุฑ ุงู ุตูุฑุชุ ูพุงู ูุจู ุจุฑ ุงูฺฉู ุฏุนูุช ุงูุฌุงู ุดุฏู ุงุณุชุ ุงุฑุณุงู ูโุดูุฏ.</p>
<hr>
<h3>ููุงุด 2 (Demonstration 2) ๐ป</h3>
<p>ุจุงุฏ ุจุฑูุงูู ฺฉุงูู ุฑุง ุจุจูู:</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> <span class="hljs-keyword">static</span> System.Console;

WriteLine(<span class="hljs-string">&quot;The host is planning a party.&quot;</span>);

<span class="hljs-keyword">var</span> inviteTask = Task.Run(() =&gt;
{
    <span class="hljs-built_in">string</span> msg = <span class="hljs-string">&quot;Invitation is done.&quot;</span>;
    <span class="hljs-comment">// ููุทู ุณุงุฏู ุจุฑุง ุงุฌุงุฏ ุงุณุชุซูุง</span>
    <span class="hljs-built_in">int</span> random = <span class="hljs-keyword">new</span> Random().Next(<span class="hljs-number">10</span>);
    <span class="hljs-keyword">if</span> (random % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>)
    {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Exception(<span class="hljs-string">&quot;Some problem occurs.&quot;</span>);
    }
    <span class="hljs-keyword">return</span> msg;
});

<span class="hljs-keyword">var</span> orderTask = inviteTask.ContinueWith(previousTask =&gt;
{
    WriteLine(previousTask.Result);
    <span class="hljs-comment">// ุดุจูโุณุงุฒ ุชุฃุฎุฑ ุจุฑุง ุชููุฏ ุงุฒ ฺฉ ูููุนุช ูุงูุน</span>
    Thread.Sleep(<span class="hljs-number">1000</span>);
    WriteLine(<span class="hljs-string">&quot;Food is ordered now.&quot;</span>);
}, TaskContinuationOptions.NotOnFaulted);

<span class="hljs-keyword">var</span> changePartyDateTask = inviteTask.ContinueWith(previousTask =&gt;
{
    WriteLine(<span class="hljs-string">&quot;Party date is shifted due to some unavoidable circumstances.&quot;</span>);
}, TaskContinuationOptions.OnlyOnFaulted);

WriteLine(<span class="hljs-string">&quot;The host is decorating the house.&quot;</span>);

ReadLine();
</code></pre>
<h4>ุฎุฑูุฌ (Output) ๐ฅ๏ธ</h4>
<p>ูููููโุง ุงุฒ ุฎุฑูุฌ ููฺฉู ุจุฏูู ุงุณุชุซูุง:</p>
<pre class="hljs"><code>The host is planning a party.
The host is decorating the house.
Invitation is done.
Food is ordered now.
</code></pre>
<p>ูููููโุง ุงุฒ ุฎุฑูุฌ ููฺฉู ููุช ูุฒุจุงู ูุฌุจูุฑ ุดุฏ <strong>ุชุงุฑุฎ ูููุงู ุฑุง ุชุบุฑ ุฏูุฏ</strong>:</p>
<pre class="hljs"><code>The host is planning a party.
The host is decorating the house.
Party date is shifted due to some unavoidable circumstances.
</code></pre>
<hr>
<h3>ูุทุงูุนู ููุฑุฏ 2 (Case Study 2) ๐</h3>
<p>ูุธุงู ุงุฏุงููโุฏููุฏู ุจู ุดูุง ฺฉูฺฉ ูโฺฉููุฏ ุจุง <strong>ูุถุนุชโูุง ูุฎุชูู</strong> ุจูโุฎูุจ ฺฉูุงุฑ ุจุงุฏ. ุงุฌุงุฒู ุฏูุฏ ฺฉ <strong>ูุทุงูุนู ููุฑุฏ ุฏฺฏุฑ</strong> ุฑุง ุจุฑุฑุณ ฺฉูู. ูุจูุงู ฺฏูุชู ฺฉู <strong>ุงุฏุงููโูุง ูโุชูุงููุฏ ุจู ฺฉ ุง ฺูุฏ ูุธูู ูพุดู ูุชุตู ุดููุฏ</strong>. ุจุงุฏ ฺฉ ูุซุงู ุจุจูู.</p>
<p>ุงู ุจุงุฑ ุงุฒ ูุชุฏ <code>ContinueWhenAll</code> ุงุณุชูุงุฏู ูโฺฉูู. ููุงููุฏ ููุดูุ ุงู ูุชุฏ ฺูุฏู overload ุฏุงุฑุฏ. ูู ูุตุฏ ุฏุงุฑู ูุณุฎูโุง ุฑุง ุงุณุชูุงุฏู ฺฉูู ฺฉู <strong>ุฏู ูพุงุฑุงูุชุฑ ูโูพุฐุฑุฏ</strong>:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">public</span> Task <span class="hljs-title">ContinueWhenAll</span>&lt;<span class="hljs-title">TAntecedentResult</span>&gt;(<span class="hljs-params">
    Task&lt;TAntecedentResult&gt;[] tasks,
    Action&lt;Task&lt;TAntecedentResult&gt;[]&gt; continuationAction
</span>)</span>
{
    <span class="hljs-comment">// ุจุฏูู ูุชุฏ ูุดุงู ุฏุงุฏู ูุดุฏู ุงุณุช</span>
}
</code></pre>
<p>ูพุงุฑุงูุชุฑ ุงูู <strong>ฺฉ ุขุฑุงู ุงุฒ ูุธุงู ูพุดู</strong> ูโูพุฐุฑุฏ (ุงู ุนู ุชูุงู ุขูโูุง ุจุงุฏ ุชฺฉูู ุดููุฏ ุชุง ุงุฏุงูู ุขุบุงุฒ ุดูุฏ) ู ูพุงุฑุงูุชุฑ ุจุนุฏ ุจุฑุง <strong>delegate ุงุฒ ููุน Action</strong> ุงุณุช ฺฉู ุฒูุงู ุงุฌุฑุง ูโุดูุฏ ฺฉู <strong>ุชูุงู ูุธุงู ููุฌูุฏ ุฏุฑ ุขุฑุงู ุชฺฉูู ุดููุฏ</strong>.</p>
<p>ุจู ููู ุฏููุ ุดูุง ฺฉุฏ ุฒุฑ ุฑุง ุฎูุงูุฏ ุฏุฏ ฺฉู ูุดุงู ูโุฏูุฏ <strong>orderTask</strong> ู <strong>inviteTask</strong> ุจุงุฏ ุชฺฉูู ุดููุฏ ุชุง <strong>ูุธูู ุงุฏุงููโุฏููุฏู (continuation task)</strong> ุขุบุงุฒ ุดูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> arrangeDinnerTask = Task.Factory.ContinueWhenAll(
    [<span class="hljs-meta">orderTask, inviteTask</span>],
    tasks =&gt;
    {
         WriteLine(<span class="hljs-string">&quot;Arranging dinner.&quot;</span>);
    }
);
</code></pre>
<div align="center">
<p><img src="../../../assets/image/03/Table%203-3.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ูฺฉุชู ููู โ๏ธ</p>
<p>ุดุงุฏ ุชูุฌู ฺฉุฑุฏู ุจุงุดุฏ ฺฉู ูฺฺฏ <strong>โCollection expressionsโ</strong> ุฏุฑ C# 12 ุงุฌุงุฒู ูโุฏูุฏ <code>arrangeDinnerTask</code> ุฑุง ุจู ุงู ุดฺฉู ุจููุณู. ุงฺฏุฑ ุงุฒ ูุณุฎู ูุฏูโุชุฑ C# ุงุณุชูุงุฏู ูโฺฉูุฏุ ูุงุฒู ุงุณุช ุขู ุฑุง ุจู ุตูุฑุช ุฒุฑ ุจููุณุฏ (ุชุบุฑ ููู ุจุง <strong>bold</strong> ูุดุฎุต ุดุฏู ุงุณุช):</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> arrangeDinnerTask = Task.Factory.ContinueWhenAll(
    <span class="hljs-keyword">new</span>[] { orderTask, inviteTask },
    <span class="hljs-comment">//[orderTask,inviteTask],  // ุงุฒ C#12 ุจู ุจุนุฏ</span>
    tasks =&gt;
    {
    }
);
</code></pre>
<hr>
<h3>ููุงุด 3 (Demonstration 3) ๐ป</h3>
<p>ุจุงุฏ ุจุฑูุงูู ฺฉุงูู ุฑุง ุจุจูู:</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> <span class="hljs-keyword">static</span> System.Console;

<span class="hljs-keyword">var</span> orderTask = Task.Run(() =&gt; WriteLine(<span class="hljs-string">&quot;Food is ordered.&quot;</span>));
<span class="hljs-keyword">var</span> inviteTask = Task.Run(() =&gt; WriteLine(<span class="hljs-string">&quot;Invitation is done.&quot;</span>));

<span class="hljs-keyword">var</span> arrangeDinnerTask = Task.Factory.ContinueWhenAll(
    <span class="hljs-comment">//[new[] { orderTask,inviteTask }],</span>
    [<span class="hljs-meta">orderTask, inviteTask</span>],  <span class="hljs-comment">// ุงุฒ C#12 ุจู ุจุนุฏ</span>
    tasks =&gt;
    {
        WriteLine(<span class="hljs-string">&quot;Arranging dinner.&quot;</span>);
    }
);

ReadLine();
</code></pre>
<h4>ุฎุฑูุฌ (Output) ๐ฅ๏ธ</h4>
<p>ูููููโุง ุงุฒ ุฎุฑูุฌ ููฺฉู ููุช ุงุจุชุฏุง ุบุฐุง ุณูุงุฑุด ุฏุงุฏู ูโุดูุฏ:</p>
<pre class="hljs"><code>Food is ordered.
Invitation is done.
Arranging dinner.
</code></pre>
<p>ูููููโุง ุงุฒ ุฎุฑูุฌ ููฺฉู ููุช ุงุจุชุฏุง ุฏุนูุชโูุง ุงูุฌุงู ูโุดูุฏ:</p>
<pre class="hljs"><code>Invitation is done.
Food is ordered.
Arranging dinner.
</code></pre>
<hr>
<h3>ุชุญูู (Analysis) ๐</h3>
<p>ุฏุฑ ูุฑ ุญุงูุช ูโุชูุงู ูุดุงูุฏู ฺฉุฑุฏ ฺฉู <strong>ุดุงู ุชููุง ูพุณ ุงุฒ ุชฺฉูู ูุธูู ุณูุงุฑุด ุบุฐุง ู ุงูุฌุงู ุฏุนูุชโูุง</strong> ฺุฏู ุดุฏู ุงุณุช.</p>
<hr>
<h3>ูุทุงูุนู ููุฑุฏ 3 (Case Study 3) ๐ฝ๏ธ</h3>
<p>ุจุงุฏ ฺฉ ูุทุงูุนู ููุฑุฏ ุฏฺฏุฑ ุฑุง ุจุฑุฑุณ ฺฉูู ฺฉู ุฏุฑ ุขู <strong>ูุธูู ุงุฏุงููโุฏููุฏู ุฒูุงู ุงุฌุฑุง ูโุดูุฏ ฺฉู ูุฑ ฺฉ ุงุฒ ูุธุงู ูุจู ุชฺฉูู ุดููุฏ</strong>. ุฏุฑ ุงู ุญุงูุช ูโุชูุงูุฏ ุงุฒ ูุชุฏ <code>ContinueWhenAny</code> ุจู ุฌุง <code>ContinueWhenAll</code> ุงุณุชูุงุฏู ฺฉูุฏ.</p>
<p>ุจู ุนููุงู ูุซุงูุ ููููู ุฎุฑูุฌ ุฒุฑ ุฒูุงู ุจู ุฏุณุช ุขูุฏ ฺฉู ูู ูุชุฏ <code>ContinueWhenAll</code> ุฑุง ุจุง <code>ContinueWhenAny</code> ุฌุงฺฏุฒู ฺฉุฑุฏู:</p>
<pre class="hljs"><code>Food is ordered.
Arranging dinner.
Invitation is done.
</code></pre>
<p>ุงู ุฎุฑูุฌ ูุดุงู ูโุฏูุฏ ฺฉู <strong>ุดุงู ุญุช ูุจู ุงุฒ ุชฺฉูู ุฏุนูุชโูุง ฺุฏู ุดุฏู ุงุณุช</strong>. ุดูุง ูโุชูุงูุฏ ุงุญุชูุงู ูุดุงูุฏู ฺูู ุฎุฑูุฌโุง ุฑุง ุจุง ุงุถุงูู ฺฉุฑุฏู ฺฉ <strong>ุฏุณุชูุฑ sleep ุฏุฑ <code>inviteTask</code></strong> ุงูุฒุงุด ุฏูุฏุ ูุงููุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> inviteTask = Task.Run(() =&gt;
{
    Thread.Sleep(<span class="hljs-number">3000</span>);
    WriteLine(<span class="hljs-string">&quot;Invitation is done.&quot;</span>);
});
</code></pre>
<p>๐ก ูฺฉุชู: ุดูุง ููฺูู ูโุชูุงูุฏ ูพุฑูฺู <strong>Chapter3_Demo3_CaseStudy3</strong> ุฑุง ุฏุงูููุฏ ฺฉูุฏ ุชุง ุงู ูุทุงูุนู ููุฑุฏ ุฑุง ุชูุฑู ฺฉูุฏ.</p>
<p>ุดูุงุณุง ฺฉ ูุธูู ู ูุถุนุช ุขู ๐</p>
<p>ููุช ุฏุฑ ฺฉ ูุญุท <strong>ฺูุฏูุฎ (multithreaded)</strong> ุจุง ฺูุฏู ูุธูู ฺฉุงุฑ ูโฺฉูุฏุ ุถุฑูุฑ ุงุณุช ฺฉู <strong>ูุธุงู ููุฑุงู ุจุง ูุถุนุช ุขูโูุง ุดูุงุณุง ุดููุฏ</strong>. ุจุง ุงุณุชูุงุฏู ุงุฒ <code>Task.CurrentId</code> ูโุชูุงูุฏ <strong>ุดูุงุณู (ID) ูุธููโุง ฺฉู ุฏุฑ ุญุงู ุงุฌุฑุงุณุช</strong> ุฑุง ุฏุฑุงูุช ฺฉูุฏ.</p>
<div align="center">
<p><img src="../../../assets/image/03/Table%203-4.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ูฺฉุชู ููู โ๏ธ</p>
<p><code>CurrentId</code> ุจุฑุง ุฏุฑุงูุช <strong>ุดูุงุณู ูุธููโุง ฺฉู ุฏุฑ ุญุงู ุงุฌุฑุงุณุช</strong> ุงุฒ ุฏุงุฎู ฺฉุฏ ฺฉู ูุธูู ุงุฌุฑุง ูโฺฉูุฏ ุงุณุชูุงุฏู ูโุดูุฏ. ุจุง ุงู ุญุงูุ ุงู ฺฉ <strong>ูฺฺฏ ุงุณุชุง (static property)</strong> ุงุณุช ู ุจุง ูฺฺฏ <code>Id</code> ูุชูุงูุช ุงุณุช. ูฺฺฏ <code>Id</code> <strong>ุดูุงุณู ฺฉ ููููู ูุดุฎุต ุงุฒ Task</strong> ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ. ุชูุงุด ุจุฑุง ุฏุฑุงูุช ููุฏุงุฑ <code>CurrentId</code> ุงุฒ ุฎุงุฑุฌ ฺฉุฏ ฺฉู ูุธูู ุฏุฑ ุญุงู ุงุฌุฑุงุณุชุ <strong>ููุฏุงุฑ null</strong> ุจุงุฒูโฺฏุฑุฏุงูุฏ.</p>
<p>ฺุฑุฎู ุนูุฑ ฺฉ <strong>ููููู Task</strong> ุงุฒ ูุฑุงุญู ูุฎุชูู ุนุจูุฑ ูโฺฉูุฏ. ูฺฺฏ <code>Status</code> ุจุฑุง ุจุฑุฑุณ <strong>ูุถุนุช ูุนู</strong> ุงุณุชูุงุฏู ูโุดูุฏ. ููฺฏุงู ุจุฑุฑุณุ ุฎูุงูุฏ ุฏุฏ ฺฉู ุงู ูฺฺฏ <strong>ููุน enum ุจู ูุงู TaskStatus</strong> ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ ฺฉู ุงุนุถุง ุฒุงุฏ ุฏุงุฑุฏ. ุงุฌุงุฒู ุฏูุฏ ฺฉ <strong>ุชุตูุฑ ุงุฒ Visual Studio</strong> ุจุฑุง ููุงุด ุขูโูุง ุงุฑุงุฆู ฺฉูู (Figure 3-2).</p>
<div align="center">
<p><img src="../../../assets/image/03/Table%203-5.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>ูุถุนุช ููุง ฺฉ Task ู ุชุญูู ุขู ๐</h3>
<p>ุฏุฑ ฺฉ ูุญุท <strong>ููุฒูุงู (concurrent)</strong> ููฺฉู ุงุณุช ุฒูุงู ฺฉู ููุฏุงุฑ ูุถุนุช ฺฉ ูุธูู ุฑุง ุฏุฑุงูุช ูโฺฉูุฏุ ูุถุนุช ุขู ุชุบุฑ ฺฉุฑุฏู ุจุงุดุฏ. ุงูุง ูฺฉุชู ุฌุงูุจ ุงู ุงุณุช ฺฉู <strong>ุฒูุงู ฺฉู ฺฉ ูุถุนุช ุจู ุฏุณุช ุขูุฏุ ููโุชูุงูุฏ ุจู ูุถุนุช ูุจู ุจุงุฒฺฏุฑุฏุฏ</strong>. ุจุฑุง ูุซุงูุ ููุช ฺฉ ูุธูู ุจู <strong>ูุถุนุช ููุง (final state)</strong> ุจุฑุณุฏุ ููโุชูุงูุฏ ุจู ูุถุนุช <code>Created</code> ุจุงุฒฺฏุฑุฏุฏ.</p>
<p>ุณู ูุถุนุช ููุง ููฺฉู ูุฌูุฏ ุฏุงุฑุฏ:<br>
โข <code>RanToCompletion</code> โ โ ูุดุงู ูโุฏูุฏ ูุธูู ุจุง ููููุช ฺฉุงูู ุดุฏู ุงุณุช.<br>
โข <code>Canceled</code> โ โ ูุดุงู ูโุฏูุฏ ูุธูู ูุบู ุดุฏู ุงุณุชุ ฺฉู ูโุชูุงูุฏ ุจู ุฏูุงู ูุซู ุฏุฎุงูุช ฺฉุงุฑุจุฑุ ุชุงูโุงูุชโูุงุ ุง ููุทู ุจุฑูุงูู ุฑุฎ ุฏูุฏ.<br>
โข <code>Faulted</code> โ๏ธ โ ูุดุงู ูโุฏูุฏ ูุธูู ุจู ุฏูู ฺฉ <strong>ุงุณุชุซูุง ูุฏุฑุชโูุดุฏู</strong> ฺฉุงูู ุดุฏู ุงุณุช.</p>
<p>ุชูุถุญุงุช ุจุดุชุฑ ุฏุฑุจุงุฑู ุงุณุชุซูุงูุง ู ูุบู ูุธุงู ุฏุฑ <strong>ูุตู ด ู ูุตู ต</strong> ุงุฑุงุฆู ุฎูุงูุฏ ุดุฏ.</p>
<hr>
<h3>ููุงุด 4 (Demonstration 4) ๐ป</h3>
<p>ุฏุฑ ุจุฑูุงูู ุฒุฑุ ุฏู ูุธูู ุฏุงุฑู:</p>
<ol>
<li><code>doSomethingTask</code> โ ูโุชูุงูุฏ ุจุง ููููุช ุชฺฉูู ุดูุฏ ุง ุจุง ฺฉ ุงุณุชุซูุง ููุงุฌู ุดูุฏ.</li>
<li><code>statusCheckerTask</code> โ ฺฉ <strong>ูุธูู ุงุฏุงููโุฏููุฏู</strong> ุงุณุช ฺฉู ูุถุนุช ูุธูู ูุงูุฏ ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ูฺฺฏ <code>Status</code> ุจุฑุฑุณ ูโฺฉูุฏ ู <code>TaskStatus</code> ุขู ุฑุง ุจุงุฒูโฺฏุฑุฏุงูุฏ.</li>
</ol>
<pre class="hljs"><code><span class="hljs-keyword">using</span> <span class="hljs-keyword">static</span> System.Console;

<span class="hljs-keyword">var</span> doSomethingTask = Task.Run(() =&gt;
{
    WriteLine(<span class="hljs-string">$&quot;The task [id:<span class="hljs-subst">{Task.CurrentId}</span>] starts...&quot;</span>);
    <span class="hljs-comment">// ุงูุฌุงู ฺฉุงุฑ ุฏฺฏุฑุ ุฏุฑ ุตูุฑุช ูุงุฒ</span>
    <span class="hljs-built_in">int</span> random = <span class="hljs-keyword">new</span> Random().Next(<span class="hljs-number">2</span>);
    WriteLine(<span class="hljs-string">$&quot;The random number is:<span class="hljs-subst">{random}</span>&quot;</span>);
    <span class="hljs-comment">// ุนุฏุฏ ุชุตุงุฏู 0 ุจุงุนุซ ุงุฌุงุฏ ุงุณุชุซูุง ูโุดูุฏ</span>
    <span class="hljs-keyword">if</span> (random == <span class="hljs-number">0</span>)
    {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Exception(<span class="hljs-string">&quot;Got a zero&quot;</span>);
    }
    WriteLine(<span class="hljs-string">$&quot;The task [id:<span class="hljs-subst">{Task.CurrentId}</span>] has finished.&quot;</span>);
});

<span class="hljs-keyword">var</span> statusCheckerTask = doSomethingTask.ContinueWith(previousTask =&gt;
{
    WriteLine(<span class="hljs-string">$&quot;The task <span class="hljs-subst">{previousTask.Id}</span>&#x27;s status is: <span class="hljs-subst">{previousTask.Status}</span>&quot;</span>);
}, TaskContinuationOptions.AttachedToParent);

ReadKey();
</code></pre>
<h4>ุฎุฑูุฌ (Output) ๐ฅ๏ธ</h4>
<p>ูููููโุง ุงุฒ ุฎุฑูุฌ ููุช ุงุณุชุซูุง ุฑุฎ ุฏุงุฏู ุงุณุช:</p>
<pre class="hljs"><code>The task [id:8] starts...
The random number is:0
The task 8's status is: Faulted
</code></pre>
<p>ูููููโุง ุงุฒ ุฎุฑูุฌ ููุช ุงุณุชุซูุง ุฑุฎ ูุฏุงุฏู ุงุณุช:</p>
<pre class="hljs"><code>The task [id:8] starts...
The random number is:1
The task [id:8] has finished.
The task 8's status is: RanToCompletion
</code></pre>
<hr>
<h3>ุชุญูู ู ูุฏุฑุช ุดุงุฎูโูุง ูุฎุชูู ๐</h3>
<p>ุฏุฑ ุตูุฑุช ูุงุฒุ ูโุชูุงูุฏ ุจุฑูุงูู ุฑุง ุทูุฑ ุชุบุฑ ุฏูุฏ ฺฉู <strong>ุดุงุฎูโูุง ุฌุฏุงฺฏุงูู ุจุฑุง ูุฏุฑุช ุณูุงุฑููุง ูุฎุชูู</strong> ุงุฌุงุฏ ฺฉูุฏุ ูุดุงุจู ููุงุด 2. ุจุฑุง ูุซุงูุ ูโุชูุงู <code>statusCheckerTask</code> ุฑุง ุจุง ุฏู ุดุงุฎู ุฒุฑ ุฌุงฺฏุฒู ฺฉุฑุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> normalHandlerTask = doSomethingTask.ContinueWith(previousTask =&gt;
{
    WriteLine(<span class="hljs-string">$&quot;The task <span class="hljs-subst">{previousTask.Id}</span>&#x27;s status is: <span class="hljs-subst">{previousTask.Status}</span>&quot;</span>);
}, TaskContinuationOptions.AttachedToParent | TaskContinuationOptions.NotOnFaulted);

<span class="hljs-keyword">var</span> faultHandlerTask = doSomethingTask.ContinueWith(previousTask =&gt;
{
    WriteLine(<span class="hljs-string">$&quot;The parent task was not completed due to an exception.&quot;</span>);
}, TaskContinuationOptions.AttachedToParent | TaskContinuationOptions.OnlyOnFaulted);
</code></pre>
<p>ุจุง ุงุฌุฑุง ุงู ุจุฑูุงููุ ูพุงูโูุง <strong>ุจุฑ ุงุณุงุณ ูุถุนุช ุชฺฉูู ูุธูู ูุงูุฏ</strong> ููุงุด ุฏุงุฏู ูโุดููุฏ.</p>
<ul>
<li>ููุช ุงุณุชุซูุง ุฑุฎ ุฏูุฏ:</li>
</ul>
<pre class="hljs"><code>The task [id:7] starts...
The random number is:0
The parent task was not completed due to an exception.
</code></pre>
<ul>
<li>ููุช ุงุณุชุซูุง ุฑุฎ ูุฏูุฏ:</li>
</ul>
<pre class="hljs"><code>The task [id:8] starts...
The random number is:1
The task [id:8] has finished.
The task 8's status is: RanToCompletion
</code></pre>
<hr>
<h3>ูพุฑุณุด ู ูพุงุณุฎ (Q&amp;A) โ</h3>
<p><strong>Q3.1:</strong> ุฏุฑ ุฎุฑูุฌโูุงุ ุดูุงุณู ูุธูู ูุงูุฏ 7 ุง 8 ุจูุฏ. ุขุง ุฏุฑุณุช ุงุณุช ฺฉู ูุธุงู ุฏฺฏุฑ ูุฒ ููุฒูุงู ุงุฌุฑุง ูโุดุฏูุฏุ</p>
<p><strong>ูพุงุณุฎ:</strong> ุจููุ ุงู ฺฉุฏ ุฏุฑ VS2022 ุจุง ุชูุธูุงุช ูพุดโูุฑุถ <strong>Debug</strong> ู ูุนุงู ุจูุฏู <strong>Hot Reload</strong> ุงุฌุฑุง ุดุฏ. ุงฺฏุฑ ููู ฺฉุฏ ุฑุง ุฏุฑ <strong>Release configuration</strong> ุง ุจุง ุบุฑูุนุงู ฺฉุฑุฏู Hot Reload ุงุฌุฑุง ฺฉูุฏุ ุดูุงุณู ูพุงูโุชุฑ ูุงููุฏ 1 ุฎูุงูุฏ ุฏุฏ:</p>
<pre class="hljs"><code>The task [id:1] started doing something...
The random number is:0
The task 1's status is: Faulted
</code></pre>
<p>๐ ุจุฑุง ุงูุชุฎุงุจ ุชูุธูุงุช ููุฑุฏูุธุฑ: ุฑู <strong>Solution Explorer</strong> ุฑุงุณุชโฺฉูฺฉ ฺฉูุฏ โค <strong>Configuration Managerโฆ</strong> โค <strong>Debug ุง Release</strong> ุฑุง ุจุฑุง ูพุฑูฺู ุงูุชุฎุงุจ ฺฉูุฏ.</p>
<div align="center">
<p><img src="../../../assets/image/03/Table%203-6.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ูฺฉุชู ููู โ๏ธ</p>
<p>ูู ุงุบูุจ ุจุฑูุงููโูุงู ุฑุง ุฏุฑ <strong>ุญุงูุช Debug</strong> ุงุฌุฑุง ูโฺฉูู. ุจูุงุจุฑุงูุ ุจุฑุง ุฏุฏู <strong>ุดูุงุณูโูุง ูพุงูโุชุฑ ูุธุงู</strong> ูุงููุฏ 1ุ 2ุ 3 ูโฆ ุฏุฑ ุฎุฑูุฌุ ูุนูููุงู ุขู ุจุฑูุงููโูุง ุฑุง ุจุง <strong>ุบุฑูุนุงู ฺฉุฑุฏู ุชูุธู โHot Reloadโ</strong> ุงุฌุฑุง ูโฺฉูู.</p>
<p><strong>Q3.2 ุขุง ุดูุงุณูโูุง ูุธุงู ฺฉุชุง ูุณุชูุฏุ</strong></p>
<p>ูุงฺฉุฑูุณุงูุช ุงู ููุถูุน ุฑุง ุชุถูู ููโฺฉูุฏ. ุฏุฑ ููฺฉ ุขููุงู ุฒุฑ ุฐฺฉุฑ ุดุฏู ุงุณุช:<br>
<a href="https://learn.microsoft.com/en-us/dotnet/api/system.threading.tasks.task.currentid?view=net-9.0">Task.CurrentId โ Microsoft Docs</a></p>
<blockquote>
<p>ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ูุฑฺูุฏ ุจุฑุฎูุฑุฏ ุดูุงุณูโูุง ุจุณุงุฑ ูุงุฏุฑ ุงุณุชุ ุงูุง <strong>ุดูุงุณูโูุง ูุธุงู ุชุถูู ุดุฏู ูุณุชูุฏ ฺฉู ฺฉุชุง ุจุงุดูุฏ</strong>.</p>
</blockquote>
<hr>
<h3>ูุธุงู ุชู ุฏุฑ ุชู (Nested Tasks) ๐</h3>
<p>ูุธุงู ูโุชูุงููุฏ <strong>ุชู ุฏุฑ ุชู</strong> ุจุงุดูุฏ. ุนู ูโุชูุงู ฺฉ <strong>ูุธูู ุฑุง ุฏุฑ ุฏูฺฏุช ฺฉุงุฑุจุฑ ฺฉ ูุธูู ุฏฺฏุฑ</strong> ุงุฌุงุฏ ฺฉุฑุฏ. <strong>ูุธูู ุจุฑูู</strong> ฺฉู ูุธูู ูุฑุฒูุฏ ุฏุฑ ุขู ุงุฌุงุฏ ูโุดูุฏุ ูุนูููุงู ุจู ุนููุงู <strong>ูุธูู ูุงูุฏ (parent task)</strong> ุดูุงุฎุชู ูโุดูุฏ.</p>
<p>ฺฉ <strong>ูุธูู ูุฑุฒูุฏ</strong> ูโุชูุงูุฏ ฺฉ ุงุฒ ุงููุงุน ุฒุฑ ุจุงุดุฏ:<br>
โข <strong>Attached</strong> ๐ โ ุจุง ฺฏุฒูู <code>TaskCreationOptions.AttachedToParent</code> ุงุฌุงุฏ ูโุดูุฏ (ุฏุฑ ุตูุฑุช ฺฉู ูุงูุฏ ุงุฌุงุฒู ุงุชุตุงู ุฏุงุดุชู ุจุงุดุฏ).<br>
โข <strong>Detached</strong> ๐ โ ุจู ุทูุฑ ูุณุชูู ุงุฌุฑุง ูโุดูุฏ.</p>
<h4>ูุธูู ูุฑุฒูุฏ Detached</h4>
<p>ุจุงุฏ ุจุญุซ ุฎูุฏ ุฑุง ุจุง <strong>ูุธุงู ูุฑุฒูุฏ Detached</strong> ุดุฑูุน ฺฉูู.</p>
<hr>
<h3>ููุงุด 5 (Demonstration 5) ๐ป</h3>
<p>ฺฉุฏ ุฒุฑ ุฏู ููููู Task ุจู ูุงูโูุง <strong>parent</strong> ู <strong>child</strong> ุงุฌุงุฏ ูโฺฉูุฏ. ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู <strong>ูุธูู ูุฑุฒูุฏ ุฏุงุฎู ูุธูู ูุงูุฏ ุงุฌุงุฏ ุดุฏู ุงุณุช</strong>. ุจุง ุงู ุญุงูุ ูู <strong>ูุธูู ูุฑุฒูุฏ ุฑุง ุจู ูุงูุฏ ูุชุตู ูฺฉุฑุฏู</strong>. ุจู ููู ุฏููุ ุฎุท <code>TaskCreationOptions.AttachedToParent</code> ุฏุฑ ฺฉุฏ ุฒุฑ <strong>ฺฉุงููุช ุดุฏู ุงุณุช</strong>.</p>
<div align="center">
<p><img src="../../../assets/image/03/Table%203-7.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ูฺฉุชู ููู โ๏ธ</p>
<p>ูุชุฏ <code>Task.Factory.StartNew</code> ฺฉ <strong>ุจุงุฑฺฏุฐุงุฑ ุงุถุงู (overload)</strong> ุฏุงุฑุฏ ฺฉู <strong><code>TaskCreationOptions</code></strong> ุฑุง ุจู ุนููุงู ูพุงุฑุงูุชุฑ ูโูพุฐุฑุฏ. ุงู ุงูฺฉุงู ุจุฑุง ูุชุฏ <code>Task.Run</code> ูุฌูุฏ ูุฏุงุฑุฏ.</p>
<hr>
<h3>ูุซุงู Detached Nested Task ๐ป</h3>
<pre class="hljs"><code><span class="hljs-keyword">using</span> <span class="hljs-keyword">static</span> System.Console;

<span class="hljs-keyword">var</span> parent = Task.Factory.StartNew(() =&gt;
{
    <span class="hljs-comment">// ฺฉุงุฑ ูุงูุฏ</span>
});

WriteLine(<span class="hljs-string">$&quot;The parent task has started.&quot;</span>);

<span class="hljs-keyword">var</span> child = Task.Factory.StartNew(() =&gt;
{
    WriteLine(<span class="hljs-string">&quot;The child task has started.&quot;</span>);
    <span class="hljs-comment">// ุงุฌุงุฏ ุชุฃุฎุฑ</span>
    Thread.Sleep(<span class="hljs-number">1000</span>);
    WriteLine(<span class="hljs-string">&quot;The child task has finished.&quot;</span>);
    <span class="hljs-comment">// ,TaskCreationOptions.AttachedToParent</span>
});

Thread.Sleep(<span class="hljs-number">5</span>);
parent.Wait();

WriteLine(<span class="hljs-string">$&quot;The parent task has finished now.&quot;</span>);
</code></pre>
<h4>ุฎุฑูุฌ ููููู ๐ฅ๏ธ</h4>
<pre class="hljs"><code>The parent task has started.
The child task has started.
The parent task has finished now.
</code></pre>
<p>ููุงูโุทูุฑ ฺฉู ูุดุงูุฏู ูโฺฉูุฏุ ุฎุฑูุฌ ูุดุงู ูโุฏูุฏ <strong>ูุธูู ูุฑุฒูุฏ ุดุฑูุน ุดุฏู ุงุณุช</strong>ุ ุงูุง ูุดุงู ููโุฏูุฏ ฺฉู <strong>ุชฺฉูู ุดุฏู ุงุณุช ุง ุฎุฑ</strong>. ุฏูู ุงู ุงุณุช ฺฉู <strong>ูุธูู ูุฑุฒูุฏ ุจุฏูู ฺฏุฒูู <code>TaskCreationOptions.AttachedToParent</code> ุงุฌุงุฏ ุดุฏู</strong> ู ุจูุงุจุฑุงู <strong>ฺฉ ูุธูู Detached</strong> ุงุณุช ฺฉู ุจู ุทูุฑ ูุณุชูู ุงุฒ ูุงูุฏ ุงุฌุฑุง ูโุดูุฏ. ุจู ููู ุฏูู ูุธูู ูุงูุฏ <strong>ูุงุฒ ูุฏุงุฑุฏ ฺฉู ููุชุธุฑ ุชฺฉูู ูุธูู ูุฑุฒูุฏ ุจุงุดุฏ</strong>.</p>
<hr>
<h3>ูพุฑุณุด ู ูพุงุณุฎ (Q&amp;A) โ</h3>
<p><strong>Q3.3:</strong> ุงฺฏุฑ ุจุฎูุงูู ุฎุท <code>parent.Wait();</code> ุฑุง ุจุง <code>Task.WaitAll(parent, child);</code> ุฌุงฺฏุฒู ฺฉูู ุชุง ูุทูุฆู ุดูู ูุธูู ูุฑุฒูุฏ ูู ุงุฌุฑุง ุดุฏู ุงุณุชุ ุขุง ุฏุฑุณุช ุงุณุชุ</p>
<p><strong>ูพุงุณุฎ:</strong> ุฎุฑ. ุฏุฑ ุขู ููููู ฺฉุฏุ <strong>ูุธูู ูุฑุฒูุฏ ุฏุฑ ูุญุฏูุฏู (scope) ูุฌูุฏ ูุฏุงุฑุฏ</strong>. ุจูุงุจุฑุงูุ ฺฉุฏ ูพุดููุงุฏ ุดูุง ุจุงุนุซ <strong>ุฎุทุง ุฒูุงู ฺฉุงููพุงู</strong> ูโุดูุฏ:</p>
<pre class="hljs"><code>CS0103 The name 'child' does not exist in the current context
</code></pre>
<p><strong>Q3.4:</strong> ุขุง ุงุณุชูุงุฏู ุงุฒ ุฏุณุชูุฑ <code>Sleep</code> ุฏุฑ ูุฎ ุงุตู ุถุฑูุฑ ุจูุฏุ</p>
<p><strong>ูพุงุณุฎ:</strong> ููุ ุถุฑูุฑ ูุจูุฏ. ุงูุง ุจุง ูุฑุงุฑ ุฏุงุฏู ุงู ุฏุณุชูุฑุ ุงุญุชูุงู ููุงุด ุฎุท <code>&quot;The child task has started.&quot;</code> ุฏุฑ ุฎุฑูุฌ ุงูุฒุงุด ูโุงุจุฏ.</p>
<hr>
<h3>Attached Nested Task ๐</h3>
<p>ุญุงูุง ุฎุท</p>
<pre class="hljs"><code><span class="hljs-comment">// ,TaskCreationOptions.AttachedToParent</span>
</code></pre>
<p>ุฑุง ุงุฒ ฺฉุงููุช ุฎุงุฑุฌ ฺฉุฑุฏู ู ุจุฑูุงูู ุฑุง ุฏูุจุงุฑู ุงุฌุฑุง ูโฺฉูู. ุงู ุจุงุฑุ <strong>ูุถุนุช ุชฺฉูู ูุธูู ูุฑุฒูุฏ</strong> ูุฒ ููุงุด ุฏุงุฏู ุฎูุงูุฏ ุดุฏ.</p>
<h4>ุฎุฑูุฌ ููููู ๐ฅ๏ธ</h4>
<pre class="hljs"><code>The parent task has started.
The child task has started.
The child task has finished.
The parent task has finished now.
</code></pre>
<div align="center">
<p><img src="../../../assets/image/03/Table%203-8.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ูฺฉุงุช ููู โ๏ธ</p>
<p>ูโุชูุงูุฏ ฺฉ <strong>ูุธูู ูุฑุฒูุฏ (child task)</strong> ุฑุง ุจู <strong>ูุธูู ูุงูุฏ (parent task)</strong> ูุชุตู ฺฉูุฏุ <strong>ููุท ุฏุฑ ุตูุฑุช ฺฉู ูุงูุฏ ุงุฌุงุฒู ุงู ฺฉุงุฑ ุฑุง ุจุฏูุฏ</strong>. ุฏุฑ ุงู ุฒูููุ ุฏู ูฺฉุชู ููู ุงุฒ ูุณุชูุฏุงุช ุฑุณู (<a href="https://learn.microsoft.com/en-us/dotnet/standard/parallel-programming/attached-and-detached-child-tasks">ููฺฉ</a>) ูุงุจู ุฐฺฉุฑ ุงุณุช:</p>
<ol>
<li>ูุงูุฏู ูโุชูุงููุฏ ุจู ุทูุฑ ุตุฑุญ ุงุฒ ุงุชุตุงู ูุธุงู ูุฑุฒูุฏ ุฌููฺฏุฑ ฺฉููุฏุ ุจุง ูุดุฎุต ฺฉุฑุฏู ฺฏุฒูู <code>TaskCreationOptions.DenyChildAttach</code> ุฏุฑ <strong>ุณุงุฒูุฏู ฺฉูุงุณ ูุงูุฏ</strong> ุง ุฏุฑ ูุชุฏ <code>TaskFactory.StartNew</code>.</li>
<li>ูุงูุฏู ุจู ุทูุฑ ุถูู ุงุฒ ุงุชุตุงู ูุธุงู ูุฑุฒูุฏ ุฌููฺฏุฑ ูโฺฉููุฏ ุงฺฏุฑ ุขูโูุง ุจุง ุงุณุชูุงุฏู ุงุฒ ูุชุฏ <code>Task.Run</code> ุงุฌุงุฏ ุดููุฏ.</li>
</ol>
<hr>
<h3>ูพุฑุณุด ู ูพุงุณุฎ (Q&amp;A) โ</h3>
<p><strong>Q3.5:</strong> ุฏุฑ ููุงุด ูุจู (Demonstration 5)ุ ููุท <code>parent.Wait();</code> ููุดุชู ุดุฏู ุจูุฏ. ุงู ุนู ุดูุง ููุท ููุชุธุฑ ุชฺฉูู ูุธูู ูุงูุฏ ูุณุชุฏ ู ุจุฑุง ูุธูู ูุฑุฒูุฏ ฺูู ูุณุช. ุจูุงุจุฑุงู ูฺ ุชุถูู ูุฌูุฏ ูุฏุงุฑุฏ ฺฉู ุฎุฑูุฌ ูุดุงู ุฏูุฏ ูุธูู ูุฑุฒูุฏ ุชฺฉูู ุดุฏู ุงุณุช. ุขุง ุงู ุฏุฑฺฉ ุตุญุญ ุงุณุชุ</p>
<p><strong>ูพุงุณุฎ:</strong> ุฎุฑ. ูุงฺฉุฑูุณุงูุช ูุนูุงุฑ ุฑุง ุจู ฺฏูููโุง ุทุฑุงุญ ฺฉุฑุฏู ุงุณุช ฺฉู ุงฺฏุฑ ุฑุงุจุทู ูุงูุฏโูุฑุฒูุฏ ุงุฌุงุฏ ฺฉูุฏุ <strong>ููุชุธุฑ ูุงูุฏู ุจุฑุง ูุธูู ูุงูุฏ ุจุงุนุซ ูโุดูุฏ ูุธูู ูุฑุฒูุฏ ูุฒ ุชฺฉูู ุดูุฏ</strong>.</p>
<hr>
<h3>ูุงุฏุงุฑ ฺฉุฑุฏู ูุงูุฏ ุจู ุงูุชุธุงุฑ ุจุฑุง ูุฑุฒูุฏ ๐จโ๐ฉโ๐ง</h3>
<p>ูโุชูุงูุฏ <strong>ูุธูู ูุงูุฏ ุฑุง ูุงุฏุงุฑ ฺฉูุฏ ุชุง ููุชุธุฑ ุชฺฉูู ูุธูู ูุฑุฒูุฏ ุดูุฏ</strong> (ุญุช ุงฺฏุฑ ฺฉ ูุธูู ูุฑุฒูุฏ Detached ุจุงุดุฏ) ุจุง ุฏุณุชุฑุณ ุจู ูฺฺฏ <code>Task&lt;TResult&gt;.Result</code> ูุธูู ูุฑุฒูุฏ.</p>
<hr>
<h3>ููุงุด 6 (Demonstration 6) ๐ป</h3>
<p>ุฏุฑ ุงู ูุซุงูุ ุจุฑูุงูู ูุจู ฺฉู ุชุบุฑ ฺฉุฑุฏู ุงุณุช. ฺฉุฏ ุฌุฏุฏ ุจุง <strong>bold</strong> ูุดุฎุต ุดุฏู ู ฺฉุฏ ูุฏู ฺฉุงููุช ุดุฏู ุงุณุช:</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> <span class="hljs-keyword">static</span> System.Console;

<span class="hljs-keyword">var</span> parent = Task.Factory.StartNew(() =&gt;
{
    <span class="hljs-comment">// ฺฉุงุฑ ูุงูุฏ</span>
});

WriteLine(<span class="hljs-string">$&quot;The parent task has started.&quot;</span>);

<span class="hljs-keyword">var</span> child = Task.Factory.StartNew(() =&gt;
{
    WriteLine(<span class="hljs-string">&quot;The child task has started.&quot;</span>);
    <span class="hljs-comment">// ุงุฌุงุฏ ุชุฃุฎุฑ</span>
    Thread.Sleep(<span class="hljs-number">1000</span>);
    <span class="hljs-comment">// WriteLine(&quot;The child task has finished.&quot;);</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;the child task has finished.&quot;</span>;
    <span class="hljs-comment">// , TaskCreationOptions.AttachedToParent</span>
});

<span class="hljs-comment">// ูุงูุฏ ุงฺฉููู ููุชุธุฑ ุงู ูุธูู ูุฑุฒูุฏ Detached ุงุณุช</span>
<span class="hljs-keyword">return</span> child.Result;

<span class="hljs-comment">// Thread.Sleep(5);</span>
<span class="hljs-comment">// parent.Wait();</span>
<span class="hljs-comment">// WriteLine($&quot;The parent task has finished now.&quot;);</span>

WriteLine(<span class="hljs-string">$&quot;The parent task confirms that <span class="hljs-subst">{parent.Result}</span>&quot;</span>);
</code></pre>
<h4>ุฎุฑูุฌ ๐ฅ๏ธ</h4>
<pre class="hljs"><code>The parent task has started.
The child task has started.
The parent task confirms that the child task has finished.
</code></pre>
<hr>
<h3>ุจุงุฒ ฺฉุฑุฏู ูุธุงู ุชู ุฏุฑ ุชู (Unwrapping Nested Tasks) ๐</h3>
<p>ุฏุฑ ููุฑุฏ ูุธุงู ุชู ุฏุฑ ุชูุ ูุซุงู ุฒุฑ ุฑุง ุฏุฑ ูุธุฑ ุจฺฏุฑุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> someTask = Task.Factory.StartNew(
    () =&gt; Task.Factory.StartNew(() =&gt; <span class="hljs-number">200</span>)
);
</code></pre>
<p>ุฏุฑ ุงู ฺฉุฏุ <code>someTask</code> ุงุฒ ููุน <code>Task&lt;Task&lt;int&gt;&gt;</code> ุงุณุช. ุงฺฏุฑ ุญุงูุง ฺฉุฏ ุฒุฑ ุฑุง ุงุฌุฑุง ฺฉูุฏ:</p>
<pre class="hljs"><code>WriteLine(someTask.Result);
</code></pre>
<p>ุฎุฑูุฌ ุจู ุดฺฉู ุฒุฑ ุฎูุงูุฏ ุจูุฏ:</p>
<pre class="hljs"><code>System.Threading.Tasks.Task`1[System.Int32]
</code></pre>
<p>ุงุฒ <strong>.NET 4 ุจู ุจุนุฏ</strong>ุ ูโุชูุงูุฏ ุงุฒ ฺฉ ุงุฒ <strong>ูุชุฏูุง Extension ุจู ูุงู <code>Unwrap</code></strong> ุงุณุชูุงุฏู ฺฉูุฏ ุชุง ูุฑ <code>Task&lt;Task&lt;TResult&gt;&gt;</code> ุฑุง ุจู <code>Task&lt;TResult&gt;</code> ุชุจุฏู ฺฉูุฏ (ุง <code>Task&lt;Task&gt;</code> ุจู <code>Task</code>). ุงู ูุธูู ุฌุฏุฏ ููุงูุฏู <strong>ูุธูู ุฏุงุฎู (inner nested task)</strong> ุฎูุงูุฏ ุจูุฏ ู <strong>ูุถุนุช ูุบู ู ุงุณุชุซูุงูุง</strong> ุฑุง ูุฒ ุดุงูู ูโุดูุฏ.</p>
<div align="center">
<p><img src="../../../assets/image/03/Table%203-9.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>ูุชุฏ Unwrap ๐</h3>
<p>ูุชุฏ <code>Unwrap</code> ุฏู ุจุงุฑฺฏุฐุงุฑ (overload) ุฏุงุฑุฏ:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Task <span class="hljs-title">Unwrap</span>(<span class="hljs-params"><span class="hljs-keyword">this</span> Task&lt;Task&gt; task</span>)</span>;
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title">Task</span>&lt;<span class="hljs-title">TResult</span>&gt; <span class="hljs-title">Unwrap</span>&lt;<span class="hljs-title">TResult</span>&gt;(<span class="hljs-params"><span class="hljs-keyword">this</span> Task&lt;Task&lt;TResult&gt;&gt; task</span>)</span>;
</code></pre>
<p>ููุงูโุทูุฑ ฺฉู ูุดุงูุฏู ูโฺฉูุฏุ ูุฑ ุฏู <strong>ูุชุฏูุง Extension</strong> ูุณุชูุฏ. ุฒูุงู ฺฉู ฺฉ <code>Task&lt;Task&gt;</code> (ุง <code>Task&lt;Task&lt;TResult&gt;&gt;</code>) ุฑุง unwrap ูโฺฉูุฏุ ฺฉ <strong>ูุธูู ุฌุฏุฏ (ูุนูููุงู ุจู ุขู proxy ฺฏูุชู ูโุดูุฏ)</strong> ุฏุฑุงูุช ูโฺฉูุฏ.</p>
<hr>
<h3>ูุซุงู ๐ป</h3>
<pre class="hljs"><code><span class="hljs-keyword">var</span> someTask1 = Task.Factory.StartNew(
    () =&gt; Task.Factory.StartNew(() =&gt; <span class="hljs-number">200</span>)
).Unwrap();

WriteLine(<span class="hljs-string">$&quot;Received: <span class="hljs-subst">{someTask1.Result}</span>&quot;</span>);
</code></pre>
<h4>ุฎุฑูุฌ ๐ฅ๏ธ</h4>
<pre class="hljs"><code>Received: 200
</code></pre>
<p>ุฌุงูุจ ุงุณุช ฺฉู ุงฺฏุฑ ุงุฒ ูุชุฏ <code>Run</code> ุงุณุชูุงุฏู ฺฉูุฏุ ุงู ฺฉุงุฑ <strong>ุจู ุทูุฑ ุฎูุฏฺฉุงุฑ ุจุฑุง ุดูุง ุงูุฌุงู ูโุดูุฏ</strong>. ูุซุงู ูุนุงุฏู:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> someTask2 = Task.Run(
    () =&gt; Task.Run(() =&gt; <span class="hljs-number">200</span>)
);

WriteLine(<span class="hljs-string">$&quot;Received: <span class="hljs-subst">{someTask2.Result}</span>&quot;</span>);
</code></pre>
<p>ุฎุฑูุฌ ููู ุฎูุงูุฏ ุจูุฏ:</p>
<pre class="hljs"><code>Received: 200
</code></pre>
<hr>
<h3>ูฺฉุชู ูฺู โญ</h3>
<p>ุฏุฑ ุงู ฺฉุชุงุจุ ูุง <strong>ฺฉููุงุช ฺฉูุฏ <code>async</code> ู <code>await</code></strong> ุฑุง ุจุฑุฑุณ ูฺฉุฑุฏูโุงู. ุจุง ุงู ุญุงูุ ูโุชูุงูุฏ ุงุฒ <code>await</code> ุจุฑุง <strong>unwrap ฺฉุฑุฏู ฺฉ ูุงู</strong> ุงุณุชูุงุฏู ฺฉูุฏ. ูุซุงู:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> someTask3 = Task.Factory.StartNew(
    () =&gt; Task.Factory.StartNew(() =&gt; <span class="hljs-number">200</span>)
);

WriteLine(<span class="hljs-string">$&quot;Received: <span class="hljs-subst">{<span class="hljs-keyword">await</span> someTask3.Result}</span>&quot;</span>);
</code></pre>
<p>ุงู ฺฉุฏ ูุฒ ฺฉุงููพุงู ูโุดูุฏ ู ุฎุฑูุฌ ูุดุงุจู ุฏุงุฑุฏ.</p>
<p>๐ก ูฺฉุชู: ูพุฑูฺู <strong>Chapter3_demo_unwrappingnestedtasks</strong> ุฑุง ุฏุงูููุฏ ฺฉูุฏ ุชุง ุงู ูุทุนุงุช ฺฉุฏ ุฑุง ุชูุฑู ฺฉูุฏ. ุงู ูพุฑูฺู ุฏุฑ ูพูุดู <strong>Chapter3</strong> ูุฑุงุฑ ุฏุงุฑุฏ.</p>
<hr>
<h3>ุฎูุงุตู ูุตู ๐</h3>
<p>ุงู ูุตู ุจู <strong>ุงุฏุงูู ูุธุงู (task continuations)</strong> ู <strong>ูุธุงู ุชู ุฏุฑ ุชู (nested tasks)</strong> ูพุฑุฏุงุฎุชู ุงุณุช ู ุจู ุทูุฑ ุฎูุงุตู ุจู ุณูุงูุงุช ุฒุฑ ูพุงุณุฎ ุฏุงุฏู ุงุณุช:</p>
<p>โข ฺฺฏููู ูโุชูุงู ฺฉ ูฺฉุงูุฒู ุณุงุฏู ุจุฑุง <strong>ุงุฏุงูู ูุธูู</strong> ูพุงุฏูโุณุงุฒ ฺฉุฑุฏุ<br>
โข ฺฺฏููู ูโุชูุงู ุดุงุฎูโูุง ูุฎุชูู ุงุฌุงุฏ ฺฉุฑุฏ ุชุง ุงุฒ <strong>ุงุฏุงูู ุดุฑุท ูุธูู</strong> ุงุณุชูุงุฏู ุดูุฏุ<br>
โข ฺฺฏููู ูโุชูุงู <strong>ูุถุนุช ูุธูู ูุนู</strong> ุฑุง ุจุฑุฑุณ ฺฉุฑุฏุ<br>
โข ฺฺฏููู ูโุชูุงู ฺฉ <strong>ูุธูู ุชู ุฏุฑ ุชู ุงุฌุงุฏุ ูุฏุฑุช ู unwrap</strong> ฺฉุฑุฏุ</p>
<h3>ุชูุฑูโูุง ๐</h3>
<p>ุจุฑุง ุจุฑุฑุณ ูุฒุงู ุฏุฑฺฉ ุฎูุฏุ <strong>ุชูุฑูโูุง ุฒุฑ ุฑุง ุงูุฌุงู ุฏูุฏ</strong> (ุจุฑุง ุงู ุชูุฑูโูุง ูุงุฒ ุจู ูุฏุฑุช ุงุณุชุซูุงูุง ุง ูุบู ูุธุงู ูุณุช):</p>
<div align="center">
<p><img src="../../../assets/image/03/Table%203-10.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>ุงุฏุขูุฑ โ๏ธ</h3>
<p>ููุงูโุทูุฑ ฺฉู ูุจูุงู ฺฏูุชู ุดุฏุ ูโุชูุงูุฏ ุจุง ุงุทููุงู ูุฑุถ ฺฉูุฏ ฺฉู <strong>ุชูุงู namespaceูุง ูุงุฒู</strong> ุจุฑุง ุงู ูุทุนุงุช ฺฉุฏ ุฏุฑ ุฏุณุชุฑุณ ูุณุชูุฏ. ุงู ูฺฉุชู ุจุฑุง <strong>ุชูุงู ุชูุฑูโูุง ุงู ฺฉุชุงุจ</strong> ูุฒ ุตุฏู ูโฺฉูุฏ.</p>
<hr>
<h2>ุชูุฑูโูุง ู ููููู ุฑุงูโุญูโูุง ๐๐ป</h2>
<h3>E3.1</h3>
<p>ุดุฑูุน ุจุง <strong>C# 12</strong>ุ ูโุชูุงูู <strong>Primary Constructor</strong> ุฑุง ุจู ุนููุงู ุจุฎุด ุงุฒ ุชุนุฑู ฺฉูุงุณ ูุดุฎุต ฺฉูู. ูุซุงู:</p>
<pre class="hljs"><code><span class="hljs-keyword">class</span> <span class="hljs-title">Employee</span> (<span class="hljs-title">string</span> <span class="hljs-title">name</span>, <span class="hljs-title">int</span> <span class="hljs-title">id</span>)
{
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">string</span> _name = name;
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">int</span> _id = id;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-built_in">string</span> <span class="hljs-title">ToString</span>()</span>
    {
        <span class="hljs-keyword">return</span> <span class="hljs-string">$&quot;Name:<span class="hljs-subst">{_name}</span> Id:<span class="hljs-subst">{_id}</span>&quot;</span>;
    }
}

<span class="hljs-comment">// ุงุฌุงุฏ ูููููโุง ุงุฒ ฺฉูุงุณ Employee</span>
Employee emp = <span class="hljs-keyword">new</span>(<span class="hljs-string">&quot;Bob&quot;</span>, <span class="hljs-number">1</span>);
</code></pre>
<p>ูุฑุถ ฺฉูุฏ ุฏู ูุธูู ุฏุงุฑู:<br>
1๏ธโฃ ุงููู ูุธููุ ฺฉ ููููู Employee ุงุฌุงุฏ ูโฺฉูุฏ.<br>
2๏ธโฃ ูุธูู ุฏููุ ูพุณ ุงุฒ ุงุชูุงู ูุธูู ุงูู ุงุฌุฑุง ุดุฏู ู ุงุจุชุฏุง ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ุขุง ูุธูู ุงูู ุจุง ููููุช ุชฺฉูู ุดุฏู ุงุณุช ุง ุฎุฑุ ุณูพุณ <strong>ุชุงุฑุฎ ู ุฒูุงู ุฌุงุฑ</strong> ุฑุง ฺุงูพ ูโฺฉูุฏ.</p>
<h4>ููููู ุจุฑูุงูู ๐ป</h4>
<pre class="hljs"><code><span class="hljs-keyword">using</span> <span class="hljs-keyword">static</span> System.Console;

<span class="hljs-keyword">var</span> createEmp = Task.Factory.StartNew(() =&gt; { })
    .ContinueWith(task =&gt;
    {
        Employee emp = <span class="hljs-keyword">new</span>(<span class="hljs-string">&quot;Bob&quot;</span>, <span class="hljs-number">1</span>);
        WriteLine(<span class="hljs-string">$&quot;Created an employee with <span class="hljs-subst">{emp}</span>&quot;</span>);
        WriteLine(<span class="hljs-string">$&quot;Was the previous task completed? <span class="hljs-subst">{task.IsCompletedSuccessfully}</span>&quot;</span>);
        WriteLine(<span class="hljs-string">$&quot;Current time:<span class="hljs-subst">{DateTime.Now}</span>&quot;</span>);
    });

createEmp.Wait();

<span class="hljs-keyword">class</span> <span class="hljs-title">Employee</span> (<span class="hljs-title">string</span> <span class="hljs-title">name</span>, <span class="hljs-title">int</span> <span class="hljs-title">id</span>)
{
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">string</span> _name = name;
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">int</span> _id = id;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-built_in">string</span> <span class="hljs-title">ToString</span>()</span>
    {
        <span class="hljs-keyword">return</span> <span class="hljs-string">$&quot;Name: <span class="hljs-subst">{_name}</span> Id: <span class="hljs-subst">{_id}</span>&quot;</span>;
    }
}
</code></pre>
<h4>ุฎุฑูุฌ ููููู ๐ฅ๏ธ</h4>
<pre class="hljs"><code>Created an employee with Name: Bob Id: 1
Was the previous task completed? True
Current time:10/16/2024 9:58:08 AM
</code></pre>
<hr>
<h3>E3.2</h3>
<p>ุงุฌุงุฏ ฺฉ <strong>ูุธูู ูพุณโุฒููู</strong> ฺฉู ฺฉ URL ุฑุง ping ูโฺฉูุฏ (ูุซูุงู <code>www.google.com</code>) ู ุณูพุณ ุงุฌุงุฏ ฺฉ <strong>ูุธูู ุงุฏุงูู</strong> ฺฉู ูุชุฌู ุฑุง ุฏุฑ ฺฉูุณูู ููุงุด ุฏูุฏ.</p>
<h4>ููููู ุจุฑูุงูู ๐ป</h4>
<pre class="hljs"><code><span class="hljs-keyword">using</span> <span class="hljs-keyword">static</span> System.Console;
<span class="hljs-keyword">using</span> System.Net.NetworkInformation;

<span class="hljs-built_in">string</span> url = <span class="hljs-string">&quot;www.google.com&quot;</span>;

WriteLine(<span class="hljs-string">$&quot;The main thread initiates a task that starts pinging <span class="hljs-subst">{url}</span>&quot;</span>);

<span class="hljs-keyword">var</span> pingTask = Task.Run(() =&gt; <span class="hljs-keyword">new</span> Ping().Send(url));

<span class="hljs-keyword">var</span> statusTask = pingTask.ContinueWith(previousTask =&gt;
{
    WriteLine(<span class="hljs-string">$&quot;Ping Status of <span class="hljs-subst">{url}</span>: <span class="hljs-subst">{pingTask.Result.Status}</span>&quot;</span>);
});

WriteLine(<span class="hljs-string">$&quot;The main thread is ready to do other work.&quot;</span>);

statusTask.Wait();
</code></pre>
<h4>ุฎุฑูุฌ ููููู ๐ฅ๏ธ</h4>
<pre class="hljs"><code>The main thread initiates a task that starts pinging www.google.com
The main thread is ready to do other work.
Ping Status of www.google.com: Success
</code></pre>
<p>๐ <strong>ูุณุฎู ุฌุงฺฏุฒู ุจุฏูู ูุชุบุฑ statusTask:</strong></p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> pingTask = Task.Run(() =&gt; <span class="hljs-keyword">new</span> Ping().Send(url))
    .ContinueWith(previousTask =&gt; previousTask.Result.Status);

WriteLine(<span class="hljs-string">$&quot;Ping Status of <span class="hljs-subst">{url}</span>: <span class="hljs-subst">{pingTask.Result}</span>&quot;</span>);
</code></pre>
<blockquote>
<p>ูฺฉุชู ููุณูุฏู: ูุฎ ุงุตู ุฏุฑ ุญู ุงุฌุฑุง ูุธูู ูพุณโุฒููู <strong>ูุณุฏูุฏ ูุดุฏู ุจูุฏ</strong> ู ููุท ุฏุฑ ูพุงุงู ุจุฑุง ููุงุด ุฎุฑูุฌ ููุชุธุฑ ูโูุงูุฏ.</p>
</blockquote>
<hr>
<h3>E3.3</h3>
<p>ูพุดโุจู ุฎุฑูุฌ ุจุฑูุงูู ุฒุฑ:</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> <span class="hljs-keyword">static</span> System.Console;

<span class="hljs-keyword">var</span> helloTask = Task.Run(() =&gt;
{
    WriteLine(<span class="hljs-string">&quot;Hello reader!&quot;</span>);
    <span class="hljs-keyword">var</span> aboutTask = Task.Factory.StartNew(() =&gt;
    {
        Task.Delay(<span class="hljs-number">1000</span>);
        WriteLine(<span class="hljs-string">&quot;How are you?&quot;</span>);
    }, TaskCreationOptions.AttachedToParent);
});

helloTask.Wait();
</code></pre>
<h4>ุฎุฑูุฌ ูุนููู ๐ฅ๏ธ</h4>
<pre class="hljs"><code>Hello reader!
</code></pre>
<p>โ ุฏูู: ุจุฑูุงูู ูุจู ุงุฒ ุงุชูุงู aboutTask ุฎุงุชูู ุงูุชู ุงุณุช.</p>
<p>ุจุง ุงุณุชูุงุฏู ุงุฒ <code>ReadKey()</code> ุง <code>ReadLine()</code> ุฏุฑ ูพุงุงู ูุฎ ุงุตูุ ูโุชูุงูุฏ ุจุฑูุงูู ุฑุง ุชุง ูุดุงูุฏู ุฎุฑูุฌ ฺฉุงูู ูฺฏู ุฏุงุฑุฏ:</p>
<pre class="hljs"><code>Hello reader!
How are you?
</code></pre>
<blockquote>
<p>ูฺฉุชู: <code>Task.Run(someAction)</code> ุจู ุทูุฑ ูพุดโูุฑุถ <strong>ุงุฌุงุฒู ุงุชุตุงู ูุธุงู ูุฑุฒูุฏ ุจู ูุงูุฏ ุฑุง ููโุฏูุฏ</strong>ุ ุงูุง <code>Task.Factory.StartNew</code> ุงู ุงูฺฉุงู ุฑุง ูุฑุงูู ูโฺฉูุฏ.</p>
</blockquote>
<hr>
<h3>E3.4</h3>
<p>ุขุง ูโุชูุงูุฏ ฺฉุฏ ุฒุฑ ุฑุง ฺฉุงููพุงู ฺฉูุฏุ</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> <span class="hljs-keyword">static</span> System.Console;

<span class="hljs-keyword">var</span> someTask = Task.Factory.StartNew(() =&gt; Task.Run(() =&gt; <span class="hljs-number">300</span>)).Unwrap();

WriteLine(<span class="hljs-string">$&quot;Received: <span class="hljs-subst">{someTask.Result}</span>&quot;</span>);
</code></pre>
<p>โ ุจููุ ุฎุฑูุฌ:</p>
<pre class="hljs"><code>Received: 300
</code></pre>
<hr>
<h3>E3.5</h3>
<p>ูพุดโุจู ุฎุฑูุฌ ุจุฑูุงูู ุฒุฑ:</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> <span class="hljs-keyword">static</span> System.Console;

<span class="hljs-keyword">var</span> getGift = Task.Factory.StartNew(() =&gt; <span class="hljs-string">&quot;Sunny wins a book&quot;</span>)
    .ContinueWith(previousTask =&gt;
        Task.Run(() =&gt; previousTask.Result + <span class="hljs-string">&quot; and a laptop.&quot;</span>)
    )
    .Unwrap();

WriteLine(getGift.Result);
</code></pre>
<h4>ุฎุฑูุฌ ๐ฅ๏ธ</h4>
<pre class="hljs"><code>Sunny wins a book and a laptop.
</code></pre>

</main>


 

  <!-- ููุชุฑ ูุดุชุฑฺฉ -->
  <footer class="footer">
    <div class="container">
      <p>
        <img src="/icone/copyright.svg" alt="ฺฉูพโุฑุงุช" width="14" height="14"
             style="vertical-align:middle;margin-inline:4px">
        <span id="y"></span> Gitab โ ุจุฑุง ุชูุณุนูโุฏููุฏฺฏุงู
      </p>
    </div>
  </footer>

  <!-- ุณุงู + ุงุณฺฉุฑูพุช ุชู -->
  <script>
    document.getElementById('y').textContent = new Date().getFullYear();

    (() => {
      const root = document.documentElement;
      const btn = document.getElementById('themeToggle');
      const KEY = 'gitab-theme';
      const media = window.matchMedia('(prefers-color-scheme: dark)');
      const getEffective = s => s === 'auto' ? (media.matches ? 'dark' : 'light') : s;
      function updateTheme(s) {
        root.setAttribute('data-theme', s);
        const mode = getEffective(s);
        root.dataset.colorMode = mode;
        btn.dataset.icon = mode === 'dark' ? 'moon' : 'sun';
      }
      const saved = localStorage.getItem(KEY) || 'auto';
      updateTheme(saved);
      btn.addEventListener('click', () => {
        const curr = localStorage.getItem(KEY) || 'auto';
        const next = curr === 'auto' ? 'dark' : curr === 'dark' ? 'light' : 'auto';
        localStorage.setItem(KEY, next);
        updateTheme(next);
      });
      media.addEventListener('change', () => {
        if ((localStorage.getItem(KEY) || 'auto') === 'auto') updateTheme('auto');
      });
      window.addEventListener('DOMContentLoaded', () => updateTheme(saved));
    })();
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script>hljs.highlightAll();</script>

<script>
document.querySelectorAll('pre code').forEach(block => {
  const btn = document.createElement('button');
  btn.className = 'copy-btn';

  const icon = document.createElement('img');
  icon.src = '/icone/copy.svg';
  icon.alt = 'Copy';
  btn.appendChild(icon);

  block.parentNode.insertBefore(btn, block);

  btn.addEventListener('click', async () => {
    await navigator.clipboard.writeText(block.textContent);
    btn.classList.add('copied');
    setTimeout(() => btn.classList.remove('copied'), 1500);
  });
});
</script>
<script>
  document.body.dataset.page = window.location.pathname;
</script>
<script>
  // ุจุงุฒ ู ุจุณุชู ฺฉุฑุฏู ููู ููุจุงู
  const menuBtn = document.querySelector(".menu-toggle");
  const nav = document.querySelector(".nav");

  if (menuBtn && nav) {
    // ุจุงุฒ ู ุจุณุชู ุดุฏู ุจุง ุฏฺฉูู
    menuBtn.addEventListener("click", (e) => {
      e.stopPropagation(); // ูุฐุงุฑู ฺฉูฺฉ ุฑู ุฎูุฏ ุฏฺฉูู ุจุงุนุซ ุจุณุชู ุดุฏู ุจุดู
      nav.classList.toggle("show");
    });

    // ุจุณุชู ููู ุจุง ฺฉูฺฉ ุจุฑูู
    document.addEventListener("click", (e) => {
      const clickedInsideNav = nav.contains(e.target);
      const clickedMenuButton = menuBtn.contains(e.target);
      if (!clickedInsideNav && !clickedMenuButton) {
        nav.classList.remove("show");
      }
    });
  }
</script>



</body>

</html>
