

<!doctype html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8">
  <link rel="icon" type="image/png" href="/Gitab/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ุงุณูุจูโูุง (Assemblies)</title>
  <meta name="description" content="ุชุฑุฌููโูุง ูุงุฑุณ ฺฉุชุงุจโูุง ูู โ ุณุฑุนุ ูููุงู ู ูุงุจู ุงุชฺฉุง.">

  <!-- ุงุณุชุงูโูุง -->
  <link rel="stylesheet" href="/Gitab/styles/main.css">
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">

  <style>
  @font-face {
    font-family: 'Vazir';
    src: url('/Gitab/fonts/Vazir-FD-WOL.ttf') format('truetype');
    font-display: swap;
  }
  body {
    font-family: 'Vazir', sans-serif;
  }
  </style>
</head>

<body>
  <!-- ูุฏุฑ ูุดุชุฑฺฉ -->
  <header class="header">
    <div class="container nav-wrap">
      <a href="/Gitab/" class="brand">
        <img src="/Gitab/icone/logo.svg" alt="Gitab logo" width="26" height="26">
        <span>Gitab</span>
      </a>

      <nav class="nav">
        <a href="/Gitab/" aria-current="page">ุฎุงูู</a>
        <a href="/Gitab/books/list-books">ฺฉุชุงุจโูุง</a>
       <a href="/Gitab/translator.html">ูุชุฑุฌูู</a>
        <a href="/Gitab/giter.html">ฺฏุชุฑ</a>
      </nav>

      <div class="nav-actions">
        <button id="themeToggle" class="icon-btn theme-btn" data-icon="moon" aria-label="ุชุบุฑ ุชู">
          <img src="/Gitab/icone/sun.svg" class="icon-sun" alt="ุฑูุดู">
          <img src="/Gitab/icone/moon.svg" class="icon-moon" alt="ุชุงุฑฺฉ">
        </button>

        <a class="icon-btn" href="https://github.com/hheydarian/Gitab" target="_blank" title="GitHub">
          <img src="/Gitab/icone/github.svg" alt="GitHub">
        </a>

        <!-- ุฏฺฉูู ููู ุจุฑุง ููุจุงู -->
        <button class="menu-toggle" aria-label="ููู">
          <img src="/Gitab/icone/menu.svg" alt="menu">
        </button>
      </div>
    </div>
  </header>

  
  <main class="site-main book-page">
    <h1>ุฏุฑุณ ููุฏูู:  ุงุณูุจูโูุง (Assemblies)</h1>
<p>ฺฉ <strong>assembly</strong> ูุงุญุฏ ูพุงูโุง ุจุฑุง ุงุณุชูุฑุงุฑ (deployment) ุฏุฑ .NET ุงุณุช ู ููฺูู ูุญูุธูโุง ุจุฑุง ุชูุงู <strong>type</strong>ูุง ุจู ุดูุงุฑ ูโุขุฏ. ฺฉ ุงุณูุจู ุดุงูู <strong>type</strong>ูุง ฺฉุงููพุงูโุดุฏู ุจู ููุฑุงู ฺฉุฏ <strong>Intermediate Language (IL)</strong>ุ ููุงุจุน ุงุฌุฑุง (<strong>runtime resources</strong>) ู ุงุทูุงุนุงุช ุจุฑุง ูุฏุฑุช ูุณุฎูโูุง ู ุงุฑุฌุงุน ุจู ุณุงุฑ ุงุณูุจูโูุง ุงุณุช. ููฺูู ุงุณูุจู ฺฉ ูุฑุฒ ุจุฑุง <strong>type resolution</strong> ุชุนุฑู ูโฺฉูุฏ. ุฏุฑ .NETุ ฺฉ ุงุณูุจู ูุนูููุงู ุดุงูู ฺฉ ูุงู ุจุง ูพุณููุฏ <code>.dll</code> ุงุณุช.</p>
<p>ุฒูุงู ฺฉู ฺฉ ุจุฑูุงูู ุงุฌุฑุง ุฏุฑ .NET ูโุณุงุฒุฏุ ุฏู ูุงู ุงุฌุงุฏ ูโุดูุฏ:</p>
<ul>
<li>ฺฉ ุงุณูุจู (.dll)</li>
<li>ฺฉ <strong>executable launcher</strong> (.exe) ฺฉู ูุชูุงุณุจ ุจุง ูพูุชูุฑู ุงุณุช ฺฉู ูุฏู ูุฑุงุฑ ุฏุงุฏูโุงุฏ.</li>
</ul>
<p>ุงู ุจุง ฺุฒ ฺฉู ุฏุฑ <strong>.NET Framework</strong> ุงุชูุงู ูโุงูุชุฏ ูุชูุงูุช ุงุณุชุ ุฌุง ฺฉู ฺฉ <strong>portable executable (PE) assembly</strong> ุชููุฏ ูโุดูุฏ. ฺฉ PE ุจุง ูพุณููุฏ <code>.exe</code> ูู ุจูโุนููุงู ุงุณูุจู ู ูู ุจูโุนููุงู ุจุฑูุงูู ุงุฌุฑุง ุนูู ูโฺฉูุฏ ู ูโุชูุงูุฏ ุจูโุทูุฑ ููุฒูุงู ูุณุฎูโูุง ณฒ ู ถด ุจุช ููุฏูุฒ ุฑุง ูุฏู ูุฑุงุฑ ุฏูุฏ.</p>
<p>ุงฺฉุซุฑ <strong>type</strong>ูุง ุงู ูุตู ุงุฒ ูุถุง ูุงูโูุง ุฒุฑ ุขูุฏูโุงูุฏ:</p>
<ul>
<li><code>System.Reflection</code></li>
<li><code>System.Resources</code></li>
<li><code>System.Globalization</code></li>
</ul>
<hr>
<h3>๐น ูุญุชูุง ฺฉ ุงุณูุจู (Whatโs in an Assembly) ๐น</h3>
<p>ฺฉ ุงุณูุจู ุดุงูู ฺูุงุฑ ููุน ูุญุชูุง ุงุณุช:</p>
<ol>
<li>
<p><strong>Assembly Manifest</strong></p>
<ul>
<li>ุงุทูุงุนุงุช ุจู <strong>CLR</strong> ูโุฏูุฏุ ูุงููุฏ ูุงู ุงุณูุจูุ ูุณุฎู ุขู ู ุณุงุฑ ุงุณูุจูโูุง ฺฉู ุจู ุขู ุงุฑุฌุงุน ุฏุงุฑูุฏ.</li>
</ul>
</li>
<li>
<p><strong>Application Manifest</strong></p>
<ul>
<li>ุงุทูุงุนุงุช ุจู ุณุณุชูโุนุงูู ูโุฏูุฏุ ูุงููุฏ ูุญูู ุงุณุชูุฑุงุฑ ุงุณูุจู ู ุงูโฺฉู ุขุง ูุงุฒ ุจู ุฏุณุชุฑุณ ูุฏุฑุช ูุฌูุฏ ุฏุงุฑุฏ ุง ุฎุฑ.</li>
</ul>
</li>
<li>
<p><strong>Compiled Types</strong></p>
<ul>
<li>ฺฉุฏ IL ฺฉุงููพุงูโุดุฏู ู <strong>metadata</strong> ูุฑุจูุท ุจู <strong>type</strong>ูุง ุชุนุฑูโุดุฏู ุฏุฑ ุงุณูุจู.</li>
</ul>
</li>
<li>
<p><strong>Resources</strong></p>
<ul>
<li>ุณุงุฑ ุฏุงุฏูโูุง ุชุนุจูโุดุฏู ุฏุฑ ุงุณูุจูุ ูุงููุฏ ุชุตุงูุฑ ู ูุชูโูุง ูุงุจู ุจููโุณุงุฒ (<strong>localizable text</strong>).</li>
</ul>
</li>
</ol>
<p>ุงุฒ ุงู ูุงูุ ุชููุง <strong>assembly manifest</strong> ุงุฌุจุงุฑ ุงุณุชุ ูุฑฺูุฏ ฺฉู ุชูุฑุจุงู ููุดู ฺฉ ุงุณูุจู ุดุงูู <strong>type</strong>ูุง ฺฉุงููพุงูโุดุฏู ูู ูุณุช (ูฺฏุฑ ุงูฺฉู ฺฉ <strong>resource assembly</strong> ุจุงุดุฏ. ุจุฑุง ุฌุฒุฆุงุช ุจู ุจุฎุด โResources and Satellite Assembliesโ ุฏุฑ ุตูุญู ททถ ูุฑุงุฌุนู ฺฉูุฏ).</p>
<hr>
<h3>๐น Assembly Manifest ๐น</h3>
<p><strong>Assembly Manifest</strong> ุฏู ูุฏู ุฏุงุฑุฏ:</p>
<ul>
<li>ุงุณูุจู ุฑุง ุจู ูุญุท ูุฒุจุงู ูุฏุฑุชโุดุฏู (<strong>managed hosting environment</strong>) ูุนุฑู ูโฺฉูุฏ.</li>
<li>ุจูโุนููุงู ฺฉ ููุฑุณุช ุจุฑุง <strong>module</strong>ูุงุ <strong>type</strong>ูุง ู ููุงุจุน ููุฌูุฏ ุฏุฑ ุงุณูุจู ุนูู ูโฺฉูุฏ.</li>
</ul>
<p>ุจูุงุจุฑุงูุ ุงุณูุจูโูุง ุฎูุฏุชูุตู (<strong>self-describing</strong>) ูุณุชูุฏ. ูุตุฑูโฺฉููุฏู ูโุชูุงูุฏ ุชูุงู ุฏุงุฏูโูุงุ <strong>type</strong>ูุง ู ุนููฺฉุฑุฏูุง ฺฉ ุงุณูุจู ุฑุง ุจุฏูู ูุงุฒ ุจู ูุงูโูุง ุงุถุงู ฺฉุดู ฺฉูุฏ.</p>
<p><strong>Assembly Manifest</strong> ุจูโุตูุฑุช ุฏุณุช ุงุถุงูู ููโุดูุฏุ ุจูฺฉู ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ุฏุฑ ููฺฏุงู ฺฉุงููพุงู ุฏุงุฎู ุงุณูุจู ุฌุงุณุงุฒ ูโุดูุฏ.</p>
<hr>
<h3>๐น ุฏุงุฏูโูุง ููู ุฐุฎุฑูโุดุฏู ุฏุฑ Manifest ๐น</h3>
<ul>
<li>ูุงู ุณุงุฏูโ ุงุณูุจู</li>
<li>ุดูุงุฑู ูุณุฎู (<strong>AssemblyVersion</strong>)</li>
<li>ฺฉูุฏ ุนููู ู ูุด ุงูุถุง ุดุฏูุ ุฏุฑ ุตูุฑุช ุฏุงุดุชู <strong>strong name</strong></li>
<li>ููุฑุณุช ุงุณูุจูโูุง ูุฑุฌุนุ ุดุงูู ูุณุฎู ู ฺฉูุฏ ุนููู ุขูโูุง</li>
<li>ููุฑุณุช <strong>type</strong>ูุง ุชุนุฑูโุดุฏู ุฏุฑ ุงุณูุจู</li>
<li>ูุฑููฺฏ ฺฉู ูุฏู ูุฑุงุฑ ุฏุงุฏู ุดุฏูุ ุฏุฑ ุตูุฑุช <strong>satellite assembly</strong> (<strong>AssemblyCulture</strong>)</li>
</ul>
<p><strong>ุฏุงุฏูโูุง ุงุทูุงุนุงุช ุฏฺฏุฑ ุดุงูู:</strong></p>
<ul>
<li>ุนููุงู ู ุชูุถุญุงุช ฺฉุงูู (<strong>AssemblyTitle ู AssemblyDescription</strong>)</li>
<li>ุงุทูุงุนุงุช ุดุฑฺฉุช ู ุญู ูุดุฑ (<strong>AssemblyCompany ู AssemblyCopyright</strong>)</li>
<li>ูุณุฎู ููุงุด (<strong>AssemblyInformationalVersion</strong>)</li>
<li>ูฺฺฏโูุง ุงุถุงู ุจุฑุง ุฏุงุฏูโูุง ุณูุงุฑุด</li>
</ul>
<p>ุจุฎุด ุงุฒ ุงู ุฏุงุฏูโูุง ุงุฒ ูพุงุฑุงูุชุฑูุง ูุฑูุฏ ุจู ฺฉุงููพุงูุฑ ุงุณุชุฎุฑุงุฌ ูโุดููุฏุ ูุงููุฏ ููุฑุณุช ุงุณูุจูโูุง ูุฑุฌุน ุง ฺฉูุฏ ุนููู ุจุฑุง ุงูุถุง ุงุณูุจู. ุจูู ุงุฒ <strong>assembly attributes</strong> ูโุขูุฏ (ฺฉู ุฏุฑ ูพุฑุงูุชุฒ ูุดุฎุต ุดุฏูโุงูุฏ).</p>
<hr>
<h3>๐น ูุดุงูุฏู ูุญุชูุงุช Manifest ๐น</h3>
<p>ูโุชูุงูุฏ ูุญุชูุงุช <strong>assembly manifest</strong> ุฑุง ุจุง ุงุจุฒุงุฑ <strong>.NET</strong> ุจู ูุงู <code>ildasm.exe</code> ูุดุงูุฏู ฺฉูุฏ. ุฏุฑ ูุตู ุจุนุฏ (ฑธ) ุชูุถุญ ุฏุงุฏู ูโุดูุฏ ฺฉู ฺฺฏููู ูโุชูุงู ุงู ฺฉุงุฑ ุฑุง ุจูโุตูุฑุช ุจุฑูุงููโููุณ ุจุง <strong>reflection</strong> ุงูุฌุงู ุฏุงุฏ.</p>
<hr>
<h3>๐น ูุดุฎุต ฺฉุฑุฏู Assembly Attributes ๐น</h3>
<p>ูฺฺฏโูุง ูุนููู ุงุณูุจู ุฑุง ูโุชูุงู ุฏุฑ <strong>Visual Studio</strong>ุ ุฏุฑ ุตูุญู Properties ูพุฑูฺู ู ุฏุฑ ุชุจ <strong>Package</strong> ูุดุฎุต ฺฉุฑุฏ. ุชูุธูุงุช ุงู ุชุจ ุจู ูุงู ูพุฑูฺู (.csproj) ุงุถุงูู ูโุดููุฏ.</p>
<p>ุจุฑุง ูุดุฎุต ฺฉุฑุฏู ูฺฺฏโูุง ฺฉู ุชูุณุท ุชุจ <strong>Package</strong> ูพุดุชุจุงู ููโุดููุฏุ ุง ุฏุฑ ุตูุฑุช ุนุฏู ฺฉุงุฑ ุจุง ูุงู .csprojุ ูโุชูุงูุฏ <strong>assembly attributes</strong> ุฑุง ุฏุฑ ฺฉุฏ ููุจุน ุชุนู ฺฉูุฏ (ุงุบูุจ ุฏุฑ ูุงู ุจู ูุงู <code>AssemblyInfo.cs</code>).</p>
<p>ูุซุงู: ุจุฑุง ุฏุณุชุฑุณ ุฏุงุฏู ุจู <strong>type</strong>ูุง ุฏุงุฎู ุจู ฺฉ ูพุฑูฺู ุชุณุช ูุงุญุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> System.Runtime.CompilerServices;
[<span class="hljs-meta">assembly: InternalsVisibleTo(<span class="hljs-string">&quot;MyUnitTestProject&quot;</span>)</span>]
</code></pre>
<hr>
<h3>๐น Application Manifest (ููุฏูุฒ) ๐น</h3>
<p><strong>Application Manifest</strong> ฺฉ ูุงู XML ุงุณุช ฺฉู ุงุทูุงุนุงุช ุฏุฑุจุงุฑูโ ุงุณูุจู ุจู ุณุณุชูโุนุงูู ููุชูู ูโฺฉูุฏ. ุงู ูุงู ุฏุฑ ููฺฏุงู ุณุงุฎุชุ ุจูโุนููุงู ฺฉ <strong>Win32 resource</strong> ุฏุงุฎู ูุงู ุงุฌุฑุง ูุฑุงุฑ ูโฺฏุฑุฏ. ุงฺฏุฑ ููุฌูุฏ ุจุงุดุฏุ ูุจู ุงุฒ ุจุงุฑฺฏุฐุงุฑ ุงุณูุจู ุชูุณุท CLR ุฎูุงูุฏู ุดุฏู ู ูพุฑุฏุงุฒุด ูโุดูุฏ ู ูโุชูุงูุฏ ูุญูู ุงุฌุฑุง ูุฑุขูุฏ ุจุฑูุงูู ุฏุฑ ููุฏูุฒ ุฑุง ุชุญุช ุชุฃุซุฑ ูุฑุงุฑ ุฏูุฏ.</p>
<p>ฺฉ <strong>manifest</strong> ุฏุฑ .NET ุฏุงุฑุง ุนูุตุฑ ุฑุดูโุง ุจู ูุงู <code>assembly</code> ุฏุฑ ูุถุง ูุงู XML ุฒุฑ ุงุณุช:</p>
<pre class="hljs"><code><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">assembly</span> <span class="hljs-attr">manifestVersion</span>=<span class="hljs-string">&quot;1.0&quot;</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;urn:schemas-microsoft-com:asm.v1&quot;</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- ูุญุชูุง manifest --&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">assembly</span>&gt;</span>
</code></pre>
<p>ูุซุงู ฺฉู ุฏุฑุฎูุงุณุช ุฏุณุชุฑุณ ูุฏุฑุช (<strong>administrative elevation</strong>) ูโฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">assembly</span> <span class="hljs-attr">manifestVersion</span>=<span class="hljs-string">&quot;1.0&quot;</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;urn:schemas-microsoft-com:asm.v1&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">trustInfo</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;urn:schemas-microsoft-com:asm.v2&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">security</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">requestedPrivileges</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">requestedExecutionLevel</span> <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;requireAdministrator&quot;</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">requestedPrivileges</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">security</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">trustInfo</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">assembly</span>&gt;</span>
</code></pre>
<blockquote>
<p>โ๏ธ ุจุฑูุงููโูุง <strong>UWP</strong> ุฏุงุฑุง manifest ุจุณุงุฑ ูพฺุฏูโุชุฑ ูุณุชูุฏ ฺฉู ุฏุฑ ูุงู <code>Package.appxmanifest</code> ุชูุตู ุดุฏู ุงุณุช ู ุดุงูู ุงุนูุงู ูุงุจูุชโูุง ุจุฑูุงูู ุงุณุช ฺฉู ูุดุฎุต ูโฺฉูุฏ ุณุณุชูโุนุงูู ฺู ูุฌูุฒูุง ูโุฏูุฏ. ุณุงุฏูโุชุฑู ุฑูุด ุจุฑุง ูุฑุงุด ุงู ูุงูุ ุงุณุชูุงุฏู ุงุฒ <strong>Visual Studio</strong> ุงุณุช ฺฉู ุจุง ุฏูุจุงุฑ ฺฉูฺฉ ุฑู ูุงูุ ฺฉ ุฏุงููฺฏ ููุงุด ูโุฏูุฏ.</p>
</blockquote>
<hr>
<h3>๐น ุงุณุชูุฑุงุฑ Application Manifest ๐น</h3>
<p>ุจุฑุง ุงูุฒูุฏู ฺฉ <strong>application manifest</strong> ุจู ูพุฑูฺู .NET ุฏุฑ <strong>Visual Studio</strong>:</p>
<ol>
<li>ุฑู ูพุฑูฺู ุฏุฑ <strong>Solution Explorer</strong> ุฑุงุณุชโฺฉูฺฉ ฺฉูุฏ.</li>
<li>ุงูุชุฎุงุจ ฺฉูุฏ <strong>Add โ New Item</strong></li>
<li>ฺฏุฒูู <strong>Application Manifest File</strong> ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ.</li>
</ol>
<p>ูพุณ ุงุฒ ุณุงุฎุช ูพุฑูฺูุ <strong>manifest</strong> ุฏุงุฎู <strong>output assembly</strong> ุฌุงุณุงุฒ ูโุดูุฏ.</p>
<hr>
<h3>๐น Modules ๐น</h3>
<p>ุงุจุฒุงุฑ <code>ildasm.exe</code> ูุฌูุฏ ฺฉ <strong>application manifest</strong> ุฌุงุณุงุฒโุดุฏู ุฑุง ุชุดุฎุต ููโุฏูุฏุ ุงูุง <strong>Visual Studio</strong> ููฺฏุงู ุฏูุจุงุฑ ฺฉูฺฉ ุฑู ุงุณูุจู ุฏุฑ <strong>Solution Explorer</strong> ูุดุงู ูโุฏูุฏ ฺฉู ุขุง manifest ููุฌูุฏ ุงุณุช ุง ุฎุฑ.</p>
<p>ุฏุฑ ูุงูุนุ ูุญุชูุงุช ฺฉ ุงุณูุจู ุฏุงุฎู ฺฉ <strong>container</strong> ูุงู ุจู ูุงู <strong>module</strong> ุจุณุชูโุจูุฏ ูโุดูุฏ. ูุฑ <strong>module</strong> ูุชูุงุธุฑ ุจุง ฺฉ ูุงู ุญุงู ูุญุชูุงุช ุงุณูุจู ุงุณุช. ุฏูู ุงู ูุงู ุงุถุงู ุงู ุงุณุช ฺฉู ุฏุฑ <strong>.NET Framework</strong> ุงูฺฉุงู ุชูุฒุน ฺฉ ุงุณูุจู ุฏุฑ ฺูุฏ ูุงู ูุฌูุฏ ุฏุงุฑุฏุ ุงูุง ุงู ูฺฺฏ ุฏุฑ <strong>.NET 5+ ู .NET Core</strong> ูุฌูุฏ ูุฏุงุฑุฏ.</p>
<p>๐ ุดฺฉู 17-1 ุฑุงุจุทู ุจู <strong>assembly</strong> ู <strong>module</strong> ุฑุง ูุดุงู ูโุฏูุฏ.</p>
<div align="center">
<p><img src="../../../assets/image/17/Table-17-1.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ุงฺฏุฑฺู .NET ุงุฒ <strong>multifile assemblies</strong> ูพุดุชุจุงู ููโฺฉูุฏุ ฺฏุงู ูุงุฒู ุงุณุช ุงุฒ ูุงู ุงุถุงู <strong>containership</strong> ฺฉู <strong>module</strong>ูุง ุงุฌุงุฏ ูโฺฉููุฏุ ุขฺฏุงู ุจุงุดุฏ. ุณูุงุฑู ุงุตู ุงู ููุถูุน ุฏุฑ <strong>reflection</strong> ุงุณุช (ุจู ุจุฎุดโูุง ยซReflecting Assembliesยป ุฏุฑ ุตูุญู ธฒท ู ยซEmitting Assemblies and Typesยป ุฏุฑ ุตูุญู ธดฑ ูุฑุงุฌุนู ฺฉูุฏ).</p>
<hr>
<h3>๐น ฺฉูุงุณ Assembly ๐น</h3>
<p>ฺฉูุงุณ <strong>Assembly</strong> ุฏุฑ ูุถุง ูุงู <code>System.Reflection</code> ุฏุฑูุงุฒูโุง ุจุฑุง ุฏุณุชุฑุณ ุจู <strong>metadata</strong> ุงุณูุจูโูุง ุฏุฑ ุฒูุงู ุงุฌุฑุง (<strong>runtime</strong>) ุงุณุช. ุฑูุดโูุง ูุฎุชูู ุจุฑุง ุจูโุฏุณุช ุขูุฑุฏู ฺฉ <strong>assembly object</strong> ูุฌูุฏ ุฏุงุฑุฏุ ุณุงุฏูโุชุฑู ุฑูุดุ ุงุณุชูุงุฏู ุงุฒ ูฺฺฏ <strong>Assembly</strong> ฺฉ <strong>Type</strong> ุงุณุช:</p>
<pre class="hljs"><code>Assembly a = <span class="hljs-keyword">typeof</span>(Program).Assembly;
</code></pre>
<p>ููฺูู ูโุชูุงูุฏ ุจุง ูุฑุงุฎูุงู ฺฉ ุงุฒ <strong>static method</strong>ูุง ฺฉูุงุณ <strong>Assembly</strong> ฺฉ ุดุก ุงุณูุจู ุจูโุฏุณุช ุขูุฑุฏ:</p>
<ul>
<li>
<p><strong>GetExecutingAssembly</strong><br>
ุงุณูุจู ููุน ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ ฺฉู ุชุงุจุน ุฌุงุฑ ุฏุฑ ุขู ุชุนุฑู ุดุฏู ุงุณุช.</p>
</li>
<li>
<p><strong>GetCallingAssembly</strong><br>
ุนููฺฉุฑุฏ ูุดุงุจู <strong>GetExecutingAssembly</strong> ุฑุง ุฏุงุฑุฏุ ุงูุง ุจุฑุง ุชุงุจุน ฺฉู ุชุงุจุน ุฌุงุฑ ุฑุง ูุฑุงุฎูุงู ฺฉุฑุฏู ุงุณุช.</p>
</li>
<li>
<p><strong>GetEntryAssembly</strong><br>
ุงุณูุจูโุง ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ ฺฉู ูุชุฏ ูุฑูุฏ (<strong>entry method</strong>) ุงุตู ุจุฑูุงูู ุฑุง ุชุนุฑู ูโฺฉูุฏ.</p>
</li>
</ul>
<p>ูพุณ ุงุฒ ุฏุงุดุชู ฺฉ <strong>Assembly object</strong>ุ ูโุชูุงูุฏ ุงุฒ <strong>properties</strong> ู <strong>methods</strong> ุขู ุจุฑุง ูพุฑุณโูุฌู <strong>metadata</strong> ุงุณูุจู ู ุจุงุฒุชุงุจ (<strong>reflect</strong>) ุจุฑ ุฑู <strong>type</strong>ูุง ุขู ุงุณุชูุงุฏู ฺฉูุฏ.</p>
<p>๐ ุฌุฏูู ฑท-ฑ ุฎูุงุตูโุง ุงุฒ ุงู ุชูุงุจุน ุฑุง ูุดุงู ูโุฏูุฏ.</p>
<div align="center">
<p><img src="../../../assets/image/17/Table-17-2.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>๐น ุงุณุงู ูู ู ุงูุถุง ุงุณูุจู (Strong Names and Assembly Signing) ๐น</h3>
<p>ุฏุงุดุชู <strong>strong name</strong> ุจุฑุง ฺฉ ุงุณูุจู ุฏุฑ <strong>.NET Framework</strong> ุงููุช ุฏุงุดุชุ ุจู ุฏู ุฏูู:</p>
<ul>
<li>ุงูฺฉุงู ุจุงุฑฺฏุฐุงุฑ ุงุณูุจู ุฏุฑ <strong>Global Assembly Cache (GAC)</strong>.</li>
<li>ุงูฺฉุงู ุงุฑุฌุงุน ุณุงุฑ <strong>strongly named assemblies</strong> ุจู ุขู.</li>
</ul>
<p>ุฏุฑ <strong>.NET 5+</strong> ู <strong>.NET Core</strong> ุงู ููุถูุน ฺฉูุชุฑ ุงููุช ุฏุงุฑุฏุ ุฒุฑุง ุงู <strong>runtime</strong>ูุง ูู <strong>global assembly cache</strong> ุฏุงุฑูุฏ ู ูู ูุญุฏูุฏุช ุฏูู ุฑุง ุงุนูุงู ูโฺฉููุฏ.</p>
<p>ฺฉ <strong>strongly named assembly</strong> ููุช ฺฉุชุง ุฏุงุฑุฏ. ุงู ฺฉุงุฑ ุจุง ุงูุฒูุฏู ุฏู ูุทุนู <strong>metadata</strong> ุจู <strong>manifest</strong> ุงูุฌุงู ูโุดูุฏ:</p>
<ul>
<li>ฺฉ ุดูุงุฑู ฺฉุชุง ูุชุนูู ุจู ููุณูุฏฺฏุงู ุงุณูุจู</li>
<li>ฺฉ <strong>signed hash</strong> ุงุฒ ุงุณูุจู ฺฉู ุซุงุจุช ูโฺฉูุฏ ุตุงุญุจ ุดูุงุฑู ฺฉุชุงุ ุงุณูุจู ุฑุง ุชููุฏ ฺฉุฑุฏู ุงุณุช</li>
</ul>
<p>ุงู ูุฑุขูุฏ ูุงุฒููุฏ ฺฉ ุฌูุช <strong>ฺฉูุฏ ุนููู/ุฎุตูุต</strong> ุงุณุช. ฺฉูุฏ ุนููู ุดูุงุฑู ฺฉุชุง ุดูุงุณุง ุฑุง ูุฑุงูู ูโฺฉูุฏ ู ฺฉูุฏ ุฎุตูุต ุจุฑุง ุงูุถุง ุงุณุชูุงุฏู ูโุดูุฏ.</p>
<blockquote>
<p>โ๏ธ <strong>Strong-name-signing</strong> ุจุง <strong>Authenticode-signing</strong> ูุชูุงูุช ุงุณุช. <strong>Authenticode</strong> ุจุนุฏุงู ุฏุฑ ููู ูุตู ุชูุถุญ ุฏุงุฏู ุฎูุงูุฏ ุดุฏ.</p>
</blockquote>
<p>ฺฉูุฏ ุนููู ุฏุฑ ุชุถูู ฺฉุชุง ุงุฑุฌุงุนุงุช ุจู ุงุณูุจูโูุง ุงุฑุฒุดููุฏ ุงุณุช: ฺฉ <strong>strongly named assembly</strong> ฺฉูุฏ ุนููู ุฑุง ุฏุฑ ููุช ุฎูุฏ ูุงุฑุฏ ูโฺฉูุฏ.</p>
<p>ุฏุฑ <strong>.NET Framework</strong>ุ ฺฉูุฏ ุฎุตูุต ุงุฒ ุชุบุฑ ู ุฏุณุชฺฉุงุฑ ุงุณูุจู ุฌููฺฏุฑ ูโฺฉูุฏุ ุฒุฑุง ุจุฏูู ฺฉูุฏ ุฎุตูุต ุดูุงุ ูฺโฺฉุณ ููโุชูุงูุฏ ูุณุฎู ุชุบุฑ ุงูุชู ุงุณูุจู ุฑุง ููุชุดุฑ ฺฉูุฏ ุจุฏูู ุงูฺฉู ุงูุถุง ุฎุฑุงุจ ุดูุฏ. ุฏุฑ ุนููุ ุงู ุจุฑุง ุจุงุฑฺฏุฐุงุฑ ุงุณูุจู ุฏุฑ <strong>GAC</strong> ฺฉุงุฑุจุฑุฏ ุฏุงุฑุฏ. ุฏุฑ <strong>.NET 5+</strong> ู <strong>.NET Core</strong> ุงูุถุง ฺฉูฺฉ ูุฏุงุฑุฏุ ุฒุฑุง ุจุฑุฑุณ ููโุดูุฏ.</p>
<p>ุงุถุงูู ฺฉุฑุฏู <strong>strong name</strong> ุจู ฺฉ ุงุณูุจู ูุจูุงู ยซุถุนูยป ูุงูโฺฏุฐุงุฑโุดุฏูุ ููุช ุขู ุฑุง ุชุบุฑ ูโุฏูุฏ. ุจู ููู ุฏููุ ุจูุชุฑ ุงุณุช ุงุฒ ุงุจุชุฏุง ุงฺฏุฑ ุงุญุชูุงู ูโุฏูุฏ ุงุณูุจู ุฏุฑ ุขูุฏู ุจู <strong>strong name</strong> ูุงุฒ ูพุฏุง ฺฉูุฏุ ุขู ุฑุง ุงุฒ ุงุจุชุฏุง ูู ูุงูโฺฏุฐุงุฑ ฺฉูุฏ.</p>
<hr>
<h3>๐น ฺฺฏููู ฺฉ ุงุณูุจู ุฑุง Strongly Name ฺฉูู ๐น</h3>
<p>ุจุฑุง ุฏุงุฏู <strong>strong name</strong> ุจู ฺฉ ุงุณูุจูุ ุงุจุชุฏุง ฺฉ ุฌูุช ฺฉูุฏ ุนููู/ุฎุตูุต ุจุง ุงุจุฒุงุฑ <code>sn.exe</code> ุชููุฏ ฺฉูุฏ:</p>
<pre class="hljs"><code>sn.exe -k MyKeyPair.snk
</code></pre>
<p><strong>Visual Studio</strong> ูุงูุจุฑ ุจู ูุงู <strong>Developer Command Prompt for VS</strong> ูุตุจ ูโฺฉูุฏ ฺฉู ฺฉ <strong>command prompt</strong> ุจุง ูุณุฑ ุงุจุฒุงุฑูุง ุชูุณุนู (ูุงููุฏ <code>sn.exe</code>) ูุฑุงูู ูโุขูุฑุฏ.</p>
<p>ุงู ุฏุณุชูุฑ ฺฉ ุฌูุช ฺฉูุฏ ุฌุฏุฏ ุชููุฏ ูโฺฉูุฏ ู ุขู ุฑุง ุฏุฑ ูุงู ุจู ูุงู <code>MyKeyPair.snk</code> ุฐุฎุฑู ูโฺฉูุฏ. ุงฺฏุฑ ุจุนุฏุงู ุงู ูุงู ุฑุง ุงุฒ ุฏุณุช ุจุฏูุฏุ ุชูุงูุง ฺฉุงููพุงู ูุฌุฏุฏ ุงุณูุจู ุจุง ููุงู ููุช ุฑุง ุจูโุทูุฑ ุฏุงุฆู ุงุฒ ุฏุณุช ุฎูุงูุฏ ุฏุงุฏ.</p>
<p>ูโุชูุงูุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ ุงู ูุงูุ ุงุณูุจู ุฑุง ุงูุถุง ฺฉูุฏ. ุฏุฑ <strong>Visual Studio</strong>:</p>
<ol>
<li>ุจู <strong>Project Properties</strong> ุจุฑูุฏ</li>
<li>ุฏุฑ ุชุจ <strong>Signing</strong>ุ ฺฏุฒูู <strong>Sign the assembly</strong> ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ</li>
<li>ูุงู <code>.snk</code> ุฎูุฏ ุฑุง ูุดุฎุต ฺฉูุฏ</li>
</ol>
<p>ฺฉ ุฌูุช ฺฉูุฏ ูโุชูุงูุฏ ฺูุฏู ุงุณูุจู ุฑุง ุงูุถุง ฺฉูุฏุ ูุฑ ฺฉุฏุงู ูููุฒ ููุช ูุชูุงุฒ ุฎูุงููุฏ ุฏุงุดุชุ ุงฺฏุฑ ูุงู ุณุงุฏู ุขูโูุง ูุชูุงูุช ุจุงุดุฏ.</p>
<hr>
<h3>๐น ุงุณุงู ุงุณูุจู (Assembly Names) ๐น</h3>
<p>ููุช ฺฉ ุงุณูุจู ุดุงูู ฺูุงุฑ ุจุฎุด ุงุฒ <strong>metadata</strong> ุฏุฑ <strong>manifest</strong> ุงุณุช:</p>
<ul>
<li><strong>ูุงู ุณุงุฏู (Simple Name)</strong></li>
<li><strong>ูุณุฎู (Version)</strong> โ ุงฺฏุฑ ููุฌูุฏ ูุจุงุดุฏ โ0.0.0.0โ ุงุณุช</li>
<li><strong>ูุฑููฺฏ (Culture)</strong> โ ุงฺฏุฑ satellite assembly ูุจุงุดุฏ โneutralโ ุงุณุช</li>
<li><strong>Public Key Token</strong> โ ุงฺฏุฑ <strong>strongly named</strong> ูุจุงุดุฏ โnullโ ุงุณุช</li>
</ul>
<p>ูุงู ุณุงุฏู ุงุฒ ูฺฺฏโูุง ุงุณุชุฎุฑุงุฌ ููโุดูุฏุ ุจูฺฉู ุงุฒ ูุงู ูุงู ุงุตู ฺฉุงููพุงูโุดุฏู (ุจุฏูู ูพุณููุฏ) ูโุขุฏ. ูุซูุงู ูุงู ุณุงุฏู ุงุณูุจู <code>System.Xml.dll</code> ุจุฑุงุจุฑ ุจุง <code>System.Xml</code> ุงุณุช. ุชุบุฑ ูุงู ูุงูุ ูุงู ุณุงุฏู ุงุณูุจู ุฑุง ุชุบุฑ ููโุฏูุฏ.</p>
<p>ุดูุงุฑู ูุณุฎู ุงุฒ ูฺฺฏ <strong>AssemblyVersion</strong> ูโุขุฏ ู ุฑุดุชูโุง ุดุงูู ฺูุงุฑ ูุณูุช ุงุณุช:</p>
<pre class="hljs"><code>major.minor.build.revision
</code></pre>
<p>ูุซุงู:</p>
<pre class="hljs"><code>[<span class="hljs-meta">assembly: AssemblyVersion(<span class="hljs-string">&quot;2.5.6.7&quot;</span>)</span>]
</code></pre>
<p>ูุฑููฺฏ ุงุฒ ูฺฺฏ <strong>AssemblyCulture</strong> ฺฏุฑูุชู ูโุดูุฏ ู ุจุฑุง <strong>satellite assembly</strong>ูุง ฺฉุงุฑุจุฑุฏ ุฏุงุฑุฏ (ุฏุฑ ุจุฎุด ยซResources and Satellite Assembliesยป ุตูุญู ททถ ุชูุถุญ ุฏุงุฏู ุดุฏู ุงุณุช).</p>
<p><strong>Public Key Token</strong> ุงุฒ <strong>strong name</strong> ููฺฏุงู ฺฉุงููพุงู ุจู ุฏุณุช ูโุขุฏ.</p>
<hr>
<h3>๐น ุงุณุงู ฺฉุงูู (Fully Qualified Names) ๐น</h3>
<p>ฺฉ ูุงู ฺฉุงูู ุงุณูุจู ุฑุดุชูโุง ุงุณุช ฺฉู ุดุงูู ูุฑ ฺูุงุฑ ุจุฎุด ููุช ุงุณุชุ ุจู ุดฺฉู:</p>
<pre class="hljs"><code>simple-name, Version=version, Culture=culture, PublicKeyToken=public-key
</code></pre>
<p>ูุซุงู: ูุงู ฺฉุงูู <code>System.Private.CoreLib.dll</code>:</p>
<pre class="hljs"><code>System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e
</code></pre>
<p>ุงฺฏุฑ ูฺฺฏ <strong>AssemblyVersion</strong> ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏุ ูุณุฎู ุจู ุตูุฑุช <code>0.0.0.0</code> ููุงุด ุฏุงุฏู ูโุดูุฏ. ุงฺฏุฑ unsigned ุจุงุดุฏุ <strong>public key token</strong> ุจุฑุงุจุฑ <code>null</code> ุงุณุช.</p>
<p>ูฺฺฏ <strong>FullName</strong> ฺฉ <strong>Assembly object</strong> ูุงู ฺฉุงูู ุขู ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ. ฺฉุงููพุงูุฑ ููุดู ุงุฒ ูุงู ฺฉุงูู ุจุฑุง ุซุจุช ุงุฑุฌุงุนุงุช ุจู ุงุณูุจู ุฏุฑ <strong>manifest</strong> ุงุณุชูุงุฏู ูโฺฉูุฏ.</p>
<blockquote>
<p>โ๏ธ ูุงู ฺฉุงูู ุงุณูุจู ุดุงูู ูุณุฑ ุฏุงุฑฺฉุชูุฑ ูุณุช. ุงูุชู ุงุณูุจู ุฏุฑ ุฏุงุฑฺฉุชูุฑ ุฏฺฏุฑ ููุถูุน ุฌุฏุงฺฏุงูู ุงุณุช ฺฉู ุฏุฑ ุจุฎุด ยซLoading, Resolving, and Isolating Assembliesยป ุตูุญู ทธณ ุชูุถุญ ุฏุงุฏู ูโุดูุฏ.</p>
</blockquote>
<hr>
<h3>๐น ฺฉูุงุณ AssemblyName ๐น</h3>
<p>ฺฉูุงุณ <strong>AssemblyName</strong> ุฏุงุฑุง ูฺฺฏโูุง typed ุจุฑุง ูุฑ ฺูุงุฑ ุจุฎุด ูุงู ฺฉุงูู ุงุณูุจู ุงุณุช. ุฏู ฺฉุงุฑุจุฑุฏ ุงุตู ุฏุงุฑุฏ:</p>
<ul>
<li>ุชุฌุฒู ุง ุณุงุฎุช ูุงู ฺฉุงูู ุงุณูุจู</li>
<li>ุฐุฎุฑู ุฏุงุฏูโูุง ุงุถุงู ุจุฑุง ฺฉูฺฉ ุจู ุงูุชู (<strong>resolve</strong>) ุงุณูุจู</li>
</ul>
<p>ุฑูุดโูุง ุจูโุฏุณุช ุขูุฑุฏู ฺฉ <strong>AssemblyName object</strong>:</p>
<ul>
<li>ุณุงุฎุช ฺฉ <strong>AssemblyName</strong> ุจุง ุงุฑุงุฆู ูุงู ฺฉุงูู</li>
<li>ูุฑุงุฎูุงู <strong>GetName</strong> ุฑู ฺฉ <strong>Assembly</strong> ููุฌูุฏ</li>
<li>ูุฑุงุฎูุงู <strong>AssemblyName.GetAssemblyName</strong> ุจุง ูุณุฑ ูุงู ุงุณูุจู</li>
</ul>
<p>ููฺูู ูโุชูุงู ฺฉ <strong>AssemblyName</strong> ุจุฏูู ุขุฑฺฏููุงู ุณุงุฎุช ู ุณูพุณ ูุฑ ูฺฺฏ ุขู ุฑุง ุชูุธู ฺฉุฑุฏ ุชุง ฺฉ ูุงู ฺฉุงูู ุณุงุฎุชู ุดูุฏ. ุฏุฑ ุงู ุญุงูุชุ <strong>AssemblyName</strong> ูุงุจู ุชุบุฑ (<strong>mutable</strong>) ุงุณุช.</p>
<hr>
<h3>๐น ูฺฺฏโูุง ู ูุชุฏูุง ุงุตู AssemblyName ๐น</h3>
<table>
<thead>
<tr>
<th>ููุน</th>
<th>ูุงู</th>
<th>ุชูุถุญ</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>FullName</td>
<td>ูุงู ฺฉุงูู</td>
</tr>
<tr>
<td>string</td>
<td>Name</td>
<td>ูุงู ุณุงุฏู</td>
</tr>
<tr>
<td>Version</td>
<td>Version</td>
<td>ูุณุฎู ุงุณูุจู</td>
</tr>
<tr>
<td>CultureInfo</td>
<td>CultureInfo</td>
<td>ุจุฑุง <strong>satellite assembly</strong></td>
</tr>
<tr>
<td>string</td>
<td>CodeBase</td>
<td>ูฺฉุงู ุงุณูุจู</td>
</tr>
<tr>
<td>byte[]</td>
<td>GetPublicKey()</td>
<td>ฺฉูุฏ ุนููู ฺฉุงูู (160 ุจุงุช)</td>
</tr>
<tr>
<td>void</td>
<td>SetPublicKey(byte[] key)</td>
<td>ุชุนู ฺฉูุฏ ุนููู</td>
</tr>
<tr>
<td>byte[]</td>
<td>GetPublicKeyToken()</td>
<td>ูุณุฎู ธ ุจุงุช ฺฉูุฏ ุนููู</td>
</tr>
<tr>
<td>void</td>
<td>SetPublicKeyToken(byte[] publicKeyToken)</td>
<td>ุชุนู public key token</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>Version</strong> ุฎูุฏ ฺฉ ุดุก strongly typed ุจุง ูฺฺฏโูุง <strong>Major, Minor, Build, Revision</strong> ุงุณุช.</li>
<li><strong>GetPublicKey</strong> ฺฉูุฏ ุนููู ุฑูุฒูฺฏุงุฑ ฺฉุงูู ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ.</li>
<li><strong>GetPublicKeyToken</strong> ุขุฎุฑู ธ ุจุงุช ุงุณุชูุงุฏูโุดุฏู ุจุฑุง ุชุนู ููุช ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ.</li>
</ul>
<p>ูุซุงู: ุจูโุฏุณุช ุขูุฑุฏู ูุงู ุณุงุฏู ฺฉ ุงุณูุจู:</p>
<pre class="hljs"><code>Console.WriteLine(<span class="hljs-keyword">typeof</span>(<span class="hljs-built_in">string</span>).Assembly.GetName().Name);
<span class="hljs-comment">// System.Private.CoreLib</span>
</code></pre>
<p>ุฏุฑุงูุช ูุณุฎู ุงุณูุจู:</p>
<pre class="hljs"><code><span class="hljs-built_in">string</span> v = myAssembly.GetName().Version.ToString();
</code></pre>
<hr>
<h3>๐น ูุณุฎูโูุง ุงุทูุงุนุงุช ู ูุงู ุงุณูุจู ๐น</h3>
<p>ุฏู ูฺฺฏ ุฏฺฏุฑ ุจุฑุง ุจุงู ุงุทูุงุนุงุช ูุฑุจูุท ุจู ูุณุฎู ูุฌูุฏ ุฏุงุฑุฏ. ุจุฑุฎูุงู <strong>AssemblyVersion</strong>ุ ุงู ุฏู ูฺฺฏ ููุช ุงุณูุจู ุฑุง ุชุบุฑ ููโุฏููุฏ ู ุชุฃุซุฑ ุจุฑ ฺฉุงููพุงู ุง ุฒูุงู ุงุฌุฑุง ูุฏุงุฑูุฏ:</p>
<ul>
<li>
<p><strong>AssemblyInformationalVersion</strong><br>
ูุณุฎูโุง ฺฉู ุจู ฺฉุงุฑุจุฑ ููุง ููุงุด ุฏุงุฏู ูโุดูุฏ. ุฏุฑ ุฏุงููฺฏ <strong>Windows File Properties</strong> ุจูโุนููุงู <strong>Product Version</strong> ุฏุฏู ูโุดูุฏ. ูุฑ ุฑุดุชูโุง ูโุชูุงูุฏ ุจุงุดุฏุ ูุงููุฏ <code>&quot;5.1 Beta 2&quot;</code>. ูุนูููุงู ุชูุงู ุงุณูุจูโูุง ฺฉ ุจุฑูุงูู ุฏุงุฑุง ููู ุดูุงุฑู ูุณุฎู ุงุทูุงุนุงุช ูุณุชูุฏ.</p>
</li>
<li>
<p><strong>AssemblyFileVersion</strong><br>
ูุนูููุงู ุจู ุดูุงุฑู <strong>build</strong> ุขู ุงุณูุจู ุงุดุงุฑู ุฏุงุฑุฏ. ุฏุฑ ุฏุงููฺฏ <strong>Windows File Properties</strong> ุจูโุนููุงู <strong>File Version</strong> ุฏุฏู ูโุดูุฏ. ูุดุงุจู <strong>AssemblyVersion</strong>ุ ุจุงุฏ ุฑุดุชูโุง ุดุงูู ุญุฏุงฺฉุซุฑ ฺูุงุฑ ุนุฏุฏ ุฌุฏุงุดุฏู ุจุง ููุทู ุจุงุดุฏ.</p>
</li>
</ul>
<h3>๐น ุงูุถุง Authenticode ๐น</h3>
<p><strong>Authenticode</strong> ฺฉ ุณุณุชู <strong>code-signing</strong> ุงุณุช ฺฉู ูุฏู ุขู ุงุซุจุงุช ููุช ูุงุดุฑ ุจุฑูุงูู ุงุณุช.<br>
ุงูุถุง <strong>Authenticode</strong> ู <strong>strong-name signing</strong> ูุณุชูู ุงุฒ ูู ูุณุชูุฏุ ูโุชูุงูุฏ ฺฉ ุงุณูุจู ุฑุง ุจุง ูุฑ ฺฉ ุง ูุฑ ุฏู ุณุณุชู ุงูุถุง ฺฉูุฏ.</p>
<p>ุงฺฏุฑฺู <strong>strong-name signing</strong> ูโุชูุงูุฏ ุงุซุจุงุช ฺฉูุฏ ฺฉู ุงุณูุจูโูุง Aุ B ู C ุงุฒ ฺฉ ูุงุดุฑ ุขูุฏูโุงูุฏ (ุจุง ูุฑุถ ุงูฺฉู ฺฉูุฏ ุฎุตูุต ูู ูุฑูุชู ุจุงุดุฏ)ุ ุงูุง ููโุชูุงูุฏ ูุดุฎุต ฺฉูุฏ ุขู ูุงุดุฑ ฺู ฺฉุณ ุงุณุช. ุจุฑุง ูุซุงูุ ุจุฑุง ุฏุงูุณุชู ุงูฺฉู ูุงุดุฑ <strong>Joe Albahari</strong> ุง <strong>Microsoft Corporation</strong> ุจูุฏู ุงุณุชุ ุจู <strong>Authenticode</strong> ูุงุฒ ุฏุงุฑุฏ.</p>
<p><strong>Authenticode</strong> ููฺฏุงู ุฏุงูููุฏ ุจุฑูุงููโูุง ุงุฒ ุงูุชุฑูุช ููุฏ ุงุณุชุ ุฒุฑุง ุชุถูู ูโฺฉูุฏ ุจุฑูุงูู ุฏููุงู ุงุฒ ููุงู ุดุฎุต ุขูุฏู ฺฉู ุชูุณุท <strong>Certificate Authority</strong> ูุนุฑู ุดุฏู ู ุฏุฑ ูุณุฑ ุงูุชูุงู ุชุบุฑ ูฺฉุฑุฏู ุงุณุช. ููฺูู ูุงูุน ููุงุด ูุดุฏุงุฑ โUnknown Publisherโ ููฺฏุงู ุงุฌุฑุง ุจุฑูุงูู ุฏุงูููุฏ ุดุฏู ุจุฑุง ุงููู ุจุงุฑ ูโุดูุฏ.</p>
<blockquote>
<p>โ๏ธ ุงูุถุง Authenticode ููฺูู ุดุฑุท ุงุฑุณุงู ุจุฑูุงููโูุง ุจู <strong>Windows Store</strong> ุงุณุช.</p>
</blockquote>
<hr>
<p><strong>Authenticode</strong> ูู ุชููุง ุจุง ุงุณูุจูโูุง .NET ฺฉุงุฑ ูโฺฉูุฏุ ุจูฺฉู ุจุง ูุงูโูุง ุงุฌุฑุง unmanaged ู ุจุงูุฑโูุง ูุงููุฏ ูุงูโูุง ูุตุจ <code>.msi</code> ูุฒ ุณุงุฒฺฏุงุฑ ุงุณุช. ุงูุจุชู Authenticode ุชุถูู ููโฺฉูุฏ ฺฉู ุจุฑูุงูู ูุงูุฏ <strong>malware</strong> ุจุงุดุฏุ ูู ุงุญุชูุงู ุขู ุฑุง ฺฉุงูุด ูโุฏูุฏ.</p>
<p>ฺฉ ูุฑุฏ ุง ุณุงุฒูุงู ุญุงุถุฑ ุดุฏู ูุงู ุฎูุฏ (ุจุง ูพุดุชูุงูู ูพุงุณูพูุฑุช ุง ูุฏุงุฑฺฉ ุดุฑฺฉุช) ุฑุง ูพุดุช ูุงู ุงุฌุฑุง ุง ฺฉุชุงุจุฎุงูู ูุฑุงุฑ ุฏูุฏ.</p>
<p>CLR ุงูุถุง <strong>Authenticode</strong> ุฑุง ุจูโุนููุงู ุจุฎุด ุงุฒ ููุช ุงุณูุจู ููโุดูุงุณุฏุ ุงูุง ูโุชูุงูุฏ ุงูุถุง ุฑุง ุจูโุตูุฑุช ุฏุฑุฎูุงุณุช (<strong>on demand</strong>) ุฎูุงูุฏู ู ุงุนุชุจุงุฑุณูุฌ ฺฉูุฏ.</p>
<hr>
<h3>๐น ูุญูู ุงูุถุง ุจุง Authenticode ๐น</h3>
<h4>ฑ. ุจูโุฏุณุช ุขูุฑุฏู ู ูุตุจ ฺฏูุงูโูุงูู</h4>
<p>ุงุจุชุฏุง ุจุงุฏ ฺฉ <strong>code-signing certificate</strong> ุงุฒ ฺฉ <strong>Certificate Authority (CA)</strong> ุฏุฑุงูุช ฺฉูุฏ. ุณูพุณ ูโุชูุงูุฏ ฺฏูุงู ุฑุง ุจูโุตูุฑุช ูุงู ุฑูุฒุฏุงุฑ ุงุณุชูุงุฏู ฺฉูุฏ ุง ุขู ุฑุง ุฏุฑ <strong>certificate store</strong> ฺฉุงููพูุชุฑ ุจุงุฑฺฏุฐุงุฑ ฺฉูุฏ.</p>
<p>ูุฒุช ุจุงุฑฺฏุฐุงุฑ ุฏุฑ <strong>certificate store</strong> ุงู ุงุณุช ฺฉู ูโุชูุงูุฏ ุจุฏูู ูุงุฑุฏ ฺฉุฑุฏู ุฑูุฒ ุงูุถุง ฺฉูุฏุ ฺฉู ุจุฑุง ุงุณฺฉุฑูพุชโูุง ุฎูุฏฺฉุงุฑ ู ูุงูโูุง batch ุงููโุชุฑ ุงุณุช.</p>
<h4>ฒ. ูุญู ุฏุฑุงูุช ฺฏูุงูโูุงูู</h4>
<p>ุชุนุฏุงุฏ ฺฉู <strong>CA</strong> ุจุฑุง <strong>code-signing</strong> ุจูโุตูุฑุช ูพุดโูุฑุถ ุฏุฑ ููุฏูุฒ ูุฌูุฏ ุฏุงุฑูุฏุ ูุงููุฏ:</p>
<ul>
<li>Comodo</li>
<li>GoDaddy</li>
<li>GlobalSign</li>
<li>DigiCert</li>
<li>Thawte</li>
<li>Symantec</li>
</ul>
<p>ููฺูู ูุฑูุดูุฏฺฏุงู ูุงููุฏ K Software ูุฌูุฏ ุฏุงุฑูุฏ ฺฉู ฺฏูุงูโูุง code-signing ุงู CAูุง ุฑุง ุจุง ุชุฎูู ุงุฑุงุฆู ูโุฏููุฏ.</p>
<p>ฺฏูุงูโูุง Authenticode ุงุฒ ุงู ูุฑูุดูุฏฺฏุงู ูุนูููุงู ฺฉูุชุฑ ูุญุฏูุฏฺฉููุฏู ูุณุชูุฏ ู ุจุฑูุงููโูุง ุบุฑ ูุงฺฉุฑูุณุงูุช ุฑุง ูุฒ ุงูุถุง ูโฺฉููุฏ. ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ฺฏูุงู SSL ูุนูููุงู ุจุฑุง Authenticode ูุงุจู ุงุณุชูุงุฏู ูุณุชุ ุฒุฑุง SSL ูุงูฺฉุช ุฏุงููู ุฑุง ุงุซุจุงุช ูโฺฉูุฏุ ุงูุง Authenticode ููุช ูุงุดุฑ ุฑุง.</p>
<p>ุจุฑุง ุจุงุฑฺฏุฐุงุฑ ฺฏูุงู ุฏุฑ <strong>certificate store</strong>:</p>
<ol>
<li><strong>Certificate Manager</strong> ุฑุง ุจุงุฒ ฺฉูุฏ</li>
<li>ูพูุดู <strong>Personal</strong> ุฑุง ุจุงุฒ ฺฉูุฏ</li>
<li>ุฑู <strong>Certificates</strong> ุฑุงุณุชโฺฉูฺฉ ู <strong>All Tasks โ Import</strong> ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ</li>
<li>ุจุง <strong>import wizard</strong> ูุฑุงุญู ุฑุง ุฏูุจุงู ฺฉูุฏ</li>
</ol>
<p>ูพุณ ุงุฒ ูุงุฑุฏ ฺฉุฑุฏู ฺฏูุงูุ ุฑู ุขู <strong>View</strong> ฺฉูฺฉ ฺฉูุฏุ ุจู ุชุจ <strong>Details</strong> ุจุฑูุฏ ู <strong>thumbprint</strong> ุขู ุฑุง ฺฉูพ ฺฉูุฏ. ุงู ููุงู ูุด SHA-256 ุงุณุช ฺฉู ุจุฑุง ุงูุถุง ูุงุฒ ุฏุงุฑุฏ.</p>
<blockquote>
<p>โ๏ธ ุงฺฏุฑ ูุตุฏ ุฏุงุฑุฏ ููุฒูุงู <strong>strong-name</strong> ูู ุงุณุชูุงุฏู ฺฉูุฏุ ุงุจุชุฏุง ุจุงุฏ <strong>strong-name-signing</strong> ุงูุฌุงู ุดูุฏุ ุณูพุณ Authenticode. ุงฺฏุฑ ุชุฑุชุจ ุจุฑุนฺฉุณ ุจุงุดุฏุ CLR ุงุถุงูู ุดุฏู strong name ุจุนุฏ ุงุฒ Authenticode ุฑุง ุจูโุนููุงู ุชุบุฑ ุบุฑูุฌุงุฒ ุฏุฑ ูุธุฑ ูโฺฏุฑุฏ.</p>
</blockquote>
<hr>
<h4>ณ. ุงูุถุง ุจุง signtool.exe</h4>
<p>ูโุชูุงูุฏ ุงุฒ ุงุจุฒุงุฑ <strong>signtool</strong> ฺฉู ููุฑุงู Visual Studio ูุตุจ ูโุดูุฏ ุงุณุชูุงุฏู ฺฉูุฏ.</p>
<p>ูุซุงู ุงูุถุง ูุงู <code>LINQPad.exe</code> ุจุง ฺฏูุงู ุฏุฑ <strong>My Store</strong> ุจู ูุงู <code>&quot;Joseph Albahari&quot;</code> ุจุง ุงูฺฏูุฑุชู SHA-256:</p>
<pre class="hljs"><code>signtool sign /n <span class="hljs-string">&quot;Joseph Albahari&quot;</span> /fd sha256 LINQPad.exe
</code></pre>
<p>ููฺูู ูโุชูุงูุฏ ุชูุถุญ ู URL ูุญุตูู ุฑุง ุงุถุงูู ฺฉูุฏ:</p>
<pre class="hljs"><code>... /d LINQPad /du http://www.linqpad.net
</code></pre>
<blockquote>
<p>โ๏ธ ูุนูููุงู ุจุฑุง ุญูุธ ุงุนุชุจุงุฑ ูพุณ ุงุฒ ุงููุถุง ฺฏูุงูุ ุจุงุฏ <strong>time-stamping server</strong> ูู ูุดุฎุต ุดูุฏ.</p>
</blockquote>
<h4>Time Stamping</h4>
<p>ุจุง ุงุณุชูุงุฏู ุงุฒ time-stampingุ ุจุฑูุงููโูุง ฺฉู ูุจู ุงุฒ ุงููุถุง ฺฏูุงู ุงูุถุง ุดุฏูโุงูุฏุ ูููุฒ ูุนุชุจุฑ ุจุงู ูโูุงููุฏ. CA ฺฉ URI ุจุฑุง ุงู ููุธูุฑ ุงุฑุงุฆู ูโุฏูุฏุ ูุงููุฏ:</p>
<pre class="hljs"><code>... /tr http://timestamp.comodoca.com/authenticode /td SHA256
</code></pre>
<h4>ุจุฑุฑุณ ุงูุถุง</h4>
<p>ุณุงุฏูโุชุฑู ุฑูุด ุจุฑุง ูุดุงูุฏู ุงูุถุง Authenticodeุ ูฺฏุงู ฺฉุฑุฏู ุจู <strong>Digital Signatures tab</strong> ุฏุฑ <strong>Windows Explorer</strong> ุงุณุช. ุงุจุฒุงุฑ <strong>signtool</strong> ูุฒ ุงู ุงูฺฉุงู ุฑุง ูุฑุงูู ูโฺฉูุฏ.</p>
<hr>
<h3>๐น ููุงุจุน ู Satellite Assemblies ๐น</h3>
<p>ฺฉ ุจุฑูุงูู ูุนูููุงู ูู ุชููุง ุดุงูู ฺฉุฏ ุงุฌุฑุง ุงุณุชุ ุจูฺฉู ูุญุชูุงูุง ูุงููุฏ ูุชูุ ุชุตูุฑ ุง ูุงู XML ูุฒ ุฏุงุฑุฏ. ุงู ูุญุชูุงูุง ูโุชูุงููุฏ ุฏุฑ ฺฉ ุงุณูุจู ุงุฒ ุทุฑู <strong>resource</strong> ฺฏูุฌุงูุฏู ุดููุฏ.</p>
<p>ุฏู ฺฉุงุฑุจุฑุฏ ุงุตู ุจุฑุง <strong>resources</strong>:</p>
<ul>
<li>ุงูุฒูุฏู ุฏุงุฏูโูุง ฺฉู ููโุชูุงููุฏ ุฏุฑ ฺฉุฏ ููุจุน ุจุงุดูุฏุ ูุงููุฏ ุชุตุงูุฑ</li>
<li>ุฐุฎุฑู ุฏุงุฏูโูุง ฺฉู ููฺฉู ุงุณุช ุฏุฑ ุจุฑูุงููโูุง ฺูุฏุฒุจุงูู ูุงุฒ ุจู ุชุฑุฌูู ุฏุงุดุชู ุจุงุดูุฏ</li>
</ul>
<p>ฺฉ <strong>assembly resource</strong> ุฏุฑ ููุงุช ฺฉ <strong>byte stream</strong> ุจุง ูุงู ูุดุฎุต ุงุณุช. ูโุชูุงู ฺฉ ุงุณูุจู ุฑุง ูุงููุฏ ฺฉ ุฏฺฉุดูุฑ ุงุฒ <strong>byte arrays</strong> ุฏุฑ ูุธุฑ ฺฏุฑูุช ฺฉู ฺฉูุฏูุง ุขู ุฑุดุชู ูุณุชูุฏ.</p>
<p>ูุซุงู ุฏุฑ <strong>ildasm</strong> ุงุฒ ุงุณูุจู ฺฉู ุฏู resource ุจู ูุงูโูุง <code>banner.jpg</code> ู <code>data.xml</code> ุฏุงุฑุฏ:</p>
<pre class="hljs"><code>.mresource public banner.jpg
{
  // Offset: 0x00000F58 Length: 0x000004F6
}
.mresource public data.xml
{
  // Offset: 0x00001458 Length: 0x0000027E
}
</code></pre>
<p>ุฏุฑ ุงู ูุซุงูุ <code>banner.jpg</code> ู <code>data.xml</code> ูุณุชููุงู ุจู ุงุณูุจู ุงุถุงูู ุดุฏูโุงูุฏุ ูุฑ ฺฉุฏุงู ุจูโุนููุงู <strong>embedded resource</strong> ุฎูุฏ. ุงู ุณุงุฏูโุชุฑู ุฑูุด ุจุฑุง ฺฉุงุฑ ุจุง ููุงุจุน ุงุณุช.</p>
<hr>
<p><strong>.NET</strong> ููฺูู ุงุฌุงุฒู ูโุฏูุฏ ูุญุชูุง ุฑุง ุงุฒ ุทุฑู ฺฉุงูุชูุฑูุง ูุงู <code>.resources</code> ุงุถุงูู ฺฉูุฏ. ุงู ฺฉุงูุชูุฑูุง ุจุฑุง ูุญุชูุง ุทุฑุงุญ ุดุฏูโุงูุฏ ฺฉู ููฺฉู ุงุณุช ูุงุฒ ุจู ุชุฑุฌูู ุฏุฑ ุฒุจุงูโูุง ูุฎุชูู ุฏุงุดุชู ุจุงุดูุฏ.</p>
<p><strong>Localized .resources</strong> ูโุชูุงููุฏ ุจูโุตูุฑุช <strong>satellite assembly</strong> ุฌุฏุงฺฏุงูู ุจุณุชูโุจูุฏ ุดููุฏ ู ุฏุฑ ุฒูุงู ุงุฌุฑุง ุจุฑ ุงุณุงุณ ุฒุจุงู ุณุณุชู ฺฉุงุฑุจุฑ ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ุงูุชุฎุงุจ ุดููุฏ.</p>
<p>๐ ุดฺฉู 17-2 ฺฉ ุงุณูุจู ุฑุง ูุดุงู ูโุฏูุฏ ฺฉู ุฏู <strong>resource</strong> ูุณุชููุงู ุฌุงุณุงุฒโุดุฏู ู ฺฉ ฺฉุงูุชูุฑ <code>.resources</code> ุจู ูุงู <code>welcome.resources</code> ุฏุงุฑุฏ ฺฉู ุจุฑุง ุขู ุฏู <strong>satellite assembly</strong> ูุญูโุณุงุฒ ุดุฏู ุงุฌุงุฏ ุดุฏู ุงุณุช.</p>
<div align="center">
<p><img src="../../../assets/image/17/Table-17-3.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>๐น ุฌุงุณุงุฒ ูุณุชูู ููุงุจุน ๐น</h3>
<p>ุฌุงุณุงุฒ <strong>resources</strong> ุฏุฑ ุฏุงุฎู ุงุณูุจูโูุง ุฏุฑ ุจุฑูุงููโูุง <strong>Windows Store</strong> ูพุดุชุจุงู ููโุดูุฏ. ุจู ุฌุง ุขูุ ูุงูโูุง ุงุถุงู ุฑุง ุจู <strong>deployment package</strong> ุงุถุงูู ฺฉุฑุฏู ู ุงุฒ ุทุฑู <strong>StorageFolder</strong> ุจุฑูุงูู ุฎูุฏ (<strong>Package.Current.InstalledLocation</strong>) ุจู ุขูโูุง ุฏุณุชุฑุณ ูพุฏุง ฺฉูุฏ.</p>
<h4>ูุญูู ุฌุงุณุงุฒ ูุณุชูู ููุงุจุน ุจุง Visual Studio</h4>
<ol>
<li>ูุงู ุฑุง ุจู ูพุฑูฺู ุงุถุงูู ฺฉูุฏ.</li>
<li><strong>Build Action</strong> ุขู ุฑุง ุฑู <strong>Embedded Resource</strong> ุชูุธู ฺฉูุฏ.</li>
</ol>
<p>Visual Studio ููุดู ูุงู ููุงุจุน ุฑุง ุจุง <strong>namespace ูพุดโูุฑุถ ูพุฑูฺู</strong> ู ููฺูู ูุงู ูุฑ <strong>ุฒุฑูพูุดู</strong> ฺฉู ูุงู ุฏุฑ ุขู ูุฑุงุฑ ุฏุงุฑุฏุ ูพุดููุฏ ูโฺฉูุฏ.<br>
ูุซูุงู ุงฺฏุฑ namespace ูพุดโูุฑุถ ูพุฑูฺู <code>Westwind.Reports</code> ุจุงุดุฏ ู ูุงู <code>banner.jpg</code> ุฏุฑ ูพูุดู <code>pictures</code> ุจุงุดุฏุ ูุงู resource ุจู ุดฺฉู ุฒุฑ ุฎูุงูุฏ ุจูุฏ:</p>
<pre class="hljs"><code>Westwind.Reports.pictures.banner.jpg
</code></pre>
<blockquote>
<p>โ๏ธ ูุงู ููุงุจุน <strong>ุญุณุงุณ ุจู ุญุฑูู ุจุฒุฑฺฏ ู ฺฉูฺฺฉ</strong> ุงุณุชุ ุจูุงุจุฑุงู ูุงู ูพูุดูโูุง ูพุฑูฺู ฺฉู ุดุงูู ููุงุจุน ูุณุชูุฏุ ุจูโุทูุฑ ูุคุซุฑ ุญุณุงุณ ุจู ุญุฑูู ุฎูุงููุฏ ุจูุฏ.</p>
</blockquote>
<hr>
<h4>ุฏุณุชุฑุณ ุจู ููุงุจุน</h4>
<p>ุจุฑุง ุฏุณุชุฑุณ ุจู ฺฉ resourceุ ูุชุฏ <strong>GetManifestResourceStream</strong> ุฑู ุงุณูุจู ุญุงู ุขู ุฑุง ุตุฏุง ุจุฒูุฏ. ุงู ูุชุฏ ฺฉ <strong>Stream</strong> ุจุฑูโฺฏุฑุฏุงูุฏ ฺฉู ูโุชูุงูุฏ ูุงููุฏ ูุฑ Stream ุฏฺฏุฑ ุขู ุฑุง ุจุฎูุงูุฏ:</p>
<pre class="hljs"><code>Assembly a = Assembly.GetEntryAssembly();
<span class="hljs-keyword">using</span> (Stream s = a.GetManifestResourceStream(<span class="hljs-string">&quot;TestProject.data.xml&quot;</span>))
<span class="hljs-keyword">using</span> (XmlReader r = XmlReader.Create(s))
{
    ...
}
</code></pre>
<p>ูุซุงู ุฏฺฏุฑ ุจุฑุง ุชุตูุฑ:</p>
<pre class="hljs"><code>System.Drawing.Image image;
<span class="hljs-keyword">using</span> (Stream s = a.GetManifestResourceStream(<span class="hljs-string">&quot;TestProject.banner.jpg&quot;</span>))
    image = System.Drawing.Image.FromStream(s);
</code></pre>
<p>Stream ุจุงุฒฺฏุดุช ูุงุจู <strong>seek</strong> ุงุณุชุ ุจูุงุจุฑุงู ูโุชูุงูุฏ ุจู ุดฺฉู ุฒุฑ ูุฒ ุฏุงุฏูโูุง ุฑุง ุจุฎูุงูุฏ:</p>
<pre class="hljs"><code><span class="hljs-built_in">byte</span>[] data;
<span class="hljs-keyword">using</span> (Stream s = a.GetManifestResourceStream(<span class="hljs-string">&quot;TestProject.banner.jpg&quot;</span>))
    data = <span class="hljs-keyword">new</span> BinaryReader(s).ReadBytes((<span class="hljs-built_in">int</span>)s.Length);
</code></pre>
<blockquote>
<p>โ๏ธ ุงฺฏุฑ ุงุฒ Visual Studio ุจุฑุง ุฌุงุณุงุฒ resource ุงุณุชูุงุฏู ฺฉุฑุฏูโุงุฏุ ูุฑุงููุด ูฺฉูุฏ ูพุดููุฏ namespace ุฑุง ูุญุงุธ ฺฉูุฏ.<br>
ุจุฑุง ฺฉุงูุด ุฎุทุงุ ูโุชูุงูุฏ ูพุดููุฏ ุฑุง ุจุง ฺฉ ููุน ูุดุฎุต ฺฉูุฏ:</p>
</blockquote>
<pre class="hljs"><code><span class="hljs-keyword">using</span> (Stream s = a.GetManifestResourceStream(<span class="hljs-keyword">typeof</span>(X), <span class="hljs-string">&quot;data.xml&quot;</span>))
</code></pre>
<p><code>X</code> ูโุชูุงูุฏ ูุฑ ููุน ุจุงุดุฏ ฺฉู ุฏุงุฑุง namespace ููุฑุฏูุธุฑ ุดูุง ุงุณุช (ูุนูููุงู ููุน ุฏุฑ ููุงู ูพูุดู ูพุฑูฺู).</p>
<hr>
<h4>ุชูุงูุช ุจุง Resource ุฏุฑ WPF</h4>
<p>ุชูุธู <strong>Build Action</strong> ฺฉ ุขุชู ูพุฑูฺู ุจู <strong>Resource</strong> ุฏุฑ ุจุฑูุงูู WPF ุจุง <strong>Embedded Resource</strong> ูุชูุงูุช ุงุณุช.</p>
<ul>
<li><strong>Resource</strong> ุฏุฑ WPF ุขุชู ุฑุง ุจู ฺฉ ูุงู <code>.resources</code> ุจู ูุงู <code>&lt;AssemblyName&gt;.g.resources</code> ุงุถุงูู ูโฺฉูุฏ.</li>
<li>ูุญุชูุง ุขู ุงุฒ ุทุฑู ฺฉูุงุณ <strong>Application</strong> ู ุจุง ุงุณุชูุงุฏู ุงุฒ URI ุฏุณุชุฑุณ ูพุฏุง ูโฺฉูุฏ.</li>
</ul>
<p>ููฺูู WPF ุงุตุทูุงุญ <strong>resource</strong> ุฑุง ุจู ุฑูุดโูุง ุฏฺฏุฑ ูุฒ ุจู ฺฉุงุฑ ูโุจุฑุฏ:</p>
<ul>
<li><strong>Static resources</strong></li>
<li><strong>Dynamic resources</strong></li>
</ul>
<p>ุงูโูุง ุงุฑุชุจุงุท ุจุง ููุงุจุน ุงุณูุจู ูุฏุงุฑูุฏ!</p>
<p>ุจุฑุง ุฏุฑุงูุช ูุงู ููู ููุงุจุน ุฏุฑ ฺฉ ุงุณูุจูุ ูโุชูุงู ุงุฒ ูุชุฏ <strong>GetManifestResourceNames</strong> ุงุณุชูุงุฏู ฺฉุฑุฏ.</p>
<hr>
<h3>๐น ูุงูโูุง .resources ๐น</h3>
<p>ูุงูโูุง <code>.resources</code> ฺฉุงูุชูุฑูุง ุจุฑุง ูุญุชูุง ูุงุจู ูุญูโุณุงุฒ ูุณุชูุฏ. ุงู ูุงูโูุง ุฏุฑ ููุงุช ุจูโุนููุงู ฺฉ <strong>embedded resource</strong> ุฏุงุฎู ุงุณูุจู ูุฑุงุฑ ูโฺฏุฑูุฏุ ุฏุฑุณุช ูุงููุฏ ุณุงุฑ ูุงูโูุง. ุชูุงูุช ุขูโูุง:</p>
<ol>
<li>ุงุจุชุฏุง ูุญุชูุง ุฎูุฏ ุฑุง ุฏุฑ ูุงู <code>.resources</code> ุจุณุชูโุจูุฏ ูโฺฉูุฏ.</li>
<li>ุจุฑุง ุฏุณุชุฑุณ ุจู ูุญุชูุง ุงุฒ <strong>ResourceManager</strong> ุง <strong>pack URI</strong> ุงุณุชูุงุฏู ูโฺฉูุฏุ ูู ุงุฒ <strong>GetManifestResourceStream</strong>.</li>
</ol>
<p>ูุงูโูุง <code>.resources</code> ุจู ุตูุฑุช <strong>binary</strong> ูุณุชูุฏ ู ูุงุจู ูุฑุงุด ูุณุชูู ุชูุณุท ุงูุณุงู ูุณุชูุฏุ ุจูุงุจุฑุงู ุจุงุฏ ุงุฒ ุงุจุฒุงุฑูุง .NET ู Visual Studio ุงุณุชูุงุฏู ฺฉูุฏ.</p>
<h4>.resx Files</h4>
<p>ูุงูโูุง <code>.resx</code> ูุฑูุช ุฏุฑ ุฒูุงู ุทุฑุงุญ ูุณุชูุฏ ฺฉู ุจุฑุง ุชููุฏ <code>.resources</code> ุงุณุชูุงุฏู ูโุดููุฏ. ุงู ูุงูโูุง ุจุง XML ุณุงุฎุชู ูโุดููุฏ ู ุณุงุฎุชุงุฑ ุขูโูุง ุจู ุตูุฑุช <strong>name/value pairs</strong> ุงุณุช:</p>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">root</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">data</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;Greeting&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>hello<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">data</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">data</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;DefaultFontSize&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;System.Int32, mscorlib&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>10<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">data</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">root</span>&gt;</span>
</code></pre>
<p>ุฏุฑ Visual Studio ุจุฑุง ุงุฌุงุฏ <code>.resx</code>:</p>
<ol>
<li>
<p>ฺฉ <strong>project item</strong> ุงุฒ ููุน <strong>Resources File</strong> ุงุถุงูู ฺฉูุฏ.</p>
</li>
<li>
<p>Visual Studio ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ:</p>
<ul>
<li>ูุฏุฑ ุตุญุญ ุฑุง ุงุฌุงุฏ ูโฺฉูุฏ.</li>
<li><strong>designer</strong> ุจุฑุง ุงุถุงูู ฺฉุฑุฏู ุฑุดุชูโูุงุ ุชุตุงูุฑ ู ูุงูโูุง ุงุฑุงุฆู ูโุฏูุฏ.</li>
<li>ูุงู <code>.resx</code> ุฑุง ุจู <code>.resources</code> ุชุจุฏู ู ุฏุฑ ุงุณูุจู ุฌุงุณุงุฒ ูโฺฉูุฏ.</li>
<li>ฺฉูุงุณ ุจุฑุง ุฏุณุชุฑุณ ุจู ุฏุงุฏูโูุง ุชููุฏ ูโฺฉูุฏ.</li>
</ul>
</li>
</ol>
<blockquote>
<p>โ๏ธ designer ููุงุจุน ุชุตูุฑ ุฑุง ุจูโุตูุฑุช typed <strong>Image objects</strong> (System.Drawing.dll) ุงุถุงูู ูโฺฉูุฏ ฺฉู ุจุฑุง WPF ููุงุณุจ ูุณุชูุฏ.</p>
</blockquote>
<hr>
<h4>ุฎูุงูุฏู ูุงูโูุง .resources</h4>
<p>ฺฉูุงุณ ุจุง ููุงู ูุงู <code>.resx</code> ุชููุฏ ูโุดูุฏ ู ุฏุงุฑุง <strong>properties</strong> ุจุฑุง ุฏุณุชุฑุณ ุจู ูุฑ ุขุชู ุงุณุช.</p>
<p><strong>ResourceManager</strong> ุจุฑุง ุฎูุงูุฏู ูุงูโูุง <code>.resources</code> ุฌุงุณุงุฒโุดุฏู ุฏุฑ ุงุณูุจู ุงุณุชูุงุฏู ูโุดูุฏ:</p>
<pre class="hljs"><code>ResourceManager r = <span class="hljs-keyword">new</span> ResourceManager(<span class="hljs-string">&quot;welcome&quot;</span>,
                                        Assembly.GetExecutingAssembly());
</code></pre>
<blockquote>
<p>โ๏ธ ุงฺฏุฑ resource ุฏุฑ Visual Studio ฺฉุงููพุงู ุดุฏูุ ุขุฑฺฏููุงู ุงูู ุจุงุฏ <strong>namespace-prefixed</strong> ุจุงุดุฏ.</p>
</blockquote>
<p>ุฏุณุชุฑุณ ุจู ูุญุชูุง:</p>
<pre class="hljs"><code><span class="hljs-built_in">string</span> greeting = r.GetString(<span class="hljs-string">&quot;Greeting&quot;</span>);
<span class="hljs-built_in">int</span> fontSize = (<span class="hljs-built_in">int</span>) r.GetObject(<span class="hljs-string">&quot;DefaultFontSize&quot;</span>);
Image image = (Image) r.GetObject(<span class="hljs-string">&quot;flag.png&quot;</span>);
</code></pre>
<p>ุจุฑุง ููุฑุณุช ฺฉุฑุฏู ูุญุชูุงุช ฺฉ ูุงู <code>.resources</code>:</p>
<pre class="hljs"><code>ResourceManager r = <span class="hljs-keyword">new</span> ResourceManager(...);
ResourceSet <span class="hljs-keyword">set</span> = r.GetResourceSet(CultureInfo.CurrentUICulture, <span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>);
<span class="hljs-keyword">foreach</span> (System.Collections.DictionaryEntry entry <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span>)
    Console.WriteLine(entry.Key);
</code></pre>
<hr>
<h3>๐น ุงุฌุงุฏ resource ุจุง pack URI ุฏุฑ Visual Studio ๐น</h3>
<p>ุฏุฑ ุจุฑูุงููโูุง WPFุ ูุงูโูุง XAML ุจุงุฏ ุจุชูุงููุฏ ููุงุจุน ุฑุง ุงุฒ ุทุฑู URI ุจุฎูุงููุฏุ ูุงููุฏ:</p>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">Button</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Image</span> <span class="hljs-attr">Height</span>=<span class="hljs-string">&quot;50&quot;</span> <span class="hljs-attr">Source</span>=<span class="hljs-string">&quot;flag.png&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
</code></pre>
<p>ุง ุงฺฏุฑ resource ุฏุฑ ุงุณูุจู ุฏฺฏุฑ ุจุงุดุฏ:</p>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">Button</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Image</span> <span class="hljs-attr">Height</span>=<span class="hljs-string">&quot;50&quot;</span> <span class="hljs-attr">Source</span>=<span class="hljs-string">&quot;UtilsAssembly;Component/flag.png&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
</code></pre>
<blockquote>
<p>โ๏ธ ฺฉููู <strong>Component</strong> ฺฉูุฏูุงฺู ุซุงุจุช ุงุณุช.</p>
</blockquote>
<p>ุจุฑุง ุงุฌุงุฏ ฺูู ููุงุจุน ููโุชูุงู ุงุฒ ูุงูโูุง <code>.resx</code> ุงุณุชูุงุฏู ฺฉุฑุฏ. ุจุงุฏ ูุงูโูุง ุฑุง ุจู ูพุฑูฺู ุงุถุงูู ฺฉุฑุฏู ู <strong>Build Action</strong> ุฑุง ุฑู <strong>Resource</strong> ูุฑุงุฑ ุฏูุฏ (ูู Embedded Resource).<br>
Visual Studio ุณูพุณ ุขูโูุง ุฑุง ุจู ูุงู <code>.resources</code> ุจู ูุงู <code>&lt;AssemblyName&gt;.g.resources</code> ุชุจุฏู ูโฺฉูุฏ ู ููฺูู ูุงูโูุง XAML ฺฉุงููพุงูโุดุฏู (.baml) ูุฒ ุฏุฑ ููุงูุฌุง ูุฑุงุฑ ูโฺฏุฑูุฏ.</p>
<p>ุจุฑุง ุจุงุฑฺฏุฐุงุฑ ููุงุจุน ุจุง <strong>URI-key</strong> ุจูโุตูุฑุช ุจุฑูุงููโููุณ:</p>
<pre class="hljs"><code>Uri u = <span class="hljs-keyword">new</span> Uri(<span class="hljs-string">&quot;flag.png&quot;</span>, UriKind.Relative);
<span class="hljs-keyword">using</span> (Stream s = Application.GetResourceStream(u).Stream)
{
    ...
}
</code></pre>
<p>ููฺูู ูโุชูุงู ุงุฒ <strong>absolute URI</strong> ุจู ุดฺฉู ุฒุฑ ุงุณุชูุงุฏู ฺฉุฑุฏ:</p>
<pre class="hljs"><code>Uri u = <span class="hljs-keyword">new</span> Uri(<span class="hljs-string">&quot;pack://application:,,,/flag.png&quot;</span>);
</code></pre>
<p>ุงฺฏุฑ ุจุฎูุงูุฏ <strong>Assembly object</strong> ูุดุฎุต ฺฉูุฏุ ูโุชูุงูุฏ ุงุฒ <strong>ResourceManager</strong> ุงุณุชูุงุฏู ฺฉูุฏ:</p>
<pre class="hljs"><code>Assembly a = Assembly.GetExecutingAssembly();
ResourceManager r = <span class="hljs-keyword">new</span> ResourceManager(a.GetName().Name + <span class="hljs-string">&quot;.g&quot;</span>, a);
<span class="hljs-keyword">using</span> (Stream s = r.GetStream(<span class="hljs-string">&quot;flag.png&quot;</span>))
{
    ...
}
</code></pre>
<p><strong>ResourceManager</strong> ููฺูู ุงุฌุงุฒู ูโุฏูุฏ ูุญุชูุง ฺฉ ฺฉุงูุชูุฑ <code>.g.resources</code> ุฏุงุฎู ฺฉ ุงุณูุจู ุฑุง ููุฑุณุช ฺฉูุฏ.</p>
<h3>๐ ุงุณูุจูโูุง ูุงููุงุฑูโุง (Satellite Assemblies) ๐</h3>
<p>ุฏุงุฏูโูุง ุฌุงุณุงุฒโุดุฏู ุฏุฑ ูุงูโูุง <code>.resources</code> <strong>ูุงุจูุช ูุญูโุณุงุฒ (localizable)</strong> ุฏุงุฑูุฏ.<br>
ูุญูโุณุงุฒ ููุงุจุน ุฒูุงู ุงููุช ุฏุงุฑุฏ ฺฉู ุจุฑูุงูู ุดูุง ุฑู ูุณุฎูโุง ุงุฒ ููุฏูุฒ ุงุฌุฑุง ุดูุฏ ฺฉู ุชูุงู ูุญุท ุขู ุจู ุฒุจุงู ุฏฺฏุฑ ููุงุด ุฏุงุฏู ูโุดูุฏ. ุจุฑุง ฺฉูพุงุฑฺฺฏุ ุจุฑูุงูู ุดูุง ูุฒ ุจุงุฏ ุงุฒ ููุงู ุฒุจุงู ุงุณุชูุงุฏู ฺฉูุฏ.</p>
<h4>ุณุงุฎุชุงุฑ ูุนููู</h4>
<ul>
<li><strong>Main assembly</strong> ุดุงูู ููุงุจุน <code>.resources</code> ุจุฑุง ุฒุจุงู ูพุดโูุฑุถ ุง <strong>fallback</strong> ุงุณุช.</li>
<li><strong>Satellite assemblies</strong> ุฌุฏุงฺฏุงูู ุดุงูู ููุงุจุน ูุญูโุดุฏู ุจุฑุง ุฒุจุงูโูุง ูุฎุชูู ูุณุชูุฏ.</li>
</ul>
<p>ุฒูุงู ฺฉู ุจุฑูุงูู ุงุฌุฑุง ูโุดูุฏุ .NET ุฒุจุงู ูุนู ุณุณุชู ุนุงูู ุฑุง ุงุฒ <code>CultureInfo.CurrentUICulture</code> ุจุฑุฑุณ ูโฺฉูุฏ. ูุฑฺฏุงู ุจุฎูุงูุฏ ฺฉ resource ุฑุง ุงุฒ ุทุฑู <strong>ResourceManager</strong> ุจุฎูุงูุฏุ runtime ุจู ุฏูุจุงู ฺฉ <strong>satellite assembly</strong> ูุญูโุดุฏู ูโฺฏุฑุฏุฏ. ุงฺฏุฑ ููุฌูุฏ ุจุงุดุฏ ู ุดุงูู ฺฉูุฏ resource ููุฑุฏ ูุธุฑ ุดูุง ุจุงุดุฏุ ุฌุงฺฏุฒู ูุณุฎู main assembly ูโุดูุฏ.</p>
<blockquote>
<p>ุงู ุนู ูโุชูุงูุฏ ูพุดุชุจุงู ุงุฒ ุฒุจุงูโูุง ุฌุฏุฏ ุฑุง ุชููุง ุจุง ุงุถุงูู ฺฉุฑุฏู satellite ุฌุฏุฏ ูุฑุงูู ฺฉูุฏุ ุจุฏูู ุงูฺฉู main assembly ุชุบุฑ ฺฉูุฏ.</p>
</blockquote>
<blockquote>
<p>โ๏ธ ฺฉ satellite assembly ููโุชูุงูุฏ ุดุงูู ฺฉุฏ ุงุฌุฑุง ุจุงุดุฏุ ุชููุง ููุงุจุน ุฑุง ูโุชูุงูุฏ ูฺฏู ุฏุงุฑุฏ.</p>
</blockquote>
<hr>
<h4>ูุณุฑูุง ุงุณุชูุฑุงุฑ Satellite Assemblies</h4>
<p>Satellite assemblies ุฏุฑ ุฒุฑูพูุดูโูุง ูููุฏุฑ ุงุณูุจู ูุฑุงุฑ ูโฺฏุฑูุฏ:</p>
<pre class="hljs"><code>programBaseFolder\MyProgram.exe
                 \MyLibrary.exe
                 \XX\MyProgram.resources.dll
                 \XX\MyLibrary.resources.dll
</code></pre>
<p><code>XX</code> ุจู ฺฉุฏ ุฏู ุญุฑู ุฒุจุงู ุงุดุงุฑู ุฏุงุฑุฏ (ูุซูุงู <code>de</code> ุจุฑุง ุขููุงู) ุง ุชุฑฺฉุจ ุงุฒ ุฒุจุงู ู ููุทูู (ูุซู <code>en-GB</code> ุจุฑุง ุงูฺฏูุณ ุฏุฑ ุจุฑุชุงูุง).<br>
ุงู ุณุณุชู ูุงูฺฏุฐุงุฑ ุจู CLR ุงุฌุงุฒู ูโุฏูุฏ ุชุง ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ satellite assembly ููุงุณุจ ุฑุง ูพุฏุง ู ุจุงุฑฺฏุฐุงุฑ ฺฉูุฏ.</p>
<hr>
<h4>ุณุงุฎุช Satellite Assemblies</h4>
<p>ูุฑุถ ฺฉูุฏ ูุซุงู ูุจู ูุง ุจุง <code>.resx</code> ุดุงูู ุงู ุจูุฏ:</p>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">root</span>&gt;</span>
  ...
  <span class="hljs-tag">&lt;<span class="hljs-name">data</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;Greeting&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>hello<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">data</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">root</span>&gt;</span>
</code></pre>
<p>ู ุฏุฑ ุฒูุงู ุงุฌุฑุง ุขู ุฑุง ุจู ุดฺฉู ุฒุฑ ุฎูุงูุฏู:</p>
<pre class="hljs"><code>ResourceManager r = <span class="hljs-keyword">new</span> ResourceManager(<span class="hljs-string">&quot;welcome&quot;</span>,
                                        Assembly.GetExecutingAssembly());
Console.Write(r.GetString(<span class="hljs-string">&quot;Greeting&quot;</span>));
</code></pre>
<p>ุญุงู ูุฑุถ ฺฉูุฏ ูโุฎูุงูู ููุช ุจุฑูุงูู ุฑู ูุณุฎู ุขููุงู ููุฏูุฒ ุงุฌุฑุง ุดุฏุ <code>hello</code> ุจู <code>hallo</code> ุชุจุฏู ุดูุฏ.<br>
ุงุจุชุฏุง ฺฉ ูุงู <code>.resx</code> ุฏฺฏุฑ ุจู ูุงู <code>welcome.de.resx</code> ุงุฌุงุฏ ูโฺฉูู ฺฉู ููุฏุงุฑ ุฑุง ุฌุงฺฏุฒู ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">root</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">data</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;Greeting&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>hallo<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">data</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">root</span>&gt;</span>
</code></pre>
<p>ุฏุฑ <strong>Visual Studio</strong> ุชููุง ฺฉุงู ุงุณุช ุงู ฺฉุงุฑ ุฑุง ุงูุฌุงู ุฏูุฏ. ููฺฏุงู <strong>rebuild</strong>ุ ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ฺฉ <strong>satellite assembly</strong> ุจู ูุงู <code>MyApp.resources.dll</code> ุฏุฑ ฺฉ ุฒุฑูพูุดู <code>de</code> ุณุงุฎุชู ูโุดูุฏ.</p>
<hr>
<h4>ุชุณุช Satellite Assemblies</h4>
<p>ุจุฑุง ุดุจูโุณุงุฒ ุงุฌุฑุง ุจุฑูุงูู ุฑู ุณุณุชูโุนุงูู ุจุง ุฒุจุงู ูุชูุงูุชุ ุจุงุฏ <strong>CurrentUICulture</strong> ุฑุง ุจุง ฺฉูุงุณ <code>Thread</code> ุชุบุฑ ุฏูุฏ:</p>
<pre class="hljs"><code>System.Threading.Thread.CurrentThread.CurrentUICulture
    = <span class="hljs-keyword">new</span> System.Globalization.CultureInfo(<span class="hljs-string">&quot;de&quot;</span>);
</code></pre>
<blockquote>
<p>โ๏ธ <code>CultureInfo.CurrentUICulture</code> ูุณุฎู ููุทโุฎูุงูุฏู ููู property ุงุณุช.</p>
</blockquote>
<p>ฺฉ ุงุณุชุฑุงุชฺ ููุฏ ุจุฑุง ุชุณุช ุงู ุงุณุช ฺฉู ฺฉููุงุช ุฑุง <strong>โัปยขฮฑโรฏสษ</strong> ฺฉูุฏุ ุนู ุจู ุดฺฉู ฺฉู ูููุฒ ุจู ุงูฺฏูุณ ูุงุจู ุฎูุงูุฏู ุจุงุดูุฏุ ุงูุง ุงุฒ ฺฉุงุฑุงฺฉุชุฑูุง ุงุณุชุงูุฏุงุฑุฏ ุฑูู ุงุณุชูุงุฏู ูฺฉููุฏ.</p>
<hr>
<h4>ูพุดุชุจุงู ุทุฑุงุญ Visual Studio</h4>
<p>ุทุฑุงุญโูุง Visual Studio ุงูฺฉุงู ูุญูโุณุงุฒ ฺฉุงููพูููุชโูุง ู ุนูุงุตุฑ ุจุตุฑ ุฑุง ูุฑุงูู ูโฺฉููุฏ:</p>
<ul>
<li><strong>WPF designer</strong> ฺฉ workflow ูุฎุตูุต ุจุฑุง localization ุฏุงุฑุฏ.</li>
<li>ุณุงุฑ designers ูุจุชู ุจุฑ Component ุงุฒ ฺฉ property ุฏุฑ ุฒูุงู ุทุฑุงุญ ุงุณุชูุงุฏู ูโฺฉููุฏ ุชุง ุดุจู <strong>Language property</strong> ููุงุด ุฏุงุฏู ุดูุฏ.</li>
<li>ุจุฑุง ูุญูโุณุงุฒุ ฺฉุงู ุงุณุช <strong>Language property</strong> ุฑุง ุชุบุฑ ุฏุงุฏู ู ุณูพุณ ุดุฑูุน ุจู ุชุบุฑ ฺฉุงููพูููุช ฺฉูุฏ.</li>
<li>ุชูุงู propertyูุง ฺฉูุชุฑู ฺฉู ุฏุงุฑุง ุตูุช <strong>Localizable</strong> ูุณุชูุฏุ ุฏุฑ ูุงู <code>.resx</code> ูุฑุจูุท ุจู ุขู ุฒุจุงู ุฐุฎุฑู ูโุดููุฏ.</li>
<li>ูโุชูุงูุฏ ุฏุฑ ูุฑ ุฒูุงู ุจู ุฒุจุงูโูุง ุฌุงุจุฌุง ุดูุฏ ููุท ุจุง ุชุบุฑ Language property.</li>
</ul>
<hr>
<h4>ูุฑููฺฏโูุง ู ุฒุฑูุฑููฺฏโูุง (Cultures and Subcultures)</h4>
<ul>
<li><strong>Culture</strong> ฺฉ ุฒุจุงู ูุดุฎุต ุฑุง ูุดุงู ูโุฏูุฏ.</li>
<li><strong>Subculture</strong> ฺฉ ูุณุฎู ููุทููโุง ุงุฒ ููุงู ุฒุจุงู ุงุณุช.</li>
<li>.NET ูุทุงุจู ุงุณุชุงูุฏุงุฑุฏ <strong>RFC1766</strong> ุงุฒ ฺฉุฏูุง ุฏู ุญุฑู ุจุฑุง ูุฑููฺฏโูุง ู ุฒุฑูุฑููฺฏโูุง ุงุณุชูุงุฏู ูโฺฉูุฏ:</li>
</ul>
<p><strong>ูุซุงู ฺฉุฏ ูุฑููฺฏโูุง:</strong></p>
<pre class="hljs"><code>En  โ ุงูฺฏูุณ
de  โ ุขููุงู
</code></pre>
<p><strong>ูุซุงู ฺฉุฏ ุฒุฑูุฑููฺฏโูุง:</strong></p>
<pre class="hljs"><code>en-AU  โ ุงูฺฏูุณ ุงุณุชุฑุงูุง
de-AT  โ ุขููุงู ุงุชุฑุด
</code></pre>
<ul>
<li>ูุฑููฺฏโูุง ุฏุฑ .NET ุจุง ฺฉูุงุณ <code>System.Globalization.CultureInfo</code> ููุงุด ุฏุงุฏู ูโุดููุฏ.</li>
<li>ุจุฑุฑุณ ูุฑููฺฏ ูุนู ุจุฑูุงูู:</li>
</ul>
<pre class="hljs"><code>Console.WriteLine(System.Threading.Thread.CurrentThread.CurrentCulture);
Console.WriteLine(System.Threading.Thread.CurrentThread.CurrentUICulture);
</code></pre>
<p>ูุซุงู ุจุฑุง ุณุณุชู ูุญูโุณุงุฒโุดุฏู ุจุฑุง ุงุณุชุฑุงูุง:</p>
<pre class="hljs"><code>CurrentCulture      โ en-AU
CurrentUICulture    โ en-US
</code></pre>
<blockquote>
<p>โ๏ธ <code>CurrentCulture</code> ุชูุธูุงุช ููุทููโุง <strong>Control Panel ููุฏูุฒ</strong> ุฑุง ูุดุงู ูโุฏูุฏุ ุฏุฑ ุญุงู ฺฉู <code>CurrentUICulture</code> ุฒุจุงู ุณุณุชู ุนุงูู ุฑุง ูุดุฎุต ูโฺฉูุฏ.<br>
ุชูุธูุงุช ููุทููโุง ุดุงูู <strong>ููุทูู ุฒูุงูุ ูุงูุจ ุชุงุฑุฎ ู ุงุฑุฒ</strong> ุงุณุช. <code>CurrentCulture</code> ุฑูุชุงุฑ ูพุดโูุฑุถ ุชูุงุจุน ูุงููุฏ <code>DateTime.Parse</code> ุฑุง ุชุนู ูโฺฉูุฏ.<br>
<code>CurrentUICulture</code> ุฒุจุงู ุฑุง ูุดุฎุต ูโฺฉูุฏ ฺฉู ุณุณุชู ุจุง ฺฉุงุฑุจุฑ ุงุฑุชุจุงุท ุจุฑูุฑุงุฑ ูโฺฉูุฏ.</p>
</blockquote>
<p><strong>ResourceManager</strong> ุจูโุทูุฑ ูพุดโูุฑุถ ุงุฒ property <code>CurrentUICulture</code> thread ูุนู ุจุฑุง ุงูุชู satellite assembly ููุงุณุจ ุงุณุชูุงุฏู ูโฺฉูุฏ.</p>
<ul>
<li>ุงฺฏุฑ satellite assembly ุจุฑุง subculture ููุฌูุฏ ุจุงุดุฏุ ุขู ุงุณุชูุงุฏู ูโุดูุฏ.</li>
<li>ุฏุฑ ุบุฑ ุงู ุตูุฑุชุ ุจู <strong>generic culture</strong> ุจุงุฒูโฺฏุฑุฏุฏ.</li>
<li>ุงฺฏุฑ generic culture ูู ููุฌูุฏ ูุจุงุดุฏุ ุจู <strong>default culture</strong> ุฏุฑ main assembly ุจุงุฒูโฺฏุฑุฏุฏ.</li>
</ul>
<h3>โ๏ธ ุจุงุฑฺฏุฐุงุฑุ ุญู ูุงุจุณุชฺฏ ู ุฌุฏุงุณุงุฒ ุงุณูุจูโูุง (Loading, Resolving, and Isolating Assemblies) โ๏ธ</h3>
<p>ุจุงุฑฺฏุฐุงุฑ ฺฉ ุงุณูุจู ุงุฒ ฺฉ ูุณุฑ ูุดุฎุต ูุณุจุชุงู ุณุงุฏู ุงุณุช ู ุจู ุขู <strong>assembly loading</strong> ฺฏูุชู ูโุดูุฏ.<br>
ุงูุง ุงุบูุจุ ุดูุง ุง CLR ูุงุฒ ุฏุงุฑุฏ ฺฉู ฺฉ ุงุณูุจู ุฑุง ููุท ุจุง ูุงู ฺฉุงูู ุง ุณุงุฏูโุงุด ุจุงุฑฺฏุฐุงุฑ ฺฉูุฏ. ุจู ุงู ฺฉุงุฑ <strong>assembly resolution</strong> ฺฏูุชู ูโุดูุฏ. ุชูุงูุช ุงุตู ุจู ุจุงุฑฺฏุฐุงุฑ ู ุญู ูุงุจุณุชฺฏ ุงู ุงุณุช ฺฉู ุฏุฑ <strong>resolution</strong> ุงุจุชุฏุง ุจุงุฏ ุงุณูุจู <strong>ูพุฏุง ุดูุฏ</strong>.</p>
<hr>
<h4>๐น ุฒูุงูโูุง ุฑุฎ ุฏุงุฏู Assembly Resolution</h4>
<ol>
<li>ุชูุณุท CLRุ ููุช ูุงุฒ ุจู ุญู ูุงุจุณุชฺฏ (dependency) ุฏุงุดุชู ุจุงุดุฏ.</li>
<li>ุตุฑุญุงูุ ููุช ุดูุง ูุชุฏ ูุงููุฏ <code>Assembly.Load(AssemblyName)</code> ุฑุง ูุฑุงุฎูุงู ูโฺฉูุฏ.</li>
</ol>
<p>ูุซุงู: ฺฉ ุจุฑูุงูู ุจุง ุงุณูุจู ุงุตู ู ุชุนุฏุงุฏ ฺฉุชุงุจุฎุงูู ุงุณุชุงุชฺฉ:</p>
<pre class="hljs"><code>AdventureGame.dll    // Main assembly
Terrain.dll          // Referenced assembly
UIEngine.dll         // Referenced assembly
</code></pre>
<blockquote>
<p>ููุธูุฑ ุงุฒ <strong>statically referenced</strong> ุงู ุงุณุช ฺฉู AdventureGame.dll ููฺฏุงู ฺฉุงููพุงู ุจุง ุงุฑุฌุงุน ุจู Terrain.dll ู UIEngine.dll ุณุงุฎุชู ุดุฏู ุงุณุช.<br>
ฺฉุงููพุงูุฑ ุฎูุฏุด ูุงุฒ ุจู ุญู ูุงุจุณุชฺฏ ูุฏุงุฑุฏุ ุฒุฑุง ูุณุฑูุง ุงุณูุจูโูุง ุจู ุงู ุฏุงุฏู ุดุฏูโุงูุฏ. ุงูุง ุฏุฑ ุฒูุงู ุงุฌุฑุงุ ุจุงุฏ ุงู ุงุณูุจูโูุง <strong>resolve</strong> ุดููุฏ.</p>
</blockquote>
<hr>
<h3>โ๏ธ Assembly Load Contexts (ALC) โ ุจุงุฑฺฏุฐุงุฑ ู ุฌุฏุงุณุงุฒ ุงุณูุจูโูุง โ๏ธ</h3>
<p>ฺฉูุงุณ <strong><code>AssemblyLoadContext</code></strong> ูุณุฆูู ุจุงุฑฺฏุฐุงุฑ (loading) ู ุญู ูุงุจุณุชฺฏ (resolving) ุงุณูุจูโูุง ู ููฺูู ูุฑุงูู ฺฉุฑุฏู <strong>ูฺฉุงูุฒู ุฌุฏุงุณุงุฒ</strong> (isolation) ุงุณุช.</p>
<hr>
<h4>๐น ูุฑ ุงุณูุจู ูุชุนูู ุจู ฺฉ ALC ุงุณุช</h4>
<p>ูุฑ <strong>Assembly</strong> ุฏุฑ .NET ุฏููุงู ุฏุฑ ฺฉ <strong>ALC</strong> ูุฑุงุฑ ุฏุงุฑุฏ.<br>
ูโุชูุงูุฏ ALC ฺฉ ุงุณูุจู ุฑุง ุจู ุงู ุดฺฉู ุฏุฑุงูุช ฺฉูุฏ:</p>
<pre class="hljs"><code>Assembly assem = Assembly.GetExecutingAssembly();
AssemblyLoadContext context = AssemblyLoadContext.GetLoadContext(assem);
Console.WriteLine(context.Name);
</code></pre>
<p>ููฺููุ ูโุชูุงูุฏ ุชูุงู ุงุณูุจูโูุง ูุชุนูู ุจู ฺฉ ALC ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ property <code>Assemblies</code> ุจุจูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">foreach</span> (Assembly a <span class="hljs-keyword">in</span> context.Assemblies)
    Console.WriteLine(a.FullName);
</code></pre>
<p>ฺฉูุงุณ <strong><code>AssemblyLoadContext</code></strong> ููฺูู ฺฉ property ุงุณุชุงุชฺฉ <strong><code>All</code></strong> ุฏุงุฑุฏ ฺฉู ููู ALCูุง ุฑุง ููุฑุณุช ูโฺฉูุฏ.</p>
<hr>
<h4>๐น ุณุงุฎุช ู ุณูุงุฑุดโุณุงุฒ ALC</h4>
<ul>
<li>ูโุชูุงูุฏ ฺฉ <strong>ALC ุฌุฏุฏ</strong> ููุท ุจุง ูููููโุณุงุฒ <code>AssemblyLoadContext</code> ู ุงุฑุงุฆู ฺฉ ูุงู ุงุฌุงุฏ ฺฉูุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">var</span> alc = <span class="hljs-keyword">new</span> AssemblyLoadContext(<span class="hljs-string">&quot;MyALC&quot;</span>);
</code></pre>
<ul>
<li>ูุนูููุงู ุจูุชุฑ ุงุณุช ฺฉูุงุณ ุฑุง <strong>subclass ฺฉูุฏ</strong> ุชุง ุจุชูุงูุฏ ููุทู ุญู ูุงุจุณุชฺฏโูุง (Load) ุฑุง ุณูุงุฑุดโุณุงุฒ ฺฉูุฏ ู ุงุณูุจูโูุง ุฑุง ุงุฒ ูุงูุดุงู ุจุงุฑฺฏุฐุงุฑ ููุงุฏ.</li>
</ul>
<hr>
<h3>๐น ุจุงุฑฺฏุฐุงุฑ ุตุฑุญ ุงุณูุจูโูุง</h3>
<p>ALC ุฏู ูุชุฏ ููู ุจุฑุง ุจุงุฑฺฏุฐุงุฑ ูุฑุงูู ูโฺฉูุฏ:</p>
<ol>
<li><strong>ุงุฒ ูุณุฑ ูุงู:</strong></li>
</ol>
<pre class="hljs"><code>Assembly assem = alc.LoadFromAssemblyPath(<span class="hljs-string">@&quot;c:\temp\foo.dll&quot;</span>);
</code></pre>
<ol start="2">
<li><strong>ุงุฒ Stream (ูุซูุงู ุญุงูุธู):</strong></li>
</ol>
<pre class="hljs"><code><span class="hljs-built_in">byte</span>[] bytes = File.ReadAllBytes(<span class="hljs-string">@&quot;c:\temp\foo.dll&quot;</span>);
<span class="hljs-keyword">var</span> ms = <span class="hljs-keyword">new</span> MemoryStream(bytes);
Assembly assem = alc.LoadFromStream(ms);
</code></pre>
<blockquote>
<p>ูพุงุฑุงูุชุฑ ุฏูู ุฏุฑ <code>LoadFromStream</code> ูโุชูุงูุฏ ุญุงู ุงุทูุงุนุงุช debug (.pdb) ุจุงุดุฏ ุชุง stack traceูุง ุดุงูู ุงุทูุงุนุงุช ุณูุฑุณ ุดููุฏ.</p>
</blockquote>
<hr>
<h4>๐น ูุญุฏูุฏุชโูุง ู ูฺฉุงุช ููู</h4>
<ul>
<li><strong>ูุงู ุณุงุฏู ุงุณูุจู ุจุงุฏ ุฏุฑ ฺฉ ALC ููุญุตุฑ ุจู ูุฑุฏ ุจุงุดุฏ.</strong><br>
ุจุฑุง ุจุงุฑฺฏุฐุงุฑ ูุณุฎูโูุง ูุฎุชููุ ุจุงุฏ ALCูุง ุฌุฏุงฺฏุงูู ุจุณุงุฒุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">var</span> alc1 = <span class="hljs-keyword">new</span> AssemblyLoadContext(<span class="hljs-string">&quot;ALC1&quot;</span>);
<span class="hljs-keyword">var</span> assem1 = alc1.LoadFromAssemblyPath(<span class="hljs-string">@&quot;c:\temp\foo.dll&quot;</span>);

<span class="hljs-keyword">var</span> alc2 = <span class="hljs-keyword">new</span> AssemblyLoadContext(<span class="hljs-string">&quot;ALC2&quot;</span>);
<span class="hljs-keyword">var</span> assem2 = alc2.LoadFromAssemblyPath(<span class="hljs-string">@&quot;c:\temp\foo.dll&quot;</span>);
</code></pre>
<blockquote>
<p>ุญุช ุงฺฏุฑ ูุญุชูุงุช ุงุณูุจูโูุง ฺฉุณุงู ุจุงุดูุฏุ <strong>typeูุง ุขูโูุง ุจุง ูู ูุงุณุงุฒฺฏุงุฑ ูุณุชูุฏ</strong>.</p>
</blockquote>
<ul>
<li>ุจุนุฏ ุงุฒ ุจุงุฑฺฏุฐุงุฑุ ฺฉ ุงุณูุจู <strong>ููุท ุจุง unload ฺฉุฑุฏู ALC ูุฑุจูุทู</strong> ุขุฒุงุฏ ูโุดูุฏ.</li>
</ul>
<hr>
<h4>๐น ุชูุงูุช ุจู ุจุงุฑฺฏุฐุงุฑ ุงุฒ ูุงู ู ุงุฒ ุญุงูุธู</h4>
<ul>
<li>
<p><strong>LoadFromAssemblyPath:</strong></p>
<ul>
<li>ุงุฒ <strong>memory-mapped file</strong> ุงุณุชูุงุฏู ูโฺฉูุฏ.</li>
<li>ุงูฺฉุงู <strong>lazy loading</strong> ู ุงุดุชุฑุงฺฉ ุญุงูุธู ุจู ูพุฑุฏุงุฒุดโูุง ูุฌูุฏ ุฏุงุฑุฏ.</li>
<li>ุงฺฏุฑ ุญุงูุธู ฺฉู ุดูุฏุ OS ูโุชูุงูุฏ ุจุฎุดโูุง ุฑุง ุขุฒุงุฏ ู ูุฌุฏุฏุงู ุจุงุฑฺฏุฐุงุฑ ฺฉูุฏ.</li>
</ul>
</li>
<li>
<p><strong>LoadFromStream:</strong></p>
<ul>
<li>ฺฉู ุงุณูุจู ููุฑุงู ุฏุฑ ุญุงูุธู ุฎุตูุต ุจุงุฑฺฏุฐุงุฑ ูโุดูุฏ.</li>
<li>property <code>Location</code> ุฎุงู ุฎูุงูุฏ ุจูุฏ.</li>
<li>ูุตุฑู ุญุงูุธู ุณุฑุนุงู ุงูุฒุงุด ูโุงุจุฏ.</li>
</ul>
</li>
</ul>
<h3>๐น Assembly Resolution in .NET โ ุจุงุฑฺฏุฐุงุฑ ู ุญู ูุงุจุณุชฺฏ ุงุณูุจูโูุง</h3>
<p>ฺฉูุงุณ <strong><code>AssemblyLoadContext</code></strong> ุนูุงูู ุจุฑ ุจุงุฑฺฏุฐุงุฑ ุงุณูุจูโูุง ุงุฒ ูุณุฑ ุง ุงุณุชุฑูุ ฺฉ ุฑูุด ุฏฺฏุฑ ูู ุฏุงุฑุฏ: <strong>ุจุงุฑฺฏุฐุงุฑ ุงุฒ ูุงู ุงุณูุจู</strong>.</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">public</span> Assembly <span class="hljs-title">LoadFromAssemblyName</span>(<span class="hljs-params">AssemblyName assemblyName</span>)</span>;
</code></pre>
<ul>
<li>ุฏุฑ ุงู ุฑูุด ุดูุง <strong>ูุณุฑ ูุงู</strong> ุฑุง ูุดุฎุต ููโฺฉูุฏ.</li>
<li>ALC ูุณุฆูู <strong>ุญู ูุงุจุณุชฺฏ ู ูพุฏุง ฺฉุฑุฏู ุงุณูุจู</strong> ุงุณุช.</li>
</ul>
<hr>
<h3>๐น ฺฺฏููฺฏ ุญู ูุงุจุณุชฺฏโูุง (Resolving Assemblies)</h3>
<p>ููฺฏุงู ุจุงุฑฺฏุฐุงุฑ ูุงุจุณุชฺฏโูุงุ CLR ูุฑุขูุฏ ุญู ูุงุจุณุชฺฏ ุฑุง ุจู ุตูุฑุช ุฒุฑ ุงูุฌุงู ูโุฏูุฏ:</p>
<ol>
<li>
<p>ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ุขุง ููู ุงุณูุจู ูุจูุงู ุฏุฑ ููุงู ALC ุญู ุดุฏู ุงุณุช ุง ูู.</p>
<ul>
<li>ุงฺฏุฑ ุญู ุดุฏู ุจุงุดุฏุ ููุงู <strong>Assembly</strong> ุจุฑฺฏุฑุฏุงูุฏู ูโุดูุฏ.</li>
</ul>
</li>
<li>
<p>ุงฺฏุฑ ุญู ูุดุฏู ุจุงุดุฏุ CLR ูุชุฏ <strong><code>Load</code></strong> ฺฉูุงุณ ALC ุฑุง ูุฑุงุฎูุงู ูโฺฉูุฏ:</p>
<ul>
<li><strong>ุฏุฑ Default ALC</strong>ุ ููุงูู ุงุฒ ูพุด ุชุนุฑูโุดุฏู ูุณุชูุฏ.</li>
<li><strong>ุฏุฑ Custom ALC</strong>ุ ุดูุง ุฎูุฏุชุงู ููุทู ุญู ูุงุจุณุชฺฏ ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉูุฏุ ูุซูุงู ุจุฑุฑุณ ฺฉ ูููุฏุฑ ูุดุฎุต ู ูุฑุงุฎูุงู <code>LoadFromAssemblyPath</code>.</li>
</ul>
</li>
<li>
<p>ุงฺฏุฑ <code>Load</code> null ุจุฑฺฏุฑุฏุงูุฏุ CLR ูุชุฏ <strong>Load ูุชุฏ Default ALC</strong> ุฑุง ูุฑุงุฎูุงู ูโฺฉูุฏ (Fallback ุจุฑุง ุงุณูุจูโูุง Runtime ู ุนููู).</p>
</li>
<li>
<p>ุงฺฏุฑ ูููุฒ ุญู ูุดุฏุ ุฑูุฏุงุฏูุง <strong>Resolving</strong> ุฏุฑ ALCูุง ูุฑุจูุทู ูุฑุงุฎูุงู ูโุดููุฏ.</p>
</li>
<li>
<p>ุจุฑุง ุณุงุฒฺฏุงุฑ ุจุง .NET Frameworkุ ุฏุฑ ููุงุช <strong>AppDomain.CurrentDomain.AssemblyResolve</strong> ูุฑุงุฎูุงู ูโุดูุฏ.</p>
</li>
</ol>
<blockquote>
<p>ูพุณ ุงุฒ ุจุงุฑฺฏุฐุงุฑุ CLR ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู <strong>ูุงู ุณุงุฏู ู ุชูฺฉู ฺฉูุฏ ุนููู</strong> ุจุง ุฏุฑุฎูุงุณุช ูุทุงุจูุช ุฏุงุฑุฏ. ูุณุฎู ูโุชูุงูุฏ ุจุงูุงุชุฑ ุง ูพุงูโุชุฑ ุจุงุดุฏ.</p>
</blockquote>
<hr>
<h3>๐น ุฏู ุฑูุด ุจุฑุง ุญู ูุงุจุณุชฺฏ ุฏุฑ Custom ALC</h3>
<ol>
<li>
<p><strong>Override ูุชุฏ Load</strong></p>
<ul>
<li>ALC ุดูุง <strong>ุงููู ูุฑุตุช</strong> ุจุฑุง ุจุงุฑฺฏุฐุงุฑ ุงุณูุจู ุฑุง ุฏุงุฑุฏ.</li>
<li>ุถุฑูุฑ ุจุฑุง <strong>ุงุฒูููโุณุงุฒ</strong>.</li>
</ul>
</li>
<li>
<p><strong>Handling ุฑูุฏุงุฏ Resolving</strong></p>
<ul>
<li>ููุท ููุช Default ALC ูุชูุงูุฏ ุงุณูุจู ุฑุง ุญู ฺฉูุฏุ ุงุฌุฑุง ูโุดูุฏ.</li>
<li>ุงููู handler ฺฉู ููุฏุงุฑ ุบุฑ null ุจุฑฺฏุฑุฏุงูุฏุ ุจุฑูุฏู ุงุณุช.</li>
</ul>
</li>
</ol>
<hr>
<h3>๐น ูุซุงู ุนูู: ุจุงุฑฺฏุฐุงุฑ ุงุณูุจู ุจุง ูุงุจุณุชฺฏ ุฎุตูุต</h3>
<p>ูุฑุถ ฺฉูุฏ ุฏุงุฑู:</p>
<ul>
<li>foo.dll ุฏุฑ <code>c:\temp</code></li>
<li>bar.dll ุจู ุนููุงู ูุงุจุณุชฺฏ ุฎุตูุต foo.dll</li>
</ul>
<h4>ุฑูุด ฑ: subclass ู override Load</h4>
<pre class="hljs"><code><span class="hljs-keyword">using</span> System.IO;
<span class="hljs-keyword">using</span> System.Reflection;
<span class="hljs-keyword">using</span> System.Runtime.Loader;

<span class="hljs-keyword">class</span> <span class="hljs-title">FolderBasedALC</span> : <span class="hljs-title">AssemblyLoadContext</span>
{
    <span class="hljs-keyword">readonly</span> <span class="hljs-built_in">string</span> _folder;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">FolderBasedALC</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> folder</span>)</span> =&gt; _folder = folder;

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> Assembly <span class="hljs-title">Load</span>(<span class="hljs-params">AssemblyName assemblyName</span>)</span>
    {
        <span class="hljs-built_in">string</span> targetPath = Path.Combine(_folder, assemblyName.Name + <span class="hljs-string">&quot;.dll&quot;</span>);
        <span class="hljs-keyword">if</span> (File.Exists(targetPath))
            <span class="hljs-keyword">return</span> LoadFromAssemblyPath(targetPath);

        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>; <span class="hljs-comment">// fallback ุจู Default ALC</span>
    }
}

<span class="hljs-comment">// ุงุณุชูุงุฏู:</span>
<span class="hljs-keyword">var</span> alc = <span class="hljs-keyword">new</span> FolderBasedALC(<span class="hljs-string">@&quot;c:\temp&quot;</span>);
Assembly foo = alc.LoadFromAssemblyName(<span class="hljs-keyword">new</span> AssemblyName(<span class="hljs-string">&quot;foo&quot;</span>));
</code></pre>
<blockquote>
<p>Load method ุจุง null ุจุฑฺฏุฑุฏุงูุฏูุ ุงุฌุงุฒู ูโุฏูุฏ <strong>ูุงุจุณุชฺฏโูุง BCL</strong> ุชูุณุท Default ALC ุญู ุดููุฏ.</p>
</blockquote>
<hr>
<h4>ุฑูุด ฒ: ุฑูุฏุงุฏ Resolving</h4>
<pre class="hljs"><code><span class="hljs-keyword">var</span> alc = <span class="hljs-keyword">new</span> AssemblyLoadContext(<span class="hljs-string">&quot;test&quot;</span>);
alc.Resolving += (context, assemblyName) =&gt;
{
    <span class="hljs-built_in">string</span> targetPath = Path.Combine(<span class="hljs-string">@&quot;c:\temp&quot;</span>, assemblyName.Name + <span class="hljs-string">&quot;.dll&quot;</span>);
    <span class="hljs-keyword">return</span> alc.LoadFromAssemblyPath(targetPath);
};

Assembly foo = alc.LoadFromAssemblyName(<span class="hljs-keyword">new</span> AssemblyName(<span class="hljs-string">&quot;foo&quot;</span>));
</code></pre>
<ul>
<li>ูุฒุช: ุณุงุฏูโุชุฑ ุงุณุชุ ฺูู Default ALC ุงุจุชุฏุง ุจุฑุฑุณ ูโุดูุฏ.</li>
<li>ุนุจ: ุงฺฏุฑ ุจุฑูุงูู ุงุตู ุฎูุฏุด ูุงุฒ ุจู foo.dll ุง bar.dll ุฏุงุดุชู ุจุงุดุฏุ ุงุฒูููโุณุงุฒ ุจุฑูุฑุงุฑ ููโุดูุฏ.</li>
</ul>
<hr>
<h4>๐น ูฺฉุงุช ฺฉูุฏ</h4>
<ul>
<li>ูุชุฏ <strong>FolderBasedALC</strong> ุจุฑุง ุฏุฑฺฉ ููููู ุญู ูุงุจุณุชฺฏ ุนุงู ุงุณุชุ ุงูุง ุฏุฑ ูพุฑูฺูโูุง ูุงูุน ุจุง NuGet ู ูุงุจุณุชฺฏโูุง platform-specific ูุญุฏูุฏุช ุฏุงุฑุฏ.</li>
<li>ุฑุงูโุญู ูพุดุฑูุชูโุชุฑ: ุงุณุชูุงุฏู ุงุฒ <strong>AssemblyDependencyResolver</strong> ุจุฑุง ูุฏุฑุช ูุงุจุณุชฺฏโูุง ุฏุฑ ูพุฑูฺูโูุง ูุงูุน.</li>
</ul>
<h3>๐น ALC ูพุดโูุฑุถ (The Default ALC) โ๏ธ</h3>
<p>ููุช ฺฉ ุจุฑูุงูู ุดุฑูุน ูโุดูุฏุ <strong>CLR</strong> ฺฉ <strong>ALC ูฺู</strong> ุฑุง ุจู ูพุฑุงูพุฑุช ุงุณุชุง <strong><code>AssemblyLoadContext.Default</code></strong> ุงุฎุชุตุงุต ูโุฏูุฏ.<br>
ALC ูพุดโูุฑุถ ุฌุง ุงุณุช ฺฉู <strong>assembly ุดุฑูุน ุจุฑูุงูู</strong> ุจุงุฑฺฏุฐุงุฑ ูโุดูุฏุ ููุฑุงู ุจุง ูุงุจุณุชฺฏโูุง ุงุณุชุงุชฺฉ ุขู ู ุงุณูุจูโูุง BCL ูุฑุจูุท ุจู <strong>.NET runtime</strong>.</p>
<p>ALC ูพุดโูุฑุถ ุงุจุชุฏุง ุฏุฑ <strong>ูุณุฑูุง ูพุดโูุฑุถ ุฌุณุชุฌู (default probing paths)</strong> ุจู ุฏูุจุงู ุงุณูุจูโูุง ูโฺฏุฑุฏุฏ ุชุง ุขูโูุง ุฑุง ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ุญู ฺฉูุฏ (ุตูุญู 791 ุฑุง ุจุจูุฏ)ุ ุงู ูุณุฑูุง ูุนูููุงู ููุงู ูฺฉุงูโูุง ูุดุฎุตโุดุฏู ุฏุฑ ูุงูโูุง <strong>.deps.json</strong> ู <strong>.runtimeconfig.json</strong> ุจุฑูุงูู ูุณุชูุฏ.</p>
<p>ุงฺฏุฑ ALC ูุชูุงูุฏ ฺฉ ุงุณูุจู ุฑุง ุฏุฑ ูุณุฑูุง ูพุดโูุฑุถ ูพุฏุง ฺฉูุฏุ ุฑูุฏุงุฏ <strong>Resolving</strong> ุขู ูุฑุงุฎูุงู ูโุดูุฏ. ูุฏุฑุช ุงู ุฑูุฏุงุฏ ุจู ุดูุง ุงุฌุงุฒู ูโุฏูุฏ ุชุง ุงุณูุจู ุฑุง ุงุฒ ูฺฉุงูโูุง ุฏฺฏุฑ ุจุงุฑฺฏุฐุงุฑ ฺฉูุฏ. ุจู ุงู ุชุฑุชุจุ ูโุชูุงูุฏ ูุงุจุณุชฺฏโูุง ุจุฑูุงูู ุฑุง ุฏุฑ ูุณุฑูุง ุงุถุงู ูุงููุฏ ุฒุฑูพูุดูโูุงุ ูพูุดูโูุง ูุดุชุฑฺฉ ุง ุญุช ุจูโุตูุฑุช ฺฉ ููุจุน ุจุงูุฑ ุฏุงุฎู <strong>host assembly</strong> ูุฑุงุฑ ุฏูุฏ:</p>
<pre class="hljs"><code>AssemblyLoadContext.Default.Resolving += (loadContext, assemblyName) =&gt;
{
    <span class="hljs-comment">// ุชูุงุด ุจุฑุง ูพุฏุง ฺฉุฑุฏู assemblyName ู ุจุฑฺฏุฑุฏุงูุฏู ฺฉ Assembly ุง null</span>
    <span class="hljs-comment">// ูุนูููุงู ูพุณ ุงุฒ ูพุฏุง ฺฉุฑุฏู ูุงูุ LoadFromAssemblyPath ูุฑุงุฎูุงู ูโุดูุฏ</span>
    <span class="hljs-comment">// ...</span>
};
</code></pre>
<blockquote>
<p>ุฑูุฏุงุฏ <strong>Resolving</strong> ุฏุฑ ALC ูพุดโูุฑุถ ููฺูู ููุช ฺฉ <strong>Custom ALC</strong> ูุชูุงูุฏ ุงุณูุจู ุฑุง ุญู ฺฉูุฏ (ุนู ูุชุฏ Load ุขู null ุจุฑฺฏุฑุฏุงูุฏ) ู ALC ูพุดโูุฑุถ ูุฒ ูุชูุงูุฏ ุงุณูุจู ุฑุง ุญู ฺฉูุฏุ ูุฑุงุฎูุงู ูโุดูุฏ.</p>
</blockquote>
<hr>
<p>ูโุชูุงูุฏ ุงุณูุจูโูุง ุฑุง ุฎุงุฑุฌ ุงุฒ ุฑูุฏุงุฏ <strong>Resolving</strong> ูุฒ ุฏุฑ ALC ูพุดโูุฑุถ ุจุงุฑฺฏุฐุงุฑ ฺฉูุฏ.<br>
ุจุง ุงู ุญุงูุ ูุจู ุงุฒ ุงูุฌุงู ุงู ฺฉุงุฑุ ุจูุชุฑ ุงุณุช ุจุฑุฑุณ ฺฉูุฏ ฺฉู ุขุง ูโุชูุงูุฏ ูุดฺฉู ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉ <strong>ALC ุฌุฏุงฺฏุงูู</strong> ุง ุฑูุดโูุง ฺฉู ุฏุฑ ุจุฎุด ุจุนุฏ ุชูุถุญ ูโุฏูู (ุงุณุชูุงุฏู ุงุฒ ALC ุงุฌุฑุง ู ุฒูููโุง) ุจูุชุฑ ุญู ฺฉูุฏ ุง ุฎุฑ.</p>
<p>ุงุณุชูุงุฏู ูุณุชูู ุงุฒ ALC ูพุดโูุฑุถ ุจุงุนุซ ูโุดูุฏ ฺฉุฏ ุดูุง ุดฺฉููุฏู ุดูุฏุ ุฒุฑุง ููโุชูุงู ุขู ุฑุง ุจู ุทูุฑ ฺฉุงูู ุงุฒููู ฺฉุฑุฏ (ุจุฑุง ูุซุงู ุชูุณุท ูุฑูโูุฑฺฉโูุง <strong>unit testing</strong> ุง <strong>LINQPad</strong>).</p>
<p>ุงฺฏุฑ ุจุงุฒ ูู ูโุฎูุงูุฏ ุงุฏุงูู ุฏูุฏุ ุจูุชุฑ ุงุณุช ุงุฒ <strong>ูุชุฏ ุญู ูุงุจุณุชฺฏ</strong> ูุงููุฏ <code>LoadFromAssemblyName</code> ุงุณุชูุงุฏู ฺฉูุฏ ุชุง ูุชุฏ ุจุงุฑฺฏุฐุงุฑ ูุงููุฏ <code>LoadFromAssemblyPath</code> โ ูุฎุตูุตุงู ุงฺฏุฑ ุงุณูุจู ุดูุง ุจู ุตูุฑุช ุงุณุชุงุชฺฉ ุงุฑุฌุงุน ุดุฏู ุจุงุดุฏ.<br>
ฺุฑุงุ ฺูู ููฺฉู ุงุณุช ุงุณูุจู ุงุฒ ูุจู ุจุงุฑฺฏุฐุงุฑ ุดุฏู ุจุงุดุฏุ ุฏุฑ ุงู ุตูุฑุช <code>LoadFromAssemblyName</code> ููุงู ุงุณูุจู ุจุงุฑฺฏุฐุงุฑโุดุฏู ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏุ ูู <code>LoadFromAssemblyPath</code> ุจุงุนุซ ุงุฌุงุฏ <strong>ุงุณุชุซูุง</strong> ูโุดูุฏ.</p>
<blockquote>
<p>ุจุง <code>LoadFromAssemblyPath</code> ููฺูู ููฺฉู ุงุณุช ุฑุณฺฉ ุฏุงุดุชู ุจุงุดุฏ ฺฉู ุงุณูุจู ุงุฒ ูฺฉุงู ุจุงุฑฺฏุฐุงุฑ ุดูุฏ ฺฉู ุจุง ูฺฉุงู ูพุดโูุฑุถ ALC ููุฎูุงู ูุฏุงุฑุฏ.</p>
</blockquote>
<p>ุงฺฏุฑ ุงุณูุจู ุฏุฑ ูฺฉุงู ุงุณุช ฺฉู ALC ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ุขู ุฑุง ูพุฏุง ููโฺฉูุฏุ ุจุงุฒ ูู ูโุชูุงูุฏ ููู ุฑูุด ุฑุง ุฏูุจุงู ฺฉุฑุฏู ู ุนูุงูู ุจุฑ ุขู ุฑูุฏุงุฏ <strong>Resolving</strong> ุฑุง ูุฏุฑุช ฺฉูุฏ.</p>
<p>ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ููฺฏุงู ูุฑุงุฎูุงู <code>LoadFromAssemblyName</code> ูุงุฒ ุจู ุงุฑุงุฆู ูุงู ฺฉุงูู ูุณุชุ <strong>ูุงู ุณุงุฏู ฺฉุงู ุงุณุช</strong> (ู ุญุช ุงฺฏุฑ ุงุณูุจู ุฏุงุฑุง Strong Name ุจุงุดุฏ ูุนุชุจุฑ ุงุณุช):</p>
<pre class="hljs"><code>AssemblyLoadContext.Default.LoadFromAssemblyName(<span class="hljs-string">&quot;System.Xml&quot;</span>);
</code></pre>
<p>ุงูุง ุงฺฏุฑ <strong>Public Key Token</strong> ุฑุง ุฏุฑ ูุงู ูุฑุงุฑ ุฏูุฏุ ุจุงุฏ ุจุง ุขูฺู ุจุงุฑฺฏุฐุงุฑ ุดุฏู ูุทุงุจูุช ุฏุงุดุชู ุจุงุดุฏ.</p>
<hr>
<h3>๐น ูุณุฑูุง ูพุดโูุฑุถ ุฌุณุชุฌู (Default Probing) ๐๏ธ</h3>
<p>ูุณุฑูุง ูพุดโูุฑุถ ูุนูููุงู ุดุงูู ููุงุฑุฏ ุฒุฑ ูุณุชูุฏ:</p>
<ul>
<li>ูุณุฑูุง ูุดุฎุตโุดุฏู ุฏุฑ <strong>AppName.deps.json</strong> (ฺฉู AppName ูุงู ุงุณูุจู ุงุตู ุจุฑูุงูู ุงุณุช). ุงฺฏุฑ ุงู ูุงู ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏุ ุงุฒ <strong>ูพูุดู ูพุงู ุจุฑูุงูู</strong> ุงุณุชูุงุฏู ูโุดูุฏ.</li>
<li>ูพูุดูโูุง ุญุงู <strong>assemblyูุง ุณุณุชู .NET runtime</strong> (ุงฺฏุฑ ุจุฑูุงูู ุดูุง <strong>Framework-dependent</strong> ุจุงุดุฏ).</li>
</ul>
<p><strong>MSBuild</strong> ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ูุงู ุจู ูุงู <strong>AppName.deps.json</strong> ุงุฌุงุฏ ูโฺฉูุฏ ฺฉู ูุณุฑ ูพุฏุง ฺฉุฑุฏู ููู ูุงุจุณุชฺฏโูุง ุฑุง ูุดุฎุต ูโฺฉูุฏ.<br>
ุงู ุดุงูู <strong>assemblyูุง platform-agnostic</strong> ุงุณุช ฺฉู ุฏุฑ ูพูุดู ูพุงู ุจุฑูุงูู ูุฑุงุฑ ูโฺฏุฑูุฏ ู <strong>assemblyูุง platform-specific</strong> ฺฉู ุฏุฑ ุฒุฑูพูุดู <code>runtimes\</code> ุชุญุช ูููุฏุฑ ูุงููุฏ <code>win</code> ุง <code>unix</code> ูุฑุงุฑ ูโฺฏุฑูุฏ.</p>
<p>ูุณุฑูุง ูุดุฎุตโุดุฏู ุฏุฑ ูุงู <code>.deps.json</code> ุชููุฏ ุดุฏู ูุณุจุช ุจู <strong>ูพูุดู ูพุงู ุจุฑูุงูู</strong> ูุณุชูุฏ โ ุง ูุฑ ูพูุดู ุงุถุงู ฺฉู ุฏุฑ ุจุฎุด <strong>additionalProbingPaths</strong> ูุงูโูุง <code>AppName.runtimeconfig.json</code> ู/ุง <code>AppName.runtimeconfig.dev.json</code> ูุดุฎุต ฺฉุฑุฏูโุงุฏ.</p>
<hr>
<h3>๐น ALC โุฌุงุฑโ (The โCurrentโ ALC) ๐</h3>
<p>ุฏุฑ ุจุฎุด ูุจูุ ูุณุจุช ุจู ุจุงุฑฺฏุฐุงุฑ ูุณุชูู ุงุณูุจู ุฏุฑ <strong>ALC ูพุดโูุฑุถ</strong> ูุดุฏุงุฑ ุฏุงุฏู. ูุนูููุงู ฺุฒ ฺฉู ูโุฎูุงูุฏุ ุจุงุฑฺฏุฐุงุฑ/ุญู ุฏุฑ <strong>ALC ุฌุงุฑ</strong> ุงุณุช.</p>
<p>ุฏุฑ ุงฺฉุซุฑ ููุงุฑุฏุ <strong>ALC ุฌุงุฑ</strong> ููุงู ALC ุงุณุช ฺฉู ุดุงูู <strong>assembly ุฏุฑ ุญุงู ุงุฌุฑุง</strong> ุงุณุช:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> executingAssem = Assembly.GetExecutingAssembly();
<span class="hljs-keyword">var</span> alc = AssemblyLoadContext.GetLoadContext(executingAssem);
Assembly assem = alc.LoadFromAssemblyName(...);  <span class="hljs-comment">// ุญู ุจุฑ ุงุณุงุณ ูุงู</span>
<span class="hljs-comment">// ุง: = alc.LoadFromAssemblyPath(...);  // ุจุงุฑฺฏุฐุงุฑ ุจุฑ ุงุณุงุณ ูุณุฑ</span>
</code></pre>
<p>ฺฉ ุฑูุด ุงูุนุทุงูโูพุฐุฑ ู ูุงุถุญโุชุฑ ุจุฑุง ุจูโุฏุณุช ุขูุฑุฏู ALC:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> myAssem = <span class="hljs-keyword">typeof</span>(SomeTypeInMyAssembly).Assembly;
<span class="hljs-keyword">var</span> alc = AssemblyLoadContext.GetLoadContext(myAssem);
...
</code></pre>
<p>ฺฏุงู ุงูฺฉุงู ุชุนู โALC ุฌุงุฑโ ูุฌูุฏ ูุฏุงุฑุฏ.<br>
ูุซูุงู ุงฺฏุฑ ูุณุฆูู ููุดุชู <strong>binary serializer</strong> ุฏุฑ .NET ุจุงุดุฏุ ุงู serializer ูุงู ฺฉุงูู ููุนโูุง (ุดุงูู ูุงู ุงุณูุจู) ุฑุง ูโููุณุฏ ู ุจุงุฏ ููฺฏุงู <strong>deserialization</strong> ุญู ุดููุฏ. ุณุคุงู ุงู ุงุณุช: ุงุฒ ฺฉุฏุงู ALC ุงุณุชูุงุฏู ฺฉููุ<br>
ูุดฺฉู ุงู ุงุณุช ฺฉู ุงฺฏุฑ ุจู <strong>executing assembly</strong> ุงุชฺฉุง ฺฉููุ ALC ููุงู assembly ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ ฺฉู serializer ุฑุง ุฏุงุฑุฏุ ูู assemblyโุง ฺฉู serializer ุฑุง ูุฑุงุฎูุงู ูโฺฉูุฏ.</p>
<p>ุฑุงู ุญู ุจูุชุฑู: <strong>ุตุฑุญ ุจูุฏู</strong>:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">object</span> <span class="hljs-title">Deserialize</span>(<span class="hljs-params">Stream stream, AssemblyLoadContext alc</span>)</span>
{
    ...
}
</code></pre>
<p>ุจุง ุงู ฺฉุงุฑุ <strong>caller</strong> ูุดุฎุต ูโฺฉูุฏ ฺฉู ฺู ฺุฒ โALC ุฌุงุฑโ ุงุณุช:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> assem = <span class="hljs-keyword">typeof</span>(SomeTypeThatIWillBeDeserializing).Assembly;
<span class="hljs-keyword">var</span> alc = AssemblyLoadContext.GetLoadContext(assem);
<span class="hljs-keyword">var</span> obj = Deserialize(someStream, alc);
</code></pre>
<h3>๐น Assembly.Load ู ALCูุง ุฒูููโุง (Contextual ALCs) โ๏ธ</h3>
<p>ุจุฑุง ุณูุงุฑู ุฑุงุฌ ุจุงุฑฺฏุฐุงุฑ ฺฉ ุงุณูุจู ุฏุฑ <strong>ALC ุฏุฑ ุญุงู ุงุฌุฑุง ุฌุงุฑ</strong>ุ ูุนูููุงู ฺฉุฏ ุฒุฑ ุฑุง ูโููุณู:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> executingAssem = Assembly.GetExecutingAssembly();
<span class="hljs-keyword">var</span> alc = AssemblyLoadContext.GetLoadContext(executingAssem);
Assembly assem = alc.LoadFromAssemblyName(...);
</code></pre>
<p>ุจุฑุง ุฑุงุญุช ุชูุณุนูโุฏููุฏฺฏุงูุ ูุงฺฉุฑูุณุงูุช ูุชุฏ ุฒุฑ ุฑุง ุฏุฑ ฺฉูุงุณ <strong>Assembly</strong> ุชุนุฑู ฺฉุฑุฏู ุงุณุช:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Assembly <span class="hljs-title">Load</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> assemblyString</span>)</span>;
</code></pre>
<p>ููฺูู ูุณุฎูโุง ฺฉุงููุงู ูุดุงุจู ูุฌูุฏ ุฏุงุฑุฏ ฺฉู <strong>ฺฉ ุด AssemblyName</strong> ูโูพุฐุฑุฏ:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Assembly <span class="hljs-title">Load</span>(<span class="hljs-params">AssemblyName assemblyRef</span>)</span>;
</code></pre>
<blockquote>
<p>ุงู ูุชุฏูุง ุจุง ูุชุฏ ูุฏู <strong>Load(byte[])</strong> ฺฉู ุฑูุชุงุฑ ฺฉุงููุงู ูุชูุงูุช ุฏุงุฑุฏ ูุชูุงูุช ูุณุชูุฏ (ุตูุญู 798 ุฑุง ุจุจูุฏ).</p>
</blockquote>
<p>ููุงููุฏ <code>LoadFromAssemblyName</code>ุ ุดูุง ูโุชูุงูุฏ ูุงู <strong>ุณุงุฏูุ ุฌุฒุฆ ุง ฺฉุงูู</strong> ุงุณูุจู ุฑุง ูุดุฎุต ฺฉูุฏ:</p>
<pre class="hljs"><code>Assembly a = Assembly.Load(<span class="hljs-string">&quot;System.Private.Xml&quot;</span>);
</code></pre>
<p>ุงู ุฏุณุชูุฑ ุงุณูุจู <code>System.Private.Xml</code> ุฑุง ุฏุฑ <strong>ูุฑ ALC ฺฉู assembly ุฏุฑ ุขู ุจุงุฑฺฏุฐุงุฑ ุดุฏู ุงุณุช</strong>ุ ุจุงุฑฺฏุฐุงุฑ ูโฺฉูุฏ.</p>
<p>ูโุชูุงูู ุจู ุฌุง ูุงู ุณุงุฏูุ ุงุฒ ุฑุดุชูโูุง ุฒุฑ ูู ุงุณุชูุงุฏู ฺฉูู ู ูุชุฌู ุฏุฑ .NET ฺฉุณุงู ุฎูุงูุฏ ุจูุฏ:</p>
<ul>
<li><code>&quot;System.Private.Xml, PublicKeyToken=cc7b13ffcd2ddd51&quot;</code></li>
<li><code>&quot;System.Private.Xml, Version=4.0.1.0&quot;</code></li>
<li><code>&quot;System.Private.Xml, Version=4.0.1.0, PublicKeyToken=cc7b13ffcd2ddd51&quot;</code></li>
</ul>
<p>ุงฺฏุฑ <strong>public key token</strong> ูุดุฎุต ุดูุฏุ ุจุงุฏ ุจุง ุขูฺู ุจุงุฑฺฏุฐุงุฑ ุดุฏู ูุทุงุจูุช ุฏุงุดุชู ุจุงุดุฏ.</p>
<blockquote>
<p>MSDN ุชูุตู ูโฺฉูุฏ ุงุฒ ูุงู ุฌุฒุฆ ุงุณุชูุงุฏู ูฺฉูุฏ ู ุจูุชุฑ ุงุณุช <strong>ูุณุฎู ุฏูู ู public key token</strong> ุฑุง ูุดุฎุต ฺฉูุฏ. ุฏูู ุขู ูุฑุจูุท ุจู .NET Framework ุงุณุชุ ูุงููุฏ ุชุฃุซุฑุงุช <strong>Global Assembly Cache</strong> ู <strong>Code Access Security</strong>.<br>
ุฏุฑ .NET 5+ ู .NET Coreุ ุงู ูุญุฏูุฏุชโูุง ูุฌูุฏ ูุฏุงุฑุฏ ู ูุนูููุงู ุงุณุชูุงุฏู ุงุฒ ูุงู ุณุงุฏู ุง ุฌุฒุฆ ุงูู ุงุณุช.</p>
</blockquote>
<p>ูุฑ ุฏู ูุชุฏ ููุท ุจุฑุง <strong>ุญู ูุงุจุณุชฺฏ (resolution)</strong> ูุณุชูุฏุ ุจูุงุจุฑุงู ููโุชูุงูุฏ ูุณุฑ ูุงู ูุดุฎุต ฺฉูุฏ. (ุงฺฏุฑ ูพุฑุงูพุฑุช <code>CodeBase</code> ุฏุฑ ุด <strong>AssemblyName</strong> ูพุฑ ุดูุฏุ ูุงุฏุฏู ฺฏุฑูุชู ูโุดูุฏ.)</p>
<hr>
<blockquote>
<p>ูฺฉุชู ููู: ุงุฒ <strong>Assembly.Load</strong> ุจุฑุง ุจุงุฑฺฏุฐุงุฑ ฺฉ ุงุณูุจู ฺฉู ุจู ุตูุฑุช ุงุณุชุงุชฺฉ ุงุฑุฌุงุน ุดุฏู ุงุณุชูุงุฏู ูฺฉูุฏ.<br>
ฺฉุงู ุงุณุช ุจู ฺฉ <strong>type</strong> ุฏุฑ ุขู assembly ุงุฑุฌุงุน ุฏูุฏ ู assembly ุฑุง ุงุฒ ุขู ุฏุฑุงูุช ฺฉูุฏ:</p>
</blockquote>
<pre class="hljs"><code>Assembly a = <span class="hljs-keyword">typeof</span>(System.Xml.Formatting).Assembly;
</code></pre>
<p>ุง ุญุช:</p>
<pre class="hljs"><code>Assembly a = System.Xml.Formatting.Indented.GetType().Assembly;
</code></pre>
<p>ุงู ุฑูุด ุงุฒ <strong>hardcoding ูุงู ุงุณูุจู</strong> ุฌููฺฏุฑ ูโฺฉูุฏ ู ููุฒูุงู ูุฑุขูุฏ <strong>assembly resolution</strong> ุฏุฑ ALC ุฏุฑ ุญุงู ุงุฌุฑุง ฺฉุฏ ุฑุง ูุนุงู ูโฺฉูุฏ (ููุงู ฺฉุงุฑ ฺฉู Assembly.Load ุงูุฌุงู ูโุฏูุฏ).</p>
<hr>
<p>ุงฺฏุฑ ูโุฎูุงุณุชุฏ ุฎูุฏุชุงู ูุชุฏ Assembly.Load ุฑุง ุจููุณุฏุ ุชูุฑุจุงู ฺูู ฺุฒ ูโุดุฏ:</p>
<pre class="hljs"><code>[<span class="hljs-meta">MethodImpl(MethodImplOptions.NoInlining)</span>]
<span class="hljs-function">Assembly <span class="hljs-title">Load</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> name</span>)</span>
{
    Assembly callingAssembly = Assembly.GetCallingAssembly();
    <span class="hljs-keyword">var</span> callingAlc = AssemblyLoadContext.GetLoadContext(callingAssembly);
    <span class="hljs-keyword">return</span> callingAlc.LoadFromAssemblyName(<span class="hljs-keyword">new</span> AssemblyName(name));
}
</code></pre>
<hr>
<h3>๐น EnterContextualReflection ๐</h3>
<p>ุงุณุชุฑุงุชฺ Assembly.Load ฺฉู ุงุฒ <strong>ALC ุงุณูุจู ูุฑุงุฎูุงููุฏู</strong> ุงุณุชูุงุฏู ูโฺฉูุฏุ ุฒูุงู ุดฺฉุณุช ูโุฎูุฑุฏ ฺฉู <strong>Assembly.Load ุชูุณุท ูุงุณุทูโุง</strong> ูุซู serializer ุง unit test runner ูุฑุงุฎูุงู ุดูุฏ.<br>
ุงฺฏุฑ ูุงุณุทู ุฏุฑ ฺฉ assembly ูุชูุงูุช ุจุงุดุฏุ ALC ูุงุณุทู ุจู ุฌุง ALC ูุฑุงุฎูุงููุฏู ุงุณุชูุงุฏู ูโุดูุฏ.</p>
<p>ุฑุงู ุญู ุงุฏูโุขู: <strong>ุงุฌุจุงุฑ caller ุจู ูุดุฎุต ฺฉุฑุฏู ALC</strong> ุจู ุฌุง ุญุฏุณ ุฒุฏู ุจุง <code>Assembly.Load(string)</code>.</p>
<p>ุงูุง ฺูู .NET 5+ ู .NET Core ุงุฒ .NET Framework ุชฺฉุงูู ุงูุชูโุงูุฏุ ุฌุง ฺฉู <strong>ุงุฒูููโุณุงุฒ ุจุง application domain</strong> ุงูุฌุงู ูโุดุฏ ู ูู ALCุ ุงุณุชูุงุฏู ุงุฏูโุขู ุฑุงุฌ ูุณุช ู <code>Assembly.Load(string)</code> ฺฏุงู ุฏุฑ ุณูุงุฑููุง ฺฉู ALC ูุงุจู ุงุนุชูุงุฏ ูุณุชุ ุงุณุชูุงุฏู ูโุดูุฏ (ูุซูุงู ุฏุฑ binary serializer).</p>
<p>ุจุฑุง ุญู ุงู ูุดฺฉูุ ูุงฺฉุฑูุณุงูุช ูุชุฏ ุจู ูุงู <strong>EnterContextualReflection</strong> ุฏุฑ AssemblyLoadContext ุงุถุงูู ฺฉุฑุฏู ุงุณุช. ุงู ูุชุฏ ฺฉ ALC ุฑุง ุจู <strong>AssemblyLoadContext.CurrentContextualReflectionContext</strong> ุงุฎุชุตุงุต ูโุฏูุฏ.</p>
<ul>
<li>ุงู ูพุฑุงูพุฑุช ุงุณุชุงุชฺฉ ุงุณุชุ ุงูุง ููุฏุงุฑ ุขู ุฏุฑ <strong>AsyncLocal</strong> ุฐุฎุฑู ูโุดูุฏ ู ูโุชูุงูุฏ ุฏุฑ threadูุง ูุฎุชูู ููุงุฏุฑ ุฌุฏุงฺฏุงูู ุฏุงุดุชู ุจุงุดุฏ ู ููฺูุงู ุฏุฑ ุนููุงุชโูุง asynchronous ุญูุธ ุดูุฏ.</li>
</ul>
<p>ุงฺฏุฑ ุงู ูพุฑุงูพุฑุช ุบุฑ-null ุจุงุดุฏุ <strong>Assembly.Load</strong> ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ุงุฒ ุขู ุงุณุชูุงุฏู ูโฺฉูุฏ ู ุงูููุช ุจุงูุงุชุฑ ูุณุจุช ุจู ALC ูุฑุงุฎูุงููุฏู ุฏุงุฑุฏ:</p>
<pre class="hljs"><code>Method1();
<span class="hljs-keyword">var</span> myALC = <span class="hljs-keyword">new</span> AssemblyLoadContext(<span class="hljs-string">&quot;test&quot;</span>);
<span class="hljs-keyword">using</span> (myALC.EnterContextualReflection())
{
    Console.WriteLine(
        AssemblyLoadContext.CurrentContextualReflectionContext.Name);  <span class="hljs-comment">// test</span>
    Method2();
}
<span class="hljs-comment">// ูพุณ ุงุฒ Disposeุ EnterContextualReflection ุฏฺฏุฑ ุงุซุฑ ูุฏุงุฑุฏ</span>
Method3();

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Method1</span>()</span> =&gt; Assembly.Load(<span class="hljs-string">&quot;...&quot;</span>); <span class="hljs-comment">// ุงุฒ ALC ูุฑุงุฎูุงููุฏู ุงุณุชูุงุฏู ูโฺฉูุฏ</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Method2</span>()</span> =&gt; Assembly.Load(<span class="hljs-string">&quot;...&quot;</span>); <span class="hljs-comment">// ุงุฒ myALC ุงุณุชูุงุฏู ูโฺฉูุฏ</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Method3</span>()</span> =&gt; Assembly.Load(<span class="hljs-string">&quot;...&quot;</span>); <span class="hljs-comment">// ุงุฒ ALC ูุฑุงุฎูุงููุฏู ุงุณุชูุงุฏู ูโฺฉูุฏ</span>
</code></pre>
<hr>
<p>ูุจูุงู ูุดุงู ุฏุงุฏู ฺฺฏููู ูโุชูุงู ฺฉ ูุชุฏ ูุดุงุจู Assembly.Load ููุดุช.<br>
ูุณุฎูโุง ุฏููโุชุฑ ฺฉู <strong>contextual reflection</strong> ุฑุง ูู ุฏุฑ ูุธุฑ ูโฺฏุฑุฏุ ฺูู ุงุณุช:</p>
<pre class="hljs"><code>[<span class="hljs-meta">MethodImpl(MethodImplOptions.NoInlining)</span>]
<span class="hljs-function">Assembly <span class="hljs-title">Load</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> name</span>)</span>
{
    <span class="hljs-keyword">var</span> alc = AssemblyLoadContext.CurrentContextualReflectionContext
              ?? AssemblyLoadContext.GetLoadContext(Assembly.GetCallingAssembly());
    <span class="hljs-keyword">return</span> alc.LoadFromAssemblyName(<span class="hljs-keyword">new</span> AssemblyName(name));
}
</code></pre>
<p>ูุฑฺูุฏ contextual reflection ุจุฑุง ุงุฌุฑุง ฺฉุฏ legacy ููุฏ ุงุณุชุ <strong>ุฑุงู ุญู ููุงููโุชุฑ</strong> ููุงู ุงุณุช ฺฉู ูุจูุงู ฺฏูุชู: ฺฉุฏ ูุฑุงุฎูุงููุฏู ุฑุง ุชุบุฑ ุฏูุฏ ุชุง <strong>LoadFromAssemblyName</strong> ุฑู ALC ูุดุฎุตโุดุฏู ุชูุณุท caller ูุฑุงุฎูุงู ุดูุฏ.</p>
<blockquote>
<p>ุฏุฑ .NET Framework ูฺ ูุนุงุฏู ุจุฑุง EnterContextualReflection ูุฌูุฏ ูุฏุงุฑุฏ ู ูุงุฒ ูู ูุณุชุ ฺูู ุงุฒูููโุณุงุฒ ุงุณุงุณุงู ุจุง <strong>application domain</strong> ุงูุฌุงู ูโุดูุฏุ ฺฉู ูุฑ domain ุฎูุฏุด ฺฉ default load context ุฏุงุฑุฏ ู ุจูุงุจุฑุงู ุงุฒูููโุณุงุฒ ุญุช ุจุง ุงุณุชูุงุฏู ุงุฒ ALC ูพุดโูุฑุถ ูู ุงูฺฉุงูโูพุฐุฑ ุงุณุช.</p>
</blockquote>
<h3>๐น ุจุงุฑฺฏุฐุงุฑ ู ุญู ูุงุจุณุชฺฏ ฺฉุชุงุจุฎุงููโูุง unmanaged ๐๏ธ</h3>
<p>ALCูุง ูโุชูุงููุฏ <strong>ฺฉุชุงุจุฎุงููโูุง native</strong> ุฑุง ูุฒ ุจุงุฑฺฏุฐุงุฑ ู ุญู ฺฉููุฏ.<br>
ุญู ูุงุจุณุชฺฏ native ุฒูุงู ุงุชูุงู ูโุงูุชุฏ ฺฉู ุดูุง ูุชุฏ ุฎุงุฑุฌ ุฑุง ูุฑุงุฎูุงู ฺฉูุฏ ฺฉู ุจุง ุตูุช <code>[DllImport]</code> ูุดุฎุต ุดุฏู ุงุณุช:</p>
<pre class="hljs"><code>[<span class="hljs-meta">DllImport(<span class="hljs-string">&quot;SomeNativeLibrary.dll&quot;</span>)</span>]
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">extern</span> <span class="hljs-built_in">int</span> <span class="hljs-title">SomeNativeMethod</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> text</span>)</span>;
</code></pre>
<p>ฺูู ุฏุฑ <code>[DllImport]</code> ูุณุฑ ฺฉุงูู ูุดุฎุต ูุดุฏูุ ูุฑุงุฎูุงู <code>SomeNativeMethod</code> ุจุงุนุซ <strong>trigger ุดุฏู ุญู ูุงุจุณุชฺฏ ุฏุฑ ููุงู ALC</strong> ูโุดูุฏ ฺฉู ุงุณูุจู ุชุนุฑูโฺฉููุฏู <code>SomeNativeMethod</code> ุฏุฑ ุขู ูุฑุงุฑ ุฏุงุฑุฏ.</p>
<hr>
<h3>๐น ูุชุฏูุง ูุฑุชุจุท ุจุง ฺฉุชุงุจุฎุงููโูุง unmanaged</h3>
<ul>
<li>ูุชุฏ <strong>virtual resolving</strong> ุฏุฑ ALC: <code>LoadUnmanagedDll</code></li>
<li>ูุชุฏ <strong>ุจุงุฑฺฏุฐุงุฑ</strong>: <code>LoadUnmanagedDllFromPath</code></li>
</ul>
<p>ูุซุงู:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> IntPtr <span class="hljs-title">LoadUnmanagedDll</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> unmanagedDllName</span>)</span>
{
    <span class="hljs-comment">// ูุณุฑ ฺฉุงูู unmanagedDllName ุฑุง ูพุฏุง ฺฉูุฏ...</span>
    <span class="hljs-built_in">string</span> fullPath = ...;
    <span class="hljs-keyword">return</span> LoadUnmanagedDllFromPath(fullPath); <span class="hljs-comment">// ุจุงุฑฺฏุฐุงุฑ DLL</span>
}
</code></pre>
<p>ุงฺฏุฑ ูุชูุงูุฏ ูุงู ุฑุง ูพุฏุง ฺฉูุฏุ ูโุชูุงูุฏ <code>IntPtr.Zero</code> ุจุฑฺฏุฑุฏุงูุฏ. ุฏุฑ ุงู ุตูุฑุช CLR ุฑูุฏุงุฏ <code>ResolvingUnmanagedDll</code> ุฑุง ุฏุฑ ALC ูุนุงู ูโฺฉูุฏ.</p>
<hr>
<h3>๐น ูฺฉุชู ุฌุงูุจ</h3>
<p>ูุชุฏ <code>LoadUnmanagedDllFromPath</code> <strong>protected</strong> ุงุณุชุ ุจูุงุจุฑุงู ูุนูููุงู ููโุชูุงูุฏ ุงุฒ handler ุฑูุฏุงุฏ <code>ResolvingUnmanagedDll</code> ูุณุชููุงู ุขู ุฑุง ูุฑุงุฎูุงู ฺฉูุฏ.<br>
ุจุง ุงู ุญุงูุ ูโุชูุงูุฏ ููุงู ูุชุฌู ุฑุง ุจุง <strong><code>NativeLibrary.Load</code></strong> ุงุณุชุงุชฺฉ ุจู ุฏุณุช ุขูุฑุฏ:</p>
<pre class="hljs"><code>someALC.ResolvingUnmanagedDll += (requestingAssembly, unmanagedDllName) =&gt;
{
    <span class="hljs-keyword">return</span> NativeLibrary.Load(<span class="hljs-string">&quot;(full path to unmanaged DLL)&quot;</span>);
};
</code></pre>
<blockquote>
<p>ฺฉุชุงุจุฎุงููโูุง native ูุนูููุงู ุชูุณุท ALC ุญู ู ุจุงุฑฺฏุฐุงุฑ ูโุดููุฏุ ุงูุง ูุชุนูู ุจู ALC ูุณุชูุฏ.<br>
ูพุณ ุงุฒ ุจุงุฑฺฏุฐุงุฑุ ูุฑ ฺฉุชุงุจุฎุงูู native ูุณุชูู ุงุณุช ู ูุณุฆูู ุญู ูุงุจุณุชฺฏโูุง transitve ุฎูุฏ ุงุณุช.<br>
ููฺูู ฺฉุชุงุจุฎุงููโูุง native ุจุฑุง ฺฉู <strong>process</strong> ุฌูุงู ูุณุชูุฏุ ุจูุงุจุฑุงู ููโุชูุงู ุฏู ูุณุฎู ูุชูุงูุช ุจุง ููุงู ูุงู ูุงู ุฑุง ุจุงุฑฺฏุฐุงุฑ ฺฉุฑุฏ.</p>
</blockquote>
<hr>
<h3>๐น AssemblyDependencyResolver ๐ฆ</h3>
<p>ุฏุฑ ุจุฎุด <strong>Default probing</strong> ฺฏูุชู ฺฉู ALC ูพุดโูุฑุถ ุจุฑุง ุญู ูุงุจุณุชฺฏโูุง <strong>platform-specific</strong> ู <strong>NuGet ุฒูุงู ุชูุณุนู</strong>ุ ูุงูโูุง <code>.deps.json</code> ู <code>.runtimeconfig.json</code> ุฑุง ุจุฑุฑุณ ูโฺฉูุฏ.</p>
<p>ุงฺฏุฑ ุจุฎูุงูุฏ ฺฉ ุงุณูุจู ุฑุง ุฏุฑ <strong>ALC ุณูุงุฑุด</strong> ุจุง ูุงุจุณุชฺฏโูุง platform-specific ุง NuGet ุจุงุฑฺฏุฐุงุฑ ฺฉูุฏุ ุจุงุฏ ุงู ููุทู ุฑุง ุจุงุฒุชููุฏ ฺฉูุฏ.<br>
ูโุชูุงูุณุชุฏ ุงู ฺฉุงุฑ ุฑุง ุจุง ูพุงุฑุณ ฺฉุฑุฏู ูุงูโูุง ุงูุฌุงู ุฏูุฏุ ุงูุง ูู ุณุฎุช ุงุณุช ู ูู ุงฺฏุฑ ููุงูู ุฏุฑ ูุณุฎู ุจุนุฏ .NET ุชุบุฑ ฺฉููุฏุ ฺฉุฏ ุดูุง ุฎุฑุงุจ ูโุดูุฏ.</p>
<p><strong>AssemblyDependencyResolver</strong> ุงู ูุดฺฉู ุฑุง ุญู ูโฺฉูุฏ.<br>
ุงุจุชุฏุง ุขู ุฑุง ุจุง ูุณุฑ ุงุณูุจู ููุฑุฏ ูุธุฑ ุจุฑุง ุจุฑุฑุณ ูุงุจุณุชฺฏโูุง ูููููโุณุงุฒ ูโฺฉูู:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> resolver = <span class="hljs-keyword">new</span> AssemblyDependencyResolver(<span class="hljs-string">@&quot;c:\temp\foo.dll&quot;</span>);
</code></pre>
<p>ุณูพุณ ุจุฑุง ูพุฏุง ฺฉุฑุฏู ูุณุฑ ฺฉ ูุงุจุณุชฺฏุ ูุชุฏ <code>ResolveAssemblyToPath</code> ุฑุง ูุฑุงุฎูุงู ูโฺฉูู:</p>
<pre class="hljs"><code><span class="hljs-built_in">string</span> path = resolver.ResolveAssemblyToPath(<span class="hljs-keyword">new</span> AssemblyName(<span class="hljs-string">&quot;bar&quot;</span>));
</code></pre>
<p>ุงฺฏุฑ <code>.deps.json</code> ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏ ุง ุดุงูู ุงุทูุงุนุงุช ุฏุฑุจุงุฑู <code>bar.dll</code> ูุจุงุดุฏุ ูุณุฑ ุจู ุตูุฑุช ูพุดโูุฑุถ ุจู <code>c:\temp\bar.dll</code> ุงุฑุฒุงุจ ูโุดูุฏ.</p>
<p>ููู ฺฉุงุฑ ุจุฑุง ูุงุจุณุชฺฏโูุง unmanaged ูุฒ ุจุง <code>ResolveUnmanagedDllToPath</code> ุงูฺฉุงูโูพุฐุฑ ุงุณุช.</p>
<hr>
<h3>๐น ูุซุงู ุนูู ุจุง NuGet</h3>
<ol>
<li>ฺฉ ูพุฑูฺู Console ุจู ูุงู <code>ClientApp</code> ุจุณุงุฒุฏ.</li>
<li>ฺฉ reference ุจู <code>Microsoft.Data.SqlClient</code> ุงุถุงูู ฺฉูุฏ.</li>
<li>ฺฉูุงุณ ุฒุฑ ุฑุง ุงุถุงูู ฺฉูุฏ:</li>
</ol>
<pre class="hljs"><code><span class="hljs-keyword">using</span> Microsoft.Data.SqlClient;

<span class="hljs-keyword">namespace</span> <span class="hljs-title">ClientApp</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
    {
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> SqlConnection <span class="hljs-title">GetConnection</span>()</span> =&gt; <span class="hljs-keyword">new</span> SqlConnection();
        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>()</span> =&gt; GetConnection(); <span class="hljs-comment">// ุชุณุช ฺฉู resolve ูโุดูุฏ</span>
    }
}
</code></pre>
<p>ุงฺฏุฑ ุจุฑูุงูู ุฑุง ุจุณุงุฒุฏ ู ุฏุฑ ูพูุดู ุฎุฑูุฌ ูฺฏุงู ฺฉูุฏุ ูุงู <code>Microsoft.Data.SqlClient.dll</code> ูุฌูุฏ ุฏุงุฑุฏ.<br>
ุงูุง ุงู ูุงู ููฺฏุงู ุงุฌุฑุง ุจุงุฑฺฏุฐุงุฑ ููโุดูุฏ ู ุชูุงุด ุจุฑุง ุจุงุฑฺฏุฐุงุฑ ุตุฑุญ ุขู ุจุงุนุซ Exception ูโุดูุฏ.<br>
assembly ูุงูุน ุฏุฑ ุฒุฑูพูุดู <code>runtimes\win</code> (ุง <code>runtimes/unix</code>) ูุฑุงุฑ ุฏุงุฑุฏ ู <strong>ALC ูพุดโูุฑุถ ุจุง parsing ูุงู <code>ClientApp.deps.json</code> ุขู ุฑุง ุจุงุฑฺฏุฐุงุฑ ูโฺฉูุฏ</strong>.</p>
<hr>
<p>ุงฺฏุฑ ุจุฎูุงูุฏ <code>ClientApp.dll</code> ุฑุง ุงุฒ ุจุฑูุงูู ุฏฺฏุฑ ุจุงุฑฺฏุฐุงุฑ ฺฉูุฏุ ูุงุฒ ุจู ฺฉ <strong>ALC ุณูุงุฑุด</strong> ุฏุงุฑุฏ ฺฉู ูุงุจุณุชฺฏ ุขู ุนู <code>Microsoft.Data.SqlClient.dll</code> ุฑุง ุญู ฺฉูุฏ.<br>
ฺฉุงู ูุณุช ููุท ูพูุดู <code>ClientApp.dll</code> ุฑุง ุจุฑุฑุณ ฺฉูุฏุ ุจูฺฉู ุจุงุฏ <strong>AssemblyDependencyResolver</strong> ูุณุฑ ุฏูู ูุงู ุฑุง ุจุฑุง ูพูุชูุฑู ูุนู ูพุฏุง ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-built_in">string</span> path = <span class="hljs-string">@&quot;C:\source\ClientApp\bin\Debug\netcoreapp3.0\ClientApp.dll&quot;</span>;
<span class="hljs-keyword">var</span> resolver = <span class="hljs-keyword">new</span> AssemblyDependencyResolver(path);
<span class="hljs-keyword">var</span> sqlClient = <span class="hljs-keyword">new</span> AssemblyName(<span class="hljs-string">&quot;Microsoft.Data.SqlClient&quot;</span>);
Console.WriteLine(resolver.ResolveAssemblyToPath(sqlClient));
</code></pre>
<p>ุฎุฑูุฌ ุฏุฑ ููุฏูุฒ ูุนูููุงู ฺูู ุงุณุช:</p>
<pre class="hljs"><code>C:\source\ClientApp\bin\Debug\netcoreapp3.0\runtimes\win\lib\netcoreapp2.1\Microsoft.Data.SqlClient.dll
</code></pre>
<blockquote>
<p>ฺฉ ูุซุงู ฺฉุงูู ุฏุฑ ุจุฎุด <strong>Writing a Plug-In System</strong> ุฏุฑ ุตูุญู 799 ุงุฑุงุฆู ุดุฏู ุงุณุช.</p>
</blockquote>
<h3>๐น ุฎุงุฑุฌ ฺฉุฑุฏู ALCูุง ุงุฒ ุญุงูุธู ู ุขุฒุงุฏุณุงุฒ ููุงุจุน ๐๏ธ</h3>
<p>ุฏุฑ ููุงุฑุฏ ุณุงุฏูุ ูโุชูุงู ฺฉ <strong>AssemblyLoadContext ุบุฑ ูพุดโูุฑุถ</strong> ุฑุง ุงุฒ ุญุงูุธู ุฎุงุฑุฌ ฺฉุฑุฏ ุชุง ูู ุญุงูุธู ุขุฒุงุฏ ุดูุฏ ู ูู ููู ูุงูโูุง ุจุงุฑฺฏุฐุงุฑโุดุฏู ุฑูุน ุดูุฏ.<br>
ุจุฑุง ุงู ฺฉุงุฑุ ููฺฏุงู ุงุฌุงุฏ ALC ุจุงุฏ <strong>ูพุงุฑุงูุชุฑ <code>isCollectible</code> ุฑุง true</strong> ูุฑุงุฑ ุฏูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> alc = <span class="hljs-keyword">new</span> AssemblyLoadContext(<span class="hljs-string">&quot;test&quot;</span>, isCollectible: <span class="hljs-literal">true</span>);
</code></pre>
<p>ุณูพุณ ูโุชูุงูุฏ ูุชุฏ <code>Unload</code> ุฑุง ูุฑุงุฎูุงู ฺฉูุฏ ุชุง ูุฑุขูุฏ unload ุขุบุงุฒ ุดูุฏ.</p>
<blockquote>
<p>ูุฏู unload ุจู ุตูุฑุช <strong>ููฺฉุงุฑ (cooperative)</strong> ุงุณุชุ ูู ุงุฌุจุงุฑ (preemptive).<br>
ุงฺฏุฑ ูุฑ ูุชุฏ ุฏุฑ ูุฑ ุงุณูุจู ALC ุฏุฑ ุญุงู ุงุฌุฑุง ุจุงุดุฏุ unload ุชุง ูพุงุงู ุงุฌุฑุง ุขู ูุชุฏูุง ุจู ุชุนูู ูโุงูุชุฏ.</p>
</blockquote>
<p>ุจุงุฑฺฏุฐุงุฑ ูุงูุน ููฺฏุงู <strong>garbage collection</strong> ุงุชูุงู ูโุงูุชุฏ.<br>
ุงฺฏุฑ ฺุฒ ุฎุงุฑุฌ ุงุฒ ALC ุจู ูุฑ ุดุก ุฏุงุฎู ALC (ุดุงูู objectูุงุ typeูุง ุง assemblyูุง) ุงุฑุฌุงุน ุบุฑ-weak ุฏุงุดุชู ุจุงุดุฏุ unload ุงูุฌุงู ููโุดูุฏ.</p>
<blockquote>
<p>ูฺฉุชู: ุจุฑุฎ APIูุง (ุญุช ุฏุฑ .NET BCL) ููฺฉู ุงุณุช objectูุง ุฑุง ุฏุฑ <strong>ููุฏูุง static ุง ุฏฺฉุดูุฑโูุง cache</strong> ฺฉููุฏ ุง ุจู eventูุง subscribe ุดููุฏ. ุงู ูโุชูุงูุฏ ููุงูุน ุจุฑุง unload ุงุฌุงุฏ ฺฉูุฏุ ูุฎุตูุตุงู ุงฺฏุฑ ฺฉุฏ ุฏุงุฎู ALC ุงุฒ APIูุง ุฎุงุฑุฌ ุงุฒ ALC ุจู ุตูุฑุช ูพฺุฏู ุงุณุชูุงุฏู ฺฉูุฏ.<br>
ุนูุช failure ุฏุฑ unload ูุนูููุงู ุณุฎุช ุงุณุช ู ูุงุฒ ุจู ุงุจุฒุงุฑูุง ูุซู WinDbg ุฏุงุฑุฏ.</p>
</blockquote>
<hr>
<h3>๐น ูุชุฏูุง Legacy ุจุฑุง ุจุงุฑฺฏุฐุงุฑ ๐</h3>
<p>ุงฺฏุฑ ูููุฒ ุงุฒ <strong>.NET Framework</strong> ุงุณุชูุงุฏู ูโฺฉูุฏ ุง ูุงุจุฑ ูโููุณุฏ ฺฉู ุจุงุฏ ุจุง .NET Framework ุณุงุฒฺฏุงุฑ ุจุงุดุฏุ ููโุชูุงูุฏ ุงุฒ <strong>AssemblyLoadContext</strong> ุงุณุชูุงุฏู ฺฉูุฏ.<br>
ุจุงุฑฺฏุฐุงุฑ ุจุง ูุชุฏูุง ุฒุฑ ุงูุฌุงู ูโุดูุฏ:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Assembly <span class="hljs-title">LoadFrom</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> assemblyFile</span>)</span>;
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Assembly <span class="hljs-title">LoadFile</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path</span>)</span>;
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Assembly <span class="hljs-title">Load</span>(<span class="hljs-params"><span class="hljs-built_in">byte</span>[] rawAssembly</span>)</span>;
</code></pre>
<ul>
<li><code>LoadFile</code> ู <code>Load(byte[])</code> ุงุฒูููโุณุงุฒ ุงุฑุงุฆู ูโุฏููุฏ.</li>
<li><code>LoadFrom</code> ฺูู ุงุฒูููโุณุงุฒ ูุฏุงุฑุฏ.</li>
</ul>
<p>ุญู ูุงุจุณุชฺฏโูุง ุจุง <strong>ุฑูุฏุงุฏ AssemblyResolve</strong> ุฏุฑ AppDomain ุงูุฌุงู ูโุดูุฏุ ูุดุงุจู ุฑูุฏุงุฏ <code>Resolving</code> ุฏุฑ ALC ูพุดโูุฑุถ.<br>
ูุชุฏ <code>Assembly.Load(string)</code> ูุฒ ุจุฑุง trigger ฺฉุฑุฏู resolution ุฏุฑ ุฏุณุชุฑุณ ุงุณุช ู ูุดุงุจู ุนูู ูโฺฉูุฏ.</p>
<hr>
<h3>๐น LoadFrom</h3>
<ul>
<li>ุงุณูุจู ุฑุง ุงุฒ ูุณุฑ ูุดุฎุต ุดุฏู ุฏุฑ <strong>default ALC</strong> ุจุงุฑฺฏุฐุงุฑ ูโฺฉูุฏ.</li>
<li>ูุดุงุจู <code>AssemblyLoadContext.Default.LoadFromAssemblyPath</code> ุงุณุชุ ุจุง ุชูุงูุชโูุง ุฒุฑ:</li>
</ul>
<ol>
<li>
<p>ุงฺฏุฑ ุงุณูุจู ุจุง ููุงู <strong>simple name</strong> ูุจูุงู ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏุ <code>LoadFrom</code> ููุงู ุงุณูุจู ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ ู Exception ููโุฏูุฏ.</p>
</li>
<li>
<p>ุงฺฏุฑ ุงุณูุจู ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏ ู ุจุงุฑฺฏุฐุงุฑ ุตูุฑุช ฺฏุฑุฏุ ุจู ุขู ูุถุนุช ูฺูโุง ุจู ูุงู <strong>LoadFrom</strong> ุฏุงุฏู ูโุดูุฏ.</p>
<ul>
<li>ุงู ูุถุนุช ุฑู ููุทู resolution ALC ูพุดโูุฑุถ ุงุซุฑ ูโฺฏุฐุงุฑุฏ ู ุงฺฏุฑ ุงุณูุจู ูุงุจุณุชฺฏโูุง ุฏุฑ ููุงู ูพูุดู ุฏุงุดุชู ุจุงุดุฏุ ุขูโูุง ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุญู ูโุดููุฏ.</li>
</ul>
</li>
</ol>
<blockquote>
<p>ุฏุฑ .NET Frameworkุ ุงฺฏุฑ ุงุณูุจู ุฏุฑ <strong>Global Assembly Cache (GAC)</strong> ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏุ CLR ููุดู ุงุฒ ุขูุฌุง ุจุงุฑฺฏุฐุงุฑ ูโฺฉูุฏ. ุงู ูุงููู ุจุฑุง ูุฑ ุณู ุฑูุด ุจุงุฑฺฏุฐุงุฑ ุตุฏู ูโฺฉูุฏ.</p>
</blockquote>
<p>ูุฒุช <code>LoadFrom</code> ุงู ุงุณุช ฺฉู ูุงุจุณุชฺฏโูุง transitve ุฏุฑ ููุงู ูพูุดู ุฑุง ุฎูุฏฺฉุงุฑ ุญู ูโฺฉูุฏุ ุงูุง ููฺฉู ุงุณุช assembly ูุงุฏุฑุณุช ุจุงุฑฺฏุฐุงุฑ ุดูุฏ.<br>
ุจุฑุง ฺฉูุชุฑู ุจูุชุฑุ ุจูุชุฑ ุงุณุช ุงุฒ <code>Load(string)</code> ุง <code>LoadFile</code> ุงุณุชูุงุฏู ฺฉูุฏ ู ูุงุจุณุชฺฏโูุง ุฑุง ุจุง <strong>AssemblyResolve</strong> ุญู ฺฉูุฏ.</p>
<hr>
<h3>๐น LoadFile ู Load(byte[])</h3>
<ul>
<li>ุงู ูุชุฏูุง ุงุณูุจู ุฑุง ุงุฒ ูุณุฑ ูุงู ุง ุขุฑุงู ุจุงุช ุฏุฑ <strong>ALC ุฌุฏุฏ</strong> ุจุงุฑฺฏุฐุงุฑ ูโฺฉููุฏ.</li>
<li>ุจุฑุฎูุงู <code>LoadFrom</code>ุ ุงุฒูููโุณุงุฒ ุงุฑุงุฆู ูโุฏููุฏ ู ูโุชูุงู ฺูุฏ ูุณุฎู ุงุฒ ููุงู ุงุณูุจู ุฑุง ุจุงุฑฺฏุฐุงุฑ ฺฉุฑุฏ.</li>
</ul>
<blockquote>
<p>ุฏู ูฺฉุชู ููู:</p>
</blockquote>
<ol>
<li>ูุฑุงุฎูุงู ุฏูุจุงุฑู <code>LoadFile</code> ุจุง ููุงู ูุณุฑุ ููุงู ุงุณูุจู ูุจู ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ.</li>
<li>ุฏุฑ .NET Frameworkุ ูุฑ ุฏู ุงุจุชุฏุง GAC ุฑุง ุจุฑุฑุณ ูโฺฉููุฏ ู ุงฺฏุฑ ููุฌูุฏ ุจุงุดุฏุ ุงุฒ ุขูุฌุง ุจุงุฑฺฏุฐุงุฑ ูโฺฉููุฏ.</li>
</ol>
<p>ุจุง <code>LoadFile</code> ุง <code>Load(byte[])</code>ุ ูุฑ ุงุณูุจู ฺฉ ALC ุฌุฏุงฺฏุงูู ุฏุงุฑุฏ. ุงู ุจุงุนุซ ุงุฒูููโุณุงุฒ ูโุดูุฏุ ุงูุง ูุฏุฑุช ุขู ฺฉู ูพฺุฏูโุชุฑ ุงุณุช.</p>
<p>ุจุฑุง ุญู ูุงุจุณุชฺฏโูุงุ ุฑูุฏุงุฏ <strong>AppDomain.CurrentDomain.AssemblyResolve</strong> ุฑุง ูุฏุฑุช ฺฉูุฏ:</p>
<pre class="hljs"><code>AppDomain.CurrentDomain.AssemblyResolve += (sender, <span class="hljs-keyword">args</span>) =&gt;
{
    <span class="hljs-built_in">string</span> fullAssemblyName = <span class="hljs-keyword">args</span>.Name;
    <span class="hljs-comment">// ฺฉ Assembly ุจุงุฒฺฏุฑุฏุงูุฏ ุง null</span>
    ...
};
</code></pre>
<blockquote>
<p><code>args</code> ุดุงูู property ุง ุจู ูุงู <code>RequestingAssembly</code> ูุฒ ูุณุช ฺฉู ูุดุฎุต ูโฺฉูุฏ ฺฉุฏุงู ุงุณูุจู trigger ฺฉููุฏู resolution ุจูุฏู ุงุณุช.</p>
</blockquote>
<p>ูพุณ ุงุฒ ุงูุชู ุงุณูุจูุ ูโุชูุงูุฏ ุจุง <code>Assembly.LoadFile</code> ุขู ุฑุง ุจุงุฑฺฏุฐุงุฑ ฺฉูุฏ.<br>
ููฺูู ูโุชูุงูุฏ ุชูุงู assemblyูุง ุจุงุฑฺฏุฐุงุฑ ุดุฏู ุฏุฑ AppDomain ูุนู ุฑุง ุจุง <code>AppDomain.CurrentDomain.GetAssemblies()</code> ููุฑุณุช ฺฉูุฏ.<br>
ุงู ุฑูุด ุฏุฑ .NET 5+ ูุฒ ฺฉุงุฑ ูโฺฉูุฏ ู ูุนุงุฏู ุงุณุช ุจุง:</p>
<pre class="hljs"><code>AssemblyLoadContext.All.SelectMany(a =&gt; a.Assemblies)
</code></pre>
<h3>๐น ููุดุชู ฺฉ ุณุณุชู ูพูุงฺฏู ุจุง ALCูุง ูุงุจู ุฎุงุฑุฌโุณุงุฒ ๐งฉ</h3>
<p>ุจุฑุง ูุดุงู ุฏุงุฏู ฺฉุงูู ููุงูู ฺฉู ุฏุฑ ุงู ุจุฎุด ุจุฑุฑุณ ฺฉุฑุฏูุ ุจุงุฏ ฺฉ <strong>ุณุณุชู ูพูุงฺฏู</strong> ุจุณุงุฒู ฺฉู ุงุฒ <strong>ALCูุง ูุงุจู unload</strong> ุงุณุชูุงุฏู ูโฺฉูุฏ ุชุง ูุฑ ูพูุงฺฏู ุจู ุตูุฑุช ุงุฒููู ุงุฌุฑุง ุดูุฏ.</p>
<p>ุณุณุชู ููููู ูุง ุดุงูู ุณู ูพุฑูฺู .NET ุฎูุงูุฏ ุจูุฏ:</p>
<table>
<thead>
<tr>
<th>ูพุฑูฺู</th>
<th>ููุน</th>
<th>ุชูุถุญ</th>
</tr>
</thead>
<tbody>
<tr>
<td>Plugin.Common</td>
<td>ฺฉุชุงุจุฎุงูู (Library)</td>
<td>ุชุนุฑู ฺฉ <strong>interface</strong> ฺฉู ูพูุงฺฏูโูุง ุขู ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉููุฏ</td>
</tr>
<tr>
<td>Capitalizer</td>
<td>ฺฉุชุงุจุฎุงูู (Library)</td>
<td>ฺฉ ูพูุงฺฏู ฺฉู ูุชู ุฑุง <strong>ุจู ุญุฑูู ุจุฒุฑฺฏ</strong> ุชุจุฏู ูโฺฉูุฏ</td>
</tr>
<tr>
<td>Plugin.Host</td>
<td>ุงูพูฺฉุดู Console</td>
<td>ูพุฏุง ฺฉุฑุฏู ู ุงุฌุฑุง ูพูุงฺฏูโูุง</td>
</tr>
</tbody>
</table>
<p>ูุฑุถ ฺฉูุฏ ูพุฑูฺูโูุง ุฏุฑ ูุณุฑูุง ุฒุฑ ูุฑุงุฑ ุฏุงุฑูุฏ:</p>
<pre class="hljs"><code>c:\source\PluginDemo\Plugin.Common
c:\source\PluginDemo\Capitalizer
c:\source\PluginDemo\Plugin.Host
</code></pre>
<p>ุชูุงู ูพุฑูฺูโูุง ุจู <strong>Plugin.Common</strong> ุงุฑุฌุงุน ูโุฏููุฏ ู ูฺ ุงุฑุฌุงุน ุจู ูพุฑูฺูโูุง ุฏฺฏุฑ ูุฌูุฏ ูุฏุงุฑุฏ.</p>
<hr>
<h3>๐น Plugin.Common</h3>
<p>ุงฺฏุฑ <strong>Plugin.Host</strong> ุจู <strong>Capitalizer</strong> ุงุฑุฌุงุน ูโุฏุงุฏุ ุฏฺฏุฑ ฺฉ ุณุณุชู ูพูุงฺฏู ูุงูุน ูุจูุฏุ ุงุฏู ุงุตู ุงู ุงุณุช ฺฉู ูพูุงฺฏูโูุง ุชูุณุท <strong>ุณููโุดุฎุตโูุง</strong> ูพุณ ุงุฒ ุงูุชุดุงุฑ <strong>Plugin.Host</strong> ู <strong>Plugin.Common</strong> ููุดุชู ุดููุฏ.</p>
<blockquote>
<p>ุงฺฏุฑ ุงุฒ Visual Studio ุงุณุชูุงุฏู ูโฺฉูุฏุ ูโุชูุงูุฏ ุชูุงู ุณู ูพุฑูฺู ุฑุง ุฏุฑ ฺฉ <strong>solution</strong> ูุฑุงุฑ ุฏูุฏ ุชุง ูุฏุฑุช ุณุงุฎุช ุฑุงุญุชโุชุฑ ุดูุฏ.<br>
ุณูพุณ ุฑู ูพุฑูฺู Plugin.Host ุฑุงุณุชโฺฉูฺฉ ฺฉูุฏุ ูุณุฑ <strong>Build Dependencies &gt; Project Dependencies</strong> ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ ู ูพุฑูฺู Capitalizer ุฑุง ุชฺฉ ุจุฒูุฏ. ุงู ุจุงุนุซ ูโุดูุฏ Capitalizer ููฺฏุงู ุณุงุฎุช Plugin.Host ุณุงุฎุชู ุดูุฏุ ุจุฏูู ูุงุฒ ุจู ุงูุฒูุฏู ุงุฑุฌุงุน.</p>
</blockquote>
<p>ุฏุฑ <strong>Plugin.Common</strong>ุ ูพูุงฺฏูโูุง ฺฉ ูุธูู ุจุณุงุฑ ุณุงุฏู ุฏุงุฑูุฏ: <strong>ุชุบุฑ ฺฉ ุฑุดุชู ูุชู</strong>.<br>
ุงู interface ุจู ุดฺฉู ุฒุฑ ุชุนุฑู ูโุดูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">namespace</span> <span class="hljs-title">Plugin.Common</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">ITextPlugin</span>
    {
        <span class="hljs-function"><span class="hljs-built_in">string</span> <span class="hljs-title">TransformText</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> input</span>)</span>;
    }
}
</code></pre>
<p>ููู ฺฉุงู ุงุณุช ุจุฑุง Plugin.Common.</p>
<hr>
<h3>๐น Capitalizer (ูพูุงฺฏู)</h3>
<p>ูพูุงฺฏู <strong>Capitalizer</strong> ุจู <strong>Plugin.Common</strong> ุงุฑุฌุงุน ูโุฏูุฏ ู ฺฉ ฺฉูุงุณ ุฏุงุฑุฏ.<br>
ุจุฑุง ุณุงุฏู ูฺฏู ุฏุงุดุชูุ ูฺ ูุงุจุณุชฺฏ ุงุถุงู ูุฏุงุฑุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">CapitalizerPlugin</span> : <span class="hljs-title">Plugin.Common.ITextPlugin</span>
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> <span class="hljs-title">TransformText</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> input</span>)</span> =&gt; input.ToUpper();
}
</code></pre>
<p>ุงฺฏุฑ ูุฑ ุฏู ูพุฑูฺู ุฑุง ุจุณุงุฒุฏ ู ุจู ูพูุดู ุฎุฑูุฌ <strong>Capitalizer</strong> ูฺฏุงู ฺฉูุฏุ ุฏู ุงุณูุจู ุฒุฑ ุฑุง ุฎูุงูุฏ ุฏุฏ:</p>
<pre class="hljs"><code>Capitalizer.dll      // ุงุณูุจู ูพูุงฺฏู ูุง
Plugin.Common.dll    // ุงุณูุจู ุงุฑุฌุงุน ุฏุงุฏู ุดุฏู
</code></pre>
<h3>๐น Plugin.Host ๐ฅ๏ธ</h3>
<p><strong>Plugin.Host</strong> ฺฉ ุงูพูฺฉุดู Console ุงุณุช ฺฉู ุดุงูู ุฏู ฺฉูุงุณ ุงุณุช.<br>
ฺฉูุงุณ ุงูู ฺฉ <strong>ALC ุณูุงุฑุด</strong> ุจุฑุง ุจุงุฑฺฏุฐุงุฑ ูพูุงฺฏูโูุง ุงุณุช:</p>
<pre class="hljs"><code><span class="hljs-keyword">class</span> <span class="hljs-title">PluginLoadContext</span> : <span class="hljs-title">AssemblyLoadContext</span>
{
    AssemblyDependencyResolver _resolver;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">PluginLoadContext</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> pluginPath, <span class="hljs-built_in">bool</span> collectible</span>)
        <span class="hljs-comment">// ูุงู ุฏูุณุชุงูู ุจุฑุง ฺฉูฺฉ ุจู ุฏุจุงฺฏ:</span>
        : <span class="hljs-title">base</span>(<span class="hljs-params">name: Path.GetFileName(pluginPath</span>), collectible)</span>
    {
        <span class="hljs-comment">// ุงุฌุงุฏ ฺฉ resolver ุจุฑุง ูพุฏุง ฺฉุฑุฏู ูุงุจุณุชฺฏโูุง</span>
        _resolver = <span class="hljs-keyword">new</span> AssemblyDependencyResolver(pluginPath);
    }

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> Assembly <span class="hljs-title">Load</span>(<span class="hljs-params">AssemblyName assemblyName</span>)</span>
    {
        <span class="hljs-comment">// ุจุฑุฑุณ ุงุณูุจู ูุดุชุฑฺฉ</span>
        <span class="hljs-keyword">if</span> (assemblyName.Name == <span class="hljs-keyword">typeof</span>(ITextPlugin).Assembly.GetName().Name)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

        <span class="hljs-built_in">string</span> target = _resolver.ResolveAssemblyToPath(assemblyName);
        <span class="hljs-keyword">if</span> (target != <span class="hljs-literal">null</span>)
            <span class="hljs-keyword">return</span> LoadFromAssemblyPath(target);

        <span class="hljs-comment">// ููฺฉู ุงุณุช ฺฉ ุงุณูุจู BCL ุจุงุดุฏ. ุงุฌุงุฒู ุจุฏูุฏ Default ALC ุขู ุฑุง ุญู ฺฉูุฏ</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> IntPtr <span class="hljs-title">LoadUnmanagedDll</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> unmanagedDllName</span>)</span>
    {
        <span class="hljs-built_in">string</span> path = _resolver.ResolveUnmanagedDllToPath(unmanagedDllName);
        <span class="hljs-keyword">return</span> path == <span class="hljs-literal">null</span>
            ? IntPtr.Zero
            : LoadUnmanagedDllFromPath(path);
    }
}
</code></pre>
<p>ุฏุฑ <strong>constructor</strong>ุ ูุณุฑ ุงุตู ุงุณูุจู ูพูุงฺฏู ู ฺฉ flag ุจุฑุง ุชุนู ุงูฺฉู ALC ูุงุจู unload ุจุงุดุฏ ุง ุฎุฑุ ุฏุฑุงูุช ูโุดูุฏ.</p>
<ul>
<li>ูุชุฏ <strong>Load</strong> ุฌุง ุงุณุช ฺฉู ูุงุจุณุชฺฏโูุง ูุฏุฑุช ูโุดููุฏ.</li>
<li>ุชูุงู ูพูุงฺฏูโูุง ุจุงุฏ ุจู <strong>Plugin.Common</strong> ุงุฑุฌุงุน ุฏููุฏ ุชุง ุจุชูุงููุฏ <strong>ITextPlugin</strong> ุฑุง ูพุงุฏูโุณุงุฒ ฺฉููุฏ.</li>
<li>ุจูุงุจุฑุงูุ Load ููฺฉู ุงุณุช ุจุฑุง ุญู Plugin.Common ูุฑุงุฎูุงู ุดูุฏ.</li>
<li>ุงฺฏุฑ ูุณุฎูโุง ุงุฒ Plugin.Common.dll ุฏุฑ ูพูุดู ุฎุฑูุฌ ูพูุงฺฏู ุจุงุดุฏ ู ูุง ุขู ุฑุง ุจุงุฑฺฏุฐุงุฑ ฺฉููุ ุฏู ูุณุฎู ุงุฒ ููุงู ุงุณูุจู ูุฌูุฏ ุฎูุงูุฏ ุฏุงุดุช: ฺฉ ุฏุฑ Default ALC ูุฒุจุงู ู ุฏฺฏุฑ ุฏุฑ PluginLoadContext ูพูุงฺฏู. ุงู ุจุงุนุซ ูุงุณุงุฒฺฏุงุฑ ู ุฎุทุง ูโุดูุฏ.</li>
</ul>
<p>ุจุฑุง ุญู ุงู ูุดฺฉูุ ุจุฑุฑุณ ูโฺฉูู:</p>
<pre class="hljs"><code><span class="hljs-keyword">if</span> (assemblyName.Name == <span class="hljs-keyword">typeof</span>(ITextPlugin).Assembly.GetName().Name)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
</code></pre>
<blockquote>
<p>ุจุงุฒฺฏุฑุฏุงูุฏู <strong>null</strong> ุจุงุนุซ ูโุดูุฏ Default ALC ูุฒุจุงูุ ุงุณูุจู ุฑุง ุญู ฺฉูุฏ.<br>
ูโุชูุงูุณุชู typeof(ITextPlugin).Assembly ุฑุง ูู ุจุฑฺฏุฑุฏุงูู ู ูุชุฌู ุฏุฑุณุช ุจูุฏ. ฺูู PluginLoadContext ุฏุฑ <strong>Plugin.Host</strong> ุชุนุฑู ุดุฏูุ ูุฑ ููุน ฺฉู ูุณุชููุงู ุงุฒ ุงู ฺฉูุงุณ ุงุฑุฌุงุน ุดูุฏุ ุฏุฑ Default ALC ูุฒุจุงู ุญู ูโุดูุฏ.</p>
</blockquote>
<p>ุณูพุณ ุงุฒ <strong>AssemblyDependencyResolver</strong> ุจุฑุง ูพุฏุง ฺฉุฑุฏู ูุฑ ูุงุจุณุชฺฏ ุฎุตูุต ูพูุงฺฏู ุงุณุชูุงุฏู ูโฺฉูู.<br>
ููฺูู <strong>LoadUnmanagedDll</strong> override ุดุฏู ุชุง ุงฺฏุฑ ูพูุงฺฏู ูุงุจุณุชฺฏ unmanaged ุฏุงุดุชู ุจุงุดุฏุ ุฏุฑุณุช ุจุงุฑฺฏุฐุงุฑ ุดูุฏ.</p>
<hr>
<h3>๐น ฺฉูุงุณ Program</h3>
<p>ุจุฑุง ุณุงุฏฺฏุ ูุณุฑ ูพูุงฺฏู Capitalizer ุจู ุตูุฑุช hardcode ุดุฏู ุงุณุช (ุฏุฑ ุนููุ ูุณุฑูุง ุฑุง ูโุชูุงู ุจุง ุฌุณุชุฌู DLLูุง ุง ุฎูุงูุฏู ูุงู ฺฉุงููฺฏ ูพุฏุง ฺฉุฑุฏ):</p>
<pre class="hljs"><code><span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
{
    <span class="hljs-keyword">const</span> <span class="hljs-built_in">bool</span> UseCollectibleContexts = <span class="hljs-literal">true</span>;

    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>()</span>
    {
        <span class="hljs-keyword">const</span> <span class="hljs-built_in">string</span> capitalizer = <span class="hljs-string">@&quot;C:\source\PluginDemo\Capitalizer\bin\Debug\netcoreapp3.0\Capitalizer.dll&quot;</span>;
        Console.WriteLine(TransformText(<span class="hljs-string">&quot;big apple&quot;</span>, capitalizer));
    }

    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-built_in">string</span> <span class="hljs-title">TransformText</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> text, <span class="hljs-built_in">string</span> pluginPath</span>)</span>
    {
        <span class="hljs-keyword">var</span> alc = <span class="hljs-keyword">new</span> PluginLoadContext(pluginPath, UseCollectibleContexts);
        <span class="hljs-keyword">try</span>
        {
            Assembly assem = alc.LoadFromAssemblyPath(pluginPath);

            <span class="hljs-comment">// ูพุฏุง ฺฉุฑุฏู ููุน ฺฉู ITextPlugin ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉูุฏ</span>
            Type pluginType = assem.ExportedTypes.Single(
                t =&gt; <span class="hljs-keyword">typeof</span>(ITextPlugin).IsAssignableFrom(t));

            <span class="hljs-comment">// ุงุฌุงุฏ ูููููโุง ุงุฒ ูพูุงฺฏู</span>
            <span class="hljs-keyword">var</span> plugin = (ITextPlugin)Activator.CreateInstance(pluginType);

            <span class="hljs-comment">// ูุฑุงุฎูุงู ูุชุฏ TransformText</span>
            <span class="hljs-keyword">return</span> plugin.TransformText(text);
        }
        <span class="hljs-keyword">finally</span>
        {
            <span class="hljs-keyword">if</span> (UseCollectibleContexts) alc.Unload(); <span class="hljs-comment">// unload ฺฉุฑุฏู ALC</span>
        }
    }
}
</code></pre>
<ul>
<li>ุงุจุชุฏุง ฺฉ <strong>ALC ุฌุฏุฏ</strong> ุจุฑุง ูพูุงฺฏู ุณุงุฎุชู ูโุดูุฏ.</li>
<li>ุณูพุณ ุงุณูุจู ูพูุงฺฏู ุจุงุฑฺฏุฐุงุฑ ูโุดูุฏ.</li>
<li>ุจุง <strong>Reflection</strong> ููุน ฺฉู ITextPlugin ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉูุฏ ูพุฏุง ูโฺฉูู.</li>
<li>ูพูุงฺฏู ุฑุง ูููููโุณุงุฒ ฺฉุฑุฏูุ ูุชุฏ <strong>TransformText</strong> ุฑุง ูุฑุงุฎูุงู ูโฺฉูู ู ALC ุฑุง unload ูโฺฉูู.</li>
</ul>
<blockquote>
<p>ุงฺฏุฑ ูุงุฒ ุจู ูุฑุงุฎูุงู ูฺฉุฑุฑ TransformText ุฏุงุดุชุฏุ ุจูุชุฑ ุงุณุช <strong>ALC ุฑุง ฺฉุด ฺฉูุฏ</strong> ู ุจุนุฏ ุงุฒ ูุฑ ูุฑุงุฎูุงู unload ูฺฉูุฏ.</p>
</blockquote>
<p>ุฎุฑูุฌ:</p>
<pre class="hljs"><code>BIG APPLE
</code></pre>
<hr>
<h3>๐น ุงูุฒูุฏู ูุงุจุณุชฺฏโูุง</h3>
<p>ฺฉุฏ ูุง ุงฺฉููู ูุงุจูุช ุญู ู ุงุฒูููโุณุงุฒ ูุงุจุณุชฺฏโูุง ุฑุง ุฏุงุฑุฏ.<br>
ุจุฑุง ูุซุงูุ ุงุจุชุฏุง ฺฉ <strong>NuGet reference</strong> ุจู <strong>Humanizer.Core</strong> ูุณุฎู 2.6.2 ุงุถุงูู ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">ItemGroup</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">PackageReference</span> <span class="hljs-attr">Include</span>=<span class="hljs-string">&quot;Humanizer.Core&quot;</span> <span class="hljs-attr">Version</span>=<span class="hljs-string">&quot;2.6.2&quot;</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">ItemGroup</span>&gt;</span>
</code></pre>
<p>ุณูพุณ ฺฉูุงุณ <strong>CapitalizerPlugin</strong> ุฑุง ุจู ุดฺฉู ุฒุฑ ุชุบุฑ ุฏูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> Humanizer;
<span class="hljs-keyword">namespace</span> <span class="hljs-title">Capitalizer</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">CapitalizerPlugin</span> : <span class="hljs-title">Plugin.Common.ITextPlugin</span>
    {
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> <span class="hljs-title">TransformText</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> input</span>)</span> =&gt; input.Pascalize();
    }
}
</code></pre>
<p>ุฎุฑูุฌ ุจุฑูุงูู ุงฺฉููู:</p>
<pre class="hljs"><code>BigApple
</code></pre>
<hr>
<h3>๐น ูพูุงฺฏู ุฌุฏุฏ: Pluralizer</h3>
<p>ฺฉ ูพุฑูฺู ฺฉุชุงุจุฎุงูู ุฌุฏุฏ ุงุฌุงุฏ ฺฉูุฏ ู NuGet reference ุจู <strong>Humanizer.Core</strong> ูุณุฎู 2.7.9 ุงุถุงูู ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">ItemGroup</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">PackageReference</span> <span class="hljs-attr">Include</span>=<span class="hljs-string">&quot;Humanizer.Core&quot;</span> <span class="hljs-attr">Version</span>=<span class="hljs-string">&quot;2.7.9&quot;</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">ItemGroup</span>&gt;</span>
</code></pre>
<p>ฺฉูุงุณ <strong>PluralizerPlugin</strong> ุฑุง ุงุถุงูู ฺฉูุฏ ฺฉู ูุดุงุจู Capitalizer ุงุณุชุ ุงูุง ูุชุฏ <strong>Pluralize</strong> ุฑุง ูุฑุงุฎูุงู ูโฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> Humanizer;
<span class="hljs-keyword">namespace</span> <span class="hljs-title">Pluralizer</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">PluralizerPlugin</span> : <span class="hljs-title">Plugin.Common.ITextPlugin</span>
    {
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> <span class="hljs-title">TransformText</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> input</span>)</span> =&gt; input.Pluralize();
    }
}
</code></pre>
<hr>
<h3>๐น ูุฑุงุฎูุงู ูพูุงฺฏู Pluralizer ุฏุฑ Main</h3>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>()</span>
{
    <span class="hljs-keyword">const</span> <span class="hljs-built_in">string</span> capitalizer = <span class="hljs-string">@&quot;C:\source\PluginDemo\Capitalizer\bin\Debug\netcoreapp3.0\Capitalizer.dll&quot;</span>;
    Console.WriteLine(TransformText(<span class="hljs-string">&quot;big apple&quot;</span>, capitalizer));

    <span class="hljs-keyword">const</span> <span class="hljs-built_in">string</span> pluralizer = <span class="hljs-string">@&quot;C:\source\PluginDemo\Pluralizer\bin\Debug\netcoreapp3.0\Pluralizer.dll&quot;</span>;
    Console.WriteLine(TransformText(<span class="hljs-string">&quot;big apple&quot;</span>, pluralizer));
}
</code></pre>
<p>ุฎุฑูุฌ:</p>
<pre class="hljs"><code>BigApple
big apples
</code></pre>
<hr>
<h3>๐น ูุดุงูุฏู ALCูุง ู ุงุณูุจูโูุง</h3>
<p>ุงฺฏุฑ <strong>UseCollectibleContexts</strong> ุฑุง <strong>false</strong> ฺฉูุฏ ู ฺฉุฏ ุฒุฑ ุฑุง ุจู Main ุงุถุงูู ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> context <span class="hljs-keyword">in</span> AssemblyLoadContext.All)
{
    Console.WriteLine(<span class="hljs-string">$&quot;Context: <span class="hljs-subst">{context.GetType().Name}</span> <span class="hljs-subst">{context.Name}</span>&quot;</span>);
    <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> assembly <span class="hljs-keyword">in</span> context.Assemblies)
        Console.WriteLine(<span class="hljs-string">$&quot;  Assembly: <span class="hljs-subst">{assembly.FullName}</span>&quot;</span>);
}
</code></pre>
<ul>
<li>ุฏู ูุณุฎู ูุฎุชูู ุงุฒ <strong>Humanizer</strong> ุฑุง ูุดุงูุฏู ุฎูุงูุฏ ฺฉุฑุฏุ ูุฑ ฺฉุฏุงู ุฏุฑ <strong>ALC ุฌุฏุงฺฏุงูู</strong>:</li>
</ul>
<pre class="hljs"><code>Context: PluginLoadContext Capitalizer.dll
  Assembly: Capitalizer, Version=1.0.0.0, ...
  Assembly: Humanizer, Version=2.6.0.0, ...
Context: PluginLoadContext Pluralizer.dll
  Assembly: Pluralizer, Version=1.0.0.0, ...
  Assembly: Humanizer, Version=2.7.0.0, ...
Context: DefaultAssemblyLoadContext Default
  Assembly: System.Private.CoreLib, ...
  Assembly: Host, Version=1.0.0.0, ...
</code></pre>
<p>ุญุช ุงฺฏุฑ ูุฑ ุฏู ูพูุงฺฏู ูุณุฎู ฺฉุณุงู Humanizer ุฑุง ุงุณุชูุงุฏู ฺฉููุฏุ <strong>ุงุฒูููโุณุงุฒ ALCูุง</strong> ูุฒุช ุฏุงุฑุฏุ ุฒุฑุง <strong>ูุชุบุฑูุง static ูุฑ ูพูุงฺฏู ุฌุฏุง ุฎูุงููุฏ ุจูุฏ</strong>.</p>

  </main>

  <!-- ููุชุฑ ูุดุชุฑฺฉ -->
  <footer class="footer">
    <div class="container">
      <p>
        <img src="/Gitab/icone/copyright.svg" alt="ฺฉูพโุฑุงุช" width="14" height="14"
             style="vertical-align:middle;margin-inline:4px">
        <span id="y"></span> Gitab โ ุจุฑุง ุชูุณุนูโุฏููุฏฺฏุงู
      </p>
    </div>
  </footer>

  <!-- ุณุงู ู ุงุณฺฉุฑูพุช ุชุบุฑ ุชู -->
  <script>
  (() => {
    const root = document.documentElement;
    const btn = document.getElementById('themeToggle');
    const KEY = 'gitab-theme';
    const media = window.matchMedia('(prefers-color-scheme: dark)');
    const getEffective = s => (s === 'auto' ? (media.matches ? 'dark' : 'light') : s);

    function updateTheme(s) {
      root.setAttribute('data-theme', s);
      const mode = getEffective(s);
      root.dataset.colorMode = mode;
      btn.dataset.icon = mode === 'dark' ? 'moon' : 'sun';
    }

    let saved = localStorage.getItem(KEY) || 'auto';
    updateTheme(saved);

    btn.addEventListener('click', () => {
      const current = localStorage.getItem(KEY) || 'auto';
      const next = current === 'auto' ? 'dark' : current === 'dark' ? 'light' : 'auto';
      localStorage.setItem(KEY, next);
      updateTheme(next);
    });

    media.addEventListener('change', () => {
      if ((localStorage.getItem(KEY) || 'auto') === 'auto') updateTheme('auto');
    });

    document.addEventListener('DOMContentLoaded', () => {
      updateTheme(localStorage.getItem(KEY) || 'auto');
    });
  })();
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>

  <script>
  document.querySelectorAll('pre code').forEach(block => {
    const btn = document.createElement('button');
    btn.className = 'copy-btn';

    const icon = document.createElement('img');
    icon.src = "/Gitab/icone/copy.svg";
    icon.alt = 'Copy';
    btn.appendChild(icon);

    block.parentNode.insertBefore(btn, block);

    btn.addEventListener('click', async () => {
      await navigator.clipboard.writeText(block.textContent);
      btn.classList.add('copied');
      setTimeout(() => btn.classList.remove('copied'), 1500);
    });
  });
  </script>

  <script>
  document.body.dataset.page = window.location.pathname;

  const menuBtn = document.querySelector(".menu-toggle");
  const nav = document.querySelector(".nav");

  if (menuBtn && nav) {
    menuBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      nav.classList.toggle("show");
    });

    document.addEventListener("click", (e) => {
      const clickedInsideNav = nav.contains(e.target);
      const clickedMenuButton = menuBtn.contains(e.target);
      if (!clickedInsideNav && !clickedMenuButton) {
        nav.classList.remove("show");
      }
    });
  }
  </script>

  <script>
    document.getElementById('y').textContent = new Date().getFullYear();
  </script>
</body>
</html>
