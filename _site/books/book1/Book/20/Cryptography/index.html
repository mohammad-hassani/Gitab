

<!doctype html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8">
  <link rel="icon" type="image/png" href="/Gitab/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ุฑูุฒูฺฏุงุฑ</title>
  <meta name="description" content="ุชุฑุฌููโูุง ูุงุฑุณ ฺฉุชุงุจโูุง ูู โ ุณุฑุนุ ูููุงู ู ูุงุจู ุงุชฺฉุง.">

  <!-- ุงุณุชุงูโูุง -->
  <link rel="stylesheet" href="/Gitab/styles/main.css">
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">

  <style>
  @font-face {
    font-family: 'Vazir';
    src: url('/Gitab/fonts/Vazir-FD-WOL.ttf') format('truetype');
    font-display: swap;
  }
  body {
    font-family: 'Vazir', sans-serif;
  }
  </style>
</head>

<body>
  <!-- ูุฏุฑ ูุดุชุฑฺฉ -->
  <header class="header">
    <div class="container nav-wrap">
      <a href="/Gitab/" class="brand">
        <img src="/Gitab/icone/logo.svg" alt="Gitab logo" width="26" height="26">
        <span>Gitab</span>
      </a>

      <nav class="nav">
        <a href="/Gitab/" aria-current="page">ุฎุงูู</a>
        <a href="/Gitab/books/list-books">ฺฉุชุงุจโูุง</a>
        <a href="#">ูุชุฑุฌูู</a>
        <a href="#">ููฺฉุงุฑ</a>
        <a href="#">ุฏุฑุจุงุฑู ูุง</a>
      </nav>

      <div class="nav-actions">
        <button id="themeToggle" class="icon-btn theme-btn" data-icon="moon" aria-label="ุชุบุฑ ุชู">
          <img src="/Gitab/icone/sun.svg" class="icon-sun" alt="ุฑูุดู">
          <img src="/Gitab/icone/moon.svg" class="icon-moon" alt="ุชุงุฑฺฉ">
        </button>

        <a class="icon-btn" href="https://github.com/hheydarian/Gitab" target="_blank" title="GitHub">
          <img src="/Gitab/icone/github.svg" alt="GitHub">
        </a>

        <!-- ุฏฺฉูู ููู ุจุฑุง ููุจุงู -->
        <button class="menu-toggle" aria-label="ููู">
          <img src="/Gitab/icone/menu.svg" alt="menu">
        </button>
      </div>
    </div>
  </header>

  
  <main class="site-main book-page">
    <h1>ูุตู ุจุณุชู:  ุฑูุฒูฺฏุงุฑ</h1>
<p>ุฏุฑ ุงู ูุตูุ ูุง ุจู ุจุฑุฑุณ APIูุง ุงุตู <strong>Cryptography</strong> ุฏุฑ .NET ูโูพุฑุฏุงุฒู:</p>
<ul>
<li><strong>Windows Data Protection API (DPAPI)</strong></li>
<li><strong>Hashing</strong></li>
<li><strong>Symmetric encryption</strong></li>
<li><strong>Public key encryption and signing</strong></li>
</ul>
<p>ุงููุงุน (Types) ูพูุดุด ุฏุงุฏู ุดุฏู ุฏุฑ ุงู ูุตู ุฏุฑ <strong>namespace</strong>ูุง ุฒุฑ ุชุนุฑู ุดุฏูโุงูุฏ:</p>
<pre class="hljs"><code>System.Security;
System.Security.Cryptography;
</code></pre>
<hr>
<h3>ูุฑูุฑ ฺฉู ๐</h3>
<p>ุฌุฏูู <strong>ฒฐ-ฑ</strong> ุฎูุงุตูโุง ุงุฒ ฺฏุฒููโูุง <strong>Cryptography</strong> ุฏุฑ .NET ุฑุง ูุดุงู ูโุฏูุฏ. ุฏุฑ ุจุฎุดโูุง ุจุนุฏุ ูุฑ ฺฉ ุงุฒ ุงู ููุงุฑุฏ ุฑุง ุจู ุชูุตู ุจุฑุฑุณ ุฎูุงูู ฺฉุฑุฏ.</p>
 <div align="center">
<p><img src="../../../assets/image/20/Table-20-1.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>ูพุดุชุจุงูโูุง ูฺูโุชุฑ ุฏุฑ .NET โจ</h3>
<p>.NET ููฺูู ูพุดุชุจุงูโูุง ุชุฎุตุตโุชุฑ ุจุฑุง <strong>ุงุฌุงุฏ ู ุงุนุชุจุงุฑุณูุฌ ุงูุถุงูุง ูุจุชู ุจุฑ XML</strong> ุฏุฑ <code>System.Security.Cryptography.Xml</code> ู ููฺูู <strong>ุงููุงุน (Types) ูุฑุชุจุท ุจุง ฺฉุงุฑ ุจุง ฺฏูุงูโูุง ุฏุฌุชุงู</strong> ุฏุฑ <code>System.Security.Cryptography.X509Certificates</code> ุงุฑุงุฆู ูโุฏูุฏ.</p>
<hr>
<h3>Windows Data Protection ๐ช๐</h3>
<p>ูฺฺฏ <strong>Windows Data Protection</strong> ููุท ุฑู ููุฏูุฒ ุฏุฑ ุฏุณุชุฑุณ ุงุณุช ู ุฏุฑ ุณุณุชูโุนุงููโูุง ุฏฺฏุฑ ฺฉ ุงุณุชุซูุงุก ุงุฒ ููุน <code>PlatformNotSupportedException</code> ุงุฌุงุฏ ูโฺฉูุฏ.</p>
<p>ุฏุฑ ุจุฎุด <strong>โFile and Directory Operationsโ</strong> ุฏุฑ ุตูุญู ทฒณ ุชูุถุญ ุฏุงุฏู ฺฉู ฺฺฏููู ูโุชูุงูุฏ ุงุฒ <code>File.Encrypt</code> ุจุฑุง ุฏุฑุฎูุงุณุช ุฑูุฒูฺฏุงุฑ ุดูุงู (transparent) ูุงู ุชูุณุท ุณุณุชูโุนุงูู ุงุณุชูุงุฏู ฺฉูุฏ:</p>
<pre class="hljs"><code>File.WriteAllText (<span class="hljs-string">&quot;myfile.txt&quot;</span>, <span class="hljs-string">&quot;&quot;</span>);
File.Encrypt (<span class="hljs-string">&quot;myfile.txt&quot;</span>);
File.AppendAllText (<span class="hljs-string">&quot;myfile.txt&quot;</span>, <span class="hljs-string">&quot;sensitive data&quot;</span>);
</code></pre>
<p>๐ ุฏุฑ ุงู ุญุงูุชุ ุฑูุฒูฺฏุงุฑ ุงุฒ ฺฉูุฏ ุงุณุชูุงุฏู ูโฺฉูุฏ ฺฉู ุงุฒ <strong>ุฑูุฒ ุนุจูุฑ ฺฉุงุฑุจุฑ ูุงฺฏูโุดุฏู</strong> ุงุณุชุฎุฑุงุฌ ุดุฏู ุงุณุช. ุดูุง ูโุชูุงูุฏ ููู ฺฉูุฏ ุงุณุชุฎุฑุงุฌโุดุฏู ุถูู ุฑุง ุจุฑุง ุฑูุฒูฺฏุงุฑ ฺฉ <strong>ุขุฑุงูโ ุจุงุช</strong> ุจุง ุงุณุชูุงุฏู ุงุฒ <strong>Windows Data Protection API (DPAPI)</strong> ุจูโฺฉุงุฑ ุจฺฏุฑุฏ.</p>
<p>DPAPI ุงุฒ ุทุฑู ฺฉูุงุณ <code>ProtectedData</code> ุฏุฑ ุฏุณุชุฑุณ ูุฑุงุฑ ฺฏุฑูุชู ุงุณุชุ ฺฉูุงุณ ุณุงุฏู ุจุง ุฏู ูุชุฏ <strong>static</strong>:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">byte</span>[] <span class="hljs-title">Protect</span>
 (<span class="hljs-params"><span class="hljs-built_in">byte</span>[] userData, <span class="hljs-built_in">byte</span>[] optionalEntropy, DataProtectionScope scope</span>)</span>;

<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">byte</span>[] <span class="hljs-title">Unprotect</span>
 (<span class="hljs-params"><span class="hljs-built_in">byte</span>[] encryptedData, <span class="hljs-built_in">byte</span>[] optionalEntropy, DataProtectionScope scope</span>)</span>;
</code></pre>
<p>๐ ูุฑ ฺุฒ ฺฉู ุฏุฑ <code>optionalEntropy</code> ูุฑุงุฑ ุฏูุฏ ุจู ฺฉูุฏ ุงุถุงูู ูโุดูุฏ ู ุงููุช ุขู ุฑุง ุงูุฒุงุด ูโุฏูุฏ.<br>
ูพุงุฑุงูุชุฑ <code>DataProtectionScope</code> ุฏู ฺฏุฒูู ุฏุงุฑุฏ:</p>
<ul>
<li><strong>CurrentUser</strong> โ ฺฉูุฏ ุงุฒ ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ (credentials) ฺฉุงุฑุจุฑ ูุนู ุงุณุชุฎุฑุงุฌ ูโุดูุฏ.</li>
<li><strong>LocalMachine</strong> โ ฺฉ ฺฉูุฏ ุฏุฑ ุณุทุญ ฺฉู ุณุณุชู (machine-wide) ุงุณุชูุงุฏู ูโุดูุฏ ฺฉู ุจู ููู ฺฉุงุฑุจุฑุงู ูุดุชุฑฺฉ ุงุณุช.</li>
</ul>
<p>โก๏ธ ุงู ุนู ุงฺฏุฑ <strong>CurrentUser</strong> ุงูุชุฎุงุจ ุดูุฏุ ุฏุงุฏูโูุง ุฑูุฒูฺฏุงุฑโุดุฏู ุชูุณุท ฺฉ ฺฉุงุฑุจุฑ ูุงุจู ุฑูุฒฺฏุดุง ุชูุณุท ฺฉุงุฑุจุฑ ุฏฺฏุฑ ูุฎูุงููุฏ ุจูุฏ. ุฏุฑ ุญุงูโฺฉู ฺฉูุฏ <strong>LocalMachine</strong> ุงููุช ฺฉูุชุฑ ุฏุงุฑุฏุ ุงูุง ุจุฑุง ุณุฑูุณโูุง ููุฏูุฒ ุง ุจุฑูุงููโูุง ฺฉู ุจุงุฏ ุชุญุช ุญุณุงุจโูุง ูุฎุชูู ฺฉุงุฑ ฺฉููุฏุ ููุงุณุจ ุงุณุช.</p>
<hr>
<h3>ูููููโุง ุณุงุฏู ุงุฒ ุฑูุฒูฺฏุงุฑ ู ุฑูุฒฺฏุดุง ๐งฉ</h3>
<pre class="hljs"><code><span class="hljs-built_in">byte</span>[] original = {<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>};
DataProtectionScope scope = DataProtectionScope.CurrentUser;
<span class="hljs-built_in">byte</span>[] encrypted = ProtectedData.Protect (original, <span class="hljs-literal">null</span>, scope);
<span class="hljs-built_in">byte</span>[] decrypted = ProtectedData.Unprotect (encrypted, <span class="hljs-literal">null</span>, scope);
<span class="hljs-comment">// decrypted is now {1, 2, 3, 4, 5}</span>
</code></pre>
<p>๐ก Windows Data Protection ุงููุช ูุชูุณุท ุฏุฑ ุจุฑุงุจุฑ ููุงุฌู ฺฉู ุฏุณุชุฑุณ ฺฉุงูู ุจู ุฑุงุงูู ุฏุงุฑุฏ ูุฑุงูู ูโฺฉูุฏุ ุงู ููุถูุน ุจุณุชฺฏ ุจู ูุฏุฑุช ุฑูุฒ ุนุจูุฑ ฺฉุงุฑุจุฑ ุฏุงุฑุฏ.<br>
ุจุง <strong>LocalMachine</strong>ุ ุงู ุฑูุด ููุท ุฏุฑ ุจุฑุงุจุฑ ฺฉุณุงู ฺฉู ุฏุณุชุฑุณ ูุฒฺฉ ุง ุงูฺฉุชุฑููฺฉ ูุญุฏูุฏ ุฏุงุฑูุฏ ูุคุซุฑ ุงุณุช.</p>
<hr>
<h3>Hashing ๐๐</h3>
<p>ฺฉ <strong>ุงูฺฏูุฑุชู Hashing</strong> ุญุฌู ุจุฒุฑฺฏ ุงุฒ ุฏุงุฏูโูุง ุฑุง ุจู ฺฉ <strong>ฺฉุฏ ุซุงุจุช ู ฺฉูฺฺฉ (hashcode)</strong> ุชุจุฏู ูโฺฉูุฏ.<br>
ุงู ุงูฺฏูุฑุชูโูุง ุทูุฑ ุทุฑุงุญ ุดุฏูโุงูุฏ ฺฉู ุญุช ุงฺฏุฑ ุชููุง ฺฉ ุจุช ุฏุฑ ุฏุงุฏูโ ุงุตู ุชุบุฑ ฺฉูุฏุ ูุชุฌูโ <strong>hashcode</strong> ฺฉุงููุงู ูุชูุงูุช ุฎูุงูุฏ ุจูุฏ.</p>
<p>๐ ุงู ูฺฺฏ ุจุงุนุซ ูโุดูุฏ ฺฉู hashing ุจุฑุง <strong>ููุงุณู ูุงูโูุง</strong> ุง <strong>ุชุดุฎุต ุฎุฑุงุจโูุง ุชุตุงุฏู (ุง ูุฎุฑุจ) ุฏุฑ ูุงู ุง ุฌุฑุงู ุฏุงุฏู (data stream)</strong> ุจุณุงุฑ ููุงุณุจ ุจุงุดุฏ.</p>
<p>ุนูุงูู ุจุฑ ุงูุ <strong>Hashing ููุน ุฑูุฒูฺฏุงุฑ ฺฉโุทุฑูู</strong> ูุญุณูุจ ูโุดูุฏุ ุฒุฑุง ุจุงุฒฺฏุฑุฏุงูุฏู hashcode ุจู ุฏุงุฏู ุงุตู ุชูุฑุจุงู ุบุฑููฺฉู ุงุณุช.<br>
ุจู ููู ุฏููุ ุฐุฎุฑูโุณุงุฒ ุฑูุฒ ุนุจูุฑ ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุจูโุตูุฑุช hash ฺฉ ุฑูุด ุงูู ุงุณุช.<br>
๐ ุงฺฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุดูุง ุจู ุฎุทุฑ ุจูุชุฏุ ููุงุฌู ุจู ุฑูุฒ ุนุจูุฑูุง ูุชู ุณุงุฏู (plain-text) ุฏุณุชุฑุณ ูพุฏุง ูุฎูุงูุฏ ฺฉุฑุฏ.<br>
ุจุฑุง ุงุญุฑุงุฒ ููุชุ ฺฉุงู ุงุณุช ูุฑูุฏ ฺฉุงุฑุจุฑ ุฑุง hash ฺฉุฑุฏู ู ุจุง ููุฏุงุฑ ุฐุฎุฑูโุดุฏู ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ููุงุณู ฺฉูุฏ.</p>
<hr>
<h3>ุงุณุชูุงุฏู ุงุฒ ComputeHash ๐ฅ</h3>
<p>ุจุฑุง ุชููุฏ hashุ ูุชุฏ <code>ComputeHash</code> ุงุฒ ฺฉ ุงุฒ ุฒุฑฺฉูุงุณโูุง <code>HashAlgorithm</code> (ูุซู <code>SHA1</code> ุง <code>SHA256</code>) ูุฑุงุฎูุงู ูโุดูุฏ:</p>
<pre class="hljs"><code><span class="hljs-built_in">byte</span>[] hash;
<span class="hljs-keyword">using</span> (Stream fs = File.OpenRead (<span class="hljs-string">&quot;checkme.doc&quot;</span>))
  hash = SHA1.Create().ComputeHash (fs);   <span class="hljs-comment">// SHA1 hash is 20 bytes long</span>
</code></pre>
<p>ูุชุฏ <code>ComputeHash</code> ููฺูู ฺฉ <strong>ุขุฑุงูโ ุจุงุช</strong> ุฑุง ูโูพุฐุฑุฏ ฺฉู ุจุฑุง hash ฺฉุฑุฏู ุฑูุฒูุง ุนุจูุฑ ุจุณุงุฑ ฺฉุงุฑุจุฑุฏ ุงุณุช (ุฑูุด ุงููโุชุฑ ุฏุฑ ุจุฎุด <strong>โHashing Passwordsโ</strong> ุฏุฑ ุตูุญู ธทธ ุชูุถุญ ุฏุงุฏู ุดุฏู ุงุณุช):</p>
<pre class="hljs"><code><span class="hljs-built_in">byte</span>[] data = System.Text.Encoding.UTF8.GetBytes (<span class="hljs-string">&quot;stRhong%pword&quot;</span>);
<span class="hljs-built_in">byte</span>[] hash = SHA256.Create().ComputeHash (data);
</code></pre>
<p>๐ ูุชุฏ <code>GetBytes</code> ุฏุฑ ฺฉ ุดุก ุงุฒ ููุน <code>Encoding</code>ุ ฺฉ ุฑุดุชู (string) ุฑุง ุจู ุขุฑุงูโ ุจุงุช ุชุจุฏู ูโฺฉูุฏุ ูุชุฏ <code>GetString</code> ุขู ุฑุง ุจุฑุนฺฉุณ ุจุฑูโฺฏุฑุฏุงูุฏ.<br>
ุงูุง ฺฉ ุดุก <code>Encoding</code> ููโุชูุงูุฏ ฺฉ ุขุฑุงูโ ุจุงุช ุฑูุฒูฺฏุงุฑโุดุฏู ุง hash ุดุฏู ุฑุง ุจู ุฑุดุชู ุจุฑฺฏุฑุฏุงูุฏุ ฺูู ุฏุงุฏูโ scramble ุดุฏู ูุนูููุงู ููุงูู encoding ูุชู ุฑุง ููุถ ูโฺฉูุฏ.</p>
<p>ุจู ุฌุง ุขู ุจุงุฏ ุงุฒ ูุชุฏูุง ุฒุฑ ุงุณุชูุงุฏู ฺฉูุฏ:</p>
<ul>
<li><code>Convert.ToBase64String</code></li>
<li><code>Convert.FromBase64String</code></li>
</ul>
<p>ุงูโูุง ุชุจุฏู ุจู ูุฑ <strong>ุขุฑุงูโ ุจุงุช</strong> ู ฺฉ ุฑุดุชู ูุนุชุจุฑ (ู ุณุงุฒฺฏุงุฑ ุจุง XML ุง JSON) ุฑุง ุงูุฌุงู ูโุฏููุฏ.</p>
<hr>
<h3>ุงูฺฏูุฑุชูโูุง Hash ุฏุฑ .NET ๐งฎ</h3>
<p><code>SHA1</code> ู <code>SHA256</code> ุฏู ููููู ุงุฒ ุฒุฑููุนโูุง <code>HashAlgorithm</code> ูุณุชูุฏ ฺฉู ุชูุณุท .NET ุงุฑุงุฆู ุดุฏูโุงูุฏ.<br>
ูููโุชุฑู ุงูฺฏูุฑุชูโูุงุ ุจู ุชุฑุชุจ <strong>ุงูุฒุงุด ุงููุช</strong> ุนุจุงุฑุชโุงูุฏ ุงุฒ: โฆ</p>
 <div align="center">
<p><img src="../../../assets/image/20/Table-20-2.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>ุงูฺฏูุฑุชูโูุง Hash ุฏุฑ .NET ๐งฎ</h3>
<p>ุชูุงู ูพูุฌ ุงูฺฏูุฑุชู ุฏุฑ ูพุงุฏูโุณุงุฒโูุง ูุนู ุชูุฑุจุงู ุจุง ุณุฑุนุช ูุดุงุจู ุงุฌุฑุง ูโุดููุฏุ ุจู ุฌุฒ <strong>SHA256</strong> ฺฉู ุญุฏูุฏ ฒ ุชุง ณ ุจุฑุงุจุฑ ุณุฑุนโุชุฑ ุงุณุช (ุงู ููุถูุน ูโุชูุงูุฏ ุจุณุชู ุจู ุณุฎุชโุงูุฒุงุฑ ู ุณุณุชูโุนุงูู ูุชูุงูุช ุจุงุดุฏ).</p>
<p>๐ ุจูโุทูุฑ ุชูุฑุจ ูโุชูุงูุฏ ุงูุชุธุงุฑ ุณุฑุนุช ุญุฏุงูู <strong>ตฐฐ ูฺฏุงุจุงุช ุฏุฑ ุซุงูู</strong> ุฑุง ุฑู ฺฉ ุฏุณฺฉุชุงูพ ุง ุณุฑูุฑ ุณุงู ฒฐฒด ุงุฒ ุชูุงู ุงู ุงูฺฏูุฑุชูโูุง ุฏุงุดุชู ุจุงุดุฏ.</p>
<p>๐ ูุฑฺู ุทูู hash ุจุดุชุฑ ุจุงุดุฏุ ุงุญุชูุงู <strong>collision</strong> (ุนู ุชููุฏ ฺฉ hash ูุดุงุจู ุงุฒ ุฏู ูุงู ูุชูุงูุช) ฺฉุงูุด ูโุงุจุฏ. ุจูุงุจุฑุงู:</p>
<ul>
<li>ููฺฏุงู <strong>hash ฺฉุฑุฏู ุฑูุฒ ุนุจูุฑูุง</strong> ุง ุฏุงุฏูโูุง ุญุณุงุณ ุงููุชุ ุญุฏุงูู ุงุฒ <strong>SHA256</strong> ุงุณุชูุงุฏู ฺฉูุฏ.</li>
<li>ุงูฺฏูุฑุชูโูุง <strong>MD5</strong> ู <strong>SHA1</strong> ุงุฒ ูุธุฑ ุงููุช ุถุนู ูุญุณูุจ ูโุดููุฏ ู ุชููุง ุจุฑุง ูุญุงูุธุช ุฏุฑ ุจุฑุงุจุฑ ุฎุฑุงุจโูุง ุชุตุงุฏู ููุงุณุจโุงูุฏุ ูู ุฏุณุชฺฉุงุฑโูุง ุนูุฏ.</li>
</ul>
<p>ุฏุฑ .NET 8 ู ุจุงูุงุชุฑุ ูพุดุชุจุงู ุงุฒ ุขุฎุฑู ุงุณุชุงูุฏุงุฑุฏ <strong>SHA-3</strong> ูุฒ ุงุถุงูู ุดุฏู ุงุณุชุ ุดุงูู ฺฉูุงุณโูุง:</p>
<ul>
<li><code>SHA3_256</code></li>
<li><code>SHA3_384</code></li>
<li><code>SHA3_512</code></li>
</ul>
<p>ุงูฺฏูุฑุชูโูุง SHA-3 ุงุฒ ุงูฺฏูุฑุชูโูุง ูุจู <strong>ุงููโุชุฑ (ู ุงูุจุชู ฺฉูุฏุชุฑ)</strong> ูุณุชูุฏุ ุงูุง ุจู <strong>Windows Build 25324+</strong> ุง <strong>Linux ุจุง OpenSSL 1.1.1+</strong> ูุงุฒ ุฏุงุฑูุฏ.<br>
ูโุชูุงูุฏ ูพุดุชุจุงู ุณุณุชูโุนุงูู ุฑุง ุงุฒ ุทุฑู ูฺฺฏ <strong>static</strong> ุจู ูุงู <code>IsSupported</code> ุฏุฑ ุงู ฺฉูุงุณโูุง ุจุฑุฑุณ ฺฉูุฏ.</p>
<hr>
<h3>Hashing Passwords ๐๐ง</h3>
<p>ุงูฺฏูุฑุชูโูุง SHA ุจุง ุทูู ุจุดุชุฑ ุจุฑุง hash ฺฉุฑุฏู ุฑูุฒ ุนุจูุฑูุง ููุงุณุจโุงูุฏุ ุจู ุดุฑุท ฺฉู ฺฉ <strong>ุณุงุณุช ุฑูุฒ ุนุจูุฑ ูู</strong> ุงุนูุงู ฺฉูุฏ ุชุง ุงุฒ ุญูููโ <strong>dictionary attack</strong> ุฌููฺฏุฑ ุดูุฏ.<br>
๐ ุฏุฑ ุงู ููุน ุญูููุ ููุงุฌู ุฌุฏูู ุงุฒ ุฑูุฒูุง ุงุฌุงุฏ ูโฺฉูุฏ ฺฉู ุดุงูู hash ุชูุงู ฺฉููุงุช ููุฌูุฏ ุฏุฑ ฺฉ ูุฑููฺฏ ูุบุช ุงุณุช.</p>
<p>โ ฺฉ ุชฺฉูฺฉ ุงุณุชุงูุฏุงุฑุฏ ููฺฏุงู hash ฺฉุฑุฏู ุฑูุฒูุงุ ุงุณุชูุงุฏู ุงุฒ <strong>salt</strong> ุงุณุช:<br>
ฺฉ ุฏูุจุงููโ ุทููุงู ุงุฒ ุจุงุชโูุง ฺฉู ุงุจุชุฏุง ุจุง ฺฉ <strong>ุชููุฏฺฉููุฏู ุงุนุฏุงุฏ ุชุตุงุฏู</strong> ุจู ุฏุณุช ูโุขุฏ ู ุณูพุณ ูพุด ุงุฒ hash ุดุฏูุ ุจุง ุฑูุฒ ุนุจูุฑ ุชุฑฺฉุจ ูโุดูุฏ.</p>
<p>ุงู ฺฉุงุฑ ุฏู ูุฒุช ููู ุฏุงุฑุฏ:</p>
<ul>
<li>ููุงุฌู ุจุงุฏ ุงุฒ ุจุงุชโูุง salt ูู ุงุทูุงุน ุฏุงุดุชู ุจุงุดุฏ.</li>
<li>ุงุณุชูุงุฏู ุงุฒ <strong>rainbow tables</strong> (ูพุงฺฏุงูโูุง ุฏุงุฏูโ ุงุฒ ูพุด ูุญุงุณุจูโุดุฏูโ ุฑูุฒูุง ู hash ุขูโูุง) ุจโุงุซุฑ ูโุดูุฏุ ูุฑฺูุฏ ุญูููโ dictionary ููฺูุงู ุจุง ูุฏุฑุช ูุญุงุณุจุงุช ฺฉุงู ููฺฉู ุงุณุช.</li>
</ul>
<hr>
<h3>Password Stretching โณ</h3>
<p>ูโุชูุงูุฏ ุงููุช ุฑุง ุจุง ุชฺฉูฺฉ <strong>stretching</strong> ุชููุช ฺฉูุฏุ ุนู ุจุง <strong>ุชฺฉุฑุงุฑ ฺูุฏุจุงุฑู hash ฺฉุฑุฏู</strong>ุ ูุฑุขูุฏ ุชููุฏ hash ุฑุง ูุญุงุณุจุงุชโุชุฑ ฺฉูุฏ.</p>
<p>ุจูโุนููุงู ูุซุงู:<br>
ุงฺฏุฑ ฑฐฐ ุจุงุฑ rehash ฺฉูุฏุ ุญูููโ dictionary ฺฉู ุดุงุฏ ฺฉ ูุงู ุทูู ุจฺฉุดุฏุ ุงฺฉููู ุญุฏูุฏ <strong>ธ ุณุงู</strong> ุฒูุงู ุฎูุงูุฏ ุจุฑุฏ.</p>
<p>ฺฉูุงุณโูุง ุฒุฑ ุฏููุงู ููู ููุน stretching ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉููุฏ ู ููฺูู ุงูฺฉุงู ุงุณุชูุงุฏู ุขุณุงู ุงุฒ salting ุฑุง ูุฑุงูู ูโุขูุฑูุฏ:</p>
<ul>
<li><code>KeyDerivation</code></li>
<li><code>Rfc2898DeriveBytes</code></li>
<li><code>PasswordDeriveBytes</code></li>
</ul>
<p>ุงุฒ ูุงู ุขูโูุงุ ุจูุชุฑู ุงูุชุฎุงุจ:<br>
<strong><code>KeyDerivation.Pbkdf2</code></strong> โ</p>
<p>ูุซุงู:</p>
<pre class="hljs"><code><span class="hljs-built_in">byte</span>[] encrypted = KeyDerivation.Pbkdf2 (
   password: <span class="hljs-string">&quot;stRhong%pword&quot;</span>,
   salt: Encoding.UTF8.GetBytes (<span class="hljs-string">&quot;j78Y#p)/saREN!y3@&quot;</span>),
   prf: KeyDerivationPrf.HMACSHA512,
   iterationCount: <span class="hljs-number">100</span>,
   numBytesRequested: <span class="hljs-number">64</span>);
</code></pre>
<p>๐ฆ <code>KeyDerivation.Pbkdf2</code> ูุงุฒููุฏ ูุตุจ ุจุณุชูโ NuGet ุจู ูุงู:<br>
<code>Microsoft.AspNetCore.Cryptography.KeyDerivation</code> ุงุณุช.<br>
ุงฺฏุฑฺู ุงู ฺฉูุงุณ ุฏุฑ <strong>namespace</strong> ูุฑุจูุท ุจู <a href="http://ASP.NET">ASP.NET</a> Core ูุฑุงุฑ ุฏุงุฑุฏุ ุงูุง ูุฑ ุจุฑูุงููโ .NET ูโุชูุงูุฏ ุงุฒ ุขู ุงุณุชูุงุฏู ฺฉูุฏ.</p>
<hr>
<h3>Symmetric Encryption ๐โ๏ธ</h3>
<p>ุฏุฑ <strong>ุฑูุฒูฺฏุงุฑ ูุชูุงุฑู (Symmetric Encryption)</strong>ุ ฺฉ ฺฉูุฏ ฺฉุณุงู ุจุฑุง <strong>ุฑูุฒูฺฏุงุฑ (encryption)</strong> ู <strong>ุฑูุฒฺฏุดุง (decryption)</strong> ุงุณุชูุงุฏู ูโุดูุฏ.</p>
<p>ฺฉุชุงุจุฎุงูู ูพุงูโ .NET (BCL) ฺูุงุฑ ุงูฺฏูุฑุชู ูุชูุงุฑู ุงุฑุงุฆู ูโุฏูุฏ ฺฉู ุฏุฑ ูุงู ุขูโูุงุ <strong>Rijndael</strong> (ุชููุธ: &quot;ุฑุงูโุฏุงู&quot; ุง &quot;ุฑูโุฏุงู&quot;) ุจูุชุฑู ฺฏุฒูู ุงุณุชุ ุฏฺฏุฑ ุงูฺฏูุฑุชูโูุง ุนูุฏุชุงู ุจุฑุง ุณุงุฒฺฏุงุฑ ุจุง ุจุฑูุงููโูุง ูุฏู ุงุณุชูุงุฏู ูโุดููุฏ.</p>
<p>โจ <strong>Rijndael</strong> ุณุฑุน ู ุงูู ุงุณุช ู ุฏุฑ ุฏู ูพุงุฏูโุณุงุฒ ุงุฑุงุฆู ูโุดูุฏ:</p>
<ul>
<li><code>Rijndael</code></li>
<li><code>Aes</code></li>
</ul>
<p>ุงู ุฏู ุชูุฑุจุงู ูุดุงุจูโุงูุฏุ ุจุง ุงู ุชูุงูุช ฺฉู <code>Aes</code> ุงุฌุงุฒู ููโุฏูุฏ ุงูุฏุงุฒูโ ุจููฺฉ (block size) ุฑุง ุชุบุฑ ุฏูุฏ ู ุฑูุฒูฺฏุงุฑ ุฑุง ุถุนู ฺฉูุฏ.<br>
๐ ุชู ุงููุช CLR ุงุณุชูุงุฏู ุงุฒ <strong>Aes</strong> ุฑุง ุชูุตู ูโฺฉูุฏ.</p>
<p>ูุฑ ุฏู ุงูฺฏูุฑุชู ฺฉูุฏูุง ูุชูุงุฑู ุจุง ุทูู <strong>ฑถุ ฒด ุง ณฒ ุจุงุช</strong> ุฑุง ูพุดุชุจุงู ูโฺฉููุฏ ฺฉู ููฺฏ ุฏุฑ ุญุงู ุญุงุถุฑ ุงูู ูุญุณูุจ ูโุดููุฏ.</p>
<hr>
<h3>ููููู ุฑูุฒูฺฏุงุฑ ๐</h3>
<p>ุฑูุฒูฺฏุงุฑ ฺฉ ุขุฑุงูโ ุจุงุช ููฺฏุงู ููุดุชู ุฏุฑ ูุงู ุจุง ฺฉูุฏ ฑถ ุจุงุช:</p>
<pre class="hljs"><code><span class="hljs-built_in">byte</span>[] key = {<span class="hljs-number">145</span>,<span class="hljs-number">12</span>,<span class="hljs-number">32</span>,<span class="hljs-number">245</span>,<span class="hljs-number">98</span>,<span class="hljs-number">132</span>,<span class="hljs-number">98</span>,<span class="hljs-number">214</span>,<span class="hljs-number">6</span>,<span class="hljs-number">77</span>,<span class="hljs-number">131</span>,<span class="hljs-number">44</span>,<span class="hljs-number">221</span>,<span class="hljs-number">3</span>,<span class="hljs-number">9</span>,<span class="hljs-number">50</span>};
<span class="hljs-built_in">byte</span>[] iv  = {<span class="hljs-number">15</span>,<span class="hljs-number">122</span>,<span class="hljs-number">132</span>,<span class="hljs-number">5</span>,<span class="hljs-number">93</span>,<span class="hljs-number">198</span>,<span class="hljs-number">44</span>,<span class="hljs-number">31</span>,<span class="hljs-number">9</span>,<span class="hljs-number">39</span>,<span class="hljs-number">241</span>,<span class="hljs-number">49</span>,<span class="hljs-number">250</span>,<span class="hljs-number">188</span>,<span class="hljs-number">80</span>,<span class="hljs-number">7</span>};
<span class="hljs-built_in">byte</span>[] data = { <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span> };   <span class="hljs-comment">// ุฏุงุฏูโุง ฺฉู ุฑูุฒูฺฏุงุฑ ูโฺฉูู.</span>
<span class="hljs-keyword">using</span> (SymmetricAlgorithm algorithm = Aes.Create())
<span class="hljs-keyword">using</span> (ICryptoTransform encryptor = algorithm.CreateEncryptor (key, iv))
<span class="hljs-keyword">using</span> (Stream f = File.Create (<span class="hljs-string">&quot;encrypted.bin&quot;</span>))
<span class="hljs-keyword">using</span> (Stream c = <span class="hljs-keyword">new</span> CryptoStream (f, encryptor, CryptoStreamMode.Write))
 c.Write (data, <span class="hljs-number">0</span>, data.Length);
</code></pre>
<hr>
<h3>ููููู ุฑูุฒฺฏุดุง ๐</h3>
<pre class="hljs"><code><span class="hljs-built_in">byte</span>[] key = {<span class="hljs-number">145</span>,<span class="hljs-number">12</span>,<span class="hljs-number">32</span>,<span class="hljs-number">245</span>,<span class="hljs-number">98</span>,<span class="hljs-number">132</span>,<span class="hljs-number">98</span>,<span class="hljs-number">214</span>,<span class="hljs-number">6</span>,<span class="hljs-number">77</span>,<span class="hljs-number">131</span>,<span class="hljs-number">44</span>,<span class="hljs-number">221</span>,<span class="hljs-number">3</span>,<span class="hljs-number">9</span>,<span class="hljs-number">50</span>};
<span class="hljs-built_in">byte</span>[] iv  = {<span class="hljs-number">15</span>,<span class="hljs-number">122</span>,<span class="hljs-number">132</span>,<span class="hljs-number">5</span>,<span class="hljs-number">93</span>,<span class="hljs-number">198</span>,<span class="hljs-number">44</span>,<span class="hljs-number">31</span>,<span class="hljs-number">9</span>,<span class="hljs-number">39</span>,<span class="hljs-number">241</span>,<span class="hljs-number">49</span>,<span class="hljs-number">250</span>,<span class="hljs-number">188</span>,<span class="hljs-number">80</span>,<span class="hljs-number">7</span>};
<span class="hljs-built_in">byte</span>[] decrypted = <span class="hljs-keyword">new</span> <span class="hljs-built_in">byte</span>[<span class="hljs-number">5</span>];
<span class="hljs-keyword">using</span> (SymmetricAlgorithm algorithm = Aes.Create())
<span class="hljs-keyword">using</span> (ICryptoTransform decryptor = algorithm.CreateDecryptor (key, iv))
<span class="hljs-keyword">using</span> (Stream f = File.OpenRead (<span class="hljs-string">&quot;encrypted.bin&quot;</span>))
<span class="hljs-keyword">using</span> (Stream c = <span class="hljs-keyword">new</span> CryptoStream (f, decryptor, CryptoStreamMode.Read))
 <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> b; (b = c.ReadByte()) &gt; <span class="hljs-number">-1</span>;)
   Console.Write (b + <span class="hljs-string">&quot; &quot;</span>);   <span class="hljs-comment">// ุฎุฑูุฌ: 1 2 3 4 5</span>
</code></pre>
<p>โก๏ธ ุฏุฑ ุงู ูุซุงูุ ฺฉ ฺฉูุฏ ฑถ ุจุงุช ุจูโุทูุฑ ุชุตุงุฏู ุณุงุฎุชู ุดุฏู ุงุณุช. ุงฺฏุฑ ฺฉูุฏ ุงุดุชุจุงู ุจุฑุง ุฑูุฒฺฏุดุง ุงุณุชูุงุฏู ุดูุฏุ <code>CryptoStream</code> ฺฉ ุงุณุชุซูุงุก ุงุฒ ููุน <code>CryptographicException</code> ุงุฌุงุฏ ูโฺฉูุฏ. ฺฏุฑูุชู ุงู ุงุณุชุซูุงุก ุชููุง ุฑุงู ุจุฑุง ุจุฑุฑุณ ุฏุฑุณุช ฺฉูุฏ ุงุณุช.</p>
<hr>
<h3>ููุด IV (Initialization Vector) ๐ฒ</h3>
<p>ุนูุงูู ุจุฑ ฺฉูุฏุ ูุง ฺฉ <strong>IV (Initialization Vector)</strong> ูู ุงุฌุงุฏ ฺฉุฑุฏู.<br>
ุงู ุฏูุจุงููโ ฑถ ุจุงุช ุจุฎุด ุงุฒ ุงูฺฏูุฑุชู ุฑูุฒูฺฏุงุฑ ุงุณุชุ ุดุจู ุจู ฺฉูุฏุ ุงูุง ูุญุฑูุงูู ูุญุณูุจ ููโุดูุฏ.</p>
<p>๐ฉ ุงฺฏุฑ ูพุงู ุฑูุฒูฺฏุงุฑโุดุฏู ุฑุง ููุชูู ฺฉูุฏุ ูุนูููุงู IV ุฑุง ุจูโุตูุฑุช <strong>plain text</strong> (ูุซูุงู ุฏุฑ ูุฏุฑ ูพุงู) ุงุฑุณุงู ฺฉุฑุฏู ู ุฏุฑ ูุฑ ูพุงู ุขู ุฑุง ุชุบุฑ ูโุฏูุฏ.<br>
ุงู ฺฉุงุฑ ุจุงุนุซ ูโุดูุฏ ูุฑ ูพุงู ุฑูุฒูฺฏุงุฑโุดุฏู ุจุง ูพุงูโูุง ูุจู ุบุฑูุงุจู ุชุดุฎุต ุจุงุดุฏโeven ุงฺฏุฑ ูุณุฎูโ ูุชู (unencrypted) ุขูโูุง ูุดุงุจู ุง ฺฉุณุงู ุจุงุดูุฏ.</p>
<ul>
<li>ุงฺฏุฑ ููโุฎูุงูุฏ ุงุฒ IV ุงุณุชูุงุฏู ฺฉูุฏุ ูโุชูุงูุฏ ฺฉ ููุฏุงุฑ ฑถ ุจุงุช ฺฉุณุงู ุฑุง ูู ุจูโุนููุงู ฺฉูุฏ ู ูู ุจูโุนููุงู IV ุจู ฺฉุงุฑ ุจุจุฑุฏ.<br>
โ๏ธ ุงูุง ุงุณุชูุงุฏู ุงุฒ ฺฉ IV ุซุงุจุช ุฏุฑ ฺูุฏ ูพุงูุ ุฑูุฒูฺฏุงุฑ ุฑุง ุถุนู ฺฉุฑุฏู ู ููฺฉู ุงุณุช ุขู ุฑุง ูุงุจู ูููุฐ ฺฉูุฏ.</li>
</ul>
<hr>
<h3>ููุด ฺฉูุงุณโูุง ๐จโ๐ง๐จโ๐ซ</h3>
<ul>
<li><strong>Aes</strong> โ ุฑุงุถโุฏุงู ุงุณุชุ ุงูฺฏูุฑุชู ุฑูุฒูฺฏุงุฑ ู ุนููุงุช Encryptor/Decryptor ุฑุง ุงุนูุงู ูโฺฉูุฏ.</li>
<li><strong>CryptoStream</strong> โ ููููโฺฉุด ุงุณุชุ ูุฏุฑุช ุฌุฑุงู ุฏุงุฏู (stream plumbing) ุฑุง ุจุฑ ุนูุฏู ุฏุงุฑุฏ.</li>
</ul>
<p>ุดูุง ูโุชูุงูุฏ <strong>Aes</strong> ุฑุง ุจุง ฺฉ ุงูฺฏูุฑุชู ูุชูุงุฑู ุฏฺฏุฑ ุฌุงฺฏุฒู ฺฉูุฏุ ุงูุง ููฺูุงู ุงุฒ <strong>CryptoStream</strong> ุงุณุชูุงุฏู ฺฉูุฏ.</p>
<p>๐ <code>CryptoStream</code> ุฏูุทุฑูู ุงุณุชุ ุจุณุชู ุจู ุงูุชุฎุงุจ ุดูุง (<code>CryptoStreamMode.Read</code> ุง <code>CryptoStreamMode.Write</code>) ูโุชูุงูุฏ ุจุฑุง ุฎูุงูุฏู ุง ููุดุชู ุงุณุชูุงุฏู ุดูุฏ.<br>
ูุฑ ุฏู Encryptor ู Decryptor ุชูุงูุง ุฎูุงูุฏู ู ููุดุชู ุฏุงุฑูุฏ ู ฺูุงุฑ ุชุฑฺฉุจ ููฺฉู ุงุฌุงุฏ ูโฺฉููุฏโุงู ูโุชูุงูุฏ ฺฏุงู ููุฌุจ ฺฏุฌ ุดุฏู ุดูุง ุดูุฏ!</p>
<p>๐ ุงฺฏุฑ ูุทูุฆู ูุณุชุฏ:</p>
<ul>
<li>ุจุฑุง ุฑูุฒูฺฏุงุฑ ุงุฒ <strong>Write</strong> ุดุฑูุน ฺฉูุฏ.</li>
<li>ุจุฑุง ุฑูุฒฺฏุดุง ุงุฒ <strong>Read</strong> ุดุฑูุน ฺฉูุฏ.</li>
</ul>
<p>ุงู ุญุงูุช ูุนูููุงู ุทุจุนโุชุฑู ุงูุชุฎุงุจ ุงุณุช.</p>
<hr>
<h3>ุชููุฏ ฺฉูุฏ ู IV ุชุตุงุฏู ๐ฒ</h3>
<p>ุจุฑุง ุชููุฏ ฺฉ ฺฉูุฏ ุง IV ุชุตุงุฏูุ ุงุฒ <code>RandomNumberGenerator</code> ุฏุฑ <code>System.Cryptography</code> ุงุณุชูุงุฏู ฺฉูุฏ.<br>
ุงุนุฏุงุฏ ฺฉู ุงู ฺฉูุงุณ ุชููุฏ ูโฺฉูุฏ ูุงูุนุงู ุบุฑูุงุจู ูพุดโุจู ู <strong>cryptographically strong</strong> ูุณุชูุฏ (ุจุฑุฎูุงู <code>System.Random</code>).</p>
<p>ูุซุงู:</p>
<pre class="hljs"><code><span class="hljs-built_in">byte</span>[] key = <span class="hljs-keyword">new</span> <span class="hljs-built_in">byte</span> [<span class="hljs-number">16</span>];
<span class="hljs-built_in">byte</span>[] iv  = <span class="hljs-keyword">new</span> <span class="hljs-built_in">byte</span> [<span class="hljs-number">16</span>];
RandomNumberGenerator rand = RandomNumberGenerator.Create();
rand.GetBytes (key);
rand.GetBytes (iv);
</code></pre>
<p>ุงุฒ .NET 6 ุจู ุจุนุฏ:</p>
<pre class="hljs"><code><span class="hljs-built_in">byte</span>[] key = RandomNumberGenerator.GetBytes (<span class="hljs-number">16</span>);
<span class="hljs-built_in">byte</span>[] iv = RandomNumberGenerator.GetBytes (<span class="hljs-number">16</span>);
</code></pre>
<p>ุงฺฏุฑ ฺฉูุฏ ู IV ูุดุฎุต ูฺฉูุฏุ ููุงุฏุฑ ุชุตุงุฏู ูู ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ุชููุฏ ูโุดููุฏ.<br>
ูโุชูุงูุฏ ุงู ููุงุฏุฑ ุฑุง ุงุฒ ุทุฑู ูฺฺฏโูุง <code>Key</code> ู <code>IV</code> ุฏุฑ ุดุก <code>Aes</code> ุฏุฑุงูุช ฺฉูุฏ.</p>
<h3>๐ ุฑูุฒูฺฏุงุฑ ุฏุฑ ุญุงูุธู</h3>
<p>ุงุฒ <strong>.NET 6</strong> ุจู ุจุนุฏุ ูโุชูุงูุฏ ุจุฑุง ุณุงุฏูโุณุงุฒ ูุฑุขูุฏ ุฑูุฒูฺฏุงุฑ ู ุฑูุฒฺฏุดุง ุขุฑุงูโูุง ุจุงุช ุงุฒ ูุชุฏูุง <strong>EncryptCbc</strong> ู <strong>DecryptCbc</strong> ุงุณุชูุงุฏู ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">byte</span>[] <span class="hljs-title">Encrypt</span> (<span class="hljs-params"><span class="hljs-built_in">byte</span>[] data, <span class="hljs-built_in">byte</span>[] key, <span class="hljs-built_in">byte</span>[] iv</span>)</span>
{
    <span class="hljs-keyword">using</span> Aes algorithm = Aes.Create();
    algorithm.Key = key;
    <span class="hljs-keyword">return</span> algorithm.EncryptCbc(data, iv);
}

<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">byte</span>[] <span class="hljs-title">Decrypt</span> (<span class="hljs-params"><span class="hljs-built_in">byte</span>[] data, <span class="hljs-built_in">byte</span>[] key, <span class="hljs-built_in">byte</span>[] iv</span>)</span>
{
    <span class="hljs-keyword">using</span> Aes algorithm = Aes.Create();
    algorithm.Key = key;
    <span class="hljs-keyword">return</span> algorithm.DecryptCbc(data, iv);
}
</code></pre>
<hr>
<h3>โ๏ธ ูุนุงุฏู ุณุงุฒฺฏุงุฑ ุจุง ููู ูุณุฎูโูุง .NET</h3>
<p>ุฏุฑ ูุณุฎูโูุง ูุฏูโุชุฑุ ุจุงุฏ ุงุฒ <strong>ICryptoTransform</strong> ู <strong>CryptoStream</strong> ุงุณุชูุงุฏู ฺฉูู:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">byte</span>[] <span class="hljs-title">Encrypt</span> (<span class="hljs-params"><span class="hljs-built_in">byte</span>[] data, <span class="hljs-built_in">byte</span>[] key, <span class="hljs-built_in">byte</span>[] iv</span>)</span>
{
    <span class="hljs-keyword">using</span> (Aes algorithm = Aes.Create())
    <span class="hljs-keyword">using</span> (ICryptoTransform encryptor = algorithm.CreateEncryptor(key, iv))
        <span class="hljs-keyword">return</span> Crypt(data, encryptor);
}

<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">byte</span>[] <span class="hljs-title">Decrypt</span> (<span class="hljs-params"><span class="hljs-built_in">byte</span>[] data, <span class="hljs-built_in">byte</span>[] key, <span class="hljs-built_in">byte</span>[] iv</span>)</span>
{
    <span class="hljs-keyword">using</span> (Aes algorithm = Aes.Create())
    <span class="hljs-keyword">using</span> (ICryptoTransform decryptor = algorithm.CreateDecryptor(key, iv))
        <span class="hljs-keyword">return</span> Crypt(data, decryptor);
}

<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-built_in">byte</span>[] <span class="hljs-title">Crypt</span> (<span class="hljs-params"><span class="hljs-built_in">byte</span>[] data, ICryptoTransform cryptor</span>)</span>
{
    MemoryStream m = <span class="hljs-keyword">new</span> MemoryStream();
    <span class="hljs-keyword">using</span> (Stream c = <span class="hljs-keyword">new</span> CryptoStream(m, cryptor, CryptoStreamMode.Write))
        c.Write(data, <span class="hljs-number">0</span>, data.Length);
    <span class="hljs-keyword">return</span> m.ToArray();
}
</code></pre>
<blockquote>
<p>๐ ุชูุฌู: ุญุงูุช <strong>CryptoStreamMode.Write</strong> ูู ุจุฑุง ุฑูุฒูฺฏุงุฑ ู ูู ุจุฑุง ุฑูุฒฺฏุดุง ููุงุณุจ ุงุณุชุ ุฒุฑุง ุฏุฑ ูุฑ ุฏู ุญุงูุช ุฏุงุฏูโูุง ุฑุง ุจู ุฏุงุฎู ฺฉ <strong>MemoryStream</strong> ุชุงุฒู &quot;ูพูุด&quot; ูโฺฉูู.</p>
</blockquote>
<hr>
<h3>๐ ูุณุฎู ูุฎุตูุต ุฑุดุชูโูุง (String)</h3>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">string</span> <span class="hljs-title">Encrypt</span> (<span class="hljs-params"><span class="hljs-built_in">string</span> data, <span class="hljs-built_in">byte</span>[] key, <span class="hljs-built_in">byte</span>[] iv</span>)</span>
{
    <span class="hljs-keyword">return</span> Convert.ToBase64String(
        Encrypt(Encoding.UTF8.GetBytes(data), key, iv));
}

<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">string</span> <span class="hljs-title">Decrypt</span> (<span class="hljs-params"><span class="hljs-built_in">string</span> data, <span class="hljs-built_in">byte</span>[] key, <span class="hljs-built_in">byte</span>[] iv</span>)</span>
{
    <span class="hljs-keyword">return</span> Encoding.UTF8.GetString(
        Decrypt(Convert.FromBase64String(data), key, iv));
}
</code></pre>
<p><strong>ููููู ุงุณุชูุงุฏู:</strong></p>
<pre class="hljs"><code><span class="hljs-built_in">byte</span>[] key = <span class="hljs-keyword">new</span> <span class="hljs-built_in">byte</span>[<span class="hljs-number">16</span>];
<span class="hljs-built_in">byte</span>[] iv = <span class="hljs-keyword">new</span> <span class="hljs-built_in">byte</span>[<span class="hljs-number">16</span>];
<span class="hljs-keyword">var</span> cryptoRng = RandomNumberGenerator.Create();
cryptoRng.GetBytes(key);
cryptoRng.GetBytes(iv);

<span class="hljs-built_in">string</span> encrypted = Encrypt(<span class="hljs-string">&quot;Yeah!&quot;</span>, key, iv);
Console.WriteLine(encrypted);   <span class="hljs-comment">// R1/5gYvcxyR2vzPjnT7yaQ==</span>
<span class="hljs-built_in">string</span> decrypted = Decrypt(encrypted, key, iv);
Console.WriteLine(decrypted);   <span class="hljs-comment">// Yeah!</span>
</code></pre>
<hr>
<h3>โ๏ธ ุฒูุฌุฑูโุณุงุฒ ุงุณุชุฑูโูุง (Chaining Streams)</h3>
<p>ุงุฒ ุขูโุฌุง ฺฉู <strong>CryptoStream ฺฉ ุฏฺฉูุฑุชูุฑ</strong> ุงุณุชุ ูโุชูุงูุฏ ุขู ุฑุง ุจุง ุณุงุฑ ุงุณุชุฑูโูุง ุฒูุฌุฑู ฺฉูุฏ. ุฏุฑ ูุซุงู ุฒุฑุ ฺฉ ูุชู ูุดุฑุฏู ู ุฑูุฒูฺฏุงุฑโุดุฏู ุฑุง ุฏุฑ ูุงู ุฐุฎุฑู ฺฉุฑุฏู ู ุณูพุณ ุจุงุฒุงุจ ูโฺฉูู:</p>
<pre class="hljs"><code><span class="hljs-built_in">byte</span>[] key = <span class="hljs-keyword">new</span> <span class="hljs-built_in">byte</span>[<span class="hljs-number">16</span>];
<span class="hljs-built_in">byte</span>[] iv = <span class="hljs-keyword">new</span> <span class="hljs-built_in">byte</span>[<span class="hljs-number">16</span>];
<span class="hljs-keyword">var</span> cryptoRng = RandomNumberGenerator.Create();
cryptoRng.GetBytes(key);
cryptoRng.GetBytes(iv);

<span class="hljs-keyword">using</span> (Aes algorithm = Aes.Create())
{
    <span class="hljs-keyword">using</span> (ICryptoTransform encryptor = algorithm.CreateEncryptor(key, iv))
    <span class="hljs-keyword">using</span> (Stream f = File.Create(<span class="hljs-string">&quot;serious.bin&quot;</span>))
    <span class="hljs-keyword">using</span> (Stream c = <span class="hljs-keyword">new</span> CryptoStream(f, encryptor, CryptoStreamMode.Write))
    <span class="hljs-keyword">using</span> (Stream d = <span class="hljs-keyword">new</span> DeflateStream(c, CompressionMode.Compress))
    <span class="hljs-keyword">using</span> (StreamWriter w = <span class="hljs-keyword">new</span> StreamWriter(d))
        <span class="hljs-keyword">await</span> w.WriteLineAsync(<span class="hljs-string">&quot;Small and secure!&quot;</span>);

    <span class="hljs-keyword">using</span> (ICryptoTransform decryptor = algorithm.CreateDecryptor(key, iv))
    <span class="hljs-keyword">using</span> (Stream f = File.OpenRead(<span class="hljs-string">&quot;serious.bin&quot;</span>))
    <span class="hljs-keyword">using</span> (Stream c = <span class="hljs-keyword">new</span> CryptoStream(f, decryptor, CryptoStreamMode.Read))
    <span class="hljs-keyword">using</span> (Stream d = <span class="hljs-keyword">new</span> DeflateStream(c, CompressionMode.Decompress))
    <span class="hljs-keyword">using</span> (StreamReader r = <span class="hljs-keyword">new</span> StreamReader(d))
        Console.WriteLine(<span class="hljs-keyword">await</span> r.ReadLineAsync());   <span class="hljs-comment">// Small and secure!</span>
}
</code></pre>
<p>๐ ุฏุฑ ุงู ูุซุงูุ ููู ูุชุบุฑูุง ฺฉโุญุฑู ุจุฎุด ุงุฒ ุฒูุฌุฑู ูุณุชูุฏ. ุงุฌุฒุง ุงุตู ูุซู <strong>algorithm</strong>ุ <strong>encryptor</strong> ู <strong>decryptor</strong> ุฏุฑ ูุงูุน ุจู <strong>CryptoStream</strong> ฺฉูฺฉ ูโฺฉููุฏ ุชุง ุนููุงุช ุฑูุฒูฺฏุงุฑ ู ุฑูุฒฺฏุดุง ุงูุฌุงู ุดูุฏ.</p>
<hr>
<p>โก ูฺฉุชู ููู: ุฒูุฌุฑูโุณุงุฒ ุงุณุชุฑูโูุง ุจู ุงู ุดฺฉูุ ุจุงุนุซ ูโุดูุฏ ฺฉู ุตุฑูโูุธุฑ ุงุฒ ุงูุฏุงุฒู ูุงู ุง ุฏุงุฏูุ ูุตุฑู ุญุงูุธู ุจุณุงุฑ ฺฉู ุจุงู ุจูุงูุฏ.</p>
 <div align="center">
<p><img src="../../../assets/image/20/Table-20-3.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>๐งน ูพุงฺฉโุณุงุฒ ุงุดุง ุฑูุฒูฺฏุงุฑ (Disposing Encryption Objects)</h3>
<p>ููุช ฺฉ <strong>CryptoStream</strong> ุฑุง Dispose ูโฺฉูุฏุ ฺฉุด ุฏุงุฎู ุขู ุจู ุงุณุชุฑู ุฒุฑู ููุชูู (Flush) ูโุดูุฏ. ุงู ฺฉุด ุฏุงุฎู ุจุฑุง ุงูฺฏูุฑุชูโูุง ุฑูุฒูฺฏุงุฑ ูุงุฒู ุงุณุชุ ฺูู ุขูโูุง ุฏุงุฏูโูุง ุฑุง ุจู ุตูุฑุช <strong>ุจููฺฉโูุง ุฏุงุฏู</strong> ูพุฑุฏุงุฒุด ูโฺฉููุฏุ ูู ุจุงุช ุจู ุจุงุช.</p>
<p>๐ ูฺฉุชู:</p>
<ul>
<li>ูุชุฏ <strong>Flush</strong> ุฏุฑ CryptoStream ูฺ ฺฉุงุฑ ุงูุฌุงู ููโุฏูุฏ.</li>
<li>ุจุฑุง <em>ููุงุด ฺฉุฑุฏู ุจุฏูู Dispose ฺฉุฑุฏู</em> ุจุงุฏ ุงุฒ <strong>FlushFinalBlock</strong> ุงุณุชูุงุฏู ฺฉูุฏ. ุงู ูุชุฏ ููุท ฺฉ ุจุงุฑ ูุงุจู ูุฑุงุฎูุงู ุงุณุช ู ุจุนุฏ ุงุฒ ุขู ุฏฺฏุฑ ููโุชูุงูุฏ ุฏุงุฏูโุง ุจููุณุฏ.</li>
</ul>
<p>ูุง ููฺูู ุงุดุง <strong>Aes</strong> ู <strong>ICryptoTransform</strong> (ุนู <code>algorithm</code>, <code>encryptor</code>, <code>decryptor</code>) ุฑุง Dispose ูโฺฉูู. ููุช ุงู Transformูุง Dispose ุดููุฏุ ฺฉูุฏ ูุชูุงุฑู ู ุฏุงุฏูโูุง ูุฑุชุจุท ุงุฒ ุญุงูุธู ูพุงฺฉ ูโุดููุฏ. ุงู ฺฉุงุฑ ุฌูู ฺฉุดู ฺฉูุฏ ุชูุณุท ูุฑูโุงูุฒุงุฑูุง ูุฎุฑุจ ุฑุง ูโฺฏุฑุฏ.<br>
ุจู <strong>Garbage Collector</strong> ููโุชูุงู ุงุนุชูุงุฏ ฺฉุฑุฏุ ฺูู ุขู ููุท ุญุงูุธู ุฑุง <em>ุขุฒุงุฏ</em> ูโฺฉูุฏุ ูู ุงูฺฉู ุจุงุชโูุง ุฑุง ุตูุฑ ฺฉูุฏ.</p>
<p>๐ ุณุงุฏูโุชุฑู ุฑุงู ุจุฑุง Dispose ฺฉุฑุฏู ฺฉ ุดุก <strong>Aes</strong> ุฎุงุฑุฌ ุงุฒ <code>using</code>ุ ูุฑุงุฎูุงู ูุชุฏ <strong>Clear</strong> ุงุณุช.<br>
ูุชุฏ <strong>Dispose</strong> ุขู ุจู ุตูุฑุช explicit ูพุงุฏูโุณุงุฒ ุดุฏู ุชุง ูุดุงู ุฏูุฏ ุงู Dispose ุบุฑูุนููู ุงุณุช (ูพุงฺฉ ฺฉุฑุฏู ุญุงูุธู ุจูโุฌุง ุขุฒุงุฏุณุงุฒ ููุงุจุน unmanaged).</p>
<h4>๐ ูฺฉุงุช ุงููุช ุจุฑุง ุฌููฺฏุฑ ุงุฒ ูุดุช ุฏุงุฏูโูุง ุญุณุงุณ</h4>
<ul>
<li>โ ุงุฒ <strong>ุฑุดุชูโูุง (string)</strong> ุจุฑุง ุงุทูุงุนุงุช ุงููุช ุงุณุชูุงุฏู ูฺฉูุฏ (ุฑุดุชูโูุง ุชุบุฑูุงูพุฐุฑูุฏ ู ููุฏุงุฑุดุงู ูุฑฺฏุฒ ูุงุจู ูพุงฺฉ ฺฉุฑุฏู ูุณุช).</li>
<li>โ ุจูุงูุงุตูู ุจุนุฏ ุงุฒ ุจโุงุณุชูุงุฏู ุดุฏูุ ุจุงูุฑูุง ุฑุง ุจุงุฒููุณ ฺฉูุฏ (ูุซูุงู ุจุง <code>Array.Clear</code>).</li>
</ul>
<hr>
<h3>๐ ูุฏุฑุช ฺฉูุฏ (Key Management)</h3>
<p>ูุฏุฑุช ฺฉูุฏ ุจุฎุด ุญุงุช ุงููุช ุงุณุช: ุงฺฏุฑ ฺฉูุฏูุง ูู ุจุฑููุฏุ ุฏุงุฏูโูุง ูู ุฏุฑ ุฎุทุฑ ุฎูุงููุฏ ุจูุฏ.</p>
<ul>
<li>ุจุงุฏ ูุดุฎุต ฺฉูุฏ ฺู ฺฉุณุงู ุจู ฺฉูุฏูุง ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดูุฏ.</li>
<li>ฺฉูุฏูุง ุฑุง ุฏุฑ ุจุฑุงุจุฑ ุฏุณุชุฑุณ ุบุฑูุฌุงุฒ ูุญุงูุธุช ฺฉูุฏ.</li>
<li>ูุณุฎูโูุง ูพุดุชุจุงู ุฏุงุดุชู ุจุงุดุฏ (ุจุฑุง ููุงูุน ุฎุฑุงุจ ุณุฎุชโุงูุฒุงุฑ).</li>
</ul>
<p>๐ซ ุชูุตู ููโุดูุฏ ฺฉูุฏูุง ุฑุง <strong>ุณุฎุชโฺฉุฏ (hardcode)</strong> ฺฉูุฏุ ฺูู ุงุจุฒุงุฑูุง ุณุงุฏูโุง ุจุฑุง ุฏฺฉุงููพุงู ุงุณูุจูโูุง ูุฌูุฏ ุฏุงุฑุฏ.<br>
โ ุฑุงู ุจูุชุฑ ุฏุฑ ููุฏูุฒ: ุชููุฏ ฺฉูุฏ ุชุตุงุฏู ุจุฑุง ูุฑ ูุตุจ ู ุฐุฎุฑู ุขู ุจุง ุงุณุชูุงุฏู ุงุฒ <strong>Windows Data Protection</strong>.</p>
<p>ุฏุฑ <strong>ุงุจุฑ (Cloud)</strong>ุ ุณุฑูุณโูุง ูุซู <strong>Azure</strong> ู <strong>AWS</strong> ุณุณุชูโูุง ูุฏุฑุช ฺฉูุฏ (KMS) ุงุฑุงุฆู ูโุฏููุฏ ฺฉู ูุงุจูุชโูุง ูุซู ุซุจุช ูุงฺฏ ุฏุณุชุฑุณโูุง (audit trails) ุฏุงุฑูุฏ.</p>
<hr>
<h3>๐ ุฑูุฒูฺฏุงุฑ ฺฉูุฏ ุนููู (Public-Key Encryption and Signing)</h3>
<p>ุฑูุฒูฺฏุงุฑ ฺฉูุฏ ุนููู <strong>ูุงูุชูุงุฑู (asymmetric)</strong> ุงุณุชุ ุนู ุจุฑุง ุฑูุฒูฺฏุงุฑ ู ุฑูุฒฺฏุดุง ุงุฒ <strong>ฺฉูุฏูุง ูุชูุงูุช</strong> ุงุณุชูุงุฏู ูโุดูุฏ:</p>
<ul>
<li>๐ ฺฉูุฏ ุนููู (<strong>public key</strong>) โ ุจุฑุง ุฑูุฒูฺฏุงุฑ</li>
<li>๐ ฺฉูุฏ ุฎุตูุต (<strong>private key</strong>) โ ุจุฑุง ุฑูุฒฺฏุดุง</li>
</ul>
<p>ูฺฺฏ ููู:</p>
<ul>
<li>ุงุฒ ุฑู ฺฉูุฏ ุนููู ููโุชูุงู ฺฉูุฏ ุฎุตูุต ุฑุง ูุญุงุณุจู ฺฉุฑุฏ.</li>
<li>ุงฺฏุฑ ฺฉูุฏ ุฎุตูุต ฺฏู ุดูุฏุ ุฏุงุฏูโูุง ุฑูุฒูฺฏุงุฑโุดุฏู ุจุงุฒุงุจ ููโุดููุฏ.</li>
<li>ุงฺฏุฑ ฺฉูุฏ ุฎุตูุต ูู ุจุฑูุฏุ ฺฉู ุณุณุชู ุฑูุฒูฺฏุงุฑ ุจโูุงุฏู ูโุดูุฏ.</li>
</ul>
<hr>
<h3>๐ก ูุซุงู: ุงุฑุชุจุงุท ุงูู ุฏู ฺฉุงููพูุชุฑ ุงุฒ ุทุฑู ฺฉูุฏ ุนููู</h3>
<p>ูุฑุถ ฺฉูุฏ <strong>Origin</strong> ูโุฎูุงูุฏ ุจู <strong>Target</strong> ูพุงู ูุญุฑูุงูู ุจูุฑุณุชุฏ:</p>
<ol>
<li><strong>Target</strong> ฺฉ ุฌูุช ฺฉูุฏ ุนููู/ุฎุตูุต ูโุณุงุฒุฏ ู ฺฉูุฏ ุนููู ุฑุง ุจุฑุง Origin ูโูุฑุณุชุฏ.</li>
<li><strong>Origin</strong> ูพุงู ูุญุฑูุงูู ุฑุง ุจุง ฺฉูุฏ ุนููู Target ุฑูุฒูฺฏุงุฑ ฺฉุฑุฏู ู ุงุฑุณุงู ูโฺฉูุฏ.</li>
<li><strong>Target</strong> ูพุงู ุฑุง ุจุง ฺฉูุฏ ุฎุตูุต ุฎูุฏุด ุฑูุฒฺฏุดุง ูโฺฉูุฏ.</li>
</ol>
<p>๐ ุดููุฏฺฉููุฏู (eavesdropper) ููุท ุงูโูุง ุฑุง ูโุจูุฏ:</p>
<ul>
<li>ฺฉูุฏ ุนููู Target</li>
<li>ูพุงู ุฑูุฒูฺฏุงุฑโุดุฏู ุจุง ุขู ฺฉูุฏ</li>
</ul>
<p>ุงูุง ุจุฏูู ฺฉูุฏ ุฎุตูุต Targetุ ููโุชูุงูุฏ ูพุงู ุฑุง ุฑูุฒฺฏุดุง ฺฉูุฏ.</p>
<hr>
<h3>โ๏ธ ูฺฉุชู ุงููุช: ุญููู ูุฑุฏ ูุงู (MITM)</h3>
<p>Origin ูุทูุฆู ูุณุช ฺฉู Target ูุงูุน ุงุณุช ุง ูุฑุฏ ูุฎุฑุจ!<br>
ุฑุงูโุญู:</p>
<ul>
<li>ุงุฒ ูุจู ฺฉูุฏ ุนููู Target ุฑุง ุจุดูุงุณุฏ.</li>
<li>ุง ฺฉูุฏ ุนููู ุฑุง ุงุฒ ุทุฑู ฺฉ <strong>ฺฏูุงู ุฏุฌุชุงู (digital certificate)</strong> ูุนุชุจุฑ ุชุฃุฏ ฺฉูุฏ.</li>
</ul>
<hr>
<h3>๐ ุชุฑฺฉุจ ฺฉูุฏ ุนููู ู ูุชูุงุฑู</h3>
<p>ุฑูุฒูฺฏุงุฑ ฺฉูุฏ ุนููู ฺฉูุฏ ุงุณุช ู ุงูุฏุงุฒู ูพุงู ูุญุฏูุฏ ุฏุงุฑุฏ.<br>
ุจู ููู ุฏูู ูุนูููุงู ูพุงู ุงููู ููุท ุดุงูู ฺฉ ฺฉูุฏ ูุชูุงุฑู ุชุงุฒู ุงุณุช.</p>
<p>๐ ุฑููุฏ:</p>
<ul>
<li>Origin โ ฺฉูุฏ ูุชูุงุฑู ุฑุง ุจุง ฺฉูุฏ ุนููู Target ุฑูุฒ ูโฺฉูุฏ ู ูโูุฑุณุชุฏ.</li>
<li>Target โ ฺฉูุฏ ูุชูุงุฑู ุฑุง ุจุง ฺฉูุฏ ุฎุตูุตโุงุด ุฑูุฒฺฏุดุง ูโฺฉูุฏ.</li>
<li>ุจูู ูพุงูโูุง โ ุจุง ุงูฺฏูุฑุชู ูุชูุงุฑู (ุณุฑุนโุชุฑ) ุฑูุฒ ูโุดููุฏ.</li>
</ul>
<p>ุงฺฏุฑ ุจุฑุง ูุฑ ุฌูุณู ฺฉ ุฌูุช ฺฉูุฏ ุนููู/ุฎุตูุต ุชุงุฒู ุณุงุฎุชู ุดูุฏุ ุงููุช ุจุงูุงุชุฑ ูโุฑูุฏ ฺูู ุฏฺฏุฑ ูุงุฒ ุจู ุฐุฎุฑูโุณุงุฒ ฺฉูุฏูุง ุฏุฑ ูฺโฺฉุฏุงู ุงุฒ ฺฉุงููพูุชุฑูุง ูุณุช.</p>
<hr>
<h3>๐ ูุญุฏูุฏุช ฺฉูุฏ ุนููู</h3>
<p>ุงูฺฏูุฑุชูโูุง ฺฉูุฏ ุนููู ููุท ูพุงูโูุง ุฑุง ุฑูุฒ ูโฺฉููุฏ ฺฉู ุงุฒ ุฎูุฏ ฺฉูุฏ <strong>ฺฉูฺฺฉโุชุฑ ุจุงุดูุฏ</strong>.<br>
ุจูุงุจุฑุงู ุจุฑุง ูพุงูโูุง ุจุฒุฑฺฏ (ุจุดุชุฑ ุงุฒ ูุตู ุงูุฏุงุฒู ฺฉูุฏ)ุ ุงุณุชุซูุง (Exception) ูพุฑุชุงุจ ูโุดูุฏ.</p>
<h3>๐ ฺฉูุงุณ RSA ุฏุฑ .NET</h3>
<p>ุฏุฑ .NET ฺูุฏู ุงูฺฏูุฑุชู ูุงูุชูุงุฑู ูุฌูุฏ ุฏุงุฑุฏ ฺฉู <strong>RSA</strong> ูุญุจูุจโุชุฑู ุขูโูุงุณุช.</p>
<h4>๐ ุฑูุฒูฺฏุงุฑ ู ุฑูุฒฺฏุดุง ุจุง RSA</h4>
<pre class="hljs"><code><span class="hljs-built_in">byte</span>[] data = { <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span> };   <span class="hljs-comment">// ุฏุงุฏูโุง ฺฉู ูโุฎูุงูู ุฑูุฒ ฺฉูู</span>
<span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> rsa = <span class="hljs-keyword">new</span> RSACryptoServiceProvider())
{
    <span class="hljs-built_in">byte</span>[] encrypted = rsa.Encrypt(data, <span class="hljs-literal">true</span>);
    <span class="hljs-built_in">byte</span>[] decrypted = rsa.Decrypt(encrypted, <span class="hljs-literal">true</span>);
}
</code></pre>
<p>ฺูู ูฺ ฺฉูุฏ ุนููู ุง ุฎุตูุตโุง ูุดุฎุต ูฺฉุฑุฏูุ ูุฑุงููโฺฉููุฏู ุฑูุฒูฺฏุงุฑ ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ฺฉ ุฌูุช ฺฉูุฏ (Key Pair) ุจุง ุทูู ูพุดโูุฑุถ <strong>ูกููขูค ุจุช</strong> ุณุงุฎุช.<br>
ูโุชูุงูุฏ ฺฉูุฏูุง ุจููุฏุชุฑ (ุฏุฑ ูุถุงุฑุจ ูจ ุจุงุช) ุจุฎูุงูุฏ. ุจุฑุง ุจุฑูุงููโูุง ุงููุช ุญุณุงุณุ ุงุณุชูุงุฏู ุงุฒ <strong>ูขููคูจ ุจุช</strong> ุชูุตู ูโุดูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> rsa = <span class="hljs-keyword">new</span> RSACryptoServiceProvider(<span class="hljs-number">2048</span>);
</code></pre>
<p>ุณุงุฎุช ฺฉูุฏ ูุญุงุณุจุงุช ุณูฺฏู ุงุณุช (ุญุฏูุฏ <strong>ูกู ููโุซุงูู</strong> ุทูู ูโฺฉุดุฏ). ุจู ููู ุฏููุ ูพุงุฏูโุณุงุฒ RSA ุชููุฏ ฺฉูุฏ ุฑุง ุชุง ุฒูุงู ฺฉู ูุงูุนุงู ูุงุฒู ุจุงุดุฏ (ูุซูุงู ููฺฏุงู ูุฑุงุฎูุงู <code>Encrypt</code>) ุจู ุชุฃุฎุฑ ูโุงูุฏุงุฒุฏ. ุงู ูุฑุตุช ุฑุง ูโุฏูุฏ ฺฉู ุงฺฏุฑ ฺฉูุฏ ููุฌูุฏ ุฏุงุฑุฏุ ุขู ุฑุง ุจุงุฑฺฏุฐุงุฑ ฺฉูุฏ.</p>
<hr>
<h3>๐พ ุฐุฎุฑูโุณุงุฒ ู ุจุงุฑฺฏุฐุงุฑ ฺฉูุฏูุง</h3>
<ul>
<li>ูุชุฏูุง <strong>ImportCspBlob</strong> ู <strong>ExportCspBlob</strong>: ุจุงุฑฺฏุฐุงุฑ/ุฐุฎุฑู ฺฉูุฏ ุฏุฑ ูุงูุจ ุขุฑุงู ุจุงุช.</li>
<li>ูุชุฏูุง <strong>FromXmlString</strong> ู <strong>ToXmlString</strong>: ููู ฺฉุงุฑ ุฑุง ุฏุฑ ูุงูุจ ุฑุดุชู (XML) ุงูุฌุงู ูโุฏููุฏ.</li>
</ul>
<p>ูพุงุฑุงูุชุฑ ุจูู ุชุนู ูโฺฉูุฏ ฺฉู ฺฉูุฏ ุฎุตูุต ูู ุฐุฎุฑู ุดูุฏ ุง ูู.</p>
<p>ูุซุงู: ุณุงุฎุช ฺฉ ุฌูุช ฺฉูุฏ ู ุฐุฎุฑู ุขู ุฑู ุฏุณฺฉ:</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> rsa = <span class="hljs-keyword">new</span> RSACryptoServiceProvider())
{
    File.WriteAllText(<span class="hljs-string">&quot;PublicKeyOnly.xml&quot;</span>, rsa.ToXmlString(<span class="hljs-literal">false</span>));
    File.WriteAllText(<span class="hljs-string">&quot;PublicPrivate.xml&quot;</span>, rsa.ToXmlString(<span class="hljs-literal">true</span>));
}
</code></pre>
<p>ฺูู ฺฉูุฏ ูุฏุงุดุชูุ ุงููู ุจุงุฑ <code>ToXmlString</code> ูุฌุจูุฑ ุดุฏ ฺฉ ุฌูุช ฺฉูุฏ ุชุงุฒู ุจุณุงุฒุฏ.</p>
<p>ุจุงุฑฺฏุฐุงุฑ ูุฌุฏุฏ ู ุงุณุชูุงุฏู ุงุฒ ุขูโูุง:</p>
<pre class="hljs"><code><span class="hljs-built_in">byte</span>[] data = Encoding.UTF8.GetBytes(<span class="hljs-string">&quot;Message to encrypt&quot;</span>);
<span class="hljs-built_in">string</span> publicKeyOnly = File.ReadAllText(<span class="hljs-string">&quot;PublicKeyOnly.xml&quot;</span>);
<span class="hljs-built_in">string</span> publicPrivate = File.ReadAllText(<span class="hljs-string">&quot;PublicPrivate.xml&quot;</span>);
<span class="hljs-built_in">byte</span>[] encrypted, decrypted;

<span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> rsaPublicOnly = <span class="hljs-keyword">new</span> RSACryptoServiceProvider())
{
    rsaPublicOnly.FromXmlString(publicKeyOnly);
    encrypted = rsaPublicOnly.Encrypt(data, <span class="hljs-literal">true</span>);

    <span class="hljs-comment">// ุฎุทุง: ฺูู ฺฉูุฏ ุฎุตูุต ูุฏุงุฑู ููโุชูุงูู Decrypt ฺฉูู:</span>
    <span class="hljs-comment">// decrypted = rsaPublicOnly.Decrypt(encrypted, true);</span>
}

<span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> rsaPublicPrivate = <span class="hljs-keyword">new</span> RSACryptoServiceProvider())
{
    rsaPublicPrivate.FromXmlString(publicPrivate);
    decrypted = rsaPublicPrivate.Decrypt(encrypted, <span class="hljs-literal">true</span>); <span class="hljs-comment">// ููููุชโุขูุฒ</span>
}
</code></pre>
<hr>
<h3>๐๏ธ ุงูุถุง ุฏุฌุชุงู (Digital Signing)</h3>
<p>ุงูฺฏูุฑุชูโูุง ฺฉูุฏ ุนููู ุจุฑุง <strong>ุงูุถุง ุฏุฌุชุงู</strong> ูู ุงุณุชูุงุฏู ูโุดููุฏ.<br>
ุงูุถุง ูุซู Hash ุงุณุชุ ุจุง ุงู ุชูุงูุช ฺฉู ุชููุฏ ุขู ุจู ฺฉูุฏ ุฎุตูุต ูุงุฒ ุฏุงุฑุฏ ู ุฌุนูโูพุฐุฑ ูุณุช. ฺฉูุฏ ุนููู ุจุฑุง ุชุฃุฏ ุงูุถุง ุงุณุชูุงุฏู ูโุดูุฏ.</p>
<p>ูุซุงู:</p>
<pre class="hljs"><code><span class="hljs-built_in">byte</span>[] data = Encoding.UTF8.GetBytes(<span class="hljs-string">&quot;Message to sign&quot;</span>);
<span class="hljs-built_in">byte</span>[] publicKey;
<span class="hljs-built_in">byte</span>[] signature;
<span class="hljs-built_in">object</span> hasher = SHA1.Create(); <span class="hljs-comment">// ุงูฺฏูุฑุชู ูุด ุงูุชุฎุงุจ ูุง</span>

<span class="hljs-comment">// ุชููุฏ ุฌูุช ฺฉูุฏ ุฌุฏุฏ ู ุงูุถุง ุฏุงุฏู:</span>
<span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> publicPrivate = <span class="hljs-keyword">new</span> RSACryptoServiceProvider())
{
    signature = publicPrivate.SignData(data, hasher);
    publicKey = publicPrivate.ExportCspBlob(<span class="hljs-literal">false</span>); <span class="hljs-comment">// ฺฏุฑูุชู ฺฉูุฏ ุนููู</span>
}

<span class="hljs-comment">// ุณุงุฎุช RSA ุฌุฏุฏ ุจุง ฺฉูุฏ ุนููู ู ุชุณุช ุงูุถุง:</span>
<span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> publicOnly = <span class="hljs-keyword">new</span> RSACryptoServiceProvider())
{
    publicOnly.ImportCspBlob(publicKey);
    Console.Write(publicOnly.VerifyData(data, hasher, signature)); <span class="hljs-comment">// True</span>

    <span class="hljs-comment">// ุชุบุฑ ุฏุงุฏู ู ุชุณุช ุฏูุจุงุฑู:</span>
    data[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;
    Console.Write(publicOnly.VerifyData(data, hasher, signature)); <span class="hljs-comment">// False</span>

    <span class="hljs-comment">// ุฎุทุง: ฺูู ฺฉูุฏ ุฎุตูุต ูุฏุงุฑู ููโุชูุงูู ุงูุถุง ุชููุฏ ฺฉูู:</span>
    signature = publicOnly.SignData(data, hasher);
}
</code></pre>
<hr>
<h3>โ๏ธ ุฌุฒุฆุงุช ุนููฺฉุฑุฏ ุงูุถุง</h3>
<p>ุงูุถุง ุจุง ุงู ูุฑุงุญู ุงูุฌุงู ูโุดูุฏ:</p>
<ol>
<li>ุฏุงุฏู ุงุจุชุฏุง <strong>ูุด</strong> ูโุดูุฏ.</li>
<li>ุงูฺฏูุฑุชู ูุงูุชูุงุฑู (RSA) ุฑู ูุด ุงุนูุงู ูโุดูุฏ.</li>
</ol>
<p>ุงุฒ ุขูุฌุง ฺฉู ูุด ุงูุฏุงุฒู ฺฉูฺฺฉ ุฏุงุฑุฏุ ุงูุถุง ุงุณูุงุฏ ุจุฒุฑฺฏ ุณุฑุน ุงูุฌุงู ูโุดูุฏ (ฺูู RSA ุจูโุชููุง ูพุฑูุฒููโุชุฑ ุงุณุช).</p>
<p>ูโุชูุงูุฏ ูุด ุฑุง ุฎูุฏุชุงู ูุญุงุณุจู ฺฉูุฏ ู ุณูพุณ ุงุฒ <strong>SignHash</strong> ุจูโุฌุง <code>SignData</code> ุงุณุชูุงุฏู ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> rsa = <span class="hljs-keyword">new</span> RSACryptoServiceProvider())
{
    <span class="hljs-built_in">byte</span>[] hash = SHA1.Create().ComputeHash(data);
    signature = rsa.SignHash(hash, CryptoConfig.MapNameToOID(<span class="hljs-string">&quot;SHA1&quot;</span>));
}
</code></pre>
<p><code>SignHash</code> ุจุงุฏ ุจุฏุงูุฏ ุงุฒ ฺู ุงูฺฏูุฑุชู ุจุฑุง ูุด ุงุณุชูุงุฏู ฺฉุฑุฏูโุงุฏ. ูุชุฏ <code>CryptoConfig.MapNameToOID</code> ุงู ุงุทูุงุนุงุช ุฑุง ุงุฒ ฺฉ ูุงู ุณุงุฏู ูุซู <code>&quot;SHA1&quot;</code> ูุฑุงูู ูโฺฉูุฏ.</p>
<p>๐ ุงูุฏุงุฒู ุงูุถุง: ุฎุฑูุฌ ุงูุถุง ุจุง ุงูุฏุงุฒู ฺฉูุฏ ุจุฑุงุจุฑ ุงุณุช. ุฏุฑ ุญุงู ุญุงุถุฑ ุงูฺฏูุฑุชู ฺฉู ุงูุถุง ุงูู ฺฉูฺฺฉุชุฑ ุงุฒ <strong>ูกูขูจ ุจุงุช</strong> ุชููุฏ ฺฉูุฏ (ุจุฑุง ูุซุงู ฺฉุฏ ูุนุงูโุณุงุฒ ูุญุตูู) ูุฌูุฏ ูุฏุงุฑุฏ.</p>
<hr>
<h3>๐ ุงุนุชูุงุฏ ุจู ฺฉูุฏ ุนููู</h3>
<p>ุจุฑุง ุงูฺฉู ุงูุถุง ูุนุชุจุฑ ุจุงุดุฏุ ฺฏุฑูุฏู ุจุงุฏ ฺฉูุฏ ุนููู ูุฑุณุชูุฏู ุฑุง ุจุดูุงุณุฏ ู ุจู ุขู ุงุนุชูุงุฏ ฺฉูุฏ. ุงู ูโุชูุงูุฏ ุงุฒ ุฑุงูโูุง ุฒุฑ ุงูุฌุงู ุดูุฏ:</p>
<ul>
<li>ุงุฑุชุจุงุท ูุจู</li>
<li>ูพฺฉุฑุจูุฏ ุงุฒ ูพุด</li>
<li>ุง ุงุณุชูุงุฏู ุงุฒ <strong>ฺฏูุงู ุฏุฌุชุงู (site certificate)</strong></li>
</ul>
<p>๐ ฺฉ ฺฏูุงู ุฏุฌุชุงู ุฑฺฉูุฑุฏ ุงูฺฉุชุฑููฺฉ ฺฉูุฏ ุนููู ู ูุงู ูุฑุณุชูุฏู ุงุณุช ฺฉู ุฎูุฏุด ุชูุณุท ฺฉ ูุฑุฌุน ูุนุชุจุฑ ูุณุชูู ุงูุถุง ุดุฏู ุงุณุช.</p>
<p>๐ฆ ูุถุง ูุงู <code>System.Security.Cryptography.X509Certificates</code> ุงููุงุน ูุงุฒู ุจุฑุง ฺฉุงุฑ ุจุง ฺฏูุงูโูุง ุฑุง ูุฑุงูู ูโฺฉูุฏ.</p>

  </main>

  <!-- ููุชุฑ ูุดุชุฑฺฉ -->
  <footer class="footer">
    <div class="container">
      <p>
        <img src="/Gitab/icone/copyright.svg" alt="ฺฉูพโุฑุงุช" width="14" height="14"
             style="vertical-align:middle;margin-inline:4px">
        <span id="y"></span> Gitab โ ุจุฑุง ุชูุณุนูโุฏููุฏฺฏุงู
      </p>
    </div>
  </footer>

  <!-- ุณุงู ู ุงุณฺฉุฑูพุช ุชุบุฑ ุชู -->
  <script>
  (() => {
    const root = document.documentElement;
    const btn = document.getElementById('themeToggle');
    const KEY = 'gitab-theme';
    const media = window.matchMedia('(prefers-color-scheme: dark)');
    const getEffective = s => (s === 'auto' ? (media.matches ? 'dark' : 'light') : s);

    function updateTheme(s) {
      root.setAttribute('data-theme', s);
      const mode = getEffective(s);
      root.dataset.colorMode = mode;
      btn.dataset.icon = mode === 'dark' ? 'moon' : 'sun';
    }

    let saved = localStorage.getItem(KEY) || 'auto';
    updateTheme(saved);

    btn.addEventListener('click', () => {
      const current = localStorage.getItem(KEY) || 'auto';
      const next = current === 'auto' ? 'dark' : current === 'dark' ? 'light' : 'auto';
      localStorage.setItem(KEY, next);
      updateTheme(next);
    });

    media.addEventListener('change', () => {
      if ((localStorage.getItem(KEY) || 'auto') === 'auto') updateTheme('auto');
    });

    document.addEventListener('DOMContentLoaded', () => {
      updateTheme(localStorage.getItem(KEY) || 'auto');
    });
  })();
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>

  <script>
  document.querySelectorAll('pre code').forEach(block => {
    const btn = document.createElement('button');
    btn.className = 'copy-btn';

    const icon = document.createElement('img');
    icon.src = "/Gitab/icone/copy.svg";
    icon.alt = 'Copy';
    btn.appendChild(icon);

    block.parentNode.insertBefore(btn, block);

    btn.addEventListener('click', async () => {
      await navigator.clipboard.writeText(block.textContent);
      btn.classList.add('copied');
      setTimeout(() => btn.classList.remove('copied'), 1500);
    });
  });
  </script>

  <script>
  document.body.dataset.page = window.location.pathname;

  const menuBtn = document.querySelector(".menu-toggle");
  const nav = document.querySelector(".nav");

  if (menuBtn && nav) {
    menuBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      nav.classList.toggle("show");
    });

    document.addEventListener("click", (e) => {
      const clickedInsideNav = nav.contains(e.target);
      const clickedMenuButton = menuBtn.contains(e.target);
      if (!clickedInsideNav && !clickedMenuButton) {
        nav.classList.remove("show");
      }
    });
  }
  </script>

  <script>
    document.getElementById('y').textContent = new Date().getFullYear();
  </script>
</body>
</html>
