

<!doctype html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8">
  <link rel="icon" type="image/png" href="/Gitab/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>LINQ to XML</title>
  <meta name="description" content="ุชุฑุฌููโูุง ูุงุฑุณ ฺฉุชุงุจโูุง ูู โ ุณุฑุนุ ูููุงู ู ูุงุจู ุงุชฺฉุง.">

  <!-- ุงุณุชุงูโูุง -->
  <link rel="stylesheet" href="/Gitab/styles/main.css">
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">

  <style>
  @font-face {
    font-family: 'Vazir';
    src: url('/Gitab/fonts/Vazir-FD-WOL.ttf') format('truetype');
    font-display: swap;
  }
  body {
    font-family: 'Vazir', sans-serif;
  }
  </style>
</head>

<body>
  <!-- ูุฏุฑ ูุดุชุฑฺฉ -->
  <header class="header">
    <div class="container nav-wrap">
      <a href="/Gitab/" class="brand">
        <img src="/Gitab/icone/logo.svg" alt="Gitab logo" width="26" height="26">
        <span>Gitab</span>
      </a>

      <nav class="nav">
        <a href="/Gitab/" aria-current="page">ุฎุงูู</a>
        <a href="/Gitab/books/list-books">ฺฉุชุงุจโูุง</a>
       <a href="/Gitab/translator.html">ูุชุฑุฌูู</a>
        <a href="/Gitab/giter.html">ฺฏุชุฑ</a>
      </nav>

      <div class="nav-actions">
        <button id="themeToggle" class="icon-btn theme-btn" data-icon="moon" aria-label="ุชุบุฑ ุชู">
          <img src="/Gitab/icone/sun.svg" class="icon-sun" alt="ุฑูุดู">
          <img src="/Gitab/icone/moon.svg" class="icon-moon" alt="ุชุงุฑฺฉ">
        </button>

        <a class="icon-btn" href="https://github.com/hheydarian/Gitab" target="_blank" title="GitHub">
          <img src="/Gitab/icone/github.svg" alt="GitHub">
        </a>

        <!-- ุฏฺฉูู ููู ุจุฑุง ููุจุงู -->
        <button class="menu-toggle" aria-label="ููู">
          <img src="/Gitab/icone/menu.svg" alt="menu">
        </button>
      </div>
    </div>
  </header>

  
  <main class="site-main book-page">
    <h1>ูุตู ุฏูู:  LINQ to XML</h1>
<p>.NET ุชุนุฏุงุฏ ุฒุงุฏ API ุจุฑุง ฺฉุงุฑ ุจุง ุฏุงุฏูโูุง XML ูุฑุงูู ูโฺฉูุฏ. ุงูุชุฎุงุจ ุงุตู ุจุฑุง ูพุฑุฏุงุฒุด ุนููู ุงุณูุงุฏ XMLุ <strong>LINQ to XML</strong> ุงุณุช.<br>
LINQ to XML ุดุงูู ฺฉ ูุฏู ุดุก ุณูุฏ XML (<strong>DOM</strong>) ุณุจฺฉ ู ุณุงุฒฺฏุงุฑ ุจุง LINQ ุงุณุชุ ุจูโุนูุงูู ูุฌููุนูโุง ุงุฒ ุนููฺฏุฑูุง ูพุฑุณโูุฌู ุชฺฉูู.</p>
<p>ุฏุฑ ุงู ูุตูุ ูุง ุจูโุทูุฑ ฺฉุงูู ุฑู LINQ to XML ุชูุฑฺฉุฒ ูโฺฉูู. ุฏุฑ ูุตู ฑฑุ ุจู <strong>ุฎูุงููุฏู/ููุณูุฏู XML</strong> ฺฉโุทุฑูู (forward-only) ูโูพุฑุฏุงุฒู ู ุฏุฑ ุถูููโ ุขููุงูุ ููุนโูุง ุจุฑุง ฺฉุงุฑ ุจุง <strong>schemaูุง</strong> ู <strong>stylesheetูุง</strong> ุฑุง ูพูุดุด ูโุฏูู. .NET ููฺูู ุดุงูู DOM ูุฏู ูุจุชู ุจุฑ <strong>XmlDocument</strong> ุงุณุช ฺฉู ูุง ุขู ุฑุง ูพูุดุด ููโุฏูู.</p>
<p>DOM ูุฑุจูุท ุจู LINQ to XML ุจุณุงุฑ ุฎูุจ ุทุฑุงุญ ุดุฏู ู ุงุฒ ูุธุฑ ฺฉุงุฑุง ุจุณุงุฑ ูู ุงุณุช. ุญุช ุจุฏูู LINQุ ุงู DOM ุจูโุนููุงู ฺฉ ูุงูโ ุณุจฺฉ ุฑู ฺฉูุงุณโูุง ุณุทุญ ูพุงู <strong>XmlReader</strong> ู <strong>XmlWriter</strong> ุงุฑุฒุดููุฏ ุงุณุช.</p>
<p>ุชูุงู ููุนโูุง LINQ to XML ุฏุฑ ูุถุง ูุงู <strong>System.Xml.Linq</strong> ุชุนุฑู ุดุฏูโุงูุฏ.</p>
<hr>
<h2>๐ ููุง ฺฉู ูุนูุงุฑ (Architectural Overview)</h2>
<p>ุงู ุจุฎุด ุจุง ูุนุฑู ุจุณุงุฑ ฺฉูุชุงู ุงุฒ ููููู <strong>DOM</strong> ุดุฑูุน ูโุดูุฏ ู ุณูพุณ ููุทู ูพุดุช DOM ุฏุฑ LINQ to XML ุฑุง ุชูุถุญ ูโุฏูุฏ.</p>
<hr>
<h3>โ DOM ฺุณุชุ (What Is a DOM?)</h3>
<p>ุจู ูุงู XML ุฒุฑ ุชูุฌู ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">customer</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;123&quot;</span> <span class="hljs-attr">status</span>=<span class="hljs-string">&quot;archived&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">firstname</span>&gt;</span>Joe<span class="hljs-tag">&lt;/<span class="hljs-name">firstname</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">lastname</span>&gt;</span>Bloggs<span class="hljs-tag">&lt;/<span class="hljs-name">lastname</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">customer</span>&gt;</span>
</code></pre>
<p>ููุงูโุทูุฑ ฺฉู ุฏุฑ ูููโ ูุงูโูุง XML ูุฌูุฏ ุฏุงุฑุฏุ ูุง ุจุง ฺฉ <strong>ุงุนูุงู (declaration)</strong> ุดุฑูุน ูโฺฉูู ู ุณูพุณ ฺฉ ุนูุตุฑ ุฑุดู (<strong>root element</strong>) ุฏุงุฑู ฺฉู ูุงู ุขู <code>customer</code> ุงุณุช.<br>
ุนูุตุฑ <code>customer</code> ุฏู ูฺฺฏ (<strong>attribute</strong>) ุฏุงุฑุฏุ ูุฑฺฉุฏุงู ุจุง ฺฉ ูุงู (id ู status) ู ููุฏุงุฑ (&quot;123&quot; ู &quot;archived&quot;).<br>
ุฏุฑูู <code>customer</code>ุ ุฏู ุนูุตุฑ ูุฑุฒูุฏ (<strong>child element</strong>) ูุฌูุฏ ุฏุงุฑุฏ: <code>firstname</code> ู <code>lastname</code>ุ ฺฉู ูุฑฺฉุฏุงู ูุญุชูุง ูุชู ุณุงุฏูโุง (&quot;Joe&quot; ู &quot;Bloggs&quot;) ุฏุงุฑูุฏ.</p>
<p>ูุฑฺฉุฏุงู ุงุฒ ุงู ุณุงุฎุชุงุฑูุงโุงุนูุงูุ ุนูุตุฑุ ูฺฺฏุ ููุฏุงุฑุ ู ูุญุชูุง ูุชูโูโุชูุงููุฏ ุจุง ฺฉ <strong>ฺฉูุงุณ (class)</strong> ููุงุด ุฏุงุฏู ุดููุฏ. ู ุงฺฏุฑ ฺูู ฺฉูุงุณโูุง ุฎุตูุตุชโูุง ูุฌููุนูโุง (<strong>collection properties</strong>) ุจุฑุง ุฐุฎุฑูโ ูุญุชูุง ูุฑุฒูุฏ ุฏุงุดุชู ุจุงุดูุฏุ ูโุชูุงูู ฺฉ <strong>ุฏุฑุฎุช ุงุฒ ุงุดุงุก</strong> ุจุณุงุฒู ฺฉู ฺฉ ุณูุฏ ุฑุง ุจูโุทูุฑ ฺฉุงูู ุชูุตู ฺฉูุฏ.<br>
ุจู ุงู ูุฏูุ <strong>Document Object Model</strong> ุง <strong>DOM</strong> ฺฏูุชู ูโุดูุฏ.</p>
<hr>
<h3>๐งฉ DOM ุฏุฑ LINQ to XML</h3>
<p>LINQ to XML ุงุฒ ุฏู ุจุฎุด ุชุดฺฉู ุดุฏู ุงุณุช:</p>
<ul>
<li>ฺฉ DOM ูุฑุจูุท ุจู XML ฺฉู ุขู ุฑุง <strong>X-DOM</strong> ูโูุงูู.</li>
<li>ูุฌููุนูโุง ุงุฒ ุญุฏูุฏ ฑฐ ุนููฺฏุฑ ูพุฑุณโูุฌู ุชฺฉูู.</li>
</ul>
<p>ููุงูโุทูุฑ ฺฉู ุงูุชุธุงุฑ ูโุฑูุฏุ <strong>X-DOM</strong> ุดุงูู ููุนโูุง ูุซู <strong>XDocument</strong>ุ <strong>XElement</strong> ู <strong>XAttribute</strong> ุงุณุช.<br>
ูฺฉุชูโ ุฌุงูุจ ุงู ุงุณุช ฺฉู ููุนโูุง X-DOM ุจู LINQ ูุงุจุณุชู ูุณุชูุฏโุดูุง ูโุชูุงูุฏ ฺฉ X-DOM ุฑุง ุจุงุฑฺฏุฐุงุฑ (load)ุ ูููููโุณุงุฒ (instantiate)ุ ุจูโุฑูุฒุฑุณุงู (update) ู ุฐุฎุฑู (save) ฺฉูุฏ ุจุฏูู ุขูฺฉู ูฺ ูพุฑุณโูุฌู LINQ ุจููุณุฏ.</p>
<p>ุจุฑุนฺฉุณุ ุดูุง ูโุชูุงูุฏ ุงุฒ LINQ ุจุฑุง ูพุฑุณโูุฌู ุฏุฑ ฺฉ DOM ฺฉู ุจุง ููุนโูุง ูุฏู ู ุณุงุฒฺฏุงุฑ ุจุง <strong>W3C</strong> ุณุงุฎุชู ุดุฏูุ ุงุณุชูุงุฏู ฺฉูุฏ. ุจุง ุงู ุญุงูุ ุงู ฺฉุงุฑ ูุญุฏูุฏฺฉููุฏู ู ุขุฒุงุฑุฏููุฏู ุฎูุงูุฏ ุจูุฏ.<br>
ูฺฺฏ ูุชูุงุฒ <strong>X-DOM</strong> ุงู ุงุณุช ฺฉู ุณุงุฒฺฏุงุฑ ุจุง LINQ (<strong>LINQ-friendly</strong>) ุงุณุชุ ุนู:</p>
<ul>
<li>ูุชุฏูุง ุฏุงุฑุฏ ฺฉู ุชูุงูโูุง <strong>IEnumerable</strong> ููุฏ ุชููุฏ ูโฺฉููุฏ ฺฉู ูโุชูุงูุฏ ุฑู ุขูโูุง ูพุฑุณโูุฌู ฺฉูุฏ.</li>
<li>ุณุงุฒูุฏูโูุง ุขู ุจูโฺฏูููโุง ุทุฑุงุญ ุดุฏูโุงูุฏ ฺฉู ูโุชูุงูุฏ ฺฉ ุฏุฑุฎุช X-DOM ุฑุง ุงุฒ ุทุฑู ฺฉ <strong>LINQ projection</strong> ุจุณุงุฒุฏ.</li>
</ul>
<hr>
<h3>๐ ููุง ฺฉู X-DOM</h3>
<p>ุดฺฉู ฑฐ-ฑ ููุนโูุง ุงุตู X-DOM ุฑุง ูุดุงู ูโุฏูุฏ.<br>
ูพุฑฺฉุงุฑุจุฑุฏุชุฑู ุงู ููุนโูุง <strong>XElement</strong> ุงุณุช.<br>
<strong>XObject</strong> ุฑุดูโ ุณูุณููโูุฑุงุชุจ ูุฑุงุซุช ุงุณุชุ ู <strong>XElement</strong> ู <strong>XDocument</strong> ุฑุดูโูุง ุณูุณููโูุฑุงุชุจ ุฏุฑุจุฑฺฏุฑ (<strong>containership hierarchy</strong>) ูุณุชูุฏ.</p>
<div align="center">
<p><img src="../../../assets/image/10/Table-10-1.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ุดฺฉู ฑฐ-ฒ ุฏุฑุฎุช X-DOM ุณุงุฎุชูโุดุฏู ุงุฒ ฺฉุฏ ุฒุฑ ุฑุง ูุดุงู ูโุฏูุฏ:</p>
<pre class="hljs"><code><span class="hljs-built_in">string</span> xml = <span class="hljs-string">@&quot;&lt;customer id=&#x27;123&#x27; status=&#x27;archived&#x27;&gt;
                 &lt;firstname&gt;Joe&lt;/firstname&gt;
                 &lt;lastname&gt;Bloggs&lt;!--nice name--&gt;&lt;/lastname&gt;
               &lt;/customer&gt;&quot;</span>;
XElement customer = XElement.Parse (xml);
</code></pre>
<div align="center">
<p><img src="../../../assets/image/10/Table-10-2.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>๐งฉ XObject</h3>
<p><strong>XObject</strong> ฺฉูุงุณ ูพุงูโ ุงูุชุฒุงุน ุจุฑุง ุชูุงู ูุญุชูุง XML ุงุณุช. ุงู ฺฉูุงุณ ฺฉ ูพููุฏ ุจู ุนูุตุฑ <strong>Parent</strong> (ูุงูุฏ) ุฏุฑ ุฏุฑุฎุช ุฏุฑุจุฑฺฏุฑ (containership tree) ุชุนุฑู ูโฺฉูุฏ ู ููฺูู ูโุชูุงูุฏ ฺฉ <strong>XDocument</strong> ุงุฎุชุงุฑ ุฏุงุดุชู ุจุงุดุฏ.</p>
<hr>
<h3>๐งฉ XNode</h3>
<p><strong>XNode</strong> ฺฉูุงุณ ูพุงู ุจุฑุง ุจุดุชุฑ ูุญุชูุง XML (ุจูโุฌุฒ attributeูุง) ุงุณุช. ูฺฺฏ ูุชูุงุฒ XNode ุงู ุงุณุช ฺฉู ูโุชูุงูุฏ ุฏุฑ ฺฉ ูุฌููุนูโ ูุฑุชุจโุดุฏู ุงุฒ XNodeูุง ฺูุฏููุน ูุฑุงุฑ ุจฺฏุฑุฏ.</p>
<p>ุจุฑุง ูุซุงูุ ุจู XML ุฒุฑ ุชูุฌู ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">data</span>&gt;</span>
 Hello world
 <span class="hljs-tag">&lt;<span class="hljs-name">subelement1</span>/&gt;</span>
 <span class="hljs-comment">&lt;!--comment--&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">subelement2</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">data</span>&gt;</span>
</code></pre>
<p>ุฏุฑูู ุนูุตุฑ ูุงูุฏ <code>&lt;data&gt;</code>ุ ุงุจุชุฏุง ฺฉ <strong>XText node</strong> (&quot;Hello world&quot;) ูุฑุงุฑ ุฏุงุฑุฏุ ุณูพุณ ฺฉ <strong>XElement node</strong>ุ ุจุนุฏ ฺฉ <strong>XComment node</strong>ุ ู ุฏุฑ ูพุงุงู ฺฉ <strong>XElement node</strong> ุฏฺฏุฑ.<br>
ุฏุฑ ููุงุจูุ ฺฉ <strong>XAttribute</strong> ุชููุง ุณุงุฑ XAttributeูุง ุฑุง ุจูโุนููุงู ููโุณุทุญ (peer) ูโูพุฐุฑุฏ.</p>
<p>ุจุง ุงูฺฉู ฺฉ <strong>XNode</strong> ูโุชูุงูุฏ ุจู ุนูุตุฑ ูุงูุฏ ุฎูุฏ (<strong>XElement</strong>) ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดุฏุ ุงูุง ูฺ ููููู ุงุฒ <strong>child node</strong> ูุฏุงุฑุฏุ ุงู ูุธููโ ุฒุฑฺฉูุงุณ ุขู ุนู <strong>XContainer</strong> ุงุณุช.</p>
<hr>
<h3>๐งฉ XContainer</h3>
<p><strong>XContainer</strong> ุงุนุถุง ุจุฑุง ฺฉุงุฑ ุจุง ูุฑุฒูุฏุงู ุชุนุฑู ูโฺฉูุฏ ู ฺฉูุงุณ ูพุงูโ ุงูุชุฒุงุน ุจุฑุง <strong>XElement</strong> ู <strong>XDocument</strong> ุงุณุช.</p>
<hr>
<h3>๐งฉ XElement</h3>
<p><strong>XElement</strong> ุงุนุถุง ุจุฑุง ูุฏุฑุช attributeูุง ูุนุฑู ูโฺฉูุฏโู ููฺูู ุฎุตูุตุชโูุง <strong>Name</strong> ู <strong>Value</strong> ุฑุง.<br>
ุฏุฑ ุญุงูุช ฺฉู ฺฉ ุนูุตุฑ ุชููุง ฺฉ ูุฑุฒูุฏ ุงุฒ ููุน <strong>XText</strong> ุฏุงุดุชู ุจุงุดุฏ (ฺฉู ุญุงูุช ูุณุจุชุงู ุฑุงุฌ ุงุณุช)ุ ุฎุตูุตุช <strong>Value</strong> ุฏุฑ XElement ูุญุชูุง ุงู ูุฑุฒูุฏ ุฑุง ูู ุจุฑุง ุนููุงุช <strong>get</strong> ู ูู ุจุฑุง <strong>set</strong> ุฏุฑุจุฑูโฺฏุฑุฏ ู ูุงุฒ ุจู ูพูุงุด ุบุฑุถุฑูุฑ ุฑุง ุญุฐู ูโฺฉูุฏ.<br>
ุจู ูุทู <strong>Value</strong>ุ ูุนูููุงู ูุงุฒ ุจู ฺฉุงุฑ ูุณุชูู ุจุง <strong>XText nodeูุง</strong> ูุฏุงุฑุฏ.</p>
<hr>
<h3>๐งฉ XDocument</h3>
<p><strong>XDocument</strong> ุฑุดูโ ฺฉ ุฏุฑุฎุช XML ุฑุง ููุงุด ูโุฏูุฏ. ุจูโุทูุฑ ุฏููโุชุฑุ ุงู ฺฉูุงุณ ุนูุตุฑ ุฑุดู (<strong>root XElement</strong>) ุฑุง ุฏุฑุจุฑ ูโฺฏุฑุฏ ู ฺฉ <strong>XDeclaration</strong>ุ ุฏุณุชูุฑุงูุนููโูุง ูพุฑุฏุงุฒุด (processing instructions) ู ุณุงุฑ ููุงุฑุฏ ุณุทุญ ุฑุดู ุฑุง ุงุถุงูู ูโฺฉูุฏ.</p>
<p>ุจุฑุฎูุงู DOM ุฏุฑ ุงุณุชุงูุฏุงุฑุฏ <strong>W3C</strong>ุ ุงุณุชูุงุฏู ุงุฒ XDocument ุงุฎุชุงุฑ ุงุณุช: ุดูุง ูโุชูุงูุฏ ฺฉ X-DOM ุฑุง ุจุงุฑฺฏุฐุงุฑุ ุฏุณุชโฺฉุงุฑ ู ุฐุฎุฑู ฺฉูุฏ ุจุฏูู ุงูฺฉู ูฺโููุช ฺฉ XDocument ุจุณุงุฒุฏ!<br>
ููฺูู ูุณุชูู ุจูุฏู ุงุฒ XDocument ุจุงุนุซ ูโุดูุฏ ุจุชูุงูุฏ ฺฉ ุฒุฑโุฏุฑุฎุช node ุฑุง ุจูโุทูุฑ ฺฉุงุฑุขูุฏ ู ุขุณุงู ุจู ุณูุณููโูุฑุงุชุจ X-DOM ุฏฺฏุฑ ููุชูู ฺฉูุฏ.</p>
<hr>
<h2>๐ฅ ุจุงุฑฺฏุฐุงุฑ ู ุชุฌุฒู (Loading and Parsing)</h2>
<p>ูู <strong>XElement</strong> ู ูู <strong>XDocument</strong> ูุชุฏูุง ุงุณุชุง (<strong>static</strong>) <strong>Load</strong> ู <strong>Parse</strong> ุฑุง ุจุฑุง ุณุงุฎุชู ฺฉ ุฏุฑุฎุช X-DOM ุงุฒ ฺฉ ููุจุน ููุฌูุฏ ุงุฑุงุฆู ูโุฏููุฏ:</p>
<ul>
<li><strong>Load</strong> ฺฉ X-DOM ุฑุง ุงุฒ ูุงูุ URIุ Streamุ TextReader ุง XmlReader ูโุณุงุฒุฏ.</li>
<li><strong>Parse</strong> ฺฉ X-DOM ุฑุง ุงุฒ ฺฉ ุฑุดุชู (string) ูโุณุงุฒุฏ.</li>
</ul>
<p>ูุซุงู:</p>
<pre class="hljs"><code>XDocument fromWeb = XDocument.Load (<span class="hljs-string">&quot;http://albahari.com/sample.xml&quot;</span>);
XElement fromFile = XElement.Load (<span class="hljs-string">@&quot;e:\media\somefile.xml&quot;</span>);
XElement config = XElement.Parse (
 <span class="hljs-string">@&quot;&lt;configuration&gt;
    &lt;client enabled=&#x27;true&#x27;&gt;
      &lt;timeout&gt;30&lt;/timeout&gt;
    &lt;/client&gt;
  &lt;/configuration&gt;&quot;</span>);
</code></pre>
<p>ุฏุฑ ุจุฎุดโูุง ุจุนุฏุ ุฑูุด ูพูุงุด ู ุจูโุฑูุฒุฑุณุงู ฺฉ X-DOM ุฑุง ุชูุถุญ ูโุฏูู.<br>
ุจูโุนููุงู ฺฉ ูพุดโููุงุด ุณุฑุนุ ุฏุฑ ุงูุฌุง ูุญููโ ุฏุณุชโฺฉุงุฑ ุนูุตุฑ <code>config</code> ฺฉู ููู ุงูุงู ุณุงุฎุชู ุขูุฏู ุงุณุช:</p>
<pre class="hljs"><code><span class="hljs-keyword">foreach</span> (XElement child <span class="hljs-keyword">in</span> config.Elements())
  Console.WriteLine (child.Name);                     <span class="hljs-comment">// client</span>

XElement client = config.Element (<span class="hljs-string">&quot;client&quot;</span>);
<span class="hljs-built_in">bool</span> enabled = (<span class="hljs-built_in">bool</span>) client.Attribute (<span class="hljs-string">&quot;enabled&quot;</span>);   <span class="hljs-comment">// Read attribute</span>
Console.WriteLine (enabled);                          <span class="hljs-comment">// True</span>

client.Attribute (<span class="hljs-string">&quot;enabled&quot;</span>).SetValue (!enabled);     <span class="hljs-comment">// Update attribute</span>

<span class="hljs-built_in">int</span> timeout = (<span class="hljs-built_in">int</span>) client.Element (<span class="hljs-string">&quot;timeout&quot;</span>);       <span class="hljs-comment">// Read element</span>
Console.WriteLine (timeout);                          <span class="hljs-comment">// 30</span>

client.Element (<span class="hljs-string">&quot;timeout&quot;</span>).SetValue (timeout * <span class="hljs-number">2</span>);    <span class="hljs-comment">// Update element</span>

client.Add (<span class="hljs-keyword">new</span> XElement (<span class="hljs-string">&quot;retries&quot;</span>, <span class="hljs-number">3</span>));             <span class="hljs-comment">// Add new element</span>

Console.WriteLine (config);   <span class="hljs-comment">// Implicitly call config.ToString()</span>
</code></pre>
<p>ูุชุฌูโ ุขุฎุฑู ุฏุณุชูุฑ <code>Console.WriteLine</code> ุจูโุดฺฉู ุฒุฑ ุฎูุงูุฏ ุจูุฏ:</p>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">client</span> <span class="hljs-attr">enabled</span>=<span class="hljs-string">&quot;false&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">timeout</span>&gt;</span>60<span class="hljs-tag">&lt;/<span class="hljs-name">timeout</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">retries</span>&gt;</span>3<span class="hljs-tag">&lt;/<span class="hljs-name">retries</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">client</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span>
</code></pre>
<hr>
<h3>๐งฉ XNode.ReadFrom</h3>
<p><strong>XNode</strong> ููฺูู ฺฉ ูุชุฏ ุงุณุชุง <strong>ReadFrom</strong> ุฏุงุฑุฏ ฺฉู ูุฑ ููุน node ุฑุง ุงุฒ ฺฉ <strong>XmlReader</strong> ูููููโุณุงุฒ ู ููุฏุงุฑุฏู ูโฺฉูุฏ.<br>
ุจุฑุฎูุงู <strong>Load</strong>ุ ุงู ูุชุฏ ูพุณ ุงุฒ ุฎูุงูุฏู ฺฉ node ฺฉุงูู ูุชููู ูโุดูุฏุ ุจูุงุจุฑุงู ุดูุง ูโุชูุงูุฏ ุจูโุทูุฑ ุฏุณุช ุงุฒ ููุงู XmlReader ุงุฏุงููโ ุฎูุงูุฏู ุฑุง ุงูุฌุงู ุฏูุฏ.</p>
<p>ููฺูู ูโุชูุงูุฏ ุจุฑุนฺฉุณ ุนูู ฺฉูุฏ ู ุจุง ุงุณุชูุงุฏู ุงุฒ ูุชุฏูุง <strong>CreateReader</strong> ู <strong>CreateWriter</strong>ุ ุงุฒ ฺฉ XmlReader ุง XmlWriter ุจุฑุง ุฎูุงูุฏู ุง ููุดุชู ฺฉ XNode ุงุณุชูุงุฏู ฺฉูุฏ.</p>
<p>ูุง ุฏุฑ ูุตู ฑฑ ุฎูุงููุฏูโูุง ู ููุณูุฏูโูุง XML ู ูุญููโ ุงุณุชูุงุฏู ุงุฒ ุขูโูุง ุจุง X-DOM ุฑุง ุชูุถุญ ุฎูุงูู ุฏุงุฏ.</p>
<hr>
<h2>๐พ ุฐุฎุฑูโุณุงุฒ ู ุณุฑุงูโุณุงุฒ (Saving and Serializing)</h2>
<p>ูุฑุงุฎูุงู <strong>ToString</strong> ุฑู ูุฑ nodeุ ูุญุชูุง ุขู ุฑุง ุจู ฺฉ ุฑุดุชูโ XML ุชุจุฏู ูโฺฉูุฏโุจุง ูุงูุจโุจูุฏ ุดุงูู ุดฺฉุณุช ุฎุท ู ุชูุฑูุชฺฏุ ููุงูโุทูุฑ ฺฉู ุฏุฏู.<br>
(ูโุชูุงูุฏ ุดฺฉุณุช ุฎุท ู ุชูุฑูุชฺฏ ุฑุง ุบุฑูุนุงู ฺฉูุฏุ ุจุง ูุดุฎุต ฺฉุฑุฏู <strong>SaveOptions.DisableFormatting</strong> ููฺฏุงู ูุฑุงุฎูุงู ToString.)</p>
<p><strong>XElement</strong> ู <strong>XDocument</strong> ููฺูู ูุชุฏ <strong>Save</strong> ุฏุงุฑูุฏ ฺฉู ฺฉ X-DOM ุฑุง ุฏุฑ ูุงูุ Streamุ TextWriter ุง XmlWriter ูโููุณุฏ. ุงฺฏุฑ ฺฉ ูุงู ูุดุฎุต ฺฉูุฏุ ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ฺฉ <strong>XML declaration</strong> ููุดุชู ูโุดูุฏ.</p>
<p>ููฺูู ูุชุฏ <strong>WriteTo</strong> ุฏุฑ ฺฉูุงุณ <strong>XNode</strong> ุชุนุฑู ุดุฏู ุงุณุช ฺฉู ููุท ฺฉ <strong>XmlWriter</strong> ูโูพุฐุฑุฏ.</p>
<p>ูุง ุฌุฒุฆุงุช ุจุดุชุฑ ุฏุฑุจุงุฑูโ ูุญููโ ูุฏุฑุช ุงุนูุงูโูุง XML ููฺฏุงู ุฐุฎุฑูโุณุงุฒ ุฑุง ุฏุฑ ุจุฎุด <strong>โDocuments and Declarationsโ</strong> ุฏุฑ ุตูุญูโ ตณน ุชูุถุญ ุฎูุงูู ุฏุงุฏ.<br>
ูููููโุณุงุฒ ฺฉ X-DOM<br>
ุจูโุฌุง ุงุณุชูุงุฏู ุงุฒ ูุชุฏูุง <strong>Load</strong> ุง <strong>Parse</strong>ุ ูโุชูุงูุฏ ฺฉ ุฏุฑุฎุช X-DOM ุฑุง ุจุง ูููููโุณุงุฒ ุฏุณุช ุงุดุงุก ู ุงูุฒูุฏู ุขูโูุง ุจู ฺฉ ูุงูุฏ ุงุฒ ุทุฑู ูุชุฏ <strong>Add</strong> ุฏุฑ ฺฉูุงุณ <strong>XContainer</strong> ุจุณุงุฒุฏ.</p>
<p>ุจุฑุง ุณุงุฎุชู ฺฉ <strong>XElement</strong> ู <strong>XAttribute</strong> ฺฉุงู ุงุณุช ฺฉ ูุงู ู ููุฏุงุฑ ูุดุฎุต ฺฉูุฏ:</p>
<pre class="hljs"><code>XElement lastName = <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;lastname&quot;</span>, <span class="hljs-string">&quot;Bloggs&quot;</span>);
lastName.Add(<span class="hljs-keyword">new</span> XComment(<span class="hljs-string">&quot;nice name&quot;</span>));
XElement customer = <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;customer&quot;</span>);
customer.Add(<span class="hljs-keyword">new</span> XAttribute(<span class="hljs-string">&quot;id&quot;</span>, <span class="hljs-number">123</span>));
customer.Add(<span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;firstname&quot;</span>, <span class="hljs-string">&quot;Joe&quot;</span>));
customer.Add(lastName);
Console.WriteLine(customer.ToString());
</code></pre>
<p>ุฎุฑูุฌ ุจู ุงู ุตูุฑุช ุงุณุช:</p>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">customer</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;123&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">firstname</span>&gt;</span>Joe<span class="hljs-tag">&lt;/<span class="hljs-name">firstname</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">lastname</span>&gt;</span>Bloggs<span class="hljs-comment">&lt;!--nice name--&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">lastname</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">customer</span>&gt;</span>
</code></pre>
<p>ููุช ฺฉ <strong>XElement</strong> ูโุณุงุฒุฏุ ููุฏุงุฑ (value) ุงุฎุชุงุฑ ุงุณุช โ ูโุชูุงูุฏ ููุท ูุงู ุนูุตุฑ ุฑุง ุจุฏูุฏ ู ุจุนุฏุงู ูุญุชูุง ุงุถุงูู ฺฉูุฏ. ุชูุฌู ฺฉูุฏ ฺฉู ููุช ููุฏุงุฑ ุชุนู ฺฉุฑุฏูุ ฺฉ ุฑุดุชูโ ุณุงุฏู ฺฉุงู ุจูุฏุ ูุงุฒู ูุจูุฏ ฺฉู ุจูโุทูุฑ ุตุฑุญ ฺฉ <strong>XText</strong> ุจุณุงุฒู ู ุงุถุงูู ฺฉูู. X-DOM ุงู ฺฉุงุฑ ุฑุง ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ุงูุฌุงู ูโุฏูุฏุ ุจูุงุจุฑุงู ุดูุง ููุท ุจุง &quot;ููุฏุงุฑ&quot; ุณุฑูฺฉุงุฑ ุฏุงุฑุฏ.</p>
<hr>
<h3>ุณุงุฎุชุงุฑ ุชุงุจุน (Functional Construction)</h3>
<p>ุฏุฑ ูุซุงู ูุจูุ ุฎูุงูุฏู ุณุงุฎุชุงุฑ XML ุงุฒ ุฑู ฺฉุฏ ฺฉู ุฏุดูุงุฑ ุงุณุช. X-DOM ฺฉ ุญุงูุช ุฏฺฏุฑ ูููููโุณุงุฒ ุจู ูุงู <strong>ุณุงุฎุชุงุฑ ุชุงุจุน</strong> (ุงุฒ ุจุฑูุงููโููุณ ุชุงุจุน) ูพุดุชุจุงู ูโฺฉูุฏ. ุฏุฑ ุงู ุญุงูุชุ ูโุชูุงูุฏ ฺฉู ุฏุฑุฎุช ุฑุง ุฏุฑ ฺฉ ุนุจุงุฑุช ูุงุญุฏ ุจุณุงุฒุฏ:</p>
<pre class="hljs"><code>XElement customer =
  <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;customer&quot;</span>, <span class="hljs-keyword">new</span> XAttribute(<span class="hljs-string">&quot;id&quot;</span>, <span class="hljs-number">123</span>),
    <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;firstname&quot;</span>, <span class="hljs-string">&quot;joe&quot;</span>),
    <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;lastname&quot;</span>, <span class="hljs-string">&quot;bloggs&quot;</span>,
      <span class="hljs-keyword">new</span> XComment(<span class="hljs-string">&quot;nice name&quot;</span>)
    )
  );
</code></pre>
<p>ุงู ุฑูุด ุฏู ูุฒุช ุฏุงุฑุฏ:</p>
<ol>
<li>ฺฉุฏ ุดุจู ุณุงุฎุชุงุฑ XML ูโุดูุฏ.</li>
<li>ูโุชูุงู ุขู ุฑุง ุฏุฑ ุนุจุงุฑุช <strong>select</strong> ฺฉ ฺฉูุฆุฑ LINQ ุงุณุชูุงุฏู ฺฉุฑุฏ.</li>
</ol>
<p>ูุซูุงูุ ฺฉูุฆุฑ ุฒุฑ ุงุฒ ฺฉ ฺฉูุงุณ ููุฌูุฏุช EF Core ุจู ฺฉ X-DOM ูพุฑูุฌฺฉุช ูโฺฉูุฏ:</p>
<pre class="hljs"><code>XElement query =
  <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;customers&quot;</span>,
    <span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> dbContext.Customers.AsEnumerable()
    <span class="hljs-function"><span class="hljs-keyword">select</span>
      <span class="hljs-keyword">new</span> <span class="hljs-title">XElement</span>(<span class="hljs-params"><span class="hljs-string">&quot;customer&quot;</span>, <span class="hljs-keyword">new</span> XAttribute(<span class="hljs-string">&quot;id&quot;</span>, c.ID</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title">XElement</span>(<span class="hljs-params"><span class="hljs-string">&quot;firstname&quot;</span>, c.FirstName</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title">XElement</span>(<span class="hljs-params"><span class="hljs-string">&quot;lastname&quot;</span>, c.LastName,
          <span class="hljs-keyword">new</span> XComment(<span class="hljs-string">&quot;nice name&quot;</span></span>)
        )
      )
  )</span>;
</code></pre>
<p>(ุงู ููุถูุน ุฑุง ุจุนุฏุงู ุฏุฑ ููู ูุตู ุฏุฑ ุจุฎุด ยซูพุฑูุฌฺฉุช ฺฉุฑุฏู ุจู ุฏุงุฎู ฺฉ X-DOMยป ุจุฑุฑุณ ูโฺฉูู.)</p>
<hr>
<h3>ุชุนู ูุญุชูุง (Specifying Content)</h3>
<p>ุณุงุฎุชุงุฑ ุชุงุจุน ุงูฺฉุงูโูพุฐุฑ ุงุณุช ฺูู ุณุงุฒูุฏูโูุง <strong>XElement</strong> (ู <strong>XDocument</strong>) ุทูุฑ overload ุดุฏูโุงูุฏ ฺฉู ฺฉ <code>params object[]</code> ุฑุง ุจูพุฐุฑูุฏ:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">XElement</span> (<span class="hljs-params">XName name, <span class="hljs-keyword">params</span> <span class="hljs-built_in">object</span>[] content</span>)
</span></code></pre>
<p>ููู ููุถูุน ุจุฑุง ูุชุฏ <strong>Add</strong> ุฏุฑ <strong>XContainer</strong> ูุฒ ุตุฏู ูโฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Add</span> (<span class="hljs-params"><span class="hljs-keyword">params</span> <span class="hljs-built_in">object</span>[] content</span>)
</span></code></pre>
<p>ุจูุงุจุฑุงูุ ููฺฏุงู ุณุงุฎุช ุง ุงุถุงูู ฺฉุฑุฏู ุจู ฺฉ X-DOM ูโุชูุงูุฏ ูุฑ ุชุนุฏุงุฏ ุดุก ุจุง ูุฑ ููุน ุฑุง ุจูโุนููุงู ูุฑุฒูุฏ ูุดุฎุต ฺฉูุฏ. ุฏูู ุงู ฺฉุงุฑ ุงู ุงุณุช ฺฉู ูุฑ ฺุฒ ูโุชูุงูุฏ ูุญุชูุง ูุงููู ุจุงุดุฏ. ุฏุฑ ุงูุฌุง ุชุตููุงุช ฺฉู <strong>XContainer</strong> ุจุฑุง ูพุฑุฏุงุฒุด ูุฑ ุดุก ูโฺฏุฑุฏ ุขูุฏู ุงุณุช:</p>
<ol>
<li>ุงฺฏุฑ ุดุก <strong>null</strong> ุจุงุดุฏุ ูุงุฏุฏู ฺฏุฑูุชู ูโุดูุฏ.</li>
<li>ุงฺฏุฑ ุดุก ุงุฒ ููุน <strong>XNode</strong> ุง <strong>XStreamingElement</strong> ุจุงุดุฏุ ูุณุชููุงู ุจู ฺฉุงูฺฉุดู <strong>Nodes</strong> ุงุถุงูู ูโุดูุฏ.</li>
<li>ุงฺฏุฑ ุดุก ฺฉ <strong>XAttribute</strong> ุจุงุดุฏุ ุจู ฺฉุงูฺฉุดู <strong>Attributes</strong> ุงุถุงูู ูโุดูุฏ.</li>
<li>ุงฺฏุฑ ุดุก ฺฉ <strong>string</strong> ุจุงุดุฏุ ุฏุฑ ฺฉ <strong>XText</strong> ูุฑุงุฑ ฺฏุฑูุชู ู ุจู <strong>Nodes</strong> ุงูุฒูุฏู ูโุดูุฏ.</li>
<li>ุงฺฏุฑ ุดุก ุงุฒ <strong>IEnumerable</strong> ูพุฑู ฺฉูุฏุ ุงุนุถุง ุขู ูพูุงุด ุดุฏู ู ููู ููุงูู ุฑู ูุฑ ุนุถู ุงุนูุงู ูโุดูุฏ.</li>
<li>ุฏุฑ ุบุฑ ุงู ุตูุฑุชุ ุดุก ุจู ุฑุดุชู ุชุจุฏู ุดุฏูุ ุฏุฑ ฺฉ <strong>XText</strong> ูุฑุงุฑ ฺฏุฑูุชู ู ุจู <strong>Nodes</strong> ุงุถุงูู ูโุดูุฏ.</li>
</ol>
<blockquote>
<p>ูฺฉุชู: X-DOM ุงู ูุฑุญูู ุฑุง ุจูููโุณุงุฒ ูโฺฉูุฏ ู ูุญุชูุง ูุชู ุณุงุฏู ุฑุง ุฏุฑ ฺฉ <strong>string</strong> ุฐุฎุฑู ูโฺฉูุฏ. ููุฏ <strong>XText</strong> ูุงูุนุงู ุณุงุฎุชู ููโุดูุฏ ุชุง ููุช ฺฉู ูุชุฏ <strong>Nodes()</strong> ุฑุง ุฑู XContainer ูุฑุงุฎูุงู ฺฉูุฏ.</p>
</blockquote>
<p>ุฏุฑ ููุงุชุ ููู ฺุฒ ุง ุฏุฑ <strong>Nodes</strong> ูุฑุงุฑ ูโฺฏุฑุฏ ุง ุฏุฑ <strong>Attributes</strong>.</p>
<p>ูพุด ุงุฒ ุตุฏุง ุฒุฏู <strong>ToString</strong> ุฑู ฺฉ ููุน ุฏูุฎูุงูุ <strong>XContainer</strong> ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ุขุง ุงุฒ ุงููุงุน ุฒุฑ ูุณุช ุง ุฎุฑ:</p>
<ul>
<li><code>float, double, decimal, bool, DateTime, DateTimeOffset, TimeSpan</code></li>
</ul>
<p>ุงฺฏุฑ ฺูู ุจุงุดุฏุ ุจูโุฌุง <strong>ToString</strong> ูุนูููุ ูุชุฏ ููุงุณุจ <strong>XmlConvert</strong> ูุฑุงุฎูุงู ูโุดูุฏ ุชุง ุฏุงุฏูโูุง ูุงุจูุช <strong>round-trip</strong> ุฏุงุดุชู ุจุงุดูุฏ ู ุจุง ููุงูู ุงุณุชุงูุฏุงุฑุฏ XML ุณุงุฒฺฏุงุฑ ุจุงุดูุฏ.</p>
<hr>
<h3>ฺฉูููโฺฏุฑ ุนูู ุฎูุฏฺฉุงุฑ (Automatic Deep Cloning)</h3>
<p>ููุช ฺฉ ููุฏ ุง attribute ุจู ฺฉ element ุงุถุงูู ูโุดูุฏ (ฺู ุงุฒ ุทุฑู ุณุงุฎุชุงุฑ ุชุงุจุน ุง ูุชุฏ <strong>Add</strong>)ุ ุฎุงุตุช <strong>Parent</strong> ุขู ููุฏ ุง attribute ุจู ุขู ุนูุตุฑ ุชูุธู ูโุดูุฏ.<br>
ุงุฒ ุขูุฌุง ฺฉู ูุฑ ููุฏ ููุท ูโุชูุงูุฏ ฺฉ ูุงูุฏ ุฏุงุดุชู ุจุงุดุฏุ ุงฺฏุฑ ฺฉ ููุฏู ูุงูุฏุฏุงุฑ ุฑุง ุจู ูุงูุฏ ุฏฺฏุฑ ุงุถุงูู ฺฉูุฏุ ุขู ููุฏ ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ <strong>ฺฉููู ุนูู (deep clone)</strong> ูโุดูุฏ.</p>
<p>ูุซุงู:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> address = <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;address&quot;</span>,
                 <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;street&quot;</span>, <span class="hljs-string">&quot;Lawley St&quot;</span>),
                 <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;town&quot;</span>, <span class="hljs-string">&quot;North Beach&quot;</span>)
             );

<span class="hljs-keyword">var</span> customer1 = <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;customer1&quot;</span>, address);
<span class="hljs-keyword">var</span> customer2 = <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;customer2&quot;</span>, address);

customer1.Element(<span class="hljs-string">&quot;address&quot;</span>).Element(<span class="hljs-string">&quot;street&quot;</span>).Value = <span class="hljs-string">&quot;Another St&quot;</span>;

Console.WriteLine(
  customer2.Element(<span class="hljs-string">&quot;address&quot;</span>).Element(<span class="hljs-string">&quot;street&quot;</span>).Value);   <span class="hljs-comment">// Lawley St</span>
</code></pre>
<p>ุงู ุชฺฉุซุฑ ุฎูุฏฺฉุงุฑ ุจุงุนุซ ูโุดูุฏ ูููููโุณุงุฒ X-DOM ุจุฏูู <strong>side effect</strong> ุจุงุดุฏ โ ฺฉู ฺฉ ุฏฺฏุฑ ุงุฒ ูฺฺฏโูุง ฺฉูุฏ ุจุฑูุงููโููุณ ุชุงุจุน ุงุณุช. โ</p>
<p>ูพูุงุด ู ฺฉูุฆุฑโฺฏุฑ (Navigating and Querying)<br>
ููุงูโุทูุฑ ฺฉู ุงูุชุธุงุฑ ุฏุงุฑุฏุ ฺฉูุงุณโูุง <strong>XNode</strong> ู <strong>XContainer</strong> ูุชุฏูุง ู ูฺฺฏโูุง ุจุฑุง ูพูุงุด ุฏุฑุฎุช X-DOM ุชุนุฑู ูโฺฉููุฏ. ุงูุง ุจุฑุฎูุงู ฺฉ DOM ุณูุชุ ุงู ุชูุงุจุน ูุฌููุนูโุง ฺฉู <strong>IList<T></strong> ุฑุง ูพุงุฏูโุณุงุฒ ฺฉูุฏ ุจุฑููโฺฏุฑุฏุงููุฏ. ุฏุฑ ุนูุถุ ุง ฺฉ ููุฏุงุฑ ูููุฑุฏ ุง ฺฉ ุฏูุจุงูู (sequence) ฺฉู <strong>IEnumerable<T></strong> ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉูุฏ ุจุฑูโฺฏุฑุฏุงููุฏ โ ู ุดูุง ุงูุชุธุงุฑ ูโุฑูุฏ ฺฉู ุฑู ุขู ุง ฺฉ ฺฉูุฆุฑ LINQ ุงุฌุฑุง ฺฉูุฏ ุง ุจุง ฺฉ <strong>foreach</strong> ูพูุงุด ฺฉูุฏ.</p>
<p>ุงู ููุถูุน ุงูฺฉุงู ุงุฌุฑุง ฺฉูุฆุฑโูุง ูพุดุฑูุชู ุฑุง ุฏุฑ ฺฉูุงุฑ ูุธุงู ุณุงุฏูโ ูพูุงุดุ ุจุง ุงุณุชูุงุฏู ุงุฒ ููุงู ุณูุชฺฉุณ ุขุดูุง LINQุ ูุฑุงูู ูโฺฉูุฏ. โ</p>
<hr>
<blockquote>
<p><strong>ูฺฉุชู:</strong> ููุงููุฏ XMLุ ุฏุฑ X-DOM ูุงู ุนูุงุตุฑ (Element) ู ุตูุงุช (Attribute) <strong>ุญุณุงุณ ุจู ุญุฑูู ฺฉูฺฺฉ ู ุจุฒุฑฺฏ</strong> ูุณุชูุฏ.</p>
</blockquote>
<hr>
<h3>ูพูุงุด ููุฏูุง ูุฑุฒูุฏ (Child Node Navigation)</h3>
<div align="center">
<p><img src="../../../assets/image/10/Table-10-3.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ุชุงุจุนโูุง ฺฉู ุฏุฑ ุณุชูู ุณูู ุฌุฏูู (ุงูุฌุง ู ุฏุฑ ุฌุฏููโูุง ุฏฺฏุฑ) ุจุง ฺฉ ุณุชุงุฑู (*) ุนูุงูุชโฺฏุฐุงุฑ ุดุฏูโุงูุฏุ ุฑู ุฏูุจุงููโูุง ุงุฒ ููุงู ููุน ูู ุนูู ูโฺฉููุฏ.<br>
ุจุฑุง ูุซุงูุ ูโุชูุงูุฏ ูุชุฏ <strong>Nodes</strong> ุฑุง ูู ุฑู ฺฉ ุดุก <strong>XContainer</strong> ู ูู ุฑู ฺฉ ุฏูุจุงูู ุงุฒ ุงุดุงุก <strong>XContainer</strong> ูุฑุงุฎูุงู ฺฉูุฏ. ุงู ูุงุจูุช ุจู ูุทู <strong>extension method</strong>ูุง ุงุณุช ฺฉู ุฏุฑ ูุถุง ูุงู <strong>System.Xml.Linq</strong> ุชุนุฑู ุดุฏูโุงูุฏโุนู ููุงู <strong>ุนููฺฏุฑูุง ฺฉูฺฉ ฺฉูุฆุฑ</strong> ฺฉู ุฏุฑ ุจุฎุด ูุฑูุฑ (overview) ุฏุฑุจุงุฑูโุดุงู ุตุญุจุช ฺฉุฑุฏู.</p>
<hr>
<h3>๐ข FirstNodeุ LastNode ู Nodes</h3>
<ul>
<li><strong>FirstNode</strong> ู <strong>LastNode</strong> ุฏุณุชุฑุณ ูุณุชูู ุจู ุงููู ุง ุขุฎุฑู ููุฏ ูุฑุฒูุฏ ูโุฏููุฏ.</li>
<li><strong>Nodes</strong> ูููโ ูุฑุฒูุฏูุง ุฑุง ุจู ุตูุฑุช ฺฉ ุฏูุจุงูู (sequence) ุจุฑูโฺฏุฑุฏุงูุฏ.</li>
</ul>
<p>ูุฑ ุณู ุงู ุชุงุจุนโูุง ููุท ูุฑุฒูุฏุงู ูุณุชูู (direct descendants) ุฑุง ุฏุฑ ูุธุฑ ูโฺฏุฑูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> bench = <span class="hljs-keyword">new</span> XElement (<span class="hljs-string">&quot;bench&quot;</span>,
              <span class="hljs-keyword">new</span> XElement (<span class="hljs-string">&quot;toolbox&quot;</span>,
                <span class="hljs-keyword">new</span> XElement (<span class="hljs-string">&quot;handtool&quot;</span>, <span class="hljs-string">&quot;Hammer&quot;</span>),
                <span class="hljs-keyword">new</span> XElement (<span class="hljs-string">&quot;handtool&quot;</span>, <span class="hljs-string">&quot;Rasp&quot;</span>)
              ),
              <span class="hljs-keyword">new</span> XElement (<span class="hljs-string">&quot;toolbox&quot;</span>,
                <span class="hljs-keyword">new</span> XElement (<span class="hljs-string">&quot;handtool&quot;</span>, <span class="hljs-string">&quot;Saw&quot;</span>),
                <span class="hljs-keyword">new</span> XElement (<span class="hljs-string">&quot;powertool&quot;</span>, <span class="hljs-string">&quot;Nailgun&quot;</span>)
              ),
              <span class="hljs-keyword">new</span> XComment (<span class="hljs-string">&quot;Be careful with the nailgun&quot;</span>)
            );

<span class="hljs-keyword">foreach</span> (XNode node <span class="hljs-keyword">in</span> bench.Nodes())
  Console.WriteLine (node.ToString (SaveOptions.DisableFormatting) + <span class="hljs-string">&quot;.&quot;</span>);
</code></pre>
<p>๐น ุฎุฑูุฌ ฺฉุฏ ุจุงูุง:</p>
<pre class="hljs"><code>&lt;toolbox&gt;&lt;handtool&gt;Hammer&lt;/handtool&gt;&lt;handtool&gt;Rasp&lt;/handtool&gt;&lt;/toolbox&gt;.
&lt;toolbox&gt;&lt;handtool&gt;Saw&lt;/handtool&gt;&lt;powertool&gt;Nailgun&lt;/powertool&gt;&lt;/toolbox&gt;.
&lt;!--Be careful with the nailgun--&gt;.
</code></pre>
<hr>
<h3>๐ข ุจุงุฒุงุจ ุนูุงุตุฑ (Retrieving elements)</h3>
<p>ูุชุฏ <strong>Elements</strong> ููุท ููุฏูุง ูุฑุฒูุฏ ุงุฒ ููุน <strong>XElement</strong> ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">foreach</span> (XElement e <span class="hljs-keyword">in</span> bench.Elements())
  Console.WriteLine (e.Name + <span class="hljs-string">&quot;=&quot;</span> + e.Value);
<span class="hljs-comment">// toolbox=HammerRasp</span>
<span class="hljs-comment">// toolbox=SawNailgun</span>
</code></pre>
<p>๐น ฺฉูุฆุฑ ุฒุฑ ุฌุนุจูโุงุจุฒุงุฑ (<strong>toolbox</strong>) ุฑุง ูพุฏุง ูโฺฉูุฏ ฺฉู ุฏุฑููุด ุงุจุฒุงุฑ <strong>Nailgun</strong> ูุฌูุฏ ุฏุงุฑุฏ:</p>
<pre class="hljs"><code>IEnumerable&lt;<span class="hljs-built_in">string</span>&gt; query =
  <span class="hljs-keyword">from</span> toolbox <span class="hljs-keyword">in</span> bench.Elements()
  <span class="hljs-keyword">where</span> toolbox.Elements().Any (tool =&gt; tool.Value == <span class="hljs-string">&quot;Nailgun&quot;</span>)
  <span class="hljs-keyword">select</span> toolbox.Value;

<span class="hljs-comment">// RESULT: { &quot;SawNailgun&quot; }</span>
</code></pre>
<p>๐น ุฏุฑ ูุซุงู ุจุนุฏ ุงุฒ <strong>SelectMany</strong> ุงุณุชูุงุฏู ูโฺฉูู ุชุง ุงุจุฒุงุฑูุง ุฏุณุช (<strong>handtool</strong>) ูููโ ุฌุนุจูโุงุจุฒุงุฑูุง ุฑุง ุจูโุฏุณุช ุจุงูุฑู:</p>
<pre class="hljs"><code>IEnumerable&lt;<span class="hljs-built_in">string</span>&gt; query =
  <span class="hljs-keyword">from</span> toolbox <span class="hljs-keyword">in</span> bench.Elements()
  <span class="hljs-keyword">from</span> tool <span class="hljs-keyword">in</span> toolbox.Elements()
  <span class="hljs-keyword">where</span> tool.Name == <span class="hljs-string">&quot;handtool&quot;</span>
  <span class="hljs-keyword">select</span> tool.Value;

<span class="hljs-comment">// RESULT: { &quot;Hammer&quot;, &quot;Rasp&quot;, &quot;Saw&quot; }</span>
</code></pre>
<hr>
<h3>๐ข ูฺฉุชู ุฏุฑุจุงุฑู Elements</h3>
<ul>
<li>ูุชุฏ <strong>Elements</strong> ูุนุงุฏู ฺฉ ฺฉูุฆุฑ LINQ ุฑู <strong>Nodes</strong> ุงุณุช.<br>
ูุซูุงู ฺฉูุฆุฑ ูุจู ูโุชูุงูุณุช ุงูโุทูุฑ ุดุฑูุน ุดูุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">from</span> toolbox <span class="hljs-keyword">in</span> bench.Nodes().OfType&lt;XElement&gt;()
<span class="hljs-keyword">where</span> ...
</code></pre>
<ul>
<li>ูุชุฏ <strong>Elements</strong> ูโุชูุงูุฏ ููุท ุนูุงุตุฑ ุจุง ฺฉ ูุงู ูุดุฎุต ุฑุง ูู ุจุฑฺฏุฑุฏุงูุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">int</span> x = bench.Elements(<span class="hljs-string">&quot;toolbox&quot;</span>).Count();    <span class="hljs-comment">// 2</span>
</code></pre>
<p>ุงู ฺฉุฏ ูุนุงุฏู ุงุณุช ุจุง:</p>
<pre class="hljs"><code><span class="hljs-built_in">int</span> x = bench.Elements().Where (e =&gt; e.Name == <span class="hljs-string">&quot;toolbox&quot;</span>).Count();  <span class="hljs-comment">// 2</span>
</code></pre>
<ul>
<li>ูุชุฏ <strong>Elements</strong> ุจูโุนููุงู ฺฉ <strong>extension method</strong> ูู ุชุนุฑู ุดุฏู ฺฉู ฺฉ <strong>IEnumerable<XContainer></strong> (ุง ุฏููโุชุฑ: <code>IEnumerable&lt;T&gt; where T : XContainer</code>) ูโูพุฐุฑุฏ.<br>
ุจู ููู ุฏููุ ูโุชูุงูุฏ ุฑู ุฏูุจุงููโุง ุงุฒ ุนูุงุตุฑ ูู ฺฉุงุฑ ฺฉูุฏ.</li>
</ul>
<p>ูุซุงู ุจุงุฒููุณโุดุฏู ุจุฑุง ุงูุชู ุงุจุฒุงุฑูุง ุฏุณุช:</p>
<pre class="hljs"><code><span class="hljs-keyword">from</span> tool <span class="hljs-keyword">in</span> bench.Elements(<span class="hljs-string">&quot;toolbox&quot;</span>).Elements(<span class="hljs-string">&quot;handtool&quot;</span>)
<span class="hljs-keyword">select</span> tool.Value;
</code></pre>
<p>๐น ุฏุฑ ุงูุฌุง:</p>
<ul>
<li>ูุฑุงุฎูุงู ุงูู <strong>Elements</strong> ุจู ูุชุฏ ูููููโุง (instance method) ุฏุฑ <strong>XContainer</strong> ูุชุตู ูโุดูุฏ.</li>
<li>ูุฑุงุฎูุงู ุฏูู <strong>Elements</strong> ุจู ูุชุฏ ุชูุณุนูโุง (extension method) ูุชุตู ูโุดูุฏ.</li>
</ul>
<h3>ุจุงุฒุงุจ ฺฉ ุนูุตุฑ ูููุฑุฏ (Retrieving a Single Element)</h3>
<p>ูุชุฏ <strong>Element</strong> (ุชฺฉโุฌูุน) ุงููู ุนูุตุฑ ูุทุงุจู ุจุง ูุงู ุฏุงุฏูโุดุฏู ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ.<br>
ุงู ูุชุฏ ุจุฑุง ูพูุงุด ุณุงุฏู ููุฏ ุงุณุชุ ูุงููุฏ ูุซุงู ุฒุฑ:</p>
<pre class="hljs"><code>XElement settings = XElement.Load(<span class="hljs-string">&quot;databaseSettings.xml&quot;</span>);
<span class="hljs-built_in">string</span> cx = settings.Element(<span class="hljs-string">&quot;database&quot;</span>).Element(<span class="hljs-string">&quot;connectString&quot;</span>).Value;
</code></pre>
<p>ูุชุฏ <strong>Element</strong> ูุนุงุฏู ูุฑุงุฎูุงู <strong>Elements()</strong> ู ุณูพุณ ุงุนูุงู <strong>FirstOrDefault</strong> ุจุง ฺฉ predicate ุจุฑุง ูุทุงุจูุช ูุงู ุงุณุช.<br>
ุงฺฏุฑ ุนูุตุฑ ุฏุฑุฎูุงุณุชโุดุฏู ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏุ <strong>Element</strong> ููุฏุงุฑ <strong>null</strong> ุจุฑูโฺฏุฑุฏุงูุฏ.</p>
<blockquote>
<p>ุชูุฌู: ูุฑุงุฎูุงู <code>Element(&quot;xyz&quot;).Value</code> ุฒูุงู ฺฉู ุนูุตุฑ <code>xyz</code> ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏุ ุจุงุนุซ <strong>NullReferenceException</strong> ูโุดูุฏ.<br>
ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุงุณุชุซูุง ูโุชูุงูุฏ ุงุฒ <strong>null-conditional operator</strong> ุงุณุชูุงุฏู ฺฉูุฏ:</p>
</blockquote>
<pre class="hljs"><code>Element(<span class="hljs-string">&quot;xyz&quot;</span>)?.Value
</code></pre>
<p>ุง ุนูุตุฑ <strong>XElement</strong> ุฑุง ูุณุชููุงู ุจู <strong>string</strong> ุชุจุฏู ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-built_in">string</span> xyz = (<span class="hljs-built_in">string</span>)settings.Element(<span class="hljs-string">&quot;xyz&quot;</span>);
</code></pre>
<p>ุงู ฺฉุงุฑ ุงูฺฉุงูโูพุฐุฑ ุงุณุช ฺูู <strong>XElement</strong> ฺฉ ุชุจุฏู ุตุฑุญ ุจู ุฑุดุชู (explicit string conversion) ุชุนุฑู ฺฉุฑุฏู ุงุณุช. โ</p>
<hr>
<h3>ุจุงุฒุงุจ ูุฑุฒูุฏุงู ู ูููโูุง (Retrieving Descendants)</h3>
<p>ฺฉูุงุณ <strong>XContainer</strong> ููฺูู ูุชุฏูุง <strong>Descendants</strong> ู <strong>DescendantNodes</strong> ุฑุง ุงุฑุงุฆู ูโุฏูุฏ ฺฉู ุนูุงุตุฑ ุง ููุฏูุง ูุฑุฒูุฏ ู ุชูุงู ูุฑุฒูุฏุงู ุขูโูุง (ฺฉู ุฏุฑุฎุช) ุฑุง ุจุฑูโฺฏุฑุฏุงููุฏ.<br>
ูุชุฏ <strong>Descendants</strong> ฺฉ ูุงู ุนูุตุฑ ุงุฎุชุงุฑ ูู ูโูพุฐุฑุฏ.</p>
<p>ูุซุงู:</p>
<pre class="hljs"><code>Console.WriteLine(bench.Descendants(<span class="hljs-string">&quot;handtool&quot;</span>).Count());  <span class="hljs-comment">// 3</span>
</code></pre>
<p>ูู ูุงูุฏูุง ู ูู ุจุฑฺฏโูุง ุดุงูู ูโุดููุฏุ ููุงูโุทูุฑ ฺฉู ูุซุงู ุฒุฑ ูุดุงู ูโุฏูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">foreach</span> (XNode node <span class="hljs-keyword">in</span> bench.DescendantNodes())
  Console.WriteLine(node.ToString(SaveOptions.DisableFormatting));
</code></pre>
<p>๐น ุฎุฑูุฌ:</p>
<pre class="hljs"><code>&lt;toolbox&gt;&lt;handtool&gt;Hammer&lt;/handtool&gt;&lt;handtool&gt;Rasp&lt;/handtool&gt;&lt;/toolbox&gt;
&lt;handtool&gt;Hammer&lt;/handtool&gt;
Hammer
&lt;handtool&gt;Rasp&lt;/handtool&gt;
Rasp
&lt;toolbox&gt;&lt;handtool&gt;Saw&lt;/handtool&gt;&lt;powertool&gt;Nailgun&lt;/powertool&gt;&lt;/toolbox&gt;
&lt;handtool&gt;Saw&lt;/handtool&gt;
Saw
&lt;powertool&gt;Nailgun&lt;/powertool&gt;
Nailgun
&lt;!--Be careful with the nailgun--&gt;
</code></pre>
<p>ฺฉูุฆุฑ ุจุนุฏ ุชูุงู <strong>comment</strong>ูุง ุฏุงุฎู X-DOM ฺฉู ุดุงูู ฺฉูููโ &quot;careful&quot; ูุณุชูุฏ ุฑุง ุงุณุชุฎุฑุงุฌ ูโฺฉูุฏ:</p>
<pre class="hljs"><code>IEnumerable&lt;<span class="hljs-built_in">string</span>&gt; query =
  <span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> bench.DescendantNodes().OfType&lt;XComment&gt;()
  <span class="hljs-keyword">where</span> c.Value.Contains(<span class="hljs-string">&quot;careful&quot;</span>)
  <span class="hljs-keyword">orderby</span> c.Value
  <span class="hljs-keyword">select</span> c.Value;
</code></pre>
<hr>
<h3>ูพูุงุด ูุงูุฏู (Parent Navigation)</h3>
<p>ุชูุงู <strong>XNode</strong>ูุง ุฏุงุฑุง ุฎุตูุตุช <strong>Parent</strong> ู ูุชุฏูุง <strong>AncestorXXX</strong> ุจุฑุง ูพูุงุด ูุงูุฏู ูุณุชูุฏ.<br>
ฺฉ ูุงูุฏ ููุดู ุงุฒ ููุน <strong>XElement</strong> ุงุณุช.</p>
<div align="center">
<p><img src="../../../assets/image/10/Table-10-4.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ุงฺฏุฑ <strong>x</strong> ฺฉ <strong>XElement</strong> ุจุงุดุฏุ ฺฉุฏ ุฒุฑ ููุดู ููุฏุงุฑ <strong>true</strong> ฺุงูพ ูโฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">foreach</span> (XNode child <span class="hljs-keyword">in</span> x.Nodes())
  Console.WriteLine(child.Parent == x);
</code></pre>
<p>ุจุง ุงู ุญุงูุ ุงู ููุถูุน ุฏุฑ ููุฑุฏ <strong>XDocument</strong> ุตุงุฏู ูุณุช. <strong>XDocument</strong> ฺฉู ูุชูุงูุช ุงุณุช: ูโุชูุงูุฏ ูุฑุฒูุฏ ุฏุงุดุชู ุจุงุดุฏ ุงูุง ูุฑฺฏุฒ ููโุชูุงูุฏ ูุงูุฏ ูฺ ููุฏ ุจุงุดุฏ!</p>
<p>ุจุฑุง ุฏุณุชุฑุณ ุจู <strong>XDocument</strong>ุ ุจุงุฏ ุงุฒ ุฎุตูุตุช <strong>Document</strong> ุงุณุชูุงุฏู ฺฉูุฏุ ุงู ูฺฺฏ ุฑู ูุฑ ุดุก ุฏุฑ ุฏุฑุฎุช X-DOM ฺฉุงุฑ ูโฺฉูุฏ.</p>
<hr>
<h3>ูพูุงุด ูุงูุฏู (Ancestors)</h3>
<ul>
<li>ูุชุฏ <strong>Ancestors</strong> ฺฉ ุฏูุจุงูู ุจุฑูโฺฏุฑุฏุงูุฏ ฺฉู ุงููู ุนูุตุฑ ุขู <strong>Parent</strong> ุงุณุชุ ุนูุตุฑ ุจุนุฏ <strong>Parent.Parent</strong> ู ุจู ููู ุชุฑุชุจ ุชุง ุฑุณุฏู ุจู ุนูุตุฑ ุฑุดู ุงุฏุงูู ุฏุงุฑุฏ.</li>
<li>ูโุชูุงูุฏ ุจุง ฺฉูุฆุฑ LINQ ุฒุฑ ุจู ุนูุตุฑ ุฑุดู ุฏุณุชุฑุณ ูพุฏุง ฺฉูุฏ:</li>
</ul>
<pre class="hljs"><code>AncestorsAndSelf().Last();
</code></pre>
<ul>
<li>ุฑูุด ุฏฺฏุฑ ุจุฑุง ุฑุณุฏู ุจู ุนูุตุฑ ุฑุดู ุงู ุงุณุช ฺฉู ุงุฒ <strong>Document.Root</strong> ุงุณุชูุงุฏู ฺฉูุฏุ ุงูุจุชู ุงู ููุท ุฒูุงู ฺฉุงุฑ ูโฺฉูุฏ ฺฉู ฺฉ <strong>XDocument</strong> ููุฌูุฏ ุจุงุดุฏ.</li>
</ul>
<hr>
<h3>ูพูุงุด ููุฏูุง ููโุณุทุญ (Peer Node Navigation)</h3>
<div align="center">
<p><img src="../../../assets/image/10/Table-10-5.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ุจุง <strong>PreviousNode</strong> ู <strong>NextNode</strong> (ู ููฺูู <strong>FirstNode</strong> ู <strong>LastNode</strong>) ูโุชูุงูุฏ ููุฏูุง ุฑุง ูุงููุฏ ฺฉ <strong>ูุณุช ูพููุฏ (linked list)</strong> ูพูุงุด ฺฉูุฏ.<br>
ุงู ุงุชูุงู ุชุตุงุฏู ูุณุช: ุฏุฑ ุณุทุญ ุฏุงุฎูุ ููุฏูุง ุฏุฑ ฺฉ <strong>ูุณุช ูพููุฏ</strong> ุฐุฎุฑู ูโุดููุฏ.</p>
<blockquote>
<p>ุชูุฌู: <strong>XNode</strong> ุงุฒ ฺฉ ูุณุช ูพููุฏ ุชฺฉโุฌูุชู ุงุณุชูุงุฏู ูโฺฉูุฏุ ุจูุงุจุฑุงู <strong>PreviousNode</strong> ุนููฺฉุฑุฏ ฺูุฏุงู ุจูููโุง ูุฏุงุฑุฏ.</p>
</blockquote>
<hr>
<h3>ูพูุงุด ุตูุงุช (Attribute Navigation)</h3>
<div align="center">
<p><img src="../../../assets/image/10/Table-10-6.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ุนูุงูู ุจุฑ ุงูุ <strong>XAttribute</strong> ุฎุตูุตุงุช <strong>PreviousAttribute</strong> ู <strong>NextAttribute</strong> ุฑุง ุชุนุฑู ูโฺฉูุฏ ู ููฺูู <strong>Parent</strong> ุฑุง ุฏุงุฑุฏ.</p>
<p>ูุชุฏ <strong>Attributes</strong> ฺฉู ฺฉ ูุงู ุฑุง ูโูพุฐุฑุฏุ ฺฉ ุฏูุจุงูู ุจุง ุตูุฑ ุง ฺฉ ุนูุตุฑ ุจุฑูโฺฏุฑุฏุงูุฏุ ุฒุฑุง ฺฉ ุนูุตุฑ ููโุชูุงูุฏ ุฏุฑ XML ุตูุงุช ุจุง ูุงูโูุง ุชฺฉุฑุงุฑ ุฏุงุดุชู ุจุงุดุฏ. โ</p>
<hr>
<h3>ุจูโุฑูุฒุฑุณุงู X-DOM (Updating an X-DOM)</h3>
<p>ูโุชูุงูุฏ ุนูุงุตุฑ ู ุตูุงุช ุฑุง ุจู ุฑูุดโูุง ุฒุฑ ุจูโุฑูุฒุฑุณุงู ฺฉูุฏ:</p>
<ul>
<li>ูุฑุงุฎูุงู <strong>SetValue</strong> ุง ุงุฎุชุตุงุต ุฏูุจุงุฑู ุจู ุฎุตูุตุช <strong>Value</strong>.</li>
<li>ูุฑุงุฎูุงู <strong>SetElementValue</strong> ุง <strong>SetAttributeValue</strong>.</li>
<li>ูุฑุงุฎูุงู ฺฉ ุงุฒ ูุชุฏูุง <strong>RemoveXXX</strong>.</li>
<li>ูุฑุงุฎูุงู ฺฉ ุงุฒ ูุชุฏูุง <strong>AddXXX</strong> ุง <strong>ReplaceXXX</strong> ู ูุดุฎุต ฺฉุฑุฏู ูุญุชูุง ุฌุฏุฏ.</li>
</ul>
<p>ููฺูู ูโุชูุงูุฏ ุฎุตูุตุช <strong>Name</strong> ุฑุง ุฑู ุงุดุงุก <strong>XElement</strong> ุฏูุจุงุฑู ุงุฎุชุตุงุต ุฏูุฏ.</p>
<hr>
<h3>ุจูโุฑูุฒุฑุณุงู ุณุงุฏู ููุงุฏุฑ (Simple Value Updates)</h3>
<div align="center">
<p><img src="../../../assets/image/10/Table-10-7.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ูุชุฏ <strong>SetValue</strong> ูุญุชูุง ฺฉ ุนูุตุฑ ุง ุตูุช ุฑุง ุจุง ฺฉ ููุฏุงุฑ ุณุงุฏู ุฌุงฺฏุฒู ูโฺฉูุฏ.<br>
ุงุฎุชุตุงุต ููุฏุงุฑ ุจู ุฎุตูุตุช <strong>Value</strong> ูุฒ ููู ฺฉุงุฑ ุฑุง ุงูุฌุงู ูโุฏูุฏุ ุงูุง ููุท ุฏุงุฏูโูุง ุฑุดุชูโุง (<strong>string</strong>) ุฑุง ูโูพุฐุฑุฏ.<br>
ูุฑ ุฏู ุงู ุชูุงุจุน ุจูโุทูุฑ ุฏููโุชุฑ ุฏุฑ ุจุฎุด ยซWorking with Valuesยป ุฏุฑ ุตูุญู 537 ุชูุถุญ ุฏุงุฏู ุดุฏูโุงูุฏ. โ</p>
<p>ฺฉ ุงุฒ ุงุซุฑุงุช ูุฑุงุฎูุงู <strong>SetValue</strong> (ุง ุงุฎุชุตุงุต ุฏูุจุงุฑู ุจู <strong>Value</strong>) ุงู ุงุณุช ฺฉู <strong>ุชูุงู ููุฏูุง ูุฑุฒูุฏ ุฑุง ุฌุงฺฏุฒู ูโฺฉูุฏ</strong>:</p>
<pre class="hljs"><code>XElement settings = <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;settings&quot;</span>,
                      <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;timeout&quot;</span>, <span class="hljs-number">30</span>)
                    );

settings.SetValue(<span class="hljs-string">&quot;blah&quot;</span>);
Console.WriteLine(settings.ToString());  <span class="hljs-comment">// &lt;settings&gt;blah&lt;/settings&gt;</span>
</code></pre>
<hr>
<h3>ุจูโุฑูุฒุฑุณุงู ููุฏูุง ูุฑุฒูุฏ ู ุตูุงุช (Updating Child Nodes and Attributes)</h3>
<div align="center">
<p><img src="../../../assets/image/10/Table-10-8.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ุฑุงุญุชโุชุฑู ูุชุฏูุง ุฏุฑ ุงู ฺฏุฑููุ ุฏู ูุชุฏ ุขุฎุฑ ุนู <strong>SetElementValue</strong> ู <strong>SetAttributeValue</strong> ูุณุชูุฏ.<br>
ุงู ูุชุฏูุง ุจูโุนููุงู <strong>ูุงูโุจุฑ</strong> ุจุฑุง ุงุฌุงุฏ ฺฉ <strong>XElement</strong> ุง <strong>XAttribute</strong> ู ุณูพุณ <strong>ุงูุฒูุฏู ุขู ุจู ูุงูุฏ</strong> ุนูู ูโฺฉููุฏุ ู ุฏุฑ ุตูุฑุช ูุฌูุฏ ุนูุตุฑ ุง ุตูุช ุจุง ููุงู ูุงูุ ุขู ุฑุง ุฌุงฺฏุฒู ูโฺฉููุฏ:</p>
<pre class="hljs"><code>XElement settings = <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;settings&quot;</span>);

settings.SetElementValue(<span class="hljs-string">&quot;timeout&quot;</span>, <span class="hljs-number">30</span>);  <span class="hljs-comment">// ุงูุฒูุฏู ููุฏ ูุฑุฒูุฏ</span>
settings.SetElementValue(<span class="hljs-string">&quot;timeout&quot;</span>, <span class="hljs-number">60</span>);  <span class="hljs-comment">// ุจูโุฑูุฒุฑุณุงู ุจู 60</span>
</code></pre>
<ul>
<li>
<p>ูุชุฏ <strong>Add</strong> ฺฉ ููุฏ ูุฑุฒูุฏ ุจู ฺฉ ุนูุตุฑ ุง ุณูุฏ ุงุถุงูู ูโฺฉูุฏ.</p>
</li>
<li>
<p>ูุชุฏ <strong>AddFirst</strong> ููู ฺฉุงุฑ ุฑุง ุงูุฌุงู ูโุฏูุฏ ุงูุง ุฏุฑ ุงุจุชุฏุง ูุฌููุนู ุงุถุงูู ูโฺฉูุฏุ ูู ุฏุฑ ุงูุชูุง.</p>
</li>
<li>
<p>ูโุชูุงูุฏ ุชูุงู ููุฏูุง ูุฑุฒูุฏ ุง ุตูุงุช ุฑุง ฺฉุฌุง ุจุง <strong>RemoveNodes</strong> ุง <strong>RemoveAttributes</strong> ุญุฐู ฺฉูุฏ.</p>
</li>
<li>
<p><strong>RemoveAll</strong> ูุนุงุฏู ูุฑุงุฎูุงู ูุฑ ุฏู ูุชุฏ ุงุณุช.</p>
</li>
<li>
<p>ูุชุฏูุง <strong>ReplaceXXX</strong> ูุนุงุฏู ุญุฐู ู ุณูพุณ ุงูุฒูุฏู ูุณุชูุฏ. ุงู ูุชุฏูุง ุงุฒ ูุฑูุฏ <strong>snapshot</strong> ูโฺฏุฑูุฏุ ุจูุงุจุฑุงู ูุฑุงุฎูุงูโุง ูุงููุฏ:</p>
</li>
</ul>
<pre class="hljs"><code>e.ReplaceNodes(e.Nodes())
</code></pre>
<p>ุจูโุทูุฑ ููุฑุฏ ุงูุชุธุงุฑ ุนูู ูโฺฉูุฏ.</p>
<hr>
<h3>ุจูโุฑูุฒุฑุณุงู ุงุฒ ุทุฑู ูุงูุฏ (Updating Through the Parent)</h3>
<div align="center">
<p><img src="../../../assets/image/10/Table-10-9.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ูุชุฏูุง <strong>AddBeforeSelf</strong>ุ <strong>AddAfterSelf</strong>ุ <strong>Remove</strong> ู <strong>ReplaceWith</strong> ุฑู ูุฑุฒูุฏุงู ููุฏ ุนูู ููโฺฉููุฏ.<br>
ุฏุฑ ุนูุถุ ุงู ูุชุฏูุง ุฑู <strong>ูุฌููุนูโุง ฺฉู ุฎูุฏ ููุฏ ุฏุฑ ุขู ูุฑุงุฑ ุฏุงุฑุฏ</strong> ุนูู ูโฺฉููุฏ.<br>
ุจุฑุง ุงู ฺฉุงุฑุ ููุฏ ุจุงุฏ ุฏุงุฑุง <strong>ูุงูุฏ (Parent)</strong> ุจุงุดุฏุ ุฏุฑ ุบุฑ ุงู ุตูุฑุชุ ฺฉ ุงุณุชุซูุง (exception) ุงุฌุงุฏ ูโุดูุฏ.</p>
<ul>
<li><strong>AddBeforeSelf</strong> ู <strong>AddAfterSelf</strong> ุจุฑุง ุฏุฑุฌ ฺฉ ููุฏ ุฏุฑ <strong>ูููุนุช ุฏูุฎูุงู</strong> ููุฏ ูุณุชูุฏ:</li>
</ul>
<pre class="hljs"><code>XElement items = <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;items&quot;</span>,
                   <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;one&quot;</span>),
                   <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;three&quot;</span>)
                 );

items.FirstNode.AddAfterSelf(<span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;two&quot;</span>));
</code></pre>
<p>๐น ูุชุฌู:</p>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">items</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">one</span> /&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">two</span> /&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">three</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">items</span>&gt;</span>
</code></pre>
<p>ุฏุฑุฌ ุฏุฑ ฺฉ ูููุนุช ุฏูุฎูุงู ุฏุฑ ฺฉ ุฏูุจุงูู ุทููุงู ุงุฒ ุนูุงุตุฑ <strong>ฺฉุงุฑุขูุฏ</strong> ุงุณุช ุฒุฑุง ููุฏูุง ุจูโุตูุฑุช ุฏุงุฎู ุฏุฑ ฺฉ <strong>ูุณุช ูพููุฏ</strong> ุฐุฎุฑู ุดุฏูโุงูุฏ.</p>
<ul>
<li>ูุชุฏ <strong>Remove</strong> ููุฏ ุฌุงุฑ ุฑุง ุงุฒ ูุงูุฏ ุฎูุฏ ุญุฐู ูโฺฉูุฏ.</li>
<li>ูุชุฏ <strong>ReplaceWith</strong> ููู ฺฉุงุฑ ุฑุง ุงูุฌุงู ูโุฏูุฏ ู ุณูพุณ ูุญุชูุง ุฏฺฏุฑ ุฑุง ุฏุฑ ููุงู ูููุนุช ุฏุฑุฌ ูโฺฉูุฏ:</li>
</ul>
<pre class="hljs"><code>XElement items = XElement.Parse(<span class="hljs-string">&quot;&lt;items&gt;&lt;one/&gt;&lt;two/&gt;&lt;three/&gt;&lt;/items&gt;&quot;</span>);
items.FirstNode.ReplaceWith(<span class="hljs-keyword">new</span> XComment(<span class="hljs-string">&quot;One was here&quot;</span>));
</code></pre>
<p>๐น ูุชุฌู:</p>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">items</span>&gt;</span><span class="hljs-comment">&lt;!--One was here--&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">two</span> /&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">three</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">items</span>&gt;</span>
</code></pre>
<hr>
<h3>ุญุฐู ฺฉ ุฏูุจุงูู ุงุฒ ููุฏูุง ุง ุตูุงุช (Removing a Sequence of Nodes or Attributes)</h3>
<p>ุจู ูุทู <strong>extension method</strong>ูุง ููุฌูุฏ ุฏุฑ <strong>System.Xml.Linq</strong>ุ ูโุชูุงูุฏ ูุชุฏ <strong>Remove</strong> ุฑุง ุฑู ฺฉ ุฏูุจุงูู ุงุฒ ููุฏูุง ุง ุตูุงุช ูู ูุฑุงุฎูุงู ฺฉูุฏ.</p>
<p>ูุซุงู X-DOM:</p>
<pre class="hljs"><code>XElement contacts = XElement.Parse(
<span class="hljs-string">@&quot;&lt;contacts&gt;
    &lt;customer name=&#x27;Mary&#x27;/&gt;
    &lt;customer name=&#x27;Chris&#x27; archived=&#x27;true&#x27;/&gt;
    &lt;supplier name=&#x27;Susan&#x27;&gt;
      &lt;phone archived=&#x27;true&#x27;&gt;012345678&lt;!--confidential--&gt;&lt;/phone&gt;
    &lt;/supplier&gt;
&lt;/contacts&gt;&quot;</span>);
</code></pre>
<ul>
<li>ุญุฐู ุชูุงู ูุดุชุฑุงู:</li>
</ul>
<pre class="hljs"><code>contacts.Elements(<span class="hljs-string">&quot;customer&quot;</span>).Remove();
</code></pre>
<ul>
<li>ุญุฐู ุชูุงู ุนูุงุตุฑ ุขุฑุดู ุดุฏู (Chris ุญุฐู ูโุดูุฏ):</li>
</ul>
<pre class="hljs"><code>contacts.Elements()
        .Where(e =&gt; (<span class="hljs-built_in">bool</span>?) e.Attribute(<span class="hljs-string">&quot;archived&quot;</span>) == <span class="hljs-literal">true</span>)
        .Remove();
</code></pre>
<ul>
<li>ุงฺฏุฑ <strong>Elements()</strong> ุฑุง ุจุง <strong>Descendants()</strong> ุฌุงฺฏุฒู ฺฉููุ ุชูุงู ุนูุงุตุฑ ุขุฑุดู ุดุฏู ุฏุฑ ฺฉู DOM ุญุฐู ูโุดููุฏุ ู ูุชุฌู ุงู ุฎูุงูุฏ ุจูุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">contacts</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">customer</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;Mary&quot;</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">supplier</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;Susan&quot;</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">contacts</span>&gt;</span>
</code></pre>
<ul>
<li>ูุซุงู ุจุนุฏุ ุญุฐู ุชูุงู ุชูุงุณโูุง ฺฉู ุฏุฑ ูุฑ ุฌุง ุฏุฑุฎุช ฺฉุงููุช &quot;confidential&quot; ุฏุงุฑูุฏ:</li>
</ul>
<pre class="hljs"><code>contacts.Elements()
        .Where(e =&gt; e.DescendantNodes()
                     .OfType&lt;XComment&gt;()
                     .Any(c =&gt; c.Value == <span class="hljs-string">&quot;confidential&quot;</span>))
        .Remove();
</code></pre>
<p>๐น ูุชุฌู:</p>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">contacts</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">customer</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;Mary&quot;</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">customer</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;Chris&quot;</span> <span class="hljs-attr">archived</span>=<span class="hljs-string">&quot;true&quot;</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">contacts</span>&gt;</span>
</code></pre>
<ul>
<li>ููุงุณู ุจุง ฺฉูุฆุฑ ุณุงุฏูโุชุฑ ฺฉู ุชูุงู ููุฏูุง ฺฉุงููุช ุฑุง ุงุฒ ุฏุฑุฎุช ุญุฐู ูโฺฉูุฏ:</li>
</ul>
<pre class="hljs"><code>contacts.DescendantNodes().OfType&lt;XComment&gt;().Remove();
</code></pre>
<blockquote>
<p>ุฏุฑ ุณุทุญ ุฏุงุฎูุ ูุชุฏ <strong>Remove</strong> ุงุจุชุฏุง ููู ุนูุงุตุฑ ูุทุงุจู ุฑุง ุฏุฑ ฺฉ ูุณุช ูููุช ูโุฎูุงูุฏ ู ุณูพุณ ุฑู ููุงู ูุณุช ูููุช ูพูุงุด ฺฉุฑุฏู ู ุญุฐู ุฑุง ุงูุฌุงู ูโุฏูุฏ.<br>
ุงู ฺฉุงุฑ ุงุฒ ุฎุทุงูุง ุฌููฺฏุฑ ูโฺฉูุฏ ฺฉู ููฺฉู ุงุณุช ููฺฏุงู <strong>ุญุฐู ู ูพุฑุณโูุฌู ููุฒูุงู</strong> ุฑุฎ ุฏููุฏ.</p>
</blockquote>
<h3>ฺฉุงุฑ ุจุง ููุงุฏุฑ (Working with Values)</h3>
<p>ูู <strong>XElement</strong> ู ูู <strong>XAttribute</strong> ุฏุงุฑุง ุฎุตูุตุช <strong>Value</strong> ุงุฒ ููุน <strong>string</strong> ูุณุชูุฏ.</p>
<ul>
<li>ุงฺฏุฑ ฺฉ ุนูุตุฑ ุชููุง ฺฉ ููุฏ ูุฑุฒูุฏ <strong>XText</strong> ุฏุงุดุชู ุจุงุดุฏุ ุฎุตูุตุช <strong>Value</strong> ุฏุฑ <strong>XElement</strong> ุจูโุนููุงู ฺฉ <strong>ูุงูโุจุฑ ููุงุณุจ</strong> ุจุฑุง ูุญุชูุง ุขู ููุฏ ุนูู ูโฺฉูุฏ.</li>
<li>ุฏุฑ <strong>XAttribute</strong>ุ ุฎุตูุตุช <strong>Value</strong> ุตุฑูุงู ููุฏุงุฑ ุตูุช ุฑุง ูฺฏู ูโุฏุงุฑุฏ.</li>
</ul>
<p>ุจุง ูุฌูุฏ ุชูุงูุชโูุง ุฐุฎุฑูโุณุงุฒุ <strong>X-DOM</strong> ูุฌููุนูโุง ฺฉููุงุฎุช ุงุฒ ุนููุงุช ุจุฑุง ฺฉุงุฑ ุจุง ููุงุฏุฑ ุนูุงุตุฑ ู ุตูุงุช ุงุฑุงุฆู ูโุฏูุฏ. โ</p>
<hr>
<h3>ุงุฎุชุตุงุต ููุงุฏุฑ (Setting Values)</h3>
<p>ุฏู ุฑูุด ุจุฑุง ุงุฎุชุตุงุต ููุฏุงุฑ ูุฌูุฏ ุฏุงุฑุฏ: ูุฑุงุฎูุงู <strong>SetValue</strong> ุง ุงุฎุชุตุงุต ุจู ุฎุตูุตุช <strong>Value</strong>.</p>
<ul>
<li><strong>SetValue</strong> ุงูุนุทุงูโูพุฐุฑ ุจุดุชุฑ ุฏุงุฑุฏุ ุฒุฑุง ููุท ุฑุดุชู ุฑุง ููโูพุฐุฑุฏ ุจูฺฉู ุงููุงุน ุฏุงุฏู ุณุงุฏู ุฏฺฏุฑ ุฑุง ูุฒ ูุจูู ูโฺฉูุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">var</span> e = <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;date&quot;</span>, DateTime.Now);
e.SetValue(DateTime.Now.AddDays(<span class="hljs-number">1</span>));
Console.Write(e.Value);  <span class="hljs-comment">// 2019-10-02T16:39:10.734375+09:00</span>
</code></pre>
<p>ูโุชูุงูุณุชู ุจู ุฌุง ุขูุ ูุณุชููุงู <strong>Value</strong> ุฑุง ุงุฎุชุตุงุต ุฏููุ ุงูุง ุฏุฑ ุงู ุตูุฑุช ูุฌุจูุฑ ุจูุฏู <strong>DateTime</strong> ุฑุง ุฏุณุช ุจู ุฑุดุชู ุชุจุฏู ฺฉูู ฺฉู ูพฺุฏูโุชุฑ ุงุณุช ู ูุงุฒ ุจู ุงุณุชูุงุฏู ุงุฒ <strong>XmlConvert</strong> ุจุฑุง ูุชุฌู ุณุงุฒฺฏุงุฑ ุจุง XML ุฏุงุฑุฏ.</p>
<ul>
<li>
<p>ููฺฏุงู ุงุฑุณุงู ููุฏุงุฑ ุจู ุณุงุฒูุฏู <strong>XElement</strong> ุง <strong>XAttribute</strong>ุ ุชุจุฏู ุฎูุฏฺฉุงุฑ ุจุฑุง ุงููุงุน ุบุฑุฑุดุชูโุง ูุฒ ุงูุฌุงู ูโุดูุฏ. ุงู ุงุทููุงู ูโุฏูุฏ ฺฉู:</p>
<ul>
<li><strong>DateTime</strong> ุจูโุฏุฑุณุช ูุฑูุช ูโุดูุฏ</li>
<li><strong>true</strong> ุจุง ุญุฑูู ฺฉูฺฺฉ ููุดุชู ูโุดูุฏ</li>
<li><strong>double.NegativeInfinity</strong> ุจู ุตูุฑุช &quot;-INF&quot; ููุดุชู ูโุดูุฏ</li>
</ul>
</li>
</ul>
<hr>
<h3>ุจุงุฒุงุจ ููุงุฏุฑ (Getting Values)</h3>
<p>ุจุฑุง ุจุฑุนฺฉุณ ฺฉุฑุฏูุ ุนู ุชุจุฏู <strong>Value</strong> ุจู ููุน ูพุงูุ ฺฉุงู ุงุณุช <strong>XElement</strong> ุง <strong>XAttribute</strong> ุฑุง ุจู ููุน ููุฑุฏ ูุธุฑ <strong>cast</strong> ฺฉูุฏ:</p>
<pre class="hljs"><code>XElement e = <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;now&quot;</span>, DateTime.Now);
DateTime dt = (DateTime)e;

XAttribute a = <span class="hljs-keyword">new</span> XAttribute(<span class="hljs-string">&quot;resolution&quot;</span>, <span class="hljs-number">1.234</span>);
<span class="hljs-built_in">double</span> res = (<span class="hljs-built_in">double</span>)a;
</code></pre>
<ul>
<li>ุนูุงุตุฑ ุง ุตูุงุช ุจูโุทูุฑ ุจูู <strong>DateTime</strong> ุง ุงุนุฏุงุฏ ุฑุง ุฐุฎุฑู ููโฺฉููุฏุ ููุดู ุจูโุตูุฑุช ูุชู ุฐุฎุฑู ู ุฏุฑ ุตูุฑุช ูุงุฒ ุชุฌุฒู ูโุดููุฏ.</li>
<li>ููุน ุงุตู ุฐุฎุฑู ุดุฏู ยซุจู ุงุฏ ููโูุงูุฏยปุ ุจูุงุจุฑุงู ุจุงุฏ <strong>cast</strong> ุฑุง ุจูโุฏุฑุณุช ุงูุฌุงู ุฏูุฏ ุชุง ุงุฒ ุฎุทุง ุฒูุงู ุงุฌุฑุง ุฌููฺฏุฑ ุดูุฏ.</li>
<li>ุจุฑุง ุงุฌุงุฏ ฺฉุฏ ููุงููุ ูโุชูุงูุฏ <strong>cast</strong> ุฑุง ุฏุฑ ุจููฺฉ <strong>try/catch</strong> ูุฑุงุฑ ุฏูุฏ ู <strong>FormatException</strong> ุฑุง ูุฏุฑุช ฺฉูุฏ.</li>
</ul>
<hr>
<h3>ุงููุงุน ูพุดุชุจุงู ุดุฏู ุจุฑุง cast ุตุฑุญ</h3>
<p><strong>XElement</strong> ู <strong>XAttribute</strong> ูโุชูุงููุฏ ุจู ุงููุงุน ุฒุฑ cast ุดููุฏ:</p>
<ul>
<li>
<p>ุชูุงู ุงููุงุน ุนุฏุฏ ุงุณุชุงูุฏุงุฑุฏ</p>
</li>
<li>
<p><strong>string</strong>ุ <strong>bool</strong>ุ <strong>DateTime</strong>ุ <strong>DateTimeOffset</strong>ุ <strong>TimeSpan</strong>ุ ู <strong>Guid</strong></p>
</li>
<li>
<p>ูุณุฎูโูุง <strong>Nullable&lt;&gt;</strong> ุงุฒ ุงููุงุน ุจุงูุง</p>
</li>
<li>
<p>ุงุณุชูุงุฏู ุงุฒ <strong>nullable</strong> ููุฏ ุงุณุช ููฺฏุงู ุงุณุชูุงุฏู ุงุฒ ูุชุฏูุง <strong>Element</strong> ู <strong>Attribute</strong>ุ ุฒุฑุง ุงฺฏุฑ ูุงู ููุฑุฏ ูุธุฑ ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏุ cast ูููุฒ ฺฉุงุฑ ูโฺฉูุฏ:</p>
</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">int</span> timeout = (<span class="hljs-built_in">int</span>)x.Element(<span class="hljs-string">&quot;timeout&quot;</span>);      <span class="hljs-comment">// ุฎุทุง</span>
<span class="hljs-built_in">int</span>? timeout = (<span class="hljs-built_in">int</span>?)x.Element(<span class="hljs-string">&quot;timeout&quot;</span>);    <span class="hljs-comment">// ุฏุฑุณุชุ timeout = null</span>
</code></pre>
<ul>
<li>ูโุชูุงูุฏ ููุฏุงุฑ ูพุดโูุฑุถ ุฑุง ุจุง ุนููฺฏุฑ <strong>??</strong> ูุดุฎุต ฺฉูุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">double</span> resolution = (<span class="hljs-built_in">double</span>?)x.Attribute(<span class="hljs-string">&quot;resolution&quot;</span>) ?? <span class="hljs-number">1.0</span>;
</code></pre>
<blockquote>
<p>ุชูุฌู: cast ุจู nullable ุดูุง ุฑุง ุงุฒ ุฎุทุง ุฏุฑ ุตูุฑุช ฺฉู ููุฏุงุฑ ุนูุตุฑ ุง ุตูุช ุฎุงู ุง ุจุง ูุฑูุช ูุงุฏุฑุณุช ุจุงุดุฏุ ูุฌุงุช ููโุฏูุฏ. ุฏุฑ ุงู ููุงุฑุฏ ุจุงุฏ <strong>FormatException</strong> ุฑุง ูุฏุฑุช ฺฉูุฏ.</p>
</blockquote>
<hr>
<h3>ุงุณุชูุงุฏู ุงุฒ cast ุฏุฑ ฺฉูุฆุฑโูุง LINQ</h3>
<p>ูุซุงู: ุจุงุฒฺฏุฑุฏุงูุฏู ูุงู ูุดุชุฑุงู ฺฉู ุงุนุชุจุงุฑ ุจุงูุง 100 ุฏุงุฑูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> data = XElement.Parse(
<span class="hljs-string">@&quot;&lt;data&gt;
      &lt;customer id=&#x27;1&#x27; name=&#x27;Mary&#x27; credit=&#x27;100&#x27; /&gt;
      &lt;customer id=&#x27;2&#x27; name=&#x27;John&#x27; credit=&#x27;150&#x27; /&gt;
      &lt;customer id=&#x27;3&#x27; name=&#x27;Anne&#x27; /&gt;
&lt;/data&gt;&quot;</span>);

IEnumerable&lt;<span class="hljs-built_in">string</span>&gt; query = <span class="hljs-keyword">from</span> cust <span class="hljs-keyword">in</span> data.Elements()
                            <span class="hljs-keyword">where</span> (<span class="hljs-built_in">int</span>?)cust.Attribute(<span class="hljs-string">&quot;credit&quot;</span>) &gt; <span class="hljs-number">100</span>
                            <span class="hljs-keyword">select</span> cust.Attribute(<span class="hljs-string">&quot;name&quot;</span>).Value;
</code></pre>
<ul>
<li>ุงุณุชูุงุฏู ุงุฒ <strong>nullable int</strong> ุงุฒ ุจุฑูุฒ <strong>NullReferenceException</strong> ุจุฑุง ูุดุชุฑโุง ูุซู Anne ฺฉู ุตูุช credit ูุฏุงุฑุฏ ุฌููฺฏุฑ ูโฺฉูุฏ.</li>
<li>ุงุตูู ูุดุงุจู ุจุฑุง ูพุฑุณโูุฌู ุฑู ููุงุฏุฑ ุนูุงุตุฑ ูุฒ ุงุนูุงู ูโุดูุฏ.</li>
</ul>
<hr>
<h3>ููุงุฏุฑ ู ููุฏูุง ูุญุชูุง ุชุฑฺฉุจ (Values and Mixed Content Nodes)</h3>
<p>ุฒูุงู ฺฉู ูุญุชูุง <strong>ูุฎุชูุท</strong> ุงุณุชุ ููฺฉู ุงุณุช ูุงุฒ ุจุงุดุฏ ูุณุชููุงู ุจุง <strong>XText</strong> ฺฉุงุฑ ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">summary</span>&gt;</span>An XAttribute is <span class="hljs-tag">&lt;<span class="hljs-name">bold</span>&gt;</span>not<span class="hljs-tag">&lt;/<span class="hljs-name">bold</span>&gt;</span> an XNode<span class="hljs-tag">&lt;/<span class="hljs-name">summary</span>&gt;</span>
</code></pre>
<ul>
<li>ุนูุตุฑ <strong>summary</strong> ุณู ูุฑุฒูุฏ ุฏุงุฑุฏ: <strong>XText</strong>ุ ุณูพุณ <strong>XElement</strong>ุ ุณูพุณ ุฏูุจุงุฑู <strong>XText</strong>.</li>
</ul>
<p>ุณุงุฎุช ุขู:</p>
<pre class="hljs"><code>XElement summary = <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;summary&quot;</span>,
                      <span class="hljs-keyword">new</span> XText(<span class="hljs-string">&quot;An XAttribute is &quot;</span>),
                      <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;bold&quot;</span>, <span class="hljs-string">&quot;not&quot;</span>),
                      <span class="hljs-keyword">new</span> XText(<span class="hljs-string">&quot; an XNode&quot;</span>));
</code></pre>
<ul>
<li>ุฌุงูุจ ุงูุฌุงุณุช ฺฉู ูโุชูุงูู ูููุฒ <strong>summary.Value</strong> ุฑุง ฺฉูุฆุฑ ฺฉูู ุจุฏูู ุงุฌุงุฏ ุงุณุชุซูุงุ ุญุงุตู <strong>ุชุฑฺฉุจ ููุงุฏุฑ ููู ูุฑุฒูุฏุงู</strong> ุงุณุช:</li>
</ul>
<pre class="hljs"><code>An XAttribute is not an XNode
</code></pre>
<ul>
<li>ูโุชูุงู ููุฏุงุฑ <strong>Value</strong> ุฑุง ุฏูุจุงุฑู ุงุฎุชุตุงุต ุฏุงุฏุ ุงูุง ููู ูุฑุฒูุฏุงู ูุจู ุจุง ฺฉ ููุฏ <strong>XText</strong> ุฌุฏุฏ ุฌุงฺฏุฒู ูโุดููุฏ.</li>
</ul>
<hr>
<h3>ุชุฑฺฉุจ ุฎูุฏฺฉุงุฑ XText</h3>
<ul>
<li>ููุช ูุญุชูุง ุณุงุฏูโุง ุจู ฺฉ <strong>XElement</strong> ุงุถุงูู ูโฺฉูุฏุ <strong>X-DOM</strong> ุจู ุฌุง ุงุฌุงุฏ ููุฏ ุฌุฏุฏุ ุจู <strong>XText</strong> ููุฌูุฏ ุงุถุงูู ูโฺฉูุฏ.</li>
</ul>
<p>ูุซุงูโูุง:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> e1 = <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;test&quot;</span>, <span class="hljs-string">&quot;Hello&quot;</span>); e1.Add(<span class="hljs-string">&quot;World&quot;</span>);
<span class="hljs-keyword">var</span> e2 = <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;test&quot;</span>, <span class="hljs-string">&quot;Hello&quot;</span>, <span class="hljs-string">&quot;World&quot;</span>);
</code></pre>
<ul>
<li>
<p>ูุฑ ุฏู <strong>e1</strong> ู <strong>e2</strong> ููุท ฺฉ ูุฑุฒูุฏ <strong>XText</strong> ุฏุงุฑูุฏ ุจุง ููุฏุงุฑ <code>&quot;HelloWorld&quot;</code>.</p>
</li>
<li>
<p>ุงฺฏุฑ ุตุฑุญุงู ฺูุฏ ููุฏ <strong>XText</strong> ุจุณุงุฒุฏุ ฺูุฏ ูุฑุฒูุฏ ุฎูุงูุฏ ุฏุงุดุช:</p>
</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">var</span> e = <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;test&quot;</span>, <span class="hljs-keyword">new</span> XText(<span class="hljs-string">&quot;Hello&quot;</span>), <span class="hljs-keyword">new</span> XText(<span class="hljs-string">&quot;World&quot;</span>));
Console.WriteLine(e.Value);           <span class="hljs-comment">// HelloWorld</span>
Console.WriteLine(e.Nodes().Count()); <span class="hljs-comment">// 2</span>
</code></pre>
<ul>
<li><strong>XElement</strong> ููุฏูุง <strong>XText</strong> ุฑุง ุจู ูู ูุชุตู ููโฺฉูุฏุ ุจูุงุจุฑุงู <strong>ููุช ุงุดุงุก ููุฏูุง ุญูุธ ูโุดูุฏ</strong>.</li>
</ul>
<h3>ุงุณูุงุฏ ู ุงุนูุงูโูุง (Documents and Declarations)</h3>
<h4>XDocument</h4>
<p>ููุงูุทูุฑ ฺฉู ูุจูุงู ฺฏูุชูุ <strong>XDocument</strong> ฺฉ ุนูุตุฑ ุฑุดู <strong>XElement</strong> ุฑุง ุจุณุชูโุจูุฏ ูโฺฉูุฏ ู ุงูฺฉุงู ุงุถุงูู ฺฉุฑุฏู ููุงุฑุฏ ุฒุฑ ุฑุง ูุฑุงูู ูโฺฉูุฏ:</p>
<ul>
<li><strong>XDeclaration</strong> (ุงุนูุงู XML)</li>
<li>ุฏุณุชูุฑุงุช ูพุฑุฏุงุฒุด (<strong>Processing Instructions</strong>)</li>
<li>ููุน ุณูุฏ (<strong>XDocumentType</strong>)</li>
<li>ูุธุฑุงุช ุฏุฑ ุณุทุญ ุฑุดู (<strong>XComment</strong>)</li>
</ul>
<blockquote>
<p><strong>ูฺฉุชู ููู:</strong> ูุฌูุฏ <strong>XDocument</strong> ุงุฎุชุงุฑ ุงุณุช ู ูโุชูุงู ุขู ุฑุง ูุงุฏุฏู ฺฏุฑูุช ุง ุญุฐู ฺฉุฑุฏ. ุจุฑุฎูุงู <strong>W3C DOM</strong>ุ XDocument ุจูโุนููุงู ยซฺุณุจยป ุจุฑุง ูฺฏู ุฏุงุดุชู ููู ฺุฒ ฺฉูุงุฑ ูู ุนูู ููโฺฉูุฏ.</p>
</blockquote>
<hr>
<h4>ูุญุชูุงุช ูุฌุงุฒ XDocument</h4>
<p>XDocument ูโุชูุงูุฏ ููุท ุงููุงุน ูุญุฏูุฏ ุงุฒ ูุญุชูุง ุฑุง ุจูพุฐุฑุฏ:</p>
<ul>
<li>ฺฉ <strong>XElement</strong> (ุนูุตุฑ ุฑุดู) โ ุงุฌุจุงุฑ ุจุฑุง ุฏุงุดุชู XDocument ูุนุชุจุฑ</li>
<li>ฺฉ <strong>XDeclaration</strong> โ ุงุฎุชุงุฑุ ุงฺฏุฑ ุญุฐู ุดูุฏุ ููุงุฏุฑ ูพุดโูุฑุถ ููฺฏุงู ุณุฑุงูโุณุงุฒ ุงุนูุงู ูโุดููุฏ</li>
<li>ฺฉ <strong>XDocumentType</strong> (ุจุฑุง ุงุฑุฌุงุน ุจู DTD)</li>
<li>ูุฑ ุชุนุฏุงุฏ <strong>XProcessingInstruction</strong></li>
<li>ูุฑ ุชุนุฏุงุฏ <strong>XComment</strong></li>
</ul>
<hr>
<h4>ููููู ุณุงุฏู ุงุฒ XDocument ูุนุชุจุฑ</h4>
<pre class="hljs"><code><span class="hljs-keyword">var</span> doc = <span class="hljs-keyword">new</span> XDocument(
    <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;test&quot;</span>, <span class="hljs-string">&quot;data&quot;</span>)
);
</code></pre>
<ul>
<li>ุฏุฑ ูุซุงู ุจุงูุง <strong>XDeclaration</strong> ูุงุฑุฏ ูุดุฏู ุงุณุชุ ุงูุง ููฺฏุงู ูุฑุงุฎูุงู <strong>doc.Save</strong>ุ ฺฉ ุงุนูุงู XML ุจูโุตูุฑุช ูพุดโูุฑุถ ุชููุฏ ูโุดูุฏ.</li>
</ul>
<hr>
<h4>ููููู ุงุฌุงุฏ ฺฉ ูุงู XHTML</h4>
<pre class="hljs"><code><span class="hljs-keyword">var</span> styleInstruction = <span class="hljs-keyword">new</span> XProcessingInstruction(
    <span class="hljs-string">&quot;xml-stylesheet&quot;</span>, <span class="hljs-string">&quot;href=&#x27;styles.css&#x27; type=&#x27;text/css&#x27;&quot;</span>
);
<span class="hljs-keyword">var</span> docType = <span class="hljs-keyword">new</span> XDocumentType(
    <span class="hljs-string">&quot;html&quot;</span>,
    <span class="hljs-string">&quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot;</span>,
    <span class="hljs-string">&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;</span>,
    <span class="hljs-literal">null</span>
);

XNamespace ns = <span class="hljs-string">&quot;http://www.w3.org/1999/xhtml&quot;</span>;

<span class="hljs-keyword">var</span> root = <span class="hljs-keyword">new</span> XElement(ns + <span class="hljs-string">&quot;html&quot;</span>,
    <span class="hljs-keyword">new</span> XElement(ns + <span class="hljs-string">&quot;head&quot;</span>,
        <span class="hljs-keyword">new</span> XElement(ns + <span class="hljs-string">&quot;title&quot;</span>, <span class="hljs-string">&quot;An XHTML page&quot;</span>)
    ),
    <span class="hljs-keyword">new</span> XElement(ns + <span class="hljs-string">&quot;body&quot;</span>,
        <span class="hljs-keyword">new</span> XElement(ns + <span class="hljs-string">&quot;p&quot;</span>, <span class="hljs-string">&quot;This is the content&quot;</span>)
    )
);

<span class="hljs-keyword">var</span> doc = <span class="hljs-keyword">new</span> XDocument(
    <span class="hljs-keyword">new</span> XDeclaration(<span class="hljs-string">&quot;1.0&quot;</span>, <span class="hljs-string">&quot;utf-8&quot;</span>, <span class="hljs-string">&quot;no&quot;</span>),
    <span class="hljs-keyword">new</span> XComment(<span class="hljs-string">&quot;Reference a stylesheet&quot;</span>),
    styleInstruction,
    docType,
    root
);

doc.Save(<span class="hljs-string">&quot;test.html&quot;</span>);
</code></pre>
<ul>
<li>ูุญุชูุง <strong>test.html</strong> ุชููุฏ ุดุฏู:</li>
</ul>
<pre class="hljs"><code><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span> standalone=<span class="hljs-string">&quot;no&quot;</span>?&gt;</span>
<span class="hljs-comment">&lt;!--Reference a stylesheet--&gt;</span>
<span class="hljs-meta">&lt;?xml-stylesheet href=&#x27;styles.css&#x27; type=&#x27;text/css&#x27;?&gt;</span>
<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot;</span>
                      <span class="hljs-string">&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.w3.org/1999/xhtml&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>An XHTML page<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>This is the content<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<hr>
<h4>ุฏุณุชุฑุณ ุจู ุฑุดู ู ุงุฑุชุจุงุทุงุช</h4>
<ul>
<li>ุฎุตูุตุช <strong>Root</strong> ุฏุฑ <strong>XDocument</strong> ฺฉ ูุงูโุจุฑ ุจุฑุง ุฏุณุชุฑุณ ุจู ุนูุตุฑ ุฑุดู ุงุณุช.</li>
<li>ููฺฉ ูุนฺฉูุณ ุงุฒ ูุฑ ุดุก ุฏุฑ ุฏุฑุฎุช ุจุง ุฎุตูุตุช <strong>Document</strong> ุงุฒ <strong>XObject</strong> ุงุฑุงุฆู ูโุดูุฏ:</li>
</ul>
<pre class="hljs"><code>Console.WriteLine(doc.Root.Name.LocalName);          <span class="hljs-comment">// html</span>
XElement bodyNode = doc.Root.Element(ns + <span class="hljs-string">&quot;body&quot;</span>);
Console.WriteLine(bodyNode.Document == doc);         <span class="hljs-comment">// True</span>
</code></pre>
<ul>
<li>ูุฑุฒูุฏุงู ฺฉ ุณูุฏ ูฺ ูุงูุฏ (Parent) ูุฏุงุฑูุฏ:</li>
</ul>
<pre class="hljs"><code>Console.WriteLine(doc.Root.Parent == <span class="hljs-literal">null</span>);          <span class="hljs-comment">// True</span>
<span class="hljs-keyword">foreach</span> (XNode node <span class="hljs-keyword">in</span> doc.Nodes())
    Console.Write(node.Parent == <span class="hljs-literal">null</span>);              <span class="hljs-comment">// TrueTrueTrueTrue</span>
</code></pre>
<blockquote>
<p>ุชูุฌู: <strong>XDeclaration</strong> ฺฉ <strong>XNode</strong> ูุณุช ู ุฏุฑ ูุฌููุนู <strong>Nodes</strong> ุณูุฏ ุธุงูุฑ ููโุดูุฏ. ููุท ุจู ุฎุตูุตุช <strong>Declaration</strong> ุงุฎุชุตุงุต ุฏุงุฏู ูโุดูุฏ. ุจู ููู ุฏูู ุฏุฑ ูุซุงู ุจุงูุงุ ููุฏุงุฑ &quot;True&quot; ฺูุงุฑ ุจุงุฑ ุชฺฉุฑุงุฑ ุดุฏ ู ูู ูพูุฌ ุจุงุฑ.</p>
</blockquote>
<h3>ุงุนูุงูโูุง XML (XML Declarations)</h3>
<p>ฺฉ ูุงู XML ุงุณุชุงูุฏุงุฑุฏ ุจุง ฺฉ ุงุนูุงู ุดุฑูุน ูโุดูุฏุ ูุงููุฏ:</p>
<pre class="hljs"><code><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span> standalone=<span class="hljs-string">&quot;yes&quot;</span>?&gt;</span>
</code></pre>
<ul>
<li>ุงุนูุงู XML ุชุถูู ูโฺฉูุฏ ฺฉู ูุงู ุจู ุฏุฑุณุช ุชูุณุท ุฎูุงููุฏู (Reader) ูพุฑุฏุงุฒุด ู ุฏุฑฺฉ ุดูุฏ.</li>
</ul>
<h4>ุฑูุชุงุฑ XElement ู XDocument ููฺฏุงู ุชููุฏ ุงุนูุงู XML</h4>
<ul>
<li><strong>Save ุจุง ูุงู ูุงู</strong> โ ููุดู ฺฉ ุงุนูุงู ูโููุณุฏ.</li>
<li><strong>Save ุจุง XmlWriter</strong> โ ุงุนูุงู ูโููุณุฏ ูฺฏุฑ ุงูฺฉู XmlWriter ุจู ูุญู ุชูุธู ุดูุฏ ฺฉู ุงุนูุงู ุชููุฏ ูฺฉูุฏ.</li>
<li><strong>ToString</strong> โ ูฺโฺฏุงู ุงุนูุงู XML ุชููุฏ ููโฺฉูุฏ.</li>
</ul>
<blockquote>
<p>ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุชููุฏ ุงุนูุงูุ ูโุชูุงู <strong>OmitXmlDeclaration</strong> ู <strong>ConformanceLevel</strong> ุฑุง ุฏุฑ <strong>XmlWriterSettings</strong> ููฺฏุงู ุณุงุฎุช XmlWriter ุชูุธู ฺฉุฑุฏ.</p>
</blockquote>
<hr>
<h4>ููุด XDeclaration</h4>
<p>ูุฌูุฏ ุง ุนุฏู ูุฌูุฏ <strong>XDeclaration</strong> ุจุฑ ููุดุชู ุงุนูุงู ุชุฃุซุฑ ูุฏุงุฑุฏ. ูุฏู ุงุตู XDeclaration ุงู ุงุณุช ฺฉู ุจู ุณุฑุงูโุณุงุฒ XML ุฑุงูููุง ฺฉูุฏ:</p>
<ul>
<li>ฺู <strong>ฺฉุฏฺฏุฐุงุฑ ูุชู</strong> (encoding) ุงุณุชูุงุฏู ุดูุฏ</li>
<li>ฺู ููุงุฏุฑ ุฏุฑ <strong>ูฺฺฏโูุง encoding ู standalone</strong> ุงุนูุงู XML ููุดุชู ุดููุฏ</li>
</ul>
<h4>ููููู ุงุฌุงุฏ XDeclaration ู XDocument ุจุง UTF-16</h4>
<pre class="hljs"><code><span class="hljs-keyword">var</span> doc = <span class="hljs-keyword">new</span> XDocument(
    <span class="hljs-keyword">new</span> XDeclaration(<span class="hljs-string">&quot;1.0&quot;</span>, <span class="hljs-string">&quot;utf-16&quot;</span>, <span class="hljs-string">&quot;yes&quot;</span>),
    <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;test&quot;</span>, <span class="hljs-string">&quot;data&quot;</span>)
);
doc.Save(<span class="hljs-string">&quot;test.xml&quot;</span>);
</code></pre>
<ul>
<li>ุชูุฌู: ูุณุฎู (version) ููุดู ุจู &quot;1.0&quot; ููุดุชู ูโุดูุฏ.</li>
<li>encoding ุจุงุฏ ฺฉ ฺฉุฏ IETF ูุงููุฏ <code>&quot;utf-16&quot;</code> ุจุงุดุฏ.</li>
</ul>
<hr>
<h4>ููุดุชู ุงุนูุงู ุจู ุฑุดุชู (String)</h4>
<ul>
<li><strong>ToString</strong> ุงุนูุงู ุชููุฏ ููโฺฉูุฏุ ุจูุงุจุฑุงู ุจุงุฏ ุงุฒ <strong>XmlWriter</strong> ุงุณุชูุงุฏู ฺฉุฑุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">var</span> doc = <span class="hljs-keyword">new</span> XDocument(
    <span class="hljs-keyword">new</span> XDeclaration(<span class="hljs-string">&quot;1.0&quot;</span>, <span class="hljs-string">&quot;utf-8&quot;</span>, <span class="hljs-string">&quot;yes&quot;</span>),
    <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;test&quot;</span>, <span class="hljs-string">&quot;data&quot;</span>)
);

<span class="hljs-keyword">var</span> output = <span class="hljs-keyword">new</span> StringBuilder();
<span class="hljs-keyword">var</span> settings = <span class="hljs-keyword">new</span> XmlWriterSettings { Indent = <span class="hljs-literal">true</span> };

<span class="hljs-keyword">using</span> (XmlWriter xw = XmlWriter.Create(output, settings))
    doc.Save(xw);

Console.WriteLine(output.ToString());
</code></pre>
<ul>
<li>ุฎุฑูุฌ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-16&quot;</span> standalone=<span class="hljs-string">&quot;yes&quot;</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">test</span>&gt;</span>data<span class="hljs-tag">&lt;/<span class="hljs-name">test</span>&gt;</span>
</code></pre>
<blockquote>
<p>ุฏูู UTF-16: ุฑุดุชูโูุง ุฏุฑ ุญุงูุธู ุฏุงุฎู ุจู ุตูุฑุช UTF-16 ุฐุฎุฑู ูโุดููุฏุ ุจูุงุจุฑุงู XmlWriter ุจูโุฏุฑุณุช &quot;utf-16&quot; ูโููุณุฏ ุชุง ุงุทูุงุนุงุช ูุงุฏุฑุณุช ุชููุฏ ูุดูุฏ.</p>
</blockquote>
<hr>
<h4>ูฺฉุชู ููู ุฏุฑุจุงุฑู ToString</h4>
<p>ุงฺฏุฑ ุจุฌุง Saveุ ุงุฒ ฺฉุฏ ุฒุฑ ุงุณุชูุงุฏู ฺฉูุฏ:</p>
<pre class="hljs"><code>File.WriteAllText(<span class="hljs-string">&quot;data.xml&quot;</span>, doc.ToString());
</code></pre>
<ul>
<li>ูุงู <strong>data.xml</strong> ุจุฏูู ุงุนูุงู XML ุฐุฎุฑู ูโุดูุฏ.</li>
<li>ุงฺฏุฑ ToString ุงุนูุงู ุชููุฏ ูโฺฉุฑุฏุ encoding ูุงุฏุฑุณุช (UTF-16) ุฏุฑุฌ ูโุดุฏ ฺฉู ููฺฉู ุจูุฏ ุจุงุนุซ ุนุฏู ุฎูุงูุฏู ุดุฏู ูุงู ุดูุฏ.</li>
</ul>
<hr>
<h3>ูุงูโูุง ู ูุถุง ูุงูโูุง (Names and Namespaces)</h3>
<ul>
<li>
<p>ููุงูโุทูุฑ ฺฉู ููุนโูุง ุฏุฑ .NET ูโุชูุงููุฏ namespace ุฏุงุดุชู ุจุงุดูุฏุ ุนูุงุตุฑ ู attributes ุฏุฑ XML ูุฒ ูโุชูุงููุฏ namespace ุฏุงุดุชู ุจุงุดูุฏ.</p>
</li>
<li>
<p><strong>ฺฉุงุฑุจุฑุฏ namespace ุฏุฑ XML:</strong></p>
<ol>
<li>ุฌููฺฏุฑ ุงุฒ ุจุฑุฎูุฑุฏ ูุงูโูุง ููฺฏุงู ุชุฑฺฉุจ ุฏุงุฏูโูุง ุงุฒ ูุงูโูุง ูุฎุชูู</li>
<li>ุฏุงุฏู ูุนูุง ุฏูู ุจู ฺฉ ูุงู</li>
</ol>
</li>
</ul>
<h4>ููููู ุชุนุฑู namespace ูพุดโูุฑุถ</h4>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">customer</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;OReilly.Nutshell.CSharp&quot;</span>/&gt;</span>
</code></pre>
<ul>
<li>
<p><code>xmlns</code> ูุงูุนุชุจุฑ ุงุณุช ู ุฏู ฺฉุงุฑ ุงูุฌุงู ูโุฏูุฏ:</p>
<ol>
<li>namespace ุนูุตุฑ ุฌุงุฑ ุฑุง ูุดุฎุต ูโฺฉูุฏ</li>
<li>namespace ูพุดโูุฑุถ ุจุฑุง ุชูุงู ุนูุงุตุฑ ูุฑุฒูุฏ ุชุนู ูโฺฉูุฏ</li>
</ol>
</li>
</ul>
<p>ูุซุงู ุจุง ุนูุงุตุฑ ูุฑุฒูุฏ:</p>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">customer</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;OReilly.Nutshell.CSharp&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">address</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">postcode</span>&gt;</span>02138<span class="hljs-tag">&lt;/<span class="hljs-name">postcode</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">address</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">customer</span>&gt;</span>
</code></pre>
<ul>
<li>ุนูุงุตุฑ <code>address</code> ู <code>postcode</code> ุจู ุทูุฑ ูพุดโูุฑุถ ุฏุฑ namespace <code>OReilly.Nutshell.CSharp</code> ูุฑุงุฑ ุฏุงุฑูุฏ.</li>
</ul>
<h4>ุญุฐู namespace ุจุฑุง ุนูุงุตุฑ ูุฑุฒูุฏ</h4>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">customer</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;OReilly.Nutshell.CSharp&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">address</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">postcode</span>&gt;</span>02138<span class="hljs-tag">&lt;/<span class="hljs-name">postcode</span>&gt;</span>  <span class="hljs-comment">&lt;!-- ุงฺฉููู postcode ุฏุฑ namespace ุฎุงู ุงุณุช --&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">address</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">customer</span>&gt;</span>
</code></pre>
<h3>ูพุดููุฏูุง (Prefixes)</h3>
<p>ฺฉ ุฏฺฏุฑ ุงุฒ ุฑูุดโูุง ุชุนู namespace ุงุณุชูุงุฏู ุงุฒ <strong>ูพุดููุฏ (prefix)</strong> ุงุณุช.</p>
<ul>
<li><strong>ูพุดููุฏ</strong> ฺฉ ูุงู ูุณุชุนุงุฑ ุจุฑุง namespace ุงุณุช ฺฉู ุจู ุดูุง ุงุฌุงุฒู ูโุฏูุฏ ฺฉูุชุฑ ุชุงูพ ฺฉูุฏ.</li>
<li>ุฏู ูุฑุญูู ุฏุงุฑุฏ: ุชุนุฑู ูพุดููุฏ ู ุงุณุชูุงุฏู ุงุฒ ุขู.</li>
</ul>
<h4>ุชุนุฑู ู ุงุณุชูุงุฏู ููุฒูุงู ุงุฒ ูพุดููุฏ</h4>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">nut:customer</span> <span class="hljs-attr">xmlns:nut</span>=<span class="hljs-string">&quot;OReilly.Nutshell.CSharp&quot;</span>/&gt;</span>
</code></pre>
<ul>
<li>ุณูุช ุฑุงุณุช: <code>xmlns:nut=&quot;...&quot;</code> โ ูพุดููุฏ <code>nut</code> ุฑุง ุชุนุฑู ูโฺฉูุฏ.</li>
<li>ุณูุช ฺูพ: <code>nut:customer</code> โ ูพุดููุฏ ุชุนุฑู ุดุฏู ุฑุง ุจู ุนูุตุฑ <code>customer</code> ูุณุจุช ูโุฏูุฏ.</li>
</ul>
<hr>
<h4>ูฺฉุชูโูุง ุฏุฑุจุงุฑู ูพุดููุฏูุง</h4>
<ul>
<li><strong>ุนูุตุฑ ุฏุงุฑุง ูพุดููุฏุ ูุถุง ูุงู ูพุดโูุฑุถ ุจุฑุง ูุฑุฒูุฏุงู ุงุฌุงุฏ ููโฺฉูุฏ.</strong></li>
<li>ุจุฑุง ุงูฺฉู ูุฑุฒูุฏ ูู ููุงู ูพุดููุฏ ุฑุง ุฏุงุดุชู ุจุงุดุฏุ ุจุงุฏ ุตุฑุงุญุชุงู ุงุฒ ุขู ุงุณุชูุงุฏู ฺฉูุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">nut:customer</span> <span class="hljs-attr">xmlns:nut</span>=<span class="hljs-string">&quot;OReilly.Nutshell.CSharp&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">nut:firstname</span>&gt;</span>Joe<span class="hljs-tag">&lt;/<span class="hljs-name">nut:firstname</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">nut:customer</span>&gt;</span>
</code></pre>
<ul>
<li>ูโุชูุงูุฏ ูพุดููุฏ ุชุนุฑู ฺฉูุฏ ุจุฏูู ุงูฺฉู ุขู ุฑุง ุจู ุนูุตุฑ ุฌุงุฑ ุงุฎุชุตุงุต ุฏูุฏุ ุจุฑุง ุฑุงุญุช ูุฑุฒูุฏุงู:</li>
</ul>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">customer</span> <span class="hljs-attr">xmlns:i</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
          <span class="hljs-attr">xmlns:z</span>=<span class="hljs-string">&quot;http://schemas.microsoft.com/2003/10/Serialization/&quot;</span>&gt;</span>
  ...
<span class="hljs-tag">&lt;/<span class="hljs-name">customer</span>&gt;</span>
</code></pre>
<ul>
<li>ูพุดููุฏูุง ูุฎุตูุตุงู ุฒูุงู ููุฏ ูุณุชูุฏ ฺฉู ุนูุงุตุฑ ุงุฒ ฺูุฏ namespace ุงุณุชูุงุฏู ฺฉููุฏ.</li>
<li><strong>ููุดู ุงุฒ URIูุง ูุนุชุจุฑ ุจุฑุง namespace ุงุณุชูุงุฏู ฺฉูุฏ</strong> ุชุง ฺฉุชุง ุจุงุดูุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">customer</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://oreilly.com/schemas/nutshell/csharp&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">nut:customer</span> <span class="hljs-attr">xmlns:nut</span>=<span class="hljs-string">&quot;http://oreilly.com/schemas/nutshell/csharp&quot;</span>/&gt;</span>
</code></pre>
<hr>
<h3>namespace ุจุฑุง Attributes</h3>
<ul>
<li>ฺฉ Attribute ููุดู ุจุฑุง ุฏุงุดุชู namespace ูุงุฒ ุจู <strong>ูพุดููุฏ</strong> ุฏุงุฑุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">customer</span> <span class="hljs-attr">xmlns:nut</span>=<span class="hljs-string">&quot;OReilly.Nutshell.CSharp&quot;</span> <span class="hljs-attr">nut:id</span>=<span class="hljs-string">&quot;123&quot;</span> /&gt;</span>
</code></pre>
<ul>
<li>Attribute ุจุฏูู ูพุดููุฏ ููุดู ุฏุฑ <strong>namespace ุฎุงู</strong> ุงุณุช ู ูุถุง ูุงู ูุงูุฏ ุฑุง ุจู ุงุฑุซ ููโุจุฑุฏ.</li>
<li>ูุนูููุงู Attributes ูุงุฒ ุจู namespace ูุฏุงุฑูุฏ ูฺฏุฑ ุจุฑุง metadata ุง ฺฉุงุฑุจุฑุฏ ุนููู:</li>
</ul>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">customer</span> <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">firstname</span>&gt;</span>Joe<span class="hljs-tag">&lt;/<span class="hljs-name">firstname</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">lastname</span> <span class="hljs-attr">xsi:nil</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">customer</span>&gt;</span>
</code></pre>
<hr>
<h3>ุชุนู namespace ุฏุฑ X-DOM</h3>
<ul>
<li>ุชุง ุจู ุญุงู ุงุฒ <strong>ุฑุดุชู ุณุงุฏู</strong> ุจุฑุง ูุงู XElement ู XAttribute ุงุณุชูุงุฏู ฺฉุฑุฏู ฺฉู ูุนุงุฏู <strong>namespace ุฎุงู</strong> ุงุณุช.</li>
<li>ุจุฑุง ุชุนู namespaceุ ุฏู ุฑูุด ุฏุงุฑู:</li>
</ul>
<ol>
<li><strong>ุงุณุชูุงุฏู ุงุฒ ุขฺฉููุงุฏ ุฏุฑ ูุงู ุฑุดุชูโุง:</strong></li>
</ol>
<pre class="hljs"><code><span class="hljs-keyword">var</span> e = <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;{http://domain.com/xmlspace}customer&quot;</span>, <span class="hljs-string">&quot;Bloggs&quot;</span>);
Console.WriteLine(e.ToString());
</code></pre>
<p>ุฎุฑูุฌ:</p>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">customer</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://domain.com/xmlspace&quot;</span>&gt;</span>Bloggs<span class="hljs-tag">&lt;/<span class="hljs-name">customer</span>&gt;</span>
</code></pre>
<ol start="2">
<li><strong>ุงุณุชูุงุฏู ุงุฒ XNamespace ู XName (ุฑูุด ุจูููโุชุฑ):</strong></li>
</ol>
<pre class="hljs"><code>XNamespace ns = <span class="hljs-string">&quot;http://domain.com/xmlspace&quot;</span>;
XName fullName = ns + <span class="hljs-string">&quot;customer&quot;</span>;

<span class="hljs-keyword">var</span> data = <span class="hljs-keyword">new</span> XElement(ns + <span class="hljs-string">&quot;data&quot;</span>,
              <span class="hljs-keyword">new</span> XAttribute(ns + <span class="hljs-string">&quot;id&quot;</span>, <span class="hljs-number">123</span>)
           );
</code></pre>
<ul>
<li>
<p><strong>XNamespace</strong> ู <strong>XName</strong> ฺฉูุงุณโูุง ูุณุชูุฏ ฺฉู namespace ู ูุงู ูุญู (local name) ุฑุง ูุฏุฑุช ูโฺฉููุฏ.</p>
</li>
<li>
<p>ููู ูุชุฏูุง ู ุณุงุฒูุฏูโูุง X-DOMุ XName ูโูพุฐุฑูุฏุ ูู ูโุชูุงู ุฑุดุชู ุณุงุฏู ูุฒ ุงุณุชูุงุฏู ฺฉุฑุฏ ุจู ุฏูู <strong>ุชุจุฏู ุถูู (implicit cast)</strong>.</p>
</li>
<li>
<p>ูุชุฌู ุงุณุชูุงุฏู ุงุฒ namespace ุฏุฑ ุนูุงุตุฑ ู attributes ฺฉุณุงู ุงุณุช ู ุชููุง ุจุง ุงุณุชูุงุฏู ุงุฒ <code>+</code> ุง ุขฺฉููุงุฏ ูุดุฎุต ูโุดูุฏ.</p>
</li>
</ul>
<h3>X-DOM ู ูุถุง ูุงู ูพุดโูุฑุถ (Default Namespaces)</h3>
<p>ุฏุฑ <strong>X-DOM</strong>ุ ููููู <strong>ูุถุง ูุงู ูพุดโูุฑุถ</strong> ุชุง ุฒูุงู <strong>ุชุจุฏู ุจู XML ูุงูุน</strong> ูุงุฏุฏู ฺฏุฑูุชู ูโุดูุฏ.</p>
<ul>
<li>ุนู ููุช ฺฉ ุนูุตุฑ ูุฑุฒูุฏ (XElement) ูโุณุงุฒุฏุ <strong>ูุถุง ูุงู ูุงูุฏ ุจู ุทูุฑ ุฎูุฏฺฉุงุฑ ุจู ุขู ููุชูู ููโุดูุฏ</strong>.</li>
<li>ุดูุง ุจุงุฏ <strong>explicit</strong> namespace ุฑุง ูุดุฎุต ฺฉูุฏ:</li>
</ul>
<pre class="hljs"><code>XNamespace ns = <span class="hljs-string">&quot;http://domain.com/xmlspace&quot;</span>;
<span class="hljs-keyword">var</span> data = <span class="hljs-keyword">new</span> XElement(ns + <span class="hljs-string">&quot;data&quot;</span>,
            <span class="hljs-keyword">new</span> XElement(ns + <span class="hljs-string">&quot;customer&quot;</span>, <span class="hljs-string">&quot;Bloggs&quot;</span>),
            <span class="hljs-keyword">new</span> XElement(ns + <span class="hljs-string">&quot;purchase&quot;</span>, <span class="hljs-string">&quot;Bicycle&quot;</span>)
          );
Console.WriteLine(data.ToString());
</code></pre>
<p><strong>ุฎุฑูุฌ:</strong></p>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">data</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://domain.com/xmlspace&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">customer</span>&gt;</span>Bloggs<span class="hljs-tag">&lt;/<span class="hljs-name">customer</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">purchase</span>&gt;</span>Bicycle<span class="hljs-tag">&lt;/<span class="hljs-name">purchase</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">data</span>&gt;</span>
</code></pre>
<ul>
<li>ุงฺฏุฑ ูุฑุฒูุฏุงู ุจุฏูู namespace ุณุงุฎุชู ุดููุฏุ ูุถุง ูุงู ุฎุงู (<code>xmlns=&quot;&quot;</code>) ุจู ุขูโูุง ุงุนูุงู ูโุดูุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">var</span> data2 = <span class="hljs-keyword">new</span> XElement(ns + <span class="hljs-string">&quot;data&quot;</span>,
            <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;customer&quot;</span>, <span class="hljs-string">&quot;Bloggs&quot;</span>),
            <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;purchase&quot;</span>, <span class="hljs-string">&quot;Bicycle&quot;</span>)
          );
Console.WriteLine(data2.ToString());
</code></pre>
<p>ุฎุฑูุฌ:</p>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">data</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://domain.com/xmlspace&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">customer</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span>Bloggs<span class="hljs-tag">&lt;/<span class="hljs-name">customer</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">purchase</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span>Bicycle<span class="hljs-tag">&lt;/<span class="hljs-name">purchase</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">data</span>&gt;</span>
</code></pre>
<hr>
<h3>ูุดุฏุงุฑ ุฏุฑ ูุงูุจุฑ X-DOM</h3>
<ul>
<li>ููฺฏุงู ุงุณุชูุงุฏู ุงุฒ <code>Element()</code> ุง ุณุงุฑ ูุชุฏูุง ุฌุณุชุฌูุ <strong>ูุฑุงููุด ฺฉุฑุฏู namespace ุจุงุนุซ ุจุงุฒฺฏุดุช null ูโุดูุฏ</strong>:</li>
</ul>
<pre class="hljs"><code>XNamespace ns = <span class="hljs-string">&quot;http://domain.com/xmlspace&quot;</span>;
<span class="hljs-keyword">var</span> data = <span class="hljs-keyword">new</span> XElement(ns + <span class="hljs-string">&quot;data&quot;</span>,
            <span class="hljs-keyword">new</span> XElement(ns + <span class="hljs-string">&quot;customer&quot;</span>, <span class="hljs-string">&quot;Bloggs&quot;</span>)
          );

XElement x = data.Element(ns + <span class="hljs-string">&quot;customer&quot;</span>); <span class="hljs-comment">// ุฏุฑุณุช</span>
XElement y = data.Element(<span class="hljs-string">&quot;customer&quot;</span>);      <span class="hljs-comment">// null</span>
</code></pre>
<ul>
<li>ุงฺฏุฑ X-DOM ุจุฏูู namespace ุณุงุฎุชู ุดุฏุ ูโุชูุงูุฏ ุจุนุฏุงู ููู ุนูุงุตุฑ ุฑุง ุจู ฺฉ namespace ูุงุญุฏ ุงุฎุชุตุงุต ุฏูุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">foreach</span> (XElement e <span class="hljs-keyword">in</span> data.DescendantsAndSelf())
  <span class="hljs-keyword">if</span> (e.Name.Namespace == <span class="hljs-string">&quot;&quot;</span>)
    e.Name = ns + e.Name.LocalName;
</code></pre>
<hr>
<h3>ูพุดููุฏูุง (Prefixes) ุฏุฑ X-DOM</h3>
<ul>
<li>X-DOM ูพุดููุฏูุง ุฑุง ููุท ุจุฑุง <strong>serialization</strong> ุงุณุชูุงุฏู ูโฺฉูุฏ.</li>
<li>ุฏุฑ ุนููุงุช ุณุงุฎุชุ ุฌุณุชุฌู ู ุจุฑูุฒุฑุณุงู X-DOM <strong>ูโุชูุงู ูพุดููุฏูุง ุฑุง ูุงุฏุฏู ฺฏุฑูุช</strong>.</li>
</ul>
<p>ูุซุงู:</p>
<pre class="hljs"><code>XNamespace ns1 = <span class="hljs-string">&quot;http://domain.com/space1&quot;</span>;
XNamespace ns2 = <span class="hljs-string">&quot;http://domain.com/space2&quot;</span>;
<span class="hljs-keyword">var</span> mix = <span class="hljs-keyword">new</span> XElement(ns1 + <span class="hljs-string">&quot;data&quot;</span>,
            <span class="hljs-keyword">new</span> XElement(ns2 + <span class="hljs-string">&quot;element&quot;</span>, <span class="hljs-string">&quot;value&quot;</span>),
            <span class="hljs-keyword">new</span> XElement(ns2 + <span class="hljs-string">&quot;element&quot;</span>, <span class="hljs-string">&quot;value&quot;</span>),
            <span class="hljs-keyword">new</span> XElement(ns2 + <span class="hljs-string">&quot;element&quot;</span>, <span class="hljs-string">&quot;value&quot;</span>)
          );
Console.WriteLine(mix.ToString());
</code></pre>
<p>ุฎุฑูุฌ ุจุฏูู ูพุดููุฏ:</p>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">data</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://domain.com/space1&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">element</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://domain.com/space2&quot;</span>&gt;</span>value<span class="hljs-tag">&lt;/<span class="hljs-name">element</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">element</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://domain.com/space2&quot;</span>&gt;</span>value<span class="hljs-tag">&lt;/<span class="hljs-name">element</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">element</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://domain.com/space2&quot;</span>&gt;</span>value<span class="hljs-tag">&lt;/<span class="hljs-name">element</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">data</span>&gt;</span>
</code></pre>
<ul>
<li>ุจุฑุง ฺฉุงูุด ุชฺฉุฑุงุฑุ ูโุชูุงู ูพุดููุฏูุง ุฑุง ุจู root ุงุถุงูู ฺฉุฑุฏ:</li>
</ul>
<pre class="hljs"><code>mix.SetAttributeValue(XNamespace.Xmlns + <span class="hljs-string">&quot;ns1&quot;</span>, ns1);
mix.SetAttributeValue(XNamespace.Xmlns + <span class="hljs-string">&quot;ns2&quot;</span>, ns2);
</code></pre>
<p>ุฎุฑูุฌ ุจููู:</p>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">ns1:data</span> <span class="hljs-attr">xmlns:ns1</span>=<span class="hljs-string">&quot;http://domain.com/space1&quot;</span>
          <span class="hljs-attr">xmlns:ns2</span>=<span class="hljs-string">&quot;http://domain.com/space2&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">ns2:element</span>&gt;</span>value<span class="hljs-tag">&lt;/<span class="hljs-name">ns2:element</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">ns2:element</span>&gt;</span>value<span class="hljs-tag">&lt;/<span class="hljs-name">ns2:element</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">ns2:element</span>&gt;</span>value<span class="hljs-tag">&lt;/<span class="hljs-name">ns2:element</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">ns1:data</span>&gt;</span>
</code></pre>
<hr>
<h3>ูพุดููุฏูุง ุจุฑุง Attributes</h3>
<ul>
<li>ูพุดููุฏูุง ุฏุฑ ุฒูุงู <strong>serializing attributes</strong> ูู ุงุนูุงู ูโุดููุฏ.</li>
<li>ูุซุงู ุงุณุชูุงุฏู ุงุฒ namespace ุงุณุชุงูุฏุงุฑุฏ W3C ุจุฑุง ูุดุงู ุฏุงุฏู nil:</li>
</ul>
<pre class="hljs"><code>XNamespace xsi = <span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>;
<span class="hljs-keyword">var</span> nil = <span class="hljs-keyword">new</span> XAttribute(xsi + <span class="hljs-string">&quot;nil&quot;</span>, <span class="hljs-literal">true</span>);

<span class="hljs-keyword">var</span> cust = <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;customers&quot;</span>,
              <span class="hljs-keyword">new</span> XAttribute(XNamespace.Xmlns + <span class="hljs-string">&quot;xsi&quot;</span>, xsi),
              <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;customer&quot;</span>,
                <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;lastname&quot;</span>, <span class="hljs-string">&quot;Bloggs&quot;</span>),
                <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;dob&quot;</span>, nil),
                <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;credit&quot;</span>, nil)
              )
            );
</code></pre>
<p>ุฎุฑูุฌ:</p>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">customers</span> <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">customer</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">lastname</span>&gt;</span>Bloggs<span class="hljs-tag">&lt;/<span class="hljs-name">lastname</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dob</span> <span class="hljs-attr">xsi:nil</span>=<span class="hljs-string">&quot;true&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">credit</span> <span class="hljs-attr">xsi:nil</span>=<span class="hljs-string">&quot;true&quot;</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">customer</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">customers</span>&gt;</span>
</code></pre>
<ul>
<li>ฺฉ attribute ูโุชูุงูุฏ ฺูุฏ ุจุงุฑ ุฏุฑ X-DOM ุงุณุชูุงุฏู ุดูุฏุ X-DOM ุจู ุทูุฑ ุฎูุฏฺฉุงุฑ ุขู ุฑุง duplicate ูโฺฉูุฏ.</li>
</ul>
<h3>Annotations ุฏุฑ LINQ to XML</h3>
<p>ุฏุฑ <strong>LINQ to XML</strong> ูโุชูุงูุฏ ุฏุงุฏูโูุง ุฏูุฎูุงู ุฎูุฏ ุฑุง ุจู ูุฑ <strong>XObject</strong> (ูุซู <code>XElement</code> ุง <code>XAttribute</code>) ุจฺุณุจุงูุฏ. ุงู ุฏุงุฏูโูุง ุจู ุนููุงู <strong>Annotations</strong> ุดูุงุฎุชู ูโุดููุฏ ู X-DOM ุขูโูุง ุฑุง <strong>ุจู ุตูุฑุช ฺฉ ุฌุนุจู ุณุงู (black box)</strong> ูุฏุฑุช ูโฺฉูุฏ.</p>
<ul>
<li>ููููู ูุดุงุจู <code>Tag</code> ุฏุฑ Windows Forms ุง WPFุ ุจุง ุงู ุชูุงูุช ฺฉู <strong>ฺูุฏู annotation</strong> ูโุชูุงูุฏ ุงุถุงูู ฺฉูุฏ ู ูุฑ ฺฉุฏุงู ูโุชูุงููุฏ <strong>ุฎุตูุต ู ุบุฑูุงุจู ูุดุงูุฏู ุชูุณุท ุฏฺฏุฑุงู</strong> ุจุงุดูุฏ.</li>
</ul>
<hr>
<h4>ุงุถุงูู ฺฉุฑุฏู ู ุญุฐู Annotations</h4>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">AddAnnotation</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> annotation</span>)
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">RemoveAnnotations</span>&lt;<span class="hljs-title">T</span>&gt;() <span class="hljs-keyword">where</span> T : <span class="hljs-keyword">class</span>
</span></code></pre>
<h4>ุจุงุฒุงุจ Annotations</h4>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">public</span> T <span class="hljs-title">Annotation</span>&lt;<span class="hljs-title">T</span>&gt;() <span class="hljs-keyword">where</span> T : <span class="hljs-keyword">class</span>
<span class="hljs-keyword">public</span> <span class="hljs-title">IEnumerable</span>&lt;<span class="hljs-title">T</span>&gt; <span class="hljs-title">Annotations</span>&lt;<span class="hljs-title">T</span>&gt;() <span class="hljs-keyword">where</span> T : <span class="hljs-keyword">class</span>
</span></code></pre>
<ul>
<li>ฺฉูุฏ ูุฑ annotation ููุน ุฏุงุฏูโุง ุขู ุงุณุช ู ุจุงุฏ <strong>Reference Type</strong> ุจุงุดุฏ.</li>
</ul>
<p><strong>ูุซุงู ุณุงุฏู ุจุง string:</strong></p>
<pre class="hljs"><code>XElement e = <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;test&quot;</span>);
e.AddAnnotation(<span class="hljs-string">&quot;Hello&quot;</span>);
Console.WriteLine(e.Annotation&lt;<span class="hljs-built_in">string</span>&gt;());   <span class="hljs-comment">// Hello</span>
</code></pre>
<ul>
<li>ูโุชูุงูุฏ ฺูุฏ annotation ุงุฒ ฺฉ ููุน ุงุถุงูู ฺฉูุฏ ู ุจุง <code>Annotations&lt;T&gt;()</code> ููู ุฑุง ุฏุฑุงูุช ฺฉูุฏ.</li>
</ul>
<hr>
<h4>ุงุณุชูุงุฏู ุงุฒ ฺฉูุงุณ ุฎุตูุต ุจุฑุง ุงูู</h4>
<p>ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุชุฏุงุฎู ุฏฺฏุฑ ฺฉุฏูุง:</p>
<pre class="hljs"><code><span class="hljs-keyword">class</span> <span class="hljs-title">X</span>
{
    <span class="hljs-keyword">class</span> <span class="hljs-title">CustomData</span> { <span class="hljs-keyword">internal</span> <span class="hljs-built_in">string</span> Message; }   <span class="hljs-comment">// Private nested type</span>

    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Test</span>()</span>
    {
        XElement e = <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;test&quot;</span>);
        e.AddAnnotation(<span class="hljs-keyword">new</span> CustomData { Message = <span class="hljs-string">&quot;Hello&quot;</span> });
        Console.WriteLine(e.Annotations&lt;CustomData&gt;().First().Message);  <span class="hljs-comment">// Hello</span>
    }
}
</code></pre>
<ul>
<li>ุจุฑุง ุญุฐู annotationุ ุจุงุฏ ุจู ููุน ุขู ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดุฏ:</li>
</ul>
<pre class="hljs"><code>e.RemoveAnnotations&lt;CustomData&gt;();
</code></pre>
<hr>
<h3>Projection ุจู X-DOM ุจุง LINQ</h3>
<ul>
<li>
<p>ุนูุงูู ุจุฑ <strong>ุงุณุชุฎุฑุงุฌ ุฏุงุฏู</strong>ุ ูโุชูุงูุฏ ุจุง LINQ <strong>ุฏุงุฏูโูุง ุฑุง ุจู X-DOM ุชุจุฏู ฺฉูุฏ</strong>.</p>
</li>
<li>
<p>ููุงุจุน (sources) ูโุชูุงููุฏ:</p>
<ul>
<li>EF Core entities</li>
<li>ฺฉ Collection ูุญู</li>
<li>ุง ุญุช ฺฉ X-DOM ุฏฺฏุฑ ุจุงุดูุฏ</li>
</ul>
</li>
</ul>
<h4>ูุซุงู: ุณุงุฎุช XML ุงุฒ ูพุงฺฏุงู ุฏุงุฏู</h4>
<pre class="hljs"><code><span class="hljs-keyword">var</span> customers =
  <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;customers&quot;</span>,
    <span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> dbContext.Customers.AsEnumerable()  <span class="hljs-comment">// ุชูุฌู ุจู AsEnumerable ุจู ุฏูู bug ุฏุฑ EF Core</span>
    <span class="hljs-function"><span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> <span class="hljs-title">XElement</span>(<span class="hljs-params"><span class="hljs-string">&quot;customer&quot;</span>, <span class="hljs-keyword">new</span> XAttribute(<span class="hljs-string">&quot;id&quot;</span>, c.ID</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title">XElement</span>(<span class="hljs-params"><span class="hljs-string">&quot;name&quot;</span>, c.Name</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title">XElement</span>(<span class="hljs-params"><span class="hljs-string">&quot;buys&quot;</span>, c.Purchases.Count</span>)
    )
  )</span>;
</code></pre>
<p><strong>ุฎุฑูุฌ ููููู:</strong></p>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">customers</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">customer</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;1&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>Tom<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">buys</span>&gt;</span>3<span class="hljs-tag">&lt;/<span class="hljs-name">buys</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">customer</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">customer</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;2&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>Harry<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">buys</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">buys</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">customer</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">customers</span>&gt;</span>
</code></pre>
<h4>ุชูุถุญ ุฏู ูุฑุญููโุง</h4>
<ol>
<li>ุงุจุชุฏุง projection ุจู <code>XElement</code>:</li>
</ol>
<pre class="hljs"><code>IEnumerable&lt;XElement&gt; sqlQuery =
  <span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> dbContext.Customers.AsEnumerable()
  <span class="hljs-function"><span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> <span class="hljs-title">XElement</span>(<span class="hljs-params"><span class="hljs-string">&quot;customer&quot;</span>, <span class="hljs-keyword">new</span> XAttribute(<span class="hljs-string">&quot;id&quot;</span>, c.ID</span>),
      <span class="hljs-keyword">new</span> <span class="hljs-title">XElement</span>(<span class="hljs-params"><span class="hljs-string">&quot;name&quot;</span>, c.Name</span>),
      <span class="hljs-keyword">new</span> <span class="hljs-title">XElement</span>(<span class="hljs-params"><span class="hljs-string">&quot;buys&quot;</span>, c.Purchases.Count</span>)
  )</span>;
</code></pre>
<ol start="2">
<li>ุณูพุณ ุฑุดู ุฑุง ูโุณุงุฒู:</li>
</ol>
<pre class="hljs"><code><span class="hljs-keyword">var</span> customers = <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;customers&quot;</span>, sqlQuery);
</code></pre>
<ul>
<li><code>sqlQuery</code> ฺฉ <code>IEnumerable&lt;XElement&gt;</code> ุงุณุชุ ุจูุงุจุฑุงู ูุฑ ุนูุตุฑ ุจู ุทูุฑ ุฎูุฏฺฉุงุฑ ุจู ุนููุงู child ุงุถุงูู ูโุดูุฏ.</li>
</ul>
<hr>
<p>ุงู ูุงุจูุช ุจุงุนุซ ูโุดูุฏ ฺฉู <strong>LINQ ุจู X-DOM</strong> ูู <strong>ุฎูุงูุฏู</strong> ู ูู <strong>ุณุงุฎุชู XML</strong> ุจู ุตูุฑุช ฺฉุงููุงู ุชุงุจุน ู ุงูุนุทุงูโูพุฐุฑ ุงูฺฉุงูโูพุฐุฑ ุจุงุดุฏ.</p>
<h3>ุญุฐู ุนูุงุตุฑ ุฎุงู ู ุงุณุชูุงุฏู ุงุฒ XStreamingElement ุฏุฑ LINQ to XML</h3>
<h4>1๏ธโฃ ุญุฐู ุนูุงุตุฑ ุฎุงู</h4>
<p>ฺฏุงู ุฏุฑ <strong>ูพุฑูฺู ฺฉุฑุฏู ุฏุงุฏูโูุง ุจู X-DOM</strong>ุ ูโุฎูุงูู <strong>ุนูุงุตุฑ ฺฉู ููุฏุงุฑ ูุฏุงุฑูุฏ</strong> ุง ุฏุงุฏูโุง ุจุฑุง ุขูโูุง ููุฌูุฏ ูุณุชุ ุชููุฏ ูุดููุฏ.</p>
<p>ูุซุงู: ุงุถุงูู ฺฉุฑุฏู ุขุฎุฑู ุฎุฑุฏ ุจุง ุงุฑุฒุด ุจุงูุง ุจุฑุง ูุฑ ูุดุชุฑ</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> customers =
  <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;customers&quot;</span>,
    <span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> dbContext.Customers.AsEnumerable()
    <span class="hljs-keyword">let</span> lastBigBuy = (<span class="hljs-keyword">from</span> p <span class="hljs-keyword">in</span> c.Purchases
                      <span class="hljs-keyword">where</span> p.Price &gt; <span class="hljs-number">1000</span>
                      <span class="hljs-keyword">orderby</span> p.Date <span class="hljs-keyword">descending</span>
                      <span class="hljs-keyword">select</span> p).FirstOrDefault()
    <span class="hljs-function"><span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> <span class="hljs-title">XElement</span>(<span class="hljs-params"><span class="hljs-string">&quot;customer&quot;</span>, <span class="hljs-keyword">new</span> XAttribute(<span class="hljs-string">&quot;id&quot;</span>, c.ID</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title">XElement</span>(<span class="hljs-params"><span class="hljs-string">&quot;name&quot;</span>, c.Name</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title">XElement</span>(<span class="hljs-params"><span class="hljs-string">&quot;buys&quot;</span>, c.Purchases.Count</span>),
        lastBigBuy</span> == <span class="hljs-literal">null</span> ? <span class="hljs-literal">null</span> :                     <span class="hljs-comment">// โ ุดุฑุท ุญุฐู ุนูุตุฑ ุฎุงู</span>
        <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;lastBigBuy&quot;</span>,
            <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;description&quot;</span>, lastBigBuy.Description),
            <span class="hljs-keyword">new</span> XElement(<span class="hljs-string">&quot;price&quot;</span>, lastBigBuy.Price)
        )
    )
  );
</code></pre>
<ul>
<li>ุงฺฏุฑ ูุดุชุฑ <strong>ุฎุฑุฏ ุจุง ุงุฑุฒุด ุจุงูุง ูุฏุงุดุชู ุจุงุดุฏ</strong>ุ ุจู ุฌุง ุชููุฏ ฺฉ <code>XElement</code> ุฎุงูุ <strong>null</strong> ูุฑุงุฑ ุฏุงุฏู ูโุดูุฏ.</li>
<li>X-DOM ููฺฏุงู ุณุงุฎุชู XMLุ ูุญุชูุง <strong>null ุฑุง ูุงุฏุฏู ูโฺฏุฑุฏ</strong> ู ุนูุตุฑ ุชููุฏ ููโุดูุฏ. โ</li>
</ul>
<hr>
<h4>2๏ธโฃ ุงูุฒุงุด ฺฉุงุฑุง ุจุง XStreamingElement</h4>
<ul>
<li>
<p>ุงฺฏุฑ ูุฏู ููุท <strong>ุฐุฎุฑู ุง ููุงุด XML</strong> ุจุงุดุฏุ ูโุชูุงู ุงุฒ <strong>XStreamingElement</strong> ุงุณุชูุงุฏู ฺฉุฑุฏ ุชุง ุญุงูุธู ุจูุชุฑ ูุฏุฑุช ุดูุฏ.</p>
</li>
<li>
<p><strong>XStreamingElement</strong> ุดุจู XElement ุงุณุช ุงูุง:</p>
<ul>
<li>ูุญุชูุง child ุฑุง <strong>ุชูุจู (deferred)</strong> ุจุงุฑฺฏุฐุงุฑ ูโฺฉูุฏ.</li>
<li>ุฑูุดโูุง traversal ูุซู <code>Elements()</code> ุง <code>Attributes()</code> ูุฏุงุฑุฏ.</li>
<li>ููุท ูโุชูุงู <code>Save</code>, <code>ToString</code>, <code>WriteTo</code> ุง <code>Add</code> ุฑุง ุฑู ุขู ุงุณุชูุงุฏู ฺฉุฑุฏ.</li>
</ul>
</li>
</ul>
<p>ูุซุงู:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> customers =
  <span class="hljs-keyword">new</span> XStreamingElement(<span class="hljs-string">&quot;customers&quot;</span>,
    <span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> dbContext.<span class="hljs-function">Customers
    <span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> <span class="hljs-title">XStreamingElement</span>(<span class="hljs-params"><span class="hljs-string">&quot;customer&quot;</span>, <span class="hljs-keyword">new</span> XAttribute(<span class="hljs-string">&quot;id&quot;</span>, c.ID</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title">XElement</span>(<span class="hljs-params"><span class="hljs-string">&quot;name&quot;</span>, c.Name</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title">XElement</span>(<span class="hljs-params"><span class="hljs-string">&quot;buys&quot;</span>, c.Purchases.Count</span>)
    )
  )</span>;

customers.Save(<span class="hljs-string">&quot;data.xml&quot;</span>);
</code></pre>
<ul>
<li>ูพุฑุณโูุฌููุง <strong>ุชุง ุฒูุงู ูุฑุงุฎูุงู Save ุง ToString</strong> ุงุฑุฒุงุจ ููโุดููุฏุ ุจูุงุจุฑุงู ฺฉู X-DOM ุจู ุญุงูุธู ุจุงุฑฺฏุฐุงุฑ ููโุดูุฏ.</li>
<li>ุชูุฌู: XStreamingElement ูุงุจูุช ูพูุงุด ูุฏุงุฑุฏ ู ููุท ุจุฑุง <strong>ุชููุฏ ุฎุฑูุฌ XML</strong> ููุงุณุจ ุงุณุช.</li>
</ul>

  </main>

  <!-- ููุชุฑ ูุดุชุฑฺฉ -->
  <footer class="footer">
    <div class="container">
      <p>
        <img src="/Gitab/icone/copyright.svg" alt="ฺฉูพโุฑุงุช" width="14" height="14"
             style="vertical-align:middle;margin-inline:4px">
        <span id="y"></span> Gitab โ ุจุฑุง ุชูุณุนูโุฏููุฏฺฏุงู
      </p>
    </div>
  </footer>

  <!-- ุณุงู ู ุงุณฺฉุฑูพุช ุชุบุฑ ุชู -->
  <script>
  (() => {
    const root = document.documentElement;
    const btn = document.getElementById('themeToggle');
    const KEY = 'gitab-theme';
    const media = window.matchMedia('(prefers-color-scheme: dark)');
    const getEffective = s => (s === 'auto' ? (media.matches ? 'dark' : 'light') : s);

    function updateTheme(s) {
      root.setAttribute('data-theme', s);
      const mode = getEffective(s);
      root.dataset.colorMode = mode;
      btn.dataset.icon = mode === 'dark' ? 'moon' : 'sun';
    }

    let saved = localStorage.getItem(KEY) || 'auto';
    updateTheme(saved);

    btn.addEventListener('click', () => {
      const current = localStorage.getItem(KEY) || 'auto';
      const next = current === 'auto' ? 'dark' : current === 'dark' ? 'light' : 'auto';
      localStorage.setItem(KEY, next);
      updateTheme(next);
    });

    media.addEventListener('change', () => {
      if ((localStorage.getItem(KEY) || 'auto') === 'auto') updateTheme('auto');
    });

    document.addEventListener('DOMContentLoaded', () => {
      updateTheme(localStorage.getItem(KEY) || 'auto');
    });
  })();
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>

  <script>
  document.querySelectorAll('pre code').forEach(block => {
    const btn = document.createElement('button');
    btn.className = 'copy-btn';

    const icon = document.createElement('img');
    icon.src = "/Gitab/icone/copy.svg";
    icon.alt = 'Copy';
    btn.appendChild(icon);

    block.parentNode.insertBefore(btn, block);

    btn.addEventListener('click', async () => {
      await navigator.clipboard.writeText(block.textContent);
      btn.classList.add('copied');
      setTimeout(() => btn.classList.remove('copied'), 1500);
    });
  });
  </script>

  <script>
  document.body.dataset.page = window.location.pathname;

  const menuBtn = document.querySelector(".menu-toggle");
  const nav = document.querySelector(".nav");

  if (menuBtn && nav) {
    menuBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      nav.classList.toggle("show");
    });

    document.addEventListener("click", (e) => {
      const clickedInsideNav = nav.contains(e.target);
      const clickedMenuButton = menuBtn.contains(e.target);
      if (!clickedInsideNav && !clickedMenuButton) {
        nav.classList.remove("show");
      }
    });
  }
  </script>

  <script>
    document.getElementById('y').textContent = new Date().getFullYear();
  </script>
  <script>
document.getElementById("openDonate").addEventListener("click", () => {
  document.getElementById("donateModal").style.display = "block";
});
document.getElementById("closeDonate").addEventListener("click", () => {
  document.getElementById("donateModal").style.display = "none";
});
document.querySelectorAll(".copy-btn").forEach(btn => {
  btn.addEventListener("click", () => {
    navigator.clipboard.writeText(btn.dataset.copy);
    btn.textContent = "โ ฺฉูพ ุดุฏ!";
    setTimeout(() => (btn.textContent = "ฺฉูพ"), 2000);
  });
});
</script>

</body>
</html>
