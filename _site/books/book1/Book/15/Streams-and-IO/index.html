

<!doctype html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8">
  <link rel="icon" type="image/png" href="/Gitab/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ุงุณุชุฑูโูุง ู ูุฑูุฏ/ุฎุฑูุฌ (Streams and I/O)</title>
  <meta name="description" content="ุชุฑุฌููโูุง ูุงุฑุณ ฺฉุชุงุจโูุง ูู โ ุณุฑุนุ ูููุงู ู ูุงุจู ุงุชฺฉุง.">

  <!-- ุงุณุชุงูโูุง -->
  <link rel="stylesheet" href="/Gitab/styles/main.css">
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">

  <style>
  @font-face {
    font-family: 'Vazir';
    src: url('/Gitab/fonts/Vazir-FD-WOL.ttf') format('truetype');
    font-display: swap;
  }
  body {
    font-family: 'Vazir', sans-serif;
  }
  </style>
</head>

<body>
  <!-- ูุฏุฑ ูุดุชุฑฺฉ -->
  <header class="header">
    <div class="container nav-wrap">
      <a href="/Gitab/" class="brand">
        <img src="/Gitab/icone/logo.svg" alt="Gitab logo" width="26" height="26">
        <span>Gitab</span>
      </a>

      <nav class="nav">
        <a href="/Gitab/" aria-current="page">ุฎุงูู</a>
        <a href="/Gitab/books/list-books">ฺฉุชุงุจโูุง</a>
       <a href="/Gitab/translator.html">ูุชุฑุฌูู</a>
        <a href="/Gitab/giter.html">ฺฏุชุฑ</a>
      </nav>

      <div class="nav-actions">
        <button id="themeToggle" class="icon-btn theme-btn" data-icon="moon" aria-label="ุชุบุฑ ุชู">
          <img src="/Gitab/icone/sun.svg" class="icon-sun" alt="ุฑูุดู">
          <img src="/Gitab/icone/moon.svg" class="icon-moon" alt="ุชุงุฑฺฉ">
        </button>

        <a class="icon-btn" href="https://github.com/hheydarian/Gitab" target="_blank" title="GitHub">
          <img src="/Gitab/icone/github.svg" alt="GitHub">
        </a>

        <!-- ุฏฺฉูู ููู ุจุฑุง ููุจุงู -->
        <button class="menu-toggle" aria-label="ููู">
          <img src="/Gitab/icone/menu.svg" alt="menu">
        </button>
      </div>
    </div>
  </header>

  
  <main class="site-main book-page">
    <h1>ูุตู ูพุงูุฒุฏูู:  ุงุณุชุฑูโูุง ู ูุฑูุฏ/ุฎุฑูุฌ (Streams and I/O)</h1>
<p>ุงู ูุตูุ ุงููุงุน ุจูุงุฏ ุจุฑุง <strong>ูุฑูุฏ (Input)</strong> ู <strong>ุฎุฑูุฌ (Output)</strong> ุฏุฑ .NET ุฑุง ุชูุถุญ ูโุฏูุฏุ ุจุง ุชูุฑฺฉุฒ ูฺู ุฑู ููุถูุนุงุช ุฒุฑ:</p>
<ul>
<li>ูุนูุงุฑ <strong>Stream</strong> ุฏุฑ .NET ู ุงูโฺฉู ฺุทูุฑ ฺฉ ุฑุงุจุท ุจุฑูุงููโููุณ (Programming Interface) ฺฉูพุงุฑฺู ุจุฑุง <strong>ุฎูุงูุฏู</strong> ู <strong>ููุดุชู</strong> ุฑู ุงููุงุน ูุฎุชูู I/O ูุฑุงูู ูโฺฉูุฏ.</li>
<li>ฺฉูุงุณโูุง ุจุฑุง ฺฉุงุฑ ุจุง <strong>ูุงูโูุง</strong> ู <strong>ุฏุงุฑฺฉุชูุฑโูุง</strong> ุฑู ุฏุณฺฉ.</li>
<li>ุงุณุชุฑูโูุง ุชุฎุตุต ุจุฑุง <strong>ูุดุฑุฏูโุณุงุฒ (Compression)</strong>ุ <strong>Named Pipes</strong>ุ ู <strong>Memory-Mapped Files</strong>.</li>
</ul>
<p>ุงู ูุตู ุจุดุชุฑ ุฑู ููุนโูุง ุฏุฑ ูุถุง ูุงู <code>System.IO</code> ุชูุฑฺฉุฒ ุฏุงุฑุฏุ ุฌุง ฺฉู ูุงุจูุชโูุง ุณุทุญ ูพุงู I/O ูุฑุงุฑ ฺฏุฑูุชูโุงูุฏ.</p>
<hr>
<h2>๐๏ธ ูุนูุงุฑ Stream</h2>
<p>ูุนูุงุฑ Stream ุฏุฑ .NET ุญูู ุณู ููููู ุงุตู ูโฺุฑุฎุฏ:</p>
<ul>
<li><strong>Backing Stores</strong></li>
<li><strong>Decorators</strong></li>
<li><strong>Adapters</strong></li>
</ul>
<p>ููุงูโุทูุฑ ฺฉู ุฏุฑ ุดฺฉู 15-1 ูุดุงู ุฏุงุฏู ุดุฏู ุงุณุช.</p>
<p><strong>Backing Store</strong> ููุงู ููุทู ุงูุชูุง ุงุณุช ฺฉู ูุฑูุฏ ู ุฎุฑูุฌ ุฑุง ฺฉุงุฑุจุฑุฏ ูโฺฉูุฏุ ูุซู ฺฉ ูุงู ุง ุงุชุตุงู ุดุจฺฉู. ุจูโุทูุฑ ุฏููโุชุฑุ Backing Store ูโุชูุงูุฏ ฺฉ ุง ูุฑ ุฏู ููุงุฑุฏ ุฒุฑ ุจุงุดุฏ:</p>
<ul>
<li>ฺฉ ููุจุน (Source) ฺฉู ุจุงุชโูุง ูโุชูุงููุฏ ุจูโุตูุฑุช ุชุฑุชุจ (Sequential) ุงุฒ ุขู ุฎูุงูุฏู ุดููุฏ.</li>
<li>ฺฉ ููุตุฏ (Destination) ฺฉู ุจุงุชโูุง ูโุชูุงููุฏ ุจูโุตูุฑุช ุชุฑุชุจ ุฏุฑ ุขู ููุดุชู ุดููุฏ.</li>
</ul>
<div align="center">
<p><img src="../../../assets/image/15/Table-15-1.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>๐ Backing Store</h3>
<p>ฺฉ <strong>Backing Store</strong> ุจูโุชููุง ูฺ ฺฉุงุฑุจุฑุฏ ุจุฑุง ุจุฑูุงููโููุณ ูุฏุงุฑุฏุ ูฺฏุฑ ุงูโฺฉู ุฏุฑ ูุนุฑุถ ุงุณุชูุงุฏู ูุฑุงุฑ ฺฏุฑุฏ. ฺฉูุงุณ ุงุณุชุงูุฏุงุฑุฏ .NET ุจุฑุง ุงู ููุธูุฑุ <strong>Stream</strong> ุงุณุช. ุงู ฺฉูุงุณ ูุฌููุนูโุง ุงุณุชุงูุฏุงุฑุฏ ุงุฒ ูุชุฏูุง ุฑุง ุจุฑุง <strong>ุฎูุงูุฏู (Reading)</strong>ุ <strong>ููุดุชู (Writing)</strong> ู <strong>ูฺฉุงูโุงุจ (Positioning)</strong> ุฏุฑ ุงุฎุชุงุฑ ูุฑุงุฑ ูโุฏูุฏ.</p>
<p>ุจุฑุฎูุงู <strong>ุขุฑุงู (Array)</strong> ฺฉู ููู ุฏุงุฏูโูุง ูพุดุชุจุงู ุขู ุจูโุทูุฑ ููโุฒูุงู ุฏุฑ ุญุงูุธู ูุฑุงุฑ ุฏุงุฑูุฏุ <strong>Stream</strong> ุฏุงุฏูโูุง ุฑุง ุจูโุตูุฑุช <strong>ุณุฑุงู (Serially)</strong> ูุฏุฑุช ูโฺฉูุฏโุง ฺฉ ุจุงุช ุฏุฑ ูุฑ ุจุงุฑุ ุง ุฏุฑ ุจููฺฉโูุง ุจุง ุงูุฏุงุฒู ูุงุจู ูุฏุฑุช. ุจู ููู ุฏููุ ฺฉ Stream ูโุชูุงูุฏ ุจุฏูู ุชูุฌู ุจู ุงูุฏุงุฒู Backing Storeุ ููุท ุงุฒ ููุฏุงุฑ ฺฉู ุญุงูุธู ุซุงุจุช ุงุณุชูุงุฏู ฺฉูุฏ.</p>
<hr>
<h3>๐๏ธ ุฏุณุชูโุจูุฏ Streamูุง</h3>
<p>ุงุณุชุฑูโูุง ุจู ุฏู ุฏุณุชู ุชูุณู ูโุดููุฏ:</p>
<ol>
<li>
<p><strong>Backing Store Streams</strong><br>
ุงู ุงุณุชุฑูโูุง ุจู ฺฉ ููุน ุฎุงุต ุงุฒ Backing Store ูุชุตู ูุณุชูุฏุ ูุซู <code>FileStream</code> ุง <code>NetworkStream</code>.</p>
</li>
<li>
<p><strong>Decorator Streams</strong><br>
ุงู ุงุณุชุฑูโูุง ุฑู ฺฉ ุงุณุชุฑู ุฏฺฏุฑ ุณูุงุฑ ูโุดููุฏ ู ุฏุงุฏูโูุง ุฑุง ุจู ููุน ุชุบุฑ ูโุฏููุฏุ ูุซู <code>DeflateStream</code> ุง <code>CryptoStream</code>.</p>
</li>
</ol>
<hr>
<h3>๐ ูุฒุงุง ูุนูุงุฑ Decorator Streams</h3>
<ul>
<li>ุขูโูุง ุงุณุชุฑูโูุง Backing Store ุฑุง ุงุฒ ูุงุฒ ุจู ูพุงุฏูโุณุงุฒ ูฺฺฏโูุง ูุซู <strong>ูุดุฑุฏูโุณุงุฒ (Compression)</strong> ู <strong>ุฑูุฒูฺฏุงุฑ (Encryption)</strong> ุขุฒุงุฏ ูโฺฉููุฏ.</li>
<li>ููุช ฺฉ ุงุณุชุฑู ุจุง Decorator ูพูุดุงูุฏู ูโุดูุฏุ <strong>ุฑุงุจุท (Interface)</strong> ุขู ุชุบุฑ ููโฺฉูุฏ.</li>
<li>ุดูุง ูโุชูุงูุฏ Decoratorูุง ุฑุง <strong>ุฏุฑ ุฒูุงู ุงุฌุฑุง (Runtime)</strong> ูุชุตู ฺฉูุฏ.</li>
<li>ูโุชูุงู ฺูุฏ Decorator ุฑุง ุจู ูู ุฒูุฌุฑ ฺฉุฑุฏ (ูุซูุงู ฺฉ <strong>ูุดุฑุฏูโุณุงุฒ</strong> ู ุณูพุณ ฺฉ <strong>ุฑูุฒูฺฏุงุฑ</strong>).</li>
</ul>
<hr>
<h3>๐ ููุด Adapter</h3>
<p>ูุฑ ุฏู ููุน ุงุณุชุฑู (Backing Store ู Decorator) ุตุฑูุงู ุจุง <strong>ุจุงุชโูุง</strong> ฺฉุงุฑ ูโฺฉููุฏ. ฺฏุฑฺู ุงู ุฑูฺฉุฑุฏ ุงูุนุทุงูโูพุฐุฑ ู ฺฉุงุฑุขูุฏ ุงุณุชุ ูู ุจุณุงุฑ ุงุฒ ุจุฑูุงููโูุง ุฏุฑ ุณุทูุญ ุจุงูุงุชุฑ ฺฉุงุฑ ูโฺฉููุฏโูุซู <strong>ูุชู (Text)</strong> ุง <strong>XML</strong>.</p>
<p>ุงูุฌุง ุงุณุช ฺฉู <strong>Adapter</strong> ูุงุฑุฏ ุนูู ูโุดูุฏ. Adapter ุจุง <strong>ูพูุดุงูุฏู (Wrapping)</strong> ฺฉ ุงุณุชุฑูุ ูุชุฏูุง ุชุฎุตุต ุจุฑุง ฺฉ ูุฑูุช ุฎุงุต ุงุฑุงุฆู ูโุฏูุฏ.</p>
<ul>
<li>ฺฉ <strong>TextReader</strong> ูุชุฏ ุจู ูุงู <code>ReadLine</code> ุฏุงุฑุฏ.</li>
<li>ฺฉ <strong>XmlWriter</strong> ูุชุฏ ุจู ูุงู <code>WriteAttributes</code> ุฏุงุฑุฏ.</li>
</ul>
<p>Adapter ุฏุฑุณุช ูุซู ฺฉ Decoratorุ ฺฉ ุงุณุชุฑู ุฑุง ูโูพูุดุงูุฏ. ุงูุง ุจุฑ ุฎูุงู Decoratorุ ุฎูุฏ ฺฉ ุงุณุชุฑู ูุณุช ู ูุนูููุงู ูุชุฏูุง <strong>ุจุงุชโูุญูุฑ</strong> ุฑุง ุจูโุทูุฑ ฺฉุงูู ูพููุงู ูโฺฉูุฏ.</p>
<hr>
<h3>๐ ุฎูุงุตู</h3>
<ul>
<li><strong>Backing Store Streams</strong> ุฏุงุฏู ุฎุงู ุฑุง ูุฑุงูู ูโฺฉููุฏ.</li>
<li><strong>Decorator Streams</strong> ุชุบุฑุงุช ุจุงูุฑ ุดูุงู ูุซู ุฑูุฒูฺฏุงุฑ ุงุฑุงุฆู ูโุฏููุฏ.</li>
<li><strong>Adapters</strong> ูุชุฏูุง ุณุทุญ ุจุงูุงุชุฑ ุจุฑุง ฺฉุงุฑ ุจุง ุงููุงุน ูุซู ุฑุดุชูโูุง (Strings) ู XML ูุฑุงูู ูโฺฉููุฏ.</li>
</ul>
<p>๐ ุดฺฉู 15-1 ุงุฑุชุจุงุท ูุงู ุงู ุงุฌุฒุงุก ุฑุง ูุดุงู ูโุฏูุฏ. ุจุฑุง ุณุงุฎุช ฺฉ ุฒูุฌุฑูุ ฺฉุงู ุงุณุช ฺฉ ุดุก ุฑุง ุจู ุณุงุฒูุฏู (Constructor) ุดุก ุฏฺฏุฑ ุจุฏูุฏ.</p>
<hr>
<h2>โ๏ธ ุงุณุชูุงุฏู ุงุฒ Streams</h2>
<p>ฺฉูุงุณ <strong>Stream</strong> ฺฉ ฺฉูุงุณ <strong>Abstract</strong> ุงุณุช ฺฉู ูพุงูโุง ุจุฑุง ุชูุงู ุงุณุชุฑูโูุง ูุญุณูุจ ูโุดูุฏ. ุงู ฺฉูุงุณ ูุชุฏูุง ู ูฺฺฏโูุง ุจุฑุง ุณู ุนููุงุช ุจูุงุฏ ุชุนุฑู ูโฺฉูุฏ:</p>
<ul>
<li><strong>ุฎูุงูุฏู (Reading)</strong></li>
<li><strong>ููุดุชู (Writing)</strong></li>
<li><strong>ุฌุณุชุฌู ุง ูฺฉุงูโุงุจ (Seeking)</strong></li>
</ul>
<p>ุจูโุนูุงููุ ุจุฑุง ฺฉุงุฑูุง ูุฏุฑุช ูุซู:</p>
<ul>
<li><strong>ุจุณุชู (Closing)</strong></li>
<li><strong>ุชุฎูู ุง Flush ฺฉุฑุฏู</strong></li>
<li><strong>ูพฺฉุฑุจูุฏ Timeoutูุง</strong></li>
</ul>
<p>ูุฒ ูุชุฏูุง ู ูฺฺฏโูุง ุฏุฑ ุงุฎุชุงุฑ ูุฑุงุฑ ูโุฏูุฏ (ุฌุฏูู 15-1 ุฑุง ุจุจูุฏ).</p>
<div align="center">
<p><img src="../../../assets/image/15/Table-15-2.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>โก ูุณุฎูโูุง Asynchronous</h3>
<p>ูุชุฏูุง <strong>Read</strong> ู <strong>Write</strong> ูุณุฎูโูุง <strong>Asynchronous</strong> ูู ุฏุงุฑูุฏ ฺฉู ููุฏุงุฑ <strong>Task</strong> ุจุฑูโฺฏุฑุฏุงููุฏ ู ุจูโุตูุฑุช ุงุฎุชุงุฑ ฺฉ <strong>CancellationToken</strong> ูโูพุฐุฑูุฏ. ููฺูู ูุณุฎูโูุง Overload ุจุฑุง ฺฉุงุฑ ุจุง ููุนโูุง <code>Span&lt;T&gt;</code> ู <code>Memory&lt;T&gt;</code> (ฺฉู ุฏุฑ ูุตู ฒณ ุชูุถุญ ุฏุงุฏู ูโุดููุฏ) ูุฌูุฏ ุฏุงุฑุฏ.</p>
<hr>
<h3>๐ ููููู ฺฉุฏ: ุฎูุงูุฏูุ ููุดุชู ู Seek ุฏุฑ FileStream</h3>
<pre class="hljs"><code><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.IO;

<span class="hljs-comment">// ุงุฌุงุฏ ูุงู ุจู ูุงู test.txt ุฏุฑ ูุณุฑ ุฌุงุฑ:</span>
<span class="hljs-keyword">using</span> (Stream s = <span class="hljs-keyword">new</span> FileStream(<span class="hljs-string">&quot;test.txt&quot;</span>, FileMode.Create))
{
    Console.WriteLine(s.CanRead);   <span class="hljs-comment">// True</span>
    Console.WriteLine(s.CanWrite);  <span class="hljs-comment">// True</span>
    Console.WriteLine(s.CanSeek);   <span class="hljs-comment">// True</span>

    s.WriteByte(<span class="hljs-number">101</span>);
    s.WriteByte(<span class="hljs-number">102</span>);

    <span class="hljs-built_in">byte</span>[] block = { <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span> };
    s.Write(block, <span class="hljs-number">0</span>, block.Length);      <span class="hljs-comment">// ููุดุชู ฺฉ ุจููฺฉ 5 ุจุงุช</span>

    Console.WriteLine(s.Length);          <span class="hljs-comment">// 7</span>
    Console.WriteLine(s.Position);        <span class="hljs-comment">// 7</span>

    s.Position = <span class="hljs-number">0</span>;                       <span class="hljs-comment">// ุจุงุฒฺฏุดุช ุจู ุงุจุชุฏุง ูุงู</span>
    Console.WriteLine(s.ReadByte());      <span class="hljs-comment">// 101</span>
    Console.WriteLine(s.ReadByte());      <span class="hljs-comment">// 102</span>

    <span class="hljs-comment">// ุฎูุงูุฏู ุฏุงุฏู ุงุฒ ุงุณุชุฑู ู ุจุงุฒููุณ ุฏุฑ ุขุฑุงู block:</span>
    Console.WriteLine(s.Read(block, <span class="hljs-number">0</span>, block.Length));   <span class="hljs-comment">// 5</span>

    <span class="hljs-comment">// ฺูู ุฏุฑ ุงูุชูุง ูุงู ูุณุชูุ ุจุงุฑ ุจุนุฏ ุฎูุงูุฏู 0 ุจุฑูโฺฏุฑุฏุงูุฏ:</span>
    Console.WriteLine(s.Read(block, <span class="hljs-number">0</span>, block.Length));   <span class="hljs-comment">// 0</span>
}
</code></pre>
<hr>
<h3>๐ ููููู ฺฉุฏ: ุงุณุชูุงุฏู ุงุฒ ูุชุฏูุง Async</h3>
<p>ุฎูุงูุฏู ุง ููุดุชู ุจูโุตูุฑุช <strong>Asynchronous</strong> ููุท ุจู ุงู ูุนู ุงุณุช ฺฉู ุจูโุฌุง <strong>Read/Write</strong>ุ ุงุฒ <strong>ReadAsync/WriteAsync</strong> ุงุณุชูุงุฏู ฺฉูุฏ ู ูุชุฌู ุฑุง <code>await</code> ฺฉูุฏ (ู ููฺูู ุจุงุฏ ูุชุฏ ูุฑุงุฎูุงููุฏู <code>async</code> ุชุนุฑู ุดูุฏุ ููุงูโุทูุฑ ฺฉู ุฏุฑ ูุตู ฑด ุชูุถุญ ุฏุงุฏู ุดุฏ).</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">async</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">AsyncDemo</span>()</span>
{
    <span class="hljs-keyword">using</span> (Stream s = <span class="hljs-keyword">new</span> FileStream(<span class="hljs-string">&quot;test.txt&quot;</span>, FileMode.Create))
    {
        <span class="hljs-built_in">byte</span>[] block = { <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span> };

        <span class="hljs-keyword">await</span> s.WriteAsync(block, <span class="hljs-number">0</span>, block.Length);   <span class="hljs-comment">// ููุดุชู ุจูโุตูุฑุช Async</span>
        s.Position = <span class="hljs-number">0</span>;                               <span class="hljs-comment">// ุจุงุฒฺฏุดุช ุจู ุงุจุชุฏุง ูุงู</span>

        <span class="hljs-comment">// ุฎูุงูุฏู ุฏูุจุงุฑู ุฏุงุฏูโูุง ุงุฒ ุงุณุชุฑู ุจู ุขุฑุงู block:</span>
        Console.WriteLine(<span class="hljs-keyword">await</span> s.ReadAsync(block, <span class="hljs-number">0</span>, block.Length));   <span class="hljs-comment">// 5</span>
    }
}
</code></pre>
<p>ูุชุฏูุง Asynchronous ฺฉูฺฉ ูโฺฉููุฏ ุจุฑูุงููโูุง <strong>Responsive</strong> ู <strong>Scalable</strong> ููุดุชู ุดููุฏ ฺฉู ุจุชูุงููุฏ ุจุง ุงุณุชุฑูโูุง ุจุงูููู ฺฉูุฏ (ุจูโูฺู ุงุณุชุฑูโูุง ุดุจฺฉูโุง) ฺฉุงุฑ ฺฉููุฏุ ุจุฏูู ุงูโฺฉู ฺฉ Thread ุจูโุทูุฑ ฺฉุงูู ูุดุบูู ุดูุฏ.</p>
<blockquote>
<p>ุจุฑุง ุณุงุฏฺฏุ ุฏุฑ ุจุดุชุฑ ูุซุงูโูุง ุงู ูุตู ุงุฒ ูุชุฏูุง <strong>Synchronous</strong> ุงุณุชูุงุฏู ูโฺฉูู. ุจุง ุงู ุญุงูุ ุฏุฑ ุจุดุชุฑ ุณูุงุฑููุง <strong>I/O ุดุจฺฉูโุง</strong> ุชูุตู ูโุดูุฏ ุงุฒ ูุชุฏูุง Async ุงุณุชูุงุฏู ฺฉูุฏ.</p>
</blockquote>
<hr>
<h2>โ๏ธ ุฎูุงูุฏู ู ููุดุชู (Reading and Writing)</h2>
<p>ฺฉ ุงุณุชุฑู ูโุชูุงูุฏ ุงุฒ <strong>ุฎูุงูุฏู</strong>ุ <strong>ููุดุชู</strong> ุง ูุฑ ุฏู ูพุดุชุจุงู ฺฉูุฏ.</p>
<ul>
<li>ุงฺฏุฑ <code>CanWrite</code> ุจุฑุงุจุฑ <code>false</code> ุจุงุดุฏุ ุงุณุชุฑู <strong>ููุท ุฎูุงูุฏู</strong> ุงุณุช.</li>
<li>ุงฺฏุฑ <code>CanRead</code> ุจุฑุงุจุฑ <code>false</code> ุจุงุดุฏุ ุงุณุชุฑู <strong>ููุท ููุดุชู</strong> ุงุณุช.</li>
</ul>
<p>๐น ูุชุฏ <code>Read</code> ฺฉ ุจููฺฉ ุฏุงุฏู ุงุฒ ุงุณุชุฑู ูโฺฏุฑุฏ ู ุขู ุฑุง ุฏุฑูู ฺฉ ุขุฑุงู ูุฑุงุฑ ูโุฏูุฏ. ุงู ูุชุฏ ุชุนุฏุงุฏ ุจุงุชโูุง ุฎูุงูุฏูโุดุฏู ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ ฺฉู ููุดู <strong>ฺฉูุชุฑ ุง ูุณุงู</strong> ุจุง ุขุฑฺฏููุงู <code>count</code> ุงุณุช.</p>
<ul>
<li>ุงฺฏุฑ ููุฏุงุฑ ฺฉูุชุฑ ุงุฒ <code>count</code> ุจุงุดุฏุ ุนู ุง ุจู ุงูุชูุง ุงุณุชุฑู ุฑุณุฏูโุงูุ ุง ุฏุงุฏูโูุง ุฏุฑ <strong>ูุทุนุงุช ฺฉูฺฺฉโุชุฑ</strong> ุจุฑฺฏุฑุฏุงูุฏู ูโุดููุฏ (ูุซู ุญุงูุช ูุนููู ุฏุฑ ุงุณุชุฑูโูุง ุดุจฺฉูโุง).</li>
<li>ุฏุฑ ุงู ุดุฑุงุทุ ุจุฎุด ุจุงูโูุงูุฏู ุงุฒ ุขุฑุงู ุจุฏูู ุชุบุฑ ุจุงู ูโูุงูุฏ.</li>
</ul>
<blockquote>
<p>ุฑุณุฏู ุจู ุงูุชูุง ุงุณุชุฑู ููุท ุฒูุงู ูุทุน ุงุณุช ฺฉู <code>Read</code> ููุฏุงุฑ <code>0</code> ุจุฑฺฏุฑุฏุงูุฏ.</p>
</blockquote>
<hr>
<h3>โ ูุซุงู ุงุดุชุจุงู</h3>
<p>ูุฑุถ ฺฉูุฏ ฺฉ ุงุณุชุฑู ฑฐฐฐ ุจุงุช ุฏุงุฑู:</p>
<pre class="hljs"><code><span class="hljs-comment">// ูุฑุถ ฺฉูุฏ s ฺฉ ุงุณุชุฑู ุงุณุช:</span>
<span class="hljs-built_in">byte</span>[] data = <span class="hljs-keyword">new</span> <span class="hljs-built_in">byte</span>[<span class="hljs-number">1000</span>];
s.Read(data, <span class="hljs-number">0</span>, data.Length);
</code></pre>
<p>ุฏุฑ ุงู ุญุงูุชุ <code>Read</code> ููฺฉู ุงุณุช ูุฑ ููุฏุงุฑ ุจู <strong>ฑ ุชุง ฑฐฐฐ</strong> ุจุฑฺฏุฑุฏุงูุฏ ู ุจุฎุด ุจุงูโูุงูุฏู ุฎูุงูุฏู ูุดูุฏ.</p>
<hr>
<h3>โ ูุซุงู ุฏุฑุณุช</h3>
<pre class="hljs"><code><span class="hljs-built_in">byte</span>[] data = <span class="hljs-keyword">new</span> <span class="hljs-built_in">byte</span>[<span class="hljs-number">1000</span>];
<span class="hljs-comment">// bytesRead ุฏุฑ ููุงุช ููุดู 1000 ุฎูุงูุฏ ุจูุฏุ ูฺฏุฑ ุงูโฺฉู ุทูู ุงุณุชุฑู ฺฉูุชุฑ ุจุงุดุฏ:</span>
<span class="hljs-built_in">int</span> bytesRead = <span class="hljs-number">0</span>;
<span class="hljs-built_in">int</span> chunkSize = <span class="hljs-number">1</span>;

<span class="hljs-keyword">while</span> (bytesRead &lt; data.Length &amp;&amp; chunkSize &gt; <span class="hljs-number">0</span>)
    bytesRead += chunkSize = s.Read(data, bytesRead, data.Length - bytesRead);
</code></pre>
<hr>
<h3>๐ ูุชุฏูุง ุฌุฏุฏ ุฏุฑ .NET 7</h3>
<p>ุงุฒ ูุณุฎู .NET 7ุ ฺฉูุงุณ <strong>Stream</strong> ูุชุฏูุง ฺฉูฺฉ ุฒุฑ ุฑุง ุฏุงุฑุฏ:</p>
<ul>
<li><code>ReadExactly</code></li>
<li><code>ReadAtLeast</code></li>
</ul>
<p>(ุจู ููุฑุงู ูุณุฎูโูุง Async ุขูโูุง).</p>
<pre class="hljs"><code><span class="hljs-built_in">byte</span>[] data = <span class="hljs-keyword">new</span> <span class="hljs-built_in">byte</span>[<span class="hljs-number">1000</span>];
s.ReadExactly(data);   <span class="hljs-comment">// ุฏููุงู 1000 ุจุงุช ูโุฎูุงูุฏ</span>
</code></pre>
<p>ูุนุงุฏู:</p>
<pre class="hljs"><code>s.ReadExactly(data, offset: <span class="hljs-number">0</span>, count: <span class="hljs-number">1000</span>);
</code></pre>
<hr>
<h3>๐ฆ BinaryReader</h3>
<p>ููุน <strong>BinaryReader</strong> ุฑุงูโุญู ุฏฺฏุฑ ุจุฑุง ุงู ฺฉุงุฑ ุงุณุช:</p>
<pre class="hljs"><code><span class="hljs-built_in">byte</span>[] data = <span class="hljs-keyword">new</span> BinaryReader(s).ReadBytes(<span class="hljs-number">1000</span>);
</code></pre>
<ul>
<li>ุงฺฏุฑ ุทูู ุงุณุชุฑู ฺฉูุชุฑ ุงุฒ ฑฐฐฐ ุจุงุช ุจุงุดุฏุ ุงูุฏุงุฒู ุขุฑุงู ูุชูุงุณุจ ุจุง ุทูู ูุงูุน ุงุณุชุฑู ุฎูุงูุฏ ุจูุฏ.</li>
<li>ุงฺฏุฑ ุงุณุชุฑู ูุงุจูุช <code>Seek</code> ุฏุงุดุชู ุจุงุดุฏุ ูโุชูุงู ุจุง ุฌุงฺฏุฒู ฺฉุฑุฏู ฑฐฐฐ ุจุง <code>(int)s.Length</code> ฺฉู ูุญุชูุง ุขู ุฑุง ุฎูุงูุฏ.</li>
</ul>
<blockquote>
<p>ุฌุฒุฆุงุช ุจุดุชุฑ ุฏุฑุจุงุฑู BinaryReader ุฏุฑ ุจุฎุด <strong>โStream Adaptersโ</strong> (ุตูุญู 709) ุขูุฏู ุงุณุช.</p>
</blockquote>
<hr>
<h3>๐น ReadByte ู WriteByte</h3>
<ul>
<li>
<p>ูุชุฏ <code>ReadByte</code> ฺฉ ุจุงุช ูโุฎูุงูุฏ ู ุฏุฑ ุตูุฑุช ุฑุณุฏู ุจู ุงูุชูุง ุงุณุชุฑูุ <code>-1</code> ุจุฑูโฺฏุฑุฏุงูุฏ.<br>
(ุจู ููู ุฏูู ููุฏุงุฑ ุจุงุฒฺฏุดุช ุขู <code>int</code> ุงุณุชุ ฺูู ููุน <code>byte</code> ููโุชูุงูุฏ <code>-1</code> ุจุฑฺฏุฑุฏุงูุฏ).</p>
</li>
<li>
<p>ูุชุฏูุง <code>Write</code> ู <code>WriteByte</code> ุฏุงุฏู ุฑุง ุจู ุงุณุชุฑู ูโูุฑุณุชูุฏ. ุงฺฏุฑ ุงุฑุณุงู ฺฉุงูู ุจุงุชโูุง ููฺฉู ูุจุงุดุฏุ ฺฉ <strong>Exception</strong> ูพุฑุชุงุจ ูโุดูุฏ.</p>
</li>
</ul>
<hr>
<h2>๐ฏ ุฌุณุชุฌู ุฏุฑ ุงุณุชุฑู (Seeking)</h2>
<ul>
<li>ุขุฑฺฏููุงู <code>offset</code> ุฏุฑ ูุชุฏูุง <strong>Read/Write</strong> ุจู ุงูุฏุณ ุดุฑูุน ุฏุฑ ุขุฑุงู <strong>Buffer</strong> ุงุดุงุฑู ุฏุงุฑุฏุ ูู ุจู ูููุนุช ุฏุฑ ุฎูุฏ ุงุณุชุฑู.</li>
<li>ฺฉ ุงุณุชุฑู <strong>Seekable</strong> ุงุณุช ุงฺฏุฑ ูฺฺฏ <code>CanSeek</code> ุขู <code>true</code> ุจุงุดุฏ (ูุซู FileStream).</li>
</ul>
<p>ุจุง ฺฉ ุงุณุชุฑู Seekable ูโุชูุงู:</p>
<ul>
<li>ููุฏุงุฑ <code>Length</code> ุฑุง ูพุฑุณุฏ ุง ุจุง <code>SetLength</code> ุชุบุฑ ุฏุงุฏ.</li>
<li>ุฏุฑ ูุฑ ูุญุธู <code>Position</code> ุฑุง ุชุบุฑ ุฏุงุฏ ู ูุดุฎุต ฺฉุฑุฏ ุงุฒ ฺฉุฌุง ุจุฎูุงูุฏ ุง ุจููุณุฏ.</li>
</ul>
<p>๐น ูฺฺฏ <code>Position</code> ูุณุจุช ุจู ุงุจุชุฏุง ุงุณุชุฑู ุงุณุชุ ุงูุง ูุชุฏ <code>Seek</code> ุงุฌุงุฒู ูโุฏูุฏ ูุณุจุช ุจู ูููุนุช ูุนู ุง ุงูุชูุง ุงุณุชุฑู ุญุฑฺฉุช ฺฉูุฏ.</p>
<ul>
<li>ุชุบุฑ <code>Position</code> ุฏุฑ FileStream ูุนูููุงู ููุท ฺูุฏ ูฺฉุฑูุซุงูู ุทูู ูโฺฉุดุฏ. ุงฺฏุฑ ูุฑุงุฑ ุงุณุช ุงู ฺฉุงุฑ ุฑุง <strong>ููููโูุง ุจุงุฑ</strong> ุฏุฑ ฺฉ ุญููู ุงูุฌุงู ุฏูุฏุ ุงุณุชูุงุฏู ุงุฒ <code>MemoryMappedFile</code> ุงูุชุฎุงุจ ุจูุชุฑ ูุณุจุช ุจู FileStream ุฎูุงูุฏ ุจูุฏ (ุตูุญู 736 ุฑุง ุจุจูุฏ).</li>
<li>ุฏุฑ ุงุณุชุฑูโูุง ุบุฑูุงุจู Seek (ูุซู ุงุณุชุฑู ุฑูุฒูฺฏุงุฑ)ุ ุชููุง ุฑุงู ุฏุงูุณุชู ุทููุ ุฎูุงูุฏู ฺฉู ุขู ุงุณุช. ููฺูู ุจุฑุง ุฎูุงูุฏู ุฏูุจุงุฑู ฺฉ ุจุฎุด ูุจูุ ุจุงุฏ ุงุณุชุฑู ุฑุง ุจุจูุฏุฏ ู ฺฉ ุงุณุชุฑู ุฌุฏุฏ ุจุงุฒ ฺฉูุฏ.</li>
</ul>
<hr>
<h2>๐ ุจุณุชู ู Flush ฺฉุฑุฏู ุงุณุชุฑูโูุง</h2>
<p>ุงุณุชุฑูโูุง ูพุณ ุงุฒ ุงุณุชูุงุฏู ุจุงุฏ <strong>Dispose</strong> ุดููุฏ ุชุง ููุงุจุน ุฒุฑุจูุง ูุซู <strong>File Handle</strong> ู <strong>Socket Handle</strong> ุขุฒุงุฏ ุดููุฏ.</p>
<p>๐น ุณุงุฏูโุชุฑู ุฑุงู ุชุถูู ุงู ููุถูุนุ ูุฑุงุฑ ุฏุงุฏู ุงุณุชุฑู ุฏุฑูู ฺฉ <strong>ุจููฺฉ using</strong> ุงุณุช.</p>
<p>ููุงูู ฺฉู ูุฏุฑุช ุงุณุชุฑูโูุง:</p>
<ul>
<li>ูุชุฏูุง <strong>Dispose</strong> ู <strong>Close</strong> ุนููฺฉุฑุฏ ฺฉุณุงู ุฏุงุฑูุฏ.</li>
<li>ุจุณุชู ุง Dispose ฺฉุฑุฏู ฺูุฏุจุงุฑู ฺฉ ุงุณุชุฑู ูุดฺฉู ุงุฌุงุฏ ููโฺฉูุฏ.</li>
<li>ุจุณุชู ฺฉ ุงุณุชุฑู Decorator ุจุงุนุซ ุจุณุชู ุดุฏู ุฎูุฏุด ู <strong>Backing Store</strong> ุขู ูโุดูุฏ.</li>
<li>ุฏุฑ ฺฉ ุฒูุฌุฑู ุงุฒ Decoratorูุงุ ุจุณุชู Decorator ุจุฑูู ฺฉู ุฒูุฌุฑู ุฑุง ูโุจูุฏุฏ.</li>
</ul>
<p>ุจุฑุฎ ุงุณุชุฑูโูุง ุฏุงุฏูโูุง ุฑุง ุจุฑุง ุจูุจูุฏ ฺฉุงุฑุง ุฏุฑ ุญุงูุธู <strong>Buffer</strong> ูโฺฉููุฏ (ูุซู FileStream). ุงู ุจุงุนุซ ูโุดูุฏ ุฏุงุฏูโุง ฺฉู ุจู ุงุณุชุฑู ูโููุณุฏุ ุจูุงูุงุตูู ูุงุฑุฏ Backing Store ูุดูุฏ.</p>
<ul>
<li>ูุชุฏ <strong>Flush</strong> ุจุงุนุซ ูโุดูุฏ ุฏุงุฏูโูุง ุจุงูุฑ ุดุฏู ููุฑุงู ููุดุชู ุดููุฏ.</li>
<li><code>Flush</code> ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ููฺฏุงู ุจุณุชู ุดุฏู ุงุณุชุฑู ุตุฏุง ุฒุฏู ูโุดูุฏุ ุจูุงุจุฑุงู ูฺโููุช ูุงุฒ ุจู ููุดุชู ฺฉุฏ ูุซู ุฒุฑ ูุฏุงุฑุฏ:</li>
</ul>
<pre class="hljs"><code>s.Flush();
s.Close();
</code></pre>
<h2>โฑ๏ธ Timeoutูุง</h2>
<p>ฺฉ ุงุณุชุฑู ุฒูุงู ุงุฒ <strong>Timeout</strong> ูพุดุชุจุงู ูโฺฉูุฏ ฺฉู ูฺฺฏ <code>CanTimeout</code> ููุฏุงุฑ <code>true</code> ุฏุงุดุชู ุจุงุดุฏ.</p>
<ul>
<li>ุงุณุชุฑูโูุง <strong>ุดุจฺฉูโุง (Network Streams)</strong> ุงุฒ Timeout ูพุดุชุจุงู ูโฺฉููุฏ.</li>
<li>ุงุณุชุฑูโูุง <strong>ูุงู (File Streams)</strong> ู <strong>ุญุงูุธู (Memory Streams)</strong> ุงุฒ Timeout ูพุดุชุจุงู ููโฺฉููุฏ.</li>
</ul>
<p>ุจุฑุง ุงุณุชุฑูโูุง ฺฉู Timeout ุฑุง ูพุดุชุจุงู ูโฺฉููุฏ:</p>
<ul>
<li>ูฺฺฏโูุง <code>ReadTimeout</code> ู <code>WriteTimeout</code> ูุฏุช ุฒูุงู Timeout ุฑุง ุจุฑ ุญุณุจ <strong>ููโุซุงูู</strong> ูุดุฎุต ูโฺฉููุฏ.</li>
<li>ููุฏุงุฑ <code>0</code> ุนู <strong>ุจุฏูู Timeout</strong>.</li>
<li>ุงฺฏุฑ Timeout ุฑุฎ ุฏูุฏุ ูุชุฏูุง <code>Read</code> ู <code>Write</code> ฺฉ <strong>Exception</strong> ูพุฑุชุงุจ ูโฺฉููุฏ.</li>
</ul>
<p>โ๏ธ ูุชุฏูุง Asynchronous (<code>ReadAsync</code>/<code>WriteAsync</code>) ุงุฒ Timeout ูพุดุชุจุงู ููโฺฉููุฏ. ุฏุฑ ุงู ุญุงูุชุ ูโุชูุงูุฏ ฺฉ <strong>CancellationToken</strong> ุจู ุงู ูุชุฏูุง ุจุฏูุฏ.</p>
<hr>
<h2>๐งต Thread Safety</h2>
<p>ุจูโุทูุฑ ฺฉูุ ุงุณุชุฑูโูุง <strong>Thread-Safe</strong> ูุณุชูุฏุ ุนู ุฏู Thread ููโุชูุงููุฏ ุจูโุทูุฑ ููโุฒูุงู ุฑู ฺฉ ุงุณุชุฑู ุจุฎูุงููุฏ ุง ุจููุณูุฏุ ฺูู ุงุญุชูุงู ุฎุทุง ูุฌูุฏ ุฏุงุฑุฏ.</p>
<p>ฺฉูุงุณ <strong>Stream</strong> ฺฉ ุฑุงูฺฉุงุฑ ุณุงุฏู ุงุฑุงุฆู ูโุฏูุฏ: ูุชุฏ ุงุณุชุงุชฺฉ <code>Synchronized</code>.</p>
<ul>
<li>ุงู ูุชุฏ ฺฉ ุงุณุชุฑู ุงุฒ ูุฑ ููุน ุฑุง ูโูพุฐุฑุฏ ู ฺฉ <strong>Wrapper ุงูู ุจุฑุง Thread</strong> ุจุฑูโฺฏุฑุฏุงูุฏ.</li>
<li>ุงู Wrapper ุจุง ฺฏุฑูุชู ฺฉ <strong>ููู ุงูุญุตุงุฑ (Exclusive Lock)</strong> ุฏุฑ ุงุทุฑุงู ูุฑ ุนููุงุช ุฎูุงูุฏูุ ููุดุชู ุง Seekุ ุชุถูู ูโฺฉูุฏ ฺฉู ููุท ฺฉ Thread ุฏุฑ ูุฑ ูุญุธู ุจุชูุงูุฏ ุนูู ููุฑุฏ ูุธุฑ ุฑุง ุงูุฌุงู ุฏูุฏ.</li>
</ul>
<p>๐น ูุชุฌู ุนูู ุงู ุงุณุช ฺฉู ฺูุฏ Thread ูโุชูุงููุฏ ุจูโุทูุฑ ููโุฒูุงู ุฏุงุฏูโูุง ุฑุง ุจู ฺฉ ุงุณุชุฑู <strong>Append</strong> ฺฉููุฏ.<br>
ุงูุง ุณุงุฑ ูุนุงูุชโูุง (ูุซู ุฎูุงูุฏู ููโุฒูุงู) ูุงุฒููุฏ ูููโฺฏุฐุงุฑ ุงุถุงู ูุณุชูุฏ ุชุง ูุทูุฆู ุดูุฏ ูุฑ Thread ุฏููุงู ุจู ุจุฎุด ุฏุฑุณุช ุงุฒ ุงุณุชุฑู ุฏุณุชุฑุณ ุฏุงุฑุฏ.</p>
<p>๐ ุฌุฒุฆุงุช ฺฉุงููโุชุฑ ุฏุฑุจุงุฑู <strong>Thread Safety</strong> ุฏุฑ ูุตู ฒฑ ุชูุถุญ ุฏุงุฏู ูโุดูุฏ.</p>
<hr>
<h3>๐ ูฺฺฏ ุฌุฏุฏ ุฏุฑ .NET 6</h3>
<p>ุงุฒ ูุณุฎู .NET 6 ุจู ุจุนุฏุ ูโุชูุงูุฏ ุจุฑุง ุนููุงุช <strong>File I/O ุงูู ู ฺฉุงุฑุขูุฏ ุฏุฑ ุจุฑุงุจุฑ Thread</strong> ุงุฒ ฺฉูุงุณ <strong>RandomAccess</strong> ุงุณุชูุงุฏู ฺฉูุฏ.</p>
<ul>
<li>ุงู ฺฉูุงุณ ุงูฺฉุงู <strong>Thread-Safe File I/O</strong> ุจุง ฺฉุงุฑุง ุจุงูุง ุฑุง ูุฑุงูู ูโฺฉูุฏ.</li>
<li>ููฺูู ุงุฌุงุฒู ูโุฏูุฏ ฺูุฏู <strong>Buffer</strong> ุฑุง ุจุฑุง ุจูุจูุฏ ุนููฺฉุฑุฏ ุจูโุทูุฑ ููโุฒูุงู ูพุงุณ ุฏูุฏ.</li>
</ul>
<hr>
<h2>๐๏ธ Backing Store Streams</h2>
<p>๐ ุดฺฉู 15-2 ุงุณุชุฑูโูุง ุงุตู <strong>Backing Store</strong> ฺฉู ุชูุณุท .NET ุงุฑุงุฆู ูโุดููุฏ ุฑุง ูุดุงู ูโุฏูุฏ.</p>
<p>๐น ุนูุงูู ุจุฑ ุงูุ ฺฉ <strong>Null Stream</strong> ูู ุงุฒ ุทุฑู ููุฏ ุงุณุชุงุชฺฉ <code>Stream.Null</code> ุฏุฑ ุฏุณุชุฑุณ ุงุณุช.</p>
<p><strong>Null Stream</strong> ูโุชูุงูุฏ ููฺฏุงู ููุดุชู <strong>Unit Test</strong>ูุง ุจุณุงุฑ ููุฏ ุจุงุดุฏ.</p>
<div align="center">
<p><img src="../../../assets/image/15/Table-15-3.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h2>๐ FileStream</h2>
<p>ุฏุฑ ุจุฎุดโูุง ุจุนุฏุ ุจู ุจุฑุฑุณ <strong>FileStream</strong> ู <strong>MemoryStream</strong> ูโูพุฑุฏุงุฒูุ ู ุฏุฑ ุจุฎุด ูพุงุงู ุงู ูุตูุ <strong>IsolatedStorageStream</strong> ุฑุง ูุนุฑู ูโฺฉูู. ุฏุฑ ูุตู ฑถ ูู ุจู <strong>NetworkStream</strong> ุฎูุงูู ูพุฑุฏุงุฎุช.</p>
<hr>
<h3>โจ ูฺฺฏโูุง FileStream</h3>
<p>ูพุดโุชุฑ ุงุณุชูุงุฏูโ ูพุงูโุง ุงุฒ <strong>FileStream</strong> ุจุฑุง ุฎูุงูุฏู ู ููุดุชู ุจุงุชโูุง ุฑุง ุฏุฏู. ุญุงูุง ุจุงุฏ ูฺฺฏโูุง ุฎุงุต ุงู ฺฉูุงุณ ุฑุง ุฏููโุชุฑ ุจุฑุฑุณ ฺฉูู.</p>
<p>๐น ุงฺฏุฑ ูููุฒ ุงุฒ <strong>UWP (Universal Windows Platform)</strong> ุงุณุชูุงุฏู ูโฺฉูุฏุ ูโุชูุงูุฏ ุนููุงุช ูุงู ุฑุง ุจุง ููุนโูุง ููุฌูุฏ ุฏุฑ ูุถุง ูุงู <strong>Windows.Storage</strong> ุงูุฌุงู ุฏูุฏ. ุชูุถุญุงุช ุจุดุชุฑ ุฏุฑ <a href="http://www.albahari.com/nutshell">ุถููู ุขููุงู</a> ุขูุฏู ุงุณุช.</p>
<hr>
<h3>๐๏ธ ุณุงุฎุช ฺฉ FileStream</h3>
<p>ุณุงุฏูโุชุฑู ุฑุงู ุจุฑุง ูููููโุณุงุฒ <strong>FileStream</strong> ุงุณุชูุงุฏู ุงุฒ ูุชุฏูุง ุงุณุชุงุชฺฉ ฺฉูุงุณ <strong>File</strong> ุงุณุช:</p>
<pre class="hljs"><code>FileStream fs1 = File.OpenRead(<span class="hljs-string">&quot;readme.bin&quot;</span>);   <span class="hljs-comment">// ููุท ุฎูุงูุฏู</span>
FileStream fs2 = File.OpenWrite(<span class="hljs-string">&quot;writeme.tmp&quot;</span>); <span class="hljs-comment">// ููุท ููุดุชู</span>
FileStream fs3 = File.Create(<span class="hljs-string">&quot;readwrite.tmp&quot;</span>);  <span class="hljs-comment">// ุฎูุงูุฏู/ููุดุชู</span>
</code></pre>
<p>โ๏ธ ุชูุงูุช <code>OpenWrite</code> ู <code>Create</code>:</p>
<ul>
<li><code>Create</code> ูุญุชูุง ูุจู ูุงู ุฑุง <strong>ฺฉุงูู ูพุงฺฉ ูโฺฉูุฏ</strong> (truncate).</li>
<li><code>OpenWrite</code> ูุญุชูุง ููุฌูุฏ ุฑุง ูฺฏู ูโุฏุงุฑุฏ ู ูฺฉุงู ุงุณุชุฑู ุฑุง ุฑู ุตูุฑ ูุฑุงุฑ ูโุฏูุฏ.<br>
ุงฺฏุฑ ฺฉูุชุฑ ุงุฒ ุงูุฏุงุฒูโ ูุจู ุฏุงุฏู ุจููุณุฏุ ูุชุฌู ุชุฑฺฉุจ ุงุฒ ุฏุงุฏูโูุง ูุฏู ู ุฌุฏุฏ ุฎูุงูุฏ ุดุฏ.</li>
</ul>
<p>ููฺูู ูโุชูุงูุฏ ูุณุชูู ุงุฒ <strong>ุณุงุฒูุฏูโ FileStream</strong> ุงุณุชูุงุฏู ฺฉูุฏ. ุณุงุฒูุฏูโูุง ุงูฺฉุงู ฺฉูุชุฑู ฺฉุงูู ุฑู:</p>
<ul>
<li>ูุงู ูุงู ุง <strong>file handle ุณุทุญ ูพุงู</strong></li>
<li>ุญุงูุชโูุง ุณุงุฎุช ู ุฏุณุชุฑุณ ุจู ูุงู</li>
<li>ฺฏุฒููโูุง ุงุดุชุฑุงฺฉโฺฏุฐุงุฑ (sharing)ุ ุจุงูุฑูฺฏ ู ุงููุช</li>
</ul>
<p>ุฑุง ูุฑุงูู ูโฺฉููุฏ. ุจุฑุง ูุซุงู:</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> fs = <span class="hljs-keyword">new</span> FileStream(<span class="hljs-string">&quot;readwrite.tmp&quot;</span>, FileMode.Open);
</code></pre>
<p>(ฺฉูุฏูุงฺูโ <code>using</code> ุชุถูู ูโฺฉูุฏ ฺฉู ุงุณุชุฑู ูพุณ ุงุฒ ุฎุฑูุฌ ุงุฒ ูุญุฏูุฏู dispose ุดูุฏ).</p>
<p>๐ ุฏุฑ ุงุฏุงูู ุจู ุฌุฒุฆุงุช <code>FileMode</code> ูโูพุฑุฏุงุฒู.</p>
<hr>
<h3>โก ูุชุฏูุง ูุงูโุจูุฑ ฺฉูุงุณ File</h3>
<p>ุงู ูุชุฏูุง ฺฉู ูุญุชูุง ูุงู ุฑุง ุฏุฑ ฺฉ ูุฑุญูู ูโุฎูุงููุฏ:</p>
<ul>
<li><code>File.ReadAllText</code> โ ุจุงุฒฺฏุฑุฏุงูุฏู ฺฉ <strong>string</strong></li>
<li><code>File.ReadAllLines</code> โ ุจุงุฒฺฏุฑุฏุงูุฏู ฺฉ <strong>ุขุฑุงู ุงุฒ string</strong></li>
<li><code>File.ReadAllBytes</code> โ ุจุงุฒฺฏุฑุฏุงูุฏู ฺฉ <strong>ุขุฑุงูโ ุจุงุช</strong></li>
</ul>
<p>ุงู ูุชุฏูุง ฺฉู ูุงู ุฑุง ุฏุฑ ฺฉ ูุฑุญูู ูโููุณูุฏ:</p>
<ul>
<li><code>File.WriteAllText</code></li>
<li><code>File.WriteAllLines</code></li>
<li><code>File.WriteAllBytes</code></li>
<li><code>File.AppendAllText</code> (ููุงุณุจ ุจุฑุง ุงุถุงููโฺฉุฑุฏู ุจู ูุงูโูุง ูุงฺฏ)</li>
</ul>
<p>ููฺูู ูุชุฏ ุจู ูุงู <code>File.ReadLines</code> ูุฌูุฏ ุฏุงุฑุฏ ฺฉู ูุงููุฏ <code>ReadAllLines</code> ุงุณุชุ ุจุง ุงู ุชูุงูุช ฺฉู ฺฉ <code>IEnumerable&lt;string&gt;</code> <strong>Lazy</strong> ุจุงุฒูโฺฏุฑุฏุงูุฏ (ุจูโุตูุฑุช ุชุฏุฑุฌ ุฎูุงูุฏู ูโุดูุฏุ ูู ฺฉโุฌุง). ุงู ฺฉุงุฑุง ุจูุชุฑ ุฏุงุฑุฏ ฺูู ฺฉู ูุงู ฺฉโุฌุง ุฏุฑ ุญุงูุธู ุจุงุฑฺฏุฐุงุฑ ููโุดูุฏ.</p>
<p>ูุซุงู ุจุง LINQ ุจุฑุง ุดูุฑุฏู ุชุนุฏุงุฏ ุฎุทูุท ฺฉู ุทูู ุขูโูุง ุจุดุชุฑ ุงุฒ ธฐ ฺฉุงุฑุงฺฉุชุฑ ุงุณุช:</p>
<pre class="hljs"><code><span class="hljs-built_in">int</span> longLines = File.ReadLines(<span class="hljs-string">&quot;filePath&quot;</span>)
                   .Count(l =&gt; l.Length &gt; <span class="hljs-number">80</span>);
</code></pre>
<hr>
<h3>๐ ูุดุฎุตโฺฉุฑุฏู ูุงู ูุงู</h3>
<p>ูุงู ูุงู ูโุชูุงูุฏ:</p>
<ul>
<li>
<p><strong>ูุทูู (Absolute)</strong> ุจุงุดุฏ โ ูุซู:</p>
<ul>
<li>ููุฏูุฒ: <code>c:\temp\test.txt</code></li>
<li>ููฺฉุณ: <code>/tmp/test.txt</code></li>
</ul>
</li>
<li>
<p><strong>ูุณุจ (Relative)</strong> ุจู ุฏุงุฑฺฉุชูุฑ ูุนู โ ูุซู:</p>
<ul>
<li><code>test.txt</code></li>
<li><code>temp\test.txt</code></li>
</ul>
</li>
</ul>
<p>๐น ุฏุงุฑฺฉุชูุฑ ูุนู ุจุฑูุงูู ุงุฒ ุทุฑู ูฺฺฏ ุงุณุชุงุชฺฉ:</p>
<pre class="hljs"><code>Environment.CurrentDirectory
</code></pre>
<p>ูุงุจู ุฏุณุชุฑุณ ู ุชุบุฑ ุงุณุช.</p>
<p>โ๏ธ ุงูุง ุฏุงุฑฺฉุชูุฑ ูุนู <strong>ููฺฉู ุงุณุช ุจุง ูุณุฑ ุงุฌุฑุง ุจุฑูุงูู ฺฉ ูุจุงุดุฏ</strong>. ุจูุงุจุฑุงู <strong>ูฺโููุช</strong> ุจุฑุง ุงูุชู ูุงูโูุง ููุฑุงู executable ุฑู ุขู ุญุณุงุจ ูฺฉูุฏ.</p>
<p>ุฏุงุฑฺฉุชูุฑ ูพุงูโ ุงูพูฺฉุดู ุงุฒ ุทุฑู:</p>
<pre class="hljs"><code>AppDomain.CurrentDomain.BaseDirectory
</code></pre>
<p>ุฏุฑุงูุช ูโุดูุฏ (ูุนูููุงู ููุงู ูพูุดูโ ูุงู ุงุฌุฑุง ุงุณุช).</p>
<p>ุจุฑุง ูุดุฎุต ฺฉุฑุฏู ูุงู ูุงู ุจูโุตูุฑุช ูุณุจ ูุณุจุช ุจู ุงู ุฏุงุฑฺฉุชูุฑ:</p>
<pre class="hljs"><code><span class="hljs-built_in">string</span> baseFolder = AppDomain.CurrentDomain.BaseDirectory;
<span class="hljs-built_in">string</span> logoPath = Path.Combine(baseFolder, <span class="hljs-string">&quot;logo.jpg&quot;</span>);
Console.WriteLine(File.Exists(logoPath));
</code></pre>
<hr>
<h3>๐ ูุณุฑูุง ุดุจฺฉูโุง (UNC Path)</h3>
<p>ุฏุฑ ููุฏูุฒ ูโุชูุงูุฏ ูุงูโูุง ุฑุง ุงุฒ ุทุฑู ูุณุฑ <strong>UNC</strong> ุจุฎูุงูุฏ/ุจููุณุฏ:</p>
<ul>
<li><code>\\JoesPC\PicShare\pic.jpg</code></li>
<li><code>\\10.1.1.2\PicShare\pic.jpg</code></li>
</ul>
<p>๐น ุฏุฑ macOS ุง Unix ุจุฑุง ุฏุณุชุฑุณ ุจู ฺฉ Windows File Share ุจุงุฏ ุงุจุชุฏุง ุขู ุฑุง ุจู filesystem ุฎูุฏ mount ฺฉูุฏุ ุณูพุณ ูุงููุฏ ูุณุฑ ูุนููู ุฏุฑ C# ุจุงุฒ ฺฉูุฏ.</p>
<hr>
<h3>โ๏ธ ูุดุฎุต ฺฉุฑุฏู FileMode</h3>
<p>ุชูุงู ุณุงุฒูุฏูโูุง <code>FileStream</code> ฺฉู ฺฉ ูุงู ูุงู ูโูพุฐุฑูุฏุ ูุงุฒ ุจู ฺฉ ุขุฑฺฏููุงู ุงุฒ ููุน <strong>FileMode enum</strong> ุฏุงุฑูุฏ.</p>
<p>๐ ุดฺฉู 15-3 ูุดุงู ูโุฏูุฏ ฺฺฏููู ุจุงุฏ ฺฉ FileMode ุงูุชุฎุงุจ ฺฉูุฏ. ูุชุงุฌ ูุดุงุจู ูุฑุงุฎูุงู ูุชุฏูุง ุงุณุชุงุชฺฉ ฺฉูุงุณ <strong>File</strong> ุฎูุงูุฏ ุจูุฏ.</p>
<div align="center">
<p><img src="../../../assets/image/15/Table-15-4.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h2>๐ FileStream</h2>
<p>๐น ุงฺฏุฑ ุฑู ูุงูโูุง <strong>Hidden</strong> ุงุฒ <code>File.Create</code> ุง <code>FileMode.Create</code> ุงุณุชูุงุฏู ฺฉูุฏุ ฺฉ <strong>ุงุณุชุซูุง (Exception)</strong> ูพุฑุชุงุจ ูโุดูุฏ. ุจุฑุง ุจุงุฒููุณ ฺฉ ูุงู ูุฎูุ ุจุงุฏ ุงุจุชุฏุง ุขู ุฑุง <strong>ุญุฐู</strong> ู ุณูพุณ ุฏูุจุงุฑู ุงุฌุงุฏ ฺฉูุฏ:</p>
<pre class="hljs"><code>File.Delete(<span class="hljs-string">&quot;hidden.txt&quot;</span>);
<span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> <span class="hljs-keyword">file</span> = File.Create(<span class="hljs-string">&quot;hidden.txt&quot;</span>);
</code></pre>
<hr>
<h3>๐ FileAccess</h3>
<p>ุงฺฏุฑ ููุท ูุงู ูุงู ู ฺฉ <code>FileMode</code> ุฑุง ุจู ุณุงุฒูุฏูโ <code>FileStream</code> ุจุฏูุฏุ ูุชุฌู (ุจุง ฺฉ ุงุณุชุซูุง) ฺฉ ุงุณุชุฑู <strong>ูุงุจู ุฎูุงูุฏู/ููุดุชู</strong> ุฎูุงูุฏ ุจูุฏ.<br>
ุงูุง ูโุชูุงูุฏ ุจุง ูุดุฎุตโฺฉุฑุฏู ุขุฑฺฏููุงู <strong>FileAccess</strong> ุฏุณุชุฑุณ ุฑุง ูุญุฏูุฏ ฺฉูุฏ:</p>
<pre class="hljs"><code>[<span class="hljs-meta">Flags</span>]
<span class="hljs-keyword">public</span> <span class="hljs-built_in">enum</span> FileAccess { Read = <span class="hljs-number">1</span>, Write = <span class="hljs-number">2</span>, ReadWrite = <span class="hljs-number">3</span> }
</code></pre>
<p>ูุซุงู: ุณุงุฎุชู ฺฉ ุงุณุชุฑู ููุท-ุฎูุงูุฏู (ูุนุงุฏู <code>File.OpenRead</code>):</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> fs = <span class="hljs-keyword">new</span> FileStream(<span class="hljs-string">&quot;x.bin&quot;</span>, FileMode.Open, FileAccess.Read);
</code></pre>
<p>โ๏ธ ุญุงูุช ุฎุงุต: <code>FileMode.Append</code> โ ููุท <strong>Write-only</strong> ุงุณุช.<br>
ุงฺฏุฑ ูโุฎูุงูุฏ ุฏุงุฏูโูุง ุฑุง <strong>ุงุถุงูู (Append)</strong> ฺฉูุฏ ู ููุฒูุงู ุงูฺฉุงู ุฎูุงูุฏู ุฏุงุดุชู ุจุงุดุฏุ ุจุงุฏ ุงุฒ <code>FileMode.Open</code> ุง <code>FileMode.OpenOrCreate</code> ุงุณุชูุงุฏู ฺฉูุฏ ู ุณูพุณ ูฺฉุงู ุงุณุชุฑู ุฑุง ุจู ุงูุชูุง ูุงู ุจุจุฑุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> fs = <span class="hljs-keyword">new</span> FileStream(<span class="hljs-string">&quot;myFile.bin&quot;</span>, FileMode.Open);
fs.Seek(<span class="hljs-number">0</span>, SeekOrigin.End);
</code></pre>
<hr>
<h3>โ๏ธ ูฺฺฏโูุง ูพุดุฑูุชูโ FileStream</h3>
<p>ูโุชูุงูุฏ ููฺฏุงู ุณุงุฎุช ฺฉ FileStream ุขุฑฺฏููุงูโูุง ุงุถุงู ุจุฏูุฏ:</p>
<ul>
<li>
<p><strong>FileShare enum</strong> โ ูุฒุงู ุฏุณุชุฑุณ ุณุงุฑ ูพุฑุฏุงุฒุดโูุง (Noneุ Readุ ReadWriteุ Write).</p>
</li>
<li>
<p><strong>Buffer size</strong> โ ุงูุฏุงุฒู ุจุงูุฑ ุฏุงุฎู (ุจูโุตูุฑุช ูพุดโูุฑุถ ดKB).</p>
</li>
<li>
<p><strong>Async flag</strong> โ ูุงฺฏุฐุงุฑ ุนููุงุช ูุงููฺฏุงู ุจู ุณุณุชูโุนุงูู.</p>
</li>
<li>
<p><strong>FileOptions flags</strong> โ ุดุงูู:</p>
<ul>
<li><code>Encrypted</code> โ ุฑูุฒูฺฏุงุฑ ุชูุณุท ุณุณุชูโุนุงูู</li>
<li><code>DeleteOnClose</code> โ ุญุฐู ุฎูุฏฺฉุงุฑ ูุงู ููฺฏุงู ุจุณุชูโุดุฏู</li>
<li><code>RandomAccess</code> โ ุจูููโุณุงุฒ ุจุฑุง ุฏุณุชุฑุณ ุชุตุงุฏู</li>
<li><code>SequentialScan</code> โ ุจูููโุณุงุฒ ุจุฑุง ุงุณฺฉู ุชุฑุชุจ</li>
<li><code>WriteThrough</code> โ ุบุฑูุนุงู ฺฉุฑุฏู ฺฉุด ุณุณุชูโุนุงูู (ุจุฑุง ูุงูโูุง ุชุฑุงฺฉูุด ุง ูุงฺฏโูุง)</li>
</ul>
</li>
</ul>
<p>โ๏ธ ููฺฏโูุง ฺฉู ุณุณุชูโุนุงูู ูพุดุชุจุงู ูฺฉูุฏุ ุจโุตุฏุง (silently) ูุงุฏุฏู ฺฏุฑูุชู ูโุดููุฏ.</p>
<p>ุงฺฏุฑ ุจุง <code>FileShare.ReadWrite</code> ูุงู ุฑุง ุจุงุฒ ฺฉูุฏุ ฺูุฏ ูพุฑุฏุงุฒุด ุง ฺฉุงุฑุจุฑ ูโุชูุงููุฏ ููุฒูุงู ุจุฎูุงููุฏ/ุจููุณูุฏ. ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุชุฏุงุฎูุ ูโุชูุงู ุจุฎุดโูุง ุงุฒ ูุงู ุฑุง ููู ฺฉุฑุฏ:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Lock</span>(<span class="hljs-params"><span class="hljs-built_in">long</span> position, <span class="hljs-built_in">long</span> length</span>)</span>;
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Unlock</span>(<span class="hljs-params"><span class="hljs-built_in">long</span> position, <span class="hljs-built_in">long</span> length</span>)</span>;
</code></pre>
<p>ูุชุฏ <code>Lock</code> ุงฺฏุฑ ูุงุญูโุง ุงุฒ ูุงู ูุจูุงู ููู ุจุงุดุฏุ ุงุณุชุซูุง ูพุฑุชุงุจ ูโฺฉูุฏ.</p>
<hr>
<h2>๐ง MemoryStream</h2>
<p><strong>MemoryStream</strong> ุงุฒ ฺฉ ุขุฑุงู ุฏุฑ ุญุงูุธู ุจูโุนููุงู <strong>backing store</strong> ุงุณุชูุงุฏู ูโฺฉูุฏ.<br>
ุงู ุนู ุชูุงู ุฏุงุฏูโูุง ุจุงุฏ ฺฉโุฌุง ุฏุฑ ุญุงูุธู ุจุงุดูุฏ (ุจุฑุฎูุงู ูุฒุช ุงุตู Stream).</p>
<p>ุงูุง ููฺูุงู ููุฏ ุงุณุชุ ุจูโุฎุตูุต ููุช:</p>
<ul>
<li>ูุงุฒ ุจู ุฏุณุชุฑุณ ุชุตุงุฏู (Random Access) ุจู ฺฉ ุงุณุชุฑู ุบุฑูุงุจู Seek ุฏุงุฑุฏ.</li>
<li>ุฏุงุฏูโ ุงุตู ฺฉูฺฺฉ ู ูุงุจู ูุฏุฑุช ุงุณุช.</li>
</ul>
<p>๐ ูุซุงู: ฺฉูพ ฺฉุฑุฏู ุฏุงุฏูโ ฺฉ ุงุณุชุฑู ุฏุฑูู MemoryStream:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> ms = <span class="hljs-keyword">new</span> MemoryStream();
sourceStream.CopyTo(ms);
</code></pre>
<ul>
<li>
<p>ุจุฑุง ฺฏุฑูุชู ุฏุงุฏูโูุง:</p>
<ul>
<li><code>ToArray()</code> โ ฺฉ ฺฉูพ ุงุฒ ุฏุงุฏูโูุง ุจุงุฒูโฺฏุฑุฏุงูุฏ.</li>
<li><code>GetBuffer()</code> โ ูุฑุฌุน ูุณุชูู ุจู ุขุฑุงูโ ุฐุฎุฑูโุณุงุฒ ูโุฏูุฏ (ฺฉุงุฑุขูุฏุชุฑ ุงุณุชุ ุงูุง ุทูู ุขู ูุนูููุงู ุงุฒ ุฏุงุฏูโ ูุงูุน ุจุดุชุฑ ุงุณุช).</li>
</ul>
</li>
</ul>
<p>๐ ุจุณุชู ุง Flush ฺฉุฑุฏู MemoryStream ุงุฎุชุงุฑ ุงุณุช:</p>
<ul>
<li>ุจุนุฏ ุงุฒ <code>Close</code> ุฏฺฏุฑ ููโุชูุงูุฏ ุจุฎูุงูุฏ/ุจููุณุฏุ ูู ููฺูุงู <code>ToArray()</code> ฺฉุงุฑ ูโฺฉูุฏ.</li>
<li><code>Flush</code> ูฺ ุชุฃุซุฑ ูุฏุงุฑุฏ.</li>
</ul>
<hr>
<h2>๐ PipeStream</h2>
<p><strong>PipeStream</strong> ุฑุงู ุณุงุฏู ุจุฑุง ุงุฑุชุจุงุท ุจู ูพุฑุฏุงุฒุดโูุง (IPC) ุงุฒ ุทุฑู ูพุฑูุชฺฉู <strong>Pipe</strong> ุณุณุชูโุนุงูู ุงุณุช.</p>
<h3>ุงููุงุน Pipe</h3>
<ol>
<li><strong>Anonymous Pipe (ุณุฑุนโุชุฑ)</strong> โ ุงุฑุชุจุงุท ฺฉโุทุฑูู ุจู ฺฉ ูพุฑุฏุงุฒุด ูุงูุฏ ู ูุฑุฒูุฏ (ุฑู ููุงู ุณุณุชู).</li>
<li><strong>Named Pipe (ุงูุนุทุงูโูพุฐุฑุชุฑ)</strong> โ ุงุฑุชุจุงุท ุฏูุทุฑูู ุจู ูพุฑุฏุงุฒุดโูุง ูุฎุชูู (ุฑู ฺฉ ุณุณุชู ุง ุจู ุณุณุชูโูุง ุฏุฑ ุดุจฺฉู).</li>
</ol>
<p>๐ Pipes ุจุฑุง IPC ุฑู ฺฉ ฺฉุงููพูุชุฑ ุนุงู ูุณุชูุฏ:</p>
<ul>
<li>ูุงุฒ ุจู ูพุฑูุชฺฉู ุดุจฺฉู ูุฏุงุฑูุฏ (ุจุฏูู ุณุฑุจุงุฑ ุดุจฺฉู).</li>
<li>ูุดฺฉู ุจุง ูุงุฑูุงูโูุง ูุฏุงุฑูุฏ.</li>
</ul>
<hr>
<h3>ฺฉูุงุณโูุง</h3>
<p>PipeStream ฺฉ ฺฉูุงุณ ุงูุชุฒุงุน ุงุณุช. ฺูุงุฑ ุฒุฑฺฉูุงุณ ุงุตู ุฏุงุฑุฏ:</p>
<ul>
<li><strong>AnonymousPipeServerStream</strong></li>
<li><strong>AnonymousPipeClientStream</strong></li>
<li><strong>NamedPipeServerStream</strong></li>
<li><strong>NamedPipeClientStream</strong></li>
</ul>
<p>๐น Named Pipes ุณุงุฏูโุชุฑูุฏุ ูพุณ ุงูู ุขูโูุง ุฑุง ุจุฑุฑุณ ูโฺฉูู.</p>
<hr>
<h3>๐ก Named Pipes</h3>
<p>ุงุฑุชุจุงุท ุงุฒ ุทุฑู ฺฉ ูุงู ูุดุชุฑฺฉ ุจุฑูุฑุงุฑ ูโุดูุฏ. ุฏู ููุด ุงุตู ูุฌูุฏ ุฏุงุฑุฏ:</p>
<ul>
<li><strong>Server</strong> โ ูููููโุง ุงุฒ <code>NamedPipeServerStream</code> ุณุงุฎุชู ู <code>WaitForConnection()</code> ุฑุง ุตุฏุง ูโุฒูุฏ.</li>
<li><strong>Client</strong> โ ูููููโุง ุงุฒ <code>NamedPipeClientStream</code> ุณุงุฎุชู ู <code>Connect()</code> ุฑุง ุตุฏุง ูโุฒูุฏ.</li>
</ul>
<p>ุณูพุณ ุฏู ุทุฑู ุงุฒ ุงุณุชุฑู ุจุฑุง ุฎูุงูุฏู/ููุดุชู ุงุณุชูุงุฏู ูโฺฉููุฏ.</p>
<p>๐ ูุซุงู ุณุงุฏู:</p>
<p><strong>Server</strong> โ ุงุฑุณุงู ฺฉ ุจุงุช (ฑฐฐ) ู ุฏุฑุงูุช ฺฉ ุจุงุช:</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> s = <span class="hljs-keyword">new</span> NamedPipeServerStream(<span class="hljs-string">&quot;pipedream&quot;</span>);
s.WaitForConnection();
s.WriteByte(<span class="hljs-number">100</span>);
Console.WriteLine(s.ReadByte());
</code></pre>
<p><strong>Client</strong> โ ุฏุฑุงูุช ุจุงุช ู ุงุฑุณุงู ฺฉ ุจุงุช (ฒฐฐ):</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> s = <span class="hljs-keyword">new</span> NamedPipeClientStream(<span class="hljs-string">&quot;pipedream&quot;</span>);
s.Connect();
Console.WriteLine(s.ReadByte());
s.WriteByte(<span class="hljs-number">200</span>);
</code></pre>
<p>๐น Pipeูุง ุจูโุทูุฑ ูพุดโูุฑุถ <strong>ุฏูุทุฑูู</strong> ูุณุชูุฏ. ูพุณ ุจุงุฏ ฺฉ <strong>ูพุฑูุชฺฉู ุชูุงูู</strong> ุจู Client ู Server ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ ุชุง ูุฑ ุฏู ููุฒูุงู ูููุณูุฏ ุง ูุฎูุงููุฏ.</p>
<hr>
<h3>๐ Message Transmission Mode (ููุท ููุฏูุฒ)</h3>
<p>ุจุฑุง ูพุงูโูุง ุทููุงูโุชุฑุ Pipeูุง ฺฉ ุญุงูุช ุฎุงุต ุจู ูุงู <strong>Message Mode</strong> ุฏุงุฑูุฏ.<br>
ุฏุฑ ุงู ุญุงูุช ูโุชูุงู ุจุง ูฺฺฏ <code>IsMessageComplete</code> ูููุฏ ฺฉ ูพุงู ฺฉุงูู ุฏุฑุงูุช ุดุฏู ุงุณุช.</p>
<p>๐ ูุซุงู: ุฎูุงูุฏู ฺฉู ูพุงู:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-built_in">byte</span>[] <span class="hljs-title">ReadMessage</span>(<span class="hljs-params">PipeStream s</span>)</span>
{
    MemoryStream ms = <span class="hljs-keyword">new</span> MemoryStream();
    <span class="hljs-built_in">byte</span>[] buffer = <span class="hljs-keyword">new</span> <span class="hljs-built_in">byte</span>[<span class="hljs-number">0x1000</span>]; <span class="hljs-comment">// 4KB</span>
    <span class="hljs-keyword">do</span> { ms.Write(buffer, <span class="hljs-number">0</span>, s.Read(buffer, <span class="hljs-number">0</span>, buffer.Length)); }
    <span class="hljs-keyword">while</span> (!s.IsMessageComplete);
    <span class="hljs-keyword">return</span> ms.ToArray();
}
</code></pre>
<hr>
<h3>โจ ูุนุงูโุณุงุฒ Message Mode</h3>
<p><strong>Server</strong>:</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> s = <span class="hljs-keyword">new</span> NamedPipeServerStream(
    <span class="hljs-string">&quot;pipedream&quot;</span>, PipeDirection.InOut, <span class="hljs-number">1</span>, PipeTransmissionMode.Message);

s.WaitForConnection();
<span class="hljs-built_in">byte</span>[] msg = Encoding.UTF8.GetBytes(<span class="hljs-string">&quot;Hello&quot;</span>);
s.Write(msg, <span class="hljs-number">0</span>, msg.Length);
Console.WriteLine(Encoding.UTF8.GetString(ReadMessage(s)));
</code></pre>
<p><strong>Client</strong>:</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> s = <span class="hljs-keyword">new</span> NamedPipeClientStream(<span class="hljs-string">&quot;pipedream&quot;</span>);
s.Connect();
s.ReadMode = PipeTransmissionMode.Message;

Console.WriteLine(Encoding.UTF8.GetString(ReadMessage(s)));
<span class="hljs-built_in">byte</span>[] msg = Encoding.UTF8.GetBytes(<span class="hljs-string">&quot;Hello right back!&quot;</span>);
s.Write(msg, <span class="hljs-number">0</span>, msg.Length);
</code></pre>
<p>โ๏ธ <strong>Message Mode ููุท ุฑู ููุฏูุฒ ูพุดุชุจุงู ูโุดูุฏ.</strong><br>
ุฏุฑ ุณุงุฑ ุณุณุชูโุนุงููโูุง โ <code>PlatformNotSupportedException</code> ูพุฑุชุงุจ ูโุดูุฏ.</p>
<hr>
<h3><strong>ูพุงูพโูุง ูุงุดูุงุณ (Anonymous pipes)</strong></h3>
<p>ฺฉ <strong>ูพุงูพ ูุงุดูุงุณ</strong> ฺฉ ุฌุฑุงู ุงุฑุชุจุงุท ฺฉโุทุฑูู ุจู ฺฉ <strong>ูพุฑุฏุงุฒุด ูุงูุฏ (parent process)</strong> ู ฺฉ <strong>ูพุฑุฏุงุฒุด ูุฑุฒูุฏ (child process)</strong> ูุฑุงูู ูโฺฉูุฏ. ุจูโุฌุง ุงุณุชูุงุฏู ุงุฒ ฺฉ ูุงู ุณุฑุงุณุฑ ุฏุฑ ุณุณุชูุ ูพุงูพโูุง ูุงุดูุงุณ ุงุฒ ุทุฑู ฺฉ <strong>ููุฏู ุฎุตูุต (private handle)</strong> ุจุง ูู ุงุฑุชุจุงุท ุจุฑูุฑุงุฑ ูโฺฉููุฏ.</p>
<p>ููุงููุฏ ูพุงูพโูุง ูุงูโุฏุงุฑุ ุฏุฑ ุงูุฌุง ูู ููุดโูุง ูุดุฎุต ุจุฑุง <strong>ฺฉูุงูุช</strong> ู <strong>ุณุฑูุฑ</strong> ูุฌูุฏ ุฏุงุฑุฏ. ุจุง ุงู ุญุงูุ ุดููโ ุงุฑุชุจุงุท ฺฉู ูุชูุงูุช ุงุณุช ู ุจูโุตูุฑุช ุฒุฑ ุงูุฌุงู ูโุดูุฏ:</p>
<ol>
<li>ุณุฑูุฑ ฺฉ <strong>AnonymousPipeServerStream</strong> ูโุณุงุฒุฏ ู ุจู ฺฉ <strong>PipeDirection</strong> (ุฌูุช In ุง Out) ูุชุนูุฏ ูโุดูุฏ.</li>
<li>ุณุฑูุฑ ูุชุฏ <strong>GetClientHandleAsString</strong> ุฑุง ุตุฏุง ูโุฒูุฏ ุชุง ฺฉ ุดูุงุณู ุจุฑุง ูพุงูพ ุจฺฏุฑุฏุ ุณูพุณ ุขู ุฑุง ุจู ฺฉูุงูุช ูโูุฑุณุชุฏ (ูุนูููุงู ุจูโุนููุงู ุขุฑฺฏููุงู ููฺฏุงู ุฑุงูโุงูุฏุงุฒ ูพุฑุฏุงุฒุด ูุฑุฒูุฏ).</li>
<li>ูพุฑุฏุงุฒุด ูุฑุฒูุฏ ฺฉ <strong>AnonymousPipeClientStream</strong> ูโุณุงุฒุฏ ู ุฌูุช ูุฎุงูู ุฑุง ูุดุฎุต ูโฺฉูุฏ.</li>
<li>ุณุฑูุฑ ููุฏู ูุญูโุง ฺฉู ุฏุฑ ูุฑุญููโ ฒ ุณุงุฎุชู ุดุฏู ุจูุฏ ุฑุง ุจุง ูุชุฏ <strong>DisposeLocalCopyOfClientHandle</strong> ุขุฒุงุฏ ูโฺฉูุฏ.</li>
<li>ุญุงูุง ูพุฑุฏุงุฒุด ูุงูุฏ ู ูุฑุฒูุฏ ูโุชูุงููุฏ ุงุฒ ุทุฑู ุฎูุงูุฏู/ููุดุชู ุงุณุชุฑู ุจุง ูู ุงุฑุชุจุงุท ุจุฑูุฑุงุฑ ฺฉููุฏ.</li>
</ol>
<p>ุงุฒ ุขูุฌุง ฺฉู ูพุงูพโูุง ูุงุดูุงุณ ฺฉโุทุฑูู ูุณุชูุฏุ ฺฉ ุณุฑูุฑ ุจุฑุง ุงุฑุชุจุงุท ุฏูุทุฑูู ุจุงุฏ <strong>ุฏู ูพุงูพ</strong> ุจุณุงุฒุฏ.</p>
<p>ฺฉุฏ ุฒุฑ ูุดุงู ูโุฏูุฏ ฺฉู ฺุทูุฑ ุฏู ูพุงูพ (ูุฑูุฏ ู ุฎุฑูุฌ) ุณุงุฎุชู ูโุดููุฏ ู ุณูพุณ ฺฉ ูพุฑุฏุงุฒุด ูุฑุฒูุฏ ุฑุงูโุงูุฏุงุฒ ูโุดูุฏ. ุฏุฑ ุงุฏุงููุ ฺฉ ุจุงุช ุงุฒ ุณุฑูุฑ ุจู ูุฑุฒูุฏ ุงุฑุณุงู ุดุฏู ู ฺฉ ุจุงุช ุฏุฑ ูพุงุณุฎ ุฏุฑุงูุช ูโุดูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
{
  <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span> (<span class="hljs-params"><span class="hljs-built_in">string</span>[] <span class="hljs-keyword">args</span></span>)</span>
  {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">args</span>.Length == <span class="hljs-number">0</span>)
      <span class="hljs-comment">// ุจุฏูู ุขุฑฺฏููุงู = ุญุงูุช ุณุฑูุฑ</span>
      AnonymousPipeServer();
    <span class="hljs-keyword">else</span>
      <span class="hljs-comment">// ุขุฑฺฏููุงูโูุง = ุดูุงุณูโูุง ูพุงูพ ุจุฑุง ุญุงูุช ฺฉูุงูุช</span>
      AnonymousPipeClient (<span class="hljs-keyword">args</span> [<span class="hljs-number">0</span>], <span class="hljs-keyword">args</span> [<span class="hljs-number">1</span>]);
  }

  <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">AnonymousPipeClient</span> (<span class="hljs-params"><span class="hljs-built_in">string</span> rxID, <span class="hljs-built_in">string</span> txID</span>)</span>
  {
    <span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> rx = <span class="hljs-keyword">new</span> AnonymousPipeClientStream (PipeDirection.In, rxID);
    <span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> tx = <span class="hljs-keyword">new</span> AnonymousPipeClientStream (PipeDirection.Out, txID);
    Console.WriteLine (<span class="hljs-string">&quot;Client received: &quot;</span> + rx.ReadByte ());
    tx.WriteByte (<span class="hljs-number">200</span>);
  }

  <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">AnonymousPipeServer</span> ()</span>
  {
    <span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> tx = <span class="hljs-keyword">new</span> AnonymousPipeServerStream (
                     PipeDirection.Out, HandleInheritability.Inheritable);
    <span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> rx = <span class="hljs-keyword">new</span> AnonymousPipeServerStream (
                     PipeDirection.In, HandleInheritability.Inheritable);

    <span class="hljs-built_in">string</span> txID = tx.GetClientHandleAsString ();
    <span class="hljs-built_in">string</span> rxID = rx.GetClientHandleAsString ();

    <span class="hljs-comment">// ุงุฌุงุฏ ู ุฑุงูโุงูุฏุงุฒ ูพุฑุฏุงุฒุด ูุฑุฒูุฏ</span>
    <span class="hljs-built_in">string</span> thisAssembly = Assembly.GetEntryAssembly().Location;
    <span class="hljs-built_in">string</span> thisExe = Path.ChangeExtension (thisAssembly, <span class="hljs-string">&quot;.exe&quot;</span>);
    <span class="hljs-keyword">var</span> <span class="hljs-keyword">args</span> = <span class="hljs-string">$&quot;<span class="hljs-subst">{txID}</span> <span class="hljs-subst">{rxID}</span>&quot;</span>;
    <span class="hljs-keyword">var</span> startInfo = <span class="hljs-keyword">new</span> ProcessStartInfo (thisExe, <span class="hljs-keyword">args</span>);
    startInfo.UseShellExecute = <span class="hljs-literal">false</span>;   <span class="hljs-comment">// ุงูุฒุงู ุจุฑุง ูพุฑุฏุงุฒุด ูุฑุฒูุฏ</span>
    Process p = Process.Start (startInfo);

    tx.DisposeLocalCopyOfClientHandle ();  <span class="hljs-comment">// ุขุฒุงุฏุณุงุฒ ููุงุจุน</span>
    rx.DisposeLocalCopyOfClientHandle ();

    tx.WriteByte (<span class="hljs-number">100</span>);    <span class="hljs-comment">// ุงุฑุณุงู ฺฉ ุจุงุช ุจู ูพุฑุฏุงุฒุด ูุฑุฒูุฏ</span>
    Console.WriteLine (<span class="hljs-string">&quot;Server received: &quot;</span> + rx.ReadByte ());
    p.WaitForExit ();
  }
}
</code></pre>
<p>๐ ููุงููุฏ ูพุงูพโูุง ูุงูโุฏุงุฑุ <strong>ฺฉูุงูุช ู ุณุฑูุฑ ุจุงุฏ ุงุฑุณุงู ู ุฏุฑุงูุช ุฎูุฏ ุฑุง ููุงููฺฏ ฺฉููุฏ</strong> ู ุฑู ุทูู ูุฑ ุงูุชูุงู ุชูุงูู ุฏุงุดุชู ุจุงุดูุฏ. ูุชุฃุณูุงูู ูพุงูพโูุง ูุงุดูุงุณ ุงุฒ <strong>ุญุงูุช ูพุงู (message mode)</strong> ูพุดุชุจุงู ููโฺฉููุฏุ ุจูุงุจุฑุงู ุจุงุฏ ุฎูุฏุชุงู ูพุฑูุชฺฉู ูุฏุฑุช ุทูู ูพุงู ุฑุง ูพุงุฏูโุณุงุฒ ฺฉูุฏ.</p>
<p>ฺฉ ุงุฒ ุฑุงูโุญูโูุง ุงู ุงุณุช ฺฉู ุฏุฑ ฺูุงุฑ ุจุงุช ุงูู ูุฑ ุงูุชูุงูุ ฺฉ <strong>ุนุฏุฏ ุตุญุญ (integer)</strong> ุงุฑุณุงู ุดูุฏ ฺฉู ุทูู ูพุงู ุจุนุฏ ุฑุง ูุดุฎุต ฺฉูุฏ. ฺฉูุงุณ <strong>BitConverter</strong> ูุชุฏูุง ุจุฑุง ุชุจุฏู ุจู ฺฉ ุนุฏุฏ ุตุญุญ ู ฺฉ ุขุฑุงูโ ด ุจุงุช ูุฑุงูู ูโฺฉูุฏ.</p>
<div align="center">
<p><img src="../../../assets/image/15/Table-15-5.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<hr>
<h3><strong>BufferedStream (ุงุณุชุฑู ุจุงูุฑ ุดุฏู)</strong></h3>
<p>ุจุงูุฑูฺฏ ุจุงุนุซ ุจูุจูุฏ ฺฉุงุฑุง ูโุดูุฏ ฺูู ุชุนุฏุงุฏ ุฏูุนุงุช ุฑูุชโูุจุฑฺฏุดุช ุจู <strong>backing store</strong> (ูุซู ูุงู ุง ุดุจฺฉู) ุฑุง ฺฉุงูุด ูโุฏูุฏ.</p>
<p>ุฏุฑ ูุซุงู ุฒุฑ ูุง ฺฉ <strong>FileStream</strong> ุฑุง ุฏุงุฎู ฺฉ <strong>BufferedStream</strong> ุจุง ุงูุฏุงุฒูโ ุจุงูุฑ ฒฐ ฺฉููุจุงุช ูโูพฺู:</p>
<pre class="hljs"><code><span class="hljs-comment">// ููุดุชู 100K ุฏุฑ ฺฉ ูุงู:</span>
File.WriteAllBytes (<span class="hljs-string">&quot;myFile.bin&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-built_in">byte</span> [<span class="hljs-number">100000</span>]);
<span class="hljs-keyword">using</span> FileStream fs = File.OpenRead (<span class="hljs-string">&quot;myFile.bin&quot;</span>);
<span class="hljs-keyword">using</span> BufferedStream bs = <span class="hljs-keyword">new</span> BufferedStream (fs, <span class="hljs-number">20000</span>);  <span class="hljs-comment">// ุจุงูุฑ 20K</span>
bs.ReadByte();
Console.WriteLine (fs.Position);   <span class="hljs-comment">// 20000</span>
</code></pre>
<p>๐ ุฏุฑ ุงู ูุซุงูุ ุงุณุชุฑู ุฒุฑู (<strong>FileStream</strong>) ุจุนุฏ ุงุฒ ุฎูุงูุฏู ููุท <strong>ฺฉ ุจุงุช</strong>ุ ุจู ุงูุฏุงุฒูโ ฒฐ,ฐฐฐ ุจุงุช ุฌูู ูโุฑูุฏุ ุงู ุจู ุฎุงุทุฑ <strong>read-ahead buffering</strong> ุงุณุช. ูุง ูโุชูุงูู ูุชุฏ <code>ReadByte</code> ุฑุง <strong>ฑน,นนน ุจุงุฑ ุฏฺฏุฑ</strong> ุตุฏุง ุจุฒููุ ุจุฏูู ุงูฺฉู ุฏูุจุงุฑู <code>FileStream</code> ุฏุฑฺฏุฑ ุดูุฏ.</p>
<p>โ ุฏุฑ ุนููุ ุจุณุชู ฺฉ <strong>BufferedStream</strong> ุจู ุทูุฑ ุฎูุฏฺฉุงุฑ ุงุณุชุฑู backing store ุฒุฑู ุฑุง ูู ูโุจูุฏุฏ.</p>
<p>โ๏ธ ุชุฑฺฉุจ <strong>BufferedStream</strong> ุจุง <strong>FileStream</strong> (ูุซู ุงู ูุซุงู) ุงุฑุฒุด ูุญุฏูุฏ ุฏุงุฑุฏุ ฺูู <strong>FileStream ุฎูุฏุด ุจุงูุฑ ุฏุงุฎู ุฏุงุฑุฏ</strong>. ุชููุง ฺฉุงุฑุจุฑุฏ ุขู ูโุชูุงูุฏ ุฒูุงู ุจุงุดุฏ ฺฉู ุจุฎูุงูู ุจุงูุฑ ฺฉ <strong>FileStream</strong> ุณุงุฎุชูโุดุฏู ุฑุง <strong>ุจุฒุฑฺฏโุชุฑ ฺฉูู</strong>.</p>
<hr>
<h3><strong>Stream Adapters (ุขุฏุงูพุชูุฑูุง ุงุณุชุฑู)</strong></h3>
<p>ุงุฒ ุขูุฌุง ฺฉู <strong>Stream ููุท ุจุง ุจุงุชโูุง ุณุฑูฺฉุงุฑ ุฏุงุฑุฏ</strong>ุ ุจุฑุง ุฎูุงูุฏู ุง ููุดุชู ุฏุงุฏูโูุง ูุซู <strong>ุฑุดุชูโูุง (string)</strong>ุ <strong>ุงุนุฏุงุฏ ุตุญุญ (int)</strong> ุง <strong>ุนูุงุตุฑ XML</strong> ุจุงุฏ ุงุฒ <strong>adapter</strong> ุงุณุชูุงุฏู ฺฉูุฏ.</p>
<p>๐ .NET ุขุฏุงูพุชูุฑูุง ุฒุฑ ุฑุง ูุฑุงูู ฺฉุฑุฏู ุงุณุช:</p>
<ul>
<li>
<p><strong>ุขุฏุงูพุชูุฑูุง ูุชู (ุจุฑุง ุฏุงุฏูโูุง ุฑุดุชู ู ฺฉุงุฑุงฺฉุชุฑ):</strong></p>
<ul>
<li><code>TextReader</code>, <code>TextWriter</code></li>
<li><code>StreamReader</code>, <code>StreamWriter</code></li>
<li><code>StringReader</code>, <code>StringWriter</code></li>
</ul>
</li>
<li>
<p><strong>ุขุฏุงูพุชูุฑูุง ุจุงูุฑ (ุจุฑุง ุงููุงุน ุฏุงุฏูโูุง ุงููู ูุซู int, bool, string, float):</strong></p>
<ul>
<li><code>BinaryReader</code>, <code>BinaryWriter</code></li>
</ul>
</li>
<li>
<p><strong>ุขุฏุงูพุชูุฑูุง XML (ูพูุดุด ุฏุงุฏูโุดุฏู ุฏุฑ ูุตู 11):</strong></p>
<ul>
<li><code>XmlReader</code>, <code>XmlWriter</code></li>
</ul>
</li>
</ul>
<p>๐ ุดฺฉู 15-5 ุฑูุงุจุท ุจู ุงู ููุนโูุง ุฑุง ูุดุงู ูโุฏูุฏ.</p>
<div align="center">
<p><img src="../../../assets/image/15/Table-15-6.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3><strong>ุขุฏุงูพุชูุฑูุง ูุชู (Text Adapters)</strong></h3>
<p><code>TextReader</code> ู <code>TextWriter</code> ฺฉูุงุณโูุง ูพุงูโ ุงูุชุฒุงุน ูุณุชูุฏ ฺฉู ูุฎุตูุต ฺฉุงุฑ ุจุง <strong>ฺฉุงุฑุงฺฉุชุฑูุง</strong> ู <strong>ุฑุดุชูโูุง</strong> ุทุฑุงุญ ุดุฏูโุงูุฏ. ูุฑ ฺฉุฏุงู ุฏุฑ .NET ุฏู ูพุงุฏูโุณุงุฒ ุนููู ุฏุงุฑูุฏ:</p>
<ul>
<li>
<p><strong><code>StreamReader</code> / <code>StreamWriter</code></strong><br>
ุงุฒ ฺฉ <strong>Stream</strong> ุจูโุนููุงู ููุจุน ุฏุงุฏูโ ุฎุงู ุงุณุชูุงุฏู ูโฺฉููุฏ ู ุจุงุชโูุง ุงุณุชุฑู ุฑุง ุจู ฺฉุงุฑุงฺฉุชุฑูุง ุง ุฑุดุชูโูุง ุชุจุฏู ูโฺฉููุฏ.</p>
</li>
<li>
<p><strong><code>StringReader</code> / <code>StringWriter</code></strong><br>
<code>TextReader</code> / <code>TextWriter</code> ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ <strong>ุฑุดุชูโูุง ุฏุฑูู ุญุงูุธู</strong> ูพุงุฏูโุณุงุฒ ูโฺฉููุฏ.</p>
</li>
</ul>
<p>๐ <strong>ุฌุฏูู 15-2</strong> ุงุนุถุง <code>TextReader</code> ุฑุง ุจุฑ ุงุณุงุณ ุฏุณุชูโุจูุฏ ูุดุงู ูโุฏูุฏ.</p>
<ul>
<li>
<p>ูุชุฏ <code>Peek</code> ฺฉุงุฑุงฺฉุชุฑ ุจุนุฏ ุฏุฑ ุงุณุชุฑู ุฑุง <strong>ุจุฑูโฺฏุฑุฏุงูุฏ ุจุฏูู ุงูฺฉู ูููุนุช ุฑุง ุฌูู ุจุจุฑุฏ</strong>.</p>
</li>
<li>
<p>ูู <code>Peek</code> ู ูู ูุณุฎูโ ุจุฏูู ูพุงุฑุงูุชุฑ <code>Read</code> ููุฏุงุฑ <strong>-1</strong> ุฑุง ุจุฑูโฺฏุฑุฏุงููุฏ ุงฺฏุฑ ุจู ุงูุชูุง ุงุณุชุฑู ุฑุณุฏู ุจุงุดูุฏุ ุฏุฑ ุบุฑ ุงู ุตูุฑุช ฺฉ <strong>ุนุฏุฏ ุตุญุญ (int)</strong> ุจุฑูโฺฏุฑุฏุงููุฏ ฺฉู ูโุชูุงู ุขู ุฑุง ูุณุชูู ุจู <code>char</code> ุชุจุฏู ฺฉุฑุฏ.</p>
</li>
<li>
<p>ูุณุฎูโ overload ุดุฏูโ <code>Read</code> ฺฉู ฺฉ <code>char[] buffer</code> ูโฺฏุฑุฏุ ุฏููุงู ูุดุงุจู ูุชุฏ <code>ReadBlock</code> ุนูู ูโฺฉูุฏ.</p>
</li>
<li>
<p>ูุชุฏ <code>ReadLine</code> ูโุฎูุงูุฏ ุชุง ุฒูุงู ฺฉู ุจู ฺฉ ุงุฒ ุงูโูุง ุจุฑุณุฏ:</p>
<ul>
<li><strong>CR</strong> (ฺฉุฏ ฺฉุงุฑุงฺฉุชุฑ 13)</li>
<li><strong>LF</strong> (ฺฉุฏ ฺฉุงุฑุงฺฉุชุฑ 10)</li>
<li>ุง ุชุฑฺฉุจ <strong>CR+LF</strong><br>
ุณูพุณ ฺฉ <strong>ุฑุดุชู (string)</strong> ุจุฑูโฺฏุฑุฏุงูุฏ ู ฺฉุงุฑุงฺฉุชุฑูุง CR/LF ุฑุง ุญุฐู ูโฺฉูุฏ.</li>
</ul>
</li>
</ul>
<div align="center">
<p><img src="../../../assets/image/15/Table-15-7.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p><code>Environment.NewLine</code> ุฏูุจุงููโ <strong>new-line</strong> ููุงุณุจ ุจุฑุง ุณุณุชูโุนุงูู ูุนู ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ.</p>
<ul>
<li>ุฏุฑ <strong>ููุฏูุฒ</strong>ุ ุงู ููุฏุงุฑ <code>&quot;\r\n&quot;</code> ุงุณุช (ุจู ุงุฏ โReturNโ ุจูุชุฏ) ู ุจู ุตูุฑุช ุชูุฑุจ ุดุจู ฺฉ ูุงุดู ุชุญุฑุฑ ูฺฉุงูฺฉ ูุฏู ุดุฏู: ุงุจุชุฏุง <strong>CR</strong> (ฺฉุงุฑุงฺฉุชุฑ ฑณ) ู ุณูพุณ <strong>LF</strong> (ฺฉุงุฑุงฺฉุชุฑ ฑฐ). ุงฺฏุฑ ุชุฑุชุจ ุฑุง ุจุฑุนฺฉุณ ฺฉูุฏุ ุง ุฏู ุฎุท ุฌุฏุฏ ุฎูุงูุฏ ุฏุงุดุช ุง ูฺ!</li>
<li>ุฏุฑ <strong>Unix</strong> ู <strong>macOS</strong>ุ ููุฏุงุฑ ุชููุง <code>&quot;\n&quot;</code> ุงุณุช.</li>
</ul>
<p><code>TextWriter</code> ูุชุฏูุง ูุดุงุจู ุจุฑุง ููุดุชู ุฏุงุฑุฏุ ููุงูโุทูุฑ ฺฉู ุฏุฑ <strong>ุฌุฏูู 15-3</strong> ูุดุงู ุฏุงุฏู ุดุฏู ุงุณุช. ูุชุฏูุง <code>Write</code> ู <code>WriteLine</code> ููฺูู <strong>overload</strong> ุดุฏูโุงูุฏ ุชุง ูููโ ููุนโูุง ุงููู ู ููุน <strong>object</strong> ุฑุง ูุจูู ฺฉููุฏ. ุงู ูุชุฏูุง ุตุฑูุงู ูุชุฏ <code>ToString</code> ุฑุง ุฑู ููุฏุงุฑ ฺฉู ุฏุงุฏู ุดุฏู ุตุฏุง ูโุฒููุฏ (ุงุฎุชุงุฑ ุงุฒ ุทุฑู ฺฉ <code>IFormatProvider</code> ฺฉู ููฺฏุงู ุตุฏุง ุฒุฏู ูุชุฏ ุง ููฺฏุงู ุณุงุฎุช <code>TextWriter</code> ูุดุฎุต ุดุฏู ุจุงุดุฏ).</p>
<div align="center">
<p><img src="../../../assets/image/15/Table-15-8.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ูุชุฏ <code>WriteLine</code> ุจูโุณุงุฏฺฏ ูุชู ุฏุงุฏูโุดุฏู ุฑุง ุจุง <code>Environment.NewLine</code> ุงูุญุงู ูโฺฉูุฏ. ูโุชูุงูุฏ ุงู ุฑูุชุงุฑ ุฑุง ุงุฒ ุทุฑู <strong>ุฎุงุตุช <code>NewLine</code></strong> ุชุบุฑ ุฏูุฏ (ุงู ูโุชูุงูุฏ ุจุฑุง <strong>ุชุทุจู ุจุง ูุฑูุชโูุง ูุงู Unix</strong> ููุฏ ุจุงุดุฏ).</p>
<p>ููุงููุฏ <code>Stream</code>ุ ฺฉูุงุณโูุง <code>TextReader</code> ู <code>TextWriter</code> ูุณุฎูโูุง <strong>ุขุณูฺฉุฑูู ูุจุชู ุจุฑ Task</strong> ุงุฒ ูุชุฏูุง ุฎูุงูุฏู ู ููุดุชู ุฎูุฏ ุฑุง ุงุฑุงุฆู ูโุฏููุฏ.</p>
<h3>StreamReader ู StreamWriter ๐โ๏ธ</h3>
<p>ุฏุฑ ูุซุงู ุฒุฑุ ฺฉ <code>StreamWriter</code> ุฏู ุฎุท ูุชู ุฑุง ุฏุฑ ฺฉ ูุงู ูโููุณุฏ ู ุณูพุณ ฺฉ <code>StreamReader</code> ูุงู ุฑุง ุฏูุจุงุฑู ูโุฎูุงูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> (FileStream fs = File.Create(<span class="hljs-string">&quot;test.txt&quot;</span>))
<span class="hljs-keyword">using</span> (TextWriter writer = <span class="hljs-keyword">new</span> StreamWriter(fs))
{
    writer.WriteLine(<span class="hljs-string">&quot;Line1&quot;</span>);
    writer.WriteLine(<span class="hljs-string">&quot;Line2&quot;</span>);
}
<span class="hljs-keyword">using</span> (FileStream fs = File.OpenRead(<span class="hljs-string">&quot;test.txt&quot;</span>))
<span class="hljs-keyword">using</span> (TextReader reader = <span class="hljs-keyword">new</span> StreamReader(fs))
{
    Console.WriteLine(reader.ReadLine()); <span class="hljs-comment">// Line1</span>
    Console.WriteLine(reader.ReadLine()); <span class="hljs-comment">// Line2</span>
}
</code></pre>
<p>ฺูู <strong>Text adapters</strong> ุงุบูุจ ููุฑุงู ุจุง ูุงูโูุง ุงุณุชูุงุฏู ูโุดููุฏุ ฺฉูุงุณ <code>File</code> ูุชุฏูุง <strong>ุงุณุชุงุชฺฉ</strong> <code>CreateText</code>ุ <code>AppendText</code> ู <code>OpenText</code> ุฑุง ุจุฑุง ฺฉูุชุงู ฺฉุฑุฏู ุฑููุฏ ูุฑุงูู ูโฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> (TextWriter writer = File.CreateText(<span class="hljs-string">&quot;test.txt&quot;</span>))
{
    writer.WriteLine(<span class="hljs-string">&quot;Line1&quot;</span>);
    writer.WriteLine(<span class="hljs-string">&quot;Line2&quot;</span>);
}
<span class="hljs-keyword">using</span> (TextWriter writer = File.AppendText(<span class="hljs-string">&quot;test.txt&quot;</span>))
    writer.WriteLine(<span class="hljs-string">&quot;Line3&quot;</span>);

<span class="hljs-keyword">using</span> (TextReader reader = File.OpenText(<span class="hljs-string">&quot;test.txt&quot;</span>))
    <span class="hljs-keyword">while</span> (reader.Peek() &gt; <span class="hljs-number">-1</span>)
        Console.WriteLine(reader.ReadLine()); <span class="hljs-comment">// Line1, Line2, Line3</span>
</code></pre>
<p>ุงู ูุซุงู ููฺูู ูุดุงู ูโุฏูุฏ ฺฉู ฺฺฏููู ูพุงุงู ูุงู ุฑุง ุจุฑุฑุณ ฺฉูู (<code>reader.Peek()</code>). ุฑูุด ุฏฺฏุฑ ุงู ุงุณุช ฺฉู ุชุง ููุช <code>reader.ReadLine</code> ููุฏุงุฑ <code>null</code> ุจุฑฺฏุฑุฏุงูุฏุ ุงุฏุงูู ุฏูู.</p>
<p>ูโุชูุงูุฏ ุงููุงุน ุฏฺฏุฑ ูุงููุฏ <strong>ุงุนุฏุงุฏ ุตุญุญ</strong> ุฑุง ูุฒ ุจุฎูุงูุฏ ู ุจููุณุฏุ ุงูุง ฺูู <code>TextWriter</code> ูุชุฏ <code>ToString</code> ุฑุง ุฑู ููุน ุดูุง ุตุฏุง ูโุฒูุฏุ ููฺฏุงู ุฎูุงูุฏู ุจุงุฏ ุฑุดุชู ุฑุง <strong>Parse</strong> ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> (TextWriter w = File.CreateText(<span class="hljs-string">&quot;data.txt&quot;</span>))
{
    w.WriteLine(<span class="hljs-number">123</span>);      <span class="hljs-comment">// ูโููุณุฏ &quot;123&quot;</span>
    w.WriteLine(<span class="hljs-literal">true</span>);     <span class="hljs-comment">// ูโููุณุฏ &quot;true&quot;</span>
}
<span class="hljs-keyword">using</span> (TextReader r = File.OpenText(<span class="hljs-string">&quot;data.txt&quot;</span>))
{
    <span class="hljs-built_in">int</span> myInt = <span class="hljs-built_in">int</span>.Parse(r.ReadLine());   <span class="hljs-comment">// myInt == 123</span>
    <span class="hljs-built_in">bool</span> yes = <span class="hljs-built_in">bool</span>.Parse(r.ReadLine());   <span class="hljs-comment">// yes == true</span>
}
</code></pre>
<h3>ุฑูุฒฺฏุฐุงุฑ ฺฉุงุฑุงฺฉุชุฑูุง ๐ค</h3>
<p><code>TextReader</code> ู <code>TextWriter</code> ุฎูุฏุดุงู ุชููุง ฺฉูุงุณโูุง <strong>abstract</strong> ูุณุชูุฏ ู ุงุฑุชุจุงุท ุจุง ฺฉ <strong>stream</strong> ุง <strong>backing store</strong> ูุฏุงุฑูุฏ. ุงูุง <code>StreamReader</code> ู <code>StreamWriter</code> ุจู ฺฉ <strong>stream ุจุงุชโูุญูุฑ</strong> ูุชุตูโุงูุฏ ู ุจุงุฏ ุจู <strong>ฺฉุงุฑุงฺฉุชุฑูุง ู ุจุงุชโูุง</strong> ุชุจุฏู ุงูุฌุงู ุฏููุฏ. ุงู ฺฉุงุฑ ุงุฒ ุทุฑู ฺฉูุงุณ <code>Encoding</code> ุฏุฑ <strong>System.Text</strong> ุงูุฌุงู ูโุดูุฏ ฺฉู ููฺฏุงู ุณุงุฎุช <code>StreamReader</code> ุง <code>StreamWriter</code> ุงูุชุฎุงุจ ูโฺฉูุฏ. ุงฺฏุฑ ฺุฒ ุงูุชุฎุงุจ ูฺฉูุฏุ <strong>UTF-8</strong> ูพุดโูุฑุถ ุงุณุชูุงุฏู ูโุดูุฏ.</p>
<p>ุงฺฏุฑ ุจูโุทูุฑ ุตุฑุญ ฺฉ <strong>Encoding</strong> ูุดุฎุต ฺฉูุฏุ <code>StreamWriter</code> ุจูโุทูุฑ ูพุดโูุฑุถ ฺฉ ูพุดโููุฏ (prefix) ุจุฑุง ุดูุงุณุง ุฑูุฒฺฏุฐุงุฑ ุจู ุงุจุชุฏุง ุฌุฑุงู ูโููุณุฏ. ุงู ูุนูููุงู ูุงุฎูุงุณุชู ุงุณุช ู ูโุชูุงูุฏ ุจุง ุณุงุฎุช Encoding ุจู ุดฺฉู ุฒุฑ ุงุฒ ุขู ุฌููฺฏุฑ ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> encoding = <span class="hljs-keyword">new</span> UTF8Encoding(
    encoderShouldEmitUTF8Identifier: <span class="hljs-literal">false</span>,
    throwOnInvalidBytes: <span class="hljs-literal">true</span>
);
</code></pre>
<p>ุขุฑฺฏููุงู ุฏูู ุจู <code>StreamWriter</code> ุง <code>StreamReader</code> ูโฺฏูุฏ ุงฺฏุฑ ุจุง ุจุงุชโูุง ููุงุฌู ุดุฏ ฺฉู ุชุฑุฌูู ูุนุชุจุฑ ุจู ุฑุดุชู ูุฏุงุฑูุฏุ <strong>Exception</strong> ูพุฑุชุงุจ ฺฉูุฏุ ฺฉู ุจุง ุฑูุชุงุฑ ูพุดโูุฑุถ ูุทุงุจูุช ุฏุงุฑุฏ.</p>
<h3>ูุซุงู ุฑูุฒฺฏุฐุงุฑ ASCII ู UTF-8</h3>
<p>ุฑูุฒฺฏุฐุงุฑ ุณุงุฏู <code>ASCII</code> ุงุณุชุ ฺูู ูุฑ ฺฉุงุฑุงฺฉุชุฑ ุจุง ฺฉ ุจุงุช ููุงุด ุฏุงุฏู ูโุดูุฏ. ฺฉุงุฑุงฺฉุชุฑูุง ุบุฑุงูฺฏูุณ ุง ููุงุฏูุง ูฺู ูุงุจู ููุงุด ูุณุชูุฏ ู ุจู <code>โก</code> ุชุจุฏู ูโุดููุฏ.</p>
<p>ุฑูุฒฺฏุฐุงุฑ ูพุดโูุฑุถ <code>UTF-8</code> ูโุชูุงูุฏ ุชูุงู ฺฉุงุฑุงฺฉุชุฑูุง ููฺฉุฏ ุฑุง ููุงุด ุฏูุฏ. ฺฉุงุฑุงฺฉุชุฑูุง ASCII (127 ฺฉุงุฑุงฺฉุชุฑ ุงูู) ุจุง ฺฉ ุจุงุช ฺฉุฏฺฏุฐุงุฑ ูโุดููุฏุ ุจูู ฺฉุงุฑุงฺฉุชุฑูุง ุจุง ุชุนุฏุงุฏ ุจุงุช ูุชุบุฑ (ูุนูููุงู ุฏู ุง ุณู) ฺฉุฏฺฏุฐุงุฑ ูโุดููุฏ. ูุซุงู:</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> (TextWriter w = File.CreateText(<span class="hljs-string">&quot;but.txt&quot;</span>)) <span class="hljs-comment">// ุงุณุชูุงุฏู ุงุฒ UTF-8 ูพุดโูุฑุถ</span>
    w.WriteLine(<span class="hljs-string">&quot;but-&quot;</span>);

<span class="hljs-keyword">using</span> (Stream s = File.OpenRead(<span class="hljs-string">&quot;but.txt&quot;</span>))
    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> b; (b = s.ReadByte()) &gt; <span class="hljs-number">-1</span>;)
        Console.WriteLine(b);
</code></pre>
<p>ุจุฑุง ฺฉุงุฑุงฺฉุชุฑ <strong>em dash (โ)</strong> ฺฉู ุฎุงุฑุฌ ุงุฒ 127 ฺฉุงุฑุงฺฉุชุฑ ุงูู ููฺฉุฏ ุงุณุชุ UTF-8 ุณู ุจุงุช ุงุณุชูุงุฏู ูโฺฉูุฏ.</p>
<h3>UTF-16</h3>
<p>UTF-16 ุงุฒ ุฏู ุง ฺูุงุฑ ุจุงุช ุจุฑุง ูุฑ ฺฉุงุฑุงฺฉุชุฑ ุงุณุชูุงุฏู ูโฺฉูุฏ. ููุน <code>char</code> ุฏุฑ C# ููุท 16 ุจุช ุงุณุชุ ูพุณ UTF-16 ุฏููุงู ุฏู ุจุงุช ุจุฑุง ูุฑ char ุงุณุชูุงุฏู ูโฺฉูุฏ. ุงู ุงูฺฉุงู ูพุฑุด ุจู ุงูุฏฺฉุณ ฺฉุงุฑุงฺฉุชุฑ ูุดุฎุต ุฏุฑ stream ุฑุง ุขุณุงู ูโฺฉูุฏ.</p>
<p>UTF-16 ุงุฒ ฺฉ ูพุดโููุฏ ุฏู ุจุงุช ุจุฑุง ูุดุฎุต ฺฉุฑุฏู <strong>little-endian</strong> ุง <strong>big-endian</strong> ุงุณุชูุงุฏู ูโฺฉูุฏ. ุชุฑุชุจ ูพุดโูุฑุถ little-endian ุจุฑุง ุณุณุชูโูุง ูุจุชู ุจุฑ ููุฏูุฒ ุงุณุชุงูุฏุงุฑุฏ ุงุณุช.</p>
<h3>StringReader ู StringWriter</h3>
<p>ุงูโูุง <strong>stream</strong> ุฑุง wrap ููโฺฉููุฏ ู ุงุฒ ฺฉ <strong>string</strong> ุง <strong>StringBuilder</strong> ุจูโุนููุงู ููุจุน ุฏุงุฏู ุงุณุชูุงุฏู ูโฺฉููุฏ. ุจูุงุจุฑุงู ูุงุฒ ุจู ุชุฑุฌูู ุจุงุช ูุณุช ู ฺฉูุงุณโูุง ุชููุง ุจุฑ ุงุณุงุณ ููุงู ุฑูุชุงุฑ ูพุงู <code>StreamReader/StreamWriter</code> ุนูู ูโฺฉููุฏ.</p>
<p>ูุซุงู: ุงฺฏุฑ ุจุฎูุงูุฏ ฺฉ ุฑุดุชู ุญุงู XML ุฑุง ุจุง <code>XmlReader</code> ุชุฌุฒู ฺฉูุฏ:</p>
<pre class="hljs"><code>XmlReader r = XmlReader.Create(<span class="hljs-keyword">new</span> StringReader(myString));
</code></pre>
<h3>Binary Adapters ๐พ</h3>
<p><code>BinaryReader</code> ู <code>BinaryWriter</code> ุฏุงุฏูโูุง native ูุงููุฏ <code>bool</code>ุ <code>byte</code>ุ <code>int</code>ุ <code>double</code>ุ <code>string</code> ู ุขุฑุงูโูุง ููุนโูุง ุงููู ุฑุง ูโุฎูุงููุฏ ู ูโููุณูุฏ.<br>
ุจุฑ ุฎูุงู <code>StreamReader/StreamWriter</code>ุ binary adapters ุฏุงุฏูโูุง ุฑุง ุจูโุตูุฑุช <strong>ููุซุฑ ุฏุฑ ุญุงูุธู</strong> ุฐุฎุฑู ูโฺฉููุฏ.</p>
<p>ูุซุงู ุชุนุฑู ฺฉูุงุณ ุณุงุฏู ู ุฐุฎุฑู/ุจุงุฑฺฏุฐุงุฑ ุจุง binary adapters:</p>
<pre class="hljs"><code><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Person</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Name;
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> Age;
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">double</span> Height;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SaveData</span>(<span class="hljs-params">Stream s</span>)</span>
    {
        <span class="hljs-keyword">var</span> w = <span class="hljs-keyword">new</span> BinaryWriter(s);
        w.Write(Name);
        w.Write(Age);
        w.Write(Height);
        w.Flush(); <span class="hljs-comment">// ุงุทููุงู ุงุฒ ุฎุงู ุดุฏู ุจุงูุฑ</span>
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">LoadData</span>(<span class="hljs-params">Stream s</span>)</span>
    {
        <span class="hljs-keyword">var</span> r = <span class="hljs-keyword">new</span> BinaryReader(s);
        Name = r.ReadString();
        Age = r.ReadInt32();
        Height = r.ReadDouble();
    }
}
</code></pre>
<p>ููฺูู ูโุชูุงู ุจุง <code>BinaryReader</code> ฺฉู ูุญุชูุง ฺฉ <strong>stream seekable</strong> ุฑุง ุจู ุขุฑุงู ุจุงุช ุฎูุงูุฏ:</p>
<pre class="hljs"><code><span class="hljs-built_in">byte</span>[] data = <span class="hljs-keyword">new</span> BinaryReader(s).ReadBytes((<span class="hljs-built_in">int</span>)s.Length);
</code></pre>
<p>ุงู ุฑูุด ุฑุงุญุชโุชุฑ ุงุฒ ุฎูุงูุฏู ูุณุชูู ุงุฒ stream ุงุณุชุ ฺูู ูุงุฒ ุจู loop ุจุฑุง ุงุทููุงู ุงุฒ ุฎูุงูุฏู ุชูุงู ุฏุงุฏูโูุง ูุฏุงุฑุฏ.</p>
<h3>ุจุณุชู ู ุขุฒุงุฏุณุงุฒ Stream Adapters ๐</h3>
<p>ุจุฑุง <strong>ุชุฎุฑุจ (tear down)</strong> stream adaptersุ ฺูุงุฑ ฺฏุฒูู ุฏุงุฑุฏ:</p>
<ol>
<li>ููุท adapter ุฑุง ุจุจูุฏุฏ.</li>
<li>adapter ุฑุง ุจุจูุฏุฏ ู ุณูพุณ stream ุฑุง ุจุจูุฏุฏ.</li>
<li>(ุจุฑุง writers) adapter ุฑุง Flush ฺฉุฑุฏู ู ุณูพุณ stream ุฑุง ุจุจูุฏุฏ.</li>
<li>(ุจุฑุง readers) ููุท stream ุฑุง ุจุจูุฏุฏ.</li>
</ol>
<p>ุฏุฑ adaptersุ ูุชุฏูุง <code>Close</code> ู <code>Dispose</code> <strong>ููโูุนู</strong> ูุณุชูุฏุ ููุงููุฏ ุฑูุชุงุฑุดุงู ุฏุฑ streams.</p>
<p>ฺฏุฒููโูุง 1 ู 2 ุงุฒ ูุธุฑ ูุนูุง <strong>ฺฉุณุงู</strong> ูุณุชูุฏุ ุฒุฑุง ุจุณุชู ฺฉ adapter ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ <strong>stream ุฒุฑู</strong> ุฑุง ูุฒ ูโุจูุฏุฏ. ูุฑ ุฒูุงู ฺฉู ุงุฒ <strong>nested using statements</strong> ุงุณุชูุงุฏู ูโฺฉูุฏุ ุนููุงู ฺฏุฒูู 2 ุฑุง ุงูุชุฎุงุจ ฺฉุฑุฏูโุงุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> (FileStream fs = File.Create(<span class="hljs-string">&quot;test.txt&quot;</span>))
<span class="hljs-keyword">using</span> (TextWriter writer = <span class="hljs-keyword">new</span> StreamWriter(fs))
    writer.WriteLine(<span class="hljs-string">&quot;Line&quot;</span>);
</code></pre>
<p>ฺูู dispose ุจู ุชุฑุชุจ ุงุฒ ุฏุงุฎู ุจู ุจุฑูู ุงูุฌุงู ูโุดูุฏุ ุงุจุชุฏุง adapter ุจุณุชู ูโุดูุฏ ู ุณูพุณ stream. ููฺูู ุงฺฏุฑ ุฏุฑ <strong>constructor</strong> adapter ุงุณุชุซูุง ุฑุฎ ุฏูุฏุ stream ููฺูุงู ุจุณุชู ูโุดูุฏ. ุงุณุชูุงุฏู ุงุฒ nested using statements ุชูุฑุจุงู ููุดู ุงูู ุงุณุช.</p>
<blockquote>
<p>ูุฑฺฏุฒ ฺฉ stream ุฑุง ูุจู ุงุฒ ุจุณุชู ุง Flush ฺฉุฑุฏู writer ุขู ูุจูุฏุฏ โ ุฏุฑ ุบุฑ ุงู ุตูุฑุช ุฏุงุฏูโูุง ุจุงูุฑ ุดุฏู ุฏุฑ adapter ุงุฒ ุจู ูโุฑููุฏ.</p>
</blockquote>
<p>ฺฏุฒููโูุง 3 ู 4 ฺฉุงุฑ ูโฺฉููุฏ ฺูู adapters ุฏุฑ ุฏุณุชู <strong>objects ุจุง disposal ุงุฎุชุงุฑ</strong> ูุฑุงุฑ ุฏุงุฑูุฏ. ฺฉ ูุซุงู: ููฺฉู ุงุณุช adapter ุฑุง ุชูุงู ฺฉุฑุฏู ุจุงุดุฏ ูู ุจุฎูุงูุฏ <strong>stream ุฒุฑู</strong> ุจุฑุง ุงุณุชูุงุฏูโูุง ุจุนุฏ ุจุงุฒ ุจูุงูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> (FileStream fs = <span class="hljs-keyword">new</span> FileStream(<span class="hljs-string">&quot;test.txt&quot;</span>, FileMode.Create))
{
    StreamWriter writer = <span class="hljs-keyword">new</span> StreamWriter(fs);
    writer.WriteLine(<span class="hljs-string">&quot;Hello&quot;</span>);
    writer.Flush();
    fs.Position = <span class="hljs-number">0</span>;
    Console.WriteLine(fs.ReadByte());
}
</code></pre>
<p>ุฏุฑ ุงูุฌุงุ ุงุจุชุฏุง ุจู ูุงู ูโููุณูุ ูููุนุช stream ุฑุง ุชุบุฑ ูโุฏูู ู ุณูพุณ ุงููู ุจุงุช ุฑุง ูโุฎูุงูู. ุงฺฏุฑ StreamWriter ุฑุง dispose ูโฺฉุฑุฏูุ FileStream ูุฒ ุจุณุชู ูโุดุฏ ู ุฎูุงูุฏู ุจุนุฏ ุดฺฉุณุช ูโุฎูุฑุฏ. ุดุฑุท ุงู ุงุณุช ฺฉู <strong>Flush</strong> ุฑุง ุตุฏุง ุจุฒูู ุชุง ุจุงูุฑ StreamWriter ุจู stream ููุดุชู ุดูุฏ.</p>
<p>Stream adapters ุจุง semantics <strong>ุงุฎุชุงุฑ ุฏุฑ disposal</strong>ุ ุงูฺฏู <strong>extended disposal</strong> ฺฉู finalizer ุฏุฑ ุขู Dispose ุฑุง ุตุฏุง ูโุฒูุฏุ ูพุงุฏูโุณุงุฒ ููโฺฉููุฏ. ุงู ุงูฺฉุงู ุฑุง ูโุฏูุฏ ฺฉู adapter ุฑูุงุดุฏู ููฺฏุงู ุฑุณุฏู <strong>garbage collector</strong> ุจู ุขูุ ุฎูุฏฺฉุงุฑ dispose ูุดูุฏ.</p>
<p>ููฺูู ฺฉ constructor ุฏุฑ StreamReader/StreamWriter ูุฌูุฏ ุฏุงุฑุฏ ฺฉู ุฏุณุชูุฑ ูโุฏูุฏ stream ุจุนุฏ ุงุฒ disposal ุจุงุฒ ุจูุงูุฏ. ุจูุงุจุฑุงู ูโุชูุงู ูุซุงู ูุจู ุฑุง ุจู ุดฺฉู ุฒุฑ ุจุงุฒููุณ ฺฉุฑุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> fs = <span class="hljs-keyword">new</span> FileStream(<span class="hljs-string">&quot;test.txt&quot;</span>, FileMode.Create))
{
    <span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> writer = <span class="hljs-keyword">new</span> StreamWriter(fs, <span class="hljs-keyword">new</span> UTF8Encoding(<span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>), <span class="hljs-number">0x400</span>, <span class="hljs-literal">true</span>))
        writer.WriteLine(<span class="hljs-string">&quot;Hello&quot;</span>);
    fs.Position = <span class="hljs-number">0</span>;
    Console.WriteLine(fs.ReadByte());
    Console.WriteLine(fs.Length);
}
</code></pre>
<hr>
<h3>Compression Streams ๐ฆ</h3>
<p>ุฏุฑ ูุถุง ูุงู <code>System.IO.Compression</code> ุฏู <strong>compression stream</strong> ุนููู ูุฌูุฏ ุฏุงุฑุฏ: <code>DeflateStream</code> ู <code>GZipStream</code>. ูุฑ ุฏู ุงุฒ ุงูฺฏูุฑุชู ูุดุฑุฏูโุณุงุฒ ูุดุงุจู ZIP ุงุณุชูุงุฏู ูโฺฉููุฏ. ุชูุงูุชุดุงู ุงู ุงุณุช ฺฉู <strong>GZipStream</strong> ฺฉ ูพุฑูุชฺฉู ุงุถุงู ุฏุฑ ุงุจุชุฏุง ู ุงูุชูุง ูโููุณุฏ ฺฉู ุดุงูู CRC ุจุฑุง ุชุดุฎุต ุฎุทุง ุงุณุช ู ุจุง ุงุณุชุงูุฏุงุฑุฏูุง ูุฑูโุงูุฒุงุฑ ุฏฺฏุฑ ุณุงุฒฺฏุงุฑ ุงุณุช.</p>
<p>.NET ููฺูู <code>BrotliStream</code> ุฑุง ุงุฑุงุฆู ูโุฏูุฏ ฺฉู ุงูฺฏูุฑุชู Brotli ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉูุฏ. <strong>BrotliStream</strong> ุจุด ุงุฒ 10 ุจุฑุงุจุฑ ฺฉูุฏุชุฑ ุงุฒ DeflateStream ู GZipStream ุงุณุช ุงูุง ูุณุจุช ูุดุฑุฏูโุณุงุฒ ุจูุชุฑ ุฏุงุฑุฏ. (ุงู ฺฉุงูุด ุณุฑุนุช ููุท ุจุฑุง ูุดุฑุฏูโุณุงุฒ ุงุณุชุ ุฏฺฉุงููพุฑุดู ุจุณุงุฑ ุณุฑุน ุงุณุช.)</p>
<p>ูุฑ ุณู stream ูุงุจูุช ุฎูุงูุฏู ู ููุดุชู ุฏุงุฑูุฏุ ุจุง ุงู ุดุฑุงุท:</p>
<ul>
<li>ููฺฏุงู ูุดุฑุฏูโุณุงุฒุ ููุดู ุฑู stream ูโููุณุฏ.</li>
<li>ููฺฏุงู ุฏฺฉุงููพุฑุดูุ ููุดู ุงุฒ stream ูโุฎูุงูุฏ.</li>
</ul>
<p><code>DeflateStream</code>ุ <code>GZipStream</code> ู <code>BrotliStream</code> <strong>decorator</strong> ูุณุชูุฏุ ุขูโูุง ุฏุงุฏูโูุง ุฑุง ุงุฒ stream ุฏฺฏุฑ ฺฉู ููฺฏุงู ุณุงุฎุช ุงุฑุงุฆู ูโุฏูุฏุ ูุดุฑุฏู ุง ุฏฺฉุงููพุฑ ูโฺฉููุฏ.</p>
<p>ูุซุงู ูุดุฑุฏูโุณุงุฒ ู ุฏฺฉุงููพุฑุดู ฺฉ ุณุฑ ุจุงุช ุจุง ุงุณุชูุงุฏู ุงุฒ FileStream:</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> (Stream s = File.Create(<span class="hljs-string">&quot;compressed.bin&quot;</span>))
<span class="hljs-keyword">using</span> (Stream ds = <span class="hljs-keyword">new</span> DeflateStream(s, CompressionMode.Compress))
    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">byte</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++)
        ds.WriteByte(i);

<span class="hljs-keyword">using</span> (Stream s = File.OpenRead(<span class="hljs-string">&quot;compressed.bin&quot;</span>))
<span class="hljs-keyword">using</span> (Stream ds = <span class="hljs-keyword">new</span> DeflateStream(s, CompressionMode.Decompress))
    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">byte</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++)
        Console.WriteLine(ds.ReadByte()); <span class="hljs-comment">// 0 ุชุง 99</span>
</code></pre>
<p>ุจุง DeflateStreamุ ูุงู ูุดุฑุฏู 102 ุจุงุช ุงุณุช: ฺฉู ุจุฒุฑฺฏุชุฑ ุงุฒ ุงุตู. BrotliStream ุขู ุฑุง ุจู 73 ุจุงุช ูุดุฑุฏู ูโฺฉูุฏ. ูุดุฑุฏูโุณุงุฒ ุจุง ุฏุงุฏูโูุง ุจุงูุฑ <strong>ูุชุฑุงฺฉู ู ุบุฑุชฺฉุฑุงุฑ</strong> ุถุนู ุนูู ูโฺฉูุฏ ู ุจุง ุฏุงุฏูโูุง ุฑูุฒูฺฏุงุฑ ุดุฏู ุจุฏุชุฑ ุงุณุช. ุงูุง ุจุฑุง ูุงูโูุง ูุชู ุนููฺฉุฑุฏ ุฎูุจ ุฏุงุฑุฏ.</p>
<p>ูุซุงู ุจุนุฏ: ูุดุฑุฏู ู ุฏฺฉุงููพุฑุดู ฺฉ ูุชู 1000 ฺฉููู ุจุง ุงูฺฏูุฑุชู Brotli:</p>
<pre class="hljs"><code><span class="hljs-built_in">string</span>[] words = <span class="hljs-string">&quot;The quick brown fox jumps over the lazy dog&quot;</span>.Split();
Random rand = <span class="hljs-keyword">new</span> Random(<span class="hljs-number">0</span>); <span class="hljs-comment">// ุจุฑุง ุซุจุงุช</span>
<span class="hljs-keyword">using</span> (Stream s = File.Create(<span class="hljs-string">&quot;compressed.bin&quot;</span>))
<span class="hljs-keyword">using</span> (Stream ds = <span class="hljs-keyword">new</span> BrotliStream(s, CompressionMode.Compress))
<span class="hljs-keyword">using</span> (TextWriter w = <span class="hljs-keyword">new</span> StreamWriter(ds))
    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i++)
        <span class="hljs-keyword">await</span> w.WriteAsync(words[rand.Next(words.Length)] + <span class="hljs-string">&quot; &quot;</span>);

Console.WriteLine(<span class="hljs-keyword">new</span> FileInfo(<span class="hljs-string">&quot;compressed.bin&quot;</span>).Length); <span class="hljs-comment">// 808</span>

<span class="hljs-keyword">using</span> (Stream s = File.OpenRead(<span class="hljs-string">&quot;compressed.bin&quot;</span>))
<span class="hljs-keyword">using</span> (Stream ds = <span class="hljs-keyword">new</span> BrotliStream(s, CompressionMode.Decompress))
<span class="hljs-keyword">using</span> (TextReader r = <span class="hljs-keyword">new</span> StreamReader(ds))
    Console.Write(<span class="hljs-keyword">await</span> r.ReadToEndAsync());
</code></pre>
<p>ุฏุฑ ุงู ุญุงูุชุ BrotliStream ุจู ุทูุฑ ูุคุซุฑ ูุงู ุฑุง ุจู 808 ุจุงุช ูุดุฑุฏู ูโฺฉูุฏ โ ฺฉูุชุฑ ุงุฒ ฺฉ ุจุงุช ุจุฑุง ูุฑ ฺฉููู. (DeflateStream ููุงู ุฏุงุฏูโูุง ุฑุง ุจู 885 ุจุงุช ูุดุฑุฏู ูโฺฉูุฏ.)</p>
<hr>
<h3>ูุดุฑุฏูโุณุงุฒ ุฏุฑ ุญุงูุธู ๐ง๐จ</h3>
<p>ฺฏุงู ูุงุฒู ุงุณุช ูุดุฑุฏูโุณุงุฒ ฺฉุงููุงู <strong>ุฏุฑ ุญุงูุธู</strong> ุงูุฌุงู ุดูุฏ. ููููู ุจุง MemoryStream:</p>
<pre class="hljs"><code><span class="hljs-built_in">byte</span>[] data = <span class="hljs-keyword">new</span> <span class="hljs-built_in">byte</span>[<span class="hljs-number">1000</span>]; <span class="hljs-comment">// ุขุฑุงู ุฎุงู ุจุฑุง ุชุณุช ูุดุฑุฏูโุณุงุฒ</span>
<span class="hljs-keyword">var</span> ms = <span class="hljs-keyword">new</span> MemoryStream();
<span class="hljs-keyword">using</span> (Stream ds = <span class="hljs-keyword">new</span> DeflateStream(ms, CompressionMode.Compress))
    ds.Write(data, <span class="hljs-number">0</span>, data.Length);

<span class="hljs-built_in">byte</span>[] compressed = ms.ToArray();
Console.WriteLine(compressed.Length); <span class="hljs-comment">// 11</span>

<span class="hljs-comment">// ุฏฺฉุงููพุฑุดู ุฏูุจุงุฑู ุจู ุขุฑุงู ุฏุงุฏู:</span>
ms = <span class="hljs-keyword">new</span> MemoryStream(compressed);
<span class="hljs-keyword">using</span> (Stream ds = <span class="hljs-keyword">new</span> DeflateStream(ms, CompressionMode.Decompress))
    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i += ds.Read(data, i, <span class="hljs-number">1000</span> - i));
</code></pre>
<p>ุงุณุชูุงุฏู ุงุฒ <code>using</code> ุฑู DeflateStream ุขู ุฑุง ุจูโุทูุฑ ุงุณุชุงูุฏุงุฑุฏ ูโุจูุฏุฏ ู ูุฑ ุจุงูุฑ ููุดุชูโูุดุฏู ุฑุง Flush ูโฺฉูุฏ. ุงู ููฺูู MemoryStream ุฑุง ูโุจูุฏุฏุ ุจูุงุจุฑุงู ุจุฑุง ุงุณุชุฎุฑุงุฌ ุฏุงุฏูโูุง ุจุงุฏ <code>ToArray</code> ุฑุง ุตุฏุง ุจุฒูู.</p>
<p>ูุณุฎู ุฌุงฺฏุฒู ฺฉู <strong>MemoryStream ุฑุง ุจุงุฒ ูฺฏู ูโุฏุงุฑุฏ</strong> ู ุงุฒ ูุชุฏูุง <strong>ุขุณูฺฉุฑูู</strong> ุงุณุชูุงุฏู ูโฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-built_in">byte</span>[] data = <span class="hljs-keyword">new</span> <span class="hljs-built_in">byte</span>[<span class="hljs-number">1000</span>];
MemoryStream ms = <span class="hljs-keyword">new</span> MemoryStream();
<span class="hljs-keyword">using</span> (Stream ds = <span class="hljs-keyword">new</span> DeflateStream(ms, CompressionMode.Compress, <span class="hljs-literal">true</span>))
    <span class="hljs-keyword">await</span> ds.WriteAsync(data, <span class="hljs-number">0</span>, data.Length);

Console.WriteLine(ms.Length); <span class="hljs-comment">// 113</span>
ms.Position = <span class="hljs-number">0</span>;
<span class="hljs-keyword">using</span> (Stream ds = <span class="hljs-keyword">new</span> DeflateStream(ms, CompressionMode.Decompress))
    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i += <span class="hljs-keyword">await</span> ds.ReadAsync(data, i, <span class="hljs-number">1000</span> - i));
</code></pre>
<p>ููฺฏ ุงุถุงู ุฏุฑ constructor ุจู DeflateStream ูโฺฏูุฏ ฺฉู <strong>stream ุฒุฑู ุฑุง ุฏุฑ disposal ูุจูุฏุฏ</strong>. ุจู ุงู ุชุฑุชุจ MemoryStream ุจุงุฒ ูโูุงูุฏ ู ูโุชูุงูู ุขู ุฑุง ุฏูุจุงุฑู ุงุฒ ูููุนุช ุตูุฑ ุจุฎูุงูู.</p>
<h3>ูุดุฑุฏูโุณุงุฒ ูุงูโูุง ุฏุฑ Unix ุจุง GZip ๐ง๐ฆ</h3>
<p>ุงูฺฏูุฑุชู ูุดุฑุฏูโุณุงุฒ <strong>GZipStream</strong> ุฏุฑ ุณุณุชูโูุง Unix ุจูโุนููุงู ูุฑูุช ูุดุฑุฏูโุณุงุฒ ูุงู ูุญุจูุจ ุงุณุช. ูุฑ ูุงู ููุจุน ุฏุฑ ฺฉ ูุงู ูุฏู ุฌุฏุงฺฏุงูู ุจุง ูพุณููุฏ <code>.gz</code> ูุดุฑุฏู ูโุดูุฏ.</p>
<p>ุฑูุดโูุง ุฒุฑ ููุงู ฺฉุงุฑ <strong>gzip</strong> ู <strong>gunzip</strong> ุฏุฑ ุฎุท ูุฑูุงู Unix ุฑุง ุงูุฌุงู ูโุฏููุฏ:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">async</span> Task <span class="hljs-title">GZip</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> sourcefile, <span class="hljs-built_in">bool</span> deleteSource = <span class="hljs-literal">true</span></span>)</span>
{
    <span class="hljs-keyword">var</span> gzip = <span class="hljs-string">$&quot;<span class="hljs-subst">{sourcefile}</span>.gz&quot;</span>;
    <span class="hljs-keyword">if</span> (File.Exists(gzip))
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Exception(<span class="hljs-string">&quot;Gzip file already exists&quot;</span>);
    
    <span class="hljs-comment">// ูุดุฑุฏูโุณุงุฒ</span>
    <span class="hljs-keyword">using</span> (FileStream inStream = File.Open(sourcefile, FileMode.Open))
    <span class="hljs-keyword">using</span> (FileStream outStream = <span class="hljs-keyword">new</span> FileStream(gzip, FileMode.CreateNew))
    <span class="hljs-keyword">using</span> (GZipStream gzipStream = <span class="hljs-keyword">new</span> GZipStream(outStream, CompressionMode.Compress))
        <span class="hljs-keyword">await</span> inStream.CopyToAsync(gzipStream); 

    <span class="hljs-keyword">if</span> (deleteSource) File.Delete(sourcefile);
}

<span class="hljs-function"><span class="hljs-keyword">async</span> Task <span class="hljs-title">GUnzip</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> gzipfile, <span class="hljs-built_in">bool</span> deleteGzip = <span class="hljs-literal">true</span></span>)</span>
{
    <span class="hljs-keyword">if</span> (Path.GetExtension(gzipfile) != <span class="hljs-string">&quot;.gz&quot;</span>)
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Exception(<span class="hljs-string">&quot;Not a gzip file&quot;</span>);

    <span class="hljs-keyword">var</span> uncompressedFile = gzipfile.Substring(<span class="hljs-number">0</span>, gzipfile.Length - <span class="hljs-number">3</span>);
    <span class="hljs-keyword">if</span> (File.Exists(uncompressedFile))
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Exception(<span class="hljs-string">&quot;Destination file already exists&quot;</span>);
    
    <span class="hljs-comment">// ุฏฺฉุงููพุฑุดู</span>
    <span class="hljs-keyword">using</span> (FileStream uncompressToStream = File.Open(uncompressedFile, FileMode.Create))
    <span class="hljs-keyword">using</span> (FileStream zipfileStream = File.Open(gzipfile, FileMode.Open))
    <span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> unzipStream = <span class="hljs-keyword">new</span> GZipStream(zipfileStream, CompressionMode.Decompress))
        <span class="hljs-keyword">await</span> unzipStream.CopyToAsync(uncompressToStream);

    <span class="hljs-keyword">if</span> (deleteGzip) File.Delete(gzipfile);
}
</code></pre>
<p>ููููู ุงุณุชูุงุฏู:</p>
<pre class="hljs"><code><span class="hljs-keyword">await</span> GZip(<span class="hljs-string">&quot;/tmp/myfile.txt&quot;</span>);        <span class="hljs-comment">// ุงุฌุงุฏ /tmp/myfile.txt.gz</span>
<span class="hljs-keyword">await</span> GUnzip(<span class="hljs-string">&quot;/tmp/myfile.txt.gz&quot;</span>);   <span class="hljs-comment">// ุจุงุฒุณุงุฒ /tmp/myfile.txt</span>
</code></pre>
<hr>
<h3>ฺฉุงุฑ ุจุง ูุงูโูุง ZIP ๐๏ธ</h3>
<p>ฺฉูุงุณโูุง <strong>ZipArchive</strong> ู <strong>ZipFile</strong> ุฏุฑ <code>System.IO.Compression</code> ุงุฒ ูุฑูุช ZIP ูพุดุชุจุงู ูโฺฉููุฏ. ูุฒุช ZIP ูุณุจุช ุจู <strong>DeflateStream</strong> ู <strong>GZipStream</strong> ุงู ุงุณุช ฺฉู:</p>
<ul>
<li>
<p>ูโุชูุงูุฏ ฺูุฏู ูุงู ุฑุง ุฏุฑ ุฎูุฏ ุฌุง ุฏูุฏ.</p>
</li>
<li>
<p>ุจุง ูุงูโูุง ZIP ุงุฌุงุฏ ุดุฏู ุชูุณุท Windows Explorer ุณุงุฒฺฏุงุฑ ุงุณุช.</p>
</li>
<li>
<p><strong>ZipArchive</strong> ุจุง streams ฺฉุงุฑ ูโฺฉูุฏ.</p>
</li>
<li>
<p><strong>ZipFile</strong> ุณูุงุฑู ูุนููู ฺฉุงุฑ ุจุง ูุงูโูุง ุฑุง ูพูุดุด ูโุฏูุฏ ู ฺฉูุงุณ ฺฉูฺฉ ุงุณุช ุจุฑุง ZipArchive.</p>
</li>
</ul>
<p>ููููู ุงุณุชูุงุฏู ุงุฒ <strong>CreateFromDirectory</strong> ุจุฑุง ุงูุฒูุฏู ุชูุงู ูุงูโูุง ฺฉ ุฏุงุฑฺฉุชูุฑ ุจู ZIP:</p>
<pre class="hljs"><code>ZipFile.CreateFromDirectory(<span class="hljs-string">@&quot;d:\MyFolder&quot;</span>, <span class="hljs-string">@&quot;d:\archive.zip&quot;</span>);
</code></pre>
<p>ุจุฑุง ุงุณุชุฎุฑุงุฌ ZIP ุจู ุฏุงุฑฺฉุชูุฑ:</p>
<pre class="hljs"><code>ZipFile.ExtractToDirectory(<span class="hljs-string">@&quot;d:\archive.zip&quot;</span>, <span class="hljs-string">@&quot;d:\MyFolder&quot;</span>);
</code></pre>
<blockquote>
<p>ุงุฒ .NET 8 ุจู ุจุนุฏ ูโุชูุงูุฏ ุจู ุฌุง ูุณุฑ ูุงูุ ฺฉ Stream ูุฒ ูุดุฎุต ฺฉูุฏ.</p>
</blockquote>
<p>ููฺฏุงู ูุดุฑุฏูโุณุงุฒุ ูโุชูุงูุฏ ูุดุฎุต ฺฉูุฏ ฺฉู ุจูููโุณุงุฒ ุจุฑุง <strong>ุญุฌู ูุงู ุง ุณุฑุนุช</strong> ุงูุฌุงู ุดูุฏ ู ุขุง ูุงู ุฏุงุฑฺฉุชูุฑ ููุจุน ุฏุฑ ุขุฑุดู ูุญุงุธ ุดูุฏ ุง ูู.</p>
<p>ุจุฑุง ุฏุณุชุฑุณ ุจู ูุฑูุฏโูุง ูููุฑุฏ ZIP ุงุฒ <strong>Open</strong> ุงุณุชูุงุฏู ูโฺฉููุ ฺฉู ฺฉ <strong>ZipArchive</strong> ุจุฑูโฺฏุฑุฏุงูุฏ. ูโุชูุงู ูุงูโูุง ุฑุง ุงุฒ ุทุฑู <strong>Entries</strong> ุดูุงุฑุด ุง ุจุง <strong>GetEntry</strong> ุจูโุตูุฑุช ุฎุงุต ุงูุช:</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> (ZipArchive zip = ZipFile.Open(<span class="hljs-string">@&quot;d:\zz.zip&quot;</span>, ZipArchiveMode.Read))
    <span class="hljs-keyword">foreach</span> (ZipArchiveEntry entry <span class="hljs-keyword">in</span> zip.Entries)
        Console.WriteLine(entry.FullName + <span class="hljs-string">&quot; &quot;</span> + entry.Length);
</code></pre>
<p><strong>ZipArchiveEntry</strong> ููฺูู ูุชุฏูุง <code>Delete</code>ุ <code>ExtractToFile</code> ู <code>Open</code> ุฑุง ุฏุงุฑุฏ. ุจุฑุง ุงุฌุงุฏ ูุฑูุฏ ุฌุฏุฏ ุงุฒ <code>CreateEntry</code> ุง ูุชุฏ ุงฺฉุณุชูุดู <code>CreateEntryFromFile</code> ุงุณุชูุงุฏู ูโฺฉูู:</p>
<pre class="hljs"><code><span class="hljs-built_in">byte</span>[] data = File.ReadAllBytes(<span class="hljs-string">@&quot;d:\foo.dll&quot;</span>); 
<span class="hljs-keyword">using</span> (ZipArchive zip = ZipFile.Open(<span class="hljs-string">@&quot;d:\zz.zip&quot;</span>, ZipArchiveMode.Update))
    zip.CreateEntry(<span class="hljs-string">@&quot;bin\X64\foo.dll&quot;</span>).Open().Write(data, <span class="hljs-number">0</span>, data.Length);
</code></pre>
<p>ูโุชูุงู ุชูุงู ุงู ฺฉุงุฑูุง ุฑุง ฺฉุงููุงู ุฏุฑ ุญุงูุธู ุงูุฌุงู ุฏุงุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ <strong>MemoryStream</strong> ุจู ุฌุง ูุณุฑ ูุงู.</p>
<hr>
<h3>ฺฉุงุฑ ุจุง ูุงูโูุง Tar ๐ฆ๐ง</h3>
<p>ฺฉูุงุณโูุง <code>System.Formats.Tar</code> (.NET 7 ุจู ุจุนุฏ) ุงุฒ ูุฑูุช <strong>.tar</strong> ูพุดุชุจุงู ูโฺฉููุฏ. ุงู ูุฑูุช ุฏุฑ Unix ุจุฑุง ุจุณุชูโุจูุฏ ฺูุฏู ูุงู ูุญุจูุจ ุงุณุช.</p>
<p>ุงุฌุงุฏ ฺฉ ูุงู tar (tarball):</p>
<pre class="hljs"><code>TarFile.CreateFromDirectory(<span class="hljs-string">&quot;/tmp/testfolder&quot;</span>, <span class="hljs-string">&quot;/tmp/test.tar&quot;</span>, <span class="hljs-literal">false</span>);
</code></pre>
<ul>
<li>ุขุฑฺฏููุงู ุณูู ูุดุฎุต ูโฺฉูุฏ ฺฉู ุขุง ูุงู ุฏุงุฑฺฉุชูุฑ ูพุงู ุฏุฑ ูุฑูุฏโูุง ุขุฑุดู ูุญุงุธ ุดูุฏ ุง ุฎุฑ.</li>
</ul>
<p>ุงุณุชุฎุฑุงุฌ tarball:</p>
<pre class="hljs"><code>TarFile.ExtractToDirectory(<span class="hljs-string">&quot;/tmp/test.tar&quot;</span>, <span class="hljs-string">&quot;/tmp/testfolder&quot;</span>, <span class="hljs-literal">true</span>);
</code></pre>
<ul>
<li>ุขุฑฺฏููุงู ุณูู ูุดุฎุต ูโฺฉูุฏ ฺฉู ุขุง ูุงูโูุง ููุฌูุฏ ุจุงุฒููุณ ุดููุฏ ุง ุฎุฑ.</li>
</ul>
<p>ูุฑ ุฏู ูุชุฏ ุงูฺฉุงู ุงุณุชูุงุฏู ุงุฒ <strong>Stream</strong> ุจู ุฌุง ูุณุฑ ูุงู tar ุฑุง ูุฒ ุฏุงุฑูุฏ.</p>
<p>ููููู ูุดุฑุฏูโุณุงุฒ tar ุจู tar.gz ุจุง GZipStream:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> ms = <span class="hljs-keyword">new</span> MemoryStream();
TarFile.CreateFromDirectory(<span class="hljs-string">&quot;/tmp/testfolder&quot;</span>, ms, <span class="hljs-literal">false</span>);
ms.Position = <span class="hljs-number">0</span>;

<span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> fs = File.Create(<span class="hljs-string">&quot;/tmp/test.tar.gz&quot;</span>))
<span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> gz = <span class="hljs-keyword">new</span> GZipStream(fs, CompressionMode.Compress))
    ms.CopyTo(gz);
</code></pre>
<ul>
<li>ุงู ฺฉุงุฑ ููุฏ ุงุณุช ฺูู ูุฑูุช tar ุฎูุฏุด ูุดุฑุฏูโุณุงุฒ ูุฏุงุฑุฏุ ุจุฑ ุฎูุงู zip.</li>
</ul>
<p>ุงุณุชุฎุฑุงุฌ tar.gz:</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> fs = File.OpenRead(<span class="hljs-string">&quot;/tmp/test.tar.gz&quot;</span>))
<span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> gz = <span class="hljs-keyword">new</span> GZipStream(fs, CompressionMode.Decompress))
    TarFile.ExtractToDirectory(gz, <span class="hljs-string">&quot;/tmp/testfolder&quot;</span>, <span class="hljs-literal">true</span>);
</code></pre>
<p>ููฺูู ูโุชูุงูุฏ ุจุง ฺฉูุงุณโูุง <strong>TarReader</strong> ู <strong>TarWriter</strong> ุจู ุณุทุญ API ุฏููโุชุฑ ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดุฏ. ููููู ุงุณุชูุงุฏู ุงุฒ <strong>TarReader</strong>:</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> (FileStream archiveStream = File.OpenRead(<span class="hljs-string">&quot;/tmp/test.tar&quot;</span>))
<span class="hljs-keyword">using</span> (TarReader reader = <span class="hljs-keyword">new</span>(archiveStream))
{
    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>)
    {
        TarEntry entry = reader.GetNextEntry();
        <span class="hljs-keyword">if</span> (entry == <span class="hljs-literal">null</span>) <span class="hljs-keyword">break</span>;
        Console.WriteLine(<span class="hljs-string">$&quot;Entry <span class="hljs-subst">{entry.Name}</span> is <span class="hljs-subst">{entry.DataStream.Length}</span> bytes long&quot;</span>);
        entry.ExtractToFile(Path.Combine(<span class="hljs-string">&quot;/tmp/testfolder&quot;</span>, entry.Name), <span class="hljs-literal">true</span>);
    }
}
</code></pre>
<hr>
<h3>ุนููุงุช ูุงู ู ุฏุงุฑฺฉุชูุฑ ๐โ๏ธ</h3>
<p>ูุถุง ูุงู <code>System.IO</code> ูุฌููุนูโุง ุงุฒ ุงููุงุน ุจุฑุง ุงูุฌุงู ุนููุงุช <strong>utility</strong> ุฑู ูุงู ู ุฏุงุฑฺฉุชูุฑ ุงุฑุงุฆู ูโุฏูุฏุ ูุงููุฏ:</p>
<ul>
<li>ฺฉูพ ู ุงูุชูุงู ูุงูโูุง</li>
<li>ุงุฌุงุฏ ุฏุงุฑฺฉุชูุฑ</li>
<li>ุชูุธู ุฎุตูุตุงุช ู ุฏุณุชุฑุณโูุง ูุงู</li>
</ul>
<p>ุจุฑุง ุงฺฉุซุฑ ูฺฺฏโูุงุ ูโุชูุงูุฏ ุจู ุฏู ฺฉูุงุณ ุงูุชุฎุงุจ ฺฉูุฏ:</p>
<ul>
<li><strong>ฺฉูุงุณโูุง ุงุณุชุง (Static):</strong> <code>File</code> ู <code>Directory</code></li>
<li><strong>ฺฉูุงุณโูุง ุจุง ูุชุฏ ููููู:</strong> <code>FileInfo</code> ู <code>DirectoryInfo</code> (ุณุงุฎุชู ุดุฏู ุจุง ูุงู ูุงู ุง ุฏุงุฑฺฉุชูุฑ)</li>
</ul>
<p>ุนูุงูู ุจุฑ ุงูุ ฺฉูุงุณ ุงุณุชุง <strong>Path</strong> ูุฌูุฏ ุฏุงุฑุฏ ฺฉู ูฺ ุนูู ุฑู ูุงู ุง ุฏุงุฑฺฉุชูุฑ ุงูุฌุงู ููโุฏูุฏุ ุจูฺฉู ูุชุฏูุง ุจุฑุง <strong>ุฏุณุชฺฉุงุฑ ุฑุดุชู ูุณุฑูุง ู ูุงู ูุงูโูุง</strong> ุงุฑุงุฆู ูโฺฉูุฏ ู ููฺูู ุจุง ูุงูโูุง ูููุช ฺฉูฺฉ ูโฺฉูุฏ.</p>
<h3>ฺฉูุงุณ File ๐๐ป</h3>
<p>ฺฉูุงุณ <strong>File</strong> ฺฉ ฺฉูุงุณ ุงุณุชุง (static) ุงุณุช ฺฉู ุชูุงู ูุชุฏูุง ุขู ฺฉ <strong>ูุงู ูุงู</strong> ูโฺฏุฑูุฏ. ูุงู ูุงู ูโุชูุงูุฏ ูุณุจ ุจู ุฏุงุฑฺฉุชูุฑ ุฌุงุฑ ุง ฺฉุงูู ุจุง ูุณุฑ ุฏุงุฑฺฉุชูุฑ ุจุงุดุฏ. ูุชุฏูุง ุงู ฺฉูุงุณ (ุชูุงู <strong>public</strong> ู <strong>static</strong>) ุนุจุงุฑุชโุงูุฏ ุงุฒ:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-built_in">bool</span> <span class="hljs-title">Exists</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path</span>)</span>;                 <span class="hljs-comment">// ุงฺฏุฑ ูุงู ููุฌูุฏ ุจุงุดุฏ true ุจุฑูโฺฏุฑุฏุงูุฏ</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Delete</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path</span>)</span>;                 
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Copy</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> sourceFileName, <span class="hljs-built_in">string</span> destFileName</span>)</span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Move</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> sourceFileName, <span class="hljs-built_in">string</span> destFileName</span>)</span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Replace</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> sourceFileName, <span class="hljs-built_in">string</span> destinationFileName,
             <span class="hljs-built_in">string</span> destinationBackupFileName</span>)</span>;
<span class="hljs-function">FileAttributes <span class="hljs-title">GetAttributes</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path</span>)</span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">SetAttributes</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path, FileAttributes fileAttributes</span>)</span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Decrypt</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path</span>)</span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Encrypt</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path</span>)</span>;
<span class="hljs-function">DateTime <span class="hljs-title">GetCreationTime</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path</span>)</span>;      <span class="hljs-comment">// ูุณุฎู UTC ูุฒ ูุฌูุฏ ุฏุงุฑุฏ</span>
<span class="hljs-function">DateTime <span class="hljs-title">GetLastAccessTime</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path</span>)</span>;    <span class="hljs-comment">// ูุณุฎู UTC ูุฒ ูุฌูุฏ ุฏุงุฑุฏ</span>
<span class="hljs-function">DateTime <span class="hljs-title">GetLastWriteTime</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path</span>)</span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">SetCreationTime</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path, DateTime creationTime</span>)</span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">SetLastAccessTime</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path, DateTime lastAccessTime</span>)</span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">SetLastWriteTime</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path, DateTime lastWriteTime</span>)</span>;
<span class="hljs-function">FileSecurity <span class="hljs-title">GetAccessControl</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path</span>)</span>;
<span class="hljs-function">FileSecurity <span class="hljs-title">GetAccessControl</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path, AccessControlSections includeSections</span>)</span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">SetAccessControl</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path, FileSecurity fileSecurity</span>)</span>;
</code></pre>
<ul>
<li>ูุชุฏ <strong>Move</strong> ุงฺฏุฑ ูุงู ููุตุฏ ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ ุงุณุชุซูุง ูโุงูุฏุงุฒุฏุ ุงูุง <strong>Replace</strong> ุงู ฺฉุงุฑ ุฑุง ููโฺฉูุฏ.</li>
<li>ูุฑ ุฏู ูุชุฏ ุงูฺฉุงู ุชุบุฑ ูุงู ูุงู ุง ุงูุชูุงู ุขู ุจู ุฏุงุฑฺฉุชูุฑ ุฏฺฏุฑ ุฑุง ูุฑุงูู ูโฺฉููุฏ.</li>
<li><strong>Delete</strong> ุงฺฏุฑ ูุงู <strong>read-only</strong> ุจุงุดุฏ ุง ูุฌูุฒ ุญุฐู ุชูุณุท ุณุณุชูโุนุงูู ุจู ูุฑุขูุฏ ุดูุง ุฏุงุฏู ูุดุฏู ุจุงุดุฏุ ุงุณุชุซูุง <code>UnauthorizedAccessException</code> ูพุฑุชุงุจ ูโฺฉูุฏ.</li>
</ul>
<p>ุชูุงู ุงุนุถุง <strong>FileAttributes</strong> ฺฉู ุชูุณุท <code>GetAttributes</code> ุจุฑฺฏุฑุฏุงูุฏู ูโุดููุฏ:</p>
<pre class="hljs"><code>Archive, Compressed, Device, Directory, Encrypted,
Hidden, IntegritySystem, Normal, NoScrubData, NotContentIndexed, 
Offline, ReadOnly, ReparsePoint, SparseFile, System, Temporary
</code></pre>
<p>ุงู ุงุนุถุง ูุงุจู ุชุฑฺฉุจ ูุณุชูุฏ. ุจุฑุง ุชุบุฑ ฺฉ ูฺฺฏ ูุงู ุจุฏูู ุชุบุฑ ุณุงุฑ ูฺฺฏโูุง:</p>
<pre class="hljs"><code><span class="hljs-built_in">string</span> filePath = <span class="hljs-string">&quot;test.txt&quot;</span>;
FileAttributes fa = File.GetAttributes(filePath);
<span class="hljs-keyword">if</span> ((fa &amp; FileAttributes.ReadOnly) != <span class="hljs-number">0</span>)
{
    <span class="hljs-comment">// ุงุฒ ุนููฺฏุฑ XOR (^) ุจุฑุง ุชุบุฑ ูพุฑฺู ReadOnly ุงุณุชูุงุฏู ูโฺฉูู</span>
    fa ^= FileAttributes.ReadOnly;
    File.SetAttributes(filePath, fa);
}

<span class="hljs-comment">// ุญุงูุง ูโุชูุงูู ูุงู ุฑุง ุญุฐู ฺฉูู</span>
File.Delete(filePath);
</code></pre>
<p>ุฑุงู ุณุงุฏูโุชุฑ ุจุง <strong>FileInfo</strong>:</p>
<pre class="hljs"><code><span class="hljs-keyword">new</span> FileInfo(<span class="hljs-string">&quot;test.txt&quot;</span>).IsReadOnly = <span class="hljs-literal">false</span>;
</code></pre>
<hr>
<h3>ูฺฺฏโูุง ูุดุฑุฏูโุณุงุฒ ู ุฑูุฒฺฏุฐุงุฑ ๐๐๏ธ</h3>
<p>ุงู ูุงุจูุช ุชููุง ุฏุฑ <strong>Windows</strong> ููุฌูุฏ ุงุณุช ู ูุงุฒููุฏ ูพฺฉุฌ NuGet <code>System.Management</code> ุงุณุช.</p>
<ul>
<li>ูฺฺฏโูุง <strong>Compressed</strong> ู <strong>Encrypted</strong> ูุชูุงุธุฑ ุจุง ฺฺฉโุจุงฺฉุณโูุง ูุดุฑุฏูโุณุงุฒ ู ุฑูุฒฺฏุฐุงุฑ ุฏุฑ ูพูุฌุฑู Properties ูุงู ุง ุฏุงุฑฺฉุชูุฑ ุฏุฑ Windows Explorer ูุณุชูุฏ.</li>
<li>ุงู ููุน ูุดุฑุฏูโุณุงุฒ ู ุฑูุฒฺฏุฐุงุฑ <strong>ุดูุงู</strong> ุงุณุชุ ุจู ุทูุฑ ฺฉู ุณุณุชูโุนุงูู ุชูุงู ุนููุงุช ุฑุง ุงูุฌุงู ูโุฏูุฏ ู ุดูุง ูโุชูุงูุฏ ุฏุงุฏูโูุง ุฑุง ุจู ุตูุฑุช plain ุจุฎูุงูุฏ ู ุจููุณุฏ.</li>
<li>ููโุชูุงู ุจุง <code>SetAttributes</code> ูฺฺฏโูุง <strong>Compressed</strong> ุง <strong>Encrypted</strong> ุฑุง ุชุบุฑ ุฏุงุฏ (ุงฺฏุฑ ุชูุงุด ฺฉูุฏุ ุจุฏูู ุฎุทุง ุดฺฉุณุช ูโุฎูุฑุฏ).</li>
</ul>
<p>ุฑุงู ุญู: ุจุฑุง ุฑูุฒฺฏุฐุงุฑ ู ุฑูุฒฺฏุดุง ุงุฒ ูุชุฏูุง <code>Encrypt()</code> ู <code>Decrypt()</code> ุฏุฑ ฺฉูุงุณ <strong>File</strong> ุงุณุชูุงุฏู ฺฉูุฏ.<br>
ุจุฑุง ูุดุฑุฏูโุณุงุฒุ ุงุณุชูุงุฏู ุงุฒ WMI ุฏุฑ <code>System.Management</code> ุฑุงู ุญู ุงุณุช:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-built_in">uint</span> <span class="hljs-title">CompressFolder</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> folder, <span class="hljs-built_in">bool</span> recursive</span>)</span>
{
    <span class="hljs-built_in">string</span> path = <span class="hljs-string">&quot;Win32_Directory.Name=&#x27;&quot;</span> + folder + <span class="hljs-string">&quot;&#x27;&quot;</span>;
    <span class="hljs-keyword">using</span> (ManagementObject dir = <span class="hljs-keyword">new</span> ManagementObject(path))
    <span class="hljs-keyword">using</span> (ManagementBaseObject p = dir.GetMethodParameters(<span class="hljs-string">&quot;CompressEx&quot;</span>))
    {
        p[<span class="hljs-string">&quot;Recursive&quot;</span>] = recursive;
        <span class="hljs-keyword">using</span> (ManagementBaseObject result = dir.InvokeMethod(<span class="hljs-string">&quot;CompressEx&quot;</span>, p, <span class="hljs-literal">null</span>))
            <span class="hljs-keyword">return</span> (<span class="hljs-built_in">uint</span>)result.Properties[<span class="hljs-string">&quot;ReturnValue&quot;</span>].Value;
    }
}
</code></pre>
<ul>
<li>ุจุฑุง ุงุณุชุฎุฑุงุฌุ <code>CompressEx</code> ุฑุง ุจุง <code>UncompressEx</code> ุฌุงฺฏุฒู ฺฉูุฏ.</li>
</ul>
<p><strong>ุฑูุฒฺฏุฐุงุฑ ุดูุงู</strong> ุจุฑ ูพุงู ฺฉูุฏ ุณุงุฎุชู ุดุฏู ุงุฒ ุฑูุฒ ุนุจูุฑ ฺฉุงุฑุจุฑ ูุงฺฏู ุดุฏู ุงุณุช. ุชุบุฑ ุฑูุฒ ุนุจูุฑ ุชูุณุท ฺฉุงุฑุจุฑ ูุนุชุจุฑ ูุดฺฉู ุงุฌุงุฏ ููโฺฉูุฏุ ุงูุง ุงฺฏุฑ ุฑูุฒ ุชูุณุท ูุฏุฑ ุฑุณุช ุดูุฏุ ุฏุงุฏูโูุง ูุงูโูุง ุฑูุฒฺฏุฐุงุฑโุดุฏู ูุงุจู ุจุงุฒุงุจ ูุฎูุงููุฏ ุจูุฏ.</p>
<p><strong>NTFS</strong> ุงู ูุงุจูุชโูุง ุฑุง ูพุดุชุจุงู ูโฺฉูุฏุ ุงูุง <strong>CDFS</strong> (ุฑู CD-ROM) ู <strong>FAT</strong> (ุฑู ฺฉุงุฑุชโูุง ูุงุจู ุญูู) ูพุดุชุจุงู ููโฺฉููุฏ.</p>
<p>ุจุฑุง ุชุดุฎุต ูพุดุชุจุงู ฺฉ ุญุฌู ุงุฒ ูุดุฑุฏูโุณุงุฒ ู ุฑูุฒฺฏุฐุงุฑ:</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.IO;
<span class="hljs-keyword">using</span> System.Text;
<span class="hljs-keyword">using</span> System.ComponentModel;
<span class="hljs-keyword">using</span> System.Runtime.InteropServices;

<span class="hljs-keyword">class</span> <span class="hljs-title">SupportsCompressionEncryption</span>
{
    <span class="hljs-keyword">const</span> <span class="hljs-built_in">int</span> SupportsCompression = <span class="hljs-number">0x10</span>;
    <span class="hljs-keyword">const</span> <span class="hljs-built_in">int</span> SupportsEncryption = <span class="hljs-number">0x20000</span>;

    [<span class="hljs-meta">DllImport(<span class="hljs-string">&quot;Kernel32.dll&quot;</span>, SetLastError = true)</span>]
    <span class="hljs-function"><span class="hljs-keyword">extern</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">GetVolumeInformation</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> vol, StringBuilder name,
        <span class="hljs-built_in">int</span> nameSize, <span class="hljs-keyword">out</span> <span class="hljs-built_in">uint</span> serialNum, <span class="hljs-keyword">out</span> <span class="hljs-built_in">uint</span> maxNameLen, <span class="hljs-keyword">out</span> <span class="hljs-built_in">uint</span> flags,
        StringBuilder fileSysName, <span class="hljs-built_in">int</span> fileSysNameSize</span>)</span>;

    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>()</span>
    {
        <span class="hljs-built_in">uint</span> serialNum, maxNameLen, flags;
        <span class="hljs-built_in">bool</span> ok = GetVolumeInformation(<span class="hljs-string">@&quot;C:\&quot;</span>, <span class="hljs-literal">null</span>, <span class="hljs-number">0</span>, <span class="hljs-keyword">out</span> serialNum,
                                       <span class="hljs-keyword">out</span> maxNameLen, <span class="hljs-keyword">out</span> flags, <span class="hljs-literal">null</span>, <span class="hljs-number">0</span>);
        <span class="hljs-keyword">if</span> (!ok) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Win32Exception();

        <span class="hljs-built_in">bool</span> canCompress = (flags &amp; SupportsCompression) != <span class="hljs-number">0</span>;
        <span class="hljs-built_in">bool</span> canEncrypt = (flags &amp; SupportsEncryption) != <span class="hljs-number">0</span>;
    }
}
</code></pre>
<hr>
<h3>ุงููุช ูุงู ุฏุฑ Windows ๐</h3>
<p>ุงู ูฺฺฏ ูุฒ <strong>ููุฏูุฒ</strong> ุงุณุช ู ูุงุฒููุฏ ูพฺฉุฌ NuGet <code>System.IO.FileSystem.AccessControl</code> ูโุจุงุดุฏ.</p>
<p>ฺฉูุงุณ <strong>FileSecurity</strong> ุงุฌุงุฒู ูโุฏูุฏ ูุฌูุฒูุง ุณุณุชูโุนุงูู ุฑุง ุจุฑุง ฺฉุงุฑุจุฑุงู ู ููุดโูุง ูุดุงูุฏู ู ุชุบุฑ ุฏูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.IO;
<span class="hljs-keyword">using</span> System.Security.AccessControl;
<span class="hljs-keyword">using</span> System.Security.Principal;

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">ShowSecurity</span>(<span class="hljs-params">FileSecurity sec</span>)</span>
{
    AuthorizationRuleCollection rules = sec.GetAccessRules(<span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>, <span class="hljs-keyword">typeof</span>(NTAccount));
    <span class="hljs-keyword">foreach</span> (FileSystemAccessRule r <span class="hljs-keyword">in</span> rules.Cast&lt;FileSystemAccessRule&gt;()
        .OrderBy(rule =&gt; rule.IdentityReference.Value))
    {
        Console.WriteLine(<span class="hljs-string">$&quot;  <span class="hljs-subst">{r.IdentityReference.Value}</span>&quot;</span>);  <span class="hljs-comment">// ูุซุงู: MyDomain/Joe</span>
        Console.WriteLine(<span class="hljs-string">$&quot;    <span class="hljs-subst">{r.FileSystemRights}</span>: <span class="hljs-subst">{r.AccessControlType}</span>&quot;</span>); <span class="hljs-comment">// FullControl</span>
    }
}

<span class="hljs-keyword">var</span> <span class="hljs-keyword">file</span> = <span class="hljs-string">&quot;sectest.txt&quot;</span>;
File.WriteAllText(<span class="hljs-keyword">file</span>, <span class="hljs-string">&quot;File security test.&quot;</span>);

<span class="hljs-keyword">var</span> sid = <span class="hljs-keyword">new</span> SecurityIdentifier(WellKnownSidType.BuiltinUsersSid, <span class="hljs-literal">null</span>);
<span class="hljs-built_in">string</span> usersAccount = sid.Translate(<span class="hljs-keyword">typeof</span>(NTAccount)).ToString();
Console.WriteLine(<span class="hljs-string">$&quot;User: <span class="hljs-subst">{usersAccount}</span>&quot;</span>);

FileSecurity sec = <span class="hljs-keyword">new</span> FileSecurity(<span class="hljs-keyword">file</span>,
    AccessControlSections.Owner |
    AccessControlSections.Group |
    AccessControlSections.Access);

Console.WriteLine(<span class="hljs-string">&quot;AFTER CREATE:&quot;</span>);
ShowSecurity(sec); <span class="hljs-comment">// BUILTIN\Users ูููุฒ ุฏุณุชุฑุณ Write ูุฏุงุฑุฏ</span>

sec.ModifyAccessRule(AccessControlModification.Add,
    <span class="hljs-keyword">new</span> FileSystemAccessRule(usersAccount, FileSystemRights.Write, AccessControlType.Allow),
    <span class="hljs-keyword">out</span> <span class="hljs-built_in">bool</span> modified);

Console.WriteLine(<span class="hljs-string">&quot;AFTER MODIFY:&quot;</span>);
ShowSecurity(sec); <span class="hljs-comment">// BUILTIN\Users ุงฺฉููู ุฏุณุชุฑุณ Write ุฏุงุฑุฏ</span>
</code></pre>
<p>ูุซุงูโูุง ุจุดุชุฑ ุฏุฑ ุจุฎุด <strong>Special Folders</strong> ุตูุญู 730 ุงุฑุงุฆู ุดุฏู ุงุณุช.</p>
<hr>
<h3>ุงููุช ูุงู ุฏุฑ Unix ๐ง</h3>
<p>ุงุฒ <strong>.NET 7</strong> ุจู ุจุนุฏุ ฺฉูุงุณ <strong>File</strong> ุดุงูู ูุชุฏูุง <strong>GetUnixFileMode</strong> ู <strong>SetUnixFileMode</strong> ุจุฑุง ฺฏุฑูุชู ู ุชุนู ูุฌูุฒ ูุงูโูุง ุฏุฑ Unix ุงุณุช.</p>
<p>ููฺูู ูุชุฏ <strong>Directory.CreateDirectory</strong> ุงูุฑููุฏ ุดุฏู ุชุง ุจุชูุงูุฏ ูุฌูุฒ Unix ุฑุง ุจูพุฐุฑุฏุ ู ููฺฏุงู ุงุฌุงุฏ ูุงู ูโุชูุงู ูุฌูุฒ ุฑุง ูุดุฎุต ฺฉุฑุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> fs = <span class="hljs-keyword">new</span> FileStream(<span class="hljs-string">&quot;test.txt&quot;</span>,
    <span class="hljs-keyword">new</span> FileStreamOptions
    {
        Mode = FileMode.Create,
        UnixCreateMode = UnixFileMode.UserRead | UnixFileMode.UserWrite
    });
</code></pre>
<h3>ฺฉูุงุณ Directory ๐๐ป</h3>
<p>ฺฉูุงุณ <strong>Directory</strong> ฺฉ ฺฉูุงุณ ุงุณุชุง (static) ุงุณุช ฺฉู ูุฌููุนูโุง ุงุฒ ูุชุฏูุง ูุดุงุจู ฺฉูุงุณ <strong>File</strong> ุงุฑุงุฆู ูโุฏูุฏุ ุงุฒ ุฌููู: ุจุฑุฑุณ ูุฌูุฏ ุฏุงุฑฺฉุชูุฑ (<code>Exists</code>)ุ ุฌุงุจุฌุง (<code>Move</code>)ุ ุญุฐู (<code>Delete</code>)ุ ุฏุฑุงูุช/ุชูุธู ุฒูุงู ุงุฌุงุฏ ุง ุขุฎุฑู ุฏุณุชุฑุณุ ู ุฏุฑุงูุช/ุชูุธู ูุฌูุฒูุง ุงููุช.</p>
<p>ูุชุฏูุง ููู ุขู ุนุจุงุฑุชโุงูุฏ ุงุฒ:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-built_in">string</span> <span class="hljs-title">GetCurrentDirectory</span>()</span>;                 <span class="hljs-comment">// ุฏุงุฑฺฉุชูุฑ ุฌุงุฑ</span>
<span class="hljs-function"><span class="hljs-keyword">void</span>   <span class="hljs-title">SetCurrentDirectory</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path</span>)</span>;     <span class="hljs-comment">// ุชูุธู ุฏุงุฑฺฉุชูุฑ ุฌุงุฑ</span>
<span class="hljs-function">DirectoryInfo <span class="hljs-title">CreateDirectory</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path</span>)</span>;  <span class="hljs-comment">// ุงุฌุงุฏ ุฏุงุฑฺฉุชูุฑ</span>
<span class="hljs-function">DirectoryInfo <span class="hljs-title">GetParent</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path</span>)</span>;        <span class="hljs-comment">// ุฏุงุฑฺฉุชูุฑ ูุงูุฏ</span>
<span class="hljs-function"><span class="hljs-built_in">string</span> <span class="hljs-title">GetDirectoryRoot</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path</span>)</span>;        <span class="hljs-comment">// ุฑุดู ุฏุงุฑฺฉุชูุฑ</span>
<span class="hljs-function"><span class="hljs-built_in">string</span>[] <span class="hljs-title">GetLogicalDrives</span>()</span>;                 <span class="hljs-comment">// ุฏุฑุงููุง ุง mount points ุฏุฑ Unix</span>

<span class="hljs-comment">// ุจุงุฒฺฏุฑุฏุงูุฏู ูุณุฑูุง ฺฉุงูู</span>
<span class="hljs-function"><span class="hljs-built_in">string</span>[] <span class="hljs-title">GetFiles</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path</span>)</span>;
<span class="hljs-function"><span class="hljs-built_in">string</span>[] <span class="hljs-title">GetDirectories</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path</span>)</span>;
<span class="hljs-function"><span class="hljs-built_in">string</span>[] <span class="hljs-title">GetFileSystemEntries</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path</span>)</span>;
<span class="hljs-function">IEnumerable&lt;<span class="hljs-built_in">string</span>&gt; <span class="hljs-title">EnumerateFiles</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path</span>)</span>;
<span class="hljs-function">IEnumerable&lt;<span class="hljs-built_in">string</span>&gt; <span class="hljs-title">EnumerateDirectories</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path</span>)</span>;
<span class="hljs-function">IEnumerable&lt;<span class="hljs-built_in">string</span>&gt; <span class="hljs-title">EnumerateFileSystemEntries</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path</span>)</span>;
</code></pre>
<p>ูฺฉุงุช ููู:</p>
<ul>
<li>ูุชุฏูุง <code>Enumerate*</code> ุจู ุตูุฑุช <strong>lazy</strong> ุนูู ูโฺฉููุฏ ู ุฏุงุฏูโูุง ุฑุง ููฺฏุงู ูพูุงุด ุงุฒ ุณุณุชู ูุงู ุฏุฑุงูุช ูโฺฉููุฏุ ุจูุงุจุฑุงู ุจุฑุง <strong>LINQ</strong> ุจุณุงุฑ ููุงุณุจ ูุณุชูุฏ.</li>
<li>ุงู ูุชุฏูุง ูโุชูุงููุฏ ุขุฑฺฏููุงูโูุง <code>searchPattern</code> ู <code>searchOption</code> ุจฺฏุฑูุฏ ู ุจุง <code>SearchOption.SearchAllSubDirectories</code> ุฌุณุชุฌู ุจุงุฒฺฏุดุช ุงูุฌุงู ุฏููุฏ.</li>
<li>ูุชุฏูุง <code>*FileSystemEntries</code> ุชุฑฺฉุจ ุงุฒ ูุงูโูุง ู ุฏุงุฑฺฉุชูุฑโูุง ูุณุชูุฏ.</li>
</ul>
<p>ุงุฌุงุฏ ฺฉ ุฏุงุฑฺฉุชูุฑ ุชููุง ุฏุฑ ุตูุฑุช ุนุฏู ูุฌูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">if</span> (!Directory.Exists(<span class="hljs-string">@&quot;d:\test&quot;</span>))
    Directory.CreateDirectory(<span class="hljs-string">@&quot;d:\test&quot;</span>);
</code></pre>
<hr>
<h3>FileInfo ู DirectoryInfo ๐</h3>
<p>ูุชุฏูุง ุงุณุชุง ุจุฑุง ุนููุงุช ฺฉุจุงุฑู ููุงุณุจ ูุณุชูุฏุ ุงูุง ุงฺฏุฑ ูุงุฒ ุจู ูุฌููุนูโุง ุงุฒ ุนููุงุช ูพุดุช ุณุฑ ูู ุฏุงุฑุฏุ ุงุณุชูุงุฏู ุงุฒ ฺฉูุงุณโูุง <strong>FileInfo</strong> ู <strong>DirectoryInfo</strong> ุฑุงุญุชโุชุฑ ุงุณุช.</p>
<ul>
<li><strong>FileInfo</strong> ุงฺฉุซุฑ ูุชุฏูุง ฺฉูุงุณ <strong>File</strong> ุฑุง ุจู ุตูุฑุช instance ุงุฑุงุฆู ูโุฏูุฏ ู ูฺฺฏโูุง ุงุถุงู ูุซู <code>Extension</code>ุ <code>Length</code>ุ <code>IsReadOnly</code> ู <code>Directory</code> ุฏุงุฑุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">static</span> <span class="hljs-built_in">string</span> TestDirectory =&gt;
    RuntimeInformation.IsOSPlatform(OSPlatform.Windows)
        ? <span class="hljs-string">@&quot;C:\Temp&quot;</span> 
        : <span class="hljs-string">&quot;/tmp&quot;</span>;

Directory.CreateDirectory(TestDirectory);
FileInfo fi = <span class="hljs-keyword">new</span> FileInfo(Path.Combine(TestDirectory, <span class="hljs-string">&quot;FileInfo.txt&quot;</span>));

Console.WriteLine(fi.Exists);          <span class="hljs-comment">// false</span>
<span class="hljs-keyword">using</span> (TextWriter w = fi.CreateText())
    w.Write(<span class="hljs-string">&quot;Some text&quot;</span>);

fi.Refresh();
Console.WriteLine(fi.Exists);          <span class="hljs-comment">// true</span>
Console.WriteLine(fi.Name);            <span class="hljs-comment">// FileInfo.txt</span>
Console.WriteLine(fi.FullName);        <span class="hljs-comment">// c:\temp\FileInfo.txt (Windows) ุง /tmp/FileInfo.txt (Unix)</span>
Console.WriteLine(fi.DirectoryName);   <span class="hljs-comment">// c:\temp ุง /tmp</span>
Console.WriteLine(fi.Directory.Name);  <span class="hljs-comment">// temp</span>
Console.WriteLine(fi.Extension);       <span class="hljs-comment">// .txt</span>
Console.WriteLine(fi.Length);          <span class="hljs-comment">// 9</span>
fi.Encrypt();
fi.Attributes ^= FileAttributes.Hidden; <span class="hljs-comment">// ุชุบุฑ ูพุฑฺู Hidden</span>
fi.IsReadOnly = <span class="hljs-literal">true</span>;
Console.WriteLine(fi.Attributes);      <span class="hljs-comment">// ReadOnly, Archive, Hidden, Encrypted</span>
Console.WriteLine(fi.CreationTime);   <span class="hljs-comment">// ุฒูุงู ุงุฌุงุฏ</span>
fi.MoveTo(Path.Combine(TestDirectory, <span class="hljs-string">&quot;FileInfoX.txt&quot;</span>)); 
</code></pre>
<ul>
<li><strong>DirectoryInfo</strong> ุจุฑุง ูพูุงุด ุฏุงุฑฺฉุชูุฑโูุง ู ูุงูโูุง ููุงุณุจ ุงุณุช:</li>
</ul>
<pre class="hljs"><code>DirectoryInfo di = <span class="hljs-keyword">new</span> DirectoryInfo(<span class="hljs-string">@&quot;e:\photos&quot;</span>);

<span class="hljs-keyword">foreach</span> (FileInfo fi <span class="hljs-keyword">in</span> di.GetFiles(<span class="hljs-string">&quot;*.jpg&quot;</span>))
    Console.WriteLine(fi.Name);

<span class="hljs-keyword">foreach</span> (DirectoryInfo subDir <span class="hljs-keyword">in</span> di.GetDirectories())
    Console.WriteLine(subDir.FullName);
</code></pre>
<hr>
<h3>ฺฉูุงุณ Path ๐ค๏ธ</h3>
<p>ฺฉูุงุณ <strong>Path</strong> ุจู ุตูุฑุช ุงุณุชุง ูุชุฏูุง ู ููุฏูุง ุจุฑุง ฺฉุงุฑ ุจุง ูุณุฑูุง ู ูุงู ูุงูโูุง ุงุฑุงุฆู ูโุฏูุฏ.</p>
<p>ูุซุงู:</p>
<pre class="hljs"><code><span class="hljs-built_in">string</span> dir  = <span class="hljs-string">@&quot;c:\mydir&quot;</span>;    <span class="hljs-comment">// ุง /mydir</span>
<span class="hljs-built_in">string</span> <span class="hljs-keyword">file</span> = <span class="hljs-string">&quot;myfile.txt&quot;</span>;
<span class="hljs-built_in">string</span> path = <span class="hljs-string">@&quot;c:\mydir\myfile.txt&quot;</span>;    <span class="hljs-comment">// ุง /mydir/myfile.txt</span>
Directory.SetCurrentDirectory(<span class="hljs-string">@&quot;k:\demo&quot;</span>);  <span class="hljs-comment">// ุง /demo</span>
</code></pre>
<p>ุจุง ุงู setup ูโุชูุงู ุงุฒ ูุชุฏูุง ฺฉูุงุณ <strong>Path</strong> ุจุฑุง ุฏุณุชฺฉุงุฑ ุฑุดุชูโูุง ูุณุฑ ู ูุงู ูุงู ุงุณุชูุงุฏู ฺฉุฑุฏุ ูุงููุฏ ุชุฑฺฉุจ ูุณุฑุ ุงุณุชุฎุฑุงุฌ ูุงู ูุงูุ ุงุณุชุฎุฑุงุฌ ูพุณููุฏุ ู ุบุฑู.</p>
<div align="center">
<p><img src="../../../assets/image/15/Table-15-9.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>ูุชุฏูุง ฺฉูุงุณ Path ู ูุฏุฑุช ูพูุดูโูุง ูฺู ๐ค๏ธ๐</h3>
<h4>ฑ. <strong>Path.Combine</strong></h4>
<p>ูุชุฏ <strong>Combine</strong> ุจุณุงุฑ ููุฏ ุงุณุชุ ุฒุฑุง ุจู ุดูุง ุงูฺฉุงู ูโุฏูุฏ ฺฉ ุฏุงุฑฺฉุชูุฑ ู ูุงู ูุงู ุง ุฏู ุฏุงุฑฺฉุชูุฑ ุฑุง ุจุฏูู ุจุฑุฑุณ ูุฌูุฏ ุง ูุจูุฏู ุฌุฏุงฺฉููุฏู ูุณุฑ ุชุฑฺฉุจ ฺฉูุฏ.</p>
<ul>
<li>ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ุฌุฏุงฺฉููุฏู ููุงุณุจ ุณุณุชู ุนุงูู ุฑุง ุงุณุชูุงุฏู ูโฺฉูุฏ.</li>
<li>ุงูุฑููุฏูุง ุฏุงุฑุฏ ฺฉู ุชุง ฺูุงุฑ ูุณุฑ ุง ูุงู ูุงู ุฑุง ูโูพุฐุฑุฏ.</li>
</ul>
<h4>ฒ. <strong>GetFullPath</strong></h4>
<p>ุชุจุฏู ูุณุฑ ูุณุจ ุจู ูุณุฑ ฺฉุงูู (Absolute).</p>
<pre class="hljs"><code><span class="hljs-built_in">string</span> fullPath = Path.GetFullPath(<span class="hljs-string">@&quot;..\..\file.txt&quot;</span>);
</code></pre>
<h4>ณ. <strong>GetRandomFileName ู GetTempFileName</strong></h4>
<ul>
<li><code>GetRandomFileName</code> ูุงู ูุงู ธ.ณ ููุญุตุฑ ุจูโูุฑุฏ ุชููุฏ ูโฺฉูุฏ ุจุฏูู ุงุฌุงุฏ ูุงู ูุงูุน.</li>
<li><code>GetTempFileName</code> ูุงู ูุงู ูููุช ุงุฌุงุฏ ูโฺฉูุฏ ู ูุงู ุตูุฑ ุจุงุช ุฏุฑ ุฏุงุฑฺฉุชูุฑ temp ูโุณุงุฒุฏ.<br>
โ๏ธ ูพุณ ุงุฒ ุงุณุชูุงุฏู ุจุงุฏ ุขู ุฑุง ุญุฐู ฺฉูุฏุ ุฏุฑ ุบุฑ ุงู ุตูุฑุช ูพุณ ุงุฒ ถตฐฐฐ ุจุงุฑ ูุฑุงุฎูุงู ุงุณุชุซูุง ุงุฌุงุฏ ูโุดูุฏ.</li>
</ul>
<p>ุงฺฏุฑ ูุดฺฉู ุงุฌุงุฏ ุดุฏุ ูโุชูุงู ุงุฒ ุชุฑฺฉุจ <code>GetTempPath</code> ุจุง <code>GetRandomFileName</code> ุงุณุชูุงุฏู ฺฉุฑุฏุ ุงูุง ูุฑุงูุจ ูพุฑ ุดุฏู ูุงุฑุฏ ุจุงุดุฏ.</p>
<hr>
<h3>ูพูุดูโูุง ูฺู (Special Folders) ๐</h3>
<p>ฺฉูุงุณ <strong>Path</strong> ู <strong>Directory</strong> ูพูุดูโูุง ูฺู ูุซู <strong>My Documents</strong> ุง <strong>Program Files</strong> ุฑุง ูพูุดุด ููโุฏููุฏ. ุจุฑุง ุงู ฺฉุงุฑ ุงุฒ:</p>
<pre class="hljs"><code><span class="hljs-built_in">string</span> myDocPath = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
</code></pre>
<ul>
<li><code>Environment.SpecialFolder</code> ฺฉ enum ุงุณุช ฺฉู ุชูุงู ูพูุดูโูุง ูฺู ููุฏูุฒ ุฑุง ุดุงูู ูโุดูุฏ: AdminTools, ApplicationData, Fonts, StartMenu ู ุบุฑู.</li>
<li>ูุณุฑ runtime ุฏุงุชโูุช ุจุง:</li>
</ul>
<pre class="hljs"><code>System.Runtime.InteropServices.RuntimeEnvironment.GetRuntimeDirectory()
</code></pre>
<h4>ูฺฉุงุช ููู ุฏุฑ ููุฏูุฒ</h4>
<ul>
<li><strong>ApplicationData:</strong> ุฏุงุฏูโูุง ฺฉุงุฑุจุฑ ฺฉู ุฏุฑ ุดุจฺฉู ููุชูู ูโุดููุฏ (ุฑูุงููฺฏ).</li>
<li><strong>LocalApplicationData:</strong> ุฏุงุฏูโูุง ูุญู ฺฉุงุฑุจุฑุ ุจุฏูู ุฑุงููฺฏ.</li>
<li><strong>CommonApplicationData:</strong> ุฏุงุฏูโูุง ูุดุชุฑฺฉ ุจู ฺฉุงุฑุจุฑุงู.</li>
</ul>
<p>ุฑุนุงุช ุงุณุชุงูุฏุงุฑุฏ: ุงุฌุงุฏ ฺฉ ุฒุฑูพูุดู ุจุง ูุงู ุจุฑูุงูู ุดูุง ุจุฑุง ุฐุฎุฑูโุณุงุฒ ุฏุงุฏูโูุง.</p>
<pre class="hljs"><code><span class="hljs-built_in">string</span> localAppDataPath = Path.Combine(
    Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData),
    <span class="hljs-string">&quot;MyCoolApplication&quot;</span>
);
<span class="hljs-keyword">if</span> (!Directory.Exists(localAppDataPath))
    Directory.CreateDirectory(localAppDataPath);
</code></pre>
<p>โ๏ธ ูฺฉุชู: ุงฺฏุฑ ุจุฑูุงูู ุจุง ุณุทุญ ุฏุณุชุฑุณ ูุฏุฑ ุงุฌุฑุง ุดูุฏ ู ูพูุดูโูุง ุฏุฑ <code>CommonApplicationData</code> ุงุฌุงุฏ ุดููุฏุ ฺฉุงุฑุจุฑุงู ุจุง ุฏุณุชุฑุณ ูุญุฏูุฏ ููฺฉู ุงุณุช ูุชูุงููุฏ ูุงูโูุง ุฑุง ุจุนุฏุงู ุชุบุฑ ุฏููุฏ. ุฑุงูโุญู: ุงุฌุงุฏ ูพูุดูโูุง ุจุง ูุฌูุฒ ููุงุณุจ ุฏุฑ ูุฑุขูุฏ ูุตุจ.</p>
<hr>
<h3>Querying Volume Information ๐ฝ</h3>
<p>ุจุฑุง ุฏุฑุงูุช ุงุทูุงุนุงุช ุฏุฑุงููุง ุงุฒ <strong>DriveInfo</strong> ุงุณุชูุงุฏู ูโฺฉูู:</p>
<pre class="hljs"><code>DriveInfo c = <span class="hljs-keyword">new</span> DriveInfo(<span class="hljs-string">&quot;C&quot;</span>); <span class="hljs-comment">// ุง &quot;/&quot; ุฏุฑ Unix</span>
<span class="hljs-built_in">long</span> totalSize = c.TotalSize;
<span class="hljs-built_in">long</span> freeBytes = c.TotalFreeSpace;
<span class="hljs-built_in">long</span> freeToMe  = c.AvailableFreeSpace;

<span class="hljs-keyword">foreach</span> (DriveInfo d <span class="hljs-keyword">in</span> DriveInfo.GetDrives())
{
    Console.WriteLine(d.Name);          <span class="hljs-comment">// C:\</span>
    Console.WriteLine(d.DriveType);     <span class="hljs-comment">// Fixed</span>
    Console.WriteLine(d.RootDirectory); <span class="hljs-comment">// C:\</span>
    <span class="hljs-keyword">if</span> (d.IsReady)
    {
        Console.WriteLine(d.VolumeLabel); <span class="hljs-comment">// ุจุฑฺุณุจ ุฏุฑุงู</span>
        Console.WriteLine(d.DriveFormat); <span class="hljs-comment">// NTFS, FAT ู ุบุฑู</span>
    }
}
</code></pre>
<ul>
<li><code>GetDrives</code> ููู ุฏุฑุงููุง ุชุนุฑูโุดุฏูุ ุดุงูู CD-ROMุ ฺฉุงุฑุช ุญุงูุธู ู ุดุจฺฉู ุฑุง ุจุงุฒูโฺฏุฑุฏุงูุฏ.</li>
<li><code>DriveType</code> enum: <code>Unknown, NoRootDirectory, Removable, Fixed, Network, CDRom, Ram</code>.</li>
</ul>
<hr>
<h3>ูุงูุชูุฑ ฺฉุฑุฏู ุชุบุฑุงุช ูุงู ู ุฏุงุฑฺฉุชูุฑ ุจุง FileSystemWatcher ๐</h3>
<ul>
<li><strong>FileSystemWatcher</strong> ุงูฺฉุงู ูุงูุชูุฑ ฺฉุฑุฏู ฺฉ ุฏุงุฑฺฉุชูุฑ ู ุฒุฑุดุงุฎูโูุง ุขู ุจุฑุง ูุนุงูุชโูุง ุฑุง ูุฑุงูู ูโฺฉูุฏ.</li>
<li>ุฑูุฏุงุฏูุง ุฏุงุฑุฏ ฺฉู ููฺฏุงู ุงุฌุงุฏุ ุชุบุฑุ ุญุฐูุ ุชุบุฑ ูุงู ุง ุชุบุฑ ูฺฺฏ ูุงู/ุฏุงุฑฺฉุชูุฑ ูุนุงู ูโุดููุฏ.</li>
</ul>
<p>ูุซุงู:</p>
<pre class="hljs"><code>Watch(GetTestDirectory(), <span class="hljs-string">&quot;*.txt&quot;</span>, <span class="hljs-literal">true</span>);

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Watch</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path, <span class="hljs-built_in">string</span> filter, <span class="hljs-built_in">bool</span> includeSubDirs</span>)</span>
{
    <span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> watcher = <span class="hljs-keyword">new</span> FileSystemWatcher(path, filter);
    watcher.Created += FileCreatedChangedDeleted;
    watcher.Changed += FileCreatedChangedDeleted;
    watcher.Deleted += FileCreatedChangedDeleted;
    watcher.Renamed += FileRenamed;
    watcher.Error   += FileError;
    watcher.IncludeSubdirectories = includeSubDirs;
    watcher.EnableRaisingEvents = <span class="hljs-literal">true</span>;

    Console.WriteLine(<span class="hljs-string">&quot;Listening for events - press &lt;enter&gt; to end&quot;</span>);
    Console.ReadLine();
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">FileCreatedChangedDeleted</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> o, FileSystemEventArgs e</span>)</span>
    =&gt; Console.WriteLine(<span class="hljs-string">&quot;File {0} has been {1}&quot;</span>, e.FullPath, e.ChangeType);

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">FileRenamed</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> o, RenamedEventArgs e</span>)</span>
    =&gt; Console.WriteLine(<span class="hljs-string">&quot;Renamed: {0}-&gt;{1}&quot;</span>, e.OldFullPath, e.FullPath);

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">FileError</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> o, ErrorEventArgs e</span>)</span>
    =&gt; Console.WriteLine(<span class="hljs-string">&quot;Error: &quot;</span> + e.GetException().Message);

<span class="hljs-function"><span class="hljs-built_in">string</span> <span class="hljs-title">GetTestDirectory</span>()</span> =&gt;
    RuntimeInformation.IsOSPlatform(OSPlatform.Windows) ? <span class="hljs-string">@&quot;C:\Temp&quot;</span> : <span class="hljs-string">&quot;/tmp&quot;</span>;
</code></pre>
<p>ูฺฉุงุช ููู:</p>
<ul>
<li>ุฑูุฏุงุฏูุง ุฏุฑ ฺฉ <strong>Thread ุฌุฏุงฺฏุงูู</strong> ุงุฌุฑุง ูโุดููุฏุ ุจูุงุจุฑุงู ุจุงุฏ ูุฏุฑุช ุงุณุชุซูุง ุฏุงุดุชู ุจุงุดุฏ.</li>
<li>ุฑูุฏุงุฏ <code>Error</code> ูุดุงูโุฏููุฏู overflow ุจุงูุฑ ุฏุงุฎู ุงุณุช. ุจุง <code>InternalBufferSize</code> ูโุชูุงู ุจุงูุฑ ุฑุง ุชุบุฑ ุฏุงุฏ.</li>
<li><code>IncludeSubdirectories</code> ุจู ุตูุฑุช ุจุงุฒฺฏุดุช ุงุนูุงู ูโุดูุฏ.</li>
<li>ูุฑุงูุจ ุจุงุดุฏ ูุงูโูุง ุฑุง ูุจู ุงุฒ ุงูฺฉู ฺฉุงููุงู ููุดุชู ุดููุฏุ ุจุงุฒ ูฺฉูุฏุ ููฺฉู ุงุณุช ูุงุฒ ุจู ุงุณุชุฑุงุชฺโูุง ูุซู ููุดุชู ุจุง ูพุณููุฏ ูููุช ู ุชุบุฑ ูุงู ุจุนุฏ ุงุฒ ุชฺฉูู ุฏุงุดุชู ุจุงุดุฏ.</li>
</ul>
<h3>ุงููุช ุณุณุชูโุนุงูู (OS Security) ๐ก๏ธ</h3>
<p>ููู ุจุฑูุงููโูุง ุชุญุช ูุญุฏูุฏุชโูุง ุณุณุชูโุนุงูู ุงุฌุฑุง ูโุดููุฏ ู ุงู ูุญุฏูุฏุชโูุง ุจุฑ ุงุณุงุณ ุณุทุญ ุฏุณุชุฑุณ ฺฉุงุฑุจุฑ ุงุนูุงู ูโุดููุฏ. ุงู ูุญุฏูุฏุชโูุง ุนูุงูู ุจุฑ I/O ูุงูุ ุจุฑ ุฏุณุชุฑุณ ุจู ููุงุจุน ุฏฺฏุฑ ูุซู <strong>Windows Registry</strong> ูู ุชุฃุซุฑ ุฏุงุฑูุฏ.</p>
<hr>
<h4>ฑ. <strong>ุงููุงุน ุญุณุงุจ ฺฉุงุฑุจุฑ</strong></h4>
<ul>
<li><strong>ุญุณุงุจ ฺฉุงุฑุจุฑ ุงุฏูู / ุณููพุฑ ูุฒุฑ:</strong> ุจุฏูู ูุญุฏูุฏุช ุฏุฑ ุฏุณุชุฑุณ ุจู ฺฉุงููพูุชุฑ ูุญู.</li>
<li><strong>ุญุณุงุจ ุจุง ุฏุณุชุฑุณ ูุญุฏูุฏ:</strong> ุนููฺฉุฑุฏูุง ูุฏุฑุช ูุญุฏูุฏ ู ุฏุณุชุฑุณ ุจู ุฏุงุฏูโูุง ุฏฺฏุฑ ฺฉุงุฑุจุฑุงู ูุญุฏูุฏ ุงุณุช.</li>
</ul>
<p>ุฏุฑ ููุฏูุฒุ ูฺฺฏ <strong>User Account Control (UAC)</strong> ุจุงุนุซ ูโุดูุฏ ููฺฏุงู ูุฑูุฏุ ูุฏุฑ ุณุณุชู ุฏู ุชูฺฉู ุง โฺฉูุงูโ ุฏุงุดุชู ุจุงุดุฏ:</p>
<ol>
<li>ฺฉูุงู ูุฏุฑ (Administrative)</li>
<li>ฺฉูุงู ฺฉุงุฑุจุฑ ุนุงุฏ (Ordinary User)</li>
</ol>
<p>ุจูโุทูุฑ ูพุดโูุฑุถ ุจุฑูุงููโูุง ุจุง ฺฉูุงู ฺฉุงุฑุจุฑ ุนุงุฏ ุงุฌุฑุง ูโุดููุฏ ูฺฏุฑ ุงูฺฉู ุฏุฑุฎูุงุณุช ุฏุณุชุฑุณ ูุฏุฑุช ฺฉููุฏ ู ฺฉุงุฑุจุฑ ุขู ุฑุง ุชุฃุฏ ฺฉูุฏ.</p>
<p>ุฏุฑ Unixุ ฺฉุงุฑุจุฑุงู ูุนูููุงู ุจุง ุญุณุงุจ ูุญุฏูุฏ ูุงุฑุฏ ูโุดููุฏ ู ุจุฑุง ุงุฌุฑุง ุฏุณุชูุฑุงุช ุจุง ุฏุณุชุฑุณ ุจุงูุง ุงุฒ <code>sudo</code> ุงุณุชูุงุฏู ูโฺฉููุฏ.</p>
<hr>
<h4>ฒ. <strong>ุงุฌุฑุง ุจุฑูุงูู ุจุง ุฏุณุชุฑุณ ูุญุฏูุฏ</strong></h4>
<ul>
<li>
<p>ุจูโุทูุฑ ูพุดโูุฑุถุ ุจุฑูุงููโูุง ุจุง ูุญุฏูุฏุช ฺฉุงุฑุจุฑ ุงุฌุฑุง ูโุดููุฏ. ุจูุงุจุฑุงู ุจุงุฏ:</p>
<ol>
<li>ุจุฑูุงูู ุฑุง ุทูุฑ ุทุฑุงุญ ฺฉูุฏ ฺฉู ุจุฏูู ุฏุณุชุฑุณ ูุฏุฑ ฺฉุงุฑ ฺฉูุฏ (<strong>ฺฏุฒูู ุงููโุชุฑ ู ุฑุงุญุชโุชุฑ</strong>)</li>
<li>ุง ุฏุณุชุฑุณ ูุฏุฑุช ุฑุง ุงุฒ ุทุฑู <strong>Application Manifest</strong> ุฏุฑุฎูุงุณุช ฺฉูุฏ (ููุฏูุฒ)</li>
</ol>
</li>
</ul>
<p>ุจุฑุง ุชุดุฎุต ุงูฺฉู ุจุฑูุงูู ุจุง ุฏุณุชุฑุณ ูุฏุฑ ุงุฌุฑุง ูโุดูุฏ:</p>
<pre class="hljs"><code>[<span class="hljs-meta">DllImport(<span class="hljs-string">&quot;libc&quot;</span>)</span>]
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">extern</span> <span class="hljs-built_in">uint</span> <span class="hljs-title">getuid</span>()</span>;

<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">IsRunningAsAdmin</span>()</span>
{
    <span class="hljs-keyword">if</span> (RuntimeInformation.IsOSPlatform(OSPlatform.Windows))
    {
        <span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> identity = WindowsIdentity.GetCurrent();
        <span class="hljs-keyword">var</span> principal = <span class="hljs-keyword">new</span> WindowsPrincipal(identity);
        <span class="hljs-keyword">return</span> principal.IsInRole(WindowsBuiltInRole.Administrator);
    }
    <span class="hljs-keyword">return</span> getuid() == <span class="hljs-number">0</span>;
}
</code></pre>
<ul>
<li>ุฏุฑ ููุฏูุฒุ ููุท ุฏุฑ ุตูุฑุช ูุนุงู ุจูุฏู UAC ู Elevationุ ููุฏุงุฑ true ุจุฑูโฺฏุฑุฏุฏ.</li>
<li>ุฏุฑ ูููฺฉุณุ true ููุท ููุช ูุฑุขูุฏ ุจุง sudo ุงุฌุฑุง ุดูุฏ.</li>
</ul>
<hr>
<h4>ณ. <strong>ูุญุฏูุฏุชโูุง ุญุณุงุจ ฺฉุงุฑุจุฑ ุนุงุฏ</strong></h4>
<p>ฺฉุงุฑูุง ฺฉู ููโุชูุงู ุจุง ุญุณุงุจ ุนุงุฏ ุงูุฌุงู ุฏุงุฏ:</p>
<ul>
<li>ููุดุชู ุฏุฑ ูพูุดูโูุง ุณุณุชู (ูุซูุงู <code>\Windows</code> ุง <code>/bin, /sbin</code>) ู ุฒุฑุดุงุฎูโูุง</li>
<li>ููุดุชู ุฏุฑ ูพูุดู Program Files ุง <code>/usr/bin, /opt</code></li>
<li>ููุดุชู ุฏุฑ ุฑุดู ุฏุฑุงู ุณุณุชู (<code>C:\</code> ุง <code>/</code>)</li>
<li>ููุดุชู ุฏุฑ ุดุงุฎู <code>HKEY_LOCAL_MACHINE</code> ุฏุฑ Registry ููุฏูุฒ</li>
<li>ุฎูุงูุฏู ุฏุงุฏูโูุง Performance Monitoring (WMI ุฏุฑ ููุฏูุฒ)</li>
</ul>
<p>ููฺูู ููฺฉู ุงุณุช ุฏุณุชุฑุณ ุจู ูุงูโูุง ุง ููุงุจุน ุฏฺฏุฑ ฺฉุงุฑุจุฑุงู ูุญุฏูุฏ ุจุงุดุฏ. ููุฏูุฒ ุงุฒ <strong>Access Control List (ACL)</strong> ุจุฑุง ูุญุงูุธุช ุงุณุชูุงุฏู ูโฺฉูุฏ ู ุงฺฏุฑ ุฏุณุชุฑุณ ุฑุฏ ุดูุฏุ CLR ุงุณุชุซูุง <strong>UnauthorizedAccessException</strong> ูพุฑุชุงุจ ูโฺฉูุฏ.</p>
<p><strong>ุฑุงูฺฉุงุฑ ููุงุจูู ุจุง ูุญุฏูุฏุชโูุง:</strong></p>
<ul>
<li>ูุงูโูุง ุฑุง ุฏุฑ ูฺฉุงูโูุง ุชูุตูโุดุฏู ฺฉุงุฑุจุฑ ุฐุฎุฑู ฺฉูุฏ.</li>
<li>ุงุฒ Registry ููุท ุจุฑุง HKEY_CURRENT_USER ุงุณุชูุงุฏู ฺฉูุฏ.</li>
<li>ฺฉุงููพูููุชโูุง ActiveX ุง COM ุฑุง ุฏุฑ ูุฑุขูุฏ ูุตุจ ุซุจุช ฺฉูุฏ.</li>
</ul>
<hr>
<h4>ด. <strong>ูฺฉุงูโูุง ูพุดููุงุฏ ุฐุฎุฑูโุณุงุฒ ูุงูโูุง</strong></h4>
<pre class="hljs"><code><span class="hljs-built_in">string</span> docsFolder = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
<span class="hljs-built_in">string</span> path = Path.Combine(docsFolder, <span class="hljs-string">&quot;test.txt&quot;</span>);

<span class="hljs-built_in">string</span> configFolder = Path.Combine(
    Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData), <span class="hljs-comment">// ุจุฑุง ฺฉุงุฑุจุฑ ูุนู</span>
    <span class="hljs-string">&quot;MyApp&quot;</span>
);
<span class="hljs-keyword">if</span> (!Directory.Exists(configFolder))
    Directory.CreateDirectory(configFolder);
</code></pre>
<p>โ๏ธ ุชูุฌู: ุงุณุชูุงุฏู ุงุฒ <code>CommonApplicationData</code> ุจุฑุง ุฏุณุชุฑุณ ููู ฺฉุงุฑุจุฑุงูุ ุจุงุฏ ุจุง ุชูุธู ูุฌูุฒูุง ููุฑุงู ุจุงุดุฏ.</p>
<hr>
<h4>ต. <strong>Elevation ูุฏุฑุช ู Virtualization ููุฏูุฒ</strong></h4>
<p>ุจุง <strong>Application Manifest</strong> ูโุชูุงูุฏ ุฏุฑุฎูุงุณุช ุฏุณุชุฑุณ ูุฏุฑ ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">requestedExecutionLevel</span> <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;requireAdministrator&quot;</span> /&gt;</span>
</code></pre>
<ul>
<li><code>asInvoker</code>: ุจุฑูุงูู ุจุฏูู ุฏุณุชุฑุณ ูุฏุฑ ุงุฌุฑุง ุดูุฏ ู Virtualization ุบุฑูุนุงู ุงุณุช.</li>
</ul>
<p><strong>Virtualization:</strong> ุชุบุฑุงุช ุฏุฑ ูพูุดู Program Files ุง Windows ู HKEY_LOCAL_MACHINE ุจู ูฺฉุงู ุฌุฏุงฺฏุงูู ูุฏุงุช ูโุดูุฏ ุชุง ุงุฒ ุขุณุจ ุจู ุณุณุชู ุฌููฺฏุฑ ุดูุฏ.</p>
<hr>
<h4>ถ. <strong>Memory-Mapped Files</strong> ๐๏ธ</h4>
<p>ูุฒุงุง:</p>
<ol>
<li>ุฏุณุชุฑุณ ุณุฑุน ู ุชุตุงุฏู ุจู ุฏุงุฏูโูุง ูุงู</li>
<li>ุงุดุชุฑุงฺฉ ุญุงูุธู ุจู ูุฑุขูุฏูุง ูุฎุชูู</li>
</ol>
<p>ุฏุฑ ุฏุงุชโูุช ุงุฒ <strong>System.IO.MemoryMappedFiles</strong> ุงุณุชูุงุฏู ูโฺฉูู ฺฉู ุฏุฑ ูุงูุน API ุณุณุชูโุนุงูู ุจุฑุง Memory-Mapped Files ุฑุง ูพูุดุด ูโุฏูุฏ.</p>
<h3>ูุงูโูุง Memory-Mapped ู ุฏุณุชุฑุณ ุชุตุงุฏู ุจู ูุงู ๐๏ธ๐จ</h3>
<p>Memory-mapped files ุจุฑุง ุฏุณุชุฑุณ <strong>ุชุตุงุฏู ู ุณุฑุน</strong> ุจู ุฏุงุฏูโูุง ูุงู ู ููฺูู ุงุดุชุฑุงฺฉ ุญุงูุธู ุจู ูุฑุขูุฏูุง ุงุณุชูุงุฏู ูโุดููุฏ. ุฏุฑ ููุงุณู ุจุง FileStream:</p>
<table>
<thead>
<tr>
<th>ููุน ุฏุณุชุฑุณ</th>
<th>FileStream</th>
<th>Memory-Mapped File</th>
</tr>
</thead>
<tbody>
<tr>
<td>Sequential (ูุชูุงู)</td>
<td>ุณุฑุนโุชุฑ (~10ร)</td>
<td>ฺฉูุฏุชุฑ</td>
</tr>
<tr>
<td>Random (ุชุตุงุฏู)</td>
<td>ฺฉูุฏุชุฑ</td>
<td>ุณุฑุนโุชุฑ (~10ร)</td>
</tr>
</tbody>
</table>
<hr>
<h4>ฑ. ุงุฌุงุฏ ฺฉ Memory-Mapped File</h4>
<ol>
<li>ฺฉ <code>FileStream</code> ูุนููู ุจุณุงุฒุฏ.</li>
<li>ฺฉ <code>MemoryMappedFile</code> ุจุณุงุฒุฏ ู ูุงู ุฑุง ุจู ุขู ุจุฏูุฏ.</li>
<li>ุงุฒ <code>CreateViewAccessor</code> ุจุฑุง ุงุฌุงุฏ <strong>View Accessor</strong> ุงุณุชูุงุฏู ฺฉูุฏ.</li>
</ol>
<pre class="hljs"><code>File.WriteAllBytes(<span class="hljs-string">&quot;long.bin&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-built_in">byte</span>[<span class="hljs-number">1</span>_000_000]);
<span class="hljs-keyword">using</span> MemoryMappedFile mmf = MemoryMappedFile.CreateFromFile(<span class="hljs-string">&quot;long.bin&quot;</span>);
<span class="hljs-keyword">using</span> MemoryMappedViewAccessor accessor = mmf.CreateViewAccessor();

accessor.Write(<span class="hljs-number">500</span>_000, (<span class="hljs-built_in">byte</span>)<span class="hljs-number">77</span>);
Console.WriteLine(accessor.ReadByte(<span class="hljs-number">500</span>_000));  <span class="hljs-comment">// 77</span>
</code></pre>
<ul>
<li>ูโุชูุงู ูุงู Map ู ุธุฑูุช ูุดุฎุต ฺฉุฑุฏ ุชุง ุญุงูุธู ุจู ุงุดุชุฑุงฺฉ ฺฏุฐุงุดุชู ุดูุฏ ุง ุงูุฏุงุฒู ูุงู ุจุฒุฑฺฏโุชุฑ ุดูุฏ.</li>
</ul>
<hr>
<h4>ฒ. ุงุดุชุฑุงฺฉ ุญุงูุธู ุจู ูุฑุขูุฏูุง (Windows)</h4>
<ul>
<li>ฺฉ ูุฑุขูุฏ <code>MemoryMappedFile.CreateNew</code> ุงุฌุงุฏ ูโฺฉูุฏ.</li>
<li>ูุฑุขูุฏูุง ุฏฺฏุฑ ุจุง <code>OpenExisting</code> ุจู ููุงู ุญุงูุธู ุฏุณุชุฑุณ ุฏุงุฑูุฏ.</li>
</ul>
<pre class="hljs"><code><span class="hljs-comment">// Writer</span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> mmFile = MemoryMappedFile.CreateNew(<span class="hljs-string">&quot;Demo&quot;</span>, <span class="hljs-number">500</span>);
<span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> accessor = mmFile.CreateViewAccessor();
accessor.Write(<span class="hljs-number">0</span>, <span class="hljs-number">12345</span>);
Console.ReadLine(); <span class="hljs-comment">// ุญุงูุธู ุฑุง ุฒูุฏู ูฺฏู ูโุฏุงุฑุฏ</span>

<span class="hljs-comment">// Reader (ูุฑุขูุฏ ุฏฺฏุฑ)</span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> mmFile = MemoryMappedFile.OpenExisting(<span class="hljs-string">&quot;Demo&quot;</span>);
<span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> accessor = mmFile.CreateViewAccessor();
Console.WriteLine(accessor.ReadInt32(<span class="hljs-number">0</span>)); <span class="hljs-comment">// 12345</span>
</code></pre>
<hr>
<h4>ณ. ุงุดุชุฑุงฺฉ ุญุงูุธู ุจู ูุฑุขูุฏูุง ุฏุฑ Windows ู Unix</h4>
<ul>
<li>ูุงู ุฑุง ุจุง <code>FileStream</code> ุจุงุฒ ฺฉูุฏ ู ุงุฌุงุฒู ุฎูุงูุฏู/ููุดุชู ูุดุชุฑฺฉ ุจุฏูุฏ (<code>FileShare.ReadWrite</code>).</li>
<li>ุณูพุณ <code>MemoryMappedFile.CreateFromFile</code> ุจุณุงุฒุฏ.</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">var</span> <span class="hljs-keyword">file</span> = Path.Combine(TestDirectory, <span class="hljs-string">&quot;interprocess.bin&quot;</span>);
File.WriteAllBytes(<span class="hljs-keyword">file</span>, <span class="hljs-keyword">new</span> <span class="hljs-built_in">byte</span>[<span class="hljs-number">100</span>]);

<span class="hljs-keyword">using</span> FileStream fs = <span class="hljs-keyword">new</span> FileStream(<span class="hljs-keyword">file</span>, FileMode.Open, FileAccess.ReadWrite, FileShare.ReadWrite);
<span class="hljs-keyword">using</span> MemoryMappedFile mmf = MemoryMappedFile.CreateFromFile(fs, <span class="hljs-literal">null</span>, fs.Length, MemoryMappedFileAccess.ReadWrite, HandleInheritability.None, <span class="hljs-literal">true</span>);
<span class="hljs-keyword">using</span> MemoryMappedViewAccessor accessor = mmf.CreateViewAccessor();
accessor.Write(<span class="hljs-number">0</span>, <span class="hljs-number">12345</span>);
Console.ReadLine();
File.Delete(<span class="hljs-keyword">file</span>);
</code></pre>
<hr>
<h4>ด. ฺฉุงุฑ ุจุง View Accessor</h4>
<ul>
<li><code>Read*</code> ู <code>Write*</code> ุจุฑุง <strong>ููุนโูุง ุนุฏุฏุ boolุ char</strong> ู ุขุฑุงูโูุง/structูุง Value Type ุงุณุชูุงุฏู ูโุดููุฏ.</li>
<li>ุจุฑุง ุฑุดุชูโูุงุ ุจุงุฏ ุงุจุชุฏุง ุขูโูุง ุฑุง ุจู ุขุฑุงู ุจุงุช ุชุจุฏู ฺฉูุฏ.</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">byte</span>[] data = Encoding.UTF8.GetBytes(<span class="hljs-string">&quot;This is a test&quot;</span>);
accessor.Write(<span class="hljs-number">0</span>, data.Length);
accessor.WriteArray(<span class="hljs-number">4</span>, data, <span class="hljs-number">0</span>, data.Length);

<span class="hljs-comment">// ุฎูุงูุฏู ูุฌุฏุฏ</span>
<span class="hljs-built_in">byte</span>[] readData = <span class="hljs-keyword">new</span> <span class="hljs-built_in">byte</span>[accessor.ReadInt32(<span class="hljs-number">0</span>)];
accessor.ReadArray(<span class="hljs-number">4</span>, readData, <span class="hljs-number">0</span>, readData.Length);
Console.WriteLine(Encoding.UTF8.GetString(readData)); <span class="hljs-comment">// This is a test</span>
</code></pre>
<ul>
<li>ฺฉุงุฑ ุจุง struct:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">struct</span> Data { <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> X, Y; }
<span class="hljs-keyword">var</span> data = <span class="hljs-keyword">new</span> Data { X = <span class="hljs-number">123</span>, Y = <span class="hljs-number">456</span> };
accessor.Write(<span class="hljs-number">0</span>, <span class="hljs-keyword">ref</span> data);
accessor.Read(<span class="hljs-number">0</span>, <span class="hljs-keyword">out</span> data);
Console.WriteLine(data.X + <span class="hljs-string">&quot; &quot;</span> + data.Y); <span class="hljs-comment">// 123 456</span>
</code></pre>
<hr>
<h4>ต. ุจูููโุณุงุฒ ุนููฺฉุฑุฏ ุจุง ุงุดุงุฑูโฺฏุฑูุง (Unsafe)</h4>
<ul>
<li>ุงุณุชูุงุฏู ุงุฒ <code>SafeMemoryMappedViewHandle.AcquirePointer</code> ุจุณุงุฑ ุณุฑุนโุชุฑ ุงุฒ <code>Read/Write</code> ุงุณุชุ ูุฎุตูุตุงู ุจุฑุง ุฏุงุฏูโูุง ุจุฒุฑฺฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">unsafe</span>
{
    <span class="hljs-built_in">byte</span>* pointer = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">try</span>
    {
        accessor.SafeMemoryMappedViewHandle.AcquirePointer(<span class="hljs-keyword">ref</span> pointer);
        <span class="hljs-built_in">int</span>* intPointer = (<span class="hljs-built_in">int</span>*)pointer;
        Console.WriteLine(*intPointer); <span class="hljs-comment">// 123</span>
    }
    <span class="hljs-keyword">finally</span>
    {
        <span class="hljs-keyword">if</span> (pointer != <span class="hljs-literal">null</span>)
            accessor.SafeMemoryMappedViewHandle.ReleasePointer();
    }
}
</code></pre>
<ul>
<li>ูุงุฒ ุจู ูุนุงู ฺฉุฑุฏู unsafe code ุฏุฑ ูุงู <code>.csproj</code>:</li>
</ul>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">PropertyGroup</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">AllowUnsafeBlocks</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">AllowUnsafeBlocks</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">PropertyGroup</span>&gt;</span>
</code></pre>
<p>ุฏูู ุงุตู ุจุฑุชุฑ ุนููฺฉุฑุฏ ุงุณุชูุงุฏู ุงุฒ <strong>ุงุดุงุฑูโฺฏุฑูุง (pointers)</strong> ููุช ุจุง ุณุงุฎุชุงุฑูุง ุจุฒุฑฺฏ ฺฉุงุฑ ูโฺฉูู ุงู ุงุณุช ฺฉู ุงุดุงุฑูโฺฏุฑูุง ุงุฌุงุฒู ูโุฏููุฏ ูุณุชููุงู ุจุง ุฏุงุฏูโูุง ุฎุงู (raw data) ฺฉุงุฑ ฺฉููุ ุจุฏูู ุงูฺฉู ูุฌุจูุฑ ุจุงุดู ุงุฒ ูุชุฏูุง <code>Read</code> ู <code>Write</code> ุจุฑุง ฺฉูพ ฺฉุฑุฏู ุฏุงุฏูโูุง ุจู ุญุงูุธู <strong>ูุฏุฑุชโุดุฏู (managed)</strong> ู <strong>ูุฏุฑุชโูุดุฏู (unmanaged)</strong> ุงุณุชูุงุฏู ฺฉูู.</p>
<p>ุงู ฺฉุงุฑ ุจุงุนุซ ุตุฑููโุฌู ูุงุจูโุชูุฌู ุฏุฑ ุฒูุงู ู ููุงุจุน ูโุดูุฏุ ุจูโูฺู ููุช ุญุฌู ุฏุงุฏูโูุง ุฒุงุฏ ุจุงุดุฏ. ุงู ููุถูุน ุฏุฑ <strong>ูุตู ฒด</strong> ฺฉุชุงุจ ุจูโุทูุฑ ฺฉุงูู ุจุฑุฑุณ ุดุฏู ุงุณุช.</p>

  </main>

  <!-- ููุชุฑ ูุดุชุฑฺฉ -->
  <footer class="footer">
    <div class="container">
      <p>
        <img src="/Gitab/icone/copyright.svg" alt="ฺฉูพโุฑุงุช" width="14" height="14"
             style="vertical-align:middle;margin-inline:4px">
        <span id="y"></span> Gitab โ ุจุฑุง ุชูุณุนูโุฏููุฏฺฏุงู
      </p>
    </div>
  </footer>

  <!-- ุณุงู ู ุงุณฺฉุฑูพุช ุชุบุฑ ุชู -->
  <script>
  (() => {
    const root = document.documentElement;
    const btn = document.getElementById('themeToggle');
    const KEY = 'gitab-theme';
    const media = window.matchMedia('(prefers-color-scheme: dark)');
    const getEffective = s => (s === 'auto' ? (media.matches ? 'dark' : 'light') : s);

    function updateTheme(s) {
      root.setAttribute('data-theme', s);
      const mode = getEffective(s);
      root.dataset.colorMode = mode;
      btn.dataset.icon = mode === 'dark' ? 'moon' : 'sun';
    }

    let saved = localStorage.getItem(KEY) || 'auto';
    updateTheme(saved);

    btn.addEventListener('click', () => {
      const current = localStorage.getItem(KEY) || 'auto';
      const next = current === 'auto' ? 'dark' : current === 'dark' ? 'light' : 'auto';
      localStorage.setItem(KEY, next);
      updateTheme(next);
    });

    media.addEventListener('change', () => {
      if ((localStorage.getItem(KEY) || 'auto') === 'auto') updateTheme('auto');
    });

    document.addEventListener('DOMContentLoaded', () => {
      updateTheme(localStorage.getItem(KEY) || 'auto');
    });
  })();
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>

  <script>
  document.querySelectorAll('pre code').forEach(block => {
    const btn = document.createElement('button');
    btn.className = 'copy-btn';

    const icon = document.createElement('img');
    icon.src = "/Gitab/icone/copy.svg";
    icon.alt = 'Copy';
    btn.appendChild(icon);

    block.parentNode.insertBefore(btn, block);

    btn.addEventListener('click', async () => {
      await navigator.clipboard.writeText(block.textContent);
      btn.classList.add('copied');
      setTimeout(() => btn.classList.remove('copied'), 1500);
    });
  });
  </script>

  <script>
  document.body.dataset.page = window.location.pathname;

  const menuBtn = document.querySelector(".menu-toggle");
  const nav = document.querySelector(".nav");

  if (menuBtn && nav) {
    menuBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      nav.classList.toggle("show");
    });

    document.addEventListener("click", (e) => {
      const clickedInsideNav = nav.contains(e.target);
      const clickedMenuButton = menuBtn.contains(e.target);
      if (!clickedInsideNav && !clickedMenuButton) {
        nav.classList.remove("show");
      }
    });
  }
  </script>

  <script>
    document.getElementById('y').textContent = new Date().getFullYear();
  </script>
</body>
</html>
