<!doctype html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Gitab | ฺฉุชุงุจุฎุงููู ุชุฑุฌููโูุง ุฏุงุชโูุช ู ุณ ุดุงุฑูพ</title>
  <meta name="description" content="ุชุฑุฌููโูุง ูุงุฑุณ ฺฉุชุงุจโูุง ูู โ ุณุฑุนุ ูููุงู ู ูุงุจู ุงุชฺฉุง.">
  <link rel="stylesheet" href="/styles/main.css">
</head>
<body>
  <!-- ูุฏุฑ ูุดุชุฑฺฉ -->
  <header class="header">
    <div class="container nav-wrap">
      <a class="brand" href="/">
        <img src="/icone/logo.svg" alt="Gitab" width="28" height="28">
        <span>Gitab</span>
      </a>

      <nav class="nav">
        <a href="/">ุฎุงูู</a>
        <a href="/books/list-books">ฺฉุชุงุจโูุง</a>
        <a href="#">ููฺฉุงุฑ</a>
        <a href="#">ุฏุฑุจุงุฑูโูุง</a>
      </nav>

     <div class="nav-actions">
  <button id="themeToggle" class="icon-btn theme-btn" aria-label="ุชุบุฑ ุญุงูุช">
    <img class="icon-sun" src="/icone/sun.svg" alt="ุฑูุดู">
    <img class="icon-moon" src="/icone/moon.svg" alt="ุชุงุฑฺฉ">
  </button>

  <a class="icon-btn" href="https://github.com/hheydarian/Gitab" target="_blank" title="GitHub">
    <img src="/icone/github.svg" alt="GitHub">
  </a>
</div>

  </header>

  <!-- ูุญุชูุง ุตูุญู -->
  <main class="site-main">
    <h1>ูุตู ุงุฒุฏูู: ุณุงุฑ ุชฺฉููููฺโูุง XML ู JSON</h1>
<p>ุฏุฑ <strong>ูุตู ฑฐ</strong>ุ ูุง API ูุฑุจูุท ุจู <strong>LINQ-to-XML</strong> ู ุจูโุทูุฑ ฺฉู XML ุฑุง ุจุฑุฑุณ ฺฉุฑุฏู.
ุฏุฑ ุงู ูุตูุ ุจู ุณุฑุงุบ <strong>ฺฉูุงุณโูุง ุณุทุญ ูพุงู XmlReader/XmlWriter</strong> ู ููฺูู <strong>ุงููุงุน ุฏุงุฏูโูุง ุจุฑุง ฺฉุงุฑ ุจุง JSON (JavaScript Object Notation)</strong> ูโุฑููุ ฺฉู ุจูโุนููุงู ฺฉ ุฌุงฺฏุฒู ูุญุจูุจ ุจุฑุง XML ุดูุงุฎุชู ูโุดูุฏ.</p>
<p>ุฏุฑ ุถูููโ ุขููุงู ๐ุ ุงุจุฒุงุฑูุง ุจุฑุง ฺฉุงุฑ ุจุง <strong>XML Schema</strong> ู <strong>Stylesheet</strong>โูุง ุชูุถุญ ุฏุงุฏู ุดุฏูโุงูุฏ.</p>
<hr>
<h3>XmlReader โก</h3>
<p><strong>XmlReader</strong> ฺฉ ฺฉูุงุณ ุจุง ฺฉุงุฑุง ุจุงูุง ุงุณุช ฺฉู ุจุฑุง ุฎูุงูุฏู ฺฉ ุฌุฑุงู (Stream) ุงุฒ XML ุจูโุตูุฑุช ุณุทุญ ูพุงู ู ููุท ุฑู ุจู ุฌูู ุงุณุชูุงุฏู ูโุดูุฏ.</p>
<p>ุจู ูุซุงู ุฒุฑ ุงุฒ ฺฉ ูุงู XML ุจู ูุงู <code>customer.xml</code> ุชูุฌู ฺฉูุฏ:</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;customer id=&quot;123&quot; status=&quot;archived&quot;&gt;
  &lt;firstname&gt;Jim&lt;/firstname&gt;
  &lt;lastname&gt;Bo&lt;/lastname&gt;
&lt;/customer&gt;
</code></pre>
<p>ุจุฑุง ุณุงุฎุชู ฺฉ ุดุก ุงุฒ ููุน <code>XmlReader</code>ุ ฺฉุงู ุงุณุช ูุชุฏ ุงุณุชุงุชฺฉ <code>XmlReader.Create</code> ุฑุง ุตุฏุง ุจุฒูุฏ ู ฺฉ <code>Stream</code>ุ ุง ฺฉ <code>TextReader</code>ุ ุง ฺฉ ุฑุดุชูโ URI ุจู ุขู ุจุฏูุฏ:</p>
<pre><code class="language-csharp">using XmlReader reader = XmlReader.Create(&quot;customer.xml&quot;);
...
</code></pre>
<p>ุงุฒ ุขูโุฌุง ฺฉู <strong>XmlReader</strong> ูโุชูุงูุฏ ุฏุงุฏูโูุง ุฑุง ุงุฒ ููุงุจุน ฺฉูุฏ (ูุซู <code>Stream</code>โูุง ู URIูุง) ุจุฎูุงูุฏุ ูุณุฎูโูุง <strong>asynchronous</strong> ุจุฑุง ุจุดุชุฑ ูุชุฏูุง ุฎูุฏ ุงุฑุงุฆู ูโุฏูุฏ ุชุง ุจุชูุงูุฏ ุจูโุณุงุฏฺฏ ฺฉุฏูุง <strong>nonblocking</strong> ุจููุณุฏ.
(ูุง ููุถูุน <strong>asynchrony</strong> ุฑุง ุจูโุทูุฑ ฺฉุงูู ุฏุฑ ูุตู ฑด ุจุฑุฑุณ ูโฺฉูู.)</p>
<hr>
<p>ุจุฑุง ุณุงุฎุชู ฺฉ <code>XmlReader</code> ฺฉู ุงุฒ <strong>ุฑุดุชู (string)</strong> ุจุฎูุงูุฏ:</p>
<pre><code class="language-csharp">using XmlReader reader = XmlReader.Create(
    new System.IO.StringReader(myString));
</code></pre>
<p>ุดูุง ููฺูู ูโุชูุงูุฏ ฺฉ ุดุก ุงุฒ ููุน <code>XmlReaderSettings</code> ุงุฑุณุงู ฺฉูุฏ ุชุง ฺฏุฒููโูุง <strong>Parsing</strong> ู <strong>Validation</strong> ุฑุง ฺฉูุชุฑู ฺฉูุฏ.</p>
<p>ุณู ูฺฺฏ ููู ุงู ฺฉูุงุณ ฺฉู ุจุฑุง ูพุฑุด ุงุฒ ูุญุชูุง ุงุถุงู ุจุณุงุฑ ููุฏ ูุณุชูุฏ:</p>
<pre><code class="language-csharp">bool IgnoreComments                  // ูพุฑุด ุงุฒ ุฑู nodeูุง ุชูุถุญุ
bool IgnoreProcessingInstructions    // ูพุฑุด ุงุฒ ุฑู ุฏุณุชูุฑูุง ูพุฑุฏุงุฒุดุ
bool IgnoreWhitespace                // ูพุฑุด ุงุฒ ุฑู ูุถุงูุง ุฎุงูุ
</code></pre>
<p>ุฏุฑ ูุซุงู ุฒุฑุ ุจู Reader ูโฺฏูู ฺฉู nodeูุง ูุถุง ุฎุงู ุฑุง <strong>ูุงุฏุฏู ุจฺฏุฑุฏ</strong>ุ ฺูู ูุนูููุงู ุฏุฑ ุณูุงุฑููุง ุฑุงุฌ ูุฒุงุญู ูุณุชูุฏ:</p>
<pre><code class="language-csharp">XmlReaderSettings settings = new XmlReaderSettings();
settings.IgnoreWhitespace = true;
using XmlReader reader = XmlReader.Create(&quot;customer.xml&quot;, settings);
...
</code></pre>
<hr>
<p>ูฺฺฏ ููุฏ ุฏฺฏุฑ ุฏุฑ <code>XmlReaderSettings</code>ุ ฺฏุฒููโ <strong>ConformanceLevel</strong> ุงุณุช.
ููุฏุงุฑ ูพุดโูุฑุถ ุขู <strong>Document</strong> ุงุณุชุ ุนู ุจู Reader ูโฺฏูุฏ ุงูุชุธุงุฑ ฺฉ <strong>ุณูุฏ XML ูุนุชุจุฑ ุจุง ฺฉ ุฑุดูโ ูุงุญุฏ</strong> ุฑุง ุฏุงุดุชู ุจุงุดุฏ.</p>
<p>ุงูุง ุงู ููุถูุน ูุดฺฉูโุณุงุฒ ูโุดูุฏ ุงฺฏุฑ ุจุฎูุงูุฏ ููุท ฺฉ ุจุฎุด ุฏุงุฎู ุงุฒ XML ุฑุง ุจุฎูุงูุฏ ฺฉู ุดุงูู ฺูุฏู node ุงุณุช:</p>
<pre><code class="language-xml">&lt;firstname&gt;Jim&lt;/firstname&gt;
&lt;lastname&gt;Bo&lt;/lastname&gt;
</code></pre>
<p>ุจุฑุง ุงูฺฉู ุงู ูุทุนู ุจุฏูู ุฎุทุง ุฎูุงูุฏู ุดูุฏุ ุจุงุฏ ููุฏุงุฑ <code>ConformanceLevel</code> ุฑุง ุฑู <strong>Fragment</strong> ูุฑุงุฑ ุฏูุฏ.</p>
<p>ููฺูู ูฺฺฏ ุฏฺฏุฑ ุจู ูุงู <strong>CloseInput</strong> ุฏุฑ <code>XmlReaderSettings</code> ูุฌูุฏ ุฏุงุฑุฏ ฺฉู ูุดุฎุต ูโฺฉูุฏ ููุช Reader ุจุณุชู ูโุดูุฏุ ุขุง ุจุงุฏ <strong>Stream ุฒุฑุจูุง</strong> ูู ุจุณุชู ุดูุฏ ุง ูู. (ุฏุฑ <code>XmlWriterSettings</code> ูุฒ ูฺฺฏ ูุดุงุจู ุจู ูุงู <strong>CloseOutput</strong> ูุฌูุฏ ุฏุงุฑุฏ.)
ููุฏุงุฑ ูพุดโูุฑุถ <code>CloseInput</code> ู <code>CloseOutput</code> ุจุฑุงุจุฑ <strong>false</strong> ุงุณุช.</p>
<hr>
<h3>ุฎูุงูุฏู Nodeูุง ๐</h3>
<p>ูุงุญุฏูุง ฺฉ ุฌุฑุงู XMLุ <strong>Nodeูุง</strong> ูุณุชูุฏ.
Reader ุฌุฑุงู XML ุฑุง ุจูโุชุฑุชุจ ูุชู (ุจูโุตูุฑุช <strong>Depth-First</strong>) ูพูุงุด ูโฺฉูุฏ.
ูฺฺฏ <code>Depth</code> ุฏุฑ Readerุ ุนูู ูุนู ูฺฉุงูโููุง (Cursor) ุฑุง ุจุงุฒูโฺฏุฑุฏุงูุฏ.</p>
<p>ุงูููโุชุฑู ุฑูุด ุจุฑุง ุฎูุงูุฏู ุงุฒ <code>XmlReader</code>ุ ุงุณุชูุงุฏู ุงุฒ ูุชุฏ <strong>Read</strong> ุงุณุช.
ุงู ูุชุฏ ูฺฉุงูโููุง ุฑุง ุจู node ุจุนุฏ ุฏุฑ ุฌุฑุงู XML ูโุจุฑุฏุ ุชูุฑุจุงู ูุดุงุจู ุจุง ูุชุฏ <code>MoveNext</code> ุฏุฑ <code>IEnumerator</code>.</p>
<ul>
<li>ุงููู ูุฑุงุฎูุงู ุจู <code>Read</code> ูฺฉุงูโููุง ุฑุง ุฑู ุงููู node ูุฑุงุฑ ูโุฏูุฏ.</li>
<li>ุฒูุงู ฺฉู <code>Read</code> ููุฏุงุฑ <strong>false</strong> ุจุงุฒูโฺฏุฑุฏุงูุฏุ ุนู ูฺฉุงูโููุง ุงุฒ ุขุฎุฑู node ุนุจูุฑ ฺฉุฑุฏู ู ุฏุฑ ุงู ููุทู ุจุงุฏ Reader ุจุณุชู ู ฺฉูุงุฑ ฺฏุฐุงุดุชู ุดูุฏ.</li>
</ul>
<hr>
<p>ุฏู ูฺฺฏ ูุชู (string) ุฏุฑ <code>XmlReader</code> ุจุฑุง ุฏุณุชุฑุณ ุจู ูุญุชูุง ฺฉ node ูุฌูุฏ ุฏุงุฑูุฏ:</p>
<ul>
<li><strong>Name</strong></li>
<li><strong>Value</strong></li>
</ul>
<p>ุจุณุชู ุจู ููุน nodeุ ฺฉ ุงุฒ ุงู ุฏู ุง ูุฑ ุฏู ุขูโูุง ููุฏุงุฑุฏู ูโุดููุฏ.</p>
<hr>
<h3>ูุซุงู: ุฎูุงูุฏู ููู Nodeูุง ๐</h3>
<p>ุฏุฑ ุงู ูุซุงูุ ูุง ูุฑ node ููุฌูุฏ ุฏุฑ ุฌุฑุงู XML ุฑุง ูโุฎูุงูู ู ููุน ูุฑ node ุฑุง ฺุงูพ ูโฺฉูู:</p>
<pre><code class="language-csharp">XmlReaderSettings settings = new XmlReaderSettings();
settings.IgnoreWhitespace = true;
using XmlReader reader = XmlReader.Create(&quot;customer.xml&quot;, settings);

while (reader.Read())
{
    Console.Write(new string(' ', reader.Depth * 2));  // ฺุงูพ ูุงุตูู ุจุฑุง ุชูุฑูุชฺฏ
    Console.Write(reader.NodeType.ToString());

    if (reader.NodeType == XmlNodeType.Element ||
        reader.NodeType == XmlNodeType.EndElement)
    {
        Console.Write(&quot; Name=&quot; + reader.Name);
    }
    else if (reader.NodeType == XmlNodeType.Text)
    {
        Console.Write(&quot; Value=&quot; + reader.Value);
    }

    Console.WriteLine();
}
</code></pre>
<p>ุฎุฑูุฌ:</p>
<pre><code>XmlDeclaration
Element Name=customer
  Element Name=firstname
    Text Value=Jim
  EndElement Name=firstname
  Element Name=lastname
    Text Value=Bo
  EndElement Name=lastname
EndElement Name=customer
</code></pre>
<p>๐ ุชูุฌู ฺฉูุฏ ฺฉู <strong>Attributes</strong> (ูฺฺฏโูุง) ุฏุฑ ูพูุงุด ูุจุชู ุจุฑ <code>Read</code> ูุญุงุธ ููโุดููุฏ. (ุจุฑุง ุงู ููุถูุน ุจู ุจุฎุด <strong>Reading Attributes</strong> ุฏุฑ ุตูุญูโ ตตน ูุฑุงุฌุนู ฺฉูุฏ.)</p>
<hr>
<h3>XmlNodeType ๐ท๏ธ</h3>
<p>ูฺฺฏ <code>NodeType</code> ุงุฒ ููุน <code>XmlNodeType</code> ุงุณุช ฺฉู ฺฉ <strong>enum</strong> ูโุจุงุดุฏ ู ุดุงูู ุงุนุถุง ุฒุฑ ุงุณุช:</p>
<ul>
<li>None</li>
<li>XmlDeclaration</li>
<li>Element</li>
<li>EndElement</li>
<li>Text</li>
<li>Attribute</li>
<li>Comment</li>
<li>Entity</li>
<li>EndEntity</li>
<li>EntityReference</li>
<li>ProcessingInstruction</li>
<li>CDATA</li>
<li>Document</li>
<li>DocumentType</li>
<li>DocumentFragment</li>
<li>Notation</li>
<li>Whitespace</li>
<li>SignificantWhitespace</li>
</ul>
<h3>ุฎูุงูุฏู Elementูุง ุฏุฑ XML ๐ท๏ธ๐</h3>
<p>ุงุบูุจ ุงููุงุช ุดูุง ุงุฒ ูุจู ุณุงุฎุชุงุฑ ุณูุฏ XML ฺฉู ูโุฎูุงูุฏ ุจุฎูุงูุฏ ุฑุง ูโุฏุงูุฏ. ุจุฑุง ุณุงุฏูโุชุฑ ฺฉุฑุฏู ุงู ฺฉุงุฑุ <strong>XmlReader</strong> ูุฌููุนูโุง ุงุฒ ูุชุฏูุง ุฑุง ูุฑุงูู ฺฉุฑุฏู ุงุณุช ฺฉู ููฺฏุงู ุฎูุงูุฏูุ ูุฑุถ ูโฺฉููุฏ ุณุงุฎุชุงุฑ ูุดุฎุต ูุฌูุฏ ุฏุงุฑุฏ. ุงู ูุชุฏูุง ูู ฺฉุฏ ุดูุง ุฑุง ุณุงุฏูโุชุฑ ูโฺฉููุฏ ู ูู ุจูโุทูุฑ ููโุฒูุงู ุจุฎุด ุงุฒ <strong>Validation</strong> ุฑุง ุงูุฌุงู ูโุฏููุฏ โ.</p>
<p>ุงฺฏุฑ ูุฑฺฏููู Validation ุดฺฉุณุช ุจุฎูุฑุฏุ <code>XmlReader</code> ฺฉ <strong>XmlException</strong> ูพุฑุชุงุจ ูโฺฉูุฏ.
ุงู ุงุณุชุซูุง ูฺฺฏโูุง <strong>LineNumber</strong> ู <strong>LinePosition</strong> ุฑุง ุฏุงุฑุฏ ฺฉู ูุดุงู ูโุฏูุฏ ุฎุทุง ุฏุฑ ฺฉุฌุง ุฑุฎ ุฏุงุฏู ุงุณุชโุซุจุช (Log ฺฉุฑุฏู) ุงู ุงุทูุงุนุงุช ุจุฑุง ูุงูโูุง ุจุฒุฑฺฏ XML ุจุณุงุฑ ุถุฑูุฑ ุงุณุช โ๏ธ.</p>
<hr>
<h3>ูุชุฏูุง ูพุงูโุง ุจุฑุง ุฎูุงูุฏู ุนูุงุตุฑ</h3>
<ul>
<li><code>ReadStartElement</code> ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู <code>NodeType</code> ูุนู ุงุฒ ููุน <strong>Element</strong> ุจุงุดุฏ ู ุณูพุณ ูุชุฏ <code>Read</code> ุฑุง ุตุฏุง ูโุฒูุฏ. ุงฺฏุฑ ฺฉ ูุงู ูุดุฎุต ฺฉูุฏุ ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ุจุง ูุงู Element ูุนู ูุทุงุจูุช ุฏุงุฑุฏ.</li>
<li><code>ReadEndElement</code> ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู <code>NodeType</code> ูุนู ุงุฒ ููุน <strong>EndElement</strong> ุจุงุดุฏ ู ุณูพุณ ูุชุฏ <code>Read</code> ุฑุง ุตุฏุง ูโุฒูุฏ.</li>
</ul>
<p>ุจูโุนููุงู ูุซุงูุ ุจุฑุง ุฎูุงูุฏู:</p>
<pre><code class="language-xml">&lt;firstname&gt;Jim&lt;/firstname&gt;
</code></pre>
<p>ูโุชูุงูู ฺฉุฏ ุฒุฑ ุฑุง ุจููุณู:</p>
<pre><code class="language-csharp">reader.ReadStartElement(&quot;firstname&quot;);
Console.WriteLine(reader.Value);
reader.Read();
reader.ReadEndElement();
</code></pre>
<hr>
<h3>ูุชุฏูุง ุฎูุงุตูโุชุฑ ๐๏ธ</h3>
<p>ูุชุฏ <code>ReadElementContentAsString</code> ูููโ ูุฑุงุญู ุจุงูุง ุฑุง ฺฉโุฌุง ุงูุฌุงู ูโุฏูุฏ:</p>
<ul>
<li>ฺฉ <strong>start element</strong></li>
<li>ฺฉ <strong>text node</strong></li>
<li>ู ฺฉ <strong>end element</strong></li>
</ul>
<p>ุณูพุณ ูุญุชูุง ุฏุงุฎู ุฑุง ุจูโุตูุฑุช ฺฉ ุฑุดุชู ุจุงุฒูโฺฏุฑุฏุงูุฏ:</p>
<pre><code class="language-csharp">string firstName = reader.ReadElementContentAsString(&quot;firstname&quot;, &quot;&quot;);
</code></pre>
<p>ุขุฑฺฏููุงู ุฏูู ุจู <strong>namespace</strong> ุงุดุงุฑู ุฏุงุฑุฏ ฺฉู ุฏุฑ ุงู ูุซุงู ุฎุงู ุงุณุช.</p>
<p>ููฺูู ูุณุฎูโูุง ุชุงูพโุดุฏูโุง ุงุฒ ุงู ูุชุฏ ูุฌูุฏ ุฏุงุฑุฏุ ูุซู <code>ReadElementContentAsInt</code>ุ ฺฉู ุฎุฑูุฌ ุฑุง ูุณุชููุงู ุจู ููุน ููุฑุฏูุธุฑ Parse ูโฺฉููุฏ.</p>
<hr>
<h3>ูุซุงู ฺฉุงููโุชุฑ ๐</h3>
<p>ุจุงุฏ ุจู ุณูุฏ XML ุฒุฑ ุจุฑฺฏุฑุฏู:</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;customer id=&quot;123&quot; status=&quot;archived&quot;&gt;
  &lt;firstname&gt;Jim&lt;/firstname&gt;
  &lt;lastname&gt;Bo&lt;/lastname&gt;
  &lt;creditlimit&gt;500.00&lt;/creditlimit&gt;    &lt;!-- OK, we sneaked this in! --&gt;
&lt;/customer&gt;
</code></pre>
<p>ู ุขู ุฑุง ุงูโุทูุฑ ุจุฎูุงูู:</p>
<pre><code class="language-csharp">XmlReaderSettings settings = new XmlReaderSettings();
settings.IgnoreWhitespace = true;

using XmlReader r = XmlReader.Create(&quot;customer.xml&quot;, settings);
r.MoveToContent();                // ูพุฑุด ุงุฒ ุฑู XML declaration
r.ReadStartElement(&quot;customer&quot;);

string firstName    = r.ReadElementContentAsString(&quot;firstname&quot;, &quot;&quot;);
string lastName     = r.ReadElementContentAsString(&quot;lastname&quot;, &quot;&quot;);
decimal creditLimit = r.ReadElementContentAsDecimal(&quot;creditlimit&quot;, &quot;&quot;);

r.MoveToContent();      // ูพุฑุด ุงุฒ ุฑู ฺฉุงููุช
r.ReadEndElement();     // ุฎูุงูุฏู ุชฺฏ ูพุงุงู customer
</code></pre>
<hr>
<h3>ูุชุฏ MoveToContent โก</h3>
<p>ูุชุฏ <code>MoveToContent</code> ุจุณุงุฑ ฺฉุงุฑุจุฑุฏ ุงุณุช. ุงู ูุชุฏ ุงุฒ ุฑู ุชูุงู ุจุฎุดโูุง ุงุถุงู ูพุฑุด ูโฺฉูุฏ:</p>
<ul>
<li><strong>XML declaration</strong></li>
<li><strong>Whitespace</strong></li>
<li><strong>Commentูุง</strong></li>
<li><strong>Processing instructionูุง</strong></li>
</ul>
<p>ููฺูู ูโุชูุงูุฏ ุจู Reader ุฏุณุชูุฑ ุฏูุฏ ุงฺฉุซุฑ ุงู ฺฉุงุฑูุง ุฑุง ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ุงุฒ ุทุฑู ูฺฺฏโูุง ููุฌูุฏ ุฏุฑ <code>XmlReaderSettings</code> ุงูุฌุงู ุฏูุฏ.</p>
<hr>
<h3>Elementูุง ุงุฎุชุงุฑ ๐</h3>
<p>ุฏุฑ ูุซุงู ูุจูุ ูุฑุถ ฺฉูุฏ ฺฉู <code>&lt;lastname&gt;</code> ุงุฎุชุงุฑ ุจุงุดุฏ. ุฑุงูโุญู ุณุงุฏู ุงุณุช:</p>
<pre><code class="language-csharp">r.ReadStartElement(&quot;customer&quot;);
string firstName    = r.ReadElementContentAsString(&quot;firstname&quot;, &quot;&quot;);
string lastName     = r.Name == &quot;lastname&quot;
                     ? r.ReadElementContentAsString() : null;
decimal creditLimit = r.ReadElementContentAsDecimal(&quot;creditlimit&quot;, &quot;&quot;);
</code></pre>
<hr>
<h3>ุชุฑุชุจ ุชุตุงุฏู Elementูุง ๐</h3>
<p>ูุซุงูโูุง ุงู ุจุฎุด ูุฑุถ ูโฺฉููุฏ ฺฉู ุนูุงุตุฑ ุฏุฑ ูุงู XML ุจูโุชุฑุชุจ ูุดุฎุต ูุฑุงุฑ ฺฏุฑูุชูโุงูุฏ.
ุงฺฏุฑ ูุงุฒ ุฏุงุฑุฏ ุจุง ุนูุงุตุฑ ฺฉู ุจู ุชุฑุชุจโูุง ูุฎุชูู ูโุขูุฏ ฺฉุงุฑ ฺฉูุฏุ ุณุงุฏูโุชุฑู ุฑุงู ุงู ุงุณุช ฺฉู ุขู ุจุฎุด ุงุฒ XML ุฑุง ุจูโุตูุฑุช ฺฉ <strong>X-DOM</strong> ุจุฎูุงูุฏ. ูุง ูุญููโ ุงู ฺฉุงุฑ ุฑุง ุฏุฑ ุจุฎุด <strong>Patterns for Using XmlReader/XmlWriter</strong> ุฏุฑ ุตูุญูโ ตถณ ุชูุถุญ ูโุฏูู.</p>
<hr>
<h3>Elementูุง ุฎุงู โฌ</h3>
<p>ูุญููโ ุจุฑุฎูุฑุฏ <code>XmlReader</code> ุจุง Elementูุง ุฎุงู ูโุชูุงูุฏ ฺฉ <strong>ุฏุงู ุฎุทุฑูุงฺฉ</strong> ุจุงุดุฏ ๐.</p>
<p>ุจู ุงู ูุซุงู ุชูุฌู ฺฉูุฏ:</p>
<pre><code class="language-xml">&lt;customerList&gt;&lt;/customerList&gt;
</code></pre>
<p>ุฏุฑ XMLุ ุงู ูุนุงุฏู ุงุณุช ุจุง:</p>
<pre><code class="language-xml">&lt;customerList/&gt;
</code></pre>
<p>ุงูุง <code>XmlReader</code> ุงู ุฏู ุฑุง ูุชูุงูุช ุชูุณุฑ ูโฺฉูุฏ.</p>
<ul>
<li>ุฏุฑ ุญุงูุช ุงููุ ฺฉุฏ ุฒุฑ ุจูโุฎูุจ ฺฉุงุฑ ูโฺฉูุฏ:</li>
</ul>
<pre><code class="language-csharp">reader.ReadStartElement(&quot;customerList&quot;);
reader.ReadEndElement();
</code></pre>
<ul>
<li>ุงูุง ุฏุฑ ุญุงูุช ุฏููุ <code>ReadEndElement</code> ฺฉ ุงุณุชุซูุง ูพุฑุชุงุจ ูโฺฉูุฏ ฺูู ุงุฒ ูุธุฑ XmlReader ูฺ <strong>end element</strong> ูุฌุฒุง ูุฌูุฏ ูุฏุงุฑุฏ.</li>
</ul>
<p>ุฑุงูโุญู: ุจุฑุฑุณ ฺฉูุฏ ฺฉู ุขุง Element ุฎุงู ุงุณุช ุง ุฎุฑ:</p>
<pre><code class="language-csharp">bool isEmpty = reader.IsEmptyElement;
reader.ReadStartElement(&quot;customerList&quot;);
if (!isEmpty) reader.ReadEndElement();
</code></pre>
<p>ุฏุฑ ุนููุ ุงู ูุดฺฉู ููุท ุฒูุงู ุขุฒุงุฑุฏููุฏู ุงุณุช ฺฉู Element ููุฑุฏูุธุฑ ูุฑุงุฑ ุงุณุช <strong>child element</strong>โูุง ุฏุงุดุชู ุจุงุดุฏ (ูุซู ฺฉ customer list).
ุจุฑุง Elementูุง ฺฉู ุชููุง ูุชู ุณุงุฏู ุฏุงุฑูุฏ (ูุซู firstname)ุ ูโุชูุงูุฏ ฺฉู ุงู ููุถูุน ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ูุชุฏูุง ูุซู <code>ReadElementContentAsString</code> ูุงุฏุฏู ุจฺฏุฑุฏ.
ูุชุฏูุง <code>ReadElementXXX</code> ูุฑ ุฏู ููุน <strong>Elementูุง ุฎุงู</strong> ุฑุง ุจูโุฏุฑุณุช ูุฏุฑุช ูโฺฉููุฏ โ.</p>
<hr>
<h3>ุณุงุฑ ูุชุฏูุง ReadXXX ๐</h3>
<p>ุฌุฏูู <strong>ฑฑ-ฑ</strong> ุชูุงู ูุชุฏูุง <code>ReadXXX</code> ุฏุฑ <strong>XmlReader</strong> ุฑุง ุฎูุงุตู ูโฺฉูุฏ.
ุจุดุชุฑ ุงู ูุชุฏูุง ุจุฑุง ฺฉุงุฑ ุจุง <strong>Elementูุง</strong> ุทุฑุงุญ ุดุฏูโุงูุฏ. ุฏุฑ ุงู ุฌุฏููุ ุจุฎุด <strong>Bold</strong> ุดุฏู ุงุฒ XML ูููููุ ูุณูุช ุฎูุงูุฏูโุดุฏู ุชูุณุท ูุชุฏ ุชูุถุญ ุฏุงุฏูโุดุฏู ุฑุง ูุดุงู ูโุฏูุฏ.</p>
<div align="center">
<p><img src="../../../assets/image/11/Table-11-1.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>ุญุฑฺฉุช ุจู Siblingูุง โก๏ธ</h3>
<p>ูุชุฏ <strong>NextSibling</strong> ูฺฉุงูโููุง (Cursor) ุฑุง ุจู ุงุจุชุฏุง <strong>ุงููู Node ููโุณุทุญ (Sibling)</strong> ุจุง ูุงู/namespace ูุดุฎุตโุดุฏู ููุชูู ูโฺฉูุฏ.</p>
<hr>
<h3>ูุชุฏูุง ูุฏู (Legacy Methods) โ๏ธ</h3>
<p>ุฏู ูุชุฏ ูุฏู ูุฌูุฏ ุฏุงุฑูุฏ:</p>
<ul>
<li><code>ReadString</code></li>
<li><code>ReadElementString</code></li>
</ul>
<p>ุงูโูุง ุดุจู ุจู <code>ReadContentAsString</code> ู <code>ReadElementContentAsString</code> ุนูู ูโฺฉููุฏุ ุงูุง ุงฺฏุฑ ุฏุงุฎู Element ุจุด ุงุฒ <strong>ฺฉ Text Node</strong> ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏุ <strong>ุงุณุชุซูุง</strong> ูพุฑุชุงุจ ูโฺฉููุฏ.</p>
<p>๐ด ูุดฺฉู ุฏฺฏุฑ: ุงฺฏุฑ ฺฉ <strong>Comment</strong> ุฏุฑ Element ุจุงุดุฏุ ุงู ูุชุฏูุง ูู ุงุณุชุซูุง ูพุฑุชุงุจ ูโฺฉููุฏ.
ุจูุงุจุฑุงู ุจุงุฏ ุงุฒ ุงุณุชูุงุฏูโ ุขูโูุง ุฎูุฏุฏุงุฑ ฺฉูุฏ.</p>
<hr>
<h2>ุฎูุงูุฏู Attributes ๐ท๏ธ</h2>
<p>ฺฉูุงุณ <strong>XmlReader</strong> ฺฉ <strong>Indexer</strong> ูุฑุงูู ูโฺฉูุฏ ฺฉู ุจู ุดูุง ุฏุณุชุฑุณ ูุณุชูู (Random Access) ุจู Attributeูุง ฺฉ Element ูโุฏูุฏโฺู ุงุฒ ุทุฑู <strong>ูุงู</strong> ู ฺู ุงุฒ ุทุฑู <strong>ูููุนุช (Index)</strong>.</p>
<p>ุงุณุชูุงุฏู ุงุฒ Indexer ูุนุงุฏู ุจุง ุตุฏุง ุฒุฏู ูุชุฏ <code>GetAttribute</code> ุงุณุช.</p>
<p>ุจู ูุซุงู ุฒุฑ ุชูุฌู ฺฉูุฏ:</p>
<pre><code class="language-xml">&lt;customer id=&quot;123&quot; status=&quot;archived&quot;/&gt;
</code></pre>
<p>ูโุชูุงูู Attributeูุง ุขู ุฑุง ุงูโุทูุฑ ุจุฎูุงูู:</p>
<pre><code class="language-csharp">Console.WriteLine(reader[&quot;id&quot;]);              // 123
Console.WriteLine(reader[&quot;status&quot;]);          // archived
Console.WriteLine(reader[&quot;bogus&quot;] == null);   // True
</code></pre>
<p>โ๏ธ ูฺฉุชู: <code>XmlReader</code> ุจุงุฏ <strong>ุฑู ฺฉ Start Element</strong> ูุฑุงุฑ ุฏุงุดุชู ุจุงุดุฏ ุชุง ุจุชูุงู Attributeูุง ุฑุง ุฎูุงูุฏ.
ุจุนุฏ ุงุฒ ุงูฺฉู <code>ReadStartElement</code> ูุฑุงุฎูุงู ุดุฏุ Attributeูุง ุจุฑุง ููุดู ุงุฒ ุฏุณุช ูโุฑููุฏ!</p>
<hr>
<h3>ุฏุณุชุฑุณ ุจุฑ ุงุณุงุณ ูููุนุช (Ordinal Position) ๐ข</h3>
<p>ุงฺฏุฑฺู ุชุฑุชุจ Attributeูุง ุงุฒ ูุธุฑ ูุนูุง ุจโุงููุช ุงุณุชุ ุดูุง ูโุชูุงูุฏ ุขูโูุง ุฑุง ุจุง ุดูุงุฑูโ Index ุจุฎูุงูุฏ:</p>
<pre><code class="language-csharp">Console.WriteLine(reader[0]);   // 123
Console.WriteLine(reader[1]);   // archived
</code></pre>
<p>ููฺูู Indexer ุงู ุงูฺฉุงู ุฑุง ูโุฏูุฏ ฺฉู <strong>Namespace</strong> ูุฑุจูุท ุจู ฺฉ Attribute (ุงฺฏุฑ ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ) ุฑุง ูุดุฎุต ฺฉูุฏ.</p>
<p>ูฺฺฏ <code>AttributeCount</code> ุชุนุฏุงุฏ Attributeูุง Node ูุนู ุฑุง ุจุงุฒูโฺฏุฑุฏุงูุฏ.</p>
<hr>
<h2>Attribute Nodeูุง ๐งฉ</h2>
<p>ุจุฑุง ูพูุงุด ูุณุชูู ุฏุฑ Attribute Nodeูุงุ ุจุงุฏ ุงุฒ ูุณุฑ ูุนููู ุฎูุงูุฏู ุจุง <code>Read</code> ฺฉู <strong>ููุญุฑู ุดูุฏ</strong>.
ุงู ฺฉุงุฑ ุฒูุงู ููุฏ ุงุณุช ฺฉู ุจุฎูุงูุฏ ููุฏุงุฑ Attribute ุฑุง ุจู ุงููุงุน ุฏฺฏุฑ ุชุจุฏู ฺฉูุฏ (ุจุง ุงุณุชูุงุฏู ุงุฒ ูุชุฏูุง <code>ReadContentAsXXX</code>).</p>
<p>ุงู ุชุบุฑ ูุณุฑ ุจุงุฏ ุงุฒ ฺฉ <strong>Start Element</strong> ุขุบุงุฒ ุดูุฏ.
ุจุฑุง ุฑุงุญุช ฺฉุงุฑุ ุฏุฑ ุญู ูพูุงุด Attributeูุงุ ูุงููู <strong>Forward-Only</strong> ฺฉู ููุนุทูโุชุฑ ูโุดูุฏ: ุดูุง ูโุชูุงูุฏ ุจู ูุฑ Attribute (ฺู ุฌูู ฺู ุนูุจ) ุจุง ูุชุฏ <code>MoveToAttribute</code> ุจุฑูุฏ.</p>
<p>ุจุฑุง ุจุงุฒฺฏุดุช ุจู Start Elementุ ุงุฒ ูุชุฏ <code>MoveToElement</code> ุงุณุชูุงุฏู ูโุดูุฏ.</p>
<hr>
<h3>ูุซุงู ุนูู ๐</h3>
<p>ุจุงุฒฺฏุฑุฏู ุจู ูุซุงู ูุจู:</p>
<pre><code class="language-xml">&lt;customer id=&quot;123&quot; status=&quot;archived&quot;/&gt;
</code></pre>
<p>ูโุชูุงูู ุงูโุทูุฑ ุนูู ฺฉูู:</p>
<pre><code class="language-csharp">reader.MoveToAttribute(&quot;status&quot;);
string status = reader.ReadContentAsString();

reader.MoveToAttribute(&quot;id&quot;);
int id = reader.ReadContentAsInt();
</code></pre>
<p>๐ ุงฺฏุฑ Attribute ูุดุฎุตโุดุฏู ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏุ <code>MoveToAttribute</code> ููุฏุงุฑ <strong>false</strong> ุจุฑูโฺฏุฑุฏุงูุฏ.</p>
<hr>
<h3>ูพูุงุด ููู Attributeูุง ๐</h3>
<p>ูโุชูุงูุฏ ูุฑ Attribute ุฑุง ุจูโุชุฑุชุจ ูพูุงุด ฺฉูุฏ:</p>
<pre><code class="language-csharp">if (reader.MoveToFirstAttribute())
    do
    {
        Console.WriteLine(reader.Name + &quot;=&quot; + reader.Value);
    }
    while (reader.MoveToNextAttribute());
</code></pre>
<p>๐ฝ ุฎุฑูุฌ:</p>
<pre><code>id=123
status=archived
</code></pre>
<hr>
<h2>Namespaces ู Prefixes ๐</h2>
<p>ฺฉูุงุณ <strong>XmlReader</strong> ุฏู ุณุณุชู ููุงุฒ ุจุฑุง ุงุฑุฌุงุน ุจู ูุงู ุนูุงุตุฑ ู Attributeูุง ูุฑุงูู ูโฺฉูุฏ:</p>
<ul>
<li><strong>Name</strong></li>
<li><strong>NamespaceURI ู LocalName</strong></li>
</ul>
<p>ูุฑ ููุช ุฎุงุตุช <strong>Name</strong> ุฑุง ุงุฒ ฺฉ Element ุจุฎูุงูุฏ ุง ูุชุฏ ูุฑุงุฎูุงู ฺฉูุฏ ฺฉู ฺฉ <strong>ูุงู ูููุฑุฏ</strong> ูโูพุฐุฑุฏุ ุฏุฑ ุญุงู ุงุณุชูุงุฏู ุงุฒ ุณุณุชู ุงูู ูุณุชุฏ.</p>
<p>ุงู ุฑูุด ุฒูุงู ุฎูุจ ุนูู ูโฺฉูุฏ ฺฉู <strong>Namespace</strong> ุง <strong>Prefix</strong> ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏ. ุฏุฑ ุบุฑ ุงู ุตูุฑุชุ ุนููฺฉุฑุฏ ุขู <strong>ุณุงุฏู ู ุณุทุญ</strong> ุงุณุช:</p>
<ul>
<li><strong>Namespace</strong>โูุง ูุงุฏุฏู ฺฏุฑูุชู ูโุดููุฏ.</li>
<li><strong>Prefix</strong>โูุง ุฏููุงู ููุงูโุทูุฑ ฺฉู ููุดุชู ุดุฏูโุงูุฏุ ุจุงุฒฺฏุฑุฏุงูุฏู ูโุดููุฏ.</li>
</ul>
<div align="center">
<p><img src="../../../assets/image/11/Table-11-2.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>๐ ูุงูโูุถุงูุง (Namespaces) ู ูพุดููุฏูุง (Prefixes)</h3>
<p>ฺฉุฏ ุฒุฑ ุจุง ุฏู ุญุงูุช ุงูู ฺฉุงุฑ ูโฺฉูุฏ:</p>
<pre><code class="language-csharp">reader.ReadStartElement(&quot;customer&quot;);
</code></pre>
<p>ุงูุง ุจุฑุง ุฑุณุฏฺฏ ุจู ุญุงูุช ุณูู ุจุงุฏ ุงุฒ ฺฉุฏ ุฒุฑ ุงุณุชูุงุฏู ฺฉูู:</p>
<pre><code class="language-csharp">reader.ReadStartElement(&quot;x:customer&quot;);
</code></pre>
<p>ุณุณุชู ุฏูู ุงุฒ ุฏู ูฺฺฏ ุญุณุงุณ ุจู ูุงูโูุถุง ุงุณุชูุงุฏู ูโฺฉูุฏ: <strong>NamespaceURI</strong> ู <strong>LocalName</strong>. ุงู ูฺฺฏโูุง ูพุดููุฏูุง ู ูุงูโูุถุงูุง ูพุดโูุฑุถ ฺฉู ุชูุณุท ุนูุงุตุฑ ูุงูุฏ ุชุนุฑู ุดุฏูโุงูุฏ ุฑุง ุฏุฑ ูุธุฑ ูโฺฏุฑูุฏ. ูพุดููุฏูุง ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ฺฏุณุชุฑุด ูโุงุจูุฏ. ุงู ุนู:</p>
<ul>
<li><strong>NamespaceURI</strong> ููุดู ูุงูโูุถุง ุฏุฑุณุช ู ูุนูุง ุนูุตุฑ ุฌุงุฑ ุฑุง ุจุงุฒุชุงุจ ูโุฏูุฏ.</li>
<li><strong>LocalName</strong> ููุดู ุจุฏูู ูฺ ูพุดููุฏ ููุงุด ุฏุงุฏู ูโุดูุฏ.</li>
</ul>
<p>ููุช ุฏู ุขุฑฺฏููุงู ูุงู ุจู ูุชุฏ ูุซู <code>ReadStartElement</code> ูโุฏูุฏุ ุฏุฑูุงูุน ุงุฒ ููู ุณุณุชู ุฏูู ุงุณุชูุงุฏู ูโฺฉูุฏ.</p>
<p>ุจูโุนููุงู ูุซุงูุ ฺฉุฏ XML ุฒุฑ ุฑุง ุฏุฑ ูุธุฑ ุจฺฏุฑุฏ:</p>
<pre><code class="language-xml">&lt;customer xmlns=&quot;DefaultNamespace&quot; xmlns:other=&quot;OtherNamespace&quot;&gt;
  &lt;address&gt;
    &lt;other:city&gt;
    ...
</code></pre>
<p>ูโุชูุงูู ุขู ุฑุง ุงูโุทูุฑ ุจุฎูุงูู:</p>
<pre><code class="language-csharp">reader.ReadStartElement(&quot;customer&quot;, &quot;DefaultNamespace&quot;);
reader.ReadStartElement(&quot;address&quot;,  &quot;DefaultNamespace&quot;);
reader.ReadStartElement(&quot;city&quot;,     &quot;OtherNamespace&quot;);
</code></pre>
<p>โ ุงูุชุฒุงุน ูพุดููุฏูุง ูุนูููุงู ููุงู ฺุฒ ุงุณุช ฺฉู ูโุฎูุงูุฏ. ุงูุง ุงฺฏุฑ ูุงุฒู ุจุงุดุฏุ ูโุชูุงูุฏ ุจุจูุฏ ฺู ูพุดููุฏ ุงุณุชูุงุฏู ุดุฏู ุงุณุช (ุงุฒ ุทุฑู ูฺฺฏ <strong>Prefix</strong>) ู ุณูพุณ ุขู ุฑุง ุจู ฺฉ ูุงูโูุถุง ุชุจุฏู ฺฉูุฏ (ุจุง ูุฑุงุฎูุงู <strong>LookupNamespace</strong>).</p>
<hr>
<h3>โ๏ธ XmlWriter</h3>
<p><strong>XmlWriter</strong> ฺฉ ููุณูุฏูโ ููุท-ุฑูโุจู-ุฌูู (forward-only) ุจุฑุง ุฌุฑุงู XML ุงุณุช. ุทุฑุงุญ XmlWriter ุจูโุทูุฑ ูุชูุงุฑู ุดุจู <strong>XmlReader</strong> ุงุณุช.</p>
<p>ูุงููุฏ <strong>XmlTextReader</strong>ุ ฺฉ XmlWriter ุฑุง ุจุง ูุฑุงุฎูุงู <strong>Create</strong> (ุจุง ฺฉ ุดุก ุชูุธูุงุช ุงุฎุชุงุฑ) ูโุณุงุฒุฏ.</p>
<p>ุฏุฑ ูุซุงู ุฒุฑุ ูุง <strong>ุชูุฑูุชฺฏ (Indenting)</strong> ุฑุง ูุนุงู ูโฺฉูู ุชุง ุฎุฑูุฌ ุจุฑุง ุงูุณุงู ุฎูุงูุงุชุฑ ุดูุฏ ู ุณูพุณ ฺฉ ูุงู XML ุณุงุฏู ูโููุณู:</p>
<pre><code class="language-csharp">XmlWriterSettings settings = new XmlWriterSettings();
settings.Indent = true;
using XmlWriter writer = XmlWriter.Create(&quot;foo.xml&quot;, settings);
writer.WriteStartElement(&quot;customer&quot;);
writer.WriteElementString(&quot;firstname&quot;, &quot;Jim&quot;);
writer.WriteElementString(&quot;lastname&quot;, &quot;Bo&quot;);
writer.WriteEndElement();
</code></pre>
<p>ุงู ฺฉุฏ ุณูุฏ ุฒุฑ ุฑุง ุชููุฏ ูโฺฉูุฏ (ููุงู ูุงู ฺฉู ุฏุฑ ุงููู ูุซุงู XmlReader ุฎูุงูุฏู):</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;customer&gt;
  &lt;firstname&gt;Jim&lt;/firstname&gt;
  &lt;lastname&gt;Bo&lt;/lastname&gt;
&lt;/customer&gt;
</code></pre>
<hr>
<h3>โ๏ธ ุชูุธูุงุช XmlWriter</h3>
<ul>
<li>ุจูโุทูุฑ ูพุดโูุฑุถุ <strong>XmlWriter</strong> ุงุนูุงู (declaration) ุจุงูุง ุฑุง ูโููุณุฏ.</li>
<li>ุงฺฏุฑ ููโุฎูุงูุฏ ุงู ุงุนูุงู ููุดุชู ุดูุฏุ ุจุงุฏ ุฏุฑ <strong>XmlWriterSettings</strong> ูฺฺฏ <strong>OmitXmlDeclaration = true</strong> ุง <strong>ConformanceLevel = Fragment</strong> ุฑุง ุชูุธู ฺฉูุฏ.</li>
<li>ููุฏุงุฑ <strong>Fragment</strong> ููฺูู ุงุฌุงุฒู ูโุฏูุฏ ฺูุฏู ฺฏุฑูโ ุฑุดู ุจููุณุฏุ ฺุฒ ฺฉู ุฏุฑ ุบุฑ ุงู ุตูุฑุช ุจุงุนุซ Exception ูโุดูุฏ.</li>
</ul>
<hr>
<h3>๐ก ููุดุชู ููุงุฏุฑ</h3>
<ul>
<li>ูุชุฏ <strong>WriteValue</strong> ฺฉ ฺฏุฑู ูุชู ูููุฑุฏ ูโููุณุฏ. ุงู ูุชุฏ ูู ุฑุดุชูโูุง ู ูู ุงููุงุน ุบุฑุฑุดุชูโุง ูุซู <code>bool</code> ู <code>DateTime</code> ุฑุง ูโูพุฐุฑุฏ ู ุจูโุทูุฑ ุฏุงุฎู ุงุฒ <strong>XmlConvert</strong> ุจุฑุง ุชุจุฏู ุฑุดุชูโูุง ุณุงุฒฺฏุงุฑ ุจุง XML ุงุณุชูุงุฏู ูโฺฉูุฏ:</li>
</ul>
<pre><code class="language-csharp">writer.WriteStartElement(&quot;birthdate&quot;);
writer.WriteValue(DateTime.Now);
writer.WriteEndElement();
</code></pre>
<ul>
<li>ุฏุฑ ููุงุจูุ ุงฺฏุฑ ุงูโุทูุฑ ุจููุณู:</li>
</ul>
<pre><code class="language-csharp">WriteElementString(&quot;birthdate&quot;, DateTime.Now.ToString());
</code></pre>
<p>ุฎุฑูุฌ ูุงุณุงุฒฺฏุงุฑ ุจุง XML ุฎูุงูุฏ ุจูุฏ ู ุงูฺฉุงู ุชูุณุฑ ูุงุฏุฑุณุช ุฏุงุฑุฏ.</p>
<ul>
<li><strong>WriteString</strong> ูุนุงุฏู ูุฑุงุฎูุงู <strong>WriteValue</strong> ุจุง ฺฉ ุฑุดุชู ุงุณุช.</li>
<li><strong>XmlWriter</strong> ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ฺฉุงุฑุงฺฉุชุฑูุง ุฑุง ฺฉู ุฏุฑ Attribute ุง Element ุบุฑูุงููู ูุณุชูุฏ (ูุซู <code>&amp;</code>, <code>&lt;</code>, <code>&gt;</code> ู ฺฉุงุฑุงฺฉุชุฑูุง Unicode ุชูุณุนูโุงูุชู) ูุฑุงุฑ ูโุฏูุฏ (escape ูโฺฉูุฏ).</li>
</ul>
<hr>
<h3>๐ท๏ธ ููุดุชู Attributeูุง</h3>
<p>ูโุชูุงูุฏ ุฏุฑุณุช ุจุนุฏ ุงุฒ ููุดุชู ฺฉ StartElementุ Attributeูุง ุฑุง ุจููุณุฏ:</p>
<pre><code class="language-csharp">writer.WriteStartElement(&quot;customer&quot;);
writer.WriteAttributeString(&quot;id&quot;, &quot;1&quot;);
writer.WriteAttributeString(&quot;status&quot;, &quot;archived&quot;);
</code></pre>
<p>ุจุฑุง ููุดุชู ููุงุฏุฑ ุบุฑุฑุดุชูโุงุ ุงุฒ ุงู ุงูฺฏู ุงุณุชูุงุฏู ฺฉูุฏ:</p>
<pre><code class="language-csharp">WriteStartAttribute();
WriteValue(...);
WriteEndAttribute();
</code></pre>
<hr>
<h3>๐งฉ ููุดุชู ุงููุงุน ุฏฺฏุฑ Node</h3>
<p>XmlWriter ูุชุฏูุง ุจุฑุง ููุดุชู ุงููุงุน ุฏฺฏุฑ ฺฏุฑูโูุง ูุฒ ุฏุงุฑุฏ:</p>
<ul>
<li>
<p><strong>WriteBase64</strong> โ ุจุฑุง ุฏุงุฏูโูุง ุจุงูุฑ</p>
</li>
<li>
<p><strong>WriteBinHex</strong> โ ุจุฑุง ุฏุงุฏูโูุง ุจุงูุฑ</p>
</li>
<li>
<p><strong>WriteCData</strong></p>
</li>
<li>
<p><strong>WriteComment</strong></p>
</li>
<li>
<p><strong>WriteDocType</strong></p>
</li>
<li>
<p><strong>WriteEntityRef</strong></p>
</li>
<li>
<p><strong>WriteProcessingInstruction</strong></p>
</li>
<li>
<p><strong>WriteRaw</strong></p>
</li>
<li>
<p><strong>WriteWhitespace</strong></p>
</li>
<li>
<p>ูุชุฏ <strong>WriteRaw</strong> ฺฉ ุฑุดุชู ุฑุง ูุณุชููุงู ุจู ุฌุฑุงู ุฎุฑูุฌ ุชุฒุฑู ูโฺฉูุฏ.</p>
</li>
<li>
<p>ููฺูู ูุชุฏ <strong>WriteNode</strong> ูุฌูุฏ ุฏุงุฑุฏ ฺฉู ฺฉ <strong>XmlReader</strong> ุฑุง ูโูพุฐุฑุฏ ู ูุฑ ฺุฒ ุฑุง ฺฉู ุงุฒ ุขู ูโุฎูุงูุฏุ ุชฺฉุฑุงุฑ (Echo) ูโฺฉูุฏ.</p>
</li>
</ul>
<hr>
<h3>๐ ูุงูโูุถุงูุง ู ูพุดููุฏูุง ุฏุฑ XmlWriter</h3>
<p>ูุณุฎูโูุง Overload ูุชุฏูุง Write* ุจู ุดูุง ุงูฺฉุงู ูโุฏููุฏ ฺฉ ุนูุตุฑ ุง Attribute ุฑุง ุจู ฺฉ ูุงูโูุถุง ูุชุตู ฺฉูุฏ.</p>
<p>ุจุงุฏ ูุญุชูุง ูุงู XML ูุจู ุฑุง ุจุงุฒููุณ ฺฉูู ู ุงู ุจุงุฑ ููู ุนูุงุตุฑ ุฑุง ุจู ูุงูโูุถุง <code>http://oreilly.com</code> ูุชุตู ฺฉููุ ู ุฏุฑ ุนูุตุฑ <code>customer</code> ูพุดููุฏ <code>o</code> ุฑุง ุชุนุฑู ฺฉูู:</p>
<pre><code class="language-csharp">writer.WriteStartElement(&quot;o&quot;, &quot;customer&quot;, &quot;http://oreilly.com&quot;);
writer.WriteElementString(&quot;o&quot;, &quot;firstname&quot;, &quot;http://oreilly.com&quot;, &quot;Jim&quot;);
writer.WriteElementString(&quot;o&quot;, &quot;lastname&quot;, &quot;http://oreilly.com&quot;, &quot;Bo&quot;);
writer.WriteEndElement();
</code></pre>
<p>ุฎุฑูุฌ ุงู ุฎูุงูุฏ ุจูุฏ:</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;o:customer xmlns:o='http://oreilly.com'&gt;
  &lt;o:firstname&gt;Jim&lt;/o:firstname&gt;
  &lt;o:lastname&gt;Bo&lt;/o:lastname&gt;
&lt;/o:customer&gt;
</code></pre>
<p>๐ ุชูุฌู ฺฉูุฏ ฺฉู ุจุฑุง ุงุฎุชุตุงุฑุ <strong>XmlWriter</strong> ุงุนูุงู ูุงูโูุถุง ุนูุงุตุฑ ูุฑุฒูุฏ ุฑุง ุญุฐู ูโฺฉูุฏ ฺูู ูุจูุงู ุชูุณุท ุนูุตุฑ ูุงูุฏ ุชุนุฑู ุดุฏูโุงูุฏ.</p>
<h3>๐ ุงูฺฏููุง ุจุฑุง ุงุณุชูุงุฏู ุงุฒ XmlReader/XmlWriter</h3>
<hr>
<h3>๐ ฺฉุงุฑ ุจุง ุฏุงุฏูโูุง ุณูุณููโูุฑุงุชุจ (Hierarchical Data)</h3>
<p>ุฏุฑ ูุธุฑ ุจฺฏุฑุฏ ฺฉูุงุณโูุง ุฒุฑ ุฑุง ุฏุงุฑู:</p>
<pre><code class="language-csharp">public class Contacts
{
  public IList&lt;Customer&gt; Customers = new List&lt;Customer&gt;();
  public IList&lt;Supplier&gt; Suppliers = new List&lt;Supplier&gt;();
}
public class Customer { public string FirstName, LastName; }
public class Supplier { public string Name; }
</code></pre>
<p>ูุฑุถ ฺฉูุฏ ูโุฎูุงูู ุงุฒ <strong>XmlReader</strong> ู <strong>XmlWriter</strong> ุจุฑุง <strong>ุณุฑุงูโุณุงุฒ (Serialization)</strong> ฺฉ ุดุก <code>Contacts</code> ุจู XML ุงุณุชูุงุฏู ฺฉูู. ุฎุฑูุฌ ูุฏูุธุฑ ุจู ุงู ุตูุฑุช ุงุณุช:</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;contacts&gt;
  &lt;customer id=&quot;1&quot;&gt;
    &lt;firstname&gt;Jay&lt;/firstname&gt;
    &lt;lastname&gt;Dee&lt;/lastname&gt;
  &lt;/customer&gt;
  &lt;customer&gt;                     &lt;!-- ูุฑุถ ูโฺฉูู id ุงุฎุชุงุฑ ุงุณุช --&gt;
    &lt;firstname&gt;Kay&lt;/firstname&gt;
    &lt;lastname&gt;Gee&lt;/lastname&gt;
  &lt;/customer&gt;
  &lt;supplier&gt;
    &lt;name&gt;X Technologies Ltd&lt;/name&gt;
  &lt;/supplier&gt;
&lt;/contacts&gt;
</code></pre>
<hr>
<h3>โจ ุจูุชุฑู ุฑูุด</h3>
<p>ุจูุชุฑู ุฑุงู ุงู ูุณุช ฺฉู ฺฉ ูุชุฏ ุจุฒุฑฺฏ ุจููุณูุ ุจูฺฉู ุงู ุงุณุช ฺฉู ูุงุจูุชโูุง XML ุฑุง ุฏุงุฎู ุฎูุฏ ฺฉูุงุณโูุง <code>Customer</code> ู <code>Supplier</code> ฺฉูพุณููู ฺฉูู. ุงู ฺฉุงุฑ ุจุง ููุดุชู ูุชุฏูุง <code>ReadXml</code> ู <code>WriteXml</code> ุฑู ุงู ฺฉูุงุณโูุง ุงูุฌุงู ูโุดูุฏ.</p>
<p>๐ ุงูฺฏู ฺฉุงุฑ ุจู ุงู ุตูุฑุช ุงุณุช:</p>
<ul>
<li>ูุชุฏูุง <strong>ReadXml</strong> ู <strong>WriteXml</strong> ููฺฏุงู ุฎุฑูุฌ ุฏุฑ ููุงู ุนูู (Depth) Reader/Writer ุฑุง ุชุฑฺฉ ูโฺฉููุฏ.</li>
<li><strong>ReadXml</strong> ุนูุตุฑ ุจุฑูู (Outer Element) ุฑุง ูโุฎูุงูุฏุ ุฏุฑุญุงูโฺฉู <strong>WriteXml</strong> ููุท ูุญุชูุง ุฏุงุฎู (Inner Content) ุฑุง ูโููุณุฏ.</li>
</ul>
<hr>
<h3>๐ค ฺฉูุงุณ Customer</h3>
<pre><code class="language-csharp">public class Customer
{
  public const string XmlName = &quot;customer&quot;;
  public int? ID;
  public string FirstName, LastName;
  public Customer () { }
  public Customer (XmlReader r) { ReadXml(r); }

  public void ReadXml (XmlReader r)
  {
    if (r.MoveToAttribute(&quot;id&quot;)) ID = r.ReadContentAsInt();
    r.ReadStartElement();
    FirstName = r.ReadElementContentAsString(&quot;firstname&quot;, &quot;&quot;);
    LastName  = r.ReadElementContentAsString(&quot;lastname&quot;, &quot;&quot;);
    r.ReadEndElement();
  }

  public void WriteXml (XmlWriter w)
  {
    if (ID.HasValue) w.WriteAttributeString(&quot;id&quot;, &quot;&quot;, ID.ToString());
    w.WriteElementString(&quot;firstname&quot;, FirstName);
    w.WriteElementString(&quot;lastname&quot;, LastName);
  }
}
</code></pre>
<p>๐ ุฏูุช ฺฉูุฏ:</p>
<ul>
<li>
<p><code>ReadXml</code> ุนูุงุตุฑ ุดุฑูุน ู ูพุงุงู ุจุฑูู ุฑุง ูโุฎูุงูุฏ. ุงฺฏุฑ ุงู ฺฉุงุฑ ุชูุณุท Caller ุงูุฌุงู ูโุดุฏุ ฺฉูุงุณ Customer ููโุชูุงูุณุช Attributeูุง ุฎูุฏุด ุฑุง ุจุฎูุงูุฏ.</p>
</li>
<li>
<p><code>WriteXml</code> ูุชูุงุฑู (Symmetrical) ููุดุชู ูุดุฏู ฺูู:</p>
<ol>
<li>Caller ููฺฉู ุงุณุช ุจุฎูุงูุฏ ูุงู ุนูุตุฑ ุจุฑูู ุฑุง ุชุนู ฺฉูุฏ.</li>
<li>Caller ููฺฉู ุงุณุช ูุงุฒ ุฏุงุดุชู ุจุงุดุฏ Attributeูุง ุงุถุงู ูุซู ููุน (Subtype) ุฑุง ุจููุณุฏ.</li>
</ol>
</li>
</ul>
<p>ูุฒุช ุฏฺฏุฑ ุงู ุงูฺฏู ุงู ุงุณุช ฺฉู ูพุงุฏูโุณุงุฒ ุดูุง ุจุง <strong>IXmlSerializable</strong> ุณุงุฒฺฏุงุฑ ูโุดูุฏ.</p>
<hr>
<h3>๐ข ฺฉูุงุณ Supplier</h3>
<pre><code class="language-csharp">public class Supplier
{
  public const string XmlName = &quot;supplier&quot;;
  public string Name;
  public Supplier () { }
  public Supplier (XmlReader r) { ReadXml(r); }

  public void ReadXml (XmlReader r)
  {
    r.ReadStartElement();
    Name = r.ReadElementContentAsString(&quot;name&quot;, &quot;&quot;);
    r.ReadEndElement();
  }

  public void WriteXml (XmlWriter w) =&gt;
    w.WriteElementString(&quot;name&quot;, Name);
}
</code></pre>
<hr>
<h3>๐ ฺฉูุงุณ Contacts</h3>
<p>ุฏุฑ ฺฉูุงุณ <code>Contacts</code>ุ ุจุงุฏ ุฏุฑ <code>ReadXml</code> ุนูุงุตุฑ ุฑุง ูพูุงุด ฺฉูู ู ุจุฑุฑุณ ฺฉูู ฺฉู ูุฑ ุฒุฑุนูุตุฑ ฺฉ <code>customer</code> ุงุณุช ุง ฺฉ <code>supplier</code>. ููฺูู ุจุงุฏ ุญุงูุช ุนูุตุฑ ุฎุงู <code>&lt;contacts/&gt;</code> ุฑุง ูุฏุฑุช ฺฉูู:</p>
<pre><code class="language-csharp">public void ReadXml (XmlReader r)
{
  bool isEmpty = r.IsEmptyElement;  // ุจุฑุง ุฌููฺฏุฑ ุงุฒ ฺฏุฑ ุงูุชุงุฏู ุฏุฑ ุนูุตุฑ ุฎุงู
  r.ReadStartElement();
  if (isEmpty) return;

  while (r.NodeType == XmlNodeType.Element)
  {
    if (r.Name == Customer.XmlName) 
        Customers.Add(new Customer(r));
    else if (r.Name == Supplier.XmlName) 
        Suppliers.Add(new Supplier(r));
    else
        throw new XmlException(&quot;Unexpected node: &quot; + r.Name);
  }
  r.ReadEndElement();
}

public void WriteXml (XmlWriter w)
{
  foreach (Customer c in Customers)
  {
    w.WriteStartElement(Customer.XmlName);
    c.WriteXml(w);
    w.WriteEndElement();
  }
  foreach (Supplier s in Suppliers)
  {
    w.WriteStartElement(Supplier.XmlName);
    s.WriteXml(w);
    w.WriteEndElement();
  }
}
</code></pre>
<hr>
<h3>๐ค ุณุฑุงูโุณุงุฒ Contacts ุจู XML</h3>
<pre><code class="language-csharp">var settings = new XmlWriterSettings();
settings.Indent = true;  // ุจุฑุง ุฎูุงูุง ุจุดุชุฑ
using XmlWriter writer = XmlWriter.Create(&quot;contacts.xml&quot;, settings);
var cts = new Contacts();
// ุงูุฒูุฏู Customers ู Suppliers...
writer.WriteStartElement(&quot;contacts&quot;);
cts.WriteXml(writer);
writer.WriteEndElement();
</code></pre>
<hr>
<h3>๐ฅ ุฏุณุฑุงูโุณุงุฒ ุงุฒ ููุงู ูุงู</h3>
<pre><code class="language-csharp">var settings = new XmlReaderSettings();
settings.IgnoreWhitespace = true;
settings.IgnoreComments = true;
settings.IgnoreProcessingInstructions = true;

using XmlReader reader = XmlReader.Create(&quot;contacts.xml&quot;, settings);
reader.MoveToContent();
var cts = new Contacts();
cts.ReadXml(reader);
</code></pre>
<hr>
<h3>๐ ุชุฑฺฉุจ XmlReader/XmlWriter ุจุง X-DOM</h3>
<p>ุฏุฑ ูุฑ ููุทู ุงุฒ ุฏุฑุฎุช XML ฺฉู ฺฉุงุฑ ุจุง XmlReader ุง XmlWriter ุณุฎุช ุดุฏุ ูโุชูุงูุฏ ุงุฒ <strong>X-DOM</strong> ูุงุฑุฏ ุดูุฏ.
ุงู ฺฉุงุฑ ุงุฌุงุฒู ูโุฏูุฏ ูุฒุช ุฑุงุญุช X-DOM ุฑุง ุจุง ูุตุฑู ฺฉู ุญุงูุธูโ XmlReader/XmlWriter ุชุฑฺฉุจ ฺฉูุฏ.</p>
<hr>
<h3>๐ ุงุณุชูุงุฏู ุงุฒ XmlReader ููุฑุงู ุจุง XElement</h3>
<p>ุจุฑุง ุฎูุงูุฏู ฺฉ ุนูุตุฑ ุฌุงุฑ ุจู ฺฉ <strong>X-DOM</strong>ุ ุงุฒ ูุชุฏ:</p>
<pre><code class="language-csharp">XNode.ReadFrom(XmlReader)
</code></pre>
<p>ุงุณุชูุงุฏู ูโฺฉูู. ุงู ูุชุฏ ููุท ุจุฎุด ุฌุงุฑ ุงุฒ ุฒุฑุฏุฑุฎุช ุฑุง ูโุฎูุงูุฏุ ูู ฺฉู ุณูุฏ ุฑุง.</p>
<p>ูุซุงู:</p>
<pre><code class="language-xml">&lt;log&gt;
  &lt;logentry id=&quot;1&quot;&gt;
    &lt;date&gt;...&lt;/date&gt;
    &lt;source&gt;...&lt;/source&gt;
    ...
  &lt;/logentry&gt;
  ...
&lt;/log&gt;
</code></pre>
<p>ุงฺฏุฑ ฺฉ ูููู ุนูุตุฑ <code>&lt;logentry&gt;</code> ุฏุงุดุชู ุจุงุดูุ ุจุงุฑฺฏุฐุงุฑ ฺฉู ุขู ุฏุฑ X-DOM ุญุงูุธู ุฒุงุฏ ูุตุฑู ูโฺฉูุฏ. ุฑุงูโุญู ุจูุชุฑ: ูพูุงุด ุชฺฉโุจูโุชฺฉ ุจุง XmlReader ู ูพุฑุฏุงุฒุด ูุฑ ุนูุตุฑ ุจูโูุณูู XElement:</p>
<pre><code class="language-csharp">XmlReaderSettings settings = new XmlReaderSettings();
settings.IgnoreWhitespace = true;
using XmlReader r = XmlReader.Create(&quot;logfile.xml&quot;, settings);
r.ReadStartElement(&quot;log&quot;);
while (r.Name == &quot;logentry&quot;)
{
  XElement logEntry = (XElement) XNode.ReadFrom(r);
  int id = (int) logEntry.Attribute(&quot;id&quot;);
  DateTime date = (DateTime) logEntry.Element(&quot;date&quot;);
  string source = (string) logEntry.Element(&quot;source&quot;);
  ...
}
r.ReadEndElement();
</code></pre>
<hr>
<h3>๐งฉ ุงุณุชูุงุฏู ุงุฒ XElement ุฏุฑ ReadXml</h3>
<p>ุงฺฏุฑ ุงูฺฏู ุจุงูุง ุฑุง ุฏูุจุงู ฺฉูุฏุ ูโุชูุงูุฏ XElement ุฑุง ูุณุชููุงู ุฏุฑ ูุชุฏูุง <code>ReadXml</code> ุง <code>WriteXml</code> ุงุณุชูุงุฏู ฺฉูุฏุ ุจุฏูู ุงูฺฉู Caller ูุชูุฌู ุดูุฏ.</p>
<p>ูุซุงู ุจุงุฒููุณ ูุชุฏ <code>ReadXml</code> ุจุฑุง Customer:</p>
<pre><code class="language-csharp">public void ReadXml (XmlReader r)
{
  XElement x = (XElement) XNode.ReadFrom(r);
  ID = (int) x.Attribute(&quot;id&quot;);
  FirstName = (string) x.Element(&quot;firstname&quot;);
  LastName  = (string) x.Element(&quot;lastname&quot;);
}
</code></pre>
<hr>
<h3>๐ ูุฏุฑุช ูุงูโูุถุงูุง ุฏุฑ XElement</h3>
<p><strong>XElement</strong> ุจุง XmlReader ููฺฉุงุฑ ูโฺฉูุฏ ุชุง ูุงูโูุถุงูุง ุฑุง ุญูุธ ฺฉูุฏ ู ูพุดููุฏูุง ุฑุง ุฏุฑุณุช ฺฏุณุชุฑุด ุฏูุฏโeven ุงฺฏุฑ ุฏุฑ ุณุทุญ ุจุฑูู ุชุนุฑู ุดุฏู ุจุงุดูุฏ.</p>
<p>ูุซุงู XML:</p>
<pre><code class="language-xml">&lt;log xmlns=&quot;http://loggingspace&quot;&gt;
  &lt;logentry id=&quot;1&quot;&gt;
  ...
</code></pre>
<p>ุฏุฑ ุงู ุญุงูุชุ <code>XElement</code>ูุง ฺฉู ุฏุฑ ุณุทุญ <code>logentry</code> ุณุงุฎุชู ูโุดููุฏุ ูุงูโูุถุง ุจุฑูู ุฑุง ุจูโุฏุฑุณุช ุจู ุงุฑุซ ูโุจุฑูุฏ. โ</p>
<h3>๐ ุงุณุชูุงุฏู ุงุฒ XmlWriter ููุฑุงู ุจุง XElement</h3>
<p>ุดูุง ูโุชูุงูุฏ ุงุฒ <strong>XElement</strong> ููุท ุจุฑุง ููุดุชู ุงูููุชโูุง ุฏุงุฎู ุฏุฑ ฺฉ <strong>XmlWriter</strong> ุงุณุชูุงุฏู ฺฉูุฏ. ฺฉุฏ ุฒุฑ ฺฉ ูููู ุงูููุช <strong>logentry</strong> ุฑุง ุฏุงุฎู ฺฉ ูุงู XML ูโููุณุฏุ ุจุฏูู ุงูฺฉู ฺฉู ูุงู ุฏุฑ ุญุงูุธู ุฐุฎุฑู ุดูุฏ:</p>
<pre><code class="language-csharp">using XmlWriter w = XmlWriter.Create (&quot;logfile.xml&quot;);
w.WriteStartElement (&quot;log&quot;);
for (int i = 0; i &lt; 1000000; i++)
{
    XElement e = new XElement (&quot;logentry&quot;,
                   new XAttribute (&quot;id&quot;, i),
                   new XElement (&quot;date&quot;, DateTime.Today.AddDays (-1)),
                   new XElement (&quot;source&quot;, &quot;test&quot;));
    e.WriteTo (w);
}
w.WriteEndElement ();
</code></pre>
<p>ุงุณุชูุงุฏู ุงุฒ <strong>XElement</strong> ููุท ุงูุฏฺฉ ุณุฑุจุงุฑ ุฏุฑ ุงุฌุฑุง ุงุฌุงุฏ ูโฺฉูุฏ. ุงฺฏุฑ ููู ูุซุงู ุฑุง ุทูุฑ ุชุบุฑ ุฏูู ฺฉู ุฏุฑ ูููโุฌุง ุงุฒ <strong>XmlWriter</strong> ุงุณุชูุงุฏู ฺฉููุ ูฺ ุชูุงูุช ูุญุณูุณ ุฏุฑ ุฒูุงู ุงุฌุฑุง ุฏุฏู ููโุดูุฏ.</p>
<hr>
<h3>๐ ฺฉุงุฑ ุจุง JSON</h3>
<p><strong>JSON</strong> ุจู ฺฉ ุฌุงฺฏุฒู ูุญุจูุจ ุจุฑุง <strong>XML</strong> ุชุจุฏู ุดุฏู ุงุณุช. ฺฏุฑฺู JSON ุงูฺฉุงูุงุช ูพุดุฑูุชู XML (ูุซู <strong>namespaces</strong>ุ <strong>prefixes</strong> ู <strong>schemas</strong>) ุฑุง ูุฏุงุฑุฏุ ุงูุง ุจู ุฏูู ุณุงุฏฺฏ ู ุฎูุงูุง ุจุดุชุฑุ ูุญุจูุจุช ุฒุงุฏ ุฏุงุฑุฏ. ูุงูุจ ุขู ูู ุดุจู ฺุฒ ุงุณุช ฺฉู ููุช ฺฉ ุดุก <strong>JavaScript</strong> ุฑุง ุจู ุฑุดุชู ุชุจุฏู ฺฉูุฏ ุจู ุฏุณุช ูโุขุฏ.</p>
<p>๐ ุจูโุตูุฑุช ุชุงุฑุฎุ .NET ูฺ ูพุดุชุจุงู ุฏุงุฎู ุจุฑุง JSON ูุฏุงุดุช ู ูุฌุจูุฑ ุจูุฏุฏ ุงุฒ ฺฉุชุงุจุฎุงููโูุง ุดุฎุต ุซุงูุซ ูุซู <strong>Json.NET</strong> ุงุณุชูุงุฏู ฺฉูุฏ. ูุฑฺูุฏ ุงู ููุถูุน ุฏฺฏุฑ ุตุงุฏู ูุณุชุ ูู ฺฉุชุงุจุฎุงูู <strong>Json.NET</strong> ููฺูุงู ุจู ุฏูุงู ุฒุฑ ูุญุจูุจ ุจุงู ูุงูุฏู ุงุณุช:</p>
<ul>
<li>๐ ุงุฒ ุณุงู ฒฐฑฑ ุชุงฺฉููู ูุฌูุฏ ุฏุงุฑุฏ.</li>
<li>๐ ููุงู API ุฑู ูุณุฎูโูุง ูุฏูโุชุฑ .NET ูู ุงุฌุฑุง ูโุดูุฏ.</li>
<li>โ๏ธ ุงุฒ ูุธุฑ ูุงุจูุชโูุง (ุญุฏุงูู ุฏุฑ ฺฏุฐุดุชู) ฺฉุงุฑุจุฑุฏโุชุฑ ุงุฒ APIูุง JSON ูุงฺฉุฑูุณุงูุช ุฏุฑ ูุธุฑ ฺฏุฑูุชู ูโุดุฏ.</li>
</ul>
<p>APIูุง JSON ูุงฺฉุฑูุณุงูุช ุงูุง ุงู ูุฒุช ุฑุง ุฏุงุฑูุฏ ฺฉู ุงุฒ ูพุงู ุทุฑุงุญ ุดุฏูโุงูุฏ ุชุง <strong>ุจุณุงุฑ ุณุงุฏู ู ูููโุงูุนุงุฏู ุณุฑุน</strong> ุจุงุดูุฏ. ููฺููุ ุงุฒ .NET 6 ุจู ุจุนุฏุ ูุงุจูุชโูุง ุขูโูุง ุจุณุงุฑ ุจู Json.NET ูุฒุฏฺฉ ุดุฏู ุงุณุช.</p>
<p>ุฏุฑ ุงู ุจุฎุด ุจู ููุถูุนุงุช ุฒุฑ ูโูพุฑุฏุงุฒู:</p>
<ul>
<li>๐ <strong>Utf8JsonReader</strong> ู <strong>Utf8JsonWriter</strong> (ุฎูุงููุฏู ู ููุณูุฏู ุฑู ุจู ุฌูู)</li>
<li>๐ <strong>JsonDocument</strong> (ุฎูุงููุฏู DOM ููุท-ุฎูุงูุฏู)</li>
<li>๐ <strong>JsonNode</strong> (ุฎูุงููุฏู/ููุณูุฏู DOM ุจุง ูุงุจูุช ุฎูุงูุฏู ู ููุดุชู)</li>
</ul>
<p>ุฏุฑ ุจุฎุด &quot;Serialization&quot; ุฏุฑ ูฺฉูู ุขููุงู ุจู ุขุฏุฑุณ: <a href="http://www.albahari.com/nutshell">http://www.albahari.com/nutshell</a>ุ ููุถูุน <strong>JsonSerializer</strong> ุจุฑุฑุณ ูโุดูุฏ ฺฉู ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ JSON ุฑุง ุจู ฺฉูุงุณโูุง <strong>ุณุฑุงูุงุฒ</strong> ู <strong>ุฏุณุฑุงูุงุฒ</strong> ูโฺฉูุฏ.</p>
<hr>
<h3>โก Utf8JsonReader</h3>
<p>ฺฉูุงุณ <strong>System.Text.Json.Utf8JsonReader</strong> ฺฉ <strong>ุฎูุงููุฏู ุจูููโุดุฏู ุฑู ุจู ุฌูู</strong> ุจุฑุง ูุชู JSON ุจุง <strong>ฺฉุฏฺฏุฐุงุฑ UTF-8</strong> ุงุณุช. ุงุฒ ูุธุฑ ูููููุ ุจุณุงุฑ ุดุจู <strong>XmlReader</strong> ุงุณุช ฺฉู ูพุดโุชุฑ ุฏุฑ ุงู ูุตู ูุนุฑู ุดุฏ ู ุชูุฑุจุงู ุจู ููุงู ุดฺฉู ุงุณุชูุงุฏู ูโุดูุฏ.</p>
<p>ูุงู JSON ุฒุฑ ุฑุง ุฏุฑ ูุธุฑ ุจฺฏุฑุฏ (ุจุง ูุงู people.json):</p>
<pre><code class="language-json">{
  &quot;FirstName&quot;:&quot;Sara&quot;,
  &quot;LastName&quot;:&quot;Wells&quot;,
  &quot;Age&quot;:35,
  &quot;Friends&quot;:[&quot;Dylan&quot;,&quot;Ian&quot;]
}
</code></pre>
<ul>
<li>ุขฺฉููุงุฏูุง <code>{}</code> ฺฉ <strong>ุดุก JSON</strong> ุฑุง ูุดุงู ูโุฏููุฏ (ฺฉู ุดุงูู propertyูุง ูุซู <code>&quot;FirstName&quot;</code> ู <code>&quot;LastName&quot;</code> ุงุณุช).</li>
<li>ุจุฑุงฺฉุชโูุง <code>[]</code> ฺฉ <strong>ุขุฑุงู JSON</strong> ุฑุง ูุดุงู ูโุฏููุฏ (ฺฉู ุดุงูู ููุงุฏุฑ ุชฺฉุฑุงุฑ ุงุณุช). ุฏุฑ ุงูุฌุง ููุงุฏุฑ ุชฺฉุฑุงุฑ ุฑุดุชู ูุณุชูุฏุ ุงูุง ูโุชูุงููุฏ ุงุดุงุก ุง ุญุช ุขุฑุงูโูุง ุฏฺฏุฑ ูู ุจุงุดูุฏ.</li>
</ul>
<hr>
<h3>๐งฉ ูพูุงุด JSON ุจุง Utf8JsonReader</h3>
<p>ฺฉุฏ ุฒุฑ ูุงู ุจุงูุง ุฑุง ุจุง ุดูุงุฑุด <strong>tokenูุง JSON</strong> ุชุฌุฒู ูโฺฉูุฏ. ูุฑ <strong>token</strong> ูโุชูุงูุฏ ุดุงูู ููุงุฑุฏ ุฒุฑ ุจุงุดุฏ:</p>
<ul>
<li>ุดุฑูุน ุง ูพุงุงู ฺฉ ุดุก</li>
<li>ุดุฑูุน ุง ูพุงุงู ฺฉ ุขุฑุงู</li>
<li>ูุงู ฺฉ property</li>
<li>ููุฏุงุฑ ฺฉ property ุง ฺฉ ุขุฑุงู (ุฑุดุชูุ ุนุฏุฏุ trueุ false ุง null)</li>
</ul>
<pre><code class="language-csharp">byte[] data = File.ReadAllBytes (&quot;people.json&quot;);
Utf8JsonReader reader = new Utf8JsonReader (data);
while (reader.Read())
{
    switch (reader.TokenType)
    {
        case JsonTokenType.StartObject:
            Console.WriteLine ($&quot;Start of object&quot;);
            break;
        case JsonTokenType.EndObject:
            Console.WriteLine ($&quot;End of object&quot;);
            break;
        case JsonTokenType.StartArray:
            Console.WriteLine();
            Console.WriteLine ($&quot;Start of array&quot;);
            break;
        case JsonTokenType.EndArray:
            Console.WriteLine ($&quot;End of array&quot;);
            break;
        case JsonTokenType.PropertyName:
            Console.Write ($&quot;Property: {reader.GetString()}&quot;);
            break;
        case JsonTokenType.String:
            Console.WriteLine ($&quot; Value: {reader.GetString()}&quot;);
            break;
        case JsonTokenType.Number:
            Console.WriteLine ($&quot; Value: {reader.GetInt32()}&quot;);
            break;
        default:
            Console.WriteLine ($&quot;No support for {reader.TokenType}&quot;);
            break;
    }
}
</code></pre>
<hr>
<h3>๐ ุฎุฑูุฌ ุจุฑูุงูู</h3>
<pre><code>Start of object
Property: FirstName Value: Sara
Property: LastName Value: Wells
Property: Age Value: 35
Property: Friends
Start of array
Value: Dylan
Value: Ian
End of array
End of object
</code></pre>
<p>โ ุงุฒ ุขูุฌุง ฺฉู <strong>Utf8JsonReader</strong> ูุณุชููุงู ุจุง UTF-8 ฺฉุงุฑ ูโฺฉูุฏุ ูโุชูุงูุฏ <strong>ฺฏุงูโุจูโฺฏุงู tokenูุง</strong> ุฑุง ุจุฏูู ุชุจุฏู ูุฑูุฏ ุจู UTF-16 (ูุฑูุช ุฑุดุชูโูุง .NET) ุจุฎูุงูุฏ. ุชุจุฏู ุจู UTF-16 ููุท ููุช ุงูุฌุงู ูโุดูุฏ ฺฉู ูุชุฏ ูุซู <strong>GetString()</strong> ูุฑุงุฎูุงู ุดูุฏ.</p>
<p>ุฌุงูุจ ุงุณุช ุจุฏุงูุฏ ฺฉู ุณุงุฒูุฏู <strong>Utf8JsonReader</strong> ูุณุชููุงู ฺฉ <strong>ุขุฑุงู ุจุงุช</strong> ููโูพุฐุฑุฏุ ุจูฺฉู ฺฉ <strong>ReadOnlySpan<byte></strong> ุฏุฑุงูุช ูโฺฉูุฏ (ุจู ููู ุฏูู Utf8JsonReader ุจูโุตูุฑุช ฺฉ <strong>ref struct</strong> ุชุนุฑู ุดุฏู ุงุณุช). ุดูุง ูโุชูุงูุฏ ฺฉ ุขุฑุงู ุจุงุช ูพุงุณ ุฏูุฏ ฺูู ฺฉ <strong>ุชุจุฏู ุถูู</strong> ุงุฒ <code>T[]</code> ุจู <code>ReadOnlySpan&lt;T&gt;</code> ูุฌูุฏ ุฏุงุฑุฏ.</p>
<p>๐ ุฏุฑ ูุตู ฒณ ุชูุถุญ ุฏุงุฏู ุฎูุงูุฏ ุดุฏ ฺฉู <strong>Spanูุง</strong> ฺฺฏููู ฺฉุงุฑ ูโฺฉููุฏ ู ฺุทูุฑ ูโุชูุงููุฏ ุนููฺฉุฑุฏ ุฑุง ุจุง ฺฉููู ฺฉุฑุฏู ุชุฎุตุต ุญุงูุธู ุจูุจูุฏ ุฏููุฏ.</p>
<hr>
<h3>โ๏ธ JsonReaderOptions</h3>
<p>ุจูโุทูุฑ ูพุดโูุฑุถุ <strong>Utf8JsonReader</strong> ุงูุฒุงู ูโฺฉูุฏ ฺฉู JSON ุฏููุงู ูุทุงุจู ุงุณุชุงูุฏุงุฑุฏ <strong>RFC 8259</strong> ุจุงุดุฏ. ุงูุง ุดูุง ูโุชูุงูุฏ ุจุง ูพุงุณ ุฏุงุฏู ฺฉ ููููู ุงุฒ <strong>JsonReaderOptions</strong> ุจู ุณุงุฒูุฏู Utf8JsonReaderุ ุขู ุฑุง ุงูุนุทุงูโูพุฐุฑุชุฑ ฺฉูุฏ.</p>
<p>ฺฏุฒููโูุง ุดุงูู ููุงุฑุฏ ุฒุฑ ูุณุชูุฏ:</p>
<ul>
<li>
<p><strong>ุชูุถุญุงุช (C-Style comments)</strong>
ุจูโุทูุฑ ูพุดโูุฑุถุ ูุฌูุฏ ุชูุถุญุงุช ุฏุฑ JSON ฺฉ <strong>JsonException</strong> ุงุฌุงุฏ ูโฺฉูุฏ. ุจุง ุชูุธู property ุจู <strong>JsonCommentHandling.Skip</strong>ุ ุชูุถุญุงุช ูุงุฏุฏู ฺฏุฑูุชู ูโุดููุฏ. ุจุง ููุฏุงุฑ <strong>JsonCommentHandling.Allow</strong>ุ ุฎูุงููุฏู ุขูโูุง ุฑุง ุชุดุฎุต ุฏุงุฏู ู tokenูุง ุงุฒ ููุน <strong>JsonTokenType.Comment</strong> ุชููุฏ ูโฺฉูุฏ. (ุชูุถุญุงุช ููโุชูุงููุฏ ูุณุท tokenูุง ุฏฺฏุฑ ุธุงูุฑ ุดููุฏ.)</p>
</li>
<li>
<p><strong>ูุฑฺฏููโูุง ุงูุชูุง (Trailing commas)</strong>
ุจุฑ ุงุณุงุณ ุงุณุชุงูุฏุงุฑุฏุ ุขุฎุฑู property ฺฉ ุดุก ู ุขุฎุฑู ุนูุตุฑ ฺฉ ุขุฑุงู ูุจุงุฏ ูุฑฺฏูู ุงูุชูุง ุฏุงุดุชู ุจุงุดูุฏ. ุจุง ุชูุธู <strong>AllowTrailingCommas = true</strong> ุงู ูุญุฏูุฏุช ุจุฑุฏุงุดุชู ูโุดูุฏ.</p>
</li>
<li>
<p><strong>ฺฉูุชุฑู ุญุฏุงฺฉุซุฑ ุนูู ุชู ุฏุฑ ุชู ุดุฏู (Maximum nesting depth)</strong>
ุจูโุทูุฑ ูพุดโูุฑุถุ ุงุดุงุก ู ุขุฑุงูโูุง ูโุชูุงููุฏ ุชุง <strong>ถด ุณุทุญ</strong> ุชู ุฏุฑ ุชู ุดููุฏ. ุจุง ุชูุธู <strong>MaxDepth</strong> ูโุชูุงูุฏ ุงู ููุฏุงุฑ ุฑุง ุชุบุฑ ุฏูุฏ.</p>
</li>
</ul>
<h3>โ๏ธ Utf8JsonWriter</h3>
<p>ฺฉูุงุณ <strong>System.Text.Json.Utf8JsonWriter</strong> ฺฉ <strong>ููุณูุฏู JSON ุฑู ุจู ุฌูู</strong> ุงุณุช. ุงู ฺฉูุงุณ ุงุฒ ุงููุงุน ุฒุฑ ูพุดุชุจุงู ูโฺฉูุฏ:</p>
<ul>
<li>๐ <strong>String</strong> ู <strong>DateTime</strong> (ฺฉู ุจูโุตูุฑุช ฺฉ ุฑุดุชู JSON ููุดุชู ูโุดููุฏ)</li>
<li>๐ข ุงููุงุน ุนุฏุฏ: <strong>Int32ุ UInt32ุ Int64ุ UInt64ุ Singleุ Double ู Decimal</strong> (ฺฉู ุจูโุตูุฑุช ุงุนุฏุงุฏ JSON ููุดุชู ูโุดููุฏ)</li>
<li>โ <strong>bool</strong> (ฺฉู ุจูโุตูุฑุช ููุงุฏุฑ true/false ุฏุฑ JSON ุฐุฎุฑู ูโุดูุฏ)</li>
<li>๐ซ <strong>null</strong> ุฏุฑ JSON</li>
<li>๐ฆ <strong>ุขุฑุงูโูุง (Arrays)</strong></li>
</ul>
<p>ุดูุง ูโุชูุงูุฏ ุงู ุฏุงุฏูโูุง ุฑุง ูุทุงุจู ุงุณุชุงูุฏุงุฑุฏ JSON ุฏุฑ ูุงูุจ <strong>object</strong> ุณุงุฒูุงูโุฏู ฺฉูุฏ. ููฺูู ุงูฺฉุงู ููุดุชู <strong>comment</strong> ูุฌูุฏ ุฏุงุฑุฏุ ูุฑฺูุฏ ฺฉู ุชูุถุญุงุช ุจุฎุด ุงุฒ ุงุณุชุงูุฏุงุฑุฏ JSON ูุณุชูุฏุ ุงูุง ุงุบูุจ ุชูุณุท <strong>JSON parserูุง</strong> ูพุดุชุจุงู ูโุดููุฏ.</p>
<hr>
<h3>๐ฅ๏ธ ููููู ฺฉุฏ ุงุณุชูุงุฏู ุงุฒ Utf8JsonWriter</h3>
<pre><code class="language-csharp">var options = new JsonWriterOptions { Indented = true };
using (var stream = File.Create (&quot;MyFile.json&quot;))
using (var writer = new Utf8JsonWriter (stream, options))
{
    writer.WriteStartObject();
    // Property name and value specified in one call
    writer.WriteString (&quot;FirstName&quot;, &quot;Dylan&quot;);
    writer.WriteString (&quot;LastName&quot;, &quot;Lockwood&quot;);
    
    // Property name and value specified in separate calls
    writer.WritePropertyName (&quot;Age&quot;);
    writer.WriteNumberValue (46);

    writer.WriteCommentValue (&quot;This is a (non-standard) comment&quot;);
    writer.WriteEndObject();
}
</code></pre>
<p>๐ ุฎุฑูุฌ ูุงู ุชููุฏุดุฏู ุจู ุงู ุตูุฑุช ุฎูุงูุฏ ุจูุฏ:</p>
<pre><code class="language-json">{
  &quot;FirstName&quot;: &quot;Dylan&quot;,
  &quot;LastName&quot;: &quot;Lockwood&quot;,
  &quot;Age&quot;: 46
  /*This is a (non-standard) comment*/
}
</code></pre>
<p>ุงุฒ .NET 6 ุจู ุจุนุฏุ ูุชุฏ <strong>WriteRawValue</strong> ุงุถุงูู ุดุฏ ฺฉู ุจู ุดูุง ุงุฌุงุฒู ูโุฏูุฏ <strong>ฺฉ ุฑุดุชู ุง ุขุฑุงู ุจุงุช</strong> ุฑุง ูุณุชููุงู ุฏุงุฎู ุฌุฑุงู JSON ุจููุณุฏ. ุงู ูุงุจูุช ุฏุฑ ููุงุฑุฏ ุฎุงุต ููุฏ ุงุณุชุ ูุซูุงู ููุช ูโุฎูุงูุฏ ุนุฏุฏ ููุดู ููุฑุงู ุจุง <strong>ุงุนุดุงุฑ</strong> ุฐุฎุฑู ุดูุฏ (ูุซู <code>1.0</code> ุจูโุฌุง <code>1</code>).</p>
<hr>
<h3>๐ ุชูุธูุงุช JsonWriterOptions</h3>
<p>ุฏุฑ ูุซุงู ุจุงูุงุ ูฺฺฏ <strong>Indented = true</strong> ุชูุธู ุดุฏู ุจูุฏ ุชุง ุฎุฑูุฌ ุฎูุงูุงุชุฑ ุดูุฏ. ุงฺฏุฑ ุงู ฺฉุงุฑ ุงูุฌุงู ููโุดุฏุ ุฎุฑูุฌ ุจู ุงู ุดฺฉู ูุดุฑุฏู ูโุจูุฏ:</p>
<pre><code class="language-json">{&quot;FirstName&quot;:&quot;Dylan&quot;,&quot;LastName&quot;:&quot;Lockwood&quot;,&quot;Age&quot;:46...}
</code></pre>
<p>ฺฏุฒููโูุง <strong>JsonWriterOptions</strong> ููฺูู ุดุงูู ููุงุฑุฏ ุฒุฑ ูุณุชูุฏ:</p>
<ul>
<li><strong>Encoder</strong> โ ฺฉูุชุฑู escape ุดุฏู ุฑุดุชูโูุง</li>
<li><strong>SkipValidation</strong> โ ุนุจูุฑ ุงุฒ ุจุฑุฑุณโูุง ุงุนุชุจุงุฑุณูุฌ ุณุงุฎุชุงุฑ (ฺฉู ุงุฌุงุฒู ูโุฏูุฏ JSON ูุงูุนุชุจุฑ ุชููุฏ ุดูุฏ)</li>
</ul>
<hr>
<h3>๐ JsonDocument</h3>
<p>ฺฉูุงุณ <strong>System.Text.Json.JsonDocument</strong> ุฏุงุฏูโูุง JSON ุฑุง ุจู ฺฉ <strong>DOM ููุท-ุฎูุงูุฏู</strong> ุชุฌุฒู ูโฺฉูุฏ ฺฉู ุงุฒ ูููููโูุง <strong>JsonElement</strong> ุณุงุฎุชู ูโุดููุฏ. ุงู ูููููโูุง ุฏุฑ ุตูุฑุช ูุงุฒ (on demand) ุงุฌุงุฏ ูโุดููุฏ.</p>
<p>ุจุฑุฎูุงู <strong>Utf8JsonReader</strong> ฺฉู ููุท ุจูโุตูุฑุช ุชุฑุชุจ (forward-only) ฺฉุงุฑ ูโฺฉูุฏุ <strong>JsonDocument</strong> ุจู ุดูุง ุงุฌุงุฒู ูโุฏูุฏ ุจู ุงูููุชโูุง ุจูโุทูุฑ ุชุตุงุฏู (random access) ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดุฏ.</p>
<p><strong>JsonDocument</strong> ฺฉ ุงุฒ ุฏู API ูุจุชู ุจุฑ DOM ุจุฑุง ฺฉุงุฑ ุจุง JSON ุงุณุช. ุฏฺฏุฑ <strong>JsonNode</strong> ุงุณุช (ฺฉู ุฏุฑ ุจุฎุด ุจุนุฏ ุชูุถุญ ุฏุงุฏู ูโุดูุฏ).</p>
<ul>
<li>๐ <strong>JsonNode</strong> ุฏุฑ .NET 6 ูุนุฑู ุดุฏุ ุนูุฏุชุงู ุจุฑุง ูพุดุชุจุงู ุงุฒ <strong>DOM ูุงุจูโููุดุชู (writable DOM)</strong>.</li>
<li>ุงูุจุชู <strong>JsonNode</strong> ุฏุฑ ุญุงูุช ููุทโุฎูุงูุฏู ูู ููุงุณุจ ุงุณุช ู ุฑุงุจุท ุจุฑูุงููโููุณ (API) ุฑูุงูโุชุฑ ุฑุง ุงุฑุงุฆู ูโุฏูุฏ ฺฉู ุงุฒ ฺฉ DOM ุณูุช ูุจุชู ุจุฑ ฺฉูุงุณโูุง ุจุฑุง ููุงุฏุฑุ ุขุฑุงูโูุง ู ุงุดุงุก ุงุณุชูุงุฏู ูโฺฉูุฏ.</li>
<li>ุฏุฑ ููุงุจูุ <strong>JsonDocument</strong> ุจุณุงุฑ ุณุจฺฉ ุงุณุช ู ููุท ุดุงูู ฺฉ ฺฉูุงุณ ุงุตู (<strong>JsonDocument</strong>) ู ุฏู ุณุงุฎุชุงุฑ ุณุจฺฉ (<strong>JsonElement</strong> ู <strong>JsonProperty</strong>) ูโุดูุฏ ฺฉู ุฏุงุฏูโูุง ุฒุฑุจูุง ุฑุง ุจูโุตูุฑุช ุขู ุชุฌุฒู ูโฺฉููุฏ.</li>
</ul>
<p>๐ ุชูุงูุช ุงู ุฏู API ุฏุฑ <strong>ุดฺฉู 11-1</strong> ูุดุงู ุฏุงุฏู ุดุฏู ุงุณุช.</p>
<hr>
<p>โ ุฏุฑ ุจุดุชุฑ ุณูุงุฑููุง ูุงูุนุ <strong>ุชูุงูุช ุนููฺฉุฑุฏ JsonDocument ู JsonNode ูุงฺุฒ ุงุณุช</strong>. ุจูุงุจุฑุงู ุงฺฏุฑ ุชุฑุฌุญ ูโุฏูุฏ ููุท ฺฉ ุงุฒ ุงู ุฏู ุฑุง ุงุฏ ุจฺฏุฑุฏุ ูโุชูุงูุฏ ูุณุชููุงู ุจู ุณุฑุงุบ <strong>JsonNode</strong> ุจุฑูุฏ.</p>
<div align="center">
<p><img src="../../../assets/image/11/Table-11-3.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>๐ JsonDocument ู ูุฏุฑุช ุญุงูุธู</h3>
<p>ฺฉูุงุณ <strong>JsonDocument</strong> ฺฉุงุฑุง ุฎูุฏ ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ <strong>ุญุงูุธู ุงุดุชุฑุงฺฉ (pooled memory)</strong> ุงูุฒุงุด ูโุฏูุฏ ุชุง ูุงุฒ ุจู <strong>garbage collection</strong> ฺฉูุชุฑ ุดูุฏ.
ุงู ุจู ุงู ูุนูุงุณุช ฺฉู ุดูุง <strong>ุจุนุฏ ุงุฒ ุงุชูุงู ุงุณุชูุงุฏูุ ุจุงุฏ JsonDocument ุฑุง Dispose ฺฉูุฏ</strong>ุ ุฏุฑ ุบุฑ ุงู ุตูุฑุชุ ุญุงูุธู ุขู ุจู ุงุณุชุฎุฑ ุจุงุฒฺฏุฑุฏุงูุฏู ููโุดูุฏ.</p>
<p>๐ ุจูุงุจุฑุงูุ ุงฺฏุฑ ฺฉ ฺฉูุงุณ ุจุฎูุงูุฏ <strong>JsonDocument</strong> ุฑุง ุฏุฑ ฺฉ <strong>field</strong> ูฺฏู ุฏุงุฑุฏุ ุจุงุฏ ุฑุงุจุท <strong>IDisposable</strong> ุฑุง ูู ูพุงุฏูโุณุงุฒ ฺฉูุฏ.
ุงฺฏุฑ ุงู ฺฉุงุฑ ุจุฑุงุชุงู ุณูฺฏู ู ุฏุณุชโููพุงฺฏุฑ ุงุณุชุ ุจูุชุฑ ุงุณุช ุจู ุฌุง ุขู ุงุฒ <strong>JsonNode</strong> ุงุณุชูุงุฏู ฺฉูุฏ.</p>
<hr>
<h3>๐๏ธ ุงุฌุงุฏ ฺฉ JsonDocument</h3>
<p>ูุชุฏ <strong>Parse</strong> ุจูโุตูุฑุช ุงุณุชุงุชฺฉ ฺฉ <strong>JsonDocument</strong> ุฑุง ุงุฒ <strong>stream</strong>ุ <strong>string</strong> ุง <strong>memory buffer</strong> ูโุณุงุฒุฏ:</p>
<pre><code class="language-csharp">using JsonDocument document = JsonDocument.Parse (jsonString);
...
</code></pre>
<p>ููฺฏุงู ูุฑุงุฎูุงู <code>Parse</code> ูโุชูุงูุฏ ฺฉ <strong>JsonDocumentOptions</strong> ูู ุจุฏูุฏ ุชุง ูุญูู ูุฏุฑุช <strong>ฺฉุงูุงูุง ุงุถุงู</strong>ุ <strong>ฺฉุงููุชโูุง</strong> ู <strong>ุญุฏุงฺฉุซุฑ ุนูู ุชู ุฏุฑ ุชู ุดุฏู (nesting depth)</strong> ฺฉูุชุฑู ุดูุฏ (ุงู ููุงุฑุฏ ุฏุฑ ุจุฎุด <strong>JsonReaderOptions</strong> ุตูุญู 570 ุชูุถุญ ุฏุงุฏู ุดุฏูุฏ).</p>
<hr>
<h3>๐ณ ุฏุณุชุฑุณ ุจู RootElement</h3>
<p>ูพุณ ุงุฒ ุณุงุฎุชุ ูโุชูุงูุฏ ุงุฒ ุทุฑู ูฺฺฏ <strong>RootElement</strong> ุจู DOM ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดุฏ:</p>
<pre><code class="language-csharp">using JsonDocument document = JsonDocument.Parse (&quot;123&quot;);
JsonElement root = document.RootElement;
Console.WriteLine (root.ValueKind);   // Number
</code></pre>
<p>ฺฉ <strong>JsonElement</strong> ูโุชูุงูุฏ ฺฉ <strong>ููุฏุงุฑ JSON</strong> (ุฑุดุชูุ ุนุฏุฏุ true/falseุ null)ุ ุง ฺฉ <strong>ุขุฑุงู</strong> ุง ฺฉ <strong>ุดุก</strong> ุฑุง ููุงุด ุฏูุฏ.
ูฺฺฏ <strong>ValueKind</strong> ูุดุฎุต ูโฺฉูุฏ ฺฉู ููุน ุขู ฺุณุช.</p>
<p>โ๏ธ ูุชุฏูุง ฺฉู ุฏุฑ ุงุฏุงูู ูุนุฑู ูโุดููุฏ <strong>ุงฺฏุฑ ููุน ุงูููุช ูุทุงุจู ุงูุชุธุงุฑ ูุจุงุดุฏุ ุงุณุชุซูุง (Exception) ูพุฑุชุงุจ ูโฺฉููุฏ</strong>.
ุงฺฏุฑ ุงุฒ <strong>schema</strong> ูุงู JSON ูุทูุฆู ูุณุชุฏุ ูโุชูุงูุฏ ุงุจุชุฏุง <strong>ValueKind</strong> ุฑุง ุจุฑุฑุณ ฺฉูุฏ ุง ุงุฒ ูุณุฎูโูุง <strong>TryGet</strong>* ุงุณุชูุงุฏู ฺฉูุฏ.</p>
<p>ููฺููุ <strong>JsonElement</strong> ุฏู ูุชุฏ ุนููู ุจุฑุง ูุฑ ููุน ุงูููุช ุฏุงุฑุฏ:</p>
<ul>
<li><code>GetRawText()</code> โ ูุชู JSON ุฏุงุฎู ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ.</li>
<li><code>WriteTo</code> โ ุงูููุช ุฑุง ุจู ฺฉ <strong>Utf8JsonWriter</strong> ูโููุณุฏ.</li>
</ul>
<hr>
<h3>๐ข ุฎูุงูุฏู ููุงุฏุฑ ุณุงุฏู</h3>
<p>ุงฺฏุฑ ุงูููุช ฺฉ ููุฏุงุฑ JSON ุจุงุดุฏุ ูโุชูุงูุฏ ููุฏุงุฑ ุขู ุฑุง ุจุง ูุชุฏูุง ูุซู <code>GetString()</code>ุ <code>GetInt32()</code>ุ <code>GetBoolean()</code> ู ุบุฑู ุจฺฏุฑุฏ:</p>
<pre><code class="language-csharp">using JsonDocument document = JsonDocument.Parse (&quot;123&quot;);
int number = document.RootElement.GetInt32();
</code></pre>
<p>ููฺูู ูุชุฏูุง ุจุฑุง ุชุจุฏู ุฑุดุชูโูุง JSON ุจู ุงููุงุน ุฑุงุฌ CLR ูุซู <strong>DateTime</strong> (ู ุญุช ุฏุงุฏูโูุง ุฏูุฏู base-64) ูุฌูุฏ ุฏุงุฑุฏ.
ูุณุฎูโูุง <strong>TryGet</strong>* ุงู ูุชุฏูุง ูู ูุณุชูุฏ ฺฉู ุฏุฑ ุตูุฑุช ุฎุทุงุ <strong>ุงุณุชุซูุง ูพุฑุชุงุจ ููโฺฉููุฏ</strong>.</p>
<hr>
<h3>๐ฆ ุฎูุงูุฏู ุขุฑุงูโูุง JSON</h3>
<p>ุงฺฏุฑ <strong>JsonElement</strong> ููุงูุฏู ฺฉ <strong>ุขุฑุงู</strong> ุจุงุดุฏุ ูโุชูุงูุฏ ุงุฒ ูุชุฏูุง ุฒุฑ ุงุณุชูุงุฏู ฺฉูุฏ:</p>
<ul>
<li><code>EnumerateArray()</code> โ ุชูุงู ุฒุฑุขุชูโูุง ุฑุง ุจูโุตูุฑุช <strong>JsonElement</strong> ุจุฑูโฺฏุฑุฏุงูุฏ.</li>
<li><code>GetArrayLength()</code> โ ุชุนุฏุงุฏ ุนูุงุตุฑ ุขุฑุงู ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ.</li>
</ul>
<p>ููฺูู ูโุชูุงูุฏ ุจุง ุงูุฏฺฉุณ ุจู ุงูููุช ุฎุงุต ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดุฏ:</p>
<pre><code class="language-csharp">using JsonDocument document = JsonDocument.Parse (@&quot;[1, 2, 3, 4, 5]&quot;);
int length = document.RootElement.GetArrayLength();   // 5
int value  = document.RootElement[3].GetInt32();      // 4
</code></pre>
<hr>
<h3>๐๏ธ ุฎูุงูุฏู ุงุดุงุก JSON</h3>
<p>ุงฺฏุฑ ุงูููุช ฺฉ <strong>ุดุก JSON</strong> ุจุงุดุฏุ ูุชุฏูุง ุฒุฑ ุฏุฑ ุฏุณุชุฑุณ ูุณุชูุฏ:</p>
<ul>
<li><code>EnumerateObject()</code> โ ููู ูฺฺฏโูุง (property) ู ููุงุฏุฑุดุงู ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ.</li>
<li><code>GetProperty(string propertyName)</code> โ ูฺฺฏ ุฎุงุต ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ (ู ุงฺฏุฑ ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏุ ุงุณุชุซูุง ูพุฑุชุงุจ ูโฺฉูุฏ).</li>
<li><code>TryGetProperty(string propertyName, out JsonElement value)</code> โ ูฺฺฏ ุฑุง ููุท ุฏุฑ ุตูุฑุช ูุฌูุฏ ุจุฑูโฺฏุฑุฏุงูุฏ.</li>
</ul>
<p>ูุซุงู:</p>
<pre><code class="language-csharp">using JsonDocument document = JsonDocument.Parse (@&quot;{ &quot;&quot;Age&quot;&quot;: 32}&quot;);
JsonElement root = document.RootElement;
int age = root.GetProperty (&quot;Age&quot;).GetInt32();
</code></pre>
<p>ุง ฺฉุดู ูฺฺฏโูุง ุจูโุตูุฑุช ูพูุง:</p>
<pre><code class="language-csharp">JsonProperty ageProp = root.EnumerateObject().First();
string name = ageProp.Name;             // Age
JsonElement value = ageProp.Value;
Console.WriteLine (value.ValueKind);    // Number
Console.WriteLine (value.GetInt32());   // 32
</code></pre>
<h3>๐ JsonDocument ู LINQ</h3>
<p>ฺฉูุงุณ <strong>JsonDocument</strong> ุจูโุฎูุจ ุจุง <strong>LINQ</strong> ุณุงุฒฺฏุงุฑ ุงุณุช. ูุฑุถ ฺฉูุฏ ูุงู JSON ุฒุฑ ุฑุง ุฏุงุฑู:</p>
<pre><code class="language-json">[
  {
    &quot;FirstName&quot;:&quot;Sara&quot;,
    &quot;LastName&quot;:&quot;Wells&quot;,
    &quot;Age&quot;:35,
    &quot;Friends&quot;:[&quot;Ian&quot;]
  },
  {
    &quot;FirstName&quot;:&quot;Ian&quot;,
    &quot;LastName&quot;:&quot;Weems&quot;,
    &quot;Age&quot;:42,
    &quot;Friends&quot;:[&quot;Joe&quot;,&quot;Eric&quot;,&quot;Li&quot;]
  },
  {
    &quot;FirstName&quot;:&quot;Dylan&quot;,
    &quot;LastName&quot;:&quot;Lockwood&quot;,
    &quot;Age&quot;:46,
    &quot;Friends&quot;:[&quot;Sara&quot;,&quot;Ian&quot;]
  }
]
</code></pre>
<p>ูโุชูุงูู ุจุง ุงุณุชูุงุฏู ุงุฒ <strong>JsonDocument</strong> ู <strong>LINQ</strong> ุฏุงุฏูโูุง ุฑุง ฺฉูุฆุฑ ฺฉูู:</p>
<pre><code class="language-csharp">using var stream = File.OpenRead (jsonPath);
using JsonDocument document = JsonDocument.Parse (json);

var query =
  from person in document.RootElement.EnumerateArray()
  select new
  {
    FirstName = person.GetProperty (&quot;FirstName&quot;).GetString(),
    Age = person.GetProperty (&quot;Age&quot;).GetInt32(),
    Friends =
      from friend in person.GetProperty (&quot;Friends&quot;).EnumerateArray()
      select friend.GetString()
  };
</code></pre>
<p>โ๏ธ ุชูุฌู ฺฉูุฏ: ุงุฒ ุขูุฌุง ฺฉู ฺฉูุฆุฑโูุง <strong>LINQ</strong> ุจูโุตูุฑุช <strong>Lazy</strong> ุงุฌุฑุง ูโุดููุฏุ ุจุงุฏ ูุจู ุงุฒ ุฎุงุฑุฌ ุดุฏู ูุญุฏูุฏู (scope) ู <strong>Dispose ุดุฏู JsonDocument</strong> (ฺฉู ุจู ุฏูู ุงุณุชูุงุฏู ุงุฒ ุฏุณุชูุฑ <code>using</code> ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ุงุชูุงู ูโุงูุชุฏ)ุ ฺฉูุฆุฑ ุฑุง ูพูุงุด (enumerate) ฺฉูุฏ.</p>
<hr>
<h3>โ๏ธ ุงุฌุงุฏ ุชุบุฑ ุจุง JSON Writer</h3>
<p>ฺฉูุงุณ <strong>JsonDocument</strong> ููุท ุฎูุงูุฏู (read-only) ุงุณุชุ ุงูุง ูโุชูุงูุฏ ูุญุชูุง ฺฉ <strong>JsonElement</strong> ุฑุง ุจุง ูุชุฏ <strong>WriteTo</strong> ุจู ฺฉ <strong>Utf8JsonWriter</strong> ุจูุฑุณุชุฏ.
ุงู ุฑูุด ุงูฺฉุงู ุจุฑุง ุชููุฏ ูุณุฎูโุง ุชุบุฑ ุงูุชู ุงุฒ JSON ูุฑุงูู ูโฺฉูุฏ.</p>
<p>ุจุฑุง ูููููุ ุฏุฑ ุงู ูุซุงูุ JSON ูุจู ุฑุง ุจู ฺฉ ูุงู ุฌุฏุฏ ูโููุณู ฺฉู ููุท ุดุงูู ุงูุฑุงุฏ ุงุณุช ฺฉู <strong>ุฏู ุง ุจุดุชุฑ ุฏูุณุช ุฏุงุฑูุฏ</strong>:</p>
<pre><code class="language-csharp">using var json = File.OpenRead (jsonPath);
using JsonDocument document = JsonDocument.Parse (json);

var options = new JsonWriterOptions { Indented = true };

using (var outputStream = File.Create (&quot;NewFile.json&quot;))
using (var writer = new Utf8JsonWriter (outputStream, options))
{
  writer.WriteStartArray();
  foreach (var person in document.RootElement.EnumerateArray())
  {
    int friendCount = person.GetProperty (&quot;Friends&quot;).GetArrayLength();
    if (friendCount &gt;= 2)
      person.WriteTo (writer);
  }
}
</code></pre>
<p>๐ ุงูุง ุงฺฏุฑ ุจู <strong>ูุงุจูุช ุจูโุฑูุฒุฑุณุงู ูุณุชูู DOM</strong> ูุงุฒ ุฏุงุฑุฏุ ุจูุชุฑ ุงุณุช ุงุฒ <strong>JsonNode</strong> ุงุณุชูุงุฏู ฺฉูุฏ.</p>
<hr>
<h3>๐ JsonNode</h3>
<p>ฺฉูุงุณ <strong>JsonNode</strong> (ุฏุฑ ูุถุง ูุงู <code>System.Text.Json.Nodes</code>) ุฏุฑ <strong>.NET 6</strong> ูุนุฑู ุดุฏ.
ูุฏู ุงุตู ุขูุ ูพุงุณุฎ ุจู ูุงุฒ ฺฉ <strong>DOM ูุงุจู ูุฑุงุด (writable DOM)</strong> ุจูุฏ.
ุงูุจุชู ุฏุฑ ุณูุงุฑููุง ููุทโุฎูุงูุฏู ูู ููุงุณุจ ุงุณุช ู ฺฉ ุฑุงุจุท <strong>ุฑูุงูโุชุฑ ู ุดโฺฏุฑุง</strong> ุงุฑุงุฆู ูโุฏูุฏ.</p>
<ul>
<li>ุฏุฑ ุงูุฌุงุ ููุงุฏุฑ JSONุ ุขุฑุงูโูุง ู ุงุดุงุก ูุฑฺฉุฏุงู ุจุง <strong>ฺฉูุงุณโูุง</strong> ููุงุด ุฏุงุฏู ูโุดููุฏ (ุชุตูุฑ 11-1 ุฏุฑ ฺฉุชุงุจ).</li>
<li>ฺูู ฺฉูุงุณโูุง ูุณุชูุฏุ ูุฒููโ <strong>Garbage Collection</strong> ุฑุง ุชุญูู ูโฺฉููุฏุ ุงูุง ุงู ูุฒูู ุฏุฑ ุงุบูุจ ุณูุงุฑููุง ูุงูุน ูุงฺุฒ ุงุณุช.</li>
<li><strong>JsonNode</strong> ููฺูุงู ุจุณุงุฑ ุจููู ุงุณุช ู ุญุช ุฏุฑ ููุงูุน ฺฉู ฺฏุฑูโูุง ูุดุงุจู ฺูุฏ ุจุงุฑ ุฎูุงูุฏู ุดููุฏุ <strong>ุณุฑุนโุชุฑ ุงุฒ JsonDocument</strong> ุนูู ูโฺฉูุฏุ ฺูู ูุชุงุฌ <strong>Parse</strong> ุฑุง ฺฉุด ูโฺฉูุฏ.</li>
</ul>
<hr>
<h3>๐๏ธ ุณุงุฎุช JsonNode</h3>
<p>ูุชุฏ ุงุณุชุงุชฺฉ <strong>Parse</strong> ฺฉ <strong>JsonNode</strong> ุฑุง ุงุฒ <strong>stream</strong>ุ <strong>string</strong>ุ <strong>memory buffer</strong> ุง <strong>Utf8JsonReader</strong> ูโุณุงุฒุฏ:</p>
<pre><code class="language-csharp">JsonNode node = JsonNode.Parse (jsonString);
</code></pre>
<p>ููฺฏุงู ูุฑุงุฎูุงู <code>Parse</code> ูโุชูุงูุฏ ูุซู JsonDocument ฺฉ <strong>JsonDocumentOptions</strong> ูู ุจุฏูุฏ ุชุง ูุญูู ูุฏุฑุช <strong>ฺฉุงูุงูุง ุงุถุงู</strong>ุ <strong>ฺฉุงููุชโูุง</strong> ู <strong>ุญุฏุงฺฉุซุฑ ุนูู</strong> ฺฉูุชุฑู ุดูุฏ.</p>
<p>๐ ุจุฑุฎูุงู <strong>JsonDocument</strong>ุ ุงูุฌุง ุฏฺฏุฑ ูุงุฒ ุจู <strong>Dispose ฺฉุฑุฏู</strong> ูุฌูุฏ ูุฏุงุฑุฏ.</p>
<hr>
<h3>๐ ุฑุดุชูโุณุงุฒ (Stringify) ุฏุฑ JsonNode</h3>
<ul>
<li>ูุชุฏ <code>ToString()</code> โ ุฎุฑูุฌ JSON ุจุง ูุฑูุช <strong>ุฎูุงูุง ู ุชูโุฏุงุฑ (indented)</strong> ุจุฑูโฺฏุฑุฏุงูุฏ.</li>
<li>ูุชุฏ <code>ToJsonString()</code> โ ุฎุฑูุฌ JSON <strong>ูุดุฑุฏู ู ุจุฏูู ูุงุตููโูุง ุงุถุงู</strong> ุจุฑูโฺฏุฑุฏุงูุฏ.</li>
</ul>
<p>ุงุฒ <strong>.NET 8</strong>ุ ูฺฺฏโูุง ุฒุฑ ูู ุงุถุงูู ุดุฏูโุงูุฏ:</p>
<ul>
<li><code>DeepEquals</code> โ ููุงุณูโ ุฏู <strong>JsonNode</strong> ุจุฏูู ูุงุฒ ุจู ุชุจุฏู ุจู ุฑุดุชู JSON.</li>
<li><code>DeepClone</code> โ ฺฏุฑูุชู ฺฉ ฺฉูพ ุนูู ุงุฒ JsonNode.</li>
</ul>
<hr>
<h3>๐งฉ ุงููุงุน JsonNode</h3>
<p>ูุชุฏ <code>Parse</code> ฺฉ ุงุฒ ุฒุฑุฏุณุชูโูุง <strong>JsonNode</strong> ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ:</p>
<ul>
<li><strong>JsonValue</strong></li>
<li><strong>JsonObject</strong></li>
<li><strong>JsonArray</strong></li>
</ul>
<p>ุจุฑุง ุฌููฺฏุฑ ุงุฒ <strong>Downcast ุฏุณุช</strong>ุ ูุชุฏูุง ฺฉูฺฉ ูุฌูุฏ ุฏุงุฑูุฏ:</p>
<ul>
<li><code>AsValue()</code></li>
<li><code>AsObject()</code></li>
<li><code>AsArray()</code></li>
</ul>
<p>ูุซุงู:</p>
<pre><code class="language-csharp">var node = JsonNode.Parse (&quot;123&quot;);  // Parses to a JsonValue
int number = node.AsValue().GetValue&lt;int&gt;();
// ููุงููุฏ ((JsonValue)node).GetValue&lt;int&gt;();
</code></pre>
<p>ุงูุง ูุนูููุงู ูุงุฒู ูุณุช ุงู ูุชุฏูุง ุฑุง ุตุฏุง ุจุฒูุฏุ ฺูู ุงุนุถุง ูพุฑฺฉุงุฑุจุฑุฏ ูุณุชููุงู ุฑู ุฎูุฏ ฺฉูุงุณ <strong>JsonNode</strong> ุฏุฑ ุฏุณุชุฑุณโุงูุฏ:</p>
<pre><code class="language-csharp">var node = JsonNode.Parse (&quot;123&quot;);
int number = node.GetValue&lt;int&gt;();
// ููุงููุฏ node.AsValue().GetValue&lt;int&gt;();
</code></pre>
<h3>ุฎูุงูุฏู ููุงุฏุฑ ุณุงุฏู ๐น</h3>
<p>ููุงูโุทูุฑ ฺฉู ุฏุฏูุ ูโุชูุงูุฏ ฺฉ ููุฏุงุฑ ุณุงุฏู ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ูุชุฏ <strong>GetValue</strong> ู ูุดุฎุต ฺฉุฑุฏู ููุนุ ุงุณุชุฎุฑุงุฌ ุง ุชุจุฏู ฺฉูุฏ. ุจุฑุง ุขุณุงูโุชุฑ ฺฉุฑุฏู ุงู ฺฉุงุฑุ <strong>JsonNode</strong> ุนููฺฏุฑูุง ุชุจุฏู ุตุฑุญ (<strong>explicit cast operators</strong>) ุฏุฑ C# ุฑุง ุจุงุฒุชุนุฑู ฺฉุฑุฏู ุงุณุชุ ฺฉู ุงูฺฉุงู ุงุณุชูุงุฏู ุงุฒ ูุงูุจุฑ ุฒุฑ ุฑุง ูุฑุงูู ูโฺฉูุฏ:</p>
<pre><code class="language-csharp">var node = JsonNode.Parse(&quot;123&quot;);
int number = (int)node;
</code></pre>
<p>ุงู ุฑูุด ุจุฑุง ุงููุงุน ุงุณุชุงูุฏุงุฑุฏ ุนุฏุฏุ ุงุฒ ุฌููู <code>char</code>ุ <code>bool</code>ุ <code>DateTime</code>ุ <code>DateTimeOffset</code>ุ <code>Guid</code> (ู ูุณุฎูโูุง nullable ุขูโูุง) ู ููฺูู <code>string</code> ฺฉุงุฑ ูโฺฉูุฏ.</p>
<p>ุงฺฏุฑ ูุทูุฆู ูุณุชุฏ ฺฉู ุชุจุฏู ูููู ุฎูุงูุฏ ุจูุฏุ ุจุงุฏ ุงุฒ ุงูฺฏู ุฒุฑ ุงุณุชูุงุฏู ฺฉูุฏ:</p>
<pre><code class="language-csharp">if (node.AsValue().TryGetValue&lt;int&gt;(out var number))
    Console.WriteLine(number);
</code></pre>
<p>ุงุฒ <strong>.NET 8</strong> ุจู ุจุนุฏุ ุจุง ูุฑุงุฎูุงู <code>node.GetValueKind()</code> ูโุชูุงูุฏ ุชุดุฎุต ุฏูุฏ ฺฉู ููุฏ ฺฉ ุฑุดุชูุ ุนุฏุฏุ ุขุฑุงูุ ุดุก ุง ููุฏุงุฑ true/false ุงุณุช.</p>
<p>ููุฏูุง ฺฉู ุงุฒ ูุชู JSON ุงุณุชุฎุฑุงุฌ ุดุฏูโุงูุฏุ ุจู ุตูุฑุช ุฏุงุฎู ุชูุณุท ฺฉ <strong>JsonElement</strong> ูพุดุชุจุงู ูโุดููุฏ (ฺฉู ุจุฎุด ุงุฒ API ุฎูุงูุฏู <strong>JsonDocument</strong> ุงุณุช). ูโุชูุงูุฏ <strong>JsonElement</strong> ุฒุฑู ุฑุง ุจู ุงู ุดฺฉู ุงุณุชุฎุฑุงุฌ ฺฉูุฏ:</p>
<pre><code class="language-csharp">JsonElement je = node.GetValue&lt;JsonElement&gt;();
</code></pre>
<p>ุจุง ุงู ุญุงูุ ุงู ุฑูุด ุฒูุงู ฺฉู ููุฏ ุจู ุตูุฑุช ุตุฑุญ ุงุฌุงุฏ ุดุฏู ุจุงุดุฏ (ูุซูุงู ููฺฏุงู ุจูโุฑูุฒุฑุณุงู DOM) ฺฉุงุฑ ููโฺฉูุฏ. ฺูู ููุฏูุง ุจู ุฌุง <strong>JsonElement</strong> ุชูุณุท ููุฏุงุฑ ูุงูุน ุชุฌุฒูโุดุฏู ูพุดุชุจุงู ูโุดููุฏ (ุฑุฌูุน ฺฉูุฏ ุจู ุจุฎุด ยซMaking updates with JsonNodeยป ุฏุฑ ุตูุญู 579).</p>
<hr>
<h3>ุฎูุงูุฏู ุขุฑุงูโูุง JSON ๐ฆ</h3>
<p>ฺฉ <strong>JsonNode</strong> ฺฉู ููุงูุฏู ฺฉ ุขุฑุงู JSON ุงุณุชุ ุงุฒ ููุน <strong>JsonArray</strong> ุฎูุงูุฏ ุจูุฏ.
<strong>JsonArray</strong> ุฑุงุจุท <code>IList&lt;JsonNode&gt;</code> ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉูุฏุ ุจูุงุจุฑุงู ูโุชูุงูุฏ ุฑู ุขู ูพูุงุด ฺฉูุฏ ู ุนูุงุตุฑ ุฑุง ูุงููุฏ ฺฉ ุขุฑุงู ุง ูุณุช ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดุฏ:</p>
<pre><code class="language-csharp">var node = JsonNode.Parse(@&quot;[1, 2, 3, 4, 5]&quot;);
Console.WriteLine(node.AsArray().Count);  // 5
foreach (JsonNode child in node.AsArray())
{
    ...
}
</code></pre>
<p>ุจู ุนููุงู ฺฉ ูุงูุจุฑุ ูโุชูุงูุฏ ุงุฒ ุงูุฏุณโุฏููุฏู (<strong>indexer</strong>) ูุณุชููุงู ุงุฒ ฺฉูุงุณ <strong>JsonNode</strong> ุงุณุชูุงุฏู ฺฉูุฏ:</p>
<pre><code class="language-csharp">Console.WriteLine((int)node[0]);   // 1
</code></pre>
<p>ุงุฒ <strong>.NET 8</strong> ุจู ุจุนุฏุ ูโุชูุงูุฏ ุจุง ูุชุฏ <strong>GetValues<T></strong> ุฏุงุฏูโูุง ุฑุง ุจู ุตูุฑุช <code>IEnumerable&lt;T&gt;</code> ุฏุฑุงูุช ฺฉูุฏ:</p>
<pre><code class="language-csharp">int[] values = node.AsArray().GetValues&lt;int&gt;().ToArray();
</code></pre>
<hr>
<h3>ุฎูุงูุฏู ุงุดุงุก JSON ๐๏ธ</h3>
<p>ฺฉ <strong>JsonNode</strong> ฺฉู ููุงูุฏู ฺฉ ุดุก JSON ุงุณุชุ ุงุฒ ููุน <strong>JsonObject</strong> ุฎูุงูุฏ ุจูุฏ.
<strong>JsonObject</strong> ุฑุงุจุท <code>IDictionary&lt;string, JsonNode&gt;</code> ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉูุฏุ ุจูุงุจุฑุงู ูโุชูุงูุฏ ฺฉ ุนุถู ุฑุง ุจุง ุงูุฏุณโุฏููุฏู ุฏุฑุงูุช ฺฉูุฏ ู ููฺูู ุฑู ฺฉูุฏ/ููุฏุงุฑูุง ุฏฺฉุดูุฑ ูพูุงุด ฺฉูุฏ.</p>
<p>ููุงููุฏ <strong>JsonArray</strong>ุ ูโุชูุงูุฏ ุงูุฏุณโุฏููุฏู ุฑุง ูุณุชููุงู ุงุฒ ฺฉูุงุณ <strong>JsonNode</strong> ุงุณุชูุงุฏู ฺฉูุฏ:</p>
<pre><code class="language-csharp">var node = JsonNode.Parse(@&quot;{ &quot;&quot;Name&quot;&quot;:&quot;&quot;Alice&quot;&quot;, &quot;&quot;Age&quot;&quot;: 32}&quot;);
string name = (string)node[&quot;Name&quot;];  // Alice
int age = (int)node[&quot;Age&quot;];           // 32
</code></pre>
<p>ุจุฑุง ยซฺฉุดูยป ูฺฺฏโูุง ูโุชูุงูู ุงุฒ ุงู ุงูฺฏู ุงุณุชูุงุฏู ฺฉูู:</p>
<pre><code class="language-csharp">foreach (KeyValuePair&lt;string, JsonNode&gt; keyValuePair in node.AsObject())
{
    string propertyName = keyValuePair.Key;   // &quot;Name&quot; ุณูพุณ &quot;Age&quot;
    JsonNode value = keyValuePair.Value;
}
</code></pre>
<p>ุงฺฏุฑ ูุทูุฆู ูุณุชุฏ ฺฉู ฺฉ ูฺฺฏ ุชุนุฑู ุดุฏู ุงุณุชุ ุงูฺฏู ุฒุฑ ูุฒ ฺฉุงุฑุจุฑุฏ ุงุณุช:</p>
<pre><code class="language-csharp">if (node.AsObject().TryGetPropertyValue(&quot;Name&quot;, out JsonNode nameNode))
{
    ...
}
</code></pre>
<hr>
<h3>ูพูุงุด Fluent ู LINQ ๐</h3>
<p>ูโุชูุงูุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ ุงูุฏุณโุฏููุฏูโูุงุ ุจู ุนูู ุณุงุฎุชุงุฑ JSON ุฏุณุชุฑุณ ูพุฏุง ฺฉูุฏ. ุจู ุนููุงู ูุซุงูุ ุจุง ุฏุงุดุชู ูุงู JSON ุฒุฑ:</p>
<pre><code class="language-json">[
  {
    &quot;FirstName&quot;:&quot;Sara&quot;,
    &quot;LastName&quot;:&quot;Wells&quot;,
    &quot;Age&quot;:35,
    &quot;Friends&quot;:[&quot;Ian&quot;]
  },
  {
    &quot;FirstName&quot;:&quot;Ian&quot;,
    &quot;LastName&quot;:&quot;Weems&quot;,
    &quot;Age&quot;:42,
    &quot;Friends&quot;:[&quot;Joe&quot;,&quot;Eric&quot;,&quot;Li&quot;]
  },
  {
    &quot;FirstName&quot;:&quot;Dylan&quot;,
    &quot;LastName&quot;:&quot;Lockwood&quot;,
    &quot;Age&quot;:46,
    &quot;Friends&quot;:[&quot;Sara&quot;,&quot;Ian&quot;]
  }
]
</code></pre>
<p>ูโุชูุงูู ุณููู ุฏูุณุช ููุฑ ุฏูู ุฑุง ุงูโฺฏููู ุงุณุชุฎุฑุงุฌ ฺฉูู:</p>
<pre><code class="language-csharp">string li = (string)node[1][&quot;Friends&quot;][2];
</code></pre>
<p>ููฺูู ุงู ูุงู ุจู ุฑุงุญุช ูุงุจู ูพุฑุณโูุฌู ุจุง <strong>LINQ</strong> ุงุณุช:</p>
<pre><code class="language-csharp">JsonNode node = JsonNode.Parse(File.ReadAllText(jsonPath));
var query =
    from person in node.AsArray()
    select new
    {
        FirstName = (string)person[&quot;FirstName&quot;],
        Age = (int)person[&quot;Age&quot;],
        Friends =
            from friend in person[&quot;Friends&quot;].AsArray()
            select (string)friend
    };
</code></pre>
<p>ุจุฑุฎูุงู <strong>JsonDocument</strong>ุ <strong>JsonNode</strong> ูุงุฒ ุจู Dispose ูุฏุงุฑุฏุ ุจูุงุจุฑุงู ูฺฏุฑุงู ุงุฒ ุจุงุจุช ุขุฒุงุฏุณุงุฒ ุญุงูุธู ููฺฏุงู ูพูุงุด ุชูุจู ูุฌูุฏ ูุฏุงุฑุฏ.</p>
<hr>
<h3>ุจูโุฑูุฒุฑุณุงู ุจุง JsonNode โ๏ธ</h3>
<p><strong>JsonObject</strong> ู <strong>JsonArray</strong> ูุงุจู ุชุบุฑ ูุณุชูุฏุ ุจูุงุจุฑุงู ูโุชูุงูุฏ ูุญุชูุง ุขูโูุง ุฑุง ุจูโุฑูุฒุฑุณุงู ฺฉูุฏ.
ุณุงุฏูโุชุฑู ุฑูุด ุจุฑุง ุฌุงฺฏุฒู ุง ุงูุฒูุฏู ูฺฺฏ ุจู ฺฉ <strong>JsonObject</strong>ุ ุงุณุชูุงุฏู ุงุฒ ุงูุฏุณโุฏููุฏู ุงุณุช:</p>
<pre><code class="language-csharp">var node = JsonNode.Parse(@&quot;{ &quot;&quot;Color&quot;&quot;: &quot;&quot;Red&quot;&quot; }&quot;);
node[&quot;Color&quot;] = &quot;White&quot;;
node[&quot;Valid&quot;] = true;
Console.WriteLine(node.ToJsonString());  // {&quot;Color&quot;:&quot;White&quot;,&quot;Valid&quot;:true}
</code></pre>
<p>ุฎุท ุฏูู ูุงูุจุฑ ุจุฑุง ุงู ุฏุณุชูุฑ ุงุณุช:</p>
<pre><code class="language-csharp">node[&quot;Color&quot;] = JsonValue.Create(&quot;White&quot;);
</code></pre>
<p>ุจู ุฌุง ุงุฎุชุตุงุต ฺฉ ููุฏุงุฑ ุณุงุฏูุ ูโุชูุงูุฏ ฺฉ <strong>JsonArray</strong> ุง <strong>JsonObject</strong> ุงุฎุชุตุงุต ุฏูุฏ.
ุจุฑุง ุญุฐู ฺฉ ูฺฺฏุ ุงุจุชุฏุง ุจู <strong>JsonObject</strong> ุชุจุฏู ฺฉูุฏ (ุง <strong>AsObject</strong> ุฑุง ูุฑุงุฎูุงู ฺฉูุฏ) ู ุณูพุณ ูุชุฏ <strong>Remove</strong> ุฑุง ูุฑุงุฎูุงู ฺฉูุฏ:</p>
<pre><code class="language-csharp">node.AsObject().Remove(&quot;Valid&quot;);
</code></pre>
<p>(ููฺูู <strong>JsonObject</strong> ูุชุฏ <strong>Add</strong> ุฏุงุฑุฏ ฺฉู ุฏุฑ ุตูุฑุช ูุฌูุฏ ูฺฺฏุ ุงุณุชุซูุงุก ุงุฌุงุฏ ูโฺฉูุฏ.)</p>
<p><strong>JsonArray</strong> ูุฒ ุงูฺฉุงู ุงุณุชูุงุฏู ุงุฒ ุงูุฏุณโุฏููุฏู ุจุฑุง ุฌุงฺฏุฒู ุนูุงุตุฑ ุฑุง ุฏุงุฑุฏ:</p>
<pre><code class="language-csharp">var node = JsonNode.Parse(&quot;[1, 2, 3]&quot;);
node[0] = 10;
</code></pre>
<p>ูุฑุงุฎูุงู <strong>AsArray</strong>ุ ูุชุฏูุง <strong>Add/Insert/Remove/RemoveAt</strong> ุฑุง ุฏุฑ ุงุฎุชุงุฑ ุดูุง ูโฺฏุฐุงุฑุฏ. ุจุฑุง ูุซุงูุ ุญุฐู ุงููู ุนูุตุฑ ู ุงุถุงูู ฺฉุฑุฏู ฺฉ ุนูุตุฑ ุจู ุงูุชูุง:</p>
<pre><code class="language-csharp">var arrayNode = JsonNode.Parse(&quot;[1, 2, 3]&quot;);
arrayNode.AsArray().RemoveAt(0);
arrayNode.AsArray().Add(4);
Console.WriteLine(arrayNode.ToJsonString());  // [2,3,4]
</code></pre>
<p>ุงุฒ <strong>.NET 8</strong> ุจู ุจุนุฏุ ูโุชูุงูุฏ ฺฉ <strong>JsonNode</strong> ุฑุง ุจุง ูุฑุงุฎูุงู <strong>ReplaceWith</strong> ูุฒ ุจูโุฑูุฒุฑุณุงู ฺฉูุฏ:</p>
<pre><code class="language-csharp">var node = JsonNode.Parse(@&quot;{ &quot;&quot;Color&quot;&quot;: &quot;&quot;Red&quot;&quot; }&quot;);
var color = node[&quot;Color&quot;];
color.ReplaceWith(&quot;Blue&quot;);
</code></pre>
<h3>ุณุงุฎุช DOM ุจุฑุง JsonNode ุจู ุตูุฑุช ุจุฑูุงููโููุณ ๐๏ธ</h3>
<p><strong>JsonArray</strong> ู <strong>JsonObject</strong> ุณุงุฒูุฏฺฏุงู ุฏุงุฑูุฏ ฺฉู ุงุฒ <strong>object initialization syntax</strong> ูพุดุชุจุงู ูโฺฉููุฏุ ู ุงู ุงูฺฉุงู ุฑุง ูโุฏููุฏ ฺฉู ฺฉู DOM ฺฉ <strong>JsonNode</strong> ุฑุง ุฏุฑ ฺฉ ุนุจุงุฑุช ุจุณุงุฒุฏ:</p>
<pre><code class="language-csharp">var node = new JsonArray
{
    new JsonObject {
        [&quot;Name&quot;] = &quot;Tracy&quot;,
        [&quot;Age&quot;] = 30,
        [&quot;Friends&quot;] = new JsonArray(&quot;Lisa&quot;, &quot;Joe&quot;)
    },
    new JsonObject {
        [&quot;Name&quot;] = &quot;Jordyn&quot;,
        [&quot;Age&quot;] = 25,
        [&quot;Friends&quot;] = new JsonArray(&quot;Tracy&quot;, &quot;Li&quot;)
    }
};
</code></pre>
<p>ูุชุฌู ุงู ุณุงุฎุชุงุฑุ JSON ุฒุฑ ุฎูุงูุฏ ุจูุฏ:</p>
<pre><code class="language-json">[
  {
    &quot;Name&quot;: &quot;Tracy&quot;,
    &quot;Age&quot;: 30,
    &quot;Friends&quot;: [&quot;Lisa&quot;, &quot;Joe&quot;]
  },
  {
    &quot;Name&quot;: &quot;Jordyn&quot;,
    &quot;Age&quot;: 25,
    &quot;Friends&quot;: [&quot;Tracy&quot;, &quot;Li&quot;]
  }
]
</code></pre>

  </main>

  <!-- ููุชุฑ ูุดุชุฑฺฉ -->
  <footer class="footer">
    <div class="container">
      <p>
        <img src="/icone/copyright.svg" alt="ฺฉูพโุฑุงุช" width="14" height="14"
             style="vertical-align:middle;margin-inline:4px">
        <span id="y"></span> Gitab โ ุจุฑุง ุชูุณุนูโุฏููุฏฺฏุงู
      </p>
    </div>
  </footer>

  <!-- ุณุงู + ุงุณฺฉุฑูพุช ุชู -->
  <script>
    document.getElementById('y').textContent = new Date().getFullYear();

    (() => {
      const root = document.documentElement;
      const btn = document.getElementById('themeToggle');
      const KEY = 'gitab-theme';
      const media = window.matchMedia('(prefers-color-scheme: dark)');
      const getEffective = s => s === 'auto' ? (media.matches ? 'dark' : 'light') : s;
      function updateTheme(s) {
        root.setAttribute('data-theme', s);
        const mode = getEffective(s);
        root.dataset.colorMode = mode;
        btn.dataset.icon = mode === 'dark' ? 'moon' : 'sun';
      }
      const saved = localStorage.getItem(KEY) || 'auto';
      updateTheme(saved);
      btn.addEventListener('click', () => {
        const curr = localStorage.getItem(KEY) || 'auto';
        const next = curr === 'auto' ? 'dark' : curr === 'dark' ? 'light' : 'auto';
        localStorage.setItem(KEY, next);
        updateTheme(next);
      });
      media.addEventListener('change', () => {
        if ((localStorage.getItem(KEY) || 'auto') === 'auto') updateTheme('auto');
      });
      window.addEventListener('DOMContentLoaded', () => updateTheme(saved));
    })();
  </script>
</body>
</html>
