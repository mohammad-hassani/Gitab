

<!doctype html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8">
  <link rel="icon" type="image/png" href="/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>LINQ Operators</title>
  <meta name="description" content="ุชุฑุฌููโูุง ูุงุฑุณ ฺฉุชุงุจโูุง ูู โ ุณุฑุนุ ูููุงู ู ูุงุจู ุงุชฺฉุง.">

  <!-- ุงุณุชุงูโูุง -->
  <link rel="stylesheet" href="/styles/main.css">
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">

  <style>
  @font-face {
    font-family: 'Vazir';
    src: url('/fonts/Vazir-FD-WOL.ttf') format('truetype');
    font-display: swap;
  }
  body {
    font-family: 'Vazir', sans-serif;
  }
  </style>
</head>

<body>
  <!-- ูุฏุฑ ูุดุชุฑฺฉ -->
  <header class="header">
    <div class="container nav-wrap">
      <a href="/" class="brand">
        <img src="/icone/logo.svg" alt="Gitab logo" width="26" height="26">
        <span>Gitab</span>
      </a>

      <nav class="nav">
        <a href="/" aria-current="page">ุฎุงูู</a>
        <a href="/books/list-books">ฺฉุชุงุจโูุง</a>
        <a href="#">ูุชุฑุฌูู</a>
        <a href="#">ููฺฉุงุฑ</a>
        <a href="#">ุฏุฑุจุงุฑู ูุง</a>
      </nav>

      <div class="nav-actions">
        <button id="themeToggle" class="icon-btn theme-btn" data-icon="moon" aria-label="ุชุบุฑ ุชู">
          <img src="/icone/sun.svg" class="icon-sun" alt="ุฑูุดู">
          <img src="/icone/moon.svg" class="icon-moon" alt="ุชุงุฑฺฉ">
        </button>

        <a class="icon-btn" href="https://github.com/hheydarian/Gitab" target="_blank" title="GitHub">
          <img src="/icone/github.svg" alt="GitHub">
        </a>

        <!-- ุฏฺฉูู ููู ุจุฑุง ููุจุงู -->
        <button class="menu-toggle" aria-label="ููู">
          <img src="/icone/menu.svg" alt="menu">
        </button>
      </div>
    </div>
  </header>

  
  <main class="site-main book-page">
    <h1>ูุตู ููู:  LINQ Operators</h1>
<p>ุงู ูุตู ุจู ุจุฑุฑุณ ุชฺฉโุชฺฉ <strong>ุนููฺฏุฑูุง LINQ</strong> ูโูพุฑุฏุงุฒุฏ. ุนูุงูู ุจุฑ ุงูฺฉู ุจูโุนููุงู ฺฉ ูุฑุฌุน ุนูู ูโฺฉูุฏุ ุฏู ุจุฎุด <strong>ยซProjectingยป</strong> (ุฏุฑ ุตูุญู ดทณ) ู <strong>ยซJoiningยป</strong> (ุฏุฑ ุตูุญู ดทณ) ููุงูู ููู ุฑุง ูพูุดุด ูโุฏููุฏ:</p>
<ul>
<li>๐ <strong>Projecting object hierarchies</strong> (ุงุฌุงุฏ ู ููุงุด ุณูุณููโูุฑุงุชุจ ุงุดุงุก)</li>
<li>๐ <strong>Joining</strong> ุจุง ุงุณุชูุงุฏู ุงุฒ <code>Select</code>ุ <code>SelectMany</code>ุ <code>Join</code> ู <code>GroupJoin</code></li>
<li>๐ <strong>Query expressions with multiple range variables</strong> (ุนุจุงุฑุชโูุง ฺฉูุฆุฑ ุจุง ฺูุฏ ูุชุบุฑ ุฏุงูููโุง)</li>
</ul>
<hr>
<h3>๐ค ูุซุงู ูพุงู</h3>
<p>ุชูุงู ูุซุงูโูุง ุงู ูุตู ูุฑุถ ูโฺฉููุฏ ฺฉู ฺฉ ุขุฑุงู ุงุฒ ูุงูโูุง ุชุนุฑู ุดุฏู ุงุณุช:</p>
<pre class="hljs"><code><span class="hljs-built_in">string</span>[] names = { <span class="hljs-string">&quot;Tom&quot;</span>, <span class="hljs-string">&quot;Dick&quot;</span>, <span class="hljs-string">&quot;Harry&quot;</span>, <span class="hljs-string">&quot;Mary&quot;</span>, <span class="hljs-string">&quot;Jay&quot;</span> };
</code></pre>
<p>ูุซุงูโูุง ฺฉู ูุฑุจูุท ุจู ูพุงฺฏุงูโุฏุงุฏู ูุณุชูุฏ ูุฑุถ ูโฺฉููุฏ ุดุก ุฒุฑ ุณุงุฎุชู ุดุฏู ุงุณุช:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> dbContext = <span class="hljs-keyword">new</span> NutshellContext();
</code></pre>
<p>ฺฉู ฺฉูุงุณ <code>NutshellContext</code> ุจู ุดฺฉู ุฒุฑ ุชุนุฑู ุดุฏู ุงุณุช:</p>
<pre class="hljs"><code><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">NutshellContext</span> : <span class="hljs-title">DbContext</span>
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">DbSet</span>&lt;<span class="hljs-title">Customer</span>&gt; Customers</span> { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">DbSet</span>&lt;<span class="hljs-title">Purchase</span>&gt; Purchases</span> { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnModelCreating</span>(<span class="hljs-params">ModelBuilder modelBuilder</span>)</span>
    {
        modelBuilder.Entity&lt;Customer&gt;(entity =&gt;
        {
            entity.ToTable(<span class="hljs-string">&quot;Customer&quot;</span>);
            entity.Property(e =&gt; e.Name).IsRequired();  <span class="hljs-comment">// ุณุชูู ุบุฑูุงุจู ุชู</span>
        });

        modelBuilder.Entity&lt;Purchase&gt;(entity =&gt;
        {
            entity.ToTable(<span class="hljs-string">&quot;Purchase&quot;</span>);
            entity.Property(e =&gt; e.Date).IsRequired();
            entity.Property(e =&gt; e.Description).IsRequired();
        });
    }
}
</code></pre>
<hr>
<h3>๐งโ๐ป ุชุนุฑู ฺฉูุงุณโูุง</h3>
<pre class="hljs"><code><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Customer</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> ID { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Name { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">virtual</span> List&lt;Purchase&gt; Purchases { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
        = <span class="hljs-keyword">new</span> List&lt;Purchase&gt;();
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Purchase</span>
{        
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> ID { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span>? CustomerID { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> DateTime Date { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Description { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">decimal</span> Price { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">virtual</span> Customer Customer { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
}
</code></pre>
<hr>
<h3>๐ ุงุจุฒุงุฑ LINQPad</h3>
<p>ุชูุงู ูุซุงูโูุง ุงู ูุตู ุฏุฑ <strong>LINQPad</strong> ุงุฒ ูพุด ุจุงุฑฺฏุฐุงุฑ ุดุฏูโุงูุฏุ ููุฑุงู ุจุง ฺฉ ูพุงฺฏุงูโุฏุงุฏู ููููู ฺฉู <strong>Schema</strong> ูุดุงุจู ุฏุงุฑุฏ.<br>
๐ฅ ูโุชูุงูุฏ LINQPad ุฑุง ุงุฒ <a href="http://www.linqpad.net">www.linqpad.net</a> ุฏุงูููุฏ ฺฉูุฏ.</p>
<hr>
<h3>๐ ุชุนุฑู ุฌุฏููโูุง SQL Server ูุชูุงุธุฑ</h3>
<pre class="hljs"><code><span class="hljs-keyword">CREATE TABLE</span> Customer (
    ID <span class="hljs-type">int</span> <span class="hljs-keyword">NOT NULL</span> <span class="hljs-keyword">IDENTITY</span> <span class="hljs-keyword">PRIMARY KEY</span>,
    Name nvarchar(<span class="hljs-number">30</span>) <span class="hljs-keyword">NOT NULL</span>
)

<span class="hljs-keyword">CREATE TABLE</span> Purchase (
    ID <span class="hljs-type">int</span> <span class="hljs-keyword">NOT NULL</span> <span class="hljs-keyword">IDENTITY</span> <span class="hljs-keyword">PRIMARY KEY</span>,
    CustomerID <span class="hljs-type">int</span> <span class="hljs-keyword">NOT NULL</span> <span class="hljs-keyword">REFERENCES</span> Customer(ID),
    <span class="hljs-type">Date</span> datetime <span class="hljs-keyword">NOT NULL</span>,
    Description nvarchar(<span class="hljs-number">30</span>) <span class="hljs-keyword">NOT NULL</span>,
    Price <span class="hljs-type">decimal</span> <span class="hljs-keyword">NOT NULL</span>
)
</code></pre>
<hr>
<h2>๐ ูุฑูุฑ ฺฉู (Overview)</h2>
<p>ุฏุฑ ุงู ุจุฎุดุ ฺฉ ูุฑูุฑ ฺฉู ุจุฑ <strong>ุนููฺฏุฑูุง ุงุณุชุงูุฏุงุฑุฏ ฺฉูุฆุฑ</strong> ุงุฑุงุฆู ูโุฏูู. ุงู ุนููฺฏุฑูุง ุฏุฑ ุณู ุฏุณุชู ุชูุณู ูโุดููุฏ:</p>
<ol>
<li>๐ <strong>Sequence in, sequence out (sequence โ sequence)</strong><br>
โ ุนู ูุฑูุฏ ฺฉ ุฏูุจุงูู (sequence) ุงุณุช ู ุฎุฑูุฌ ูู ฺฉ ุฏูุจุงูู.</li>
<li>๐ <strong>Sequence in, single element or scalar value out</strong><br>
โ ุนู ูุฑูุฏ ฺฉ ุฏูุจุงูู ุงุณุช ุงูุง ุฎุฑูุฌ ููุท ฺฉ ุนูุตุฑ ุง ฺฉ ููุฏุงุฑ ูููุฑุฏ.</li>
<li>๐ <strong>Nothing in, sequence out (generation methods)</strong><br>
โ ุนู ูฺ ูุฑูุฏ ูุฌูุฏ ูุฏุงุฑุฏ ุงูุง ุฎุฑูุฌ ฺฉ ุฏูุจุงูู ุชููุฏ ูโุดูุฏ.</li>
</ol>
<hr>
<p>ูุง ุงุจุชุฏุง ูุฑ ุณู ุฏุณุชู ุฑุง ูุนุฑู ฺฉุฑุฏู ู ุนููฺฏุฑูุง ูุฑุจูุท ุจู ูุฑฺฉุฏุงู ุฑุง ุจุฑุฑุณ ูโฺฉูู. ุณูพุณ ุจูโุทูุฑ ุฌุฏุงฺฏุงูู ุณุฑุงุบ ุชฺฉโุชฺฉ ุนููฺฏุฑูุง ุฎูุงูู ุฑูุช.</p>
<hr>
<h2>๐ Sequence โ Sequence</h2>
<p>ุจุดุชุฑ ุนููฺฏุฑูุง LINQ ุฏุฑ ุงู ุฏุณุชู ูุฑุงุฑ ูโฺฏุฑูุฏ. ุขูโูุง ฺฉ ุง ฺูุฏ ุฏูุจุงูู ุฑุง ุจูโุนููุงู ูุฑูุฏ ูโฺฏุฑูุฏ ู ุฏุฑ ุฎุฑูุฌ ฺฉ ุฏูุจุงูู ุชููุฏ ูโฺฉููุฏ.</p>
<p>๐ <strong>ุดฺฉู น-ฑ</strong> ุนููฺฏุฑูุง ุฑุง ูุดุงู ูโุฏูุฏ ฺฉู ุณุงุฎุชุงุฑ ุฏูุจุงููโูุง ุฑุง ุชุบุฑ ูโุฏููุฏ.</p>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-1.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>๐ ุนููฺฏุฑูุง LINQ โ ุฏุณุชูโุจูุฏโูุง</h3>
<p>ุฏุฑ ุงู ุจุฎุดุ ุนููฺฏุฑูุง LINQ ุฑุง ุจุฑ ุงุณุงุณ ููุน ูุฑูุฏ ู ุฎุฑูุฌ ูุฑูุฑ ูโฺฉูู. ูุฑ ุฏุณุชู ุจุง ูุซุงูโูุง ู ุชูุถุญ ฺฉูุชุงู ูุนุฑู ูโุดูุฏ.</p>
<hr>
<h2>๐ Filtering (ููุชุฑ ฺฉุฑุฏู)</h2>
<p><strong>ูุฑูุฏ:</strong> <code>IEnumerable&lt;TSource&gt;</code><br>
<strong>ุฎุฑูุฌ:</strong> <code>IEnumerable&lt;TSource&gt;</code></p>
<p>๐น ูุธูู: ุจุฑฺฏุฑุฏุงูุฏู ฺฉ ุฒุฑูุฌููุนู ุงุฒ ุนูุงุตุฑ ุงุตู.</p>
<p>๐ ุนููฺฏุฑูุง:<br>
<code>Where</code>, <code>Take</code>, <code>TakeLast</code>, <code>TakeWhile</code>, <code>Skip</code>, <code>SkipLast</code>, <code>SkipWhile</code>,<br>
<code>Distinct</code>, <code>DistinctBy</code></p>
<hr>
<h2>๐จ Projecting (ุชุจุฏู/ููุงุด)</h2>
<p><strong>ูุฑูุฏ:</strong> <code>IEnumerable&lt;TSource&gt;</code><br>
<strong>ุฎุฑูุฌ:</strong> <code>IEnumerable&lt;TResult&gt;</code></p>
<p>๐น ูุธูู: ุชุบุฑ ุดฺฉู ูุฑ ุนูุตุฑ ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉ <strong>lambda function</strong>.</p>
<ul>
<li><code>SelectMany</code> ุฏูุจุงููโูุง ุชู ุฏุฑ ุชู (nested sequences) ุฑุง <strong>ูุณุทุญโุณุงุฒ (flatten)</strong> ูโฺฉูุฏ.</li>
<li><code>Select</code> ู <code>SelectMany</code> ูโุชูุงููุฏ ุงููุงุน ูุฎุชูู <strong>Join</strong> (ูุงููุฏ inner join, left outer join, cross join, non-equi join) ุฑุง ุจุง <strong>EF Core</strong> ุงูุฌุงู ุฏููุฏ.</li>
</ul>
<p>๐ ุนููฺฏุฑูุง:<br>
<code>Select</code>, <code>SelectMany</code></p>
<hr>
<h2>๐ Joining (ุงุชุตุงู/ุชุฑฺฉุจ)</h2>
<p><strong>ูุฑูุฏ:</strong><br>
<code>IEnumerable&lt;TOuter&gt;, IEnumerable&lt;TInner&gt;</code><br>
<strong>ุฎุฑูุฌ:</strong><br>
<code>IEnumerable&lt;TResult&gt;</code></p>
<p>๐น ูุธูู: ุชุฑฺฉุจ ุนูุงุตุฑ ฺฉ ุฏูุจุงูู ุจุง ุฏูุจุงููโุง ุฏฺฏุฑ.</p>
<ul>
<li><code>Join</code> ู <code>GroupJoin</code> ุจุฑุง ฺฉุงุฑุง ุจูุชุฑ ุฏุฑ ฺฉูุฆุฑโูุง ูุญู ุทุฑุงุญ ุดุฏูโุงูุฏ ู ุงุฒ <strong>inner join</strong> ู <strong>left outer join</strong> ูพุดุชุจุงู ูโฺฉููุฏ.</li>
<li><code>Zip</code> ุฏู ุฏูุจุงูู ุฑุง ููโุฒูุงู ูพูุงุด ฺฉุฑุฏู ู ุฑู ูุฑ ุฌูุช ุนูุตุฑ ฺฉ ุชุงุจุน ุงุนูุงู ูโฺฉูุฏ.</li>
</ul>
<p>๐ ุนููฺฏุฑูุง:<br>
<code>Join</code>, <code>GroupJoin</code>, <code>Zip</code></p>
<hr>
<h2>๐ Ordering (ูุฑุชุจโุณุงุฒ)</h2>
<p><strong>ูุฑูุฏ:</strong> <code>IEnumerable&lt;TSource&gt;</code><br>
<strong>ุฎุฑูุฌ:</strong> <code>IOrderedEnumerable&lt;TSource&gt;</code></p>
<p>๐น ูุธูู: ุจุงุฒฺฏุฑุฏุงูุฏู ฺฉ ุฏูุจุงูู ุจุง ุชุฑุชุจ ุฌุฏุฏ.</p>
<p>๐ ุนููฺฏุฑูุง:<br>
<code>OrderBy</code>, <code>OrderByDescending</code>, <code>ThenBy</code>, <code>ThenByDescending</code>, <code>Reverse</code></p>
<hr>
<h2>๐ Grouping (ฺฏุฑููโุจูุฏ)</h2>
<p><strong>ูุฑูุฏ:</strong> <code>IEnumerable&lt;TSource&gt;</code><br>
<strong>ุฎุฑูุฌ:</strong></p>
<ul>
<li><code>IEnumerable&lt;IGrouping&lt;TKey,TElement&gt;&gt;</code></li>
<li>ุง <code>IEnumerable&lt;TElement[]&gt;</code></li>
</ul>
<p>๐น ูุธูู: ุชูุณู ฺฉ ุฏูุจุงูู ุจู ุฒุฑโุฏูุจุงููโูุง.</p>
<p>๐ ุนููฺฏุฑูุง:<br>
<code>GroupBy</code>, <code>Chunk</code></p>
<hr>
<h2>๐ Set Operators (ุนููฺฏุฑูุง ูุฌููุนูโุง)</h2>
<p><strong>ูุฑูุฏ:</strong><br>
<code>IEnumerable&lt;TSource&gt;, IEnumerable&lt;TSource&gt;</code><br>
<strong>ุฎุฑูุฌ:</strong><br>
<code>IEnumerable&lt;TSource&gt;</code></p>
<p>๐น ูุธูู: ฺฏุฑูุชู ุฏู ุฏูุจุงูู ููโููุน ู ุจุฑฺฏุฑุฏุงูุฏู ุงุดุชุฑุงฺฉุ ุงุฌุชูุงุน ุง ุชูุงูุช ุขูโูุง.</p>
<p>๐ ุนููฺฏุฑูุง:<br>
<code>Concat</code>, <code>Union</code>, <code>UnionBy</code>, <code>Intersect</code>, <code>IntersectBy</code>, <code>Except</code>, <code>ExceptBy</code></p>
<hr>
<h2>๐ Conversion Methods (ุชุจุฏู)</h2>
<h3>๐ Import</h3>
<p><strong>ูุฑูุฏ:</strong> <code>IEnumerable</code><br>
<strong>ุฎุฑูุฌ:</strong> <code>IEnumerable&lt;TResult&gt;</code></p>
<p>๐ ุนููฺฏุฑูุง:<br>
<code>OfType</code>, <code>Cast</code></p>
<h3>๐ค Export</h3>
<p><strong>ูุฑูุฏ:</strong> <code>IEnumerable&lt;TSource&gt;</code><br>
<strong>ุฎุฑูุฌ:</strong> ฺฉ ุขุฑุงูุ ูุณุชุ ุฏฺฉุดูุฑุ Lookup ุง ุฏูุจุงูู</p>
<p>๐ ุนููฺฏุฑูุง:<br>
<code>ToArray</code>, <code>ToList</code>, <code>ToDictionary</code>, <code>ToLookup</code>, <code>AsEnumerable</code>, <code>AsQueryable</code></p>
<hr>
<h2>๐ฏ Sequence โ Element or Value</h2>
<h3>๐น Element Operators (ุงูุชุฎุงุจ ุนูุตุฑ)</h3>
<p><strong>ูุฑูุฏ:</strong> <code>IEnumerable&lt;TSource&gt;</code><br>
<strong>ุฎุฑูุฌ:</strong> <code>TSource</code></p>
<p>๐ ุนููฺฏุฑูุง:<br>
<code>First</code>, <code>FirstOrDefault</code>, <code>Last</code>, <code>LastOrDefault</code>,<br>
<code>Single</code>, <code>SingleOrDefault</code>, <code>ElementAt</code>, <code>ElementAtOrDefault</code>,<br>
<code>MinBy</code>, <code>MaxBy</code>, <code>DefaultIfEmpty</code></p>
<hr>
<h3>๐น Aggregation Methods (ุชุฌูุน)</h3>
<p><strong>ูุฑูุฏ:</strong> <code>IEnumerable&lt;TSource&gt;</code><br>
<strong>ุฎุฑูุฌ:</strong> ฺฉ ููุฏุงุฑ ูููุฑุฏ (scalar)</p>
<p>๐ ูุธูู: ุงูุฌุงู ูุญุงุณุจู ุฑู ฺฉ ุฏูุจุงูู ู ุจุงุฒฺฏุฑุฏุงูุฏู ฺฉ ููุฏุงุฑ ุนุฏุฏ ุง ูุดุงุจู ุขู.</p>
<p>๐ ุนููฺฏุฑูุง:<br>
<code>Aggregate</code>, <code>Average</code>, <code>Count</code>, <code>LongCount</code>, <code>Sum</code>, <code>Max</code>, <code>Min</code></p>
<hr>
<h3>๐น Quantifiers (ฺฉูุงูุชูุงุฑูุง)</h3>
<p><strong>ูุฑูุฏ:</strong> <code>IEnumerable&lt;TSource&gt;</code><br>
<strong>ุฎุฑูุฌ:</strong> <code>bool</code></p>
<p>๐ ูุธูู: ุจุฑฺฏุฑุฏุงูุฏู ูุชุฌู <strong>true/false</strong> ุจูโุนููุงู ฺฉ ุชุฌูุน.</p>
<p>๐ ุนููฺฏุฑูุง:<br>
<code>All</code>, <code>Any</code>, <code>Contains</code>, <code>SequenceEqual</code></p>
<hr>
<h2>๐ Void โ Sequence</h2>
<h3>๐น Generation Methods (ุชููุฏ)</h3>
<p><strong>ูุฑูุฏ:</strong> <code>void</code><br>
<strong>ุฎุฑูุฌ:</strong> <code>IEnumerable&lt;TResult&gt;</code></p>
<p>๐ ูุธูู: ุณุงุฎุช ฺฉ ุฏูุจุงูู ุณุงุฏู ุงุฒ ุตูุฑ.</p>
<p>๐ ุนููฺฏุฑูุง:<br>
<code>Empty</code>, <code>Range</code>, <code>Repeat</code></p>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-2.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>๐ ูฺฉุชู ุฏุฑุจุงุฑู ุณุชูู ยซSQL equivalentsยป</h3>
<p>ุฏุฑ ุฌุฏููโูุง ูุฑุฌุน ุงู ูุตูุ ุณุชูู <strong>ยซSQL equivalentsยป</strong> ูุฒููุงู ููุงู ฺุฒ ูุณุช ฺฉู ฺฉ ูพุงุฏูโุณุงุฒ <code>IQueryable</code> ูุซู <strong>EF Core</strong> ุชููุฏ ูโฺฉูุฏ.<br>
ุจูฺฉู ุงู ุณุชูู ูุดุงู ูโุฏูุฏ ุงฺฏุฑ ุฎูุฏุชุงู ูโุฎูุงุณุชุฏ ูุนุงุฏู ุขู ฺฉูุฆุฑ ุฑุง ุจู ุฒุจุงู <strong>SQL</strong> ุจููุณุฏุ ูุนูููุงู ุงุฒ ฺู ฺุฒ ุงุณุชูุงุฏู ูโฺฉุฑุฏุฏ.</p>
<ul>
<li>ุงฺฏุฑ ูุนุงุฏู ุณุงุฏูโุง ุจุฑุง ุขู ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏุ ุณุชูู ุฎุงู ุฑูุง ูโุดูุฏ.</li>
<li>ุงฺฏุฑ ูฺ ูุนุงุฏู ุฏุฑ SQL ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏุ ุนุจุงุฑุช <strong>ยซException thrownยป</strong> ุฏุฑุฌ ูโุดูุฏ.</li>
</ul>
<hr>
<h3>๐งโ๐ป ูพุงุฏูโุณุงุฒ Enumerable</h3>
<p>ููุช ฺฉุฏ ูพุงุฏูโุณุงุฒ ุจุฑุง <code>Enumerable</code> ูุดุงู ุฏุงุฏู ูโุดูุฏุ ุจุฑุฑุณ ููุงุฑุฏ ุฒุฑ ุฏุฑ ุขู ุญุฐู ุดุฏูโุงูุฏ:</p>
<ul>
<li>ุจุฑุฑุณ ุขุฑฺฏููุงูโูุง <strong>null</strong></li>
<li>ุจุฑุฑุณ <strong>indexing predicates</strong></li>
</ul>
<hr>
<h3>๐ ุฏุฑุจุงุฑู ูุชุฏูุง Filtering</h3>
<p>ุฏุฑ ูุฑ ฺฉ ุงุฒ ูุชุฏูุง <strong>Filtering</strong>ุ ููุดู ุฎุฑูุฌ ุดุงูู ููุงู ุชุนุฏุงุฏ ุง <strong>ฺฉูุชุฑ</strong> ุงุฒ ุนูุงุตุฑ ุงุณุช ฺฉู ุฏุฑ ูุฑูุฏ ุฏุงุดุชุฏ.<br>
โ๏ธ ูฺโููุช ููโุชูุงูุฏ ุนูุงุตุฑ ุจุดุชุฑ ุงุฒ ุขูฺู ูุงุฑุฏ ฺฉุฑุฏูโุงุฏ ุจู ุฏุณุช ุจุงูุฑุฏ!<br>
ุนูุงูู ุจุฑ ุงูุ ุนูุงุตุฑ ฺฉู ุฏุฑ ุฎุฑูุฌ ุฏุฑุงูุช ูโฺฉูุฏ <strong>ุชุจุฏู ุง ุชุบุฑ ุดฺฉู ุฏุงุฏู ููโุดููุฏ</strong>ุ ุขูโูุง ุฏููุงู ููุงู ุนูุงุตุฑ ูุณุชูุฏ ฺฉู ุฏุฑ ูุฑูุฏ ูุฌูุฏ ุฏุงุดุชูุฏ.</p>
<hr>
<h2>๐ Where</h2>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-3.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>๐ Where ุฏุฑ LINQ</h3>
<hr>
<h3>โ๏ธ ูุญุฏูุฏุชโูุง</h3>
<ul>
<li>โ ุงุณุชูุงุฏู ุงุฒ <code>Where</code> ุฏุฑ <strong>LINQ to SQL</strong> ู <strong>Entity Framework (EF Core)</strong> ุฏุงุฑุง ูุญุฏูุฏุชโูุง ุงุณุช (ุจุฑุฎ ุณูุงุฑููุง ูพุดุชุจุงู ููโุดููุฏ).</li>
</ul>
<hr>
<h3>๐ ุณูุชฺฉุณ ฺฉูุฆุฑ</h3>
<pre class="hljs"><code><span class="hljs-keyword">where</span> <span class="hljs-built_in">bool</span>-expression
</code></pre>
<hr>
<h3>๐ง ูพุงุฏูโุณุงุฒ Enumerable.Where</h3>
<p>ูุณุฎู ุฏุงุฎู <code>Enumerable.Where</code> (ุจุฏูู ุจุฑุฑุณ null) ูุนุงุฏู ฺฉุฏ ุดุจู ุฒุฑ ุงุณุช:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title">IEnumerable</span>&lt;<span class="hljs-title">TSource</span>&gt; <span class="hljs-title">Where</span>&lt;<span class="hljs-title">TSource</span>&gt;(<span class="hljs-params">
    <span class="hljs-keyword">this</span> IEnumerable&lt;TSource&gt; source,
    Func&lt;TSource, <span class="hljs-built_in">bool</span>&gt; predicate</span>)</span>
{
    <span class="hljs-keyword">foreach</span> (TSource element <span class="hljs-keyword">in</span> source)
        <span class="hljs-keyword">if</span> (predicate(element))
            <span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> element;
}
</code></pre>
<hr>
<h3>๐ ุชูุถุญ</h3>
<p><code>Where</code> ุนูุงุตุฑ ุงุฒ ุฏูุจุงูู ูุฑูุฏ ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ ฺฉู ุดุฑุท ุฏุงุฏูโุดุฏู (<strong>predicate</strong>) ุฑุง ุจุฑุขูุฑุฏู ูโฺฉููุฏ.</p>
<hr>
<h3>โจ ูุซุงู ุณุงุฏู</h3>
<pre class="hljs"><code><span class="hljs-built_in">string</span>[] names = { <span class="hljs-string">&quot;Tom&quot;</span>, <span class="hljs-string">&quot;Dick&quot;</span>, <span class="hljs-string">&quot;Harry&quot;</span>, <span class="hljs-string">&quot;Mary&quot;</span>, <span class="hljs-string">&quot;Jay&quot;</span> };

IEnumerable&lt;<span class="hljs-built_in">string</span>&gt; query = names.Where(name =&gt; name.EndsWith(<span class="hljs-string">&quot;y&quot;</span>));

<span class="hljs-comment">// ุฎุฑูุฌ:</span>
<span class="hljs-comment">// Harry</span>
<span class="hljs-comment">// Mary</span>
<span class="hljs-comment">// Jay</span>
</code></pre>
<p>๐น ูุนุงุฏู ุฏุฑ <strong>Query Syntax</strong>:</p>
<pre class="hljs"><code>IEnumerable&lt;<span class="hljs-built_in">string</span>&gt; query =
    <span class="hljs-keyword">from</span> n <span class="hljs-keyword">in</span> names
    <span class="hljs-keyword">where</span> n.EndsWith(<span class="hljs-string">&quot;y&quot;</span>)
    <span class="hljs-keyword">select</span> n;
</code></pre>
<hr>
<h3>๐ ฺูุฏ ุดุฑุท Where ุฏุฑ ฺฉ ฺฉูุฆุฑ</h3>
<p>ฺฉ ุนุจุงุฑุช <code>where</code> ูโุชูุงูุฏ ฺูุฏ ุจุงุฑ ุฏุฑ ฺฉูุฆุฑ ุธุงูุฑ ุดูุฏ ู ุจุง <code>let</code>, <code>orderby</code>, ุง <code>join</code> ุชุฑฺฉุจ ุดูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">from</span> n <span class="hljs-keyword">in</span> names
<span class="hljs-keyword">where</span> n.Length &gt; <span class="hljs-number">3</span>
<span class="hljs-keyword">let</span> u = n.ToUpper()
<span class="hljs-keyword">where</span> u.EndsWith(<span class="hljs-string">&quot;Y&quot;</span>)
<span class="hljs-keyword">select</span> u;

<span class="hljs-comment">// ุฎุฑูุฌ:</span>
<span class="hljs-comment">// HARRY</span>
<span class="hljs-comment">// MARY</span>
</code></pre>
<p>๐ธ ููุงูู <strong>scoping</strong> ุงุณุชุงูุฏุงุฑุฏ #C ุงุนูุงู ูโุดููุฏ. ุนู ููโุชูุงูุฏ ูุจู ุงุฒ ุชุนุฑู ฺฉ ูุชุบุฑ (ุจุง <code>range variable</code> ุง <code>let</code>) ุจู ุขู ุงุฑุฌุงุน ุฏูุฏ.</p>
<hr>
<h3>๐ข Indexed Filtering (ููุชุฑฺฏุฐุงุฑ ุจุฑ ุงุณุงุณ ุงูุฏฺฉุณ)</h3>
<p><code>Where</code> ูโุชูุงูุฏ ุจูโุตูุฑุช ุงุฎุชุงุฑ ุขุฑฺฏููุงู ุฏูู ุงุฒ ููุน <code>int</code> ุฏุฑุงูุช ฺฉูุฏ (ููุงุงูฺฏุฑ <strong>ูููุนุช ุนูุตุฑ</strong> ุฏุฑ ุฏูุจุงูู). ุงู ูฺฺฏ ุงุฌุงุฒู ูโุฏูุฏ ุชุตููโฺฏุฑ ุจุฑุงุณุงุณ ูููุนุช ุงูุฌุงู ุดูุฏ.</p>
<pre class="hljs"><code>IEnumerable&lt;<span class="hljs-built_in">string</span>&gt; query = names.Where((n, i) =&gt; i % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>);

<span class="hljs-comment">// ุฎุฑูุฌ:</span>
<span class="hljs-comment">// Tom</span>
<span class="hljs-comment">// Harry</span>
<span class="hljs-comment">// Jay</span>
</code></pre>
<p>โ๏ธ ุฏุฑ <strong>EF Core</strong> ุงุณุชูุงุฏู ุงุฒ ุงู ูุงุจูุช ุจุงุนุซ <strong>Exception</strong> ูโุดูุฏ.</p>
<hr>
<h3>๐ ููุงุณู ุจุง LIKE ุฏุฑ EF Core</h3>
<p>ูุชุฏูุง ุฒุฑ ุฏุฑ ุฑุดุชูโูุง ุจู <strong>SQL LIKE</strong> ุชุฑุฌูู ูโุดููุฏ:</p>
<ul>
<li><code>Contains</code></li>
<li><code>StartsWith</code></li>
<li><code>EndsWith</code></li>
</ul>
<p>ูุซุงู:</p>
<pre class="hljs"><code>c.Name.Contains(<span class="hljs-string">&quot;abc&quot;</span>)
</code></pre>
<p>ุจู SQL ูุนุงุฏู ุฒุฑ ุชุจุฏู ูโุดูุฏ:</p>
<pre class="hljs"><code>customer.Name <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;%abc%&#x27;</span>
</code></pre>
<blockquote>
<p>(ุฏุฑ ูุงูุน ูุณุฎู <strong>ูพุงุฑุงูุชุฑโุดุฏู</strong> ุณุงุฎุชู ูโุดูุฏุ ูู ุฑุดุชู ูุณุชูู.)</p>
</blockquote>
<p>๐น ุจุฑุง ููุงุณู ุจุง <strong>ุณุชูู ุฏฺฏุฑ</strong> ุจุงุฏ ุงุฒ ูุชุฏ <code>EF.Functions.Like</code> ุงุณุชูุงุฏู ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">where</span> EF.Functions.Like(c.Description, <span class="hljs-string">&quot;%&quot;</span> + c.Name + <span class="hljs-string">&quot;%&quot;</span>)
</code></pre>
<p>ุงู ูุชุฏ ุงูฺฉุงู ููุงุณูโูุง ูพฺุฏูโุชุฑ ุฑุง ูู ูโุฏูุฏุ ูุซู:</p>
<pre class="hljs"><code><span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;abc%def%&#x27;</span>
</code></pre>
<hr>
<h3>๐ ููุงุณู ุฑุดุชูโุง ุจุง &lt; ู &gt; ุฏุฑ EF Core</h3>
<p>ุจุฑุง ููุงุณู ุชุฑุชุจ ุฑุดุชูโูุง ุงุฒ ูุชุฏ <code>string.CompareTo</code> ุงุณุชูุงุฏู ฺฉูุฏ:</p>
<pre class="hljs"><code>dbContext.Purchases
    .Where(p =&gt; p.Description.CompareTo(<span class="hljs-string">&quot;C&quot;</span>) &lt; <span class="hljs-number">0</span>);
</code></pre>
<p>๐ ุงู ฺฉุฏ ุจู ุนููฺฏุฑูุง <code>&lt;</code> ู <code>&gt;</code> ุฏุฑ SQL ูฺฏุงุดุช ูโุดูุฏ.</p>
<hr>
<h3>๐ ุงุณุชูุงุฏู ุงุฒ IN ุฏุฑ EF Core</h3>
<p>ุฏุฑ EF Core ูโุชูุงูุฏ <code>Contains</code> ุฑุง ุฑู ฺฉ ูุฌููุนู ูุญู ุงุณุชูุงุฏู ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-built_in">string</span>[] chosenOnes = { <span class="hljs-string">&quot;Tom&quot;</span>, <span class="hljs-string">&quot;Jay&quot;</span> };

<span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> dbContext.Customers
<span class="hljs-keyword">where</span> chosenOnes.Contains(c.Name)
<span class="hljs-keyword">select</span> c;
</code></pre>
<p>ูุนุงุฏู SQL:</p>
<pre class="hljs"><code><span class="hljs-keyword">WHERE</span> customer.Name <span class="hljs-keyword">IN</span> (&quot;Tom&quot;, &quot;Jay&quot;)
</code></pre>
<p>โ๏ธ ุงฺฏุฑ ูุฌููุนู ูุญู ุขุฑุงูโุง ุงุฒ <strong>entity</strong> ุง ููุน ุบุฑ scalar ุจุงุดุฏุ EF Core ููฺฉู ุงุณุช ุจูโุฌุง ุขู <strong>EXISTS</strong> ุชููุฏ ฺฉูุฏ.</p>
<hr>
<h3>โฉ ุนููฺฏุฑูุง ุจุนุฏ</h3>
<ul>
<li><code>Take</code></li>
<li><code>TakeLast</code></li>
<li><code>Skip</code></li>
<li><code>SkipLast</code></li>
</ul>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-4.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>๐ Take ู Skip ุฏุฑ LINQ</h3>
<hr>
<h3>๐ ุชูุถุญ ฺฉู</h3>
<ul>
<li>๐น ูุชุฏ <code>Take</code> ุงููู <strong>n ุนูุตุฑ</strong> ุงุฒ ุฏูุจุงูู ุฑู ุจุฑูโฺฏุฑุฏููู ู ุจูู ุฑู ูุงุฏุฏู ูโฺฏุฑู.</li>
<li>๐น ูุชุฏ <code>Skip</code> ุงููู <strong>n ุนูุตุฑ</strong> ุฑู ุญุฐู ูโฺฉูู ู ุจูู ุนูุงุตุฑ ุฑู ุจุฑูโฺฏุฑุฏููู.</li>
</ul>
<p>ุงู ุฏู ูุชุฏ ูุนูููุงู <strong>ุจุง ูู</strong> ุงุณุชูุงุฏู ูโุดูุ ูุฎุตูุตุงู ููุช ูโุฎูุงู ุตูุญูโุจูุฏ (Paging) ุฏุฑ ฺฉ ุงูพูฺฉุดู ูุจ ุฑู ูพุงุฏูโุณุงุฒ ฺฉูู.</p>
<hr>
<h3>๐ ูุซุงู ฺฉุงุฑุจุฑุฏ (Paging ุฏุฑ EF Core)</h3>
<p>ูุฑุถ ฺฉู ฺฉุงุฑุจุฑ ุชู ุฏุชุงุจุณ ฺฉุชุงุจโูุง ุฏูุจุงู ุนุจุงุฑุช <code>&quot;mercury&quot;</code> ูโฺฏุฑุฏู ู <strong>ฑฐฐ ูุชุฌู</strong> ูพุฏุง ูโุดู.</p>
<p>๐ ุจุฑุง ฺฏุฑูุชู <strong>ฒฐ ูุชุฌู ุงูู</strong>:</p>
<pre class="hljs"><code>IQueryable&lt;Book&gt; query = dbContext.Books
    .Where(b =&gt; b.Title.Contains(<span class="hljs-string">&quot;mercury&quot;</span>))
    .OrderBy(b =&gt; b.Title)
    .Take(<span class="hljs-number">20</span>);
</code></pre>
<p>๐ ุจุฑุง ฺฏุฑูุชู <strong>ฺฉุชุงุจโูุง ุดูุงุฑู ฒฑ ุชุง ดฐ</strong>:</p>
<pre class="hljs"><code>IQueryable&lt;Book&gt; query = dbContext.Books
    .Where(b =&gt; b.Title.Contains(<span class="hljs-string">&quot;mercury&quot;</span>))
    .OrderBy(b =&gt; b.Title)
    .Skip(<span class="hljs-number">20</span>)
    .Take(<span class="hljs-number">20</span>);
</code></pre>
<hr>
<h3>โ๏ธ ูุญูู ุชุฑุฌูู ุฏุฑ SQL</h3>
<p>ุฏุฑ EF Core:</p>
<ul>
<li>ุฏุฑ <strong>SQL Server 2005</strong> ุจู ุชุงุจุน <code>ROW_NUMBER</code> ุชุฑุฌูู ูโุดู.</li>
<li>ุฏุฑ ูุณุฎูโูุง ูุฏูโุชุฑ SQL Server ุจู <strong>ุฒุฑฺฉูุฆุฑ TOP n</strong> ูฺฏุงุดุช ูโุดู.</li>
</ul>
<hr>
<h3>๐ ูุชุฏูุง TakeLast ู SkipLast</h3>
<ul>
<li><code>TakeLast(n)</code> โ ุขุฎุฑู <strong>n ุนูุตุฑ</strong> ุฑู ุจุฑูโฺฏุฑุฏููู.</li>
<li><code>SkipLast(n)</code> โ ุขุฎุฑู <strong>n ุนูุตุฑ</strong> ุฑู ุญุฐู ูโฺฉูู.</li>
</ul>
<hr>
<h3>๐ ูุงุจูุช ุฌุฏุฏ ุงุฒ .NET 6</h3>
<p>ุงุฒ ูุณุฎู <strong>.NET 6</strong>ุ ูุชุฏ <code>Take</code> ฺฉ ูุณุฎู overload ุฌุฏุฏ ุฏุงุฑู ฺฉู ูุชุบุฑ <code>Range</code> ุฑู ูุจูู ูโฺฉูู. ุงู ูุณุฎู ูโุชููู ุฌุงฺฏุฒู ุชูุงู ฺูุงุฑ ูุชุฏ ุจุดู.</p>
<p>๐ ูุซุงูโูุง:</p>
<pre class="hljs"><code>Take(<span class="hljs-number">5.</span>.)
<span class="hljs-comment">// ูุนุงุฏู Skip(5)</span>

Take(..^<span class="hljs-number">5</span>)
<span class="hljs-comment">// ูุนุงุฏู SkipLast(5)</span>
</code></pre>
<p>ุนู ูโุชูู ุฎู ุชูุฒุชุฑ ู ฺฉูุชุงูโุชุฑ ฺฉุฏ ุจุฒู โจ</p>
<hr>
<h3>โฉ ุนููฺฏุฑูุง ุจุนุฏ</h3>
<ul>
<li><code>TakeWhile</code></li>
<li><code>SkipWhile</code></li>
</ul>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-5.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>๐น TakeWhile ู SkipWhile</h3>
<hr>
<h3>โ๏ธ TakeWhile</h3>
<p><code>TakeWhile</code> ุนูุงุตุฑ ุฏูุจุงูู ูุฑูุฏ ุฑุง <strong>ุจู ุชุฑุชุจ ูพูุงุด</strong> ูโฺฉูุฏ ู ูุฑ ุนูุตุฑ ุฑุง <strong>ุชุง ุฒูุงู ฺฉู ุดุฑุท ุฏุงุฏูโุดุฏู true ุจุงุดุฏ</strong> ุจุฑูโฺฏุฑุฏุงูุฏ.<br>
ุจู ูุญุถ ุงูฺฉู ุดุฑุท false ุดูุฏุ ุจูู ุนูุงุตุฑ ูุงุฏุฏู ฺฏุฑูุชู ูโุดููุฏ.</p>
<pre class="hljs"><code><span class="hljs-built_in">int</span>[] numbers = { <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">234</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span> };
<span class="hljs-keyword">var</span> takeWhileSmall = numbers.TakeWhile(n =&gt; n &lt; <span class="hljs-number">100</span>); <span class="hljs-comment">// ุฎุฑูุฌ: { 3, 5, 2 }</span>
</code></pre>
<hr>
<h3>โ๏ธ SkipWhile</h3>
<p><code>SkipWhile</code> ูู ุฏูุจุงูู ูุฑูุฏ ุฑุง ูพูุงุด ูโฺฉูุฏุ ูู <strong>ุนูุงุตุฑ ุฑุง ุชุง ุฒูุงู ฺฉู ุดุฑุท true ุจุงุดุฏ ูุงุฏุฏู ูโฺฏุฑุฏ</strong>.<br>
ุจุนุฏ ุงุฒ ุงููู ุนูุตุฑ ฺฉู ุดุฑุท false ุดุฏุ ุจูู ุนูุงุตุฑ <strong>ุจุฑฺฏุฑุฏุงูุฏู ูโุดููุฏ</strong>.</p>
<pre class="hljs"><code><span class="hljs-built_in">int</span>[] numbers = { <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">234</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span> };
<span class="hljs-keyword">var</span> skipWhileSmall = numbers.SkipWhile(n =&gt; n &lt; <span class="hljs-number">100</span>); <span class="hljs-comment">// ุฎุฑูุฌ: { 234, 4, 1 }</span>
</code></pre>
<p>โ๏ธ ุชูุฌู:<br>
<code>TakeWhile</code> ู <code>SkipWhile</code> ูฺ ูุนุงุฏู SQL ูุฏุงุฑูุฏ ู ุฏุฑ ฺฉูุฆุฑโูุง <strong>EF Core</strong> ุงุณุชูุงุฏู ุงุฒ ุขูโูุง ุจุงุนุซ <strong>Exception</strong> ูโุดูุฏ.</p>
<hr>
<h3>๐น Distinct ู DistinctBy</h3>
<hr>
<h3>โ Distinct</h3>
<p><code>Distinct</code> ุฏูุจุงูู ูุฑูุฏ ุฑุง ุจุฏูู <strong>ุชฺฉุฑุงุฑโูุง</strong> ุจุฑูโฺฏุฑุฏุงูุฏ.<br>
ูโุชูุงูุฏ <strong>custom equality comparer</strong> ูู ุจู ุขู ุจุฏูุฏ.</p>
<pre class="hljs"><code><span class="hljs-built_in">char</span>[] distinctLetters = <span class="hljs-string">&quot;HelloWorld&quot;</span>.Distinct().ToArray();
<span class="hljs-built_in">string</span> s = <span class="hljs-keyword">new</span> <span class="hljs-built_in">string</span>(distinctLetters); <span class="hljs-comment">// ุฎุฑูุฌ: &quot;HeloWrd&quot;</span>
</code></pre>
<blockquote>
<p>ูโุชูุงูู ูุณุชููุงู ูุชุฏูุง LINQ ุฑุง ุฑู <code>string</code> ุตุฏุง ุจุฒููุ ฺูู <code>string</code> ูพุงุฏูโุณุงุฒโฺฉููุฏู <code>IEnumerable&lt;char&gt;</code> ุงุณุช.</p>
</blockquote>
<hr>
<h3>โ DistinctBy</h3>
<ul>
<li>ูุนุฑู ุดุฏู ุฏุฑ <strong>.NET 6</strong></li>
<li>ุงูฺฉุงู ูุดุฎุต ฺฉุฑุฏู ฺฉ <strong>key selector</strong> ูุจู ุงุฒ ููุงุณู ุชุณุงู ุฑุง ูุฑุงูู ูโฺฉูุฏ.</li>
</ul>
<p>ูุซุงู:</p>
<pre class="hljs"><code><span class="hljs-keyword">new</span>[] { <span class="hljs-number">1.0</span>, <span class="hljs-number">1.1</span>, <span class="hljs-number">2.0</span>, <span class="hljs-number">2.1</span>, <span class="hljs-number">3.0</span>, <span class="hljs-number">3.1</span> }
    .DistinctBy(n =&gt; Math.Round(n, <span class="hljs-number">0</span>)); <span class="hljs-comment">// ุฎุฑูุฌ: { 1, 2, 3 }</span>
</code></pre>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-6.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>๐จ Select ู SelectMany ุฏุฑ LINQ</h3>
<hr>
<h3>โ๏ธ ุชูุถุญ ฺฉู</h3>
<p>ููุช <strong>ุฑู ูพุงฺฏุงู ุฏุงุฏู ฺฉูุฆุฑ ูโุฒูู</strong>ุ <code>Select</code> ู <code>SelectMany</code> <strong>ุงูุนุทุงูโูพุฐุฑุชุฑู ุงุจุฒุงุฑูุง ุจุฑุง ุงูุฌุงู join</strong> ูุณุชูุฏ.<br>
ุงูุง ุจุฑุง <strong>ฺฉูุฆุฑโูุง ูุญู (Local queries)</strong>ุ <code>Join</code> ู <code>GroupJoin</code> <strong>ฺฉุงุฑุขูุฏุชุฑู ู ุณุฑุนโุชุฑู ุงุจุฒุงุฑูุง ุจุฑุง join</strong> ูุญุณูุจ ูโุดููุฏ.</p>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-7.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>Select</h3>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-8.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>โ๏ธ ูุญุฏูุฏุช EF Core</h3>
<ul>
<li>โ ุงุณุชูุงุฏู ุงุฒ <code>Select</code> ุจู ุนููุงู <strong>subquery ูพฺุฏู ุง indexed projection</strong> ุฏุฑ EF Core ูุญุฏูุฏุช ุฏุงุฑุฏ ู ุจุฑุฎ ุณูุงุฑููุง ููฺฉู ุงุณุช ูพุดุชุจุงู ูุดูุฏ.</li>
</ul>
<hr>
<h3>๐ ุณูุชฺฉุณ ฺฉูุฆุฑ</h3>
<pre class="hljs"><code><span class="hljs-keyword">select</span> projection-expression
</code></pre>
<hr>
<h3>๐ง ูพุงุฏูโุณุงุฒ Enumerable</h3>
<p>ูุณุฎู ุฏุงุฎู <code>Enumerable.Select</code> ุจู ุดฺฉู ุฒุฑ ุงุณุช:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title">IEnumerable</span>&lt;<span class="hljs-title">TResult</span>&gt; <span class="hljs-title">Select</span>&lt;<span class="hljs-title">TSource</span>,<span class="hljs-title">TResult</span>&gt;(<span class="hljs-params">
    <span class="hljs-keyword">this</span> IEnumerable&lt;TSource&gt; source,
    Func&lt;TSource,TResult&gt; selector</span>)</span>
{
    <span class="hljs-keyword">foreach</span> (TSource element <span class="hljs-keyword">in</span> source)
        <span class="hljs-function"><span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> <span class="hljs-title">selector</span>(<span class="hljs-params">element</span>)</span>;
}
</code></pre>
<hr>
<h3>๐น ุชูุถุญ ฺฉู</h3>
<ul>
<li>ุจุง <code>Select</code> ููุดู <strong>ุชุนุฏุงุฏ ุนูุงุตุฑ ุฎุฑูุฌ ุจุฑุงุจุฑ ุจุง ุชุนุฏุงุฏ ุนูุงุตุฑ ูุฑูุฏ ุงุณุช</strong>.</li>
<li>ูุฑ ุนูุตุฑ ูโุชูุงูุฏ ุจุง <strong>lambda function</strong> ุจู ูุฑ ุดฺฉู ุฏูุฎูุงู ุชุจุฏู ุดูุฏ.</li>
</ul>
<hr>
<h3>๐น ูุซุงู ูพุงูโุง: ฺฏุฑูุชู ูุงู ูููุชโูุง</h3>
<pre class="hljs"><code>IEnumerable&lt;<span class="hljs-built_in">string</span>&gt; query = <span class="hljs-keyword">from</span> f <span class="hljs-keyword">in</span> FontFamily.Families
                            <span class="hljs-keyword">select</span> f.Name;

<span class="hljs-keyword">foreach</span> (<span class="hljs-built_in">string</span> name <span class="hljs-keyword">in</span> query) 
    Console.WriteLine(name);
</code></pre>
<p>๐น ูุนุงุฏู <strong>Lambda Syntax</strong>:</p>
<pre class="hljs"><code>IEnumerable&lt;<span class="hljs-built_in">string</span>&gt; query = FontFamily.Families.Select(f =&gt; f.Name);
</code></pre>
<hr>
<h3>๐น ูพุฑูฺู ฺฉุฑุฏู ุจู ุงููุงุน ูุงุดูุงุณ (Anonymous Types)</h3>
<pre class="hljs"><code><span class="hljs-keyword">var</span> query = <span class="hljs-keyword">from</span> f <span class="hljs-keyword">in</span> FontFamily.Families
            <span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> { f.Name, LineSpacing = f.GetLineSpacing(FontStyle.Bold) };
</code></pre>
<ul>
<li>ฺฏุงู ุงููุงุช projection ุจุฏูู ูฺ ุชุบุฑ ุฎุงุต ุงูุฌุงู ูโุดูุฏุ ููุท ุจุฑุง ุงูฺฉู ฺฉูุฆุฑ ุจุง <code>select</code> ุง <code>group</code> ูพุงุงู ุงุจุฏ.<br>
ูุซุงู: ุงูุชุฎุงุจ ูููุชโูุง ฺฉู <strong>strikeout</strong> ุฑุง ูพุดุชุจุงู ูโฺฉููุฏ:</li>
</ul>
<pre class="hljs"><code>IEnumerable&lt;FontFamily&gt; query =
    <span class="hljs-keyword">from</span> f <span class="hljs-keyword">in</span> FontFamily.Families
    <span class="hljs-keyword">where</span> f.IsStyleAvailable(FontStyle.Strikeout)
    <span class="hljs-keyword">select</span> f;

<span class="hljs-keyword">foreach</span> (FontFamily ff <span class="hljs-keyword">in</span> query)
    Console.WriteLine(ff.Name);
</code></pre>
<blockquote>
<p>ุฏุฑ ุงู ููุงุฑุฏุ <strong>ฺฉุงููพุงูุฑ ููฺฏุงู ุชุจุฏู ุจู Fluent Syntax</strong>ุ projection ุฑุง ุญุฐู ูโฺฉูุฏ.</p>
</blockquote>
<hr>
<h3>๐น Indexed Projection</h3>
<ul>
<li><code>selector</code> ูโุชูุงูุฏ ุขุฑฺฏููุงู ุงุฎุชุงุฑ ุฏูู ุงุฒ ููุน <strong>int</strong> ุจฺฏุฑุฏ ฺฉู ููุงุงูฺฏุฑ <strong>ูููุนุช ุนูุตุฑ</strong> ุฏุฑ ุฏูุจุงูู ุงุณุช.</li>
<li>โ๏ธ ุงู ูุงุจูุช ููุท ุฏุฑ <strong>ฺฉูุฆุฑโูุง ูุญู</strong> ฺฉุงุฑ ูโฺฉูุฏ.</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">string</span>[] names = { <span class="hljs-string">&quot;Tom&quot;</span>, <span class="hljs-string">&quot;Dick&quot;</span>, <span class="hljs-string">&quot;Harry&quot;</span>, <span class="hljs-string">&quot;Mary&quot;</span>, <span class="hljs-string">&quot;Jay&quot;</span> };
IEnumerable&lt;<span class="hljs-built_in">string</span>&gt; query = names.Select((s, i) =&gt; i + <span class="hljs-string">&quot;=&quot;</span> + s);
<span class="hljs-comment">// ุฎุฑูุฌ: { &quot;0=Tom&quot;, &quot;1=Dick&quot;, &quot;2=Harry&quot;, &quot;3=Mary&quot;, &quot;4=Jay&quot; }</span>
</code></pre>
<hr>
<h3>๐น Subqueries ู Object Hierarchies</h3>
<ul>
<li>ูโุชูุงู ฺฉ <strong>subquery</strong> ุฑุง ุฏุฑ <code>Select</code> ุฌุง ุฏุงุฏ ุชุง <strong>ุณุงุฎุชุงุฑ ุดุก (Object Hierarchy)</strong> ุจุณุงุฒู.</li>
<li>ูุซุงู: ุฏุฑุงูุช ูุฑ ุฏุงุฑฺฉุชูุฑ ุฏุฑ ูุณุฑ <code>Path.GetTempPath()</code> ููุฑุงู ุจุง ูุณุช ูุงูโูุง ุขู:</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">string</span> tempPath = Path.GetTempPath();
DirectoryInfo[] dirs = <span class="hljs-keyword">new</span> DirectoryInfo(tempPath).GetDirectories();

<span class="hljs-keyword">var</span> query = <span class="hljs-function"><span class="hljs-keyword">from</span> d <span class="hljs-keyword">in</span> dirs
            <span class="hljs-title">where</span> (<span class="hljs-params">d.Attributes &amp; FileAttributes.System</span>)</span> == <span class="hljs-number">0</span>
            <span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span>
            {
                DirectoryName = d.FullName,
                Created = d.CreationTime,
                Files = <span class="hljs-keyword">from</span> f <span class="hljs-keyword">in</span> d.GetFiles()
                        <span class="hljs-keyword">where</span> (f.Attributes &amp; FileAttributes.Hidden) == <span class="hljs-number">0</span>
                        <span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> { FileName = f.Name, f.Length }
            };

<span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> dirFiles <span class="hljs-keyword">in</span> query)
{
    Console.WriteLine(<span class="hljs-string">&quot;Directory: &quot;</span> + dirFiles.DirectoryName);
    <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> <span class="hljs-keyword">file</span> <span class="hljs-keyword">in</span> dirFiles.Files)
        Console.WriteLine(<span class="hljs-string">&quot;  &quot;</span> + <span class="hljs-keyword">file</span>.FileName + <span class="hljs-string">&quot; Len: &quot;</span> + <span class="hljs-keyword">file</span>.Length);
}
</code></pre>
<ul>
<li>ุจุฎุด ุฏุงุฎู ุงู ฺฉูุฆุฑ ฺฉ <strong>correlated subquery</strong> ุงุณุชุ ฺูู ุจู ุดุก <code>d</code> ุฏุฑ ฺฉูุฆุฑ ุฎุงุฑุฌ ุงุฑุฌุงุน ูโุฏูุฏ.</li>
<li>ฺฉ subquery ุฏุฑ <code>Select</code> ุงูฺฉุงู <strong>ูฺฏุงุดุช ฺฉ ูุฑูุด ุดุก (Object Hierarchy) ุจู ูุฑูุด ุฏฺฏุฑ</strong> ุง ูฺฏุงุดุช <strong>Relational Object Model ุจู Hierarchical Object Model</strong> ุฑุง ูโุฏูุฏ.</li>
</ul>
<hr>
<h3>๐น Deferred Execution ุฏุฑ Local Queries</h3>
<ul>
<li>ุฏุฑ ฺฉูุฆุฑโูุง ูุญูุ subquery ุฏุงุฎู <code>Select</code> ุจุงุนุซ <strong>double-deferred execution</strong> ูโุดูุฏ.</li>
<li>ุฏุฑ ูุซุงู ุจุงูุงุ ูุงูโูุง ุชุง ุฒูุงู ฺฉู <code>foreach</code> ุฏุงุฎู ุงุฌุฑุง ูุดูุฏุ <strong>ููุชุฑ ุง ูพุฑูฺู ููโุดููุฏ</strong>.</li>
</ul>
<h3>๐ Subqueries ู Joins ุฏุฑ EF Core</h3>
<hr>
<h3>๐น Subquery Projections ุฏุฑ EF Core</h3>
<ul>
<li><strong>Projection ุจุง subquery</strong> ุฏุฑ EF Core ุจู ุฎูุจ ฺฉุงุฑ ูโฺฉูุฏ ู ูโุชูุงูุฏ ุฌุงฺฏุฒู <strong>SQL-style joins</strong> ุจุงุดุฏ.</li>
<li>ูุซุงู: ุฏุฑุงูุช ูุงู ูุฑ ูุดุชุฑ ุจู ููุฑุงู <strong>ุฎุฑุฏูุง ุจุง ุงุฑุฒุด ุจุงูุง ฑฐฐฐ</strong>:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">var</span> query =
    <span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> dbContext.Customers
    <span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> {
        c.Name,
        Purchases = (
            <span class="hljs-keyword">from</span> p <span class="hljs-keyword">in</span> dbContext.Purchases
            <span class="hljs-keyword">where</span> p.CustomerID == c.ID &amp;&amp; p.Price &gt; <span class="hljs-number">1000</span>
            <span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> { p.Description, p.Price }
        ).ToList()
    };

<span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> namePurchases <span class="hljs-keyword">in</span> query)
{
    Console.WriteLine(<span class="hljs-string">&quot;Customer: &quot;</span> + namePurchases.Name);
    <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> purchaseDetail <span class="hljs-keyword">in</span> namePurchases.Purchases)
        Console.WriteLine(<span class="hljs-string">&quot;  - $$$: &quot;</span> + purchaseDetail.Price);
}
</code></pre>
<blockquote>
<p>โ๏ธ ุฏูุช ฺฉูุฏ ฺฉู ุงุณุชูุงุฏู ุงุฒ <code>ToList</code> ุฏุฑ subquery ุถุฑูุฑ ุงุณุชุ ุฒุฑุง EF Core 3 ููโุชูุงูุฏ <strong>queryable</strong> ุจุณุงุฒุฏ ุงฺฏุฑ subquery ูุณุชููุงู ุจู <code>DbContext</code> ุงุฑุฌุงุน ุฏูุฏ. ุงู ูุญุฏูุฏุช ููฺฉู ุงุณุช ุฏุฑ ูุณุฎูโูุง ุจุนุฏ EF Core ุจุฑุทุฑู ุดูุฏ.</p>
</blockquote>
<hr>
<h3>๐น ูุฒุช ุงู ุณุจฺฉ</h3>
<ul>
<li>
<p>ุงู ููุน ฺฉูุฆุฑ <strong>ุจุฑุง interpreted queries ููุงุณุจ ุงุณุช</strong>.</p>
</li>
<li>
<p>ฺฉูุฆุฑ ุฎุงุฑุฌ ู subquery <strong>ุจู ุตูุฑุช ฺฉ ูุงุญุฏ ูพุฑุฏุงุฒุด ูโุดููุฏ</strong> ู ุงุฒ round-tripping ุงุถุงู ุฌููฺฏุฑ ูโฺฉููุฏ.</p>
</li>
<li>
<p>โ๏ธ ุฏุฑ ฺฉูุฆุฑโูุง ูุญู (Local queries) ุงู ุฑูุด <strong>ุบุฑ ุจููู</strong> ุงุณุชุ ฺูู ุชูุงู ุชุฑฺฉุจโูุง ุนูุงุตุฑ ุฎุงุฑุฌ ู ุฏุงุฎู ุจุงุฏ ูพูุงุด ุดููุฏ.</p>
</li>
<li>
<p>ุฌุงฺฏุฒู ุจููู ุจุฑุง Local queries: ุงุณุชูุงุฏู ุงุฒ <strong>Join</strong> ุง <strong>GroupJoin</strong>.</p>
</li>
</ul>
<hr>
<h3>๐น ูฺฏุงุดุช ุฏุงุฏูโูุง ุณูุณููโูุฑุงุชุจ</h3>
<ul>
<li>
<p>ุงู ฺฉูุฆุฑ <strong>ุงุดุงุก ุฏู ูุฌููุนู ูุชูุงูุช</strong> ุฑุง ููโุชุฑุงุฒ ูโฺฉูุฏ ู ูโุชูุงู ุขู ุฑุง ฺฉ ููุน <strong>join</strong> ุฏุฑ ูุธุฑ ฺฏุฑูุช.</p>
</li>
<li>
<p>ุชูุงูุช ุจุง join ุณูุช SQL:</p>
<ul>
<li>ุฎุฑูุฌ <strong>ุชุฎุช (flat)</strong> ูุณุชุ ุจูฺฉู ุฏุงุฏูโูุง ุฑุงุจุทูโุง ุจู <strong>ุฏุงุฏูโูุง ุณูุณููโูุฑุงุชุจ</strong> ูฺฏุงุดุช ูโุดููุฏ.</li>
</ul>
</li>
</ul>
<hr>
<h3>๐น ุงุณุชูุงุฏู ุงุฒ Navigation Property</h3>
<p>ูุซุงู ุณุงุฏูโุชุฑ ุจุง ุงุณุชูุงุฏู ุงุฒ Navigation Property <code>Purchases</code> ุฏุฑ <code>Customer</code>:</p>
<pre class="hljs"><code><span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> dbContext.Customers
<span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span>
{
    c.Name,
    Purchases = <span class="hljs-keyword">from</span> p <span class="hljs-keyword">in</span> c.Purchases  <span class="hljs-comment">// Purchases ููุน List&lt;Purchase&gt; ุงุณุช</span>
                <span class="hljs-keyword">where</span> p.Price &gt; <span class="hljs-number">1000</span>
                <span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> { p.Description, p.Price }
};
</code></pre>
<blockquote>
<p>ุฏุฑ EF Core 3ุ ููฺฏุงู ุงุณุชูุงุฏู ุงุฒ Navigation Property <strong>ูุงุฒ ุจู ToList ูุณุช</strong>.</p>
</blockquote>
<ul>
<li>ูุฑ ุฏู ฺฉูุฆุฑ ูุงููุฏ <strong>left outer join ุฏุฑ SQL</strong> ูุณุชูุฏ: ููู ูุดุชุฑโูุง ุฏุฑ enumeration ุจุฑูู ูุญุงุธ ูโุดููุฏุ ุญุช ุงฺฏุฑ ุฎุฑุฏ ูุฏุงุดุชู ุจุงุดูุฏ.</li>
</ul>
<hr>
<h3>๐น ุดุจูโุณุงุฒ Inner Join</h3>
<ul>
<li>ุจุฑุง ุญุฐู ูุดุชุฑโูุง ฺฉู ุฎุฑุฏ ุจุง ุงุฑุฒุด ุจุงูุง ูุฏุงุฑูุฏุ ูโุชูุงู ุดุฑุท ุงุถุงูู ฺฉุฑุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> dbContext.Customers
<span class="hljs-keyword">where</span> c.Purchases.Any(p =&gt; p.Price &gt; <span class="hljs-number">1000</span>)
<span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> {
    c.Name,
    Purchases = <span class="hljs-keyword">from</span> p <span class="hljs-keyword">in</span> c.Purchases
                <span class="hljs-keyword">where</span> p.Price &gt; <span class="hljs-number">1000</span>
                <span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> { p.Description, p.Price }
};
</code></pre>
<ul>
<li>
<p>โ๏ธ ุงู ุฑูุด ฺฉู ุชฺฉุฑุงุฑ ุงุณุช (Price &gt; 1000 ุฏู ุจุงุฑ ููุดุชู ูโุดูุฏ).</p>
</li>
<li>
<p>ุจุง ุงุณุชูุงุฏู ุงุฒ <code>let</code> ูโุชูุงู ุชฺฉุฑุงุฑ ุฑุง ุญุฐู ฺฉุฑุฏ:</p>
</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> dbContext.Customers
<span class="hljs-keyword">let</span> highValueP = <span class="hljs-keyword">from</span> p <span class="hljs-keyword">in</span> c.Purchases
                 <span class="hljs-keyword">where</span> p.Price &gt; <span class="hljs-number">1000</span>
                 <span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> { p.Description, p.Price }
<span class="hljs-keyword">where</span> highValueP.Any()
<span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> { c.Name, Purchases = highValueP };
</code></pre>
<ul>
<li>ุงู ุณุจฺฉ <strong>ุงูุนุทุงูโูพุฐุฑ</strong> ุงุณุชุ ุจุฑุง ูุซุงู ุจุง ุชุบุฑ <code>Any()</code> ุจู <code>Count()</code> ูโุชูุงู ููุท ูุดุชุฑโูุง ุจุง ุญุฏุงูู ุฏู ุฎุฑุฏ ุจุง ุงุฑุฒุด ุจุงูุง ุฑุง ฺฏุฑูุช:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">where</span> highValueP.Count() &gt;= <span class="hljs-number">2</span>
<span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> { c.Name, Purchases = highValueP };
</code></pre>
<hr>
<h3>๐น Projection ุจู Types ูุดุฎุต</h3>
<ul>
<li>ุชุง ุงูุฌุง ุงุฒ <strong>Anonymous Types</strong> ุงุณุชูุงุฏู ุดุฏ.</li>
<li>ูโุชูุงู <strong>ฺฉูุงุณโูุง ูุนููู (Named Classes)</strong> ูุฒ ุณุงุฎุช ู ุจุง object initializer ูพุฑ ฺฉุฑุฏ.</li>
<li>ุงู ฺฉูุงุณโูุง ูโุชูุงููุฏ <strong>ููุทู ุณูุงุฑุด</strong> ุฏุงุดุชู ุจุงุดูุฏ ู ุจู ูุชุฏูุง ู Assemblyูุง ููุชูู ุดููุฏ.</li>
<li>ููููู ูุนููู: <strong>Custom Business Entity / DTO</strong></li>
</ul>
<pre class="hljs"><code>IQueryable&lt;CustomerEntity&gt; query =
    <span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> dbContext.Customers
    <span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> CustomerEntity
    {
        Name = c.Name,
        Purchases = (
            <span class="hljs-keyword">from</span> p <span class="hljs-keyword">in</span> c.Purchases
            <span class="hljs-keyword">where</span> p.Price &gt; <span class="hljs-number">1000</span>
            <span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> PurchaseEntity
            {
                Description = p.Description,
                Value = p.Price
            }
        ).ToList()
    };

<span class="hljs-comment">// ุงุฌุฑุง ฺฉูุฆุฑ ู ุชุจุฏู ุฎุฑูุฌ ุจู List</span>
List&lt;CustomerEntity&gt; result = query.ToList();
</code></pre>
<blockquote>
<p>ฺฉูุงุณโูุง DTO ูุนูููุงู <strong>ูฺ ููุทู ุชุฌุงุฑ ูุฏุงุฑูุฏ</strong> ู ุตุฑูุงู ุจุฑุง ุงูุชูุงู ุฏุงุฏู ุจู ูุงูโูุง ุง ุณุณุชูโูุง ุงุณุชูุงุฏู ูโุดููุฏ.</p>
</blockquote>
<hr>
<h3>๐น ูฺฉุชู ฺฉูุฏ</h3>
<ul>
<li>ุชุง ุงูุฌุง <strong>ูุงุฒ ุจู Join ุง SelectMany ูุฏุงุดุชู</strong>.</li>
<li>ุฏูู: <strong>ุณุงุฎุชุงุฑ ุณูุณููโูุฑุงุชุจ ุฏุงุฏูโูุง ุญูุธ ุดุฏู</strong>ุ ุจุฑุฎูุงู SQL ฺฉู ูุนูููุงู ุฏุงุฏูโูุง ุฑุง flatten ูโฺฉูุฏ.</li>
</ul>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-9.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>๐ SelectMany ุฏุฑ LINQ</h3>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-10.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>๐ SelectMany ุฏุฑ LINQ โ ุฌุฒุฆุงุช ู ูุซุงูโูุง</h3>
<hr>
<h3>๐น Query Syntax</h3>
<pre class="hljs"><code><span class="hljs-keyword">from</span> identifier1 <span class="hljs-keyword">in</span> enumerable-expression1
<span class="hljs-keyword">from</span> identifier2 <span class="hljs-keyword">in</span> enumerable-expression2
...
</code></pre>
<ul>
<li>ุฏุฑ <strong>query syntax</strong>ุ ููุช ุงุฒ ฺฉ <code>from</code> ุงุถุงู ุงุณุชูุงุฏู ูโฺฉูุฏุ ุฏุฑ ูุงูุน <strong>SelectMany</strong> ูุฑุงุฎูุงู ูโุดูุฏ.</li>
</ul>
<hr>
<h3>๐น Enumerable Implementation</h3>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title">IEnumerable</span>&lt;<span class="hljs-title">TResult</span>&gt; <span class="hljs-title">SelectMany</span>&lt;<span class="hljs-title">TSource</span>,<span class="hljs-title">TResult</span>&gt;
    (<span class="hljs-params">IEnumerable&lt;TSource&gt; source,
     Func&lt;TSource,IEnumerable&lt;TResult&gt;&gt; selector</span>)</span>
{
    <span class="hljs-keyword">foreach</span> (TSource element <span class="hljs-keyword">in</span> source)
        <span class="hljs-keyword">foreach</span> (<span class="hljs-function">TResult subElement <span class="hljs-keyword">in</span> <span class="hljs-title">selector</span>(<span class="hljs-params">element</span>))
            <span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> subElement</span>;
}
</code></pre>
<ul>
<li>
<p><code>SelectMany</code> ููู <strong>subsequenceูุง ุฑุง ุจู ฺฉ ุฏูุจุงููโ ุชุฎุช (flat)</strong> ุชุฑฺฉุจ ูโฺฉูุฏ.</p>
</li>
<li>
<p><strong>ุชูุงูุช ุจุง Select:</strong></p>
<ul>
<li><code>Select</code>: ุจุฑุง ูุฑ ุนูุตุฑ ูุฑูุฏุ ุฏููุง <strong>ฺฉ ุนูุตุฑ ุฎุฑูุฌ</strong> ุชููุฏ ูโฺฉูุฏ.</li>
<li><code>SelectMany</code>: ุจุฑุง ูุฑ ุนูุตุฑ ูุฑูุฏุ <strong>ฐ ุชุง n ุนูุตุฑ ุฎุฑูุฌ</strong> ุชููุฏ ูโฺฉูุฏ.</li>
<li>n ุนูุงุตุฑ ุฎุฑูุฌ ุงุฒ ฺฉ <strong>subsequence ุง child sequence</strong> ฺฉู ุชูุณุท <strong>lambda expression</strong> ุตุงุฏุฑ ูโุดูุฏุ ุญุงุตู ูโุดููุฏ.</li>
</ul>
</li>
</ul>
<hr>
<h3>๐น ูุซุงู ุณุงุฏู: flatten ฺฉุฑุฏู ฺฉููุงุช ุงุฒ fullNames</h3>
<pre class="hljs"><code><span class="hljs-built_in">string</span>[] fullNames = { <span class="hljs-string">&quot;Anne Williams&quot;</span>, <span class="hljs-string">&quot;John Fred Smith&quot;</span>, <span class="hljs-string">&quot;Sue Green&quot;</span> };

IEnumerable&lt;<span class="hljs-built_in">string</span>&gt; query = fullNames.SelectMany(name =&gt; name.Split());
<span class="hljs-keyword">foreach</span> (<span class="hljs-built_in">string</span> name <span class="hljs-keyword">in</span> query)
    Console.Write(name + <span class="hljs-string">&quot;|&quot;</span>);  
<span class="hljs-comment">// ุฎุฑูุฌ: Anne|Williams|John|Fred|Smith|Sue|Green|</span>
</code></pre>
<ul>
<li>ุงฺฏุฑ ุจู ุฌุง <code>SelectMany</code> ุงุฒ <code>Select</code> ุงุณุชูุงุฏู ฺฉูุฏุ ุฎุฑูุฌ <strong>ุณูุณููโูุฑุงุชุจ (nested arrays)</strong> ุฎูุงูุฏ ุจูุฏ ู ูุงุฒ ุจู <code>foreach</code> ุชู ุฏุฑ ุชู ุฏุงุฑุฏ:</li>
</ul>
<pre class="hljs"><code>IEnumerable&lt;<span class="hljs-built_in">string</span>[]&gt; query = fullNames.Select(name =&gt; name.Split());
<span class="hljs-keyword">foreach</span> (<span class="hljs-built_in">string</span>[] stringArray <span class="hljs-keyword">in</span> query)
    <span class="hljs-keyword">foreach</span> (<span class="hljs-built_in">string</span> name <span class="hljs-keyword">in</span> stringArray)
        Console.Write(name + <span class="hljs-string">&quot;|&quot;</span>);
</code></pre>
<ul>
<li>ูุฒุช <code>SelectMany</code> ุงู ุงุณุช ฺฉู <strong>ฺฉ ุฏูุจุงููโ ุชุฎุช (flat)</strong> ุชููุฏ ูโฺฉูุฏ.</li>
</ul>
<hr>
<h3>๐น Query Syntax ู ฺูุฏ ูุชุบุฑู ุจูุฏู</h3>
<pre class="hljs"><code>IEnumerable&lt;<span class="hljs-built_in">string</span>&gt; query =
    <span class="hljs-keyword">from</span> fullName <span class="hljs-keyword">in</span> fullNames
    <span class="hljs-keyword">from</span> name <span class="hljs-keyword">in</span> fullName.Split()   <span class="hljs-comment">// ุชุฑุฌูู ุจู SelectMany</span>
    <span class="hljs-keyword">select</span> name;
</code></pre>
<ul>
<li>ูุชุบุฑ ุฌุฏุฏ <code>name</code> ูุนุฑู ูโุดูุฏุ ุงูุง ูุชุบุฑ ูุฏู <code>fullName</code> ููฺูุงู ุฏุฑ ุฏุณุชุฑุณ ุงุณุช.</li>
<li>ูโุชูุงูู ุงุฒ ูุฑ ุฏู ุฏุฑ projection ููุง ุงุณุชูุงุฏู ฺฉูู:</li>
</ul>
<pre class="hljs"><code>IEnumerable&lt;<span class="hljs-built_in">string</span>&gt; query =
    <span class="hljs-keyword">from</span> fullName <span class="hljs-keyword">in</span> fullNames
    <span class="hljs-keyword">from</span> name <span class="hljs-keyword">in</span> fullName.Split()
    <span class="hljs-keyword">select</span> name + <span class="hljs-string">&quot; came from &quot;</span> + fullName;
</code></pre>
<ul>
<li>ุฎุฑูุฌ ููููู:</li>
</ul>
<pre class="hljs"><code>Anne came from Anne Williams
Williams came from Anne Williams
John came from John Fred Smith
...
</code></pre>
<hr>
<h3>๐น ูุดฺฉู ุฏุฑ Fluent Syntax</h3>
<ul>
<li>ููุช <code>SelectMany</code> ุฑุง ูุณุชููุงู ุฏุฑ <strong>fluent syntax</strong> ุจููุณู ู ุจุฎูุงูู ูุฑ ุฏู ูุชุบุฑ outer ู inner ุฑุง ุฏุงุดุชู ุจุงุดูุ ูุดฺฉู ุงุฌุงุฏ ูโุดูุฏ.</li>
<li>ุฑุงูโุญู: <strong>ูุฑ child element ุฑุง ุฏุฑ ฺฉ anonymous type ุจุณุชูโุจูุฏ ฺฉูู</strong> ฺฉู outer element ุฑุง ูู ูฺฏู ุฏุงุฑุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">from</span> fullName <span class="hljs-keyword">in</span> fullNames
<span class="hljs-keyword">from</span> x <span class="hljs-keyword">in</span> fullName.Split().Select(name =&gt; <span class="hljs-keyword">new</span> { name, fullName })
<span class="hljs-keyword">orderby</span> x.fullName, x.name
<span class="hljs-keyword">select</span> x.name + <span class="hljs-string">&quot; came from &quot;</span> + x.fullName;
</code></pre>
<ul>
<li>ูุนุงุฏู Fluent Syntax:</li>
</ul>
<pre class="hljs"><code>IEnumerable&lt;<span class="hljs-built_in">string</span>&gt; query = fullNames
    .SelectMany(fName =&gt; fName.Split()
        .Select(name =&gt; <span class="hljs-keyword">new</span> { name, fName }))
    .OrderBy(x =&gt; x.fName)
    .ThenBy(x =&gt; x.name)
    .Select(x =&gt; x.name + <span class="hljs-string">&quot; came from &quot;</span> + x.fName);
</code></pre>
<ul>
<li>๐น ูฺฉุชู: ุงู ุชฺฉูฺฉ ูุดุงุจู <strong>resolve ฺฉุฑุฏู let clause</strong> ุฏุฑ query syntax ุงุณุช.</li>
</ul>
<h3>๐ค ูฺฉุฑ ฺฉุฑุฏู ุจู ุณุจฺฉ Query Syntax ุฏุฑ LINQ</h3>
<hr>
<h3>๐น ฺุฑุง query syntax ููุฏ ุงุณุชุ</h3>
<ul>
<li>ููุช ุจู <strong>ฺูุฏ ูุชุบุฑ ุฏุงููู (range variables)</strong> ูุงุฒ ุฏุงุฑุฏุ query syntax ฺฉูฺฉ ูโฺฉูุฏ ุชุง ูุณุชูู ุฏุฑ ููุงู ฺุงุฑฺูุจ ูฺฉุฑ ฺฉูุฏ.</li>
<li>ุฏู ุงูฺฏู ุงุตู ุจุฑุง ุงุณุชูุงุฏู ุงุฒ <strong>generatorูุง ุงุถุงู</strong> ูุฌูุฏ ุฏุงุฑุฏ:</li>
</ul>
<hr>
<h3>1๏ธโฃ ฺฏุณุชุฑุด ู flatten ฺฉุฑุฏู subsequenceูุง</h3>
<ul>
<li>ุจุง ูุฑุงุฎูุงู ฺฉ <strong>property ุง method</strong> ุฑู ฺฉ ูุชุบุฑ ุฏุงููู ููุฌูุฏ ุฏุฑ generator ุงุถุงูุ ูโุชูุงู subsequenceูุง ุฑุง ฺฏุณุชุฑุด ุฏุงุฏ.</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">from</span> fullName <span class="hljs-keyword">in</span> fullNames
<span class="hljs-keyword">from</span> name <span class="hljs-keyword">in</span> fullName.Split()
</code></pre>
<ul>
<li>ูุซุงู ูุดุงุจู ุฏุฑ EF Core:</li>
</ul>
<pre class="hljs"><code>IEnumerable&lt;<span class="hljs-built_in">string</span>&gt; query = 
    <span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> dbContext.Customers
    <span class="hljs-keyword">from</span> p <span class="hljs-keyword">in</span> c.Purchases
    <span class="hljs-keyword">select</span> c.Name + <span class="hljs-string">&quot; bought a &quot;</span> + p.Description;
</code></pre>
<ul>
<li>ุฎุฑูุฌ ููููู:</li>
</ul>
<pre class="hljs"><code>Tom bought a Bike
Tom bought a Holiday
Dick bought a Phone
Harry bought a Car
...
</code></pre>
<ul>
<li>๐น ูุฑ ูุดุชุฑ ุจู ฺฉ <strong>subsequence ุงุฒ ุฎุฑุฏูุง</strong> ุชุจุฏู ุดุฏู ุงุณุช.</li>
</ul>
<hr>
<h3>2๏ธโฃ ุชููุฏ Cartesian Product ุง Cross Join</h3>
<ul>
<li>ูุฑ ุนูุตุฑ ุงุฒ ฺฉ ุฏูุจุงูู ุจุง ูุฑ ุนูุตุฑ ุฏูุจุงูู ุฏฺฏุฑ ุชุฑฺฉุจ ูโุดูุฏ.</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">int</span>[] numbers = { <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span> };
<span class="hljs-built_in">string</span>[] letters = { <span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;b&quot;</span> };

IEnumerable&lt;<span class="hljs-built_in">string</span>&gt; query = 
    <span class="hljs-keyword">from</span> n <span class="hljs-keyword">in</span> numbers
    <span class="hljs-keyword">from</span> l <span class="hljs-keyword">in</span> letters
    <span class="hljs-keyword">select</span> n.ToString() + l;
<span class="hljs-comment">// ุฎุฑูุฌ: { &quot;1a&quot;, &quot;1b&quot;, &quot;2a&quot;, &quot;2b&quot;, &quot;3a&quot;, &quot;3b&quot; }</span>
</code></pre>
<ul>
<li>ุงู ุงูฺฏู ูพุงูโุง ุจุฑุง <strong>SelectMany-style joins</strong> ุงุณุช.</li>
</ul>
<hr>
<h3>๐น Join ฺฉุฑุฏู ุจุง SelectMany</h3>
<ul>
<li>ูโุชูุงู ุจุง <strong>ุงุถุงูู ฺฉุฑุฏู ุดุฑุท ููุชุฑ</strong> ุฑู ูุชุฌู cross productุ join ุณุงุฎุช:</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">string</span>[] players = { <span class="hljs-string">&quot;Tom&quot;</span>, <span class="hljs-string">&quot;Jay&quot;</span>, <span class="hljs-string">&quot;Mary&quot;</span> };

IEnumerable&lt;<span class="hljs-built_in">string</span>&gt; query = 
    <span class="hljs-keyword">from</span> name1 <span class="hljs-keyword">in</span> players
    <span class="hljs-keyword">from</span> name2 <span class="hljs-keyword">in</span> players
    <span class="hljs-keyword">where</span> name1.CompareTo(name2) &lt; <span class="hljs-number">0</span>
    <span class="hljs-keyword">orderby</span> name1, name2
    <span class="hljs-keyword">select</span> name1 + <span class="hljs-string">&quot; vs &quot;</span> + name2;

<span class="hljs-comment">// ุฎุฑูุฌ: { &quot;Jay vs Mary&quot;, &quot;Jay vs Tom&quot;, &quot;Mary vs Tom&quot; }</span>
</code></pre>
<ul>
<li>๐น ุงู ฺฉ <strong>non-equi join</strong> ุงุณุช ฺูู ุดุฑุท join ุงุฒ ููุงุณู ูุงุจุฑุงุจุฑ ุงุณุชูุงุฏู ูโฺฉูุฏ.</li>
</ul>
<hr>
<h3>๐น SelectMany ุฏุฑ EF Core</h3>
<ul>
<li>ูโุชูุงูุฏ <strong>cross joins, non-equi joins, inner joins, left outer joins</strong> ุงูุฌุงู ุฏูุฏ.</li>
<li>ูโุชูุงู ุงุฒ ุขู ุจุง <strong>associations ุงุฒ ูุจู ุชุนุฑูโุดุฏู ุง ุฑูุงุจุท ad hoc</strong> ุงุณุชูุงุฏู ฺฉุฑุฏ.</li>
<li>ุชูุงูุช ุจุง Select: <strong>SelectMany ุฏูุจุงููโุง ุชุฎุช (flat) ุจุฑูโฺฏุฑุฏุงูุฏุ ูู ุณูุณููโูุฑุงุชุจ</strong>.</li>
</ul>
<h4>ูุซุงู Cross Join</h4>
<pre class="hljs"><code><span class="hljs-keyword">var</span> query = 
    <span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> dbContext.Customers
    <span class="hljs-keyword">from</span> p <span class="hljs-keyword">in</span> dbContext.Purchases
    <span class="hljs-keyword">select</span> c.Name + <span class="hljs-string">&quot; might have bought a &quot;</span> + p.Description;
</code></pre>
<h4>ูุซุงู Equi-Join (SQL-style)</h4>
<pre class="hljs"><code><span class="hljs-keyword">var</span> query = 
    <span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> dbContext.Customers
    <span class="hljs-keyword">from</span> p <span class="hljs-keyword">in</span> dbContext.Purchases
    <span class="hljs-keyword">where</span> c.ID == p.CustomerID
    <span class="hljs-keyword">select</span> c.Name + <span class="hljs-string">&quot; bought a &quot;</span> + p.Description;
</code></pre>
<ul>
<li>๐น ุงู ุชุฑุฌูู ุฎูุจ ุจู SQL ุฏุงุฑุฏ ู ุงุฌุฑุง outer joins ูุฒ ุจุง ุชุบุฑุงุช ฺฉูฺฺฉ ููฺฉู ุงุณุช.</li>
</ul>
<hr>
<h3>๐น ุงุณุชูุงุฏู ุงุฒ Collection Navigation Properties</h3>
<ul>
<li>ูโุชูุงู ุจู ุฌุง ููุชุฑ ุฑู cross productุ <strong>subcollectionูุง ุฑุง ฺฏุณุชุฑุด ุฏุงุฏ</strong>:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> dbContext.Customers
<span class="hljs-keyword">from</span> p <span class="hljs-keyword">in</span> c.Purchases
<span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> { c.Name, p.Description };
</code></pre>
<ul>
<li>ูุฒุช: <strong>ูุงุฒ ุจู ุดุฑุท join ูุณุช</strong> ู ุงุฒ ููุชุฑ ุฑู cross product ุฎูุงุต ูโุดูู.</li>
</ul>
<hr>
<h3>๐น ุงุถุงูู ฺฉุฑุฏู ููุชุฑูุง</h3>
<ul>
<li>ูุซุงู: ูุดุชุฑุงู ฺฉู ูุงูุดุงู ุจุง &quot;T&quot; ุดุฑูุน ูโุดูุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> dbContext.Customers
<span class="hljs-keyword">where</span> c.Name.StartsWith(<span class="hljs-string">&quot;T&quot;</span>)
<span class="hljs-keyword">from</span> p <span class="hljs-keyword">in</span> c.Purchases
<span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> { c.Name, p.Description };
</code></pre>
<ul>
<li>ุฏุฑ EF Coreุ ุฌุงุจุฌุง where clause ฺฉ ุฎุท ูพุงูโุชุฑ ูู ฺฉุงุฑ ูโฺฉูุฏ.</li>
<li>ุฏุฑ local queriesุ ุจูุชุฑ ุงุณุช <strong>ุงุจุชุฏุง ููุชุฑ ฺฉูุฏ ู ุจุนุฏ join ฺฉูุฏ</strong>.</li>
</ul>
<hr>
<h3>๐น ุงุถุงูู ฺฉุฑุฏู ุฌุฏุงูู ูุฑุฒูุฏ</h3>
<ul>
<li>ูุซุงู: ูุฑ ุฎุฑุฏ ุฏุงุฑุง ฺูุฏ PurchaseItem ุงุณุช:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> dbContext.Customers
<span class="hljs-keyword">from</span> p <span class="hljs-keyword">in</span> c.Purchases
<span class="hljs-keyword">from</span> pi <span class="hljs-keyword">in</span> p.PurchaseItems
<span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> { c.Name, p.Description, pi.Detail };
</code></pre>
<ul>
<li>ูุฑ <code>from</code> ุฌุฏุฏ ฺฉ <strong>child table</strong> ุงุถุงูู ูโฺฉูุฏ.</li>
</ul>
<hr>
<h3>๐น ุงุณุชูุงุฏู ุงุฒ Navigation Property ูุงูุฏ</h3>
<ul>
<li>ุจุฑุง ุฏุณุชุฑุณ ุจู ุฏุงุฏูโูุง ูุงูุฏุ ูุงุฒ ุจู from ุฌุฏุฏ ูุณุช:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> dbContext.Customers
<span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> { Name = c.Name, SalesPerson = c.SalesPerson.Name };
</code></pre>
<ul>
<li>๐น ุงูุฌุง SelectMany ูุงุฒู ูุณุช ฺูู <strong>subcollection ุจุฑุง flatten ฺฉุฑุฏู ูุฌูุฏ ูุฏุงุฑุฏ</strong>.</li>
</ul>
<h3>โ๏ธ Outer Joins ุจุง SelectMany ุฏุฑ LINQ ู EF Core</h3>
<hr>
<h3>๐น ูุซุงู ุงููู ุจุง Subquery</h3>
<ul>
<li>ฺฉ <strong>Select subquery</strong> ูุดุงุจู <strong>left outer join</strong> ุฑูุชุงุฑ ูโฺฉูุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> dbContext.Customers
<span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> {
    c.Name,
    Purchases = <span class="hljs-keyword">from</span> p <span class="hljs-keyword">in</span> c.Purchases
                <span class="hljs-keyword">where</span> p.Price &gt; <span class="hljs-number">1000</span>
                <span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> { p.Description, p.Price }
};
</code></pre>
<ul>
<li>๐น ุฏุฑ ุงูุฌุง <strong>ูุฑ ูุดุชุฑ</strong> ุฏุฑ ุฎุฑูุฌ ุธุงูุฑ ูโุดูุฏุ ุญุช ุงฺฏุฑ ุฎุฑุฏ ูุฏุงุดุชู ุจุงุดุฏ.</li>
<li>ูุชุฌู ฺฉ <strong>hierarchical result set</strong> ุงุณุช.</li>
</ul>
<hr>
<h3>๐น ูุดฺฉู ููุช SelectMany ุงุณุชูุงุฏู ุดูุฏ</h3>
<ul>
<li>ุงฺฏุฑ ุจุฎูุงูู ุฎุฑูุฌ <strong>flat</strong> ุฏุงุดุชู ุจุงุดู:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> dbContext.Customers
<span class="hljs-keyword">from</span> p <span class="hljs-keyword">in</span> c.Purchases
<span class="hljs-keyword">where</span> p.Price &gt; <span class="hljs-number">1000</span>
<span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> { c.Name, p.Description, p.Price };
</code></pre>
<ul>
<li>๐น ุงูุฌุง join <strong>ุจู inner join ุชุจุฏู ูโุดูุฏ</strong>:<br>
ูุดุชุฑุงู ููุท ุฒูุงู ุธุงูุฑ ูโุดููุฏ ฺฉู <strong>ฺฉ ุง ฺูุฏ ุฎุฑุฏ ุจุง ุงุฑุฒุด ุจุงูุง</strong> ุฏุงุดุชู ุจุงุดูุฏ.</li>
</ul>
<hr>
<h3>๐น ุฑุงู ุญู ุจุฑุง Left Outer Join ุชุฎุช</h3>
<ul>
<li>ุงุฒ <code>DefaultIfEmpty()</code> ุฑู <strong>inner sequence</strong> ุงุณุชูุงุฏู ูโฺฉูู.</li>
<li>ุงู ูุชุฏ ุงฺฏุฑ sequence ุฎุงู ุจุงุดุฏุ ฺฉ ุนูุตุฑ null ุชููุฏ ูโฺฉูุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> dbContext.Customers
<span class="hljs-keyword">from</span> p <span class="hljs-keyword">in</span> c.Purchases.DefaultIfEmpty()
<span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> { c.Name, p.Description, Price = (<span class="hljs-built_in">decimal</span>?)p.Price };
</code></pre>
<ul>
<li>โ EF Core ููู ูุดุชุฑุงู ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏุ ุญุช ุงฺฏุฑ ุฎุฑุฏ ูุฏุงุดุชู ุจุงุดูุฏ.</li>
<li>โ๏ธ ุฏุฑ local queryุ ุงฺฏุฑ p null ุจุงุดุฏุ ุฏุณุชุฑุณ ุจู <code>p.Description</code> ุง <code>p.Price</code> ุจุงุนุซ NullReferenceException ูโุดูุฏ.</li>
</ul>
<hr>
<h3>๐น ูุณุฎู ููุงูู (Robust)</h3>
<pre class="hljs"><code><span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> dbContext.Customers
<span class="hljs-keyword">from</span> p <span class="hljs-keyword">in</span> c.Purchases.DefaultIfEmpty()
<span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> {
    c.Name,
    Descript = p == <span class="hljs-literal">null</span> ? <span class="hljs-literal">null</span> : p.Description,
    Price = p == <span class="hljs-literal">null</span> ? (<span class="hljs-built_in">decimal</span>?) <span class="hljs-literal">null</span> : p.Price
};
</code></pre>
<ul>
<li>ุงู ูุณุฎู ุฏุฑ ูุฑ ุฏู ุณูุงุฑู (EF Core ู local query) ุงูู ุงุณุช.</li>
</ul>
<hr>
<h3>๐น ุงุนูุงู ููุชุฑ ููุช</h3>
<ul>
<li>ููโุชูุงูู <code>where</code> ุฑุง ุจุนุฏ ุงุฒ DefaultIfEmpty ูุฑุงุฑ ุฏููุ ฺูู ููุชุฑ ุจุนุฏ ุงุฒ ุงุถุงูู ฺฉุฑุฏู null ุงุฌุฑุง ูโุดูุฏ.</li>
<li>ุฑุงู ุญู: ููุชุฑ ุฑุง ูุจู ุงุฒ DefaultIfEmpty ุจุง ฺฉ subquery ุงุนูุงู ฺฉูู:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> dbContext.Customers
<span class="hljs-keyword">from</span> p <span class="hljs-keyword">in</span> c.Purchases.Where(p =&gt; p.Price &gt; <span class="hljs-number">1000</span>).DefaultIfEmpty()
<span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> {
    c.Name,
    Descript = p == <span class="hljs-literal">null</span> ? <span class="hljs-literal">null</span> : p.Description,
    Price = p == <span class="hljs-literal">null</span> ? (<span class="hljs-built_in">decimal</span>?) <span class="hljs-literal">null</span> : p.Price
};
</code></pre>
<ul>
<li>โ EF Core ุงู ุฑุง ุจู <strong>left outer join</strong> ุชุฑุฌูู ูโฺฉูุฏ.</li>
<li>ุงู ฺฉ <strong>ุงูฺฏู ููุซุฑ ุจุฑุง ููุดุชู ฺูู queryูุง</strong> ุงุณุช.</li>
</ul>
<p>ุงฺฏุฑ ุจู ููุดุชู <strong>outer join</strong> ุฏุฑ SQL ุนุงุฏุช ุฏุงุฑุ ููฺฉูู ูุณูุณู ุจุด ฺฉู ฺฏุฒููโ ุณุงุฏูโุชุฑ ุนู <strong>Select subquery</strong> ุฑู ูุงุฏุฏู ุจฺฏุฑ ู ุจู ุณูุช ุฑูุด ุชุฎุช ู ูพฺุฏูโ SQL-centric ุจุฑ ฺฉู ุขุดูุงุชุฑ ุจู ูุธุฑ ูโุฑุณู.</p>
<p>โ ูุงูุนุช ุงูู ฺฉู <strong>hierarchical result set</strong> ฺฉู ุงุฒ ฺฉ Select subquery ุจู ุฏุณุช ูุงุฏุ ุงุบูุจ ุจุฑุง queryูุง ุณุจฺฉ outer join ุจูุชุฑูุ ฺูู ูุงุฒ ุจู ูุฏุฑุช nullูุง ุงุถุงู ูุฏุงุฑ ู ฺฉุงุฑ ุชูุฒุชุฑ ุงูุฌุงู ูโุดู.</p>
<h3>Joining</h3>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-11.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>โจ ูุญู Query ุฏุฑ LINQ</h3>
<pre class="hljs"><code>from outer-var in outer-enumerable
join inner-var in inner-enumerable on outer-key-expr equals inner-key-expr
[ into identifier ]
</code></pre>
<h3>๐ ูุฑูุฑ ฺฉู (Overview)</h3>
<p>๐น <strong>Join</strong> ู <strong>GroupJoin</strong> ุฏู ุชูุงู ูุฑูุฏ (input sequences) ุฑุง ุจู ฺฉ ุชูุงู ุฎุฑูุฌ (output sequence) ุชุฑฺฉุจ ูโฺฉููุฏ.</p>
<ul>
<li><strong>Join</strong> ุฎุฑูุฌ ูุณุทุญ (flat output) ุชููุฏ ูโฺฉูุฏ.</li>
<li><strong>GroupJoin</strong> ุฎุฑูุฌ ุณูุณููโูุฑุงุชุจ (hierarchical output) ุชููุฏ ูโฺฉูุฏ.</li>
</ul>
<p>โจ <strong>Join</strong> ู <strong>GroupJoin</strong> ฺฉ ุฑุงูุจุฑุฏ ุฌุงฺฏุฒู ุจุฑุง <strong>Select</strong> ู <strong>SelectMany</strong> ุงุฑุงุฆู ูโุฏููุฏ.</p>
<p>โ <strong>ูุฒุช Join ู GroupJoin</strong> ุงู ุงุณุช ฺฉู ุขูโูุง ุจูโุดฺฉู ฺฉุงุฑุขูุฏ ุฑู ูุฌููุนูโูุง ูุญู (local in-memory collections) ุงุฌุฑุง ูโุดููุฏุ ฺูู ุงุจุชุฏุง ุชูุงู ุฏุฑูู (inner sequence) ุฑุง ุฏุงุฎู ฺฉ lookup ฺฉูุฏุฏุงุฑ (keyed lookup) ุจุงุฑฺฏุฐุงุฑ ูโฺฉููุฏ ู ุจู ุงู ุชุฑุชุจ ุงุฒ ูุงุฒ ุจู ูพูุงุด (enumerate) ูฺฉุฑุฑ ุฑู ูุฑ ุนูุตุฑ ุฏุงุฎู ุฌููฺฏุฑ ูโฺฉููุฏ.</p>
<p>โ๏ธ <strong>ุนุจ ุขูโูุง</strong> ุงู ุงุณุช ฺฉู ุชููุง ูุนุงุฏู <strong>inner join</strong> ู <strong>left outer join</strong> ุฑุง ุงุฑุงุฆู ูโุฏููุฏุ ุจุฑุง <strong>cross join</strong> ู <strong>non-equi join</strong> ููฺูุงู ุจุงุฏ ุงุฒ <strong>Select/SelectMany</strong> ุงุณุชูุงุฏู ฺฉุฑุฏ.</p>
<p>๐ ุฏุฑ ฺฉูุฆุฑโูุง <strong>EF Core</strong>ุ ุงุณุชูุงุฏู ุงุฒ <strong>Join</strong> ู <strong>GroupJoin</strong> ูุฒุช ุฎุงุต ูุณุจุช ุจู <strong>Select</strong> ู <strong>SelectMany</strong> ูุฏุงุฑุฏ.</p>
<p>๐ ุฌุฏูู <strong>น-ฑ</strong> ุชูุงูุชโูุง ูุงู ูุฑ ฺฉ ุงุฒ ุฑุงูุจุฑุฏูุง join ุฑุง ุฎูุงุตู ูโฺฉูุฏ.</p>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-12.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>๐ Join</h3>
<p>ุงูพุฑุงุชูุฑ <strong>Join</strong> ฺฉ <strong>inner join</strong> ุงูุฌุงู ูโุฏูุฏ ู ฺฉ ุชูุงู ุฎุฑูุฌ ูุณุทุญ (flat output sequence) ุชููุฏ ูโฺฉูุฏ.</p>
<p>๐น ูุซุงู ุฒุฑุ ูู ูุดุชุฑุงู (customers) ุฑุง ููุฑุงู ุจุง ุฎุฑุฏูุงุดุงู (purchases) ููุฑุณุช ูโฺฉูุฏุ ุจุฏูู ุงูฺฉู ุงุฒ ูฺฺฏ ูุงูุจุฑ (navigation property) ุงุณุชูุงุฏู ุดูุฏ:</p>
<pre class="hljs"><code>IQueryable&lt;<span class="hljs-built_in">string</span>&gt; query =
  <span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> dbContext.Customers
  <span class="hljs-keyword">join</span> p <span class="hljs-keyword">in</span> dbContext.Purchases <span class="hljs-keyword">on</span> c.ID <span class="hljs-keyword">equals</span> p.CustomerID
  <span class="hljs-keyword">select</span> c.Name + <span class="hljs-string">&quot; bought a &quot;</span> + p.Description;
</code></pre>
<p>๐ ูุชุงุฌ ุฏููุงู ููุงู ฺุฒ ุงุณุช ฺฉู ุจุง ฺฉ ฺฉูุฆุฑ ุจู ุณุจฺฉ <strong>SelectMany</strong> ุจู ุฏุณุช ูโุขุฏ:</p>
<pre class="hljs"><code>Tom bought a Bike
Tom bought a Holiday
Dick bought a Phone
Harry bought a Car
</code></pre>
<hr>
<h3>โก ูุฒุช Join ุฏุฑ ุจุฑุงุจุฑ SelectMany</h3>
<p>ุจุฑุง ุฏุฏู ูุฒุช <strong>Join</strong> ุฏุฑ ููุงุณู ุจุง <strong>SelectMany</strong>ุ ุจุงุฏ ฺฉูุฆุฑ ุฑุง ุจู ุญุงูุช ูุญู (local query) ุชุจุฏู ฺฉูู.</p>
<p>ุงููุ ุชูุงู ูุดุชุฑุงู ู ุฎุฑุฏูุง ุฑุง ุฏุฑ ุขุฑุงูโูุง ฺฉูพ ูโฺฉูู ู ุณูพุณ ุฑู ุขุฑุงูโูุง ฺฉูุฆุฑ ูโุฒูู:</p>
<pre class="hljs"><code>Customer[] customers = dbContext.Customers.ToArray();
Purchase[] purchases = dbContext.Purchases.ToArray();

<span class="hljs-keyword">var</span> slowQuery = <span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> customers
                <span class="hljs-keyword">from</span> p <span class="hljs-keyword">in</span> purchases
                <span class="hljs-keyword">where</span> c.ID == p.CustomerID
                <span class="hljs-keyword">select</span> c.Name + <span class="hljs-string">&quot; bought a &quot;</span> + p.Description;

<span class="hljs-keyword">var</span> fastQuery = <span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> customers
                <span class="hljs-keyword">join</span> p <span class="hljs-keyword">in</span> purchases <span class="hljs-keyword">on</span> c.ID <span class="hljs-keyword">equals</span> p.CustomerID
                <span class="hljs-keyword">select</span> c.Name + <span class="hljs-string">&quot; bought a &quot;</span> + p.Description;
</code></pre>
<p>ูุฑ ุฏู ฺฉูุฆุฑ ูุชุฌู ฺฉุณุงู ุจุฑูโฺฏุฑุฏุงููุฏุ ุงูุง ฺฉูุฆุฑ ุจุง <strong>Join</strong> ุจูโูุฑุงุชุจ ุณุฑุนโุชุฑ ุงุณุช. ุฏููุด ุงู ุงุณุช ฺฉู ูพุงุฏูโุณุงุฒ ุฏุฑ <strong>Enumerable</strong>ุ ูุฌููุนู ุฏุงุฎู (purchases) ุฑุง ุงุจุชุฏุง ุจูโุตูุฑุช ฺฉ <strong>keyed lookup</strong> ุจุงุฑฺฏุฐุงุฑ ูโฺฉูุฏ.</p>
<hr>
<h3>๐ ูุญู ฺฉู Join</h3>
<p>ูุญู ููุดุชู <strong>join</strong> ุจูโุทูุฑ ฺฉู ุจู ุดฺฉู ุฒุฑ ุงุณุช:</p>
<pre class="hljs"><code>join inner-var in inner-sequence on outer-key-expr equals inner-key-expr
</code></pre>
<p>ุงูพุฑุงุชูุฑูุง <strong>Join</strong> ุฏุฑ LINQ ุจู ุชูุงู ุจุฑูู (outer sequence) ู ุชูุงู ุฏุฑูู (inner sequence) ุชูุงุฒ ูุงุฆู ูโุดููุฏ.</p>
<ul>
<li>โ <strong>outer sequence</strong> โ ููุงู ุชูุงู ูุฑูุฏ ุงุณุช (ุฏุฑ ุงู ูุซุงูุ customers).</li>
<li>โ <strong>inner sequence</strong> โ ูุฌููุนู ุฌุฏุฏ ุงุณุช ฺฉู ูุนุฑู ูโฺฉูุฏ (ุฏุฑ ุงู ูุซุงูุ purchases).</li>
</ul>
<p>๐ <strong>Join</strong> ููุท <strong>inner join</strong> ุงูุฌุงู ูโุฏูุฏุ ุนู ูุดุชุฑุงู ฺฉู ุฎุฑุฏ ูุฏุงุฑูุฏ ุงุฒ ุฎุฑูุฌ ุญุฐู ูโุดููุฏ.<br>
ุฏุฑ <strong>inner join</strong> ูโุชูุงูุฏ ุชูุงู ุจุฑูู ู ุฏุฑูู ุฑุง ุจุง ูู ุฌุงุจูโุฌุง ฺฉูุฏ ู ููฺูุงู ูุชุฌู ฺฉุณุงู ุจฺฏุฑุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">from</span> p <span class="hljs-keyword">in</span> purchases                                <span class="hljs-comment">// p ุญุงูุง outer ุงุณุช</span>
<span class="hljs-keyword">join</span> c <span class="hljs-keyword">in</span> customers <span class="hljs-keyword">on</span> p.CustomerID <span class="hljs-keyword">equals</span> c.ID    <span class="hljs-comment">// c ุญุงูุง inner ุงุณุช</span>
...
</code></pre>
<hr>
<h3>๐งฉ ฺูุฏู Join ุฏุฑ ฺฉ ฺฉูุฆุฑ</h3>
<p>ุดูุง ูโุชูุงูุฏ ฺูุฏู ุนุจุงุฑุช <strong>join</strong> ุฏุฑ ฺฉ ฺฉูุฆุฑ ุงุถุงูู ฺฉูุฏ.<br>
ูุซูุงู ุงฺฏุฑ ูุฑ ุฎุฑุฏ (purchase) ฺฉ ุง ฺูุฏ ุขุชู ุฎุฑุฏ (purchase items) ุฏุงุดุชู ุจุงุดุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> customers
<span class="hljs-keyword">join</span> p <span class="hljs-keyword">in</span> purchases <span class="hljs-keyword">on</span> c.ID <span class="hljs-keyword">equals</span> p.CustomerID           <span class="hljs-comment">// first join</span>
<span class="hljs-keyword">join</span> pi <span class="hljs-keyword">in</span> purchaseItems <span class="hljs-keyword">on</span> p.ID <span class="hljs-keyword">equals</span> pi.PurchaseID     <span class="hljs-comment">// second join</span>
...
</code></pre>
<p>๐ ุฏุฑ ุงูุฌุงุ <code>purchases</code> ุฏุฑ ุงููู join ุจูโุนููุงู <strong>inner sequence</strong> ุนูู ูโฺฉูุฏ ู ุฏุฑ ุฏููู join ุจูโุนููุงู <strong>outer sequence</strong>.</p>
<p>ูุนุงุฏู ูุงฺฉุงุฑุขูุฏ ููู ฺฉุงุฑ ุจุง <strong>foreach</strong> ุจู ุดฺฉู ุฒุฑ ุงุณุช:</p>
<pre class="hljs"><code><span class="hljs-keyword">foreach</span> (Customer c <span class="hljs-keyword">in</span> customers)
  <span class="hljs-keyword">foreach</span> (Purchase p <span class="hljs-keyword">in</span> purchases)
    <span class="hljs-keyword">if</span> (c.ID == p.CustomerID)
      <span class="hljs-keyword">foreach</span> (PurchaseItem pi <span class="hljs-keyword">in</span> purchaseItems)
        <span class="hljs-keyword">if</span> (p.ID == pi.PurchaseID)
          Console.WriteLine (c.Name + <span class="hljs-string">&quot;,&quot;</span> + p.Price + <span class="hljs-string">&quot;,&quot;</span> + pi.Detail);
</code></pre>
<p>ุฏุฑ ูุญู Queryุ ูุชุบุฑูุง joinูุง ูุจู ููฺูุงู ุฏุฑ ุฏุณุชุฑุณ ูุณุชูุฏโุฏููุงู ูุซู ฺฉุงุฑ ฺฉู ุฏุฑ ฺฉูุฆุฑโูุง ุจู ุณุจฺฉ <strong>SelectMany</strong> ุงุชูุงู ูโุงูุชุฏ.<br>
ููฺูู ูโุชูุงูุฏ ุจู joinูุงุ ุงุฒ <strong>where</strong> ู <strong>let</strong> ุงุณุชูุงุฏู ฺฉูุฏ.</p>
<hr>
<h3>๐ Join ุจุง ฺูุฏ ฺฉูุฏ</h3>
<p>ูโุชูุงูุฏ ุฑู ฺูุฏ ฺฉูุฏ ุจูโุทูุฑ ููุฒูุงู join ุงูุฌุงู ุฏูุฏ. ุจุฑุง ุงู ฺฉุงุฑ ุงุฒ <strong>anonymous types</strong> ุงุณุชูุงุฏู ูโุดูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">from</span> x <span class="hljs-keyword">in</span> sequenceX
<span class="hljs-keyword">join</span> y <span class="hljs-keyword">in</span> sequenceY <span class="hljs-keyword">on</span> <span class="hljs-keyword">new</span> { K1 = x.Prop1, K2 = x.Prop2 }
                   <span class="hljs-keyword">equals</span> <span class="hljs-keyword">new</span> { K1 = y.Prop3, K2 = y.Prop4 }
...
</code></pre>
<p>ุจุฑุง ุงูฺฉู ุงู ฺฉุงุฑ ุฏุฑุณุช ุงูุฌุงู ุดูุฏุ ุฏู <strong>anonymous type</strong> ุจุงุฏ ุฏููุงู ฺฉ ุณุงุฎุชุงุฑ (structure) ุฏุงุดุชู ุจุงุดูุฏ.<br>
ฺฉุงููพุงูุฑ ูุฑ ุฏู ุฑุง ุจุง ฺฉ ููุน ุฏุงุฎู ฺฉุณุงู ูพุงุฏูโุณุงุฒ ูโฺฉูุฏุ ุจูุงุจุฑุงู ฺฉูุฏูุง join ุจุง ูู ุณุงุฒฺฏุงุฑ ูโุดููุฏ.</p>
<h3>๐ Join ุฏุฑ <strong>Fluent Syntax</strong></h3>
<p>๐น ฺฉูุฆุฑ ุฒุฑ ุฏุฑ ูุญู Query:</p>
<pre class="hljs"><code><span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> customers
<span class="hljs-keyword">join</span> p <span class="hljs-keyword">in</span> purchases <span class="hljs-keyword">on</span> c.ID <span class="hljs-keyword">equals</span> p.CustomerID
<span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> { c.Name, p.Description, p.Price };
</code></pre>
<p>ุจู ุดฺฉู <strong>Fluent Syntax</strong> ุงูโุทูุฑ ููุดุชู ูโุดูุฏ:</p>
<pre class="hljs"><code>customers.Join(                <span class="hljs-comment">// outer collection</span>
    purchases,                 <span class="hljs-comment">// inner collection</span>
    c =&gt; c.ID,                 <span class="hljs-comment">// outer key selector</span>
    p =&gt; p.CustomerID,         <span class="hljs-comment">// inner key selector</span>
    (c, p) =&gt; <span class="hljs-keyword">new</span>              <span class="hljs-comment">// result selector</span>
        { c.Name, p.Description, p.Price }
);
</code></pre>
<p>๐ ุนุจุงุฑุช <strong>result selector</strong> ุฏุฑ ุงูุชูุงุ ูุฑ ุนูุตุฑ ุฎุฑูุฌ ุฑุง ูโุณุงุฒุฏ.</p>
<hr>
<h3>๐ ุงูุฒูุฏู ุนุจุงุฑุงุช ุฏฺฏุฑ (orderby ู โฆ)</h3>
<p>ุงฺฏุฑ ูุจู ุงุฒ ุจุฎุด <strong>select</strong> ุนุจุงุฑุงุช ูุซู <strong>orderby</strong> ุฏุงุดุชู ุจุงุดู:</p>
<pre class="hljs"><code><span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> customers
<span class="hljs-keyword">join</span> p <span class="hljs-keyword">in</span> purchases <span class="hljs-keyword">on</span> c.ID <span class="hljs-keyword">equals</span> p.CustomerID
<span class="hljs-keyword">orderby</span> p.Price
<span class="hljs-keyword">select</span> c.Name + <span class="hljs-string">&quot; bought a &quot;</span> + p.Description;
</code></pre>
<p>ุฏุฑ <strong>Fluent Syntax</strong> ุจุงุฏ ฺฉ ููุน ูุงุดูุงุณ ูููุช (temporary anonymous type) ุจุณุงุฒู ุชุง ูุฑ ุฏู ูุชุบุฑ <code>c</code> ู <code>p</code> ูพุณ ุงุฒ join ุฏุฑ ุฏุณุชุฑุณ ุจุงุดูุฏ:</p>
<pre class="hljs"><code>customers.Join(                  <span class="hljs-comment">// outer collection</span>
    purchases,                   <span class="hljs-comment">// inner collection</span>
    c =&gt; c.ID,                   <span class="hljs-comment">// outer key selector</span>
    p =&gt; p.CustomerID,           <span class="hljs-comment">// inner key selector</span>
    (c, p) =&gt; <span class="hljs-keyword">new</span> { c, p })      <span class="hljs-comment">// result selector</span>
    .OrderBy(x =&gt; x.p.Price)
    .Select(x =&gt; x.c.Name + <span class="hljs-string">&quot; bought a &quot;</span> + x.p.Description);
</code></pre>
<p>โ ุฏุฑ ุนููุ ูุญู Query ุจุฑุง join ูุนูููุงู ุชุฑุฌุญ ุฏุงุฏู ูโุดูุฏุ ฺูู ุณุงุฏูโุชุฑ ู ุฎูุงูุงุชุฑ ุงุณุช.</p>
<hr>
<h2>๐ฅ GroupJoin</h2>
<p>๐น <strong>GroupJoin</strong> ููุงู ฺฉุงุฑ <strong>Join</strong> ุฑุง ุงูุฌุงู ูโุฏูุฏุ ุงูุง ุจูโุฌุง ุงูฺฉู ุฎุฑูุฌ ูุณุทุญ ุจุฏูุฏุ ฺฉ ุฎุฑูุฌ ุณูุณููโูุฑุงุชุจ (hierarchical result) ุชููุฏ ูโฺฉูุฏ ฺฉู ุจุฑ ุงุณุงุณ ูุฑ ุนูุตุฑ ุจุฑูู (outer element) ฺฏุฑููโุจูุฏ ุดุฏู ุงุณุช.<br>
ููฺูู ุงูฺฉุงู <strong>left outer join</strong> ุฑุง ูุฑุงูู ูโฺฉูุฏ.<br>
๐ ุชูุฌู: <strong>GroupJoin</strong> ุฏุฑ ุญุงู ุญุงุถุฑ ุฏุฑ <strong>EF Core</strong> ูพุดุชุจุงู ููโุดูุฏ.</p>
<hr>
<h3>โ๏ธ ูุญู Query ุจุฑุง GroupJoin</h3>
<p>ูุญู Query ุจุฑุง <strong>GroupJoin</strong> ูุซู <strong>Join</strong> ุงุณุชุ ุงูุง ุจุง ฺฉูู ฺฉูุฏ <strong>into</strong> ุฏูุจุงู ูโุดูุฏ.</p>
<p>๐น ฺฉ ูุซุงู ุณุงุฏู ุจุง ฺฉูุฆุฑ ูุญู:</p>
<pre class="hljs"><code>Customer[] customers = dbContext.Customers.ToArray();
Purchase[] purchases = dbContext.Purchases.ToArray();

IEnumerable&lt;IEnumerable&lt;Purchase&gt;&gt; query =
  <span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> customers
  <span class="hljs-keyword">join</span> p <span class="hljs-keyword">in</span> purchases <span class="hljs-keyword">on</span> c.ID <span class="hljs-keyword">equals</span> p.CustomerID
  <span class="hljs-keyword">into</span> custPurchases
  <span class="hljs-keyword">select</span> custPurchases;   <span class="hljs-comment">// custPurchases ฺฉ ุชูุงู ุงุณุช</span>
</code></pre>
<p>๐ ุนุจุงุฑุช <code>into</code> ุชููุง ุฒูุงู ุจู <strong>GroupJoin</strong> ุชุจุฏู ูโุดูุฏ ฺฉู <strong>ุจูุงูุงุตูู ุจุนุฏ ุงุฒ ฺฉ join</strong> ุจุงุฏ.<br>
ุงฺฏุฑ ุจุนุฏ ุงุฒ <strong>select</strong> ุง <strong>group</strong> ุจุงุฏุ ูุนูุงุด <strong>query continuation</strong> ุงุณุช.<br>
ูุฑ ุฏู ููุฑุฏ ฺฉ ูฺฺฏ ูุดุชุฑฺฉ ุฏุงุฑูุฏ: ูุนุฑู ฺฉ ูุชุบุฑ ุฌุฏุฏ (range variable).</p>
<p>๐น ุฎุฑูุฌ ฺฉ <strong>ุชูุงู ุงุฒ ุชูุงูโูุง</strong> ุงุณุช ฺฉู ูโุชูุงูู ุขู ุฑุง ุงูโุทูุฑ ูพูุงุด ฺฉูู:</p>
<pre class="hljs"><code><span class="hljs-keyword">foreach</span> (IEnumerable&lt;Purchase&gt; purchaseSequence <span class="hljs-keyword">in</span> query)
    <span class="hljs-keyword">foreach</span> (Purchase p <span class="hljs-keyword">in</span> purchaseSequence)
        Console.WriteLine(p.Description);
</code></pre>
<hr>
<h3>๐ค ุงุณุชูุงุฏู ฺฉุงุฑุจุฑุฏโุชุฑ ุงุฒ GroupJoin</h3>
<p>ุฏุฑ ุญุงูุช ูุนูููุ ฺฉูุฆุฑ ุฑุง ุงูโุทูุฑ ูโููุณู ุชุง ุงุฑุชุจุงุท ูุดุชุฑ ุจุง ุฎุฑุฏูุงุด ุญูุธ ุดูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> customers
<span class="hljs-keyword">join</span> p <span class="hljs-keyword">in</span> purchases <span class="hljs-keyword">on</span> c.ID <span class="hljs-keyword">equals</span> p.CustomerID
<span class="hljs-keyword">into</span> custPurchases
<span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> { CustName = c.Name, custPurchases };
</code></pre>
<p>ุงู ูุนุงุฏู ุงุณุช ุจุง ุงู ฺฉูุฆุฑ (ฺฉู ูุงฺฉุงุฑุขูุฏ ุงุณุช):</p>
<pre class="hljs"><code><span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> customers
<span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span>
{
    CustName = c.Name,
    custPurchases = purchases.Where(p =&gt; c.ID == p.CustomerID)
};
</code></pre>
<hr>
<h3>๐ Left Outer Join ุฏุฑ GroupJoin</h3>
<p>ุจูโุทูุฑ ูพุดโูุฑุถุ <strong>GroupJoin</strong> ูุนุงุฏู ฺฉ <strong>left outer join</strong> ุงุณุช.<br>
ุจุฑุง ฺฏุฑูุชู <strong>inner join</strong> (ุญุฐู ูุดุชุฑุงู ฺฉู ุฎุฑุฏ ูุฏุงุฑูุฏ)ุ ุจุงุฏ ุฑู <code>custPurchases</code> ููุชุฑ ุจุฒูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> customers
<span class="hljs-keyword">join</span> p <span class="hljs-keyword">in</span> purchases <span class="hljs-keyword">on</span> c.ID <span class="hljs-keyword">equals</span> p.CustomerID
<span class="hljs-keyword">into</span> custPurchases
<span class="hljs-keyword">where</span> custPurchases.Any()
<span class="hljs-keyword">select</span> ...
</code></pre>
<p>๐ ุนุจุงุฑุงุช ุจุนุฏ ุงุฒ <strong>group-join into</strong> ุฑู <strong>ุฒุฑุชูุงูโูุง (subsequences)</strong> ุนูู ูโฺฉููุฏุ ูู ุฑู ุชฺฉโุชฺฉ ุนูุงุตุฑ.<br>
ูพุณ ุงฺฏุฑ ุจุฎูุงูุฏ ุฑู ุฎุฑุฏูุง ูููุฑุฏ ููุชุฑ ฺฉูุฏุ ุจุงุฏ ูุจู ุงุฒ join ุงุฒ <strong>Where</strong> ุงุณุชูุงุฏู ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> customers
<span class="hljs-keyword">join</span> p <span class="hljs-keyword">in</span> purchases.Where(p2 =&gt; p2.Price &gt; <span class="hljs-number">1000</span>)
     <span class="hljs-keyword">on</span> c.ID <span class="hljs-keyword">equals</span> p.CustomerID
<span class="hljs-keyword">into</span> custPurchases ...
</code></pre>
<p>ููฺูู ูโุชูุงูุฏ ฺฉูุฆุฑโูุง <strong>lambda</strong> ุจุง <strong>GroupJoin</strong> ุฏุฑุณุช ูุซู <strong>Join</strong> ุจุณุงุฒุฏ.</p>
<hr>
<h2>๐ช Flat Outer Joins</h2>
<p>ฺฏุงู ูโุฎูุงูุฏ ูู <strong>outer join</strong> ุฏุงุดุชู ุจุงุดุฏ ู ูู ฺฉ ุฎุฑูุฌ ูุณุทุญ (flat result set).</p>
<ul>
<li><strong>GroupJoin</strong> โ outer join ูโุฏูุฏ.</li>
<li><strong>Join</strong> โ ุฎุฑูุฌ ูุณุทุญ ูโุฏูุฏ.</li>
</ul>
<p>๐ ุฑุงูโุญู: ุงูู <strong>GroupJoin</strong>ุ ุจุนุฏ <strong>DefaultIfEmpty</strong> ุฑู ูุฑ ุฒุฑุชูุงูุ ู ุฏุฑ ููุงุช <strong>SelectMany</strong>:</p>
<pre class="hljs"><code><span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> customers
<span class="hljs-keyword">join</span> p <span class="hljs-keyword">in</span> purchases <span class="hljs-keyword">on</span> c.ID <span class="hljs-keyword">equals</span> p.CustomerID <span class="hljs-keyword">into</span> custPurchases
<span class="hljs-keyword">from</span> cp <span class="hljs-keyword">in</span> custPurchases.DefaultIfEmpty()
<span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span>
{
    CustName = c.Name,
    Price = cp == <span class="hljs-literal">null</span> ? (<span class="hljs-built_in">decimal</span>?) <span class="hljs-literal">null</span> : cp.Price
};
</code></pre>
<p>โ ุงฺฏุฑ ุฒุฑุชูุงู ุฎุฑุฏูุง ุฎุงู ุจุงุดุฏุ <strong>DefaultIfEmpty</strong> ฺฉ ุชูุงู ุจุง ููุฏุงุฑ null ุชููุฏ ูโฺฉูุฏ.<br>
ุนุจุงุฑุช ุฏูู <strong>from</strong> ุจู <strong>SelectMany</strong> ุชุฑุฌูู ูโุดูุฏ ู ููู ุฒุฑุชูุงูโูุง ุฎุฑุฏ ุฑุง ฺฏุณุชุฑุด ุฏุงุฏู ู ุฏุฑ ฺฉ ุชูุงู ูุงุญุฏ ุงุฒ ุนูุงุตุฑ ุฎุฑุฏ ูุณุทุญ ูโฺฉูุฏ.</p>
<h3>๐ Joining with Lookups</h3>
<p>ุงูพุฑุงุชูุฑูุง <strong>Join</strong> ู <strong>GroupJoin</strong> ุฏุฑ ฺฉูุงุณ <strong>Enumerable</strong> ุฏุฑ ุฏู ูุฑุญูู ุนูู ูโฺฉููุฏ:</p>
<ol>
<li>ุงุจุชุฏุง ุชูุงู ุฏุฑูู (inner sequence) ุฑุง ุฏุงุฎู ฺฉ <strong>lookup</strong> ุจุงุฑฺฏุฐุงุฑ ูโฺฉููุฏ.</li>
<li>ุณูพุณ ุชูุงู ุจุฑูู (outer sequence) ุฑุง ุฏุฑ ุชุฑฺฉุจ ุจุง lookup ูพุฑุฏุงุฒุด ูโฺฉููุฏ.</li>
</ol>
<hr>
<h3>๐ฆ Lookup ฺุณุชุ</h3>
<p>ฺฉ <strong>lookup</strong> ุฏุฑ ูุงูุน ูุฌููุนูโุง ุงุฒ ฺฏุฑููโูุง (groupings) ุงุณุช ฺฉู ูโุชูุงู ุจูโุทูุฑ ูุณุชูู ุจุง ฺฉูุฏ (key) ุจู ุขูโูุง ุฏุณุชุฑุณ ุฏุงุดุช.<br>
ูโุชูุงูุฏ ุขู ุฑุง ูุซู ฺฉ <strong>ุฏฺฉุดูุฑ ุงุฒ ุชูุงูโูุง</strong> ุชุตูุฑ ฺฉูุฏโฺฉ ุฏฺฉุดูุฑ ฺฉู ูโุชูุงูุฏ ฺูุฏู ุนูุตุฑ ุฑุง ุฒุฑ ฺฉ ฺฉูุฏ ูฺฏู ุฏุงุฑุฏ (ฺฏุงู ุจู ุขู <strong>multidictionary</strong> ูโฺฏููุฏ).</p>
<p>๐ Lookup ููุท ุฎูุงูุฏู (read-only) ุงุณุช ู ุฑุงุจุท ุขู ุจู ุดฺฉู ุฒุฑ ุชุนุฑู ูโุดูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">ILookup</span>&lt;<span class="hljs-title">TKey</span>, <span class="hljs-title">TElement</span>&gt; :
    <span class="hljs-title">IEnumerable</span>&lt;<span class="hljs-title">IGrouping</span>&lt;<span class="hljs-title">TKey</span>, <span class="hljs-title">TElement</span>&gt;&gt;, <span class="hljs-title">IEnumerable</span>
{
    <span class="hljs-built_in">int</span> Count { <span class="hljs-keyword">get</span>; }
    <span class="hljs-function"><span class="hljs-built_in">bool</span> <span class="hljs-title">Contains</span>(<span class="hljs-params">TKey key</span>)</span>;
    IEnumerable&lt;TElement&gt; <span class="hljs-keyword">this</span>[TKey key] { <span class="hljs-keyword">get</span>; }
}
</code></pre>
<hr>
<h3>โณ ุงุฌุฑุง Lazy</h3>
<p>ูุซู ุณุงุฑ ุงูพุฑุงุชูุฑูุง LINQ ฺฉู ุฎุฑูุฌ ุชููุฏ ูโฺฉููุฏุ ุงูพุฑุงุชูุฑูุง join ูุฒ <strong>Deferred Execution</strong> ุง <strong>Lazy Execution</strong> ุฏุงุฑูุฏ.<br>
ุนู <strong>lookup</strong> ุณุงุฎุชู ููโุดูุฏ ุชุง ุฒูุงู ฺฉู ูพูุงุด (enumeration) ุฎุฑูุฌ ุดุฑูุน ุดูุฏโู ุฏุฑ ุขู ูุญุธู ฺฉู lookup ฺฉุฌุง ุณุงุฎุชู ูโุดูุฏ.</p>
<hr>
<h3>๐ ุณุงุฎุชู Lookup ุฏุณุช</h3>
<p>ูโุชูุงูุฏ lookup ุฑุง ุจูโุทูุฑ ุฏุณุช ุจุณุงุฒุฏ ู ฺฉูุฆุฑ ุจุฒูุฏ. ุงู ฺฉุงุฑ ฺูุฏ ูุฒุช ุฏุงุฑุฏ:</p>
<ul>
<li>โ ูโุชูุงูุฏ ฺฉ lookup ุฑุง ุฏุฑ ฺูุฏู ฺฉูุฆุฑ ู ุญุช ุฏุฑ ฺฉุฏ ุฏุณุชูุฑ (imperative code) ูุนููู ุงุณุชูุงุฏู ฺฉูุฏ.</li>
<li>โ ูพุฑุณโูุฌู (query) ุงุฒ lookup ฺฉ ุฑุงู ุนุงู ุจุฑุง ุฏุฑฺฉ ูุญู ฺฉุงุฑ <strong>Join</strong> ู <strong>GroupJoin</strong> ุงุณุช.</li>
</ul>
<p>๐น ูุชุฏ <strong>ToLookup</strong> ฺฉ lookup ูโุณุงุฒุฏ. ูุซุงู: ุจุงุฑฺฏุฐุงุฑ ุชูุงู ุฎุฑุฏูุง (purchases) ุฏุฑ ฺฉ lookup ฺฉู ุจุฑ ุงุณุงุณ <strong>CustomerID</strong> ฺฉูุฏฺฏุฐุงุฑ ุดุฏู ุงุณุช:</p>
<pre class="hljs"><code>ILookup&lt;<span class="hljs-built_in">int</span>?, Purchase&gt; purchLookup =
    purchases.ToLookup(p =&gt; p.CustomerID, p =&gt; p);
</code></pre>
<ul>
<li>ุขุฑฺฏููุงู ุงูู โ ฺฉูุฏ (CustomerID).</li>
<li>ุขุฑฺฏููุงู ุฏูู โ ููุงุฏุฑ ฺฉู ุจูโุนููุงู value ุฏุฑ lookup ุฐุฎุฑู ูโุดููุฏ.</li>
</ul>
<hr>
<h3>๐ ุฎูุงูุฏู ุงุฒ Lookup</h3>
<p>ุฎูุงูุฏู ุงุฒ ฺฉ lookup ุดุจู ุฎูุงูุฏู ุงุฒ ฺฉ ุฏฺฉุดูุฑ ุงุณุชุ ุจุง ุงู ุชูุงูุช ฺฉู <strong>Indexer</strong> ฺฉ ุชูุงู ุงุฒ ุขุชูโูุง ููุทุจู ุจุฑูโฺฏุฑุฏุงูุฏ (ูู ููุท ฺฉ ุขุชู).</p>
<pre class="hljs"><code><span class="hljs-keyword">foreach</span> (Purchase p <span class="hljs-keyword">in</span> purchLookup[<span class="hljs-number">1</span>])
    Console.WriteLine(p.Description);
</code></pre>
<p>ุงู ฺฉุฏ ุชูุงู ุฎุฑุฏูุง ูุดุชุฑ ุจุง ID ุจุฑุงุจุฑ 1 ุฑุง ููุงุด ูโุฏูุฏ.</p>
<hr>
<h3>โก ฺฉุงุฑุง Lookup ูุซู Join/GroupJoin</h3>
<p>ููุช ฺฉ lookup ุฏุงุดุชู ุจุงุดุฏุ ูโุชูุงูุฏ ฺฉูุฆุฑโูุง <strong>SelectMany/Select</strong> ุจููุณุฏ ฺฉู ุจูโุงูุฏุงุฒ ฺฉูุฆุฑโูุง <strong>Join/GroupJoin</strong> ฺฉุงุฑุขูุฏ ูุณุชูุฏ.</p>
<p>๐น <strong>Join</strong> ูุนุงุฏู ุงุณุชูุงุฏู ุงุฒ <strong>SelectMany</strong> ุฑู ฺฉ lookup ุงุณุช:</p>
<pre class="hljs"><code><span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> customers
<span class="hljs-keyword">from</span> p <span class="hljs-keyword">in</span> purchLookup[c.ID]
<span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> { c.Name, p.Description, p.Price };
</code></pre>
<p>๐ ุฎุฑูุฌ:</p>
<pre class="hljs"><code>Tom Bike 500
Tom Holiday 2000
Dick Bike 600
Dick Phone 300
...
</code></pre>
<hr>
<h3>๐ช Outer Join ุจุง DefaultIfEmpty</h3>
<p>ุงุถุงููโฺฉุฑุฏู <strong>DefaultIfEmpty</strong> ุจุงุนุซ ูโุดูุฏ ฺฉูุฆุฑ ูุนุงุฏู ฺฉ <strong>outer join</strong> ุดูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> customers
<span class="hljs-keyword">from</span> p <span class="hljs-keyword">in</span> purchLookup[c.ID].DefaultIfEmpty()
<span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span>
{
    c.Name,
    Descript = p == <span class="hljs-literal">null</span> ? <span class="hljs-literal">null</span> : p.Description,
    Price = p == <span class="hljs-literal">null</span> ? (<span class="hljs-built_in">decimal</span>?) <span class="hljs-literal">null</span> : p.Price
};
</code></pre>
<hr>
<h3>๐งฉ GroupJoin ูุนุงุฏู Lookup</h3>
<p><strong>GroupJoin</strong> ูุนุงุฏู ุงู ุงุณุช ฺฉู lookup ุฑุง ุฏุงุฎู projection ุจุฎูุงูู:</p>
<pre class="hljs"><code><span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> customers
<span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span>
{
    CustName = c.Name,
    CustPurchases = purchLookup[c.ID]
};
</code></pre>
<hr>
<h2>โ๏ธ ูพุงุฏูโุณุงุฒ Enumerable.Join</h2>
<p>ุณุงุฏูโุชุฑู ูพุงุฏูโุณุงุฒ ูุนุชุจุฑ <strong>Enumerable.Join</strong> (ุจุฏูู ุฏุฑูุธุฑ ฺฏุฑูุชู null-check):</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title">IEnumerable</span>&lt;<span class="hljs-title">TResult</span>&gt; <span class="hljs-title">Join</span>
    &lt;TOuter, TInner, TKey, TResult&gt;(<span class="hljs-params">
        <span class="hljs-keyword">this</span> IEnumerable&lt;TOuter&gt; outer,
        IEnumerable&lt;TInner&gt; inner,
        Func&lt;TOuter, TKey&gt; outerKeySelector,
        Func&lt;TInner, TKey&gt; innerKeySelector,
        Func&lt;TOuter, TInner, TResult&gt; resultSelector</span>)</span>
{
    ILookup&lt;TKey, TInner&gt; lookup = inner.ToLookup(innerKeySelector);
    <span class="hljs-keyword">return</span>
        <span class="hljs-keyword">from</span> outerItem <span class="hljs-keyword">in</span> outer
        <span class="hljs-keyword">from</span> innerItem <span class="hljs-keyword">in</span> lookup[outerKeySelector(outerItem)]
        <span class="hljs-function"><span class="hljs-keyword">select</span> <span class="hljs-title">resultSelector</span>(<span class="hljs-params">outerItem, innerItem</span>)</span>;
}
</code></pre>
<hr>
<h2>โ๏ธ ูพุงุฏูโุณุงุฒ Enumerable.GroupJoin</h2>
<p>ูพุงุฏูโุณุงุฒ <strong>GroupJoin</strong> ุดุจู Join ุงุณุชุ ุงูุง ุณุงุฏูโุชุฑ:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title">IEnumerable</span>&lt;<span class="hljs-title">TResult</span>&gt; <span class="hljs-title">GroupJoin</span>
    &lt;TOuter, TInner, TKey, TResult&gt;(<span class="hljs-params">
        <span class="hljs-keyword">this</span> IEnumerable&lt;TOuter&gt; outer,
        IEnumerable&lt;TInner&gt; inner,
        Func&lt;TOuter, TKey&gt; outerKeySelector,
        Func&lt;TInner, TKey&gt; innerKeySelector,
        Func&lt;TOuter, IEnumerable&lt;TInner&gt;, TResult&gt; resultSelector</span>)</span>
{
    ILookup&lt;TKey, TInner&gt; lookup = inner.ToLookup(innerKeySelector);
    <span class="hljs-keyword">return</span>
        <span class="hljs-function"><span class="hljs-keyword">from</span> outerItem <span class="hljs-keyword">in</span> outer
        <span class="hljs-keyword">select</span> <span class="hljs-title">resultSelector</span>(<span class="hljs-params">
            outerItem,
            lookup[outerKeySelector(outerItem</span>)])</span>;
}
</code></pre>
<hr>
<h2>๐ The Zip Operator</h2>
<pre class="hljs"><code>IEnumerable&lt;TFirst&gt;, IEnumerable&lt;TSecond&gt; โ IEnumerable&lt;TResult&gt;
</code></pre>
<p>ุงูพุฑุงุชูุฑ <strong>Zip</strong> ุฏู ุชูุงู ุฑุง <strong>ฺฏุงูโุจูโฺฏุงู</strong> (ูุซู ุฒูพ) ูพูุงุด ูโฺฉูุฏ ู ุจุง ุงุนูุงู ฺฉ ุชุงุจุน ุฑู ูุฑ ุฌูุช ุนูุตุฑุ ฺฉ ุชูุงู ุฌุฏุฏ ูโุณุงุฒุฏ.</p>
<p>๐น ูุซุงู:</p>
<pre class="hljs"><code><span class="hljs-built_in">int</span>[] numbers = { <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span> };
<span class="hljs-built_in">string</span>[] words = { <span class="hljs-string">&quot;three&quot;</span>, <span class="hljs-string">&quot;five&quot;</span>, <span class="hljs-string">&quot;seven&quot;</span>, <span class="hljs-string">&quot;ignored&quot;</span> };

IEnumerable&lt;<span class="hljs-built_in">string</span>&gt; zip =
    numbers.Zip(words, (n, w) =&gt; n + <span class="hljs-string">&quot;=&quot;</span> + w);
</code></pre>
<p>๐ ุฎุฑูุฌ:</p>
<pre class="hljs"><code>3=three
5=five
7=seven
</code></pre>
<p>๐ ุนูุงุตุฑ ุงุถุงูู ุฏุฑ ูุฑ ฺฉ ุงุฒ ุชูุงูโูุง ูุงุฏุฏู ฺฏุฑูุชู ูโุดููุฏ.<br>
โ๏ธ <strong>Zip</strong> ุฏุฑ <strong>EF Core</strong> ูพุดุชุจุงู ููโุดูุฏ.</p>
<h3>๐ ูุฑุชุจโุณุงุฒ (Ordering)</h3>
<pre class="hljs"><code>IEnumerable&lt;TSource&gt; โ IOrderedEnumerable&lt;TSource&gt;
</code></pre>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-13.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ุนููฺฏุฑูุง ูุฑุชุจโุณุงุฒ (Ordering operators) ููุงู ุนูุงุตุฑ ุฑุง ุจุงุฒูโฺฏุฑุฏุงููุฏุ ุงูุง ุฏุฑ <strong>ุชุฑุชุจ ูุชูุงูุช</strong>.</p>
<h3>๐ OrderBy, OrderByDescending, ThenBy, ThenByDescending</h3>
<h4>๐ ุขุฑฺฏููุงูโูุง OrderBy ู OrderByDescending</h4>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-14.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ููุน ุจุงุฒฺฏุดุช = <code>IOrderedEnumerable&lt;TSource&gt;</code></p>
<h3>๐น ุขุฑฺฏููุงูโูุง ThenBy ู ThenByDescending</h3>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-15.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>๐ ูุญู Query (Query syntax)</h3>
<pre class="hljs"><code>orderby expression1 [descending] [, expression2 [descending] ... ]
</code></pre>
<hr>
<h3>๐ ูุฑูุฑ ฺฉู (Overview)</h3>
<ul>
<li><strong>OrderBy</strong> ูุณุฎูโุง ูุฑุชุจโุดุฏู ุงุฒ ุชูุงู ูุฑูุฏ ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ ู ุงุฒ <strong>keySelector</strong> ุจุฑุง ููุงุณู ุงุณุชูุงุฏู ูโฺฉูุฏ.</li>
<li>ูุซุงู: ุชููุฏ ฺฉ ุชูุงู ุงุฒ ูุงูโูุง ุจู ุชุฑุชุจ ุญุฑูู ุงููุจุง:</li>
</ul>
<pre class="hljs"><code>IEnumerable&lt;<span class="hljs-built_in">string</span>&gt; query = names.OrderBy(s =&gt; s);
</code></pre>
<ul>
<li>ูุฑุชุจโุณุงุฒ ุจุฑ ุงุณุงุณ ุทูู ูุงู:</li>
</ul>
<pre class="hljs"><code>IEnumerable&lt;<span class="hljs-built_in">string</span>&gt; query = names.OrderBy(s =&gt; s.Length);
<span class="hljs-comment">// ูุชุฌู: { &quot;Jay&quot;, &quot;Tom&quot;, &quot;Mary&quot;, &quot;Dick&quot;, &quot;Harry&quot; };</span>
</code></pre>
<ul>
<li>ุชุฑุชุจ ูุณุจ ุนูุงุตุฑ ฺฉู ฺฉูุฏ ูุฑุชุจโุณุงุฒ ฺฉุณุงู ุฏุงุฑูุฏ (ูุซู Jay/Tom ู Mary/Dick) ูุดุฎุต ูุณุชโูฺฏุฑ ุงูฺฉู <strong>ThenBy</strong> ุงุถุงูู ฺฉูุฏ:</li>
</ul>
<pre class="hljs"><code>IEnumerable&lt;<span class="hljs-built_in">string</span>&gt; query = names.OrderBy(s =&gt; s.Length).ThenBy(s =&gt; s);
<span class="hljs-comment">// ูุชุฌู: { &quot;Jay&quot;, &quot;Tom&quot;, &quot;Dick&quot;, &quot;Mary&quot;, &quot;Harry&quot; };</span>
</code></pre>
<ul>
<li><strong>ThenBy</strong> ุชููุง ุนูุงุตุฑ ุจุง ููุงู ฺฉูุฏ ูุฑุชุจโุณุงุฒ ูุจู ุฑุง ุฏูุจุงุฑู ูุฑุชุจ ูโฺฉูุฏ.</li>
<li>ูโุชูุงูุฏ ูุฑ ุชุนุฏุงุฏ <strong>ThenBy</strong> ุฑุง ุฒูุฌุฑูโุง ุงุณุชูุงุฏู ฺฉูุฏ. ูุซุงู: ุงุจุชุฏุง ุจุฑ ุงุณุงุณ ุทููุ ุณูพุณ ฺฉุงุฑุงฺฉุชุฑ ุฏููุ ู ุฏุฑ ููุงุช ฺฉุงุฑุงฺฉุชุฑ ุงูู:</li>
</ul>
<pre class="hljs"><code>names.OrderBy(s =&gt; s.Length).ThenBy(s =&gt; s[<span class="hljs-number">1</span>]).ThenBy(s =&gt; s[<span class="hljs-number">0</span>]);
</code></pre>
<hr>
<h3>๐ ูุนุงุฏู ุฏุฑ ูุญู Query</h3>
<pre class="hljs"><code><span class="hljs-keyword">from</span> s <span class="hljs-keyword">in</span> names
<span class="hljs-keyword">orderby</span> s.Length, s[<span class="hljs-number">1</span>], s[<span class="hljs-number">0</span>]
<span class="hljs-keyword">select</span> s;
</code></pre>
<p>โ๏ธ ููููู ุงุดุชุจุงู: ุงู ุฏุฑ ูุงูุน ุงุจุชุฏุง ุจุฑ ุงุณุงุณ <code>s[1]</code> ู ุณูพุณ <code>s.Length</code> ูุฑุชุจ ูโฺฉูุฏ (ุง ุฏุฑ ฺฉูุฆุฑ ูพุงฺฏุงู ุฏุงุฏู ููุท ุจุฑ ุงุณุงุณ <code>s[1]</code> ูุฑุชุจ ูโฺฉูุฏ ู ุชุฑุชุจ ูุจู ุฑุง ูุงุฏุฏู ูโฺฏุฑุฏ):</p>
<pre class="hljs"><code><span class="hljs-keyword">from</span> s <span class="hljs-keyword">in</span> names
<span class="hljs-keyword">orderby</span> s.Length
<span class="hljs-keyword">orderby</span> s[<span class="hljs-number">1</span>]
...
</code></pre>
<hr>
<h3>๐ฝ OrderByDescending ู ThenByDescending</h3>
<p>ุงู ุงูพุฑุงุชูุฑูุง ููุงู ฺฉุงุฑูุง ูุจู ุฑุง ุงูุฌุงู ูโุฏููุฏ ุงูุง ุฎุฑูุฌ ุฑุง ุจู ุชุฑุชุจ ูุนฺฉูุณ ูโุฏููุฏ.</p>
<p>ูุซุงู EF Core: ุจุงุฒุงุจ ุฎุฑุฏูุง ุจุฑ ุงุณุงุณ ููุช ูุฒูู ู ุฏุฑ ุตูุฑุช ุจุฑุงุจุฑ ุจูุฏู ููุชุ ุจู ุชุฑุชุจ ุงููุจุง:</p>
<pre class="hljs"><code>dbContext.Purchases
    .OrderByDescending(p =&gt; p.Price)
    .ThenBy(p =&gt; p.Description);
</code></pre>
<p>ูุนุงุฏู ุฏุฑ ูุญู Query:</p>
<pre class="hljs"><code><span class="hljs-keyword">from</span> p <span class="hljs-keyword">in</span> dbContext.Purchases
<span class="hljs-keyword">orderby</span> p.Price <span class="hljs-keyword">descending</span>, p.Description
<span class="hljs-keyword">select</span> p;
</code></pre>
<h3>๐ Comparers ู Collations</h3>
<ul>
<li>ุฏุฑ ฺฉ <strong>ฺฉูุฆุฑ ูุญู (local query)</strong>ุ ุฎูุฏู ุงุดุงุก ุงูุชุฎุงุจโุดุฏู ุชูุณุท <strong>key selector</strong> ุงูฺฏูุฑุชู ูุฑุชุจโุณุงุฒ ุฑุง ุงุฒ ุทุฑู ูพุงุฏูโุณุงุฒ ูพุดโูุฑุถ <strong>IComparable</strong> ุชุนู ูโฺฉููุฏ (ุฑุฌูุน ฺฉูุฏ ุจู ูุตู ท).</li>
<li>ุดูุง ูโุชูุงูุฏ ุงูฺฏูุฑุชู ูุฑุชุจโุณุงุฒ ุฑุง ุจุง ุงุฑุณุงู ฺฉ ุดุก <strong>IComparer</strong> ุจุงุฒููุณ ฺฉูุฏ. ูุซุงู: ูุฑุชุจโุณุงุฒ <strong>ุบุฑุญุณุงุณ ุจู ุญุฑูู ุจุฒุฑฺฏ/ฺฉูฺฺฉ</strong>:</li>
</ul>
<pre class="hljs"><code>names.OrderBy(n =&gt; n, StringComparer.CurrentCultureIgnoreCase);
</code></pre>
<ul>
<li>ุงุฑุณุงู <strong>comparer</strong> ุฏุฑ ูุญู Query ุง ุชูุณุท <strong>EF Core</strong> ูพุดุชุจุงู ููโุดูุฏ.</li>
<li>ููฺฏุงู ฺฉูุฆุฑ ุฒุฏู ุฑู ูพุงฺฏุงู ุฏุงุฏูุ ุงูฺฏูุฑุชู ููุงุณู ุชูุณุท <strong>Collation</strong> ุณุชูู ูุฑุจูุทู ุชุนู ูโุดูุฏ.</li>
<li>ุงฺฏุฑ Collation ุญุณุงุณ ุจู ุญุฑูู ุจุงุดุฏุ ูโุชูุงูุฏ ูุฑุชุจโุณุงุฒ ุบุฑุญุณุงุณ ุจู ุญุฑูู ุจุฒุฑฺฏ/ฺฉูฺฺฉ ุฑุง ุจุง ูุฑุงุฎูุงู <code>ToUpper</code> ุฏุฑ <strong>key selector</strong> ุงูุฌุงู ุฏูุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">from</span> p <span class="hljs-keyword">in</span> dbContext.Purchases
<span class="hljs-keyword">orderby</span> p.Description.ToUpper()
<span class="hljs-keyword">select</span> p;
</code></pre>
<hr>
<h3>๐น IOrderedEnumerable ู IOrderedQueryable</h3>
<ul>
<li>
<p>ุงูพุฑุงุชูุฑูุง ูุฑุชุจโุณุงุฒุ ุฒุฑููุนโูุง ุฎุงุต ุงุฒ <code>IEnumerable&lt;T&gt;</code> ุฑุง ุจุฑูโฺฏุฑุฏุงููุฏ:</p>
<ul>
<li>ุฏุฑ <strong>Enumerable</strong> โ <code>IOrderedEnumerable&lt;TSource&gt;</code></li>
<li>ุฏุฑ <strong>Queryable</strong> โ <code>IOrderedQueryable&lt;TSource&gt;</code></li>
</ul>
</li>
<li>
<p>ุงู ุฒุฑููุนโูุง ุงุฌุงุฒู ูโุฏููุฏ ฺฉู ุงูพุฑุงุชูุฑ <strong>ThenBy</strong>ุ ุชุฑุชุจ ููุฌูุฏ ุฑุง <strong>ุชฺฉูู</strong> ฺฉูุฏ ู ุฌุงฺฏุฒู ูฺฉูุฏ.</p>
</li>
<li>
<p>ุงุนุถุง ุงุถุงู ุงู ุฒุฑููุนโูุง ุจูโุตูุฑุช ุนููู ููุงุงู ูุณุชูุฏ ู ุดุจู ุชูุงูโูุง ุนุงุฏ ุนูู ูโฺฉููุฏ.</p>
</li>
</ul>
<p>๐น ูุซุงู: ุณุงุฎุช ฺฉูุฆุฑ ูุฑุญููโุง</p>
<pre class="hljs"><code>IOrderedEnumerable&lt;<span class="hljs-built_in">string</span>&gt; query1 = names.OrderBy(s =&gt; s.Length);
IOrderedEnumerable&lt;<span class="hljs-built_in">string</span>&gt; query2 = query1.ThenBy(s =&gt; s);
</code></pre>
<p>โ๏ธ ุงฺฏุฑ <code>query1</code> ุงุฒ ููุน <code>IEnumerable&lt;string&gt;</code> ุชุนุฑู ุดูุฏุ ุฎุท ุฏูู ฺฉุงููพุงู ููโุดูุฏโฺูู <strong>ThenBy</strong> ุจู ูุฑูุฏ ุงุฒ ููุน <code>IOrderedEnumerable&lt;string&gt;</code> ูุงุฒ ุฏุงุฑุฏ.</p>
<hr>
<h3>๐น ุงุณุชูุงุฏู ุงุฒ ุชุงูพ ุถูู (Implicit Typing)</h3>
<pre class="hljs"><code><span class="hljs-keyword">var</span> query1 = names.OrderBy(s =&gt; s.Length);
<span class="hljs-keyword">var</span> query2 = query1.ThenBy(s =&gt; s);
</code></pre>
<ul>
<li>ุชุงูพ ุถูู ุฑุงุญุช ุฏุงุฑุฏ ุงูุง ูโุชูุงูุฏ ูุดฺฉูุงุช ุงุฌุงุฏ ฺฉูุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">var</span> query = names.OrderBy(s =&gt; s.Length);
query = query.Where(n =&gt; n.Length &gt; <span class="hljs-number">3</span>);  <span class="hljs-comment">// ุฎุทุง ุฒูุงู ฺฉุงููพุงู</span>
</code></pre>
<ul>
<li>ฺฉุงููพุงูุฑ <code>query</code> ุฑุง ุงุฒ ููุน <code>IOrderedEnumerable&lt;string&gt;</code> ุงุณุชูุชุงุฌ ูโฺฉูุฏุ ุงูุง <code>Where</code> ฺฉ <code>IEnumerable&lt;string&gt;</code> ุจุฑูโฺฏุฑุฏุงูุฏ ฺฉู ููโุชูุงู ุขู ุฑุง ุฏูุจุงุฑู ุจู <code>query</code> ุงุฎุชุตุงุต ุฏุงุฏ.</li>
</ul>
<p>โ ุฑุงูโุญูโูุง:</p>
<ol>
<li>ุงุณุชูุงุฏู ุงุฒ ุชุงูพ ุตุฑุญ</li>
<li>ุง ูุฑุงุฎูุงู <code>AsEnumerable()</code> ุจุนุฏ ุงุฒ <code>OrderBy</code>:</li>
</ol>
<pre class="hljs"><code><span class="hljs-keyword">var</span> query = names.OrderBy(s =&gt; s.Length).AsEnumerable();
query = query.Where(n =&gt; n.Length &gt; <span class="hljs-number">3</span>);  <span class="hljs-comment">// ุฏุฑุณุช</span>
</code></pre>
<ul>
<li>ูุนุงุฏู ุฏุฑ ฺฉูุฆุฑโูุง <strong>interpreted</strong>ุ ูุฑุงุฎูุงู <code>AsQueryable()</code> ุงุณุช.</li>
</ul>
<h2>Grouping</h2>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-16.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>๐ GroupBy</h3>
<pre class="hljs"><code>IEnumerable&lt;TSource&gt; โ IEnumerable&lt;IGrouping&lt;TKey, TElement&gt;&gt;
</code></pre>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-17.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>๐ GroupBy</h3>
<pre class="hljs"><code>IEnumerable&lt;TSource&gt; โ IEnumerable&lt;IGrouping&lt;TKey, TElement&gt;&gt;
</code></pre>
<hr>
<h3>๐ ูุญู Query (Query syntax)</h3>
<pre class="hljs"><code>group element-expression by key-expression
</code></pre>
<hr>
<h3>๐ ูุฑูุฑ ฺฉู (Overview)</h3>
<ul>
<li><strong>GroupBy</strong> ฺฉ ุชูุงู ุตุงู (flat) ุฑุง ุจู ุชูุงูโุง ุงุฒ ฺฏุฑููโูุง ุชุจุฏู ูโฺฉูุฏ.</li>
<li>ูุซุงู: ฺฏุฑููโุจูุฏ ุชูุงู ูุงูโูุง ููุฌูุฏ ุฏุฑ <code>Path.GetTempPath()</code> ุจุฑ ุงุณุงุณ ูพุณููุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">string</span>[] files = Directory.GetFiles(Path.GetTempPath());

IEnumerable&lt;IGrouping&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;&gt; query =
    files.GroupBy(<span class="hljs-keyword">file</span> =&gt; Path.GetExtension(<span class="hljs-keyword">file</span>));
</code></pre>
<ul>
<li>ุง ุจุง ุชุงูพ ุถูู:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">var</span> query = files.GroupBy(<span class="hljs-keyword">file</span> =&gt; Path.GetExtension(<span class="hljs-keyword">file</span>));
</code></pre>
<hr>
<h3>๐น ูพูุงุด ูุชุงุฌ</h3>
<pre class="hljs"><code><span class="hljs-keyword">foreach</span> (IGrouping&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt; grouping <span class="hljs-keyword">in</span> query)
{
    Console.WriteLine(<span class="hljs-string">&quot;Extension: &quot;</span> + grouping.Key);
    <span class="hljs-keyword">foreach</span> (<span class="hljs-built_in">string</span> filename <span class="hljs-keyword">in</span> grouping)
        Console.WriteLine(<span class="hljs-string">&quot;   - &quot;</span> + filename);
}
</code></pre>
<p>๐ ุฎุฑูุฌ ููููู:</p>
<pre class="hljs"><code>Extension: .pdf
  -- chapter03.pdf
  -- chapter04.pdf
Extension: .doc
  -- todo.doc
  -- menu.doc
  -- Copy of menu.doc
</code></pre>
<hr>
<h3>๐ ูพุงุฏูโุณุงุฒ ุฏุงุฎู</h3>
<ul>
<li><code>Enumerable.GroupBy</code> ุนูุงุตุฑ ูุฑูุฏ ุฑุง ุฏุงุฎู ฺฉ ุฏฺฉุดูุฑ ูููุช ุงุฒ ูุณุชโูุง ูโุฎูุงูุฏ ุชุง ููู ุนูุงุตุฑ ุจุง ฺฉูุฏ ูุดุงุจู ุฏุฑ ฺฉ ุฒุฑูุณุช ูุฑุงุฑ ฺฏุฑูุฏ.</li>
<li>ุณูพุณ ฺฉ ุชูุงู ุงุฒ <strong>grouping</strong>ูุง ุฑุง ุชููุฏ ูโฺฉูุฏ.</li>
<li><strong>Grouping</strong> ฺฉ ุชูุงู ุงุณุช ฺฉู ุฏุงุฑุง <strong>Key</strong> ูโุจุงุดุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">IGrouping</span>&lt;<span class="hljs-title">TKey</span>, <span class="hljs-title">TElement</span>&gt; : <span class="hljs-title">IEnumerable</span>&lt;<span class="hljs-title">TElement</span>&gt;, <span class="hljs-title">IEnumerable</span>
{
    TKey Key { <span class="hljs-keyword">get</span>; }    <span class="hljs-comment">// ฺฉูุฏ ุงุนูุงู ุดุฏู ุฑู ุฒุฑุชูุงู ุจูโุตูุฑุช ฺฉู</span>
}
</code></pre>
<ul>
<li>ุจู ุทูุฑ ูพุดโูุฑุถุ ุนูุงุตุฑ ูุฑ ฺฏุฑูู ููุงู ุนูุงุตุฑ ูุฑูุฏ ูุณุชูุฏ ูฺฏุฑ ุงูฺฉู <strong>elementSelector</strong> ูุดุฎุต ฺฉูุฏ.</li>
<li>ูุซุงู: ุชุจุฏู ุนูุงุตุฑ ูุฑูุฏ ุจู ุญุฑูู ุจุฒุฑฺฏ:</li>
</ul>
<pre class="hljs"><code>files.GroupBy(<span class="hljs-keyword">file</span> =&gt; Path.GetExtension(<span class="hljs-keyword">file</span>), <span class="hljs-keyword">file</span> =&gt; <span class="hljs-keyword">file</span>.ToUpper());
</code></pre>
<ul>
<li>ุฏุฑ ุงู ุญุงูุชุ <strong>Key</strong> ูุฑ ฺฏุฑูู ูููุฒ ุฏุฑ ุญุงูุช ุงุตู ุฎูุฏ ุจุงู ูโูุงูุฏ.</li>
</ul>
<p>๐ ุฎุฑูุฌ ููููู:</p>
<pre class="hljs"><code>Extension: .pdf
  -- CHAPTER03.PDF
  -- CHAPTER04.PDF
Extension: .doc
  -- TODO.DOC
</code></pre>
<hr>
<h3>โ๏ธ ูฺฉุงุช ููู</h3>
<ul>
<li>ุฒุฑูุฌููุนูโูุง ุจุฑ ุงุณุงุณ ฺฉูุฏ ุจู ุชุฑุชุจ ุงููุจุง ุตุงุฏุฑ ููโุดููุฏ. <strong>GroupBy</strong> ุชููุง ฺฏุฑููโุจูุฏ ูโฺฉูุฏ ู ูุฑุชุจโุณุงุฒ ุงูุฌุงู ููโุฏูุฏ.</li>
<li>ุจุฑุง ูุฑุชุจโุณุงุฒุ ุจุงุฏ ุงุฒ <strong>OrderBy</strong> ุงุณุชูุงุฏู ฺฉูุฏ:</li>
</ul>
<pre class="hljs"><code>files.GroupBy(<span class="hljs-keyword">file</span> =&gt; Path.GetExtension(<span class="hljs-keyword">file</span>), <span class="hljs-keyword">file</span> =&gt; <span class="hljs-keyword">file</span>.ToUpper())
     .OrderBy(grouping =&gt; grouping.Key);
</code></pre>
<hr>
<h3>๐น ูุนุงุฏู ุฏุฑ ูุญู Query</h3>
<pre class="hljs"><code>group element-expr by key-expr
</code></pre>
<p>ูุซุงู:</p>
<pre class="hljs"><code><span class="hljs-keyword">from</span> <span class="hljs-keyword">file</span> <span class="hljs-keyword">in</span> files
<span class="hljs-keyword">group</span> <span class="hljs-keyword">file</span>.ToUpper() <span class="hljs-keyword">by</span> Path.GetExtension(<span class="hljs-keyword">file</span>);
</code></pre>
<ul>
<li>ูุดุงุจู <strong>select</strong>ุ <code>group</code> ฺฉ ฺฉูุฆุฑ ุฑุง ูพุงุงู ูโุฏูุฏ ูฺฏุฑ ุงูฺฉู <strong>query continuation clause</strong> ุงุถุงูู ฺฉูุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">from</span> <span class="hljs-keyword">file</span> <span class="hljs-keyword">in</span> files
<span class="hljs-keyword">group</span> <span class="hljs-keyword">file</span>.ToUpper() <span class="hljs-keyword">by</span> Path.GetExtension(<span class="hljs-keyword">file</span>) <span class="hljs-keyword">into</span> grouping
<span class="hljs-keyword">orderby</span> grouping.Key
<span class="hljs-keyword">select</span> grouping;
</code></pre>
<hr>
<h3>๐น ุงุฏุงููโ ฺฉูุฆุฑโูุง (Query Continuations)</h3>
<ul>
<li>ุงุฏุงููโ ฺฉูุฆุฑ ูพุณ ุงุฒ <strong>group by</strong> ููุฏ ุงุณุชุ ูุซูุงู ููุชุฑ ฺฉุฑุฏู ฺฏุฑููโูุง ฺฉู ฺฉูุชุฑ ุงุฒ ูพูุฌ ูุงู ุฏุงุฑูุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">from</span> <span class="hljs-keyword">file</span> <span class="hljs-keyword">in</span> files
<span class="hljs-keyword">group</span> <span class="hljs-keyword">file</span>.ToUpper() <span class="hljs-keyword">by</span> Path.GetExtension(<span class="hljs-keyword">file</span>) <span class="hljs-keyword">into</span> grouping
<span class="hljs-keyword">where</span> grouping.Count() &gt;= <span class="hljs-number">5</span>
<span class="hljs-keyword">select</span> grouping;
</code></pre>
<ul>
<li>ฺฉ <code>where</code> ูพุณ ุงุฒ <code>group by</code> ูุนุงุฏู <strong>HAVING</strong> ุฏุฑ SQL ุงุณุช.</li>
<li>ุงู ุดุฑุท ุฑู ฺฉู ุฒุฑุชูุงู ุง ฺฏุฑูู ุงุนูุงู ูโุดูุฏุ ูู ุฑู ุนูุงุตุฑ ูุฑุฏ.</li>
</ul>
<hr>
<h3>๐น ูุซุงู Aggregation</h3>
<ul>
<li>ฺฏุงู ุชููุง ุจู ูุชุฌูโ ุชุฌูุน ุฑู ฺฏุฑููโูุง ูุงุฒ ุฏุงุฑุฏ ู ูโุชูุงูุฏ ุฒุฑุชูุงูโูุง ุฑุง ูุงุฏุฏู ุจฺฏุฑุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">string</span>[] votes = { <span class="hljs-string">&quot;Dogs&quot;</span>, <span class="hljs-string">&quot;Cats&quot;</span>, <span class="hljs-string">&quot;Cats&quot;</span>, <span class="hljs-string">&quot;Dogs&quot;</span>, <span class="hljs-string">&quot;Dogs&quot;</span> };

IEnumerable&lt;<span class="hljs-built_in">string</span>&gt; query = <span class="hljs-keyword">from</span> vote <span class="hljs-keyword">in</span> votes
                            <span class="hljs-keyword">group</span> vote <span class="hljs-keyword">by</span> vote <span class="hljs-keyword">into</span> g
                            <span class="hljs-keyword">orderby</span> g.Count() <span class="hljs-keyword">descending</span>
                            <span class="hljs-keyword">select</span> g.Key;

<span class="hljs-built_in">string</span> winner = query.First();    <span class="hljs-comment">// Dogs</span>
</code></pre>
<h3>๐ GroupBy ุฏุฑ EF Core</h3>
<ul>
<li>ฺฏุฑููโุจูุฏ ุฏุฑ <strong>EF Core</strong> ุจู ููุงู ุดฺฉู ุฑู ูพุงฺฏุงู ุฏุงุฏู ุนูู ูโฺฉูุฏ.</li>
<li>ุงฺฏุฑ <strong>navigation property</strong>ูุง ุฑุง ุชูุธู ฺฉุฑุฏู ุจุงุดุฏุ ุงุบูุจ ูุงุฒ ุจู ฺฏุฑููโุจูุฏ ฺฉูุชุฑ ุงุฒ ุญุงูุช ุงุณุชุงูุฏุงุฑุฏ SQL ูพุด ูโุขุฏ.</li>
</ul>
<p>ูุซุงู: ุงูุชุฎุงุจ ูุดุชุฑุงู ฺฉู ุญุฏุงูู ุฏู ุฎุฑุฏ ุฏุงุดุชูโุงูุฏ ุจุฏูู ูุงุฒ ุจู ฺฏุฑููโุจูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> dbContext.Customers
<span class="hljs-keyword">where</span> c.Purchases.Count &gt;= <span class="hljs-number">2</span>
<span class="hljs-keyword">select</span> c.Name + <span class="hljs-string">&quot; has made &quot;</span> + c.Purchases.Count + <span class="hljs-string">&quot; purchases&quot;</span>;
</code></pre>
<ul>
<li>ูููููโุง ฺฉู ูุงุฒ ุจู ฺฏุฑููโุจูุฏ ุฏุงุฑุฏ: ูุญุงุณุจู ฺฉู ูุฑูุดโูุง ุจุฑ ุงุณุงุณ ุณุงู:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">from</span> p <span class="hljs-keyword">in</span> dbContext.Purchases
<span class="hljs-keyword">group</span> p.Price <span class="hljs-keyword">by</span> p.Date.Year <span class="hljs-keyword">into</span> salesByYear
<span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> {
    Year       = salesByYear.Key,
    TotalValue = salesByYear.Sum()
};
</code></pre>
<ul>
<li><strong>GroupBy</strong> ุฏุฑ LINQ ุงุฒ <strong>GROUP BY</strong> ุฏุฑ SQL ูุฏุฑุชููุฏุชุฑ ุงุณุชุ ุฒุฑุง ูโุชูุงูุฏ ููู ุฑุฏูโูุง ุฑุง ุจุฏูู ูฺ ุชุฌูุน ุจุงุฒุงุจ ฺฉูุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">from</span> p <span class="hljs-keyword">in</span> dbContext.Purchases
<span class="hljs-keyword">group</span> p <span class="hljs-keyword">by</span> p.Date.Year
</code></pre>
<p>โ๏ธ ุงู ุฑูุด ุฏุฑ <strong>EF Core</strong> ฺฉุงุฑ ููโฺฉูุฏ.<br>
ุฑุงูโุญู ุณุงุฏู: ูุจู ุงุฒ ฺฏุฑููโุจูุฏ <code>.AsEnumerable()</code> ูุฑุงุฎูุงู ฺฉูุฏ ุชุง ฺฏุฑููโุจูุฏ ุฑู ฺฉูุงูุช ุงูุฌุงู ุดูุฏ.</p>
<ul>
<li>
<p>ุงู ุฑูุด ุชุง ุฒูุงู ฺฉู ููุชุฑูฺฏ ูุจู ุงุฒ ฺฏุฑููโุจูุฏ ุงูุฌุงู ุดูุฏุ ฺฉุงุฑุขูุฏ ุงุณุชุ ุฒุฑุง ููุท ุฏุงุฏูโูุง ููุฑุฏ ูุงุฒ ุงุฒ ุณุฑูุฑ ูุฑุงุฎูุงู ูโุดููุฏ.</p>
</li>
<li>
<p>ุชูุงูุช ุฏฺฏุฑ ุจุง SQL: ุงูุฒุงู ุจู ูพุฑูุฌฺฉุช ฺฉุฑุฏู ูุชุบุฑูุง ุง ุนุจุงุฑุงุช ุงุณุชูุงุฏูโุดุฏู ุฏุฑ ฺฏุฑููโุจูุฏ ุง ูุฑุชุจโุณุงุฒ ูุฌูุฏ ูุฏุงุฑุฏ.</p>
</li>
</ul>
<hr>
<h3>๐น ฺฏุฑููโุจูุฏ ุจุง ฺูุฏ ฺฉูุฏ</h3>
<ul>
<li>ูโุชูุงูุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ <strong>composite key</strong> ู <strong>anonymous type</strong> ฺฏุฑููโุจูุฏ ฺฉูุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">from</span> n <span class="hljs-keyword">in</span> names
<span class="hljs-keyword">group</span> n <span class="hljs-keyword">by</span> <span class="hljs-keyword">new</span> { FirstLetter = n[<span class="hljs-number">0</span>], Length = n.Length };
</code></pre>
<hr>
<h3>๐น ููุงุณูโฺฉููุฏูโูุง ุณูุงุฑุด (Custom equality comparers)</h3>
<ul>
<li>ูโุชูุงูุฏ ฺฉ <strong>equality comparer</strong> ุณูุงุฑุด ุจู GroupBy ุจุฏูุฏ ุชุง ุงูฺฏูุฑุชู ููุงุณูโ ฺฉูุฏ ุชุบุฑ ฺฉูุฏ.</li>
<li>ุจู ูุฏุฑุช ูุงุฒู ุงุณุชุ ุฒุฑุง ุชุบุฑ ุนุจุงุฑุช <strong>key selector</strong> ูุนูููุงู ฺฉุงู ุงุณุช.</li>
<li>ูุซุงู: ฺฏุฑููโุจูุฏ ุบุฑุญุณุงุณ ุจู ุญุฑูู ุจุฒุฑฺฏ/ฺฉูฺฺฉ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">group</span> n <span class="hljs-keyword">by</span> n.ToUpper()
</code></pre>
<hr>
<h3>๐ Chunk</h3>
<pre class="hljs"><code>IEnumerable&lt;TSource&gt; โ IEnumerable&lt;TElement[]&gt;
</code></pre>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-18.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>๐ฆ Chunk</h3>
<ul>
<li>ูุนุฑูโุดุฏู ุฏุฑ <strong>.NET 6</strong>ุ <strong>Chunk</strong> ฺฉ ุชูุงู ุฑุง ุจู ุจููฺฉโูุง (chunks) ุจุง ุงูุฏุงุฒูโ ูุดุฎุต ุชูุณู ูโฺฉูุฏ (ุง ฺฉูุชุฑุ ุงฺฏุฑ ุนูุงุตุฑ ฺฉุงู ูุจุงุดูุฏ):</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">foreach</span> (<span class="hljs-built_in">int</span>[] chunk <span class="hljs-keyword">in</span> <span class="hljs-keyword">new</span>[] { <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span> }.Chunk(<span class="hljs-number">3</span>))
    Console.WriteLine(<span class="hljs-built_in">string</span>.Join(<span class="hljs-string">&quot;, &quot;</span>, chunk));
</code></pre>
<p><strong>ุฎุฑูุฌ:</strong></p>
<pre class="hljs"><code>1, 2, 3
4, 5, 6
7, 8
</code></pre>
<hr>
<h3>๐ Set Operators</h3>
<pre class="hljs"><code>IEnumerable&lt;TSource&gt;, IEnumerable&lt;TSource&gt; โ IEnumerable&lt;TSource&gt;
</code></pre>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-19.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>๐ Concat, Union, UnionBy</h3>
<ul>
<li><strong>Concat</strong> ููู ุนูุงุตุฑ ุชูุงู ุงูู ุฑุง ุจุงุฒูโฺฏุฑุฏุงูุฏุ ุณูพุณ ููู ุนูุงุตุฑ ุชูุงู ุฏูู ุฑุง ุงุถุงูู ูโฺฉูุฏ.</li>
<li><strong>Union</strong> ููุงู ฺฉุงุฑ ุฑุง ูโฺฉูุฏ ุงูุง <strong>ุชฺฉุฑุงุฑโูุง ุฑุง ุญุฐู ูโฺฉูุฏ</strong>:</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">int</span>[] seq1 = { <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span> }, seq2 = { <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span> };

IEnumerable&lt;<span class="hljs-built_in">int</span>&gt;
    concat = seq1.Concat(seq2),   <span class="hljs-comment">// { 1, 2, 3, 3, 4, 5 }</span>
    union  = seq1.Union(seq2);   <span class="hljs-comment">// { 1, 2, 3, 4, 5 }</span>
</code></pre>
<ul>
<li>ูุดุฎุต ฺฉุฑุฏู <strong>ููุน ุขุฑฺฏููุงู</strong> ููุฏ ุงุณุช ููุช ุชูุงูโูุง ููุน ูุชูุงูุช ุฏุงุฑูุฏ ูู ุนูุงุตุฑ ฺฉ <strong>base type</strong> ูุดุชุฑฺฉ ุฏุงุฑูุฏ.</li>
<li>ูุซุงู ุจุง API ุจุงุฒุชุงุจ (Reflection API): ูุชุฏูุง ู ูพุฑุงูพุฑุชโูุง ุจุง ฺฉูุงุณโูุง <code>MethodInfo</code> ู <code>PropertyInfo</code> ููุงุด ุฏุงุฏู ูโุดููุฏ ฺฉู ฺฉ ฺฉูุงุณ ูพุงู ูุดุชุฑฺฉ ุจู ูุงู <code>MemberInfo</code> ุฏุงุฑูุฏ.</li>
</ul>
<pre class="hljs"><code>MethodInfo[] methods = <span class="hljs-keyword">typeof</span>(<span class="hljs-built_in">string</span>).GetMethods();
PropertyInfo[] props = <span class="hljs-keyword">typeof</span>(<span class="hljs-built_in">string</span>).GetProperties();
IEnumerable&lt;MemberInfo&gt; both = methods.Concat&lt;MemberInfo&gt;(props);
</code></pre>
<ul>
<li>ูุซุงู ุฏฺฏุฑ: ููุชุฑ ฺฉุฑุฏู ูุชุฏูุง ูุจู ุงุฒ ุงูุญุงู:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">var</span> methods = <span class="hljs-keyword">typeof</span>(<span class="hljs-built_in">string</span>).GetMethods().Where(m =&gt; !m.IsSpecialName);
<span class="hljs-keyword">var</span> props   = <span class="hljs-keyword">typeof</span>(<span class="hljs-built_in">string</span>).GetProperties();
<span class="hljs-keyword">var</span> both    = methods.Concat&lt;MemberInfo&gt;(props);
</code></pre>
<ul>
<li>
<p>ุงู ูุซุงู ุจู <strong>interface type parameter variance</strong> ูุงุจุณุชู ุงุณุช:<br>
<code>methods</code> ุงุฒ ููุน <code>IEnumerable&lt;MethodInfo&gt;</code> ุงุณุช ู ูุงุฒ ุจู ุชุจุฏู <strong>covariant</strong> ุจู <code>IEnumerable&lt;MemberInfo&gt;</code> ุฏุงุฑุฏ.</p>
</li>
<li>
<p><strong>UnionBy</strong> (ูุนุฑู ุดุฏู ุฏุฑ .NET 6) ฺฉ <strong>keySelector</strong> ูโฺฏุฑุฏ ฺฉู ุจุฑุง ุชุนู ุชฺฉุฑุงุฑ ุจูุฏู ุนูุงุตุฑ ุงุณุชูุงุฏู ูโุดูุฏ. ูุซุงู: union ุบุฑ ุญุณุงุณ ุจู ุญุฑูู ุจุฒุฑฺฏ/ฺฉูฺฺฉ:</p>
</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">string</span>[] seq1 = { <span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;C&quot;</span> };
<span class="hljs-built_in">string</span>[] seq2 = { <span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;B&quot;</span>, <span class="hljs-string">&quot;c&quot;</span> };

<span class="hljs-keyword">var</span> union = seq1.UnionBy(seq2, x =&gt; x.ToUpperInvariant());
<span class="hljs-comment">// union is { &quot;A&quot;, &quot;b&quot;, &quot;C&quot; }</span>
</code></pre>
<ul>
<li>ุงู ฺฉุงุฑ ุจุง <strong>Union</strong> ูู ูุงุจู ุงูุฌุงู ุงุณุช ุงฺฏุฑ ฺฉ <strong>equality comparer</strong> ุจุฏูู:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">var</span> union = seq1.Union(seq2, StringComparer.InvariantCultureIgnoreCase);
</code></pre>
<hr>
<h3>๐น Intersect, IntersectBy, Except, ExceptBy</h3>
<ul>
<li><strong>Intersect</strong> ุนูุงุตุฑ ูุดุชุฑฺฉ ุจู ุฏู ุชูุงู ุฑุง ุจุงุฒูโฺฏุฑุฏุงูุฏ.</li>
<li><strong>Except</strong> ุนูุงุตุฑ ุชูุงู ุงูู ฺฉู ุฏุฑ ุชูุงู ุฏูู ูุณุชูุฏ ุฑุง ุจุงุฒูโฺฏุฑุฏุงูุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">int</span>[] seq1 = { <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span> }, seq2 = { <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span> };

IEnumerable&lt;<span class="hljs-built_in">int</span>&gt;
    commonality  = seq1.Intersect(seq2),    <span class="hljs-comment">// { 3 }</span>
    difference1  = seq1.Except(seq2),      <span class="hljs-comment">// { 1, 2 }</span>
    difference2  = seq2.Except(seq1);      <span class="hljs-comment">// { 4, 5 }</span>
</code></pre>
<ul>
<li>ูพุงุฏูโุณุงุฒ ุฏุงุฎู <strong>Enumerable.Except</strong>: ุชูุงู ุนูุงุตุฑ ุชูุงู ุงูู ุฏุฑ ฺฉ ุฏฺฉุดูุฑ ุจุงุฑฺฏุฐุงุฑ ูโุดููุฏุ ุณูพุณ ุชูุงู ุนูุงุตุฑ ููุฌูุฏ ุฏุฑ ุชูุงู ุฏูู ุงุฒ ุฏฺฉุดูุฑ ุญุฐู ูโุดููุฏ.</li>
<li>ูุนุงุฏู ุฏุฑ SQL:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">SELECT</span> number <span class="hljs-keyword">FROM</span> numbers1Table
<span class="hljs-keyword">WHERE</span> number <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">IN</span> (<span class="hljs-keyword">SELECT</span> number <span class="hljs-keyword">FROM</span> numbers2Table)
</code></pre>
<ul>
<li><strong>IntersectBy</strong> ู <strong>ExceptBy</strong> (ุงุฒ .NET 6) ุงุฌุงุฒู ูโุฏููุฏ ฺฉ <strong>key selector</strong> ูุดุฎุต ฺฉูุฏ ฺฉู ูุจู ุงุฒ ููุงุณู ุชุณุงู ุงุนูุงู ูโุดูุฏ (ูุดุงุจู UnionBy).</li>
</ul>
<hr>
<h3>๐น Conversion Methods</h3>
<ul>
<li>LINQ ุนูุฏุชุงู ุจุง ุชูุงูโูุง ฺฉุงุฑ ูโฺฉูุฏ (<code>IEnumerable&lt;T&gt;</code>).</li>
<li><strong>Conversion methods</strong> ุจุฑุง ุชุจุฏู ุจู ู ุงุฒ ุงููุงุน ุฏฺฏุฑ ูุฌููุนูโูุง ุงุณุชูุงุฏู ูโุดููุฏ.</li>
</ul>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-20.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>๐ OfType ู Cast</h3>
<ul>
<li><strong>OfType</strong> ู <strong>Cast</strong> ฺฉ ูุฌููุนู ุบุฑุฌูุฑฺฉ (<code>IEnumerable</code>) ุฑุง ูโฺฏุฑูุฏ ู ฺฉ ุชูุงู ุฌูุฑฺฉ (<code>IEnumerable&lt;T&gt;</code>) ุจุงุฒูโฺฏุฑุฏุงููุฏ ฺฉู ูโุชูุงูุฏ ุฑู ุขู ุนููุงุช LINQ ุงูุฌุงู ุฏูุฏ:</li>
</ul>
<pre class="hljs"><code>ArrayList classicList = <span class="hljs-keyword">new</span> ArrayList(); <span class="hljs-comment">// ุฏุฑ System.Collections</span>
classicList.AddRange(<span class="hljs-keyword">new</span> <span class="hljs-built_in">int</span>[] { <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span> });

IEnumerable&lt;<span class="hljs-built_in">int</span>&gt; sequence1 = classicList.Cast&lt;<span class="hljs-built_in">int</span>&gt;();
</code></pre>
<ul>
<li>
<p>ุชูุงูุช <strong>Cast</strong> ู <strong>OfType</strong> ุฒูุงู ุงุณุช ฺฉู ุจุง ุนูุตุฑ ูุงุณุงุฒฺฏุงุฑ ููุงุฌู ูโุดููุฏ:</p>
<ul>
<li><strong>Cast</strong>: ุฎุทุง ูโุฏูุฏ.</li>
<li><strong>OfType</strong>: ุนูุตุฑ ูุงุณุงุฒฺฏุงุฑ ุฑุง ูุงุฏุฏู ูโฺฏุฑุฏ.</li>
</ul>
</li>
</ul>
<p>ุงุฏุงูู ูุซุงู ุจุงูุง:</p>
<pre class="hljs"><code>DateTime offender = DateTime.Now;
classicList.Add(offender);

IEnumerable&lt;<span class="hljs-built_in">int</span>&gt;
    sequence2 = classicList.OfType&lt;<span class="hljs-built_in">int</span>&gt;(), <span class="hljs-comment">// OK - ุนูุตุฑ DateTime ูุงุฏุฏู ฺฏุฑูุชู ูโุดูุฏ</span>
    sequence3 = classicList.Cast&lt;<span class="hljs-built_in">int</span>&gt;();   <span class="hljs-comment">// ุงุณุชุซูุงุก ูโุฏูุฏ</span>
</code></pre>
<ul>
<li>ููุงูู ุณุงุฒฺฏุงุฑ ุนูุงุตุฑ ุฏููุงู ูุทุงุจู <strong>is operator</strong> ุฏุฑ C# ุงุณุช ู ุชููุง <strong>reference conversion</strong> ู <strong>unboxing conversion</strong> ุฑุง ุฏุฑ ูุธุฑ ูโฺฏุฑุฏ.</li>
</ul>
<p>ูพุงุฏูโุณุงุฒ ุฏุงุฎู <strong>OfType</strong>:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title">IEnumerable</span>&lt;<span class="hljs-title">TSource</span>&gt; <span class="hljs-title">OfType</span>&lt;<span class="hljs-title">TSource</span>&gt;(<span class="hljs-params">IEnumerable source</span>)</span>
{
    <span class="hljs-keyword">foreach</span> (<span class="hljs-built_in">object</span> element <span class="hljs-keyword">in</span> source)
        <span class="hljs-keyword">if</span> (element <span class="hljs-keyword">is</span> TSource)
            <span class="hljs-function"><span class="hljs-keyword">yield</span> <span class="hljs-title">return</span> (<span class="hljs-params">TSource</span>)element</span>;
}
</code></pre>
<p>ูพุงุฏูโุณุงุฒ <strong>Cast</strong> ูุดุงุจู ุงุณุช ูู ุชุณุช ุณุงุฒฺฏุงุฑ ููุน ุฑุง ุงูุฌุงู ููโุฏูุฏ:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title">IEnumerable</span>&lt;<span class="hljs-title">TSource</span>&gt; <span class="hljs-title">Cast</span>&lt;<span class="hljs-title">TSource</span>&gt;(<span class="hljs-params">IEnumerable source</span>)</span>
{
    <span class="hljs-keyword">foreach</span> (<span class="hljs-built_in">object</span> element <span class="hljs-keyword">in</span> source)
        <span class="hljs-function"><span class="hljs-keyword">yield</span> <span class="hljs-title">return</span> (<span class="hljs-params">TSource</span>)element</span>;
}
</code></pre>
<ul>
<li>ูุชุฌู: ููโุชูุงูุฏ ุงุฒ <strong>Cast</strong> ุจุฑุง ุชุจุฏูโูุง ุนุฏุฏ ุง ุณูุงุฑุด ุงุณุชูุงุฏู ฺฉูุฏ. ุจุฑุง ุงู ฺฉุงุฑ ุจุงุฏ ุงุฒ <strong>Select</strong> ุงุณุชูุงุฏู ฺฉูุฏ.</li>
</ul>
<p>ูุซุงู:</p>
<pre class="hljs"><code><span class="hljs-built_in">int</span>[] integers = { <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span> };

IEnumerable&lt;<span class="hljs-built_in">long</span>&gt; test1 = integers.OfType&lt;<span class="hljs-built_in">long</span>&gt;(); <span class="hljs-comment">// ุตูุฑ ุนูุตุฑ</span>
IEnumerable&lt;<span class="hljs-built_in">long</span>&gt; test2 = integers.Cast&lt;<span class="hljs-built_in">long</span>&gt;();   <span class="hljs-comment">// ุงุณุชุซูุงุก ูโุฏูุฏ</span>
</code></pre>
<ul>
<li>
<p>ุฏูู:</p>
<ul>
<li>ุฏุฑ <strong>OfType</strong>: <code>(element is long)</code> ุจุฑุง int ููุดู false ุงุณุช.</li>
<li>ุฏุฑ <strong>Cast</strong>: ููุช <code>TSource</code> ฺฉ value type ุงุณุชุ CLR ุขู ุฑุง unboxing ูุฑุถ ูโฺฉูุฏุ ฺฉู ูุงุฒ ุจู ุชุทุงุจู ุฏูู ููุน ุฏุงุฑุฏุ ูพุณ ุฎุทุง ุฑุฎ ูโุฏูุฏ.</li>
</ul>
</li>
</ul>
<p>ุฑุงูโุญู: ุงุณุชูุงุฏู ุงุฒ <strong>Select</strong>:</p>
<pre class="hljs"><code>IEnumerable&lt;<span class="hljs-built_in">long</span>&gt; castLong = integers.Select(s =&gt; (<span class="hljs-built_in">long</span>)s);
</code></pre>
<ul>
<li>
<p><strong>OfType</strong> ู <strong>Cast</strong> ุจุฑุง <strong>downcasting</strong> ุนูุงุตุฑ ุฏุฑ ฺฉ ุชูุงู ุฌูุฑฺฉ ูุฒ ููุฏ ูุณุชูุฏ. ูุซุงู:</p>
<ul>
<li>ุงฺฏุฑ ุชูุงู ุดูุง <code>IEnumerable&lt;Fruit&gt;</code> ุจุงุดุฏุ <code>OfType&lt;Apple&gt;</code> ููุท ุณุจโูุง ุฑุง ุจุงุฒูโฺฏุฑุฏุงูุฏ.</li>
<li>ฺฉุงุฑุจุฑุฏ ูฺู ุฏุฑ <strong>LINQ to XML</strong> ุฏุงุฑุฏ (ูุตู ฑฐ).</li>
</ul>
</li>
<li>
<p><strong>Cast</strong> ุงุฒ <strong>query syntax</strong> ูุฒ ูพุดุชุจุงู ูโฺฉูุฏ: ฺฉุงูุณุช ููุน ุฑุง ูุจู ุงุฒ ูุชุบุฑ ูุญุฏูุฏู ูุดุฎุต ฺฉูุฏ:</p>
</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">from</span> TreeNode node <span class="hljs-keyword">in</span> myTreeView.Nodes
...
</code></pre>
<hr>
<h3>๐ข ToArray, ToList, ToDictionary, ToHashSet, ToLookup</h3>
<ul>
<li><strong>ToArray</strong>, <strong>ToList</strong>, ู <strong>ToHashSet</strong> ูุชุงุฌ ุฑุง ุฏุฑ ฺฉ <strong>array</strong>ุ <strong>List<T></strong> ุง <strong>HashSet<T></strong> ูุฑุงุฑ ูโุฏููุฏ.</li>
<li>ุงุฌุฑุง ุขูโูุง ููุฌุจ <strong>enumeration ููุฑ</strong> ุชูุงู ูุฑูุฏ ูโุดูุฏ (ูุฑุงุฌุนู ฺฉูุฏ ุจู โDeferred Executionโุ ุตูุญู ดณฒ).</li>
<li><strong>ToDictionary</strong> ู <strong>ToLookup</strong> ุขุฑฺฏููุงูโูุง ุฒุฑ ุฑุง ูโูพุฐุฑูุฏ:</li>
</ul>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-21.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>๐ก ToDictionary ู ToLookup</h3>
<ul>
<li><strong>ToDictionary</strong> ูุฒ ุงุฌุฑุง ููุฑ (immediate execution) ุชูุงู ุฑุง ูุฌุจูุฑ ูโฺฉูุฏ ู ูุชุงุฌ ุฑุง ุฏุฑ ฺฉ <strong>Dictionary&lt;TK, TV&gt;</strong> ูุฑุงุฑ ูโุฏูุฏ.</li>
<li><strong>keySelector</strong> ุงุฑุงุฆูโุดุฏู ุจุงุฏ ุจุฑุง ูุฑ ุนูุตุฑ ููุฏุงุฑ <strong>ููุญุตุฑ ุจู ูุฑุฏ</strong> ุชููุฏ ฺฉูุฏุ ุฏุฑ ุบุฑ ุงู ุตูุฑุช <strong>ุงุณุชุซูุงุก</strong> ุฑุฎ ูโุฏูุฏ.</li>
<li>ุฏุฑ ููุงุจูุ <strong>ToLookup</strong> ุงุฌุงุฒู ูโุฏูุฏ ฺูุฏู ุนูุตุฑ ุจุง ููุงู ฺฉูุฏ ูุฌูุฏ ุฏุงุดุชู ุจุงุดูุฏ.</li>
<li>ุจุฑุง ุชูุถุญุงุช ุจุดุชุฑ ุฏุฑุจุงุฑู <strong>lookups</strong>ุ ุจู ุจุฎุด โJoining with lookupsโ ุตูุญู ดนธ ูุฑุงุฌุนู ฺฉูุฏ.</li>
</ul>
<hr>
<h3>๐น AsEnumerable ู AsQueryable</h3>
<ul>
<li><strong>AsEnumerable</strong> ฺฉ ุชูุงู ุฑุง ุจู <code>IEnumerable&lt;T&gt;</code> <strong>upcast</strong> ูโฺฉูุฏ ู ุจุงุนุซ ูโุดูุฏ ฺฉุงููพุงูุฑ ุงูพุฑุงุชูุฑูุง ุจุนุฏ ุฑุง ุจู ูุชุฏูุง <strong>Enumerable</strong> ูุตู ฺฉูุฏ ูู <strong>Queryable</strong>.</li>
<li>ูุซุงู: ุจุฎุด โCombining Interpreted and Local Queriesโุ ุตูุญู ดตฒ.</li>
<li><strong>AsQueryable</strong> ฺฉ ุชูุงู ุฑุง ุจู <code>IQueryable&lt;T&gt;</code> <strong>downcast</strong> ูโฺฉูุฏ ุงฺฏุฑ ุงูุชุฑูุณ ุฑุง ูพุงุฏูโุณุงุฒ ฺฉูุฏุ ุฏุฑ ุบุฑ ุงู ุตูุฑุชุ ฺฉ wrapper <code>IQueryable&lt;T&gt;</code> ุฑู ุชูุงู ูุญู ูโุณุงุฒุฏ.</li>
</ul>
<hr>
<h3>๐น Element Operators</h3>
<pre class="hljs"><code>IEnumerable&lt;TSource&gt; โ TSource
</code></pre>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-22.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>โก Methods ending in โOrDefaultโ</h3>
<ul>
<li>ูุชุฏูุง ฺฉู ุจุง <strong>OrDefault</strong> ูพุงุงู ูโุงุจูุฏุ ุจู ุฌุง ูพุฑุชุงุจ <strong>exception</strong> ููุช ุชูุงู ูุฑูุฏ ุฎุงู ุงุณุช ุง ูฺ ุนูุตุฑ ุจุง ุดุฑุท ุฏุงุฏู ุดุฏู ูุทุงุจูุช ูุฏุงุฑุฏุ ููุฏุงุฑ <strong>default(TSource)</strong> ุจุงุฒูโฺฏุฑุฏุงููุฏ.</li>
<li>ููุฏุงุฑ <strong>default(TSource)</strong> ุจุฑุง ุงููุงุน ูุฑุฌุน (<strong>reference types</strong>) ุจุฑุงุจุฑ <code>null</code>ุ ุจุฑุง ููุน <code>bool</code> ุจุฑุงุจุฑ <code>false</code> ู ุจุฑุง ุงููุงุน ุนุฏุฏ ุจุฑุงุจุฑ ุตูุฑ ุงุณุช.</li>
</ul>
<hr>
<h3>๐น First, Last, and Single</h3>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-23.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>๐น First ู Last</h3>
<p>ูุซุงู ุฒุฑ <strong>First</strong> ู <strong>Last</strong> ุฑุง ูุดุงู ูโุฏูุฏ:</p>
<pre class="hljs"><code><span class="hljs-built_in">int</span>[] numbers  = { <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span> };
<span class="hljs-built_in">int</span> first      = numbers.First();                     <span class="hljs-comment">// 1</span>
<span class="hljs-built_in">int</span> last       = numbers.Last();                      <span class="hljs-comment">// 5</span>
<span class="hljs-built_in">int</span> firstEven  = numbers.First(n =&gt; n % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>);     <span class="hljs-comment">// 2</span>
<span class="hljs-built_in">int</span> lastEven   = numbers.Last(n =&gt; n % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>);      <span class="hljs-comment">// 4</span>
</code></pre>
<p>ูุซุงู <strong>First</strong> ุฏุฑ ููุงุจู <strong>FirstOrDefault</strong>:</p>
<pre class="hljs"><code><span class="hljs-built_in">int</span> firstBigError  = numbers.First(n =&gt; n &gt; <span class="hljs-number">10</span>);      <span class="hljs-comment">// Exception</span>
<span class="hljs-built_in">int</span> firstBigNumber = numbers.FirstOrDefault(n =&gt; n &gt; <span class="hljs-number">10</span>); <span class="hljs-comment">// 0</span>
</code></pre>
<hr>
<h3>๐น Single ู SingleOrDefault</h3>
<ul>
<li><strong>Single</strong> ูุงุฒ ุฏุงุฑุฏ ฺฉู <strong>ุฏููุง ฺฉ ุนูุตุฑ</strong> ุจุง ุดุฑุท ุฏุงุฏู ุดุฏู ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ.</li>
<li><strong>SingleOrDefault</strong> ุงุฌุงุฒู ูโุฏูุฏ <strong>ุตูุฑ ุง ฺฉ ุนูุตุฑ</strong> ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ.</li>
</ul>
<p>ูุซุงูโูุง:</p>
<pre class="hljs"><code><span class="hljs-built_in">int</span> onlyDivBy3 = numbers.Single(n =&gt; n % <span class="hljs-number">3</span> == <span class="hljs-number">0</span>);      <span class="hljs-comment">// 3</span>
<span class="hljs-built_in">int</span> divBy2Err  = numbers.Single(n =&gt; n % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>);      <span class="hljs-comment">// ุฎุทุง: 2 ู 4 ูุทุงุจูุช ุฏุงุฑูุฏ</span>
<span class="hljs-built_in">int</span> singleError = numbers.Single(n =&gt; n &gt; <span class="hljs-number">10</span>);         <span class="hljs-comment">// ุฎุทุง</span>
<span class="hljs-built_in">int</span> noMatches   = numbers.SingleOrDefault(n =&gt; n &gt; <span class="hljs-number">10</span>); <span class="hljs-comment">// 0</span>
<span class="hljs-built_in">int</span> divBy2Error = numbers.SingleOrDefault(n =&gt; n % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>); <span class="hljs-comment">// ุฎุทุง</span>
</code></pre>
<ul>
<li>
<p><strong>Single</strong> ุณุฎุชโฺฏุฑุชุฑู ุนุถู ุฎุงููุงุฏู element operators ุงุณุช.</p>
</li>
<li>
<p><strong>FirstOrDefault</strong> ู <strong>LastOrDefault</strong> ุจุดุชุฑู ุชุญูู ุฑุง ุฏุงุฑูุฏ.</p>
</li>
<li>
<p>ุฏุฑ <strong>EF Core</strong>ุ <strong>Single</strong> ุงุบูุจ ุจุฑุง ูุงฺฉุด ฺฉ ุฑุฏู ุงุฒ ุฌุฏูู ุจุฑ ุงุณุงุณ <strong>primary key</strong> ุงุณุชูุงุฏู ูโุดูุฏ:</p>
</li>
</ul>
<pre class="hljs"><code>Customer cust = dataContext.Customers.Single(c =&gt; c.ID == <span class="hljs-number">3</span>);
</code></pre>
<hr>
<h3>๐น ElementAt</h3>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-24.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>๐น ElementAt ู ElementAtOrDefault</h3>
<ul>
<li><strong>ElementAt</strong> ุนูุตุฑ nุงู ุชูุงู ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">int</span>[] numbers  = { <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span> };
<span class="hljs-built_in">int</span> third      = numbers.ElementAt(<span class="hljs-number">2</span>);          <span class="hljs-comment">// 3</span>
<span class="hljs-built_in">int</span> tenthError = numbers.ElementAt(<span class="hljs-number">9</span>);          <span class="hljs-comment">// Exception</span>
<span class="hljs-built_in">int</span> tenth      = numbers.ElementAtOrDefault(<span class="hljs-number">9</span>); <span class="hljs-comment">// 0</span>
</code></pre>
<ul>
<li>ุงฺฏุฑ ุชูุงู ูุฑูุฏ <strong>IList<T></strong> ุจุงุดุฏุ <strong>ElementAt</strong> ุงุฒ indexer ุขู ุงุณุชูุงุฏู ูโฺฉูุฏุ ุฏุฑ ุบุฑ ุงู ุตูุฑุชุ n ุจุงุฑ ุดูุงุฑุด ูโฺฉูุฏ ู ุณูพุณ ุนูุตุฑ ุจุนุฏ ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ.</li>
<li><strong>ElementAt</strong> ุฏุฑ <strong>EF Core</strong> ูพุดุชุจุงู ููโุดูุฏ.</li>
</ul>
<hr>
<h3>๐น MinBy ู MaxBy</h3>
<ul>
<li>ูุนุฑูโุดุฏู ุฏุฑ <strong>.NET 6</strong>ุ <strong>MinBy</strong> ู <strong>MaxBy</strong> ุนูุตุฑ ุจุง ฺฉูฺฺฉโุชุฑู ุง ุจุฒุฑฺฏโุชุฑู ููุฏุงุฑ (ุจุฑ ุงุณุงุณ <strong>keySelector</strong>) ุฑุง ุจุฑูโฺฏุฑุฏุงููุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">string</span>[] names = { <span class="hljs-string">&quot;Tom&quot;</span>, <span class="hljs-string">&quot;Dick&quot;</span>, <span class="hljs-string">&quot;Harry&quot;</span>, <span class="hljs-string">&quot;Mary&quot;</span>, <span class="hljs-string">&quot;Jay&quot;</span> };
Console.WriteLine(names.MaxBy(n =&gt; n.Length));   <span class="hljs-comment">// Harry</span>
</code></pre>
<ul>
<li>ุฏุฑ ููุงุจูุ <strong>Min</strong> ู <strong>Max</strong> ุฎูุฏ <strong>ููุฏุงุฑ ฺฉูฺฺฉโุชุฑู ุง ุจุฒุฑฺฏโุชุฑู</strong> ุฑุง ุจุฑูโฺฏุฑุฏุงููุฏ:</li>
</ul>
<pre class="hljs"><code>Console.WriteLine(names.Max(n =&gt; n.Length));    <span class="hljs-comment">// 5</span>
</code></pre>
<ul>
<li>ุงฺฏุฑ ุฏู ุง ฺูุฏ ุนูุตุฑ ููุฏุงุฑ ุญุฏุงูู/ุญุฏุงฺฉุซุฑ ฺฉุณุงู ุฏุงุดุชู ุจุงุดูุฏุ <strong>MinBy/MaxBy</strong> ุงููู ุนูุตุฑ ุฑุง ุจุงุฒูโฺฏุฑุฏุงููุฏ:</li>
</ul>
<pre class="hljs"><code>Console.WriteLine(names.MinBy(n =&gt; n.Length));  <span class="hljs-comment">// Tom</span>
</code></pre>
<ul>
<li>ุงฺฏุฑ ุชูุงู ุฎุงู ุจุงุดุฏุ <strong>MinBy</strong> ู <strong>MaxBy</strong> ููุฏุงุฑ <strong>null</strong> ุจุฑูโฺฏุฑุฏุงููุฏ ุงฺฏุฑ ููุน ุนูุตุฑ nullable ุจุงุดุฏุ ุฏุฑ ุบุฑ ุงู ุตูุฑุช ุงุณุชุซูุงุก ุฑุฎ ูโุฏูุฏ.</li>
</ul>
<hr>
<h3>๐น DefaultIfEmpty</h3>
<ul>
<li><strong>DefaultIfEmpty</strong> ุชูุงูโุง ุจุง ฺฉ ุนูุตุฑ ุดุงูู <strong>default(TSource)</strong> ุจุฑูโฺฏุฑุฏุงูุฏ ุงฺฏุฑ ุชูุงู ูุฑูุฏ ุฎุงู ุจุงุดุฏุ ุฏุฑ ุบุฑ ุงู ุตูุฑุช ุชูุงู ูุฑูุฏ ุฑุง ุจุฏูู ุชุบุฑ ุจุงุฒูโฺฏุฑุฏุงูุฏ.</li>
<li>ุงู ูุชุฏ ุฏุฑ ููุดุชู <strong>flat outer joins</strong> ฺฉุงุฑุจุฑุฏ ุฏุงุฑุฏ: ุจุฎุดโูุง โOuter joins with SelectManyโ ุตูุญู ดนฑ ู โFlat outer joinsโ ุตูุญู ดนท.</li>
</ul>
<hr>
<h3>๐น Aggregation Methods</h3>
<pre class="hljs"><code>IEnumerable&lt;TSource&gt; โ scalar
</code></pre>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-25.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>๐น Count ู LongCount</h3>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-26.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<ul>
<li><strong>Count</strong> ุจู ุณุงุฏฺฏ ุชูุงู ุฑุง ุดูุงุฑุด ูโฺฉูุฏ ู ุชุนุฏุงุฏ ุนูุงุตุฑ ุฑุง ุจุงุฒูโฺฏุฑุฏุงูุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">int</span> fullCount = <span class="hljs-keyword">new</span> <span class="hljs-built_in">int</span>[] { <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span> }.Count();   <span class="hljs-comment">// 3</span>
</code></pre>
<ul>
<li>
<p>ูพุงุฏูโุณุงุฒ ุฏุงุฎู <strong>Enumerable.Count</strong> ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ุขุง ุชูุงู ูุฑูุฏ <strong>ICollection<T></strong> ุฑุง ูพุงุฏูโุณุงุฒ ฺฉุฑุฏู ุงุณุช ุง ุฎุฑ.</p>
<ul>
<li>ุงฺฏุฑ ูพุงุฏูโุณุงุฒ ุดุฏู ุจุงุดุฏุ ูุณุชููุงู ุงุฒ <strong>ICollection<T>.Count</strong> ุงุณุชูุงุฏู ูโฺฉูุฏ.</li>
<li>ุฏุฑ ุบุฑ ุงู ุตูุฑุชุ ูุฑ ุนูุตุฑ ุฑุง ุดูุงุฑุด ูโฺฉูุฏ ู ฺฉ ุดูุงุฑูุฏู ุฑุง ุงูุฒุงุด ูโุฏูุฏ.</li>
</ul>
</li>
<li>
<p>ูโุชูุงู ฺฉ <strong>predicate</strong> ูู ุงุฑุงุฆู ุฏุงุฏ ุชุง ููุท ุนูุงุตุฑ ูุทุงุจู ุดุฑุท ุดูุงุฑุด ุดููุฏ:</p>
</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">int</span> digitCount = <span class="hljs-string">&quot;pa55w0rd&quot;</span>.Count(c =&gt; <span class="hljs-built_in">char</span>.IsDigit(c));   <span class="hljs-comment">// 3</span>
</code></pre>
<ul>
<li><strong>LongCount</strong> ููุงู ฺฉุงุฑ <strong>Count</strong> ุฑุง ุงูุฌุงู ูโุฏูุฏ ุงูุง ูุชุฌู ุฑุง ุจู ุตูุฑุช <strong>int64 (long)</strong> ุจุฑูโฺฏุฑุฏุงูุฏ ู ููุงุณุจ ุชูุงูโูุง ุจุง ุจุด ุงุฒ ุฏู ููุงุฑุฏ ุนูุตุฑ ุงุณุช.</li>
</ul>
<hr>
<h3>๐น Min ู Max</h3>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-27.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<ul>
<li><strong>Min</strong> ู <strong>Max</strong> ฺฉูฺฺฉโุชุฑู ุง ุจุฒุฑฺฏโุชุฑู ุนูุตุฑ ฺฉ ุชูุงู ุฑุง ุจุฑูโฺฏุฑุฏุงููุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">int</span>[] numbers = { <span class="hljs-number">28</span>, <span class="hljs-number">32</span>, <span class="hljs-number">14</span> };
<span class="hljs-built_in">int</span> smallest = numbers.Min();  <span class="hljs-comment">// 14</span>
<span class="hljs-built_in">int</span> largest  = numbers.Max();  <span class="hljs-comment">// 32</span>
</code></pre>
<ul>
<li>ุงฺฏุฑ ฺฉ <strong>selector</strong> ุงุฑุงุฆู ุฏูุฏุ ูุฑ ุนูุตุฑ ุงุจุชุฏุง ุจู ุตูุฑุช ุฏูุฎูุงู ุชุจุฏู ูโุดูุฏ ู ุณูพุณ ููุงุณู ุงูุฌุงู ูโุดูุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">int</span> smallestMod = numbers.Max(n =&gt; n % <span class="hljs-number">10</span>);  <span class="hljs-comment">// 8</span>
</code></pre>
<ul>
<li>ุงฺฏุฑ ุนูุงุตุฑ ุฎูุฏุดุงู ูุงุจู ููุงุณู ูุจุงุดูุฏ (<strong>IComparable<T></strong> ูพุงุฏูโุณุงุฒ ูฺฉุฑุฏู ุจุงุดูุฏ)ุ ุงุฑุงุฆู <strong>selector</strong> ุงูุฒุงู ุงุณุช:</li>
</ul>
<pre class="hljs"><code>Purchase runtimeError = dbContext.Purchases.Min();             <span class="hljs-comment">// ุฎุทุง</span>
<span class="hljs-built_in">decimal</span>? lowestPrice = dbContext.Purchases.Min(p =&gt; p.Price);  <span class="hljs-comment">// ุตุญุญ</span>
</code></pre>
<ul>
<li><strong>Selector</strong> ุชุนู ูโฺฉูุฏ ฺฉู ฺฺฏููู ุนูุงุตุฑ ููุงุณู ุดููุฏ ู ููฺูู ููุน ูุชุฌู ููุง ฺุณุช. ุฏุฑ ูุซุงู ุจุงูุงุ ูุชุฌู ููุง <strong>decimal</strong> ุงุณุช ูู ุดุก <strong>Purchase</strong>.</li>
<li>ุจุฑุง ุจู ุฏุณุช ุขูุฑุฏู ุงุฑุฒุงูโุชุฑู ุฎุฑุฏุ ุจุงุฏ ุงุฒ <strong>subquery</strong> ุงุณุชูุงุฏู ฺฉูุฏ:</li>
</ul>
<pre class="hljs"><code>Purchase cheapest = dbContext.Purchases
    .Where(p =&gt; p.Price == dbContext.Purchases.Min(p2 =&gt; p2.Price))
    .FirstOrDefault();
</code></pre>
<ul>
<li>ุฏุฑ ุงู ุญุงูุช ูโุชูุงู ุจุฏูู ุงุณุชูุงุฏู ุงุฒ ุชุฌูุน (<strong>aggregation</strong>) ูุฒ ูพุฑุณโูุฌู ุฑุง ุจุง <strong>OrderBy</strong> ู ุณูพุณ <strong>FirstOrDefault</strong> ููุดุช.</li>
</ul>
<hr>
<h3>๐น Sum ู Average</h3>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-28.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<ul>
<li><strong>Sum</strong> ู <strong>Average</strong> ุงูพุฑุงุชูุฑูุง ุชุฌูุน (<strong>aggregation</strong>) ูุณุชูุฏ ู ุจู ุดฺฉู ูุดุงุจู ุจุง <strong>Min</strong> ู <strong>Max</strong> ุงุณุชูุงุฏู ูโุดููุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">decimal</span>[] numbers  = { <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span> };
<span class="hljs-built_in">decimal</span> sumTotal   = numbers.Sum();     <span class="hljs-comment">// 15</span>
<span class="hljs-built_in">decimal</span> average    = numbers.Average(); <span class="hljs-comment">// 5  (ูุงูฺฏู)</span>
</code></pre>
<ul>
<li>ูุซุงู ุฏฺฏุฑ: ูุฌููุน ุทูู ุฑุดุชูโูุง ุฏุฑ ุขุฑุงู <strong>names</strong>:</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">int</span> combinedLength = names.Sum(s =&gt; s.Length);   <span class="hljs-comment">// 19</span>
</code></pre>
<ul>
<li><strong>Sum</strong> ู <strong>Average</strong> ูุญุฏูุฏุชโูุง ุฏุฑ ููุน ุฏุงุฏู ุฏุงุฑูุฏ ู ููุท ุจุฑุง ุงููุงุน ุนุฏุฏ (int, long, float, double, decimal ู ูุณุฎู nullable ุขููุง) ุชุนุฑู ุดุฏูโุงูุฏ.</li>
<li>ุฏุฑ ููุงุจูุ <strong>Min</strong> ู <strong>Max</strong> ูโุชูุงููุฏ ุฑู ูุฑ ฺุฒ ฺฉู <strong>IComparable<T></strong> ุฑุง ูพุงุฏูโุณุงุฒ ฺฉุฑุฏู ุจุงุดุฏุ ูุงููุฏ ุฑุดุชูโูุงุ ุนูู ฺฉููุฏ.</li>
<li>ููฺููุ <strong>Average</strong> ููุดู ูุชุฌูโุง ุงุฒ ููุน <strong>decimal</strong>ุ <strong>float</strong> ุง <strong>double</strong> ุจุฑูโฺฏุฑุฏุงูุฏุ ูุทุงุจู ุฌุฏูู ุฒุฑ:</li>
</ul>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-29.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>๐น Aggregate ู ูุณุงุฆู ูุฑุชุจุท</h3>
<ul>
<li><strong>Average</strong> ุจูโุทูุฑ ุถูู ููุงุฏุฑ ูุฑูุฏ ุฑุง ุงุฑุชูุง ูโุฏูุฏ ุชุง ุงุฒ ุฏุณุช ุฑูุชู ุฏูุช ุฌููฺฏุฑ ุดูุฏ. ุจู ููู ุฏูู ูุซุงู ุฒุฑ ฺฉุงููพุงู ููโุดูุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">int</span> avg = <span class="hljs-keyword">new</span> <span class="hljs-built_in">int</span>[] { <span class="hljs-number">3</span>, <span class="hljs-number">4</span> }.Average(); <span class="hljs-comment">// ุฎุทุง: cannot convert double to int</span>
</code></pre>
<ul>
<li>ุงูุง ุงู ููููู ฺฉุงููพุงู ูโุดูุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">double</span> avg = <span class="hljs-keyword">new</span> <span class="hljs-built_in">int</span>[] { <span class="hljs-number">3</span>, <span class="hljs-number">4</span> }.Average(); <span class="hljs-comment">// 3.5</span>
</code></pre>
<ul>
<li>ุงฺฏุฑ ูุงุฒ ุจุงุดุฏุ ูโุชูุงูู ุนูุตุฑ ูุฑูุฏ ุฑุง ุจู ุตุฑุงุญุช ุชุจุฏู ฺฉูู:</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">double</span> avg = numbers.Average(n =&gt; (<span class="hljs-built_in">double</span>)n);
</code></pre>
<ul>
<li>ููฺฏุงู ฺฉูุฆุฑ ุฒุฏู ุจู ูพุงฺฏุงู ุฏุงุฏูุ <strong>Sum</strong> ู <strong>Average</strong> ุจู ุนููุงุช ุชุฌูุน ุงุณุชุงูุฏุงุฑุฏ SQL ุชุฑุฌูู ูโุดููุฏ. ูุซุงู:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> dbContext.Customers
<span class="hljs-keyword">where</span> c.Purchases.Average(p =&gt; p.Price) &gt; <span class="hljs-number">500</span>
<span class="hljs-keyword">select</span> c.Name;
</code></pre>
<hr>
<h3>๐น Aggregate</h3>
<ul>
<li><strong>Aggregate</strong> ุงุฌุงุฒู ูโุฏูุฏ ุงูฺฏูุฑุชู ุชุฌูุน ุณูุงุฑุด ุฎูุฏ ุฑุง ูพุงุฏูโุณุงุฒ ฺฉูุฏ. ุงู ูุชุฏ ุฏุฑ EF Core ูพุดุชุจุงู ููโุดูุฏ ู ฺฉุงุฑุจุฑุฏ ุขู ุฏุฑ ููุงุฑุฏ ุฎุงุต ุงุณุช. ูุซุงู ูุดุงุจู ุจุง <strong>Sum</strong>:</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">int</span>[] numbers = { <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span> };
<span class="hljs-built_in">int</span> sum = numbers.Aggregate(<span class="hljs-number">0</span>, (total, n) =&gt; total + n); <span class="hljs-comment">// 6</span>
</code></pre>
<ul>
<li>
<p>ูพุงุฑุงูุชุฑ ุงูู (<strong>seed</strong>) ููุทู ุดุฑูุน ุชุฌูุน ุงุณุช ู ูพุงุฑุงูุชุฑ ุฏูู ุงูฺฏูุฑุชู ุจูโุฑูุฒุฑุณุงู ููุฏุงุฑ ุชุฌูุน ุจุง ุฏุฑุงูุช ูุฑ ุนูุตุฑ ุฌุฏุฏ ุงุณุช.</p>
</li>
<li>
<p>ูโุชูุงู ูพุงุฑุงูุชุฑ ุณูู ุฑุง ูู ุงุฑุงุฆู ุฏุงุฏ ุชุง ูุชุฌู ููุง ุงุฒ ููุฏุงุฑ ุชุฌูุน ุงุณุชุฎุฑุงุฌ ุดูุฏ.</p>
</li>
<li>
<p>ุงฺฉุซุฑ ููุงุฑุฏ ุงุณุชูุงุฏู <strong>Aggregate</strong> ูโุชูุงููุฏ ุจุง ฺฉ ุญููู <strong>foreach</strong> ุณุงุฏู ุญู ุดููุฏุ ุงูุง ูุฒุช <strong>Aggregate</strong> ุฏุฑ ุนููุงุชโูุง ูพฺุฏู ุง ุจุฒุฑฺฏ ุงู ุงุณุช ฺฉู ุจุง <strong>PLINQ</strong> ูโุชูุงู ุจูโุตูุฑุช ููุงุฒ ุงุฌุฑุง ฺฉุฑุฏ.</p>
</li>
</ul>
<hr>
<h3>๐น ุชุฌูุน ุจุฏูู Seed</h3>
<ul>
<li>ูโุชูุงู <strong>seed</strong> ุฑุง ุญุฐู ฺฉุฑุฏ. ุฏุฑ ุงู ุญุงูุชุ ุนูุตุฑ ุงูู ุจูโุตูุฑุช ุถูู <strong>seed</strong> ุดุฏู ู ุชุฌูุน ุงุฒ ุนูุตุฑ ุฏูู ุขุบุงุฒ ูโุดูุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">int</span>[] numbers = { <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span> };
<span class="hljs-built_in">int</span> sum = numbers.Aggregate((total, n) =&gt; total + n); <span class="hljs-comment">// 6</span>
</code></pre>
<ul>
<li>ูุซุงู ุฏฺฏุฑ ุจุง ุถุฑุจ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">int</span>[] numbers = { <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span> };
<span class="hljs-built_in">int</span> x = numbers.Aggregate(<span class="hljs-number">0</span>, (prod, n) =&gt; prod * n); <span class="hljs-comment">// 0*1*2*3 = 0</span>
<span class="hljs-built_in">int</span> y = numbers.Aggregate((prod, n) =&gt; prod * n);   <span class="hljs-comment">// 1*2*3 = 6</span>
</code></pre>
<ul>
<li>ุชุฌูุน ุจุฏูู <strong>seed</strong> ูุฒุช ุงุฌุฑุง ููุงุฒ ุจุฏูู overload ุฎุงุต ุฑุง ุฏุงุฑุฏุ ุงูุง ูฺฉุงุช ุฎุทุฑูุงฺฉ ูุฒ ุฏุงุฑุฏ.</li>
</ul>
<hr>
<h3>โ๏ธ ูุดฺฉูุงุช ุชุฌูุน ุจุฏูู Seed</h3>
<ul>
<li>ุชูุงุจุน ุบุฑ ุฌุงุจุฌุง ู ุบุฑ ุชุฑฺฉุจ (<strong>non-commutative / non-associative</strong>) ูโุชูุงููุฏ ูุชุงุฌ ุบุฑููุชุธุฑู ุง ุบุฑูุทุน ุชููุฏ ฺฉููุฏ.</li>
<li>ูุซุงู:</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">int</span>[] numbers = { <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span> };
<span class="hljs-built_in">int</span> sum = numbers.Aggregate((total, n) =&gt; total + n * n); <span class="hljs-comment">// 27</span>
</code></pre>
<ul>
<li>
<p>ุจู ุฌุง ูุญุงุณุจู ุตุญุญ ฒ<em>ฒ + ณ</em>ณ + ด*ด = ฒนุ ููุฏุงุฑ ฒท ูุญุงุณุจู ุดุฏ.</p>
</li>
<li>
<p>ุฑุงู ุญูโูุง:</p>
<ol>
<li>ุชุจุฏู ุจู ุชุฌูุน ุจุง <strong>seed</strong>:</li>
</ol>
</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">int</span>[] numbers = { <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span> };
</code></pre>
<ol start="2">
<li>ุจุงุฒููุณ ุชุงุจุน ุชุฌูุน ุจู ุตูุฑุช ุฌุงุจุฌุง ู ุชุฑฺฉุจ:</li>
</ol>
<pre class="hljs"><code><span class="hljs-built_in">int</span> sum = numbers.Select(n =&gt; n * n).Aggregate((total, n) =&gt; total + n);
</code></pre>
<ul>
<li>ุฏุฑ ุณูุงุฑููุง ุณุงุฏูุ ุจูุชุฑ ุงุณุช ุงุฒ <strong>Sum</strong> ู <strong>Average</strong> ุงุณุชูุงุฏู ุดูุฏ. ูุซุงู ูุญุงุณุจู <strong>Root-Mean-Square</strong>:</li>
</ul>
<pre class="hljs"><code>Math.Sqrt(numbers.Average(n =&gt; n * n));
</code></pre>
<ul>
<li>ูุซุงู ูุญุงุณุจู ุงูุญุฑุงู ูุนุงุฑ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">double</span> mean = numbers.Average();
<span class="hljs-built_in">double</span> sdev = Math.Sqrt(numbers.Average(n =&gt; {
    <span class="hljs-built_in">double</span> dif = n - mean;
    <span class="hljs-keyword">return</span> dif * dif;
}));
</code></pre>
<ul>
<li>ุงู ุฑูุดโูุง ุงููุ ฺฉุงุฑุขูุฏ ู ฺฉุงููุงู ููุงุฒโูพุฐุฑ ูุณุชูุฏ.</li>
</ul>
<hr>
<h3>๐น Quantifiers</h3>
<p><code>IEnumerable&lt;TSource&gt;</code> โ <code>bool</code></p>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-30.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>๐น Contains ู Any</h3>
<ul>
<li>ูุชุฏ <strong>Contains</strong> ฺฉ ุนูุตุฑ ุงุฒ ููุน <code>TSource</code> ูโูพุฐุฑุฏ ู ุจุฑุฑุณ ูโฺฉูุฏ ุขุง ุขู ุนูุตุฑ ุฏุฑ ุชูุงู ูุฌูุฏ ุฏุงุฑุฏ ุง ุฎุฑ.</li>
<li>ูุชุฏ <strong>Any</strong> ฺฉ ุดุฑุท ุงุฎุชุงุฑ (<strong>predicate</strong>) ูโฺฏุฑุฏ ู ุจุฑุฑุณ ูโฺฉูุฏ ุขุง ุญุฏุงูู ฺฉ ุนูุตุฑ ุจุง ุดุฑุท ุฏุงุฏูโุดุฏู ูุฌูุฏ ุฏุงุฑุฏ ุง ุฎุฑ.</li>
</ul>
<p>ูุซุงูโูุง:</p>
<pre class="hljs"><code><span class="hljs-built_in">bool</span> hasAThree = <span class="hljs-keyword">new</span> <span class="hljs-built_in">int</span>[] { <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span> }.Contains(<span class="hljs-number">3</span>);       <span class="hljs-comment">// true</span>
<span class="hljs-built_in">bool</span> hasAThree = <span class="hljs-keyword">new</span> <span class="hljs-built_in">int</span>[] { <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span> }.Any(n =&gt; n == <span class="hljs-number">3</span>);  <span class="hljs-comment">// true</span>
</code></pre>
<ul>
<li><strong>Any</strong> ูโุชูุงูุฏ ูููโ ฺฉุงุฑูุง ฺฉู <strong>Contains</strong> ุงูุฌุงู ูโุฏูุฏ ุฑุง ุงูุฌุงู ุฏูุฏ ู ุญุช ุจุดุชุฑ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">bool</span> hasABigNumber = <span class="hljs-keyword">new</span> <span class="hljs-built_in">int</span>[] { <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span> }.Any(n =&gt; n &gt; <span class="hljs-number">10</span>); <span class="hljs-comment">// false</span>
</code></pre>
<ul>
<li>ูุฑุงุฎูุงู <strong>Any</strong> ุจุฏูู ุดุฑุทุ ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ุขุง ุชูุงู ุญุฏุงูู ฺฉ ุนูุตุฑ ุฏุงุฑุฏ ุง ุฎุฑ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-built_in">bool</span> hasABigNumber = <span class="hljs-keyword">new</span> <span class="hljs-built_in">int</span>[] { <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span> }.Where(n =&gt; n &gt; <span class="hljs-number">10</span>).Any();
</code></pre>
<ul>
<li><strong>Any</strong> ุฏุฑ ุฒุฑฺฉูุฆุฑโูุง ู ฺฉูุฆุฑโูุง ูพุงฺฏุงู ุฏุงุฏู ุจุณุงุฑ ููุฏ ุงุณุช. ูุซุงู:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">from</span> c <span class="hljs-keyword">in</span> dbContext.Customers
<span class="hljs-keyword">where</span> c.Purchases.Any(p =&gt; p.Price &gt; <span class="hljs-number">1000</span>)
<span class="hljs-keyword">select</span> c
</code></pre>
<hr>
<h3>๐น All ู SequenceEqual</h3>
<ul>
<li><strong>All</strong> ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ุขุง ููู ุนูุงุตุฑ ุดุฑุท ุฏุงุฏูโุดุฏู ุฑุง ุฑุนุงุช ูโฺฉููุฏ ุง ุฎุฑ. ูุซุงู:</li>
</ul>
<pre class="hljs"><code>dbContext.Customers.Where(c =&gt; c.Purchases.All(p =&gt; p.Price &lt; <span class="hljs-number">100</span>));
</code></pre>
<ul>
<li><strong>SequenceEqual</strong> ุฏู ุชูุงู ุฑุง ุจุง ูู ููุงุณู ูโฺฉูุฏ. ุจุฑุง ุจุงุฒฺฏุฑุฏุงูุฏู <code>true</code>ุ ูุฑ ุฏู ุชูุงู ุจุงุฏ ุนูุงุตุฑ ฺฉุณุงู ู ุจุง ููุงู ุชุฑุชุจ ุฏุงุดุชู ุจุงุดูุฏ. ูโุชูุงู ุงุฒ <strong>equality comparer</strong> ุฏูุฎูุงู ุงุณุชูุงุฏู ฺฉุฑุฏุ ูพุดโูุฑุถ <code>EqualityComparer&lt;T&gt;.Default</code> ุงุณุช.</li>
</ul>
<hr>
<h3>๐น Generation Methods</h3>
<p><code>void</code> โ <code>IEnumerable&lt;TResult&gt;</code></p>
<div align="center">
<p><img src="../../../assets/image/09/Table-9-31.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<h3>๐น Empty, Repeat ู Range</h3>
<p>ูุชุฏูุง <strong>Empty</strong>ุ <strong>Repeat</strong> ู <strong>Range</strong> ูุชุฏูุง ุงุณุชุง (<strong>static</strong>) ูุณุชูุฏ ู ุชูุงูโูุง ุณุงุฏู ูุญู ุฑุง ุชููุฏ ูโฺฉููุฏ.</p>
<hr>
<h4>๐น Empty</h4>
<p>ูุชุฏ <strong>Empty</strong> ฺฉ ุชูุงู ุฎุงู ุชููุฏ ูโฺฉูุฏ ู ุชููุง ูุงุฒ ุจู ููุน ุฏุงุฏู ุฏุงุฑุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">foreach</span> (<span class="hljs-built_in">string</span> s <span class="hljs-keyword">in</span> Enumerable.Empty&lt;<span class="hljs-built_in">string</span>&gt;())
    Console.Write(s);   <span class="hljs-comment">// &lt;ฺุฒ ููุงุด ุฏุงุฏู ููโุดูุฏ&gt;</span>
</code></pre>
<p>ุฏุฑ ุชุฑฺฉุจ ุจุง ุนููฺฏุฑ <code>??</code>ุ <strong>Empty</strong> ุนฺฉุณ <strong>DefaultIfEmpty</strong> ุนูู ูโฺฉูุฏ.</p>
<p>ูุซุงู: ูุฑุถ ฺฉูุฏ ฺฉ ุขุฑุงูโ jagged ุงุฒ ุงุนุฏุงุฏ ุตุญุญ ุฏุงุฑู ู ูโุฎูุงูู ูููโ ุงุนุฏุงุฏ ุฑุง ุฏุฑ ฺฉ ูุณุช ุตุงู ุฌูุน ฺฉูู. ฺฉูุฆุฑ <strong>SelectMany</strong> ุฒุฑ ุฏุฑ ุตูุฑุช ูุฌูุฏ ุขุฑุงูโ null ุฏุงุฎู ุจุง ุฎุทุง ููุงุฌู ูโุดูุฏ:</p>
<pre class="hljs"><code><span class="hljs-built_in">int</span>[][] numbers =
{
    <span class="hljs-keyword">new</span> <span class="hljs-built_in">int</span>[] { <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span> },
    <span class="hljs-keyword">new</span> <span class="hljs-built_in">int</span>[] { <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span> },
    <span class="hljs-literal">null</span>                     <span class="hljs-comment">// ุงู null ุจุงุนุซ ุดฺฉุณุช ฺฉูุฆุฑ ูโุดูุฏ</span>
};

IEnumerable&lt;<span class="hljs-built_in">int</span>&gt; flat = numbers.SelectMany(innerArray =&gt; innerArray);
</code></pre>
<p>ุงุณุชูุงุฏู ุงุฒ <strong>Empty</strong> ููุฑุงู ุจุง <code>??</code> ูุดฺฉู ุฑุง ุญู ูโฺฉูุฏ:</p>
<pre class="hljs"><code>IEnumerable&lt;<span class="hljs-built_in">int</span>&gt; flat = numbers
    .SelectMany(innerArray =&gt; innerArray ?? Enumerable.Empty&lt;<span class="hljs-built_in">int</span>&gt;());

<span class="hljs-keyword">foreach</span> (<span class="hljs-built_in">int</span> i <span class="hljs-keyword">in</span> flat)
    Console.Write(i + <span class="hljs-string">&quot; &quot;</span>);     <span class="hljs-comment">// 1 2 3 4 5 6</span>
</code></pre>
<hr>
<h4>๐น Range ู Repeat</h4>
<ul>
<li><strong>Range</strong>: ฺฉ ููุฏุงุฑ ุดุฑูุน ู ุชุนุฏุงุฏ ุนูุงุตุฑ (ูุฑ ุฏู ุงุฒ ููุน <code>int</code>) ูโฺฏุฑุฏ ู ุชูุงู ุชููุฏ ูโฺฉูุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">foreach</span> (<span class="hljs-built_in">int</span> i <span class="hljs-keyword">in</span> Enumerable.Range(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>))
    Console.Write(i + <span class="hljs-string">&quot; &quot;</span>);    <span class="hljs-comment">// 5 6 7</span>
</code></pre>
<ul>
<li><strong>Repeat</strong>: ุนูุตุฑ ุจุฑุง ุชฺฉุฑุงุฑ ู ุชุนุฏุงุฏ ุฏูุนุงุช ุชฺฉุฑุงุฑ ุขู ุฑุง ูโฺฏุฑุฏ:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">foreach</span> (<span class="hljs-built_in">bool</span> x <span class="hljs-keyword">in</span> Enumerable.Repeat(<span class="hljs-literal">true</span>, <span class="hljs-number">3</span>))
    Console.Write(x + <span class="hljs-string">&quot; &quot;</span>);    <span class="hljs-comment">// True True True</span>
</code></pre>

  </main>

  <!-- ููุชุฑ ูุดุชุฑฺฉ -->
  <footer class="footer">
    <div class="container">
      <p>
        <img src="/icone/copyright.svg" alt="ฺฉูพโุฑุงุช" width="14" height="14"
             style="vertical-align:middle;margin-inline:4px">
        <span id="y"></span> Gitab โ ุจุฑุง ุชูุณุนูโุฏููุฏฺฏุงู
      </p>
    </div>
  </footer>

  <!-- ุณุงู ู ุงุณฺฉุฑูพุช ุชุบุฑ ุชู -->
  <script>
  (() => {
    const root = document.documentElement;
    const btn = document.getElementById('themeToggle');
    const KEY = 'gitab-theme';
    const media = window.matchMedia('(prefers-color-scheme: dark)');
    const getEffective = s => (s === 'auto' ? (media.matches ? 'dark' : 'light') : s);

    function updateTheme(s) {
      root.setAttribute('data-theme', s);
      const mode = getEffective(s);
      root.dataset.colorMode = mode;
      btn.dataset.icon = mode === 'dark' ? 'moon' : 'sun';
    }

    let saved = localStorage.getItem(KEY) || 'auto';
    updateTheme(saved);

    btn.addEventListener('click', () => {
      const current = localStorage.getItem(KEY) || 'auto';
      const next = current === 'auto' ? 'dark' : current === 'dark' ? 'light' : 'auto';
      localStorage.setItem(KEY, next);
      updateTheme(next);
    });

    media.addEventListener('change', () => {
      if ((localStorage.getItem(KEY) || 'auto') === 'auto') updateTheme('auto');
    });

    document.addEventListener('DOMContentLoaded', () => {
      updateTheme(localStorage.getItem(KEY) || 'auto');
    });
  })();
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>

  <script>
  document.querySelectorAll('pre code').forEach(block => {
    const btn = document.createElement('button');
    btn.className = 'copy-btn';

    const icon = document.createElement('img');
    icon.src = "/icone/copy.svg";
    icon.alt = 'Copy';
    btn.appendChild(icon);

    block.parentNode.insertBefore(btn, block);

    btn.addEventListener('click', async () => {
      await navigator.clipboard.writeText(block.textContent);
      btn.classList.add('copied');
      setTimeout(() => btn.classList.remove('copied'), 1500);
    });
  });
  </script>

  <script>
  document.body.dataset.page = window.location.pathname;

  const menuBtn = document.querySelector(".menu-toggle");
  const nav = document.querySelector(".nav");

  if (menuBtn && nav) {
    menuBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      nav.classList.toggle("show");
    });

    document.addEventListener("click", (e) => {
      const clickedInsideNav = nav.contains(e.target);
      const clickedMenuButton = menuBtn.contains(e.target);
      if (!clickedInsideNav && !clickedMenuButton) {
        nav.classList.remove("show");
      }
    });
  }
  </script>

  <script>
    document.getElementById('y').textContent = new Date().getFullYear();
  </script>
</body>
</html>
