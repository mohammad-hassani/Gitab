<!doctype html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8">
  <link rel="icon" type="image/png" href="/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Threading and Concurrency</title>
  <meta name="description" content="ุชุฑุฌููโูุง ูุงุฑุณ ฺฉุชุงุจโูุง ูู โ ุณุฑุนุ ูููุงู ู ูุงุจู ุงุชฺฉุง.">
  <link rel="stylesheet" href="/styles/main.css">
<link rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
<style>
@font-face {
  font-family: 'Vazir';
  src: url('/fonts/Vazir-FD-WOL.ttf') format('truetype');
  font-display: swap;
}
body {
  font-family: 'Vazir', sans-serif;
}
</style>

</head>
<body>
  <!-- ูุฏุฑ ูุดุชุฑฺฉ -->
 <header class="header">
  <div class="container nav-wrap">
    <a href="/" class="brand">
      <img src="/icone/logo.svg" alt="Gitab logo" width="26" height="26">
      <span>Gitab</span>
    </a>

    <nav class="nav">
      <a href="/" aria-current="page">ุฎุงูู</a>
      <a href="/books/list-books">ฺฉุชุงุจโูุง</a>
      <a href="#">ูุชุฑุฌูู</a>
      <a href="#">ููฺฉุงุฑ</a>
      <a href="#">ุฏุฑุจุงุฑู ูุง</a>
    </nav>

    <div class="nav-actions">
     <button id="themeToggle" class="icon-btn theme-btn" data-icon="moon" aria-label="ุชุบุฑ ุชู">
        <img src="/icone/sun.svg" class="icon-sun" alt="ุฑูุดู">
        <img src="/icone/moon.svg" class="icon-moon" alt="ุชุงุฑฺฉ">
      </button>
  <a class="icon-btn" href="https://github.com/hheydarian/Gitab" target="_blank" title="GitHub">
    <img src="/icone/github.svg" alt="GitHub">
  </a>
      <!-- ุฏฺฉูู ููู ุจุฑุง ููุจุงู -->
      <button class="menu-toggle" aria-label=" ููู">
        <img src="/icone/menu.svg" alt="menu">
      </button>
    </div>
  </div> 
  

</header>

 

<main class="site-main book-page ">
  <h1>ูุตู ูุดุชู:  <strong>Threading ู Concurrency</strong></h1>
<p>ฺฉ <strong>Process (ูุฑุขูุฏ)</strong> ุฏุฑ ุงุตู ููุงู ุจุฑูุงููโุง ุงุณุช ฺฉู ุฑู ฺฉ ุณุณุชูโุนุงูู ุฏุฑ ุญุงู ุงุฌุฑุง ุงุณุช. ุงู ูุฑุขูุฏ ุงุฒ ฺูุฏู <strong>Thread (ุฑุดุชูโ ุงุฌุฑุง)</strong> ุณุงุฎุชู ูโุดูุฏ.<br>
<strong>Thread of execution (ุฑุดุชูโ ุงุฌุฑุง)</strong> ูุฌููุนูโุง ุงุฒ ุฏุณุชูุฑูุงุณุช ฺฉู ุชูุณุท ฺฉ Process ุตุงุฏุฑ ูโุดูุฏ.</p>
<p>ูุงุจูุช ุงุฌุฑุง ุจุด ุงุฒ ฺฉ Thread ุจูโุตูุฑุช ููโุฒูุงูุ <strong>Multi-Threading (ฺูุฏุฑุณูุงู)</strong> ูุงูุฏู ูโุดูุฏ.<br>
ุฏุฑ ุงู ูุตู ูุฑุงุฑ ุงุณุช ุจู ููุถูุน <strong>Multi-Threading</strong> ู <strong>Concurrency (ููโุฒูุงู)</strong> ุจูพุฑุฏุงุฒู.</p>
<p>ูุฑ Thread ุจุฑุง ุงุฌุฑุงุ ฺฉ ููุฏุงุฑ ูุดุฎุต ุฒูุงู ุฏุฑุงูุช ูโฺฉูุฏ ู ุงู ุงุฌุฑุง ุชูุณุท <strong>Thread Scheduler (ุฒูุงูโุจูุฏ ุฑุดุชูโูุง)</strong> ุจู ุตูุฑุช ฺุฑุฎุด ูุฏุฑุช ูโุดูุฏ. ุฒูุงูโุจูุฏุ ุจุง ุงุณุชูุงุฏู ุงุฒ ุชฺฉูฺฉ ุจู ูุงู <strong>Time Slicing</strong> ุฒูุงู ุงุฌุฑุง ุฑุง ุจู Threadูุง ุชูุณู ูโฺฉูุฏ ู ูุฑ Thread ุฑุง ุฏุฑ ุฒูุงู ุชุนูโุดุฏู ุจุฑุง ุงุฌุฑุง ุจู CPU ูโูุฑุณุชุฏ. โ๏ธ</p>
<p><strong>Concurrency</strong> ุนู ุชูุงูุง ุงุฌุฑุง ุจุด ุงุฒ ฺฉ Thread ุฏููุงู ุฏุฑ ฺฉ ูุญุธู. ุงู ููุถูุน ุชููุง ุฏุฑ ฺฉุงููพูุชุฑูุง ููฺฉู ุงุณุช ฺฉู ุจุด ุงุฒ ฺฉ <strong>Processor Core (ูุณุชู ูพุฑุฏุงุฒูุฏู)</strong> ุฏุงุดุชู ุจุงุดูุฏ. ูุฑฺู ุชุนุฏุงุฏ ูุณุชูโูุง ุจุดุชุฑ ุจุงุดุฏุ ุชุนุฏุงุฏ ุจุดุชุฑ ุงุฒ Threadูุง ูโุชูุงููุฏ ุจูโุทูุฑ ููโุฒูุงู ุงุฌุฑุง ุดููุฏ. ๐ฅ๏ธ๐ก</p>
<p>ุฏุฑ ุทูู ุจุฑุฑุณ <strong>Concurrency</strong> ู <strong>Threading</strong> ุฏุฑ ุงู ูุตูุ ุจุง ูุดฺฉูุงุช ูุซู <strong>Blocking (ุงูุณุฏุงุฏ)</strong>ุ <strong>Deadlock (ุจูโุจุณุช)</strong> ู <strong>Race Condition (ุดุฑุงุท ุฑูุงุจุช)</strong> ุฑูุจูโุฑู ูโุดูู. ููฺูู ุงุฏ ูโฺฏุฑู ฺุทูุฑ ุจุง ุงุณุชูุงุฏู ุงุฒ ุงุตูู <strong>Clean Code</strong> ุงู ูุดฺฉูุงุช ุฑุง ุญู ฺฉูู. โ</p>
<hr>
<h3>โจ ูุจุงุญุซ ฺฉู ุฏุฑ ุงู ูุตู ูพูุดุด ุฏุงุฏู ุฎูุงููุฏ ุดุฏ</h3>
<ol>
<li>ุฏุฑฺฉ <strong>ฺุฑุฎู ุญุงุช Thread</strong></li>
<li>ุงูุฒูุฏู <strong>ูพุงุฑุงูุชุฑ ุจู Thread</strong></li>
<li>ุงุณุชูุงุฏู ุงุฒ <strong>Thread Pool</strong></li>
<li>ุงุณุชูุงุฏู ุงุฒ <strong>Mutual Exclusion Object</strong> ุจุง Threadูุง ููฺฏุงู (Synchronous)</li>
<li>ฺฉุงุฑ ุจุง Threadูุง ููุงุฒ ุจุง ุงุณุชูุงุฏู ุงุฒ <strong>Semaphore</strong></li>
<li>ูุญุฏูุฏ ฺฉุฑุฏู ุชุนุฏุงุฏ <strong>ูพุฑุฏุงุฒูุฏูโูุง ู Threadูุง</strong> ุฏุฑ <strong>Thread Pool</strong></li>
<li>ุฌููฺฏุฑ ุงุฒ <strong>Deadlock</strong></li>
<li>ุฌููฺฏุฑ ุงุฒ <strong>Race Condition</strong></li>
<li>ุฏุฑฺฉ <strong>Static Constructorูุง ู Methodูุง</strong></li>
<li>ุขุดูุง ุจุง <strong>Mutability (ูุงุจูุช ุชุบุฑูพุฐุฑ)</strong>ุ <strong>Immutability (ุชุบุฑูุงูพุฐุฑ)</strong> ู <strong>Thread Safety</strong></li>
<li><strong>Synchronized Method Dependencies</strong></li>
<li>ุงุณุชูุงุฏู ุงุฒ ฺฉูุงุณ <strong>Interlocked</strong> ุจุฑุง ุชุบุฑ ูุถุนุชโูุง ุณุงุฏู</li>
<li>ุชูุตูโูุง ุนููู ๐</li>
</ol>
<hr>
<h3>๐ฏ ูพุณ ุงุฒ ูพุงุงู ุงู ูุตู ุดูุง ุชูุงูุงโูุง ุฒุฑ ุฑุง ฺฉุณุจ ุฎูุงูุฏ ฺฉุฑุฏ</h3>
<ul>
<li>ุฏุฑฺฉ ู ุชูุถุญ <strong>ฺุฑุฎู ุญุงุช Thread</strong></li>
<li>ุขุดูุง ุจุง <strong>Foreground Thread</strong> ู <strong>Background Thread</strong> ู ุชูุงูุง ุงุณุชูุงุฏู ุงุฒ ุขูโูุง</li>
<li>ูุฏุฑุช ู ฺฉูุชุฑู ุณุฑุนุช ุงุฌุฑุง Threadูุง (<strong>Throttle</strong>) ู ุชุนู ุชุนุฏุงุฏ ูพุฑุฏุงุฒูุฏูโูุง ููโุฒูุงู ุจุง ุงุณุชูุงุฏู ุงุฒ <strong>Thread Pool</strong></li>
<li>ุฏุฑฺฉ ุงุซุฑ <strong>Static Constructorูุง</strong> ู <strong>Methodูุง</strong> ุฏุฑ ุงุฑุชุจุงุท ุจุง <strong>Multi-Threading</strong> ู <strong>Concurrency</strong></li>
<li>ุฏุฑ ูุธุฑ ฺฏุฑูุชู ุชุฃุซุฑ <strong>Mutability</strong> ู <strong>Immutability</strong> ุจุฑ <strong>Thread Safety</strong></li>
<li>ุฏุฑฺฉ ุนูุช ุจุฑูุฒ <strong>Race Condition</strong> ู ุฑูุดโูุง ุฌููฺฏุฑ ุงุฒ ุขู</li>
<li>ุฏุฑฺฉ ุนูุช ูููุน <strong>Deadlock</strong> ู ุฑุงูโูุง ูพุดฺฏุฑ ุงุฒ ุขู</li>
<li>ุชูุงูุง ุงูุฌุงู ุชุบุฑุงุช ุณุงุฏู ุฏุฑ ูุถุนุชโูุง ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉูุงุณ <strong>Interlocked</strong></li>
</ul>
<hr>
<h3>โก ูพุดโูุงุฒ ุงุฌุฑุง ฺฉุฏูุง ุงู ูุตู</h3>
<p>ุจุฑุง ุงุฌุฑุง ฺฉุฏูุง ุงู ูุตู ุจู ฺฉ <strong>.NET Framework Console Application</strong> ูุงุฒ ุฏุงุฑุฏ.<br>
ูฺฏุฑ ุฏุฑ ููุงูุน ฺฉู ุจูโุทูุฑ ุฎุงุต ุฐฺฉุฑ ุดุฏู ุจุงุดุฏุ ุชูุงู ฺฉุฏูุง ุฏุฑูู ฺฉูุงุณ <strong>Program</strong> ูุฑุงุฑ ุฎูุงููุฏ ฺฏุฑูุช. ๐๏ธ</p>
<h3>๐ ุฏุฑฺฉ <strong>ฺุฑุฎูโ ุญุงุช Thread</strong></h3>
<p>ุฏุฑ ุฒุจุงู <strong>C#</strong>ุ ูุฑ <strong>Thread</strong> (ุฑุดุชูโ ุงุฌุฑุง) ุฏุงุฑุง ฺฉ <strong>ฺุฑุฎูโ ุญุงุช</strong> ูุดุฎุต ุงุณุช.<br>
ุงู ฺุฑุฎูุ ูุฑุงุญู ุฑุง ูุดุงู ูโุฏูุฏ ฺฉู ฺฉ Thread ุงุฒ ุฒูุงู ุงุฌุงุฏ ุดุฏู ุชุง ูพุงุงู ฺฉุงุฑุด ุท ูโฺฉูุฏ.</p>
<p>ฺุฑุฎูโ ุญุงุช Thread ุจู ุตูุฑุช ุฒุฑ ุงุณุช: ๐งฉ</p>
<div align="center">
<p><img src="../../../assets/image/08/Table%208-1.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ููุช ฺฉ <strong>Thread (ุฑุดุชู)</strong> ุดุฑูุน ุจู ฺฉุงุฑ ูโฺฉูุฏุ ูุงุฑุฏ ุญุงูุช <strong>Running (ุฏุฑ ุญุงู ุงุฌุฑุง)</strong> ูโุดูุฏ. ุฏุฑ ุงู ุญุงูุชุ ุฑุดุชู ูโุชูุงูุฏ ูุงุฑุฏ ุญุงูุชโูุง <strong>Wait (ุงูุชุธุงุฑ)</strong>ุ <strong>Sleep (ุฎูุงุจ)</strong>ุ <strong>Join (ูพูุณุชู)</strong>ุ <strong>Stop (ุชููู)</strong> ุง <strong>Suspended (ูุนูู)</strong> ุดูุฏ. ููฺูู ุฑุดุชูโูุง ูโุชูุงููุฏ <strong>Aborted (ูุชูููโุดุฏู)</strong> ุดููุฏ. ุฑุดุชูโูุง ูุชูููโุดุฏู ูุงุฑุฏ ุญุงูุช <strong>Stop</strong> ูโุดููุฏ. ุดูุง ูโุชูุงูุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ ูุชุฏูุง <strong>Suspend()</strong> ู <strong>Resume()</strong> ฺฉ ุฑุดุชู ุฑุง ุจู ุชุฑุชุจ ูุนูู ฺฉุฑุฏู ู ุฏูุจุงุฑู ุงุฏุงูู ุฏูุฏ.</p>
<p>ฺฉ ุฑุดุชู ุฒูุงู ูุงุฑุฏ ุญุงูุช <strong>Wait</strong> ูโุดูุฏ ฺฉู ูุชุฏ <strong>Monitor.Wait(object obj)</strong> ูุฑุงุฎูุงู ุดูุฏ. ุณูพุณ ุงู ุฑุดุชู ุฒูุงู ุงุฏุงูู ูพุฏุง ูโฺฉูุฏ ฺฉู ูุชุฏ <strong>Monitor.Pulse(object obj)</strong> ูุฑุงุฎูุงู ุดูุฏ.<br>
ุฑุดุชูโูุง ุจุง ูุฑุงุฎูุงู ูุชุฏ <strong>Thread.Sleep(int millisecondsTimeout)</strong> ุจู ุญุงูุช ุฎูุงุจ ูโุฑููุฏ. ูพุณ ุงุฒ ฺฏุฐุดุช ุฒูุงู ูุดุฎุตโุดุฏูุ ุฑุดุชู ุฏูุจุงุฑู ุจู ุญุงูุช ุงุฌุฑุง ุจุงุฒูโฺฏุฑุฏุฏ.</p>
<p>ูุชุฏ <strong>Thread.Join()</strong> ุจุงุนุซ ูโุดูุฏ ฺฉ ุฑุดุชู ูุงุฑุฏ ุญุงูุช ุงูุชุธุงุฑ ุดูุฏ. ุฑุดุชูโุง ฺฉู Join ุดุฏู ุงุณุช ุฏุฑ ุญุงูุช ุงูุชุธุงุฑ ุจุงู ูโูุงูุฏ ุชุง ุชูุงู ุฑุดุชูโูุง ูุงุจุณุชู ุจู ุขู ุงุฌุฑุง ุดููุฏ ู ุณูพุณ ุจู ุญุงูุช ุงุฌุฑุง ุจุงุฒูโฺฏุฑุฏุฏ. ุจุง ุงู ุญุงูุ ุงฺฏุฑ ูุฑ ฺฉ ุงุฒ ุฑุดุชูโูุง ูุงุจุณุชู ูุชููู ุดููุฏ (<strong>Aborted</strong>)ุ ุงู ุฑุดุชู ูู ูุชููู ุดุฏู ู ูุงุฑุฏ ุญุงูุช <strong>Stop</strong> ูโุดูุฏ.<br>
ุฑุดุชูโูุง ฺฉู ฺฉุงูู ุงุฌุฑุง ุดุฏูโุงูุฏ ุง ูุชููู ุดุฏูโุงูุฏุ ุฏฺฏุฑ ูุงุจู ุดุฑูุน ูุฌุฏุฏ ูุณุชูุฏ.</p>
<p>ุฑุดุชูโูุง ูโุชูุงููุฏ ุฏุฑ <strong>Foreground (ูพุดโุฒููู)</strong> ุง <strong>Background (ูพุณโุฒููู)</strong> ุงุฌุฑุง ุดููุฏ. ุจุงุฏ ุจุง ุฑุดุชูโูุง ูพุดโุฒููู ุดุฑูุน ฺฉูู:</p>
<h3>๐ต ุฑุดุชูโูุง ูพุดโุฒููู (Foreground Threads)</h3>
<p>ุจูโุตูุฑุช ูพุดโูุฑุถุ ุฑุดุชูโูุง ุฏุฑ ูพุดโุฒููู ุงุฌุฑุง ูโุดููุฏ. ฺฉ <strong>Process (ูุฑุขูุฏ)</strong> ุฒูุงู ฺฉู ุญุฏุงูู ฺฉ ุฑุดุชู ูพุดโุฒููู ุฏุฑ ุญุงู ุงุฌุฑุง ุจุงุดุฏุ ููฺูุงู ูุนุงู ุจุงู ูโูุงูุฏ. ุญุช ุงฺฏุฑ ูุชุฏ <strong>Main()</strong> ุชูุงู ุดูุฏ ุงูุง ูููุฒ ฺฉ ุฑุดุชู ูพุดโุฒููู ุฏุฑ ุญุงู ุงุฌุฑุง ุจุงุดุฏุ ูุฑุขูุฏ ุจุฑูุงูู ุชุง ูพุงุงู ฺฉุงุฑ ุขู ุฑุดุชู ูุนุงู ุฎูุงูุฏ ูุงูุฏ. ุงุฌุงุฏ ฺฉ ุฑุดุชู ูพุดโุฒููู ุจุณุงุฑ ุณุงุฏู ุงุณุชุ ููุงูโุทูุฑ ฺฉู ุฏุฑ ฺฉุฏ ุฒุฑ ูโุจูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> foregroundThread = <span class="hljs-keyword">new</span> Thread(SomeMethodName);
foregroundThread.Start();
</code></pre>
<h3>๐ข ุฑุดุชูโูุง ูพุณโุฒููู (Background Threads)</h3>
<p>ุงุฌุงุฏ ุฑุดุชู ูพุณโุฒููู ูุดุงุจู ุฑุดุชูโูุง ูพุดโุฒููู ุงุณุชุ ุจุง ุงู ุชูุงูุช ฺฉู ุดูุง ุจุงุฏ ุจูโุตูุฑุช ุตุฑุญ ูุดุฎุต ฺฉูุฏ ฺฉู ุฑุดุชู ุฏุฑ ูพุณโุฒููู ุงุฌุฑุง ุดูุฏุ ููุงูโุทูุฑ ฺฉู ุฏุฑ ูุซุงู ุฒุฑ ูุดุงู ุฏุงุฏู ุดุฏู ุงุณุช:</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> backgroundThread = <span class="hljs-keyword">new</span> Thread(SomeMethodName);
backgroundThread.IsBackground = <span class="hljs-literal">true</span>;
backgroundThread.Start();
</code></pre>
<p>ุฑุดุชูโูุง ูพุณโุฒููู ุจุฑุง ุงูุฌุงู ฺฉุงุฑูุง ุฌุงูุจ ู ุญูุธ <strong>ูุงฺฉูุดโูพุฐุฑ ุฑุงุจุท ฺฉุงุฑุจุฑ</strong> ุงุณุชูุงุฏู ูโุดููุฏ. ุฒูุงู ฺฉู ูุฑุขูุฏ ุงุตู ูพุงุงู ุงุจุฏุ ูุฑ ุฑุดุชู ูพุณโุฒูููโุง ฺฉู ุฏุฑ ุญุงู ุงุฌุฑุง ุจุงุดุฏ ูุฒ ุฎุงุชูู ูพุฏุง ูโฺฉูุฏ. ุงูุง ุญุช ุงฺฏุฑ ูุฑุขูุฏ ุงุตู ูพุงุงู ุงุจุฏุ ุฑุดุชูโูุง ูพุดโุฒูููโุง ฺฉู ุฏุฑ ุญุงู ุงุฌุฑุง ูุณุชูุฏุ ุชุง ุฒูุงู ฺฉุงูู ุดุฏูุดุงู ุงุฌุฑุง ุฎูุงููุฏ ุดุฏ.</p>
<hr>
<h3>โ ุงูุฒูุฏู ูพุงุฑุงูุชุฑ ุจู ุฑุดุชูโูุง (Adding Thread Parameters)</h3>
<p>ุฑูุดโูุง ฺฉู ุฏุฑ ุฑุดุชูโูุง ุงุฌุฑุง ูโุดููุฏ ูุนูููุงู ูพุงุฑุงูุชุฑ ุฏุงุฑูุฏ. ุจูุงุจุฑุงู ููฺฏุงู ุงุฌุฑุง ฺฉ ูุชุฏ ุฏุฑูู ฺฉ ุฑุดุชูุ ุจุงุฏ ุจุฏุงูู ฺฺฏููู ูพุงุฑุงูุชุฑูุง ุขู ูุชุฏ ุฑุง ุจู ุฑุดุชู ุงุฑุณุงู ฺฉูู.</p>
<p>ูุฑุถ ฺฉูุฏ ูุชุฏ ุฒุฑ ุฑุง ุฏุงุฑู ฺฉู ุฏู ุนุฏุฏ ุตุญุญ (<strong>int</strong>) ุฑุง ุจุง ูู ุฌูุน ฺฉุฑุฏู ู ูุชุฌู ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">int</span> <span class="hljs-title">Add</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> a, <span class="hljs-built_in">int</span> b</span>)</span>
{
    <span class="hljs-keyword">return</span> a + b;
}
</code></pre>
<p>ููุงูโุทูุฑ ฺฉู ูโุจูุฏุ ุงู ูุชุฏ ุณุงุฏู ุงุณุช. ุฏู ูพุงุฑุงูุชุฑ ุจู ูุงูโูุง <strong>a</strong> ู <strong>b</strong> ุฏุงุฑุฏ. ุงู ุฏู ูพุงุฑุงูุชุฑ ุจุงุฏ ุจู ุฑุดุชู ุงุฑุณุงู ุดููุฏ ุชุง ูุชุฏ <strong>Add()</strong> ุจูโุฏุฑุณุช ุงุฌุฑุง ุดูุฏ.</p>
<p>ุฏุฑ ุงุฏุงูู ฺฉ ูุชุฏ ููููู ุงุถุงูู ูโฺฉูู ฺฉู ููู ฺฉุงุฑ ุฑุง ุงูุฌุงู ูโุฏูุฏ:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ThreadParametersExample</span>()</span>
{
    <span class="hljs-built_in">int</span> result = <span class="hljs-number">0</span>;
    Thread thread = <span class="hljs-keyword">new</span> Thread(() =&gt; { result = Add(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>); });
    thread.Start();
    thread.Join();
    Message(<span class="hljs-string">$&quot;The addition of 1 plus 2 is <span class="hljs-subst">{result}</span>.&quot;</span>);
}
</code></pre>
<p>ุฏุฑ ุงู ูุชุฏุ ุงุจุชุฏุง ฺฉ ูุชุบุฑ <strong>int</strong> ุจุง ููุฏุงุฑ ุงููู 0 ุชุนุฑู ูโฺฉูู. ุณูพุณ ฺฉ ุฑุดุชู ุฌุฏุฏ ุงุฌุงุฏ ูโฺฉูู ฺฉู ูุชุฏ <strong>Add()</strong> ุฑุง ุจุง ููุงุฏุฑ <strong>1</strong> ู <strong>2</strong> ูุฑุงุฎูุงู ฺฉุฑุฏู ู ูุชุฌู ุฑุง ุฏุฑ ูุชุบุฑ ุฐุฎุฑู ูโฺฉูุฏ. ุฑุดุชู ุฑุง ุงุฌุฑุง ูโฺฉูู ู ุจุง ูุชุฏ <strong>Join()</strong> ููุชุธุฑ ูโูุงูู ุชุง ุงุฌุฑุง ุฑุดุชู ุชูุงู ุดูุฏ. ุฏุฑ ููุงุชุ ูุชุฌู ุฑุง ุฏุฑ ูพูุฌุฑู <strong>Console</strong> ฺุงูพ ูโฺฉูู.</p>
<p>ุจุฑุง ุงู ฺฉุงุฑุ ูุชุฏ <strong>Message()</strong> ุฑุง ุงุถุงูู ูโฺฉูู:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">internal</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Message</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> message</span>)</span>
{
    Console.WriteLine(message);
}
</code></pre>
<p>ูุชุฏ <strong>Message()</strong> ฺฉ ุฑุดุชู ูุชู ุฑุง ุฏุฑุงูุช ฺฉุฑุฏู ู ุฏุฑ ูพูุฌุฑู ฺฉูุณูู ููุงุด ูโุฏูุฏ. ุญุงูุง ฺฉุงู ุงุณุช ูุชุฏ <strong>Main()</strong> ุฑุง ุจูโุฑูุฒุฑุณุงู ฺฉูู:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] <span class="hljs-keyword">args</span></span>)</span>
{
    ThreadParametersExample();
    Message(<span class="hljs-string">&quot;=== Press any Key to exit ===&quot;</span>);
    Console.ReadKey();
}
</code></pre>
<p>ุฏุฑ ูุชุฏ <strong>Main()</strong>ุ ุงุจุชุฏุง ูุชุฏ ููููู ุฎูุฏ ุฑุง ูุฑุงุฎูุงู ูโฺฉูู ู ุณูพุณ ููุชุธุฑ ูโูุงูู ุชุง ฺฉุงุฑุจุฑ ฺฉูุฏ ุฑุง ูุดุงุฑ ุฏูุฏ ุชุง ุจุฑูุงูู ุจุณุชู ุดูุฏ. ุฎุฑูุฌ ฺฉู ุจุงุฏ ูุดุงูุฏู ฺฉูุฏ ุจูโุตูุฑุช ุฒุฑ ุฎูุงูุฏ ุจูุฏ: ๐</p>
<div align="center">
<p><img src="../../../assets/image/08/Table%208-2.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ููุงูโุทูุฑ ฺฉู ูุดุงูุฏู ฺฉุฑุฏุฏุ ุงุนุฏุงุฏ <strong>1</strong> ู <strong>2</strong> ูพุงุฑุงูุชุฑูุง ูุชุฏ ุจูุฏูุฏ ฺฉู ุจู ูุชุฏ ุฌูุน ุงุฑุณุงู ุดุฏูุฏ ู ููุฏุงุฑ <strong>3</strong> ุฎุฑูุฌโุง ุจูุฏ ฺฉู ุฑุดุชู ุจุฑฺฏุฑุฏุงูุฏ.</p>
<hr>
<h2>๐ ุงุณุชูุงุฏู ุงุฒ <strong>Thread Pool (ุงุณุชุฎุฑ ุฑุดุชู)</strong></h2>
<p>ฺฉ <strong>Thread Pool</strong> ุจุงุนุซ ุจูุจูุฏ ุนููฺฉุฑุฏ ุจุฑูุงูู ูโุดูุฏุ ฺูู ุฏุฑ ููฺฏุงู ุดุฑูุน ุจุฑูุงูู ูุฌููุนูโุง ุงุฒ ุฑุดุชูโูุง ุงุฌุงุฏ ูโฺฉูุฏ. ูุฑ ุฒูุงู ฺฉ ุฑุดุชู ูุงุฒ ุจุงุดุฏุ ฺฉ ุงุฒ ุฑุดุชูโูุง ููุฌูุฏ ุฏุฑ ุงุณุชุฎุฑ ุจุฑุง ุงูุฌุงู ฺฉ ฺฉุงุฑ ุงุฎุชุตุงุต ุฏุงุฏู ูโุดูุฏ. ูพุณ ุงุฒ ุงูุฌุงู ุขู ฺฉุงุฑุ ุฑุดุชู ุฏูุจุงุฑู ุจู ุงุณุชุฎุฑ ุจุฑฺฏุฑุฏุงูุฏู ุดุฏู ู ูุงุจู ุงุณุชูุงุฏู ูุฌุฏุฏ ุฎูุงูุฏ ุจูุฏ.</p>
<p>ุงุฒ ุขูุฌุง ฺฉู ุงุฌุงุฏ ุฑุดุชู ุฏุฑ <strong>.NET</strong> ูุฒููโุจุฑ ุงุณุชุ ูโุชูุงู ุจุง ุงุณุชูุงุฏู ุงุฒ <strong>Thread Pool</strong> ุนููฺฉุฑุฏ ุฑุง ุจูุจูุฏ ุจุฎุดุฏ. ูุฑ ูุฑุขูุฏ ุฏุงุฑุง ุชุนุฏุงุฏ ูุดุฎุต ุฑุดุชู ุงุณุช ฺฉู ุจุฑุงุณุงุณ ููุงุจุน ุณุณุชู (ูุซู ุญุงูุธู ู CPU) ุชุนู ูโุดูุฏ. ุงูุจุชู ูโุชูุงู ุชุนุฏุงุฏ ุฑุดุชูโูุง ุงุณุชูุงุฏูโุดุฏู ุฏุฑ ุงุณุชุฎุฑ ุฑุง ฺฉู ุง ุฒุงุฏ ฺฉุฑุฏุ ุงูุง ูุนูููุงู ุจูุชุฑ ุงุณุช ุงู ูุฏุฑุช ุฑุง ุจู ุฎูุฏ ุงุณุชุฎุฑ ุจุณูพุงุฑู ู ุจูโุตูุฑุช ุฏุณุช ุชูุธูุงุช ุงูุฌุงู ูุฏูู.</p>
<p>ุฑูุดโูุง ูุฎุชูู ุจุฑุง ุงุฌุงุฏ ฺฉ <strong>Thread Pool</strong> ุนุจุงุฑุชโุงูุฏ ุงุฒ:</p>
<ul>
<li>ุงุณุชูุงุฏู ุงุฒ <strong>Task Parallel Library (TPL)</strong> (ุฏุฑ <strong>.NET Framework 4.0</strong> ู ุจุงูุงุชุฑ)</li>
<li>ุงุณุชูุงุฏู ุงุฒ <strong>ThreadPool.QueueUserWorkItem()</strong></li>
<li>ุงุณุชูุงุฏู ุงุฒ <strong>Asynchronous Delegates (ููุงูุฏูโูุง ูุงููุฒูุงู)</strong></li>
<li>ุงุณุชูุงุฏู ุงุฒ <strong>BackgroundWorker</strong></li>
</ul>
<blockquote>
<p><strong>ูฺฉุชู ููู:</strong> ุจูโุทูุฑ ฺฉูุ <strong>Thread Pool</strong> ูุนูููุงู ุจุฑุง ุจุฑูุงููโูุง <strong>Server-side (ุณูุช ุณุฑูุฑ)</strong> ุงุณุชูุงุฏู ูโุดูุฏ. ุจุฑุง ุจุฑูุงููโูุง <strong>Client-side (ุณูุช ฺฉุงุฑุจุฑ)</strong>ุ ุจูุชุฑ ุงุณุช ุงุฒ ุฑุดุชูโูุง <strong>Foreground</strong> ู <strong>Background</strong> ุจุณุชู ุจู ูุงุฒ ุงุณุชูุงุฏู ฺฉูุฏ.</p>
</blockquote>
<p>ุฏุฑ ุงู ฺฉุชุงุจุ ูุง ููุท ุจู <strong>TPL</strong> ู ูุชุฏ <strong>QueueUserWorkItem()</strong> ูโูพุฑุฏุงุฒู. ุจุฑุง ุงุฏฺฏุฑ ุฑูุดโูุง ุฏฺฏุฑ ูโุชูุงูุฏ ุจู ููฺฉ ุฒุฑ ูุฑุงุฌุนู ฺฉูุฏ:<br>
<a href="http://www.albahari.com/threading/">http://www.albahari.com/threading/</a></p>
<hr>
<h2>โก ฺฉุชุงุจุฎุงูู <strong>Task Parallel Library (TPL)</strong></h2>
<p>ุฏุฑ C#ุ ฺฉ ุนููุงุช ูุงููุฒูุงู ุชูุณุท ฺฉ <strong>Task (ูุธูู)</strong> ููุงุด ุฏุงุฏู ูโุดูุฏ. ูุฑ <strong>Task</strong> ุฏุฑ C# ุชูุณุท ฺฉูุงุณ <strong>Task</strong> ุฏุฑ <strong>TPL</strong> ููุงุด ุฏุงุฏู ูโุดูุฏ. ููุงูโุทูุฑ ฺฉู ุงุฒ ูุงูุด ูพุฏุงุณุชุ <strong>Task Parallelism</strong> ุงูฺฉุงู ุงุฌุฑุง ููโุฒูุงู ฺูุฏ <strong>Task</strong> ุฑุง ูุฑุงูู ูโฺฉูุฏ ฺฉู ุฏุฑ ุจุฎุดโูุง ุจุนุฏ ุฏุฑุจุงุฑู ุขู ุงุฏ ูโฺฏุฑู.</p>
<p>ุงููู ูุชุฏ ฺฉู ุงุฒ ฺฉูุงุณ <strong>Parallel</strong> ุจุฑุฑุณ ูโฺฉููุ ูุชุฏ <strong>Invoke()</strong> ุงุณุช.</p>
<hr>
<h3>๐ <strong>Parallel.Invoke()</strong></h3>
<p>ุฏุฑ ุงููู ูุซุงูุ ุณู ูุชุฏ ูุฎุชูู ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ <strong>Parallel.Invoke()</strong> ูุฑุงุฎูุงู ูโฺฉูู. ุณู ูุชุฏ ุฒุฑ ุฑุง ุงุถุงูู ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">MethodOne</span>()</span>
{
    Message(<span class="hljs-string">$&quot;MethodOne Executed: Thread Id(<span class="hljs-subst">{Thread.CurrentThread.ManagedThreadId}</span>)&quot;</span>);
}

<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">MethodTwo</span>()</span>
{
    Message(<span class="hljs-string">$&quot;MethodTwo Executed: Thread Id(<span class="hljs-subst">{Thread.CurrentThread.ManagedThreadId}</span>)&quot;</span>);
}

<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">MethodThree</span>()</span>
{
    Message(<span class="hljs-string">$&quot;MethodThree Executed: Thread Id(<span class="hljs-subst">{Thread.CurrentThread.ManagedThreadId}</span>)&quot;</span>);
}
</code></pre>
<p>ููุงูโุทูุฑ ฺฉู ูโุจูุฏุ ุงู ุณู ูุชุฏ ุชูุฑุจุงู ูุดุงุจู ูุณุชูุฏ ู ุชููุง ูุงูโูุง ู ูพุงู ฺุงูพโุดุฏู ุฏุฑ ฺฉูุณูู ูุชูุงูุช ุงุณุช ฺฉู ุชูุณุท ูุชุฏ <strong>Message()</strong> (ฺฉู ูุจูุงู ููุดุชู) ููุงุด ุฏุงุฏู ูโุดูุฏ.</p>
<p>ุญุงูุง ูุชุฏ <strong>UsingTaskParallelLibrary()</strong> ุฑุง ุงุถุงูู ูโฺฉูู ุชุง ุงู ุณู ูุชุฏ ุฑุง ุจูโุตูุฑุช ููุงุฒ ุงุฌุฑุง ฺฉูู:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">UsingTaskParallelLibrary</span>()</span>
{
    Message(<span class="hljs-string">$&quot;UsingTaskParallelLibrary Started: Thread Id = (<span class="hljs-subst">{Thread.CurrentThread.ManagedThreadId}</span>)&quot;</span>);
    Parallel.Invoke(MethodOne, MethodTwo, MethodThree);
    Message(<span class="hljs-string">&quot;UsingTaskParallelLibrary Completed.&quot;</span>);
}
</code></pre>
<p>ุฏุฑ ุงู ูุชุฏุ ุงุจุชุฏุง ูพุงู ุฏุฑ ูพูุฌุฑู <strong>Console</strong> ฺุงูพ ูโฺฉูู ุชุง ูุดุงู ุฏูุฏ ุดุฑูุน ูุชุฏ ุขุบุงุฒ ุดุฏู ุงุณุช. ุณูพุณ ูุชุฏูุง <strong>MethodOne</strong>ุ <strong>MethodTwo</strong> ู <strong>MethodThree</strong> ุฑุง ุจูโุตูุฑุช ููุงุฒ ุงุฌุฑุง ูโฺฉูู. ูพุณ ุงุฒ ุขูุ ูพุงู ุฏุฑ <strong>Console</strong> ฺุงูพ ูโฺฉูู ุชุง ูุดุฎุต ุดูุฏ ูุชุฏ ุจู ุงูุชูุง ุงุฌุฑุง ุฎูุฏ ุฑุณุฏู ุงุณุช ู ุณูพุณ ููุชุธุฑ ูโูุงูู ุชุง ฺฉุงุฑุจุฑ ฺฉูุฏ ุฑุง ูุดุงุฑ ุฏูุฏ ู ุฏุฑ ููุงุช ูุชุฏ ุฎุงุชูู ูพุฏุง ฺฉูุฏ.</p>
<p>ฺฉุฏ ุฑุง ุงุฌุฑุง ฺฉูุฏ ู ุจุงุฏ ุฎุฑูุฌ ุฒุฑ ุฑุง ูุดุงูุฏู ฺฉูุฏ: ๐</p>
<div align="center">
<p><img src="../../../assets/image/08/Table%208-3.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ุฏุฑ ุชุตูุฑ ูุจูุ ูุดุงูุฏู ูโฺฉูุฏ ฺฉู <strong>ุฑุดุชู ุดูุงุฑู 1</strong> ุฏูุจุงุฑู ุงุณุชูุงุฏู ุดุฏู ุงุณุช. ุญุงูุง ุจุงุฏ ุจู ุณุฑุงุบ ุญููู <strong>Parallel.For()</strong> ุจุฑูู.</p>
<hr>
<h2>๐ <strong>Parallel.For()</strong></h2>
<p>ุฏุฑ ูุซุงู ุจุนุฏ ูุฑุจูุท ุจู <strong>TPL</strong>ุ ุจู ฺฉ ุญููู ุณุงุฏู <strong>Parallel.For()</strong> ูฺฏุงู ูโฺฉูู. ูุชุฏ ุฒุฑ ุฑุง ุจู ฺฉูุงุณ <strong>Program</strong> ุฏุฑ ฺฉ ุจุฑูุงูู <strong>Console</strong> ุฌุฏุฏ ุจุง <strong>.NET Framework</strong> ุงุถุงูู ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Method</span>()</span>
{
    Message(<span class="hljs-string">$&quot;Method Executed: Thread Id(<span class="hljs-subst">{Thread.CurrentThread.ManagedThreadId}</span>)&quot;</span>);
}
</code></pre>
<p>ุงู ูุชุฏ ุชููุง ฺฉ ุฑุดุชู ูุชู ุฑุง ุฏุฑ ูพูุฌุฑู <strong>Console</strong> ฺุงูพ ูโฺฉูุฏ.</p>
<p>ุญุงูุง ูุชุฏ ุงุฌุงุฏ ูโฺฉูู ฺฉู ุญููู <strong>Parallel.For()</strong> ุฑุง ุงุฌุฑุง ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">UsingTaskParallelLibraryFor</span>()</span>
{
    Message(<span class="hljs-string">$&quot;UsingTaskParallelLibraryFor Started: Thread Id = (<span class="hljs-subst">{Thread.CurrentThread.ManagedThreadId}</span>)&quot;</span>);
    Parallel.For(<span class="hljs-number">0</span>, <span class="hljs-number">1000</span>, X =&gt; Method());
    Message(<span class="hljs-string">&quot;UsingTaskParallelLibraryFor Completed.&quot;</span>);
}
</code></pre>
<p>ุฏุฑ ุงู ูุชุฏุ ุงุฒ ุนุฏุฏ <strong>0 ุชุง 1000</strong> ุญููู ูโุฒูู ู ุฏุฑ ูุฑ ุชฺฉุฑุงุฑุ ูุชุฏ <strong>Method()</strong> ุฑุง ูุฑุงุฎูุงู ูโฺฉูู. ุฏุฑ ุทูู ุงุฌุฑุง ุงู ุญูููุ ุฎูุงูุฏ ุฏุฏ ฺฉู ุฑุดุชูโูุง ุฏุฑ ูุฑุงุฎูุงูโูุง ูุฎุชูู ุฏูุจุงุฑู ุงุณุชูุงุฏู ูโุดููุฏุ ููุงูโุทูุฑ ฺฉู ุฏุฑ ุชุตูุฑ ุฒุฑ ูุดุฎุต ุงุณุช: ๐</p>
<div align="center">
<p><img src="../../../assets/image/08/Table%208-4.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ุญุงูุง ูโุฎูุงูู ุจู ุณุฑุงุบ ุงุณุชูุงุฏู ุงุฒ ูุชุฏ <strong>ThreadPool.QueueUserWorkItem()</strong> ุจุฑูู.</p>
<hr>
<h2>๐งต <strong>ThreadPool.QueueUserWorkItem()</strong></h2>
<p>ูุชุฏ <strong>ThreadPool.QueueUserWorkItem()</strong> ฺฉ ูุชุฏ <strong>WaitCallback</strong> ุฑุง ุฏุฑุงูุช ฺฉุฑุฏู ู ุขู ุฑุง ุจุฑุง ุงุฌุฑุง ุฏุฑ ุตู ูุฑุงุฑ ูโุฏูุฏ.<br>
<strong>WaitCallback</strong> ฺฉ <strong>Delegate (ููุงูุฏู)</strong> ุงุณุช ฺฉู ูุดุงูโุฏููุฏู ูุชุฏ ุงุณุช ฺฉู ุจุงุฏ ุชูุณุท ฺฉ ุฑุดุชู ุฏุฑ <strong>Thread Pool</strong> ุงุฌุฑุง ุดูุฏ. ููุช ฺฉ ุฑุดุชู ุขุฒุงุฏ ุดูุฏุ ุงู ูุชุฏ ุงุฌุฑุง ุฎูุงูุฏ ุดุฏ.</p>
<p>ุจุงุฏ ฺฉ ูุซุงู ุณุงุฏู ุงุถุงูู ฺฉูู. ุงุจุชุฏุง ูุชุฏ ุฒุฑ ุฑุง ุชุนุฑู ูโฺฉูู:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">WaitCallbackMethod</span>(<span class="hljs-params">Object _</span>)</span>
{
    Message(<span class="hljs-string">&quot;Hello from WaitCallBackMethod!&quot;</span>);
}
</code></pre>
<p>ุงู ูุชุฏ ฺฉ ูพุงุฑุงูุชุฑ ุงุฒ ููุน <strong>Object</strong> ุฏุฑุงูุช ูโฺฉูุฏุ ุงูุง ฺูู ุงุฒ ุขู ุงุณุชูุงุฏู ููโฺฉููุ ุงุฒ ูุชุบุฑ <strong>discard (_)</strong> ุงุณุชูุงุฏู ุดุฏู ุงุณุช. ุณูพุณ ูพุงู ุฏุฑ ูพูุฌุฑู <strong>Console</strong> ฺุงูพ ูโุดูุฏ.</p>
<p>ุญุงูุง ฺฉุฏ ูุฑุงุฎูุงู ุงู ูุชุฏ ุฑุง ุงุถุงูู ูโฺฉูู:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ThreadPoolQueueUserWorkItem</span>()</span>
{
    ThreadPool.QueueUserWorkItem(WaitCallbackMethod);
    Message(<span class="hljs-string">&quot;Main thread does some work, then sleeps.&quot;</span>);
    Thread.Sleep(<span class="hljs-number">1000</span>);
    Message(<span class="hljs-string">&quot;Main thread exits.&quot;</span>);
}
</code></pre>
<p>ููุงูโุทูุฑ ฺฉู ูโุจูุฏุ ุงุฒ ฺฉูุงุณ <strong>ThreadPool</strong> ุจุฑุง ูุฑุงุฑ ุฏุงุฏู <strong>WaitCallbackMethod()</strong> ุฏุฑ ุตู <strong>Thread Pool</strong> ุงุณุชูุงุฏู ฺฉุฑุฏู. ุณูพุณ ุฑุดุชู ุงุตู (Main thread) ฺฉู ฺฉุงุฑ ุงูุฌุงู ุฏุงุฏู ู ุจู ุฎูุงุจ ูโุฑูุฏ. ุฏุฑ ุงู ุฒูุงูุ ฺฉ ุฑุดุชู ุขุฒุงุฏ ุงุฒ ุงุณุชุฎุฑ ุฑุดุชูโูุง ุงูุชุฎุงุจ ุดุฏู ู ูุชุฏ <strong>WaitCallbackMethod()</strong> ุงุฌุฑุง ูโุดูุฏ. ุณูพุณ ุฑุดุชู ุจู ุงุณุชุฎุฑ ุจุฑฺฏุฑุฏุงูุฏู ุดุฏู ู ูุงุจู ุงุณุชูุงุฏู ูุฌุฏุฏ ุฎูุงูุฏ ุจูุฏ. ุงุฌุฑุง ุจุฑูุงูู ุจู ุฑุดุชู ุงุตู ุจุงุฒูโฺฏุฑุฏุฏ ู ุฏุฑ ููุงุช ุจุฑูุงูู ุฎุงุชูู ูพุฏุง ูโฺฉูุฏ.</p>
<hr>
<h2>๐ ุงุณุชูุงุฏู ุงุฒ <strong>Mutex</strong> ุจุง ุฑุดุชูโูุง ููุฒูุงู</h2>
<p>ุฏุฑ ุจุฎุด ุจุนุฏุ ุจู ุณุฑุงุบ <strong>Mutex (ุดุก ูููโฺฉููุฏู)</strong> ูโุฑูู.</p>
<p>ุฏุฑ C#ุ ฺฉ <strong>Mutex</strong> ฺฉ ุดุก ูููโฺฉููุฏู ุฑุดุชู ุงุณุช ฺฉู ูโุชูุงูุฏ ุจู ฺูุฏู ูุฑุขูุฏ ฺฉุงุฑ ฺฉูุฏ. ุชููุง ูุฑุขูุฏ ฺฉู ุฏุฑุฎูุงุณุช ุง ุขุฒุงุฏุณุงุฒ ฺฉ ููุจุน ุฑุง ุฏุงุฑุฏุ ูโุชูุงูุฏ <strong>Mutex</strong> ุฑุง ุชุบุฑ ุฏูุฏ. ุฒูุงู ฺฉู ฺฉ <strong>Mutex</strong> ููู ุดูุฏุ ุจูู ูุฑุขูุฏูุง ุจุงุฏ ุฏุฑ ุตู ููุชุธุฑ ุจูุงููุฏ. ููุช ููู ุขุฒุงุฏ ุดุฏุ ุจูู ูโุชูุงููุฏ ุจู ููุจุน ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดูุฏ. ฺูุฏู ุฑุดุชู ูโุชูุงููุฏ ุงุฒ ฺฉ <strong>Mutex</strong> ุงุณุชูุงุฏู ฺฉููุฏุ ุงูุง ููุท ุจูโุตูุฑุช <strong>ููุฒูุงูโุณุงุฒ ุดุฏู (Synchronous)</strong>.</p>
<h3>ูุฒุงุง ุงุณุชูุงุฏู ุงุฒ Mutex</h3>
<ul>
<li><strong>Mutex</strong> ฺฉ ููู ุณุงุฏู ุงุณุช ฺฉู ูุจู ุงุฒ ูุฑูุฏ ุจู ุจุฎุด ุญุณุงุณ ุงุฒ ฺฉุฏ ฺฏุฑูุชู ูโุดูุฏ ู ููฺฏุงู ุฎุฑูุฌ ุงุฒ ุขู ุขุฒุงุฏ ูโุดูุฏ.</li>
<li>ฺูู ุฏุฑ ูุฑ ูุญุธู ุชููุง ฺฉ ุฑุดุชู ูุงุฑุฏ ุจุฎุด ุญุณุงุณ ูโุดูุฏุ ุฏุงุฏูโูุง ุฏุฑ ุญุงูุช ุณุงุฒฺฏุงุฑ ุจุงู ูโูุงููุฏ ู <strong>Race Condition (ุชุฏุงุฎู ุฏุงุฏูโูุง)</strong> ุฑุฎ ููโุฏูุฏ.</li>
</ul>
<h3>ูุนุงุจ ุงุณุชูุงุฏู ุงุฒ Mutex</h3>
<ul>
<li><strong>Starvation (ฺฏุฑุณูฺฏ ุฑุดุชู)</strong>: ุงฺฏุฑ ุฑุดุชูโุง ููู ุฑุง ุฏุฑ ุงุฎุชุงุฑ ุฏุงุดุชู ุจุงุดุฏ ู ุจู ุฎูุงุจ ุจุฑูุฏ ุง ูุชููู ุดูุฏุ ุฑุดุชูโูุง ุฏฺฏุฑ ููโุชูุงููุฏ ุงุฏุงูู ุฏููุฏ.</li>
<li>ููุช ฺฉ <strong>Mutex</strong> ููู ุดุฏู ุงุณุชุ ููุท ููุงู ุฑุดุชูโุง ฺฉู ููู ุฑุง ฺฏุฑูุชู ูโุชูุงูุฏ ุขู ุฑุง ุขุฒุงุฏ ฺฉูุฏ. ูฺ ุฑุดุชู ุฏฺฏุฑ ููโุชูุงูุฏ ููู ุฑุง ุจฺฏุฑุฏ ุง ุขุฒุงุฏ ฺฉูุฏ.</li>
<li>ุฏุฑ ูุฑ ูุญุธู ููุท ฺฉ ุฑุดุชู ุงุฌุงุฒู ูุฑูุฏ ุจู ุจุฎุด ุญุณุงุณ ุฑุง ุฏุงุฑุฏ. ุงู ููุถูุน ูโุชูุงูุฏ ุจุงุนุซ ูุฏุฑ ุฑูุช ุฒูุงู <strong>CPU</strong> ุดูุฏุ ุฒุฑุง ูพุงุฏูโุณุงุฒ Mutex ููฺฉู ุงุณุช ุจู ุญุงูุช <strong>Busy Waiting (ุงูุชุธุงุฑ ูุนุงู)</strong> ููุฌุฑ ุดูุฏ.</li>
</ul>
<hr>
<h3>โ๏ธ ุจุฑูุงูู ููููู ุจุฑุง ุงุณุชูุงุฏู ุงุฒ Mutex</h3>
<p>ุงุจุชุฏุง ุฏุฑ ุจุงูุง ฺฉูุงุณุ ูุชุบุฑ ุฒุฑ ุฑุง ุงุถุงูู ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> Mutex _mutex = <span class="hljs-keyword">new</span> Mutex();
</code></pre>
<p>ุฏุฑ ุงูุฌุงุ ฺฉ ุดุก ุงุจุชุฏุง ุจู ูุงู <strong>_mutex</strong> ุชุนุฑู ฺฉุฑุฏูโุงู ฺฉู ุจุฑุง ููฺฏุงูโุณุงุฒ ุจู ูุฑุขูุฏูุง ุงุณุชูุงุฏู ุฎูุงูุฏ ุดุฏ.</p>
<p>ุญุงูุง ูุชุฏ ุจุฑุง ููุงุด ููฺฏุงูโุณุงุฒ ุฑุดุชูโูุง ุจุง ุงุณุชูุงุฏู ุงุฒ Mutex ุงุถุงูู ูโฺฉูู:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ThreadSynchronisationUsingMutex</span>()</span>
{
    <span class="hljs-keyword">try</span>
    {
        _mutex.WaitOne();
        Message(<span class="hljs-string">$&quot;Domain Entered By: <span class="hljs-subst">{Thread.CurrentThread.Name}</span>&quot;</span>);
        Thread.Sleep(<span class="hljs-number">500</span>);
        Message(<span class="hljs-string">$&quot;Domain Left By: <span class="hljs-subst">{Thread.CurrentThread.Name}</span>&quot;</span>);
    }
    <span class="hljs-keyword">finally</span>
    {
        _mutex.ReleaseMutex();
    }
}
</code></pre>
<p>ุฏุฑ ุงู ูุชุฏุ ุฑุดุชู ุฌุงุฑ ุชุง ุฒูุงู ฺฉู <strong>Wait Handle</strong> (ุฏุณุชฺฏุฑู ุงูุชุธุงุฑ) ุณฺฏูุงู ุฏุฑุงูุช ฺฉูุฏุ ุจููฺฉู ูโุดูุฏ. ููุช ุณฺฏูุงู ุฏุงุฏู ุดูุฏุ ุฑุดุชู ุจุนุฏ ูโุชูุงูุฏ ูุงุฑุฏ ุดูุฏ. ูพุณ ุงุฒ ูพุงุงู ฺฉุงุฑุ ุณุงุฑ ุฑุดุชูโูุง ุงุฒ ุญุงูุช ุงูุชุธุงุฑ ุขุฒุงุฏ ุดุฏู ู ุงูฺฉุงู ุฏุณุชุฑุณ ุจู Mutex ุฑุง ุฎูุงููุฏ ุฏุงุดุช.</p>
<p>ูุชุฏ ุจุนุฏ ุจุฑุง ุงุฌุฑุง ููููู Mutex:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">MutexExample</span>()</span>
{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">10</span>; i++)
    {
        <span class="hljs-keyword">var</span> thread = <span class="hljs-keyword">new</span> Thread(ThreadSynchronisationUsingMutex)
        {
            Name = <span class="hljs-string">$&quot;Mutex Example Thread: <span class="hljs-subst">{i}</span>&quot;</span>
        };
        thread.Start();
    }
}
</code></pre>
<p>ุฏุฑ ุงู ูุชุฏุ 10 ุฑุดุชู ุงุฌุงุฏ ฺฉุฑุฏู ู ุขูโูุง ุฑุง ุดุฑูุน ูโฺฉูู. ูุฑ ุฑุดุชู ูุชุฏ <strong>ThreadSynchronisationUsingMutex()</strong> ุฑุง ุงุฌุฑุง ูโฺฉูุฏ.</p>
<p>ุฏุฑ ููุงุชุ ูุชุฏ <strong>Main()</strong> ุฑุง ุจูโุฑูุฒุฑุณุงู ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] <span class="hljs-keyword">args</span></span>)</span>
{
    SemaphoreExample();
    Console.ReadKey();
}
</code></pre>
<p>ูุชุฏ <strong>Main()</strong> ูููููโ ุงุณุชูุงุฏู ุงุฒ <strong>Mutex</strong> ูุง ุฑุง ุงุฌุฑุง ูโฺฉูุฏ. ุฎุฑูุฌ ุจุงุฏ ูุดุงุจู ุชุตูุฑ ุฒุฑ ุจุงุดุฏ: ๐</p>
<div align="center">
<p><img src="../../../assets/image/08/Table%208-5.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ูุซุงู ฺฉู ุงุฌุฑุง ฺฉุฑุฏู ููฺฉู ุงุณุช ูุฑ ุจุงุฑ ุงุนุฏุงุฏ ูุฎุชูู ุจุฑุง ุฑุดุชูโูุง ูุดุงู ุฏูุฏ. ุญุช ุงฺฏุฑ ุงุนุฏุงุฏ ูุดุงุจู ุจุงุดูุฏุ ููฺฉู ุงุณุช ุชุฑุชุจ ููุงุด ุขูโูุง ูุชูุงูุช ุจุงุดุฏ.</p>
<p>ุญุงูุง ฺฉู ุจุง <strong>Mutex</strong> ุขุดูุง ุดุฏูุ ุจุงุฏ ุจู <strong>Semaphore (ุณููุงููุฑ)</strong> ุจูพุฑุฏุงุฒู.</p>
<hr>
<h2>๐ก ฺฉุงุฑ ุจุง ุฑุดุชูโูุง ููุงุฒ ุจุง ุงุณุชูุงุฏู ุงุฒ <strong>Semaphore</strong></h2>
<p>ุฏุฑ ุจุฑูุงููโูุง ฺูุฏุฑุดุชูโุง (<strong>Multi-threaded Applications</strong>)ุ ฺฉ ุนุฏุฏ ุบุฑููู ุจู ูุงู <strong>Semaphore</strong> ุจู ุฑุดุชูโูุง ุจู ุงุดุชุฑุงฺฉ ฺฏุฐุงุดุชู ูโุดูุฏ. ุงู ููุฏุงุฑ ูโุชูุงูุฏ <strong>ฑ</strong> ุง <strong>ฒ</strong> ุจุงุดุฏ ฺฉู ุฏุฑ ููฺฏุงูโุณุงุฒ ุจูโุชุฑุชุจ ุจู ูุนู <strong>ุงูุชุธุงุฑ (Wait)</strong> ู <strong>ุณฺฏูุงู (Signal)</strong> ุงุณุช.<br>
ูโุชูุงู ฺฉ Semaphore ุฑุง ุจู ุชุนุฏุงุฏ <strong>Buffer (ุญุงูุธู ูููุช)</strong> ูุฑุชุจุท ฺฉุฑุฏ ุชุง ูุฑุขูุฏูุง ูุฎุชูู ุจูโุตูุฑุช ููโุฒูุงู ุฑู ูุฑฺฉุฏุงู ฺฉุงุฑ ฺฉููุฏ.</p>
<p>ุจูโุทูุฑ ุฎูุงุตูุ <strong>Semaphore</strong> ฺฉ ูฺฉุงูุฒู ุณฺฏูุงูโุฏู ุงุณุช ฺฉู ุงุฒ ุงููุงุน <strong>Integer</strong> ู <strong>Binary</strong> ุจูุฏู ู ุจุง ุนููุงุช <strong>Wait</strong> ู <strong>Signal</strong> ูุงุจู ุชุบุฑ ุงุณุช. ุงฺฏุฑ ููุงุจุน ุขุฒุงุฏ ููุฌูุฏ ูุจุงุดูุฏุ ูุฑุขูุฏูุง ฺฉู ูุงุฒ ุจู ููุจุน ุฏุงุฑูุฏ ุจุงุฏ ุนููุงุช <strong>Wait</strong> ุฑุง ุงุฌุฑุง ฺฉููุฏ ุชุง ุฒูุงู ฺฉู ููุฏุงุฑ Semaphore ุจุฒุฑฺฏโุชุฑ ุงุฒ ุตูุฑ ุดูุฏ. Semaphore ูโุชูุงูุฏ ฺูุฏู ุฑุดุชู ุจุฑูุงูู ุฑุง ูุฏุฑุช ฺฉูุฏ ู ูุฑ ุดุก ูโุชูุงูุฏ ุขู ุฑุง ุชุบุฑ ุฏูุฏุ ููุจุน ุจฺฏุฑุฏ ุง ุขุฒุงุฏ ฺฉูุฏ.</p>
<h3>ูุฒุงุง Semaphore</h3>
<ul>
<li>ฺูุฏู ุฑุดุชู ูโุชูุงููุฏ ุจูโุทูุฑ ููโุฒูุงู ุจู ุจุฎุด ุญุณุงุณ ุงุฒ ฺฉุฏ ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดูุฏ.</li>
<li>Semaphore ุฏุฑ ุณุทุญ ูุณุชู (<strong>Kernel</strong>) ุงุฌุฑุง ูโุดูุฏ ู ูุงุจุณุชู ุจู ูุงุดู ูุณุช.</li>
<li>ุจุฎุด ุญุณุงุณ ฺฉุฏ ุฏุฑ ุจุฑุงุจุฑ ฺูุฏู ูุฑุขูุฏ ูุญุงูุธุช ูโุดูุฏ ู ุจุฑุฎูุงู Mutexุ Semaphore ุฒูุงู ูพุฑุฏุงุฒุด ู ููุงุจุน ุฑุง ูุฏุฑ ููโุฏูุฏ.</li>
</ul>
<h3>ูุนุงุจ Semaphore</h3>
<ul>
<li><strong>Priority Inversion (ูุงุฑููฺฏ ุงูููุช)</strong>: ุฒูุงู ุฑุฎ ูโุฏูุฏ ฺฉู ฺฉ ุฑุดุชู ุจุง ุงูููุช ุจุงูุง ูุฌุจูุฑ ุจุงุดุฏ ููุชุธุฑ ุขุฒุงุฏ ุดุฏู Semaphore ุชูุณุท ฺฉ ุฑุดุชู ุจุง ุงูููุช ูพุงู ุจูุงูุฏ.</li>
<li>ุงฺฏุฑ ุฑุดุชูโูุง ุจุง ุงูููุช ูุชูุณุท ุฌูู ุชฺฉูู ุดุฏู ุฑุดุชูโูุง ุจุง ุงูููุช ูพุงู ุฑุง ุจฺฏุฑูุฏุ ูุดฺฉู <strong>Unbounded Priority Inversion</strong> ูพุด ูโุขุฏ ฺฉู ุฏุฑ ุขู ููโุชูุงู ุชุฃุฎุฑ ุฑุดุชูโูุง ุงูููุช ุจุงูุง ุฑุง ูพุดโุจู ฺฉุฑุฏ.</li>
<li>ุณุณุชูโุนุงูู ุจุงุฏ ููู ุนููุงุช <strong>Wait</strong> ู <strong>Signal</strong> ุฑุง ูพฺฏุฑ ฺฉูุฏ ฺฉู ูพฺุฏฺฏ ุงุฌุงุฏ ูโฺฉูุฏ.</li>
<li>ุงุณุชูุงุฏู ุงุฒ Semaphore ูุฑุงุฑุฏุงุฏ ุงุณุช ู ุงุฌุจุงุฑ ูุณุชุ ุงูุง ุงฺฏุฑ ุนููุงุช <strong>Wait</strong> ู <strong>Signal</strong> ุฑุง ุฏุฑ ุชุฑุชุจ ุฏุฑุณุช ุงูุฌุงู ูุฏูุฏุ ุฎุทุฑ <strong>Deadlock (ููู ุจูโุจุณุช)</strong> ูุฌูุฏ ุฏุงุฑุฏ.</li>
<li>ุฏุฑ ุณุณุชูโูุง ุจุฒุฑฺฏุ ููฺฉู ุงุณุช <strong>Modularity (ูุงฺููุงุฑ ุจูุฏู)</strong> ฺฉุงูุด ุงุจุฏ ู ฺฉุฏ ุฏุฑ ูุนุฑุถ ุฎุทุงูุง ุจุฑูุงููโููุณ ู ููุถ ูููโูุง ูุฑุงุฑ ฺฏุฑุฏ.</li>
</ul>
<hr>
<h3>โ๏ธ ุจุฑูุงูู ููููู ุจุง ุงุณุชูุงุฏู ุงุฒ Semaphore</h3>
<p>ุงุจุชุฏุง ฺฉ ูุชุบุฑ Semaphore ุชุนุฑู ูโฺฉูู:</p>
<pre class="hljs"><code><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> Semaphore _semaphore = <span class="hljs-keyword">new</span> Semaphore(<span class="hljs-number">2</span>, <span class="hljs-number">4</span>);
</code></pre>
<p>ูพุงุฑุงูุชุฑ ุงูู ูุดุฎุต ูโฺฉูุฏ ฺูุฏ ุฏุฑุฎูุงุณุช ูโุชูุงููุฏ ุจูโุทูุฑ ููโุฒูุงู ูพุฐุฑูุชู ุดููุฏ.<br>
ูพุงุฑุงูุชุฑ ุฏูู ุญุฏุงฺฉุซุฑ ุชุนุฏุงุฏ ุฏุฑุฎูุงุณุชโูุง ุฑุง ฺฉู ูโุชูุงู ููโุฒูุงู ูพุฐุฑูุช ูุดุฎุต ูโฺฉูุฏ.</p>
<p>ุญุงูุง ูุชุฏ <strong>StartSemaphore()</strong> ุฑุง ุงุถุงูู ูโฺฉูู:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">StartSemaphore</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> id</span>)</span>
{
    Console.WriteLine(<span class="hljs-string">$&quot;Object <span class="hljs-subst">{id}</span> wants semaphore access.&quot;</span>);
    <span class="hljs-keyword">try</span>
    {
        _semaphore.WaitOne();
        Console.WriteLine(<span class="hljs-string">$&quot;Object <span class="hljs-subst">{id}</span> gained semaphore access.&quot;</span>);
        Thread.Sleep(<span class="hljs-number">1000</span>);
        Console.WriteLine(<span class="hljs-string">$&quot;Object <span class="hljs-subst">{id}</span> has exited semaphore.&quot;</span>);
    }
    <span class="hljs-keyword">finally</span>
    {
        _semaphore.Release();
    }
}
</code></pre>
<p>ุฏุฑ ุงู ูุชุฏุ ุฑุดุชู ุฌุงุฑ ุชุง ุฒูุงู ฺฉู <strong>Wait Handle</strong> ุณฺฏูุงู ุฏุฑุงูุช ฺฉูุฏ ุจููฺฉู ูโุดูุฏ. ุณูพุณ ุฑุดุชู ฺฉุงุฑ ุฎูุฏ ุฑุง ุงูุฌุงู ูโุฏูุฏ ู ุฏุฑ ูพุงุงู Semaphore ุขุฒุงุฏ ูโุดูุฏ ู ููุฏุงุฑุด ุจู ุญุงูุช ูุจู ุจุฑูโฺฏุฑุฏุฏ.</p>
<p>ุญุงูุง ูุชุฏ <strong>SemaphoreExample()</strong> ุฑุง ุงุถุงูู ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SemaphoreExample</span>()</span>
{
    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">10</span>; i++)
    {
        Thread t = <span class="hljs-keyword">new</span> Thread(StartSemaphore);
        t.Start(i);
    }
}
</code></pre>
<p>ุงู ูุซุงู ฑฐ ุฑุดุชู ุงุฌุงุฏ ูโฺฉูุฏ ฺฉู ูุชุฏ <strong>StartSemaphore()</strong> ุฑุง ุงุฌุฑุง ูโฺฉููุฏ.</p>
<p>ุฏุฑ ููุงุชุ ูุชุฏ <strong>Main()</strong> ุฑุง ุจูโุฑูุฒุฑุณุงู ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] <span class="hljs-keyword">args</span></span>)</span>
{
    SemaphoreExample();
    Console.ReadKey();
}
</code></pre>
<p>ูุชุฏ <strong>Main()</strong> ูุชุฏ <strong>SemaphoreExample()</strong> ุฑุง ูุฑุงุฎูุงู ฺฉุฑุฏู ู ุณูพุณ ููุชุธุฑ ูโูุงูุฏ ุชุง ฺฉุงุฑุจุฑ ฺฉูุฏ ุฑุง ูุดุงุฑ ุฏูุฏ ุชุง ุจุฑูุงูู ุฎุงุชูู ูพุฏุง ฺฉูุฏ. ุฎุฑูุฌ ุจุงุฏ ูุดุงุจู ุชุตูุฑ ุฒุฑ ุจุงุดุฏ: ๐</p>
<div align="center">
<p><img src="../../../assets/image/08/Table%208-6.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ุจุงุฏ ุจู ูุญูู ูุญุฏูุฏ ฺฉุฑุฏู ุชุนุฏุงุฏ <strong>ูพุฑุฏุงุฒูุฏูโูุง ู ุฑุดุชูโูุง ุฏุฑ Thread Pool</strong> ุจูพุฑุฏุงุฒู.</p>
<hr>
<h2>โ๏ธ ูุญุฏูุฏ ฺฉุฑุฏู ุชุนุฏุงุฏ ูพุฑุฏุงุฒูุฏูโูุง ู ุฑุดุชูโูุง ุฏุฑ <strong>Thread Pool</strong></h2>
<p>ฺฏุงู ุงููุงุช ูุงุฒ ุงุณุช ฺฉู ุชุนุฏุงุฏ ูพุฑุฏุงุฒูุฏูโูุง ู ุฑุดุชูโูุง ููุฑุฏ ุงุณุชูุงุฏู ุชูุณุท ุจุฑูุงูู ุฎูุฏ ุฑุง ูุญุฏูุฏ ฺฉูุฏ.</p>
<h3>ูุญุฏูุฏ ฺฉุฑุฏู ูพุฑุฏุงุฒูุฏูโูุง</h3>
<p>ุจุฑุง ฺฉุงูุด ุชุนุฏุงุฏ ูพุฑุฏุงุฒูุฏูโูุง ููุฑุฏ ุงุณุชูุงุฏูุ ุงุจุชุฏุง ูพุฑุฏุงุฒุด ุฌุงุฑ ุฑุง ุฏุฑุงูุช ฺฉุฑุฏู ู ููุฏุงุฑ <strong>ProcessorAffinity</strong> ุขู ุฑุง ุชูุธู ูโฺฉูู.<br>
ูุซูุงู ูุฑุถ ฺฉูุฏ ฺฉ ฺฉุงููพูุชุฑ ฺูุงุฑ ูุณุชูโุง ุฏุงุฑู ู ูโุฎูุงูู ููุท ุงุฒ ุฏู ูุณุชู ุงูู ุงุณุชูุงุฏู ฺฉูู. ููุฏุงุฑ ุจุงูุฑ ุฏู ูุณุชู ุงูู ุจุฑุงุจุฑ ุงุณุช ุจุง <code>11</code> ฺฉู ุฏุฑ ุญุงูุช ุนุฏุฏ ุตุญุญ ุจุฑุงุจุฑ ุจุง <strong>3</strong> ุงุณุช.</p>
<p>ูุชุฏ ุฏุฑ ฺฉ ุจุฑูุงูู ุฌุฏุฏ <strong>.NET Framework Console</strong> ุงุฌุงุฏ ูโฺฉูู ู ูุงู ุขู ุฑุง <strong>AssignCores()</strong> ูโฺฏุฐุงุฑู:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">AssignCores</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> cores</span>)</span>
{
    Process.GetCurrentProcess().ProcessorAffinity = <span class="hljs-keyword">new</span> IntPtr(cores);
}
</code></pre>
<p>ุฏุฑ ุงู ูุชุฏุ ฺฉ ุนุฏุฏ ุตุญุญ ุจู ุนููุงู ูุฑูุฏ ูโุฏูู. ุงู ุนุฏุฏ ุชูุณุท <strong>.NET Framework</strong> ุจู ููุฏุงุฑ ุจุงูุฑ ุชุจุฏู ูโุดูุฏ ู ูพุฑุฏุงุฒูุฏูโูุง ฺฉู ููุฏุงุฑ ฑ ุฏุงุฑูุฏ ุงุณุชูุงุฏู ูโุดููุฏุ ุฏุฑ ุญุงู ฺฉู ูพุฑุฏุงุฒูุฏูโูุง ฺฉู ููุฏุงุฑุดุงู ฐ ุงุณุชุ ุงุณุชูุงุฏู ูุฎูุงููุฏ ุดุฏ.<br>
ูุซุงูโูุง:</p>
<ul>
<li><code>0110 (6)</code> โ ุงุณุชูุงุฏู ุงุฒ ูุณุชูโูุง 2 ู 3</li>
<li><code>1100 (3)</code> โ ุงุณุชูุงุฏู ุงุฒ ูุณุชูโูุง 1 ู 2</li>
<li><code>0011 (12)</code> โ ุงุณุชูุงุฏู ุงุฒ ูุณุชูโูุง 3 ู 4</li>
</ul>
<blockquote>
<p>ุงฺฏุฑ ูุงุฒ ุจู ุงุฏุขูุฑ ุจุงูุฑ ุฏุงุฑุฏุ ูโุชูุงูุฏ ุจู <a href="https://www.computerhope.com/jargon/b/binary.htm">ุงู ููฺฉ</a> ูุฑุงุฌุนู ฺฉูุฏ.</p>
</blockquote>
<hr>
<h3>ุชูุธู ุญุฏุงฺฉุซุฑ ุชุนุฏุงุฏ ุฑุดุชูโูุง</h3>
<p>ุจุฑุง ุชูุธู ุญุฏุงฺฉุซุฑ ุชุนุฏุงุฏ ุฑุดุชูโูุงุ ูุชุฏ <strong>SetMaxThreads()</strong> ุงุฒ ฺฉูุงุณ <strong>ThreadPool</strong> ุฑุง ูุฑุงุฎูุงู ูโฺฉูู. ุงู ูุชุฏ ุฏู ูพุงุฑุงูุชุฑ ูโฺฏุฑุฏ:</p>
<ol>
<li>ุญุฏุงฺฉุซุฑ ุชุนุฏุงุฏ <strong>Worker Threads</strong> ุฏุฑ Thread Pool</li>
<li>ุญุฏุงฺฉุซุฑ ุชุนุฏุงุฏ <strong>Asynchronous I/O Threads</strong> ุฏุฑ Thread Pool</li>
</ol>
<p>ูุชุฏ ุฒุฑ ุฑุง ุจุฑุง ุชูุธู ุญุฏุงฺฉุซุฑ ุชุนุฏุงุฏ ุฑุดุชูโูุง ุงุถุงูู ูโฺฉูู:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SetMaxThreads</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> workerThreads, <span class="hljs-built_in">int</span> asyncIoThreads</span>)</span>
{
    ThreadPool.SetMaxThreads(workerThreads, asyncIoThreads);
}
</code></pre>
<p>ููุงูโุทูุฑ ฺฉู ูโุจูุฏุ ุชูุธู ุญุฏุงฺฉุซุฑ ุชุนุฏุงุฏ ุฑุดุชูโูุง ู ูพุฑุฏุงุฒูุฏูโูุง ุจุณุงุฑ ุณุงุฏู ุงุณุช. ุฏุฑ ุงุบูุจ ููุงูุน ูุงุฒ ุจู ุงูุฌุงู ุงู ฺฉุงุฑ ุฏุฑ ุจุฑูุงููโูุง ูุณุชุ ูฺฏุฑ ุงูฺฉู ุจุฑูุงูู ุดูุง ุจุง ูุดฺฉูุงุช ุนููฺฉุฑุฏ ููุงุฌู ุดูุฏ. ุงฺฏุฑ ุจุฑูุงูู ูุดฺฉู ุฏุฑ ุนููฺฉุฑุฏ ูุฏุงุฑุฏุ ุจูุชุฑ ุงุณุช ุชุนุฏุงุฏ ุฑุดุชูโูุง ู ูพุฑุฏุงุฒูุฏูโูุง ุฑุง ุชูุธู ูฺฉูุฏ.</p>
<hr>
<h2>๐ ุฌููฺฏุฑ ุงุฒ <strong>Deadlocks (ููู ุจูโุจุณุช)</strong></h2>
<p>ฺฉ <strong>Deadlock</strong> ุฒูุงู ุฑุฎ ูโุฏูุฏ ฺฉู ุฏู ุง ฺูุฏ ุฑุดุชู ุฏุฑ ุญุงู ุงุฌุฑุง ูุณุชูุฏ ู ููุชุธุฑ ฺฉุฏฺฏุฑ ุจุฑุง ุชฺฉูู ูุณุชูุฏ. ุงู ูุดฺฉู ุฏุฑ ุจุฑูุงููโูุง ุจุงุนุซ <strong>ฺฏุฑ ฺฉุฑุฏู ุจุฑูุงูู</strong> ูโุดูุฏ ู ุจุฑุง ฺฉุงุฑุจุฑ ููุง ูโุชูุงูุฏ ุจุณุงุฑ ุฎุทุฑูุงฺฉ ุจุงุดุฏุ ฺุฑุง ฺฉู ููฺฉู ุงุณุช ุฏุงุฏูโูุง ุงุฒ ุจู ุจุฑููุฏ ุง ุฎุฑุงุจ ุดููุฏ.</p>
<h3>ูุซุงู ูุงูุน</h3>
<p>ูุฑุถ ฺฉูุฏ ฺฉ ุชุฑุงฺฉูุด ุจุงูฺฉ ุจุฒุฑฺฏ ุฏุงุฑู ฺฉู ุจุงุฏ <strong>ยฃ1 ูููู</strong> ุงุฒ ุญุณุงุจ ุจุงูฺฉ ฺฉ ูุดุชุฑ ุจุฑุง ูพุฑุฏุงุฎุช ูุงูุงุช HMRC ุจุฑุฏุงุดุช ุดูุฏ.</p>
<ul>
<li>ูพูู ุงุฒ ุญุณุงุจ ฺฉุณุจโูฺฉุงุฑ ูุดุชุฑ ุจุฑุฏุงุดุช ูโุดูุฏ</li>
<li>ูุจู ุงุฒ ุงูฺฉู ูพูู ุจู ุญุณุงุจ HMRC ูุงุฑุฒ ุดูุฏุ ฺฉ <strong>Deadlock</strong> ุฑุฎ ูโุฏูุฏ</li>
<li>ูฺ ฺฏุฒูู ุจุงุฒุงุจ ูุฌูุฏ ูุฏุงุฑุฏ ู ุจุฑูุงูู ุจุงุฏ ุฎุงุชูู ุงุจุฏ ู ุฏูุจุงุฑู ุงุฌุฑุง ุดูุฏ</li>
</ul>
<p>ูุชุฌู: ุญุณุงุจ ุจุงูฺฉ ฺฉุณุจโูฺฉุงุฑ <strong>ยฃ1 ูููู</strong> ฺฉุงูุด ูโุงุจุฏ ุงูุง ูุงูุงุช ูพุฑุฏุงุฎุช ูุดุฏู ุงุณุช ู ูุดุชุฑ ูููุฒ ูุณุฆูู ูพุฑุฏุงุฎุช ุขู ุงุณุช. ุงู ูุซุงู ุงููุช ุฌููฺฏุฑ ุงุฒ ุฑุฎ ุฏุงุฏู <strong>Deadlocks</strong> ุฑุง ูุดุงู ูโุฏูุฏ.</p>
<p>ุจุฑุง ุณุงุฏูโุชุฑ ฺฉุฑุฏู ููุถูุนุ ูุง ุจุง <strong>ุฏู ุฑุดุชู</strong> ฺฉุงุฑ ุฎูุงูู ฺฉุฑุฏุ ููุงูโุทูุฑ ฺฉู ุฏุฑ ูููุฏุงุฑ ุฒุฑ ูุดุงู ุฏุงุฏู ุดุฏู ุงุณุช:</p>
<div align="center">
<p><img src="../../../assets/image/08/Table%208-7.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ูุง ุฑุดุชูโูุงูุงู ุฑุง <strong>Thread 1</strong> ู <strong>Thread 2</strong> ู ููุงุจุนูุงู ุฑุง <strong>Resource 1</strong> ู <strong>Resource 2</strong> ูโูุงูู.</p>
<ul>
<li><strong>Thread 1</strong> ฺฉ <strong>Lock</strong> ุฑู <strong>Resource 1</strong> ูโฺฏุฑุฏ.</li>
<li><strong>Thread 2</strong> ฺฉ <strong>Lock</strong> ุฑู <strong>Resource 2</strong> ูโฺฏุฑุฏ.</li>
</ul>
<p>ุญุงูุง:</p>
<ul>
<li><strong>Thread 1</strong> ูุงุฒ ุฏุงุฑุฏ ุจู <strong>Resource 2</strong> ุฏุณุชุฑุณ ูพุฏุง ฺฉูุฏุ ุงูุง ุจุงุฏ ููุชุธุฑ ุจูุงูุฏ ฺูู <strong>Thread 2</strong> ุขู ุฑุง ููู ฺฉุฑุฏู ุงุณุช.</li>
<li><strong>Thread 2</strong> ูุงุฒ ุฏุงุฑุฏ ุจู <strong>Resource 1</strong> ุฏุณุชุฑุณ ูพุฏุง ฺฉูุฏุ ุงูุง ุจุงุฏ ููุชุธุฑ ุจูุงูุฏ ฺูู <strong>Thread 1</strong> ุขู ุฑุง ููู ฺฉุฑุฏู ุงุณุช.</li>
</ul>
<p>ูุชุฌู ุงู ุงุณุช ฺฉู ูู <strong>Thread 1</strong> ู ูู <strong>Thread 2</strong> ุฏุฑ ุญุงูุช <strong>Wait</strong> ูุฑุงุฑ ูโฺฏุฑูุฏ. ุงุฒ ุขูุฌุง ฺฉู ูฺโฺฉ ุงุฒ ุฑุดุชูโูุง ููโุชูุงููุฏ ุงุฏุงูู ุฏููุฏ ุชุง ุฏฺฏุฑ ููุจุนุด ุฑุง ุขุฒุงุฏ ฺฉูุฏุ ูุฑ ุฏู ุฑุดุชู ูุงุฑุฏ ูุถุนุช <strong>Deadlock (ููู ุจูโุจุณุช)</strong> ูโุดููุฏ. ุฒูุงู ฺฉู ฺฉ ุจุฑูุงูู ฺฉุงููพูุชุฑ ุฏุฑ ุญุงูุช <strong>Deadlock</strong> ูุฑุงุฑ ุฏุงุฑุฏุ ุจุฑูุงูู ฺฏุฑ ูโฺฉูุฏ ู ูุฌุจูุฑ ูโุดูุฏ ุขู ุฑุง ุฎุงุชูู ุฏูุฏ.</p>
<p>ฺฉ ูุซุงู ฺฉุฏ ุจุฑุง <strong>Deadlock</strong> ุจูุชุฑู ุฑุงู ุจุฑุง ุชูุถุญ ุงู ููุถูุน ุงุณุช. ุฏุฑ ุจุฎุด ุจุนุฏุ ฺฉ ูุซุงู ุนูู ุงุฒ <strong>Deadlock</strong> ูโููุณู.</p>
<hr>
<h2>๐ฅ๏ธ ฺฉุฏููุณ ูุซุงู Deadlock</h2>
<p>ุจูุชุฑู ุฑูุด ุจุฑุง ููู ุงู ููุถูุนุ ฺฉ ูุซุงู ุนูู ุงุณุช. ูุง ุฏู ูุชุฏ ุฎูุงูู ููุดุช ฺฉู ูุฑ ฺฉุฏุงู ุฏุงุฑุง ุฏู <strong>Lock</strong> ูุฎุชูู ูุณุชูุฏ. ุงู ูุชุฏูุง ุงุดุง ุฑุง ููู ูโฺฉููุฏ ฺฉู ูุชุฏ ุฏฺฏุฑ ุจู ุขู ูุงุฒ ุฏุงุฑุฏ. ฺูู ูุฑ ุฑุดุชู ููุงุจุน ุฑุง ฺฉู ุฑุดุชู ุฏฺฏุฑ ูุงุฒ ุฏุงุฑุฏ ููู ูโฺฉูุฏุ ูุฑ ุฏู ุฑุดุชู ูุงุฑุฏ ุญุงูุช <strong>Deadlock</strong> ูโุดููุฏ. ุจุนุฏ ุงุฒ ุงูฺฉู ูุซุงู ูุง ฺฉุงุฑ ฺฉุฑุฏุ ุขู ุฑุง ุงุตูุงุญ ุฎูุงูู ฺฉุฑุฏ ุชุง ุงุฒ ูุถุนุช Deadlock ุจุงุฒุงุจ ุดูุฏ ู ุงุฏุงูู ุฏูุฏ.</p>
<p>ุงุจุชุฏุง ฺฉ ุจุฑูุงูู ุฌุฏุฏ <strong>.NET Framework Console</strong> ุงุฌุงุฏ ฺฉูุฏ ู ูุงู ุขู ุฑุง <strong>CH08_Deadlocks</strong> ุจฺฏุฐุงุฑุฏ. ูุงุฒ ุจู ุฏู ุดุก ุจู ุนููุงู ูุชุบุฑูุง ุนุถู ุฏุงุฑู:</p>
<pre class="hljs"><code><span class="hljs-keyword">static</span> <span class="hljs-built_in">object</span> _object1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">object</span>();
<span class="hljs-keyword">static</span> <span class="hljs-built_in">object</span> _object2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">object</span>();
</code></pre>
<p>ุงู ุงุดุงุก ุจู ุนููุงู <strong>Lock Objects</strong> ุงุณุชูุงุฏู ุฎูุงููุฏ ุดุฏ. ูุง ุฏู ุฑุดุชู ุฎูุงูู ุฏุงุดุช ู ูุฑ ุฑุดุชู ูุชุฏ ูุฎุตูุต ุจู ุฎูุฏ ุฑุง ุงุฌุฑุง ูโฺฉูุฏ.</p>
<hr>
<h3>ูุชุฏ Thread1Method()</h3>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Thread1Method</span>()</span>
{
    Console.WriteLine(<span class="hljs-string">&quot;Thread1Method: Thread1Method Entered.&quot;</span>);
    <span class="hljs-keyword">lock</span> (_object1)
    {
        Console.WriteLine(<span class="hljs-string">&quot;Thread1Method: Entered _object1 lock. Sleeping...&quot;</span>);
        Thread.Sleep(<span class="hljs-number">1000</span>);
        Console.WriteLine(<span class="hljs-string">&quot;Thread1Method: Woke from sleep&quot;</span>);
        <span class="hljs-keyword">lock</span> (_object2)
        {
            Console.WriteLine(<span class="hljs-string">&quot;Thread1Method: Entered _object2 lock.&quot;</span>);
        }
        Console.WriteLine(<span class="hljs-string">&quot;Thread1Method: Exited _object2 lock.&quot;</span>);
    }
    Console.WriteLine(<span class="hljs-string">&quot;Thread1Method: Exited _object1 lock.&quot;</span>);
}
</code></pre>
<ul>
<li>ุงู ูุชุฏ ุงุจุชุฏุง ฺฉ <strong>Lock</strong> ุฑู <strong>_object1</strong> ูโฺฏุฑุฏ.</li>
<li>ุณูพุณ ุจู ูุฏุช ฑ ุซุงูู <strong>Sleep</strong> ูโฺฉูุฏ.</li>
<li>ุจุนุฏ ุงุฒ ุจุฏุงุฑ ุดุฏูุ <strong>Lock</strong> ุฑู <strong>_object2</strong> ูโฺฏุฑุฏ.</li>
<li>ุฏุฑ ููุงุช ูุฑ ุฏู Lock ุฑุง ุขุฒุงุฏ ฺฉุฑุฏู ู ูุชุฏ ุฎุงุชูู ูโุงุจุฏ.</li>
</ul>
<hr>
<h3>ูุชุฏ Thread2Method()</h3>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Thread2Method</span>()</span>
{
    Console.WriteLine(<span class="hljs-string">&quot;Thread2Method: Thread1Method Entered.&quot;</span>);
    <span class="hljs-keyword">lock</span> (_object2)
    {
        Console.WriteLine(<span class="hljs-string">&quot;Thread2Method: Entered _object2 lock. Sleeping...&quot;</span>);
        Thread.Sleep(<span class="hljs-number">1000</span>);
        Console.WriteLine(<span class="hljs-string">&quot;Thread2Method: Woke from sleep.&quot;</span>);
        <span class="hljs-keyword">lock</span> (_object1)
        {
            Console.WriteLine(<span class="hljs-string">&quot;Thread2Method: Entered _object1 lock.&quot;</span>);
        }
        Console.WriteLine(<span class="hljs-string">&quot;Thread2Method: Exited _object1 lock.&quot;</span>);
    }
    Console.WriteLine(<span class="hljs-string">&quot;Thread2Method: Exited _object2 lock.&quot;</span>);
}
</code></pre>
<ul>
<li>ุงู ูุชุฏ ุงุจุชุฏุง ฺฉ <strong>Lock</strong> ุฑู <strong>_object2</strong> ูโฺฏุฑุฏ.</li>
<li>ุณูพุณ ุจู ูุฏุช ฑ ุซุงูู <strong>Sleep</strong> ูโฺฉูุฏ.</li>
<li>ุจุนุฏ ุงุฒ ุจุฏุงุฑ ุดุฏูุ <strong>Lock</strong> ุฑู <strong>_object1</strong> ูโฺฏุฑุฏ.</li>
<li>ุฏุฑ ููุงุช ูุฑ ุฏู Lock ุฑุง ุขุฒุงุฏ ฺฉุฑุฏู ู ูุชุฏ ุฎุงุชูู ูโุงุจุฏ.</li>
</ul>
<hr>
<h3>ูุชุฏ DeadlockNoRecovery()</h3>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DeadlockNoRecovery</span>()</span>
{
    Thread thread1 = <span class="hljs-keyword">new</span> Thread((ThreadStart)Thread1Method);
    Thread thread2 = <span class="hljs-keyword">new</span> Thread((ThreadStart)Thread2Method);
    thread1.Start();
    thread2.Start();
    Console.WriteLine(<span class="hljs-string">&quot;Press any key to exit.&quot;</span>);
    Console.ReadKey();
}
</code></pre>
<p>ุฏุฑ ุงู ูุชุฏ:</p>
<ul>
<li>ุฏู ุฑุดุชู ุงุฌุงุฏ ูโฺฉูู.</li>
<li>ูุฑ ุฑุดุชู ูุชุฏ ูุชูุงูุช ุฑุง ุงุฌุฑุง ูโฺฉูุฏ.</li>
<li>ูุฑ ุฏู ุฑุดุชู ุดุฑูุน ูโุดููุฏ.</li>
<li>ุจุฑูุงูู ุชุง ุฒูุงู ฺฉู ฺฉุงุฑุจุฑ ฺฉูุฏ ุฑุง ูุดุงุฑ ุฏูุฏุ ูุชููู ูโุดูุฏ.</li>
</ul>
<hr>
<h3>ูุชุฏ Main()</h3>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>()</span>
{
    DeadlockNoRecovery();
}
</code></pre>
<hr>
<p>ููฺฏุงู ุงุฌุฑุง ุจุฑูุงููุ ุจุงุฏ ุฎุฑูุฌ ูุดุงุจู ุชุตูุฑ ุฒุฑ ุฑุง ูุดุงูุฏู ฺฉูุฏ: ๐</p>
<div align="center">
<p><img src="../../../assets/image/08/Table%208-8.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ููุงูโุทูุฑ ฺฉู ูโุจูุฏุ ฺูู <strong>Thread1</strong> ุฑู <strong>_object1</strong> ููู ุฏุงุฑุฏุ <strong>Thread2</strong> ููโุชูุงูุฏ ุขู ุฑุง ููู ฺฉูุฏ. ููฺููุ ฺูู <strong>Thread2</strong> ุฑู <strong>_object2</strong> ููู ุฏุงุฑุฏุ <strong>Thread1</strong> ููโุชูุงูุฏ ุขู ุฑุง ููู ฺฉูุฏ. ุจูุงุจุฑุงู ูุฑ ุฏู ุฑุดุชู ูุงุฑุฏ <strong>Deadlock</strong> ูโุดููุฏ ู ุจุฑูุงูู ฺฏุฑ ูโฺฉูุฏ.</p>
<p>ุญุงูุง ฺฉุฏ ูโููุณู ฺฉู ูุดุงู ุฏูุฏ ฺฺฏููู ูโุชูุงู ุงุฒ ูููุน ุงู <strong>Deadlock</strong> ุฌููฺฏุฑ ฺฉุฑุฏ. ูุง ุงุฒ ูุชุฏ <strong>Monitor.TryEnter()</strong> ุงุณุชูุงุฏู ูโฺฉูู ุชุง ุชูุงุด ฺฉูู ุฏุฑ ูุฏุช ุฒูุงู ูุดุฎุต <strong>Lock</strong> ุจฺฏุฑู. ุณูพุณ ุฏุฑ ุตูุฑุช ููููุชุ ุจุง <strong>Monitor.Exit()</strong> ููู ุฑุง ุขุฒุงุฏ ูโฺฉูู.</p>
<hr>
<h3>ูุชุฏ DeadlockWithRecovery()</h3>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DeadlockWithRecovery</span>()</span>
{
    Thread thread4 = <span class="hljs-keyword">new</span> Thread((ThreadStart)Thread4Method);
    Thread thread5 = <span class="hljs-keyword">new</span> Thread((ThreadStart)Thread5Method);
    thread4.Start();
    thread5.Start();
    Console.WriteLine(<span class="hljs-string">&quot;Press any key to exit.&quot;</span>);
    Console.ReadKey();
}
</code></pre>
<ul>
<li>ุงู ูุชุฏ ุฏู <strong>Foreground Thread</strong> ุงุฌุงุฏ ูโฺฉูุฏ.</li>
<li>ุณูพุณ ุฑุดุชูโูุง ุฑุง ุดุฑูุน ฺฉุฑุฏูุ ูพุงู ุฑู ฺฉูุณูู ฺุงูพ ูโฺฉูุฏ ู ููุชุธุฑ ูโูุงูุฏ ุชุง ฺฉุงุฑุจุฑ ฺฉูุฏ ุฑุง ูุดุงุฑ ุฏูุฏ.</li>
</ul>
<hr>
<h3>ูุชุฏ Thread4Method()</h3>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Thread4Method</span>()</span>
{
    Console.WriteLine(<span class="hljs-string">&quot;Thread4Method: Entered _object1 lock. Sleeping...&quot;</span>);
    Thread.Sleep(<span class="hljs-number">1000</span>);
    Console.WriteLine(<span class="hljs-string">&quot;Thread4Method: Woke from sleep&quot;</span>);
    
    <span class="hljs-keyword">if</span> (!Monitor.TryEnter(_object1))
    {
        Console.WriteLine(<span class="hljs-string">&quot;Thread4Method: Failed to lock _object1.&quot;</span>);
        <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">try</span>
    {
        <span class="hljs-keyword">if</span> (!Monitor.TryEnter(_object2))
        {
            Console.WriteLine(<span class="hljs-string">&quot;Thread4Method: Failed to lock _object2.&quot;</span>);
            <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-keyword">try</span>
        {
            Console.WriteLine(<span class="hljs-string">&quot;Thread4Method: Doing work with _object2.&quot;</span>);
        }
        <span class="hljs-keyword">finally</span>
        {
            Monitor.Exit(_object2);
            Console.WriteLine(<span class="hljs-string">&quot;Thread4Method: Released _object2 lock.&quot;</span>);
        }
    }
    <span class="hljs-keyword">finally</span>
    {
        Monitor.Exit(_object1);
        Console.WriteLine(<span class="hljs-string">&quot;Thread4Method: Released _object1 lock.&quot;</span>);
    }
}
</code></pre>
<ul>
<li>ุงู ูุชุฏ ฑ ุซุงูู <strong>Sleep</strong> ูโฺฉูุฏ.</li>
<li>ุณูพุณ ุชูุงุด ูโฺฉูุฏ <strong>Lock</strong> ุฑู <strong>_object1</strong> ุจฺฏุฑุฏ. ุงฺฏุฑ ูููู ูุดูุฏุ ูุชุฏ ุจุงุฒ ูโฺฏุฑุฏุฏ.</li>
<li>ุงฺฏุฑ <strong>_object1</strong> ููู ุดูุฏุ ุชูุงุด ูโฺฉูุฏ <strong>Lock</strong> ุฑู <strong>_object2</strong> ุจฺฏุฑุฏ.</li>
<li>ุงฺฏุฑ ูููู ูุดูุฏุ ูุชุฏ ุจุงุฒ ูโฺฏุฑุฏุฏ.</li>
<li>ุงฺฏุฑ ููู ุดุฏุ ฺฉุงุฑ ูุงุฒู ุฑู <strong>_object2</strong> ุงูุฌุงู ูโุดูุฏ.</li>
<li>ุณูพุณ <strong>_object2</strong> ุขุฒุงุฏ ูโุดูุฏ ู ุฏุฑ ููุงุช <strong>_object1</strong> ูุฒ ุขุฒุงุฏ ูโุดูุฏ.</li>
</ul>
<hr>
<h3>ูุชุฏ Thread5Method()</h3>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Thread5Method</span>()</span>
{
    Console.WriteLine(<span class="hljs-string">&quot;Thread5Method: Entered _object2 lock. Sleeping...&quot;</span>);
    Thread.Sleep(<span class="hljs-number">1000</span>);
    Console.WriteLine(<span class="hljs-string">&quot;Thread5Method: Woke from sleep&quot;</span>);
    
    <span class="hljs-keyword">if</span> (!Monitor.TryEnter(_object2))
    {
        Console.WriteLine(<span class="hljs-string">&quot;Thread5Method: Failed to lock _object2.&quot;</span>);
        <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-keyword">try</span>
    {
        <span class="hljs-keyword">if</span> (!Monitor.TryEnter(_object1))
        {
            Console.WriteLine(<span class="hljs-string">&quot;Thread5Method: Failed to lock _object1.&quot;</span>);
            <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-keyword">try</span>
        {
            Console.WriteLine(<span class="hljs-string">&quot;Thread5Method: Doing work with _object1.&quot;</span>);
        }
        <span class="hljs-keyword">finally</span>
        {
            Monitor.Exit(_object1);
            Console.WriteLine(<span class="hljs-string">&quot;Thread5Method: Released _object1 lock.&quot;</span>);
        }
    }
    <span class="hljs-keyword">finally</span>
    {
        Monitor.Exit(_object2);
        Console.WriteLine(<span class="hljs-string">&quot;Thread5Method: Released _object2 lock.&quot;</span>);
    }
}
</code></pre>
<ul>
<li>ุนููฺฉุฑุฏ ุงู ูุชุฏ ููุงู Thread4Method ุงุณุชุ ุงูุง ุชุฑุชุจ ููู ฺฏุฑูุชู <strong>_object1</strong> ู <strong>_object2</strong> ุจุฑุนฺฉุณ ุงุณุช.</li>
</ul>
<hr>
<h3>ูุฑุงุฎูุงู ุฏุฑ Main()</h3>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>()</span>
{
    DeadlockWithRecovery();
}
</code></pre>
<p>ฺฉุฏ ุฑุง ฺูุฏ ุจุงุฑ ุงุฌุฑุง ฺฉูุฏ. ุฏุฑ ุงฺฉุซุฑ ููุงุฑุฏุ ุฎุฑูุฌ ูุดุงุจู ุชุตูุฑ ุฒุฑ ุฎูุงูุฏ ุจูุฏุ ุฌุง ฺฉู ููู <strong>Lockูุง</strong> ุจุง ููููุช ฺฏุฑูุชู ุดุฏูโุงูุฏ. โ</p>
<div align="center">
<p><img src="../../../assets/image/08/Table%208-9.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ุณูพุณุ ูุฑ ฺฉูุฏ ุฑุง ูุดุงุฑ ุฏูุฏ ุชุง ุจุฑูุงูู ุฎุงุฑุฌ ุดูุฏ. ุงฺฏุฑ ุจุฑูุงูู ุฑุง ฺูุฏ ุจุงุฑ ุงุฌุฑุง ฺฉูุฏุ ุฏุฑ ููุงุช ุฎูุงูุฏ ุฏุฏ ฺฉู ฺฉ <strong>Lock</strong> ุดฺฉุณุช ูโุฎูุฑุฏ. ุจุฑูุงูู ูุชูุงูุณุช ุฏุฑ <strong>Thread5Method()</strong> ุฑู <strong>_object2</strong> ููู ุจฺฏุฑุฏ. ุจุง ุงู ุญุงูุ ุงฺฏุฑ ฺฉูุฏ ุฑุง ูุดุงุฑ ุฏูุฏุ ุจุฑูุงูู ุฎุงุฑุฌ ูโุดูุฏ.</p>
<p>ููุงูโุทูุฑ ฺฉู ูโุจูุฏุ ุจุง ุงุณุชูุงุฏู ุงุฒ <strong>Monitor.TryEnter()</strong> ูโุชูุงูุฏ ุชูุงุด ฺฉูุฏ ฺฉ ุดุก ุฑุง ููู ฺฉูุฏ. ุงูุง ุงฺฏุฑ ููู ฺฏุฑูุชู ูุดุฏุ ูโุชูุงูุฏ ุงูุฏุงู ุฏฺฏุฑ ุงูุฌุงู ุฏูุฏ ุจุฏูู ุงูฺฉู ุจุฑูุงูู ุดูุง ฺฏุฑ ฺฉูุฏ ุง <strong>Hang</strong> ุดูุฏ. โ</p>
<hr>
<h2>โก ูพุดฺฏุฑ ุงุฒ <strong>Race Conditions</strong></h2>
<p>ุฒูุงู ฺฉู ฺูุฏู ุฑุดุชู ุงุฒ ฺฉ ููุจุน ูุดุชุฑฺฉ ุงุณุชูุงุฏู ูโฺฉููุฏ ู ุฎุฑูุฌโูุง ูุชูุงูุช ุจู ุฏูู ุฒูุงูโุจูุฏ ูุฑ ุฑุดุชู ุชููุฏ ูโุดูุฏุ ุงู ูุถุนุช ุฑุง <strong>Race Condition</strong> ูโูุงููุฏ.<br>
ุฏุฑ ุงู ุจุฎุดุ ูุง ุงู ูุถุนุช ุฑุง ุจุง ฺฉ ูุซุงู ุนูู ูุดุงู ุฎูุงูู ุฏุงุฏ.</p>
<p>ุฏุฑ ูุซุงู ูุง:</p>
<ul>
<li>ุฏู ุฑุดุชู ูุฌูุฏ ุฎูุงูุฏ ุฏุงุดุช.</li>
<li>ูุฑ ุฑุดุชู ฺฉ ูุชุฏ ุฑุง ูุฑุงุฎูุงู ูโฺฉูุฏ ุชุง ุญุฑูู ุงููุจุง ุฑุง ฺุงูพ ฺฉูุฏ.</li>
<li>ฺฉ ูุชุฏ ุญุฑูู ุจุฒุฑฺฏ (<strong>Uppercase</strong>) ู ูุชุฏ ุฏฺฏุฑ ุญุฑูู ฺฉูฺฺฉ (<strong>Lowercase</strong>) ุฑุง ฺุงูพ ูโฺฉูุฏ.</li>
<li>ุงุฒ ุงู ูุซุงูุ ุฎูุงูุฏ ุฏุฏ ฺฉู ุฎุฑูุฌ ุงุดุชุจุงู ุงุณุช ู ูุฑ ุจุงุฑ ุงุฌุฑุง ุจุฑูุงูู ุฎุฑูุฌ ูุชูุงูุช ุฎูุงูุฏ ุจูุฏ.</li>
</ul>
<hr>
<h3>ูุชุฏ ThreadingRaceCondition()</h3>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ThreadingRaceCondition</span>()</span>
{
    Thread T1 = <span class="hljs-keyword">new</span> Thread(Method1);
    T1.Start();
    Thread T2 = <span class="hljs-keyword">new</span> Thread(Method2);
    T2.Start();
}
</code></pre>
<ul>
<li>
<p>ุงู ูุชุฏ ุฏู ุฑุดุชู ุชููุฏ ูโฺฉูุฏ ู ุขููุง ุฑุง ุดุฑูุน ูโฺฉูุฏ.</p>
</li>
<li>
<p>ูุฑ ุฑุดุชู ุจู ฺฉ ูุชุฏ ุงุดุงุฑู ุฏุงุฑุฏ:</p>
<ul>
<li><strong>Method1()</strong> ุญุฑูู ุงููุจุง ุฑุง ุจุง ุญุฑูู ุจุฒุฑฺฏ ฺุงูพ ูโฺฉูุฏ.</li>
<li><strong>Method2()</strong> ุญุฑูู ุงููุจุง ุฑุง ุจุง ุญุฑูู ฺฉูฺฺฉ ฺุงูพ ูโฺฉูุฏ.</li>
</ul>
</li>
</ul>
<hr>
<h3>ูุชุฏ Method1()</h3>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Method1</span>()</span>
{
    <span class="hljs-keyword">for</span> (_alphabetCharacter = <span class="hljs-string">&#x27;A&#x27;</span>; _alphabetCharacter &lt;= <span class="hljs-string">&#x27;Z&#x27;</span>; _alphabetCharacter++)
    {
        Console.Write(_alphabetCharacter + <span class="hljs-string">&quot; &quot;</span>);
    }
}
</code></pre>
<h3>ูุชุฏ Method2()</h3>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Method2</span>()</span>
{
    <span class="hljs-keyword">for</span> (_alphabetCharacter = <span class="hljs-string">&#x27;a&#x27;</span>; _alphabetCharacter &lt;= <span class="hljs-string">&#x27;z&#x27;</span>; _alphabetCharacter++)
    {
        Console.Write(_alphabetCharacter + <span class="hljs-string">&quot; &quot;</span>);
    }
}
</code></pre>
<ul>
<li>ูุฑ ุฏู ูุชุฏ ุจู ูุชุบุฑ <strong>_alphabetCharacter</strong> ุงุฑุฌุงุน ูโุฏููุฏ.</li>
<li>ุจูุงุจุฑุงูุ ุจุงุฏ ุงู ุนุถู ุฑุง ุฏุฑ ุจุงูุง ฺฉูุงุณ ุงุถุงูู ฺฉูู:</li>
</ul>
<pre class="hljs"><code><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">char</span> _alphabetCharacter;
</code></pre>
<hr>
<h3>ุจูโุฑูุฒุฑุณุงู ูุชุฏ Main()</h3>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] <span class="hljs-keyword">args</span></span>)</span>
{
    Console.WriteLine(<span class="hljs-string">&quot;\n\nRace Condition:&quot;</span>);
    ThreadingRaceCondition();
    Console.WriteLine(<span class="hljs-string">&quot;\n\nPress any key to exit.&quot;</span>);
    Console.ReadKey();
}
</code></pre>
<p>ุญุงูุง ฺฉุฏ ูุง ุขูุงุฏู ุงุณุช ุชุง <strong>Race Condition</strong> ุฑุง ูุดุงู ุฏูุฏ. ุงฺฏุฑ ุจุฑูุงูู ุฑุง ฺูุฏู ุจุงุฑ ุงุฌุฑุง ฺฉูุฏุ ุฎูุงูุฏ ุฏุฏ ฺฉู ูุชุงุฌ ููุงู ฺุฒ ูุณุช ฺฉู ุงูุชุธุงุฑ ุฏุงุฑู ู ุญุช ููฺฉู ุงุณุช ฺฉุงุฑุงฺฉุชุฑูุง ุฎุงุฑุฌ ุงุฒ ุญุฑูู ุงููุจุง ูุฒ ฺุงูพ ุดููุฏ. โ๏ธ</p>
<div align="center">
<p><img src="../../../assets/image/08/Table%208-10.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ุฏููุงู ููุงู ฺุฒ ูุจูุฏ ฺฉู ุงูุชุธุงุฑ ุฏุงุดุชูุ ุฏุฑุณุช ุงุณุชุ ๐</p>
<p>ูุง ูโุฎูุงูู ุงู ูุดฺฉู ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ <strong>TPL</strong> ุญู ฺฉูู. ูุฏู <strong>Task Parallel Library (TPL)</strong> ุณุงุฏูโุณุงุฒ <strong>Parallelism</strong> ู <strong>Concurrency</strong> ุงุณุช. ุจุง ุชูุฌู ุจู ุงูฺฉู ุงฺฉุซุฑ ฺฉุงููพูุชุฑูุง ุงูุฑูุฒ ุฏุงุฑุง ุฏู ุง ฺูุฏ ูพุฑุฏุงุฒูุฏู ูุณุชูุฏุ <strong>TPL</strong> ุจู ุตูุฑุช ูพูุง ูุฒุงู <strong>Concurrency</strong> ุฑุง ููุงุณโุจูุฏ ูโฺฉูุฏ ุชุง ุงุฒ ุชูุงู ูพุฑุฏุงุฒูุฏูโูุง ููุฌูุฏ ุจู ุจูููโุชุฑู ุดฺฉู ุงุณุชูุงุฏู ุดูุฏ. โก</p>
<ul>
<li>ุชูุณูโุจูุฏ ฺฉุงุฑ (<strong>Partitioning of work</strong>)</li>
<li>ุฒูุงูโุจูุฏ ุฑุดุชูโูุง ุฏุฑ <strong>Thread Pool</strong></li>
<li>ูพุดุชุจุงู ุงุฒ ูุบู (<strong>Cancellation</strong>)</li>
<li>ูุฏุฑุช ูุถุนุช (<strong>State Management</strong>)<br>
ู ููุงุฑุฏ ุฏฺฏุฑ ูุฒ ุชูุณุท <strong>TPL</strong> ุงูุฌุงู ูโุดููุฏ.<br>
ููฺฉ ูุณุชูุฏุงุช ุฑุณู ูุงฺฉุฑูุณุงูุช ุฏุฑุจุงุฑู <strong>TPL</strong> ุฏุฑ ุจุฎุด <strong>Further Reading</strong> ุงู ูุตู ููุฌูุฏ ุงุณุช. ๐</li>
</ul>
<hr>
<p>ุฑุงู ุญู ุงู ูุดฺฉู ุณุงุฏู ุงุณุช. ูุง ฺฉ <strong>Task</strong> ุฏุงุฑู ฺฉู ุงุจุชุฏุง <strong>Method1()</strong> ุฑุง ุงุฌุฑุง ูโฺฉูุฏ. ุณูพุณ ุงู <strong>Task</strong> ุงุฏุงูู ูโุฏูุฏ ู <strong>Method2()</strong> ุฑุง ุงุฌุฑุง ูโฺฉูุฏ. ุฏุฑ ููุงุช ุจุง ูุฑุงุฎูุงู <strong>Wait()</strong> ููุชุธุฑ ูโูุงูู ุชุง <strong>Task</strong> ฺฉุงูู ุดูุฏ.</p>
<hr>
<h3>ูุชุฏ ThreadingRaceConditionFixed()</h3>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ThreadingRaceConditionFixed</span>()</span>
{
    Task
        .Run(() =&gt; Method1())
        .ContinueWith(task =&gt; Method2())
        .Wait();
}
</code></pre>
<ul>
<li>ุงุจุชุฏุง <strong>Method1()</strong> ุงุฌุฑุง ูโุดูุฏ.</li>
<li>ูพุณ ุงุฒ ุงุชูุงู ุขูุ <strong>Method2()</strong> ุงุฌุฑุง ูโุดูุฏ.</li>
<li><strong>Wait()</strong> ุงุทููุงู ูโุฏูุฏ ฺฉู ุจุฑูุงูู ุชุง ูพุงุงู ุงุฌุฑุง <strong>Task</strong> ุตุจุฑ ฺฉูุฏ. โ</li>
</ul>
<hr>
<h3>ุจูโุฑูุฒุฑุณุงู ูุชุฏ Main()</h3>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] <span class="hljs-keyword">args</span></span>)</span>
{
    <span class="hljs-comment">//Console.WriteLine(&quot;\n\nRace Condition:&quot;);</span>
    <span class="hljs-comment">//ThreadingRaceCondition();</span>
    Console.WriteLine(<span class="hljs-string">&quot;\n\nRace Condition Fixed:&quot;</span>);
    ThreadingRaceConditionFixed();
    Console.WriteLine(<span class="hljs-string">&quot;\n\nPress any key to exit.&quot;</span>);
    Console.ReadKey();
}
</code></pre>
<p>ฺฉุฏ ุฑุง ุงุฌุฑุง ฺฉูุฏ. ุงฺฏุฑ ุจุฑูุงูู ุฑุง ฺูุฏู ุจุงุฑ ุงุฌุฑุง ฺฉูุฏุ ุฎูุงูุฏ ุฏุฏ ฺฉู ุฎุฑูุฌ ููุดู ฺฉุณุงู ุงุณุชุ ููุงูโุทูุฑ ฺฉู ุฏุฑ ุชุตูุฑ ุฒุฑ ูุดุงู ุฏุงุฏู ุดุฏู ุงุณุช. ๐ฏ</p>
<div align="center">
<p><img src="../../../assets/image/08/Table%208-11.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ุชุง ุงูุฌุงุ ูุง ุฏุฏู ฺฉู <strong>Thread</strong> ฺุณุช ู ฺฺฏููู ูโุชูุงู ุงุฒ ุขูโูุง ุฏุฑ <strong>Foreground</strong> ู <strong>Background</strong> ุงุณุชูุงุฏู ฺฉุฑุฏ. ููฺูู ุจุง <strong>Deadlocks</strong> ู ูุญูู ุญู ุขูโูุง ุจุง <strong>Monitor.TryEnter()</strong> ุขุดูุง ุดุฏู. ุฏุฑ ููุงุชุ ุจุง <strong>Race Conditions</strong> ู ูุญูู ุญู ุขูโูุง ุจุง ุงุณุชูุงุฏู ุงุฒ <strong>TPL</strong> ุขุดูุง ุดุฏู. โ</p>
<p>ุญุงูุงุ ุจู ุณุฑุงุบ <strong>Static Constructors</strong> ู <strong>Static Methods</strong> ูโุฑูู.</p>
<hr>
<h2>๐น ุฏุฑฺฉ <strong>Static Constructors</strong> ู <strong>Methods</strong></h2>
<p>ุงฺฏุฑ ฺูุฏู ฺฉูุงุณ ููุฒูุงู ุจู ฺฉ <strong>Property Instance</strong> ุฏุณุชุฑุณ ูุงุฒ ุฏุงุดุชู ุจุงุดูุฏุ ฺฉ ุงุฒ <strong>Threadูุง</strong> ุฏุฑุฎูุงุณุช ุงุฌุฑุง <strong>Static Constructor</strong> (ฺฉู ุจู ุขู <strong>Type Initializer</strong> ูู ฺฏูุชู ูโุดูุฏ) ูโุฏูุฏ.<br>
ุฏุฑ ุญุงู ฺฉู ููุชุธุฑ ุงุฌุฑุง <strong>Type Initializer</strong> ูุณุชูุ ุชูุงู <strong>Threadูุง ุฏฺฏุฑ</strong> ููู ูโุดููุฏ. ููุช <strong>Type Initializer</strong> ุงุฌุฑุง ุดุฏุ <strong>Threadูุง ูููโุดุฏู</strong> ุขุฒุงุฏ ุดุฏู ู ูุงุฏุฑ ุจู ุฏุณุชุฑุณ ุจู <strong>Instance Property</strong> ุฎูุงููุฏ ุจูุฏ.</p>
<ul>
<li><strong>Static Constructors</strong> <strong>Thread-Safe</strong> ูุณุชูุฏุ ุฒุฑุง ุชุถูู ูโุดูุฏ ฺฉู ููุท ฺฉ ุจุงุฑ ุฏุฑ ูุฑ <strong>Application Domain</strong> ุงุฌุฑุง ุดููุฏ.</li>
<li>ุขูโูุง ูุจู ุงุฒ ุฏุณุชุฑุณ ุจู ูุฑ <strong>Static Member</strong> ู ูุจู ุงุฒ ูุฑ <strong>Class Instantiation</strong> ุงุฌุฑุง ูโุดููุฏ.</li>
<li>ุงฺฏุฑ ุงุณุชุซูุง ุฏุฑ <strong>Static Constructor</strong> ุงุฌุงุฏ ู ุจุฑูู ูุฑุงุฑ ฺฉูุฏุ <strong>TypeInitializationException</strong> ุชููุฏ ูโุดูุฏ ู ุจุงุนุซ ูโุดูุฏ <strong>CLR</strong> ุจุฑูุงูู ุดูุง ุฑุง ูุชููู ฺฉูุฏ.</li>
</ul>
<hr>
<h3>ูฺฉุงุช ููู ุฏุฑุจุงุฑู <strong>Static Methods</strong></h3>
<ul>
<li><strong>Static Methods</strong> ุชููุง ฺฉ ูุณุฎู ุงุฒ ูุชุฏ ู ุฏุงุฏูโูุง ุขู ุฑุง ุฏุฑ ุณุทุญ <strong>Type</strong> ูฺฏู ูโุฏุงุฑูุฏ.</li>
<li>ุงู ุจุฏุงู ูุนูุงุณุช ฺฉู ููุงู ูุชุฏ ู ุฏุงุฏูโูุง ุขู ุจู ูููููโูุง ูุฎุชูู ุจู ุงุดุชุฑุงฺฉ ฺฏุฐุงุดุชู ูโุดูุฏ.</li>
<li>ูุฑ <strong>Thread</strong> ุฏุฑ ุจุฑูุงููุ <strong>Stack</strong> ุฎูุฏ ุฑุง ุฏุงุฑุฏ.</li>
<li><strong>Value Types</strong> ฺฉู ุจู ูุชุฏูุง <strong>Static</strong> ูพุงุณ ุฏุงุฏู ูโุดููุฏ ุฑู <strong>Stack</strong> ุฑุดุชู ูุฑุงุฎูุงููุฏู ุงุฌุงุฏ ูโุดููุฏุ ุจูุงุจุฑุงู <strong>Thread-Safe</strong> ูุณุชูุฏ.</li>
<li>ุงฺฏุฑ ุฏู <strong>Thread</strong> ููุงู ฺฉุฏ ุฑุง ุจุง ููุงู ููุฏุงุฑ ูุฑุงุฎูุงู ฺฉููุฏุ ุฏู ูุณุฎู ุงุฒ ุขู ููุฏุงุฑ ุฑู <strong>Stack</strong> ูุฑ <strong>Thread</strong> ุงุฌุงุฏ ูโุดูุฏ. ุจูุงุจุฑุงูุ <strong>Threads</strong> ุฑู ูู ุงุซุฑ ููโฺฏุฐุงุฑูุฏ.</li>
</ul>
<p>โ๏ธ ุงูุง:</p>
<ul>
<li>ุงฺฏุฑ ูุชุฏ <strong>Static</strong> ุจู <strong>Member Variable</strong> ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดุฏุ <strong>Thread-Safe</strong> ูุณุช.</li>
<li>ุฏู <strong>Thread</strong> ูุฎุชูู ููุงู ูุชุฏ ุฑุง ูุฑุงุฎูุงู ฺฉุฑุฏู ู ุจู <strong>Member Variable</strong> ุฏุณุชุฑุณ ุฏุงุฑูุฏ. <strong>Context-Switching</strong> ุจู <strong>Threadูุง</strong> ุฑุฎ ูโุฏูุฏ ู ูุฑ <strong>Thread</strong> ูุชุบุฑ ุฑุง ุชุบุฑ ูโุฏูุฏ. ุงู ููุฌุฑ ุจู <strong>Race Conditions</strong> ูโุดูุฏ.</li>
<li>ุงฺฏุฑ <strong>Reference Types</strong> ุจู ูุชุฏ <strong>Static</strong> ูพุงุณ ุฏุงุฏู ุดููุฏุ ูุดฺฉูุงุช ูุดุงุจู ุฑุฎ ูโุฏูุฏ ู ุจุงุนุซ <strong>Race Condition</strong> ูโุดูุฏ.</li>
</ul>
<p>โ ูุชุฌู:</p>
<ul>
<li>ููฺฏุงู ุงุณุชูุงุฏู ุงุฒ <strong>Static Methods</strong> ุฏุฑ <strong>Threads</strong>ุ ุงุฒ ุฏุณุชุฑุณ ุจู <strong>Member Variable</strong> ุงุฌุชูุงุจ ฺฉูุฏ ู <strong>Reference Types</strong> ูพุงุณ ูุฏูุฏ.</li>
<li><strong>Static Methods</strong> <strong>Thread-Safe</strong> ูุณุชูุฏ ุชุง ุฒูุงู ฺฉู ุชููุง <strong>Primitive Types</strong> ูพุงุณ ุฏุงุฏู ุดููุฏ ู ูุถุนุช ุชุบุฑ ูฺฉูุฏ.</li>
</ul>
<hr>
<h2>๐ป ุงุถุงูู ฺฉุฑุฏู <strong>Static Constructors</strong> ุจู ฺฉุฏ ููููู</h2>
<p>ฺฉ ุจุฑูุงูู ุฌุฏุฏ <strong>.NET Framework Console</strong> ุจุณุงุฒุฏ.<br>
ฺฉ ฺฉูุงุณ ุจู ูุงู <strong>StaticConstructorTestClass</strong> ุงุถุงูู ฺฉูุฏ ู ฺฉ ูุชุบุฑ <strong>Read-Only Static String</strong> ุจู ูุงู <strong>_message</strong> ุชุนุฑู ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">StaticConstructorTestClass</span>
{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">string</span> _message;
}
</code></pre>
<p>ุงู ูุชุบุฑ ุชูุณุท ูุชุฏ <strong>Message()</strong> ุจู ูุฑุงุฎูุงููุฏู ุจุงุฒฺฏุฑุฏุงูุฏู ูโุดูุฏ.</p>
<h3>ูุชุฏ Message()</h3>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">string</span> <span class="hljs-title">Message</span>()</span>
{
    <span class="hljs-keyword">return</span> <span class="hljs-string">$&quot;Message: <span class="hljs-subst">{_message}</span>&quot;</span>;
}
</code></pre>
<ul>
<li>ุงู ูุชุฏ ูพุงู ุฐุฎุฑูโุดุฏู ุฏุฑ <strong>_message</strong> ุฑุง ุจุงุฒูโฺฏุฑุฏุงูุฏ.</li>
</ul>
<h3>Constructor</h3>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-title">StaticConstructorTestClass</span>()</span>
{
    Console.WriteLine(<span class="hljs-string">&quot;StaticConstructorTestClass static constructor started.&quot;</span>);
    _message = <span class="hljs-string">&quot;Hello, World!&quot;</span>;
    Thread.Sleep(<span class="hljs-number">1000</span>);
    _message = <span class="hljs-string">&quot;Goodbye, World!&quot;</span>;
    Console.WriteLine(<span class="hljs-string">&quot;StaticConstructorTestClass static constructor finished.&quot;</span>);
}
</code></pre>
<ul>
<li>ุฏุฑ <strong>Constructor</strong> ฺฉ ูพุงู ุจู ฺฉูุณูู ูโููุณู.</li>
<li>ุณูพุณ <strong>Member Variable</strong> ุชูุธู ูโุดูุฏ ู <strong>Thread</strong> ุจู ูุฏุช ฑ ุซุงูู ุฎูุงุจุฏู ู ุฏูุจุงุฑู ูพุงู ุชุบุฑ ุฏุงุฏู ูโุดูุฏ.</li>
<li>ุฏุฑ ููุงุชุ ูพุงู ุฏฺฏุฑ ุจู ฺฉูุณูู ฺุงูพ ูโุดูุฏ.</li>
</ul>
<hr>
<h3>ุจูโุฑูุฒุฑุณุงู ูุชุฏ Main()</h3>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] <span class="hljs-keyword">args</span></span>)</span>
{
    <span class="hljs-keyword">var</span> program = <span class="hljs-keyword">new</span> Program();
    program.StaticConstructorExample();
    Thread.CurrentThread.Join();
}
</code></pre>
<ul>
<li><strong>Main()</strong> ฺฉูุงุณ <strong>Program</strong> ุฑุง ูููููโุณุงุฒ ูโฺฉูุฏ.</li>
<li>ุณูพุณ <strong>StaticConstructorExample()</strong> ูุฑุงุฎูุงู ูโุดูุฏ.</li>
<li>ุจุฑูุงูู ูุชููู ุดุฏู ู ูุชุฌู ุฑุง ูุดุงูุฏู ูโฺฉููุ ุณูพุณ <strong>Threadูุง</strong> ุจู <strong>Join()</strong> ูโูพููุฏูุฏ.</li>
</ul>
<p>ุฎุฑูุฌ ุฑุง ูโุชูุงูุฏ ุฏุฑ ุชุตูุฑ ุฒุฑ ูุดุงูุฏู ฺฉูุฏ. ๐บ</p>
<div align="center">
<p><img src="../../../assets/image/08/Table%208-12.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ุญุงูุง ุจู ุณุฑุงุบ ูุซุงูโูุง ุงุฒ <strong>Static Methods</strong> ูโุฑูู.</p>
<hr>
<h2>๐ป ุงุถุงูู ฺฉุฑุฏู <strong>Static Methods</strong> ุจู ฺฉุฏ ููููู</h2>
<p>ุงฺฉููู ูุตุฏ ุฏุงุฑู <strong>Static Methods</strong> ุงูู ุจุฑุง <strong>Thread</strong> ู ุบุฑ ุงูู ุฑุง ุนูู ูุดุงูุฏู ฺฉูู.</p>
<p>ฺฉ ฺฉูุงุณ ุฌุฏุฏ ุจู ูุงู <strong>StaticExampleClass</strong> ุจู ฺฉ ุจุฑูุงูู <strong>.NET Framework Console</strong> ุงุถุงูู ฺฉูุฏ ู ฺฉุฏ ุฒุฑ ุฑุง ุจููุณุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">StaticExampleClass</span>
{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">int</span> _x = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">int</span> _y = <span class="hljs-number">2</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">int</span> _z = <span class="hljs-number">3</span>;
}
</code></pre>
<ul>
<li>ุฏุฑ ุจุงูุง ฺฉูุงุณุ ุณู ุนุฏุฏ ุตุญุญ ุชุนุฑู ฺฉุฑุฏูโุงู: <strong>_xุ _y ู _z</strong> ุจุง ููุงุฏุฑ ฑุ ฒ ู ณ.</li>
<li>ุงู ูุชุบุฑูุง ูโุชูุงููุฏ ุจู <strong>Threadูุง</strong> ุชุบุฑ ฺฉููุฏ.</li>
</ul>
<hr>
<h3>Static Constructor</h3>
<p>ุญุงูุง ฺฉ <strong>Static Constructor</strong> ุงุถุงูู ูโฺฉูู ุชุง ููุงุฏุฑ ุงู ูุชุบุฑูุง ุฑุง ฺุงูพ ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-title">StaticExampleClass</span>()</span>
{
    Console.WriteLine(<span class="hljs-string">$&quot;Constructor: _x=<span class="hljs-subst">{_x}</span>, _y=<span class="hljs-subst">{_y}</span>, _z=<span class="hljs-subst">{_z}</span>&quot;</span>);
}
</code></pre>
<ul>
<li>ููุงูโุทูุฑ ฺฉู ูุดุงูุฏู ูโฺฉูุฏุ <strong>Static Constructor</strong> ููุท ููุงุฏุฑ ูุชุบุฑูุง ุฑุง ุฏุฑ <strong>Console Window</strong> ฺุงูพ ูโฺฉูุฏ.</li>
</ul>
<hr>
<h3>Thread-Safe Method</h3>
<p>ูุชุฏ ุงูู ูุง ฺฉ ูุชุฏ <strong>Thread-Safe</strong> ุจู ูุงู <strong>ThreadSafeMethod()</strong> ุงุณุช:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">internal</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ThreadSafeMethod</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> x, <span class="hljs-built_in">int</span> y, <span class="hljs-built_in">int</span> z</span>)</span>
{
    Console.WriteLine(<span class="hljs-string">$&quot;ThreadSafeMethod: x=<span class="hljs-subst">{x}</span>, y=<span class="hljs-subst">{y}</span>, z=<span class="hljs-subst">{z}</span>&quot;</span>);
    Console.WriteLine(<span class="hljs-string">$&quot;ThreadSafeMethod: <span class="hljs-subst">{x}</span>+<span class="hljs-subst">{y}</span>+<span class="hljs-subst">{z}</span>=<span class="hljs-subst">{x+y+z}</span>&quot;</span>);
}
</code></pre>
<ul>
<li>ุงู ูุชุฏ <strong>Thread-Safe</strong> ุงุณุช ุฒุฑุง ููุท ุจุง ูพุงุฑุงูุชุฑูุง <strong>by value</strong> ฺฉุงุฑ ูโฺฉูุฏ.</li>
<li>ุจุง ูุชุบุฑูุง <strong>Member</strong> ุชุนุงูู ูุฏุงุฑุฏ ู ูฺ <strong>by reference value</strong> ูุฏุงุฑุฏ.</li>
<li>ุจูุงุจุฑุงูุ ุตุฑู ูุธุฑ ุงุฒ ููุงุฏุฑ ูุฑูุฏุ ููุดู ูุชุฌู ููุฑุฏ ุงูุชุธุงุฑ ุฑุง ุฎูุงูุฏ ฺฏุฑูุช.</li>
</ul>
<p>โ ุนู ฺู ฺฉ <strong>Thread</strong> ูุงุญุฏ ุง ุญุช ููููโูุง <strong>Thread</strong> ุจู ุงู ูุชุฏ ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดูุฏุ ุฎุฑูุฌ ูุฑ <strong>Thread</strong> ููุงู ฺุฒ ุฎูุงูุฏ ุจูุฏ ฺฉู ุงูุชุธุงุฑ ุฏุงุฑุฏุ ุญุช ุจุง ูุฌูุฏ <strong>Context Switching</strong>.</p>
<p>ุฎุฑูุฌ ุงู ูุชุฏ ุฑุง ุฏุฑ <strong>Screenshot</strong> ุจุนุฏ ูุดุงูุฏู ูโฺฉูู. ๐</p>
<div align="center">
<p><img src="../../../assets/image/08/Table%208-13.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ุญุงู ฺฉู ุจุง <strong>Thread-Safe Methods</strong> ุขุดูุง ุดุฏูุ ููุทู ุงุณุช ฺฉู ูฺฏุงู ูู ุจู <strong>Non-Thread-Safe Methods</strong> ุจูุฏุงุฒู.</p>
<p>โ ุชุง ุงูุฌุง ูโุฏุงูุฏ ฺฉู ูุฑ <strong>Static Method</strong> ฺฉู ุฑู <strong>by reference values</strong> ุง <strong>Static Member Variables</strong> ุนูู ฺฉูุฏุ <strong>Thread-Safe</strong> ูุณุช.</p>
<hr>
<h3>Non-Thread-Safe Method</h3>
<p>ุฏุฑ ูุซุงู ุจุนุฏุ ูุชุฏ ุจุง ููุงู ุณู ูพุงุฑุงูุชุฑ <strong>ThreadSafeMethod()</strong> ุฎูุงูู ุฏุงุดุชุ ุงูุง ุงู ุจุงุฑ:</p>
<ul>
<li>ูุชุบุฑูุง ุนุถู (<strong>Member Variables</strong>) ุฑุง ููุฏุงุฑุฏู ูโฺฉููุ</li>
<li>ูพุงู ฺุงูพ ูโฺฉููุ</li>
<li>ุจุฑุง ูุฏุช <strong>Sleep</strong> ูโฺฉููุ</li>
<li>ุณูพุณ ุจุฏุงุฑ ุดุฏู ู ุฏูุจุงุฑู ููุงุฏุฑ ุฑุง ฺุงูพ ูโฺฉูู.</li>
</ul>
<p>ฺฉุฏ <strong>NotThreadSafeMethod()</strong> ุฑุง ุจู ฺฉูุงุณ <strong>StaticExampleClass</strong> ุงุถุงูู ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">internal</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">NotThreadSafeMethod</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> x, <span class="hljs-built_in">int</span> y, <span class="hljs-built_in">int</span> z</span>)</span>
{
    _x = x;
    _y = y;
    _z = z;
    Console.WriteLine(
        <span class="hljs-string">$&quot;<span class="hljs-subst">{Thread.CurrentThread.ManagedThreadId}</span>-NotThreadSafeMethod: _x=<span class="hljs-subst">{_x}</span>, _y=<span class="hljs-subst">{_y}</span>, _z=<span class="hljs-subst">{_z}</span>&quot;</span>
    );
    Thread.Sleep(<span class="hljs-number">300</span>);
    Console.WriteLine(
        <span class="hljs-string">$&quot;<span class="hljs-subst">{Thread.CurrentThread.ManagedThreadId}</span>-ThreadSafeMethod: <span class="hljs-subst">{_x}</span>+<span class="hljs-subst">{_y}</span>+<span class="hljs-subst">{_z}</span>=<span class="hljs-subst">{_x + _y + _z}</span>&quot;</span>
    );
}
</code></pre>
<ul>
<li>ุฏุฑ ุงู ูุชุฏุ ุงุจุชุฏุง <strong>Member Variables</strong> ุฑุง ุจุง ููุงุฏุฑ ูุฑูุฏ ููุฏุงุฑุฏู ูโฺฉูู.</li>
<li>ุณูพุณ ุขู ููุงุฏุฑ ุฑุง ุฏุฑ <strong>Console</strong> ฺุงูพ ูโฺฉูู ู <strong>300 ููโุซุงูู</strong> ุจู <strong>Sleep</strong> ูโุฑูู.</li>
<li>ูพุณ ุงุฒ ุจุฏุงุฑ ุดุฏูุ ุฏูุจุงุฑู ููุงุฏุฑ ุฑุง ฺุงูพ ูโฺฉูู.</li>
</ul>
<hr>
<h3>ุจุฑูุฒุฑุณุงู Main Method</h3>
<p>ุฏุฑ ฺฉูุงุณ <strong>Program</strong>ุ <strong>Main()</strong> ุฑุง ุจู ุดฺฉู ุฒุฑ ุจุฑูุฒุฑุณุงู ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] <span class="hljs-keyword">args</span></span>)</span>
{
    <span class="hljs-keyword">var</span> program = <span class="hljs-keyword">new</span> Program();
    program.ThreadUnsafeMethodCall();
    Console.ReadKey();
}
</code></pre>
<ul>
<li>ุฏุฑ <strong>Main()</strong>ุ ุงุจุชุฏุง ฺฉูุงุณ <strong>Program</strong> ูููููโุณุงุฒ ูโุดูุฏ.</li>
<li>ุณูพุณ ูุชุฏ <strong>ThreadUnsafeMethodCall()</strong> ูุฑุงุฎูุงู ูโุดูุฏ.</li>
<li>ุจุฑูุงูู ุชุง ุฒูุงู ฺฉู ฺฉุงุฑุจุฑ ฺฉูุฏ ูุดุงุฑ ุฏูุฏุ ุตุจุฑ ูโฺฉูุฏ.</li>
</ul>
<hr>
<h3>ThreadUnsafeMethodCall</h3>
<p>ุญุงูุง <strong>ThreadUnsafeMethodCall()</strong> ุฑุง ุจู ฺฉูุงุณ <strong>Program</strong> ุงุถุงูู ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ThreadUnsafeMethodCall</span>()</span>
{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> index = <span class="hljs-number">0</span>; index &lt; <span class="hljs-number">10</span>; index++)
    {
        <span class="hljs-keyword">var</span> thread = <span class="hljs-keyword">new</span> Thread(() =&gt;
        {
            StaticExampleClass.NotThreadSafeMethod(index + <span class="hljs-number">1</span>, index + <span class="hljs-number">2</span>, index + <span class="hljs-number">3</span>);
        });
        thread.Start();
    }
}
</code></pre>
<ul>
<li>ุงู ูุชุฏ <strong>10 Thread</strong> ุงุฌุงุฏ ูโฺฉูุฏ ฺฉู ูุฑฺฉุฏุงู <strong>NotThreadSafeMethod()</strong> ุงุฒ ฺฉูุงุณ <strong>StaticExampleClass</strong> ุฑุง ูุฑุงุฎูุงู ูโฺฉููุฏ.</li>
<li>ุงฺฏุฑ ฺฉุฏ ุฑุง ุงุฌุฑุง ฺฉูุฏุ ุฎุฑูุฌ ูุดุงุจู <strong>Screenshot</strong> ุจุนุฏ ูุดุงูุฏู ุฎูุงูุฏ ุดุฏ. โก</li>
</ul>
<p>ุฎุฑูุฌ ูุดุงู ูโุฏูุฏ ฺฉู ููุงุฏุฑ ุจู <strong>Threadูุง</strong> ุชุฏุงุฎู ุฏุงุฑูุฏ ู ุจู ุฏูู ุนุฏู ุงูู <strong>Thread</strong>ุ ูุชุงุฌ ุบุฑูุงุจู ูพุดโุจู ุงุณุช.</p>
<div align="center">
<p><img src="../../../assets/image/08/Table%208-14.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ููุงูโุทูุฑ ฺฉู ูโุจูุฏุ ุฎุฑูุฌ ุจุฑูุงูู ุขู ฺุฒ ูุณุช ฺฉู ุงูุชุธุงุฑ ุฏุงุดุชู. ุงู ุจู ุฏูู <strong>ุขููุฏฺฏ ุฏุงุฏูโูุง ุชูุณุท Threadูุง ูุฎุชูู</strong> ุฑุฎ ูโุฏูุฏ. ุงู ููุถูุน ูุง ุฑุง ุจู ุจุฎุด ุจุนุฏ ุนู <strong>ูุงุจูุช ุชุบุฑ (Mutability)ุ ุนุฏู ุชุบุฑ (Immutability) ู ุงูู Thread</strong> ูโุฑุณุงูุฏ. ๐</p>
<hr>
<h2>ูุงุจูุช ุชุบุฑุ ุนุฏู ุชุบุฑ ู ุงูู Thread</h2>
<p><strong>Mutability</strong> ููุจุน ุจุฑูุฒ ุฎุทุง ุฏุฑ ุจุฑูุงููโูุง ฺูุฏ Threadู ุงุณุช. ฺฉ ุฎุทุง ูุงุจู ุชุบุฑ ูุนูููุงู ูุงุด ุงุฒ ุงุดุชุฑุงฺฉโฺฏุฐุงุฑ ู ุจูโุฑูุฒุฑุณุงู ููุงุฏุฑ ุจู Threadูุงุณุช.</p>
<p>ุจุฑุง ุญุฐู ุฎุทุฑ ุงู ููุน ุฎุทุงูุงุ ุจูุชุฑ ุงุณุช ุงุฒ <strong>Immutable Types</strong> ุงุณุชูุงุฏู ฺฉูู.</p>
<p><strong>Thread Safety</strong> ุนู ุงุฌุฑุง ุงูู ฺฉ ุจุฎุด ฺฉุฏ ุชูุณุท ฺูุฏ Thread ุจูโุทูุฑ ููุฒูุงู. ููุช ุจุฑูุงููโูุง ฺูุฏ Threadู ูโููุณุฏุ ููู ุงุณุช ฺฉู ฺฉุฏ ุดูุง <strong>Thread-Safe</strong> ุจุงุดุฏ. ฺฉุฏ ุดูุง Thread-Safe ุงุณุช ุงฺฏุฑ ุดุฑุงุท ูุงููุฏ <strong>Race Conditions</strong> ู <strong>Deadlocks</strong> ู ูุดฺฉูุงุช ูุงุด ุงุฒ <strong>Mutability</strong> ุฑุง ุญุฐู ฺฉูุฏ.</p>
<ul>
<li><strong>Immutable Object</strong>: ุดุฆ ฺฉู ูพุณ ุงุฒ ุงุฌุงุฏ ูุงุจู ุชุบุฑ ูุณุช. ุงฺฏุฑ ฺูู ุดุฆ ุจู Threadูุง ุจูโุฏุฑุณุช ููฺฏุงูโุณุงุฒ ุดูุฏุ ููู Threadูุง ููุงู ูุถุนุช ูุนุชุจุฑ ุดุก ุฑุง ุฎูุงููุฏ ุฏุฏ.</li>
<li><strong>Mutable Object</strong>: ุดุฆ ฺฉู ูพุณ ุงุฒ ุงุฌุงุฏ ูุงุจู ุชุบุฑ ุงุณุช ู ุฏุงุฏูโูุง ุขู ูโุชูุงูุฏ ุจู Threadูุง ุชุบุฑ ฺฉูุฏ. ุงู ูโุชูุงูุฏ ุจุงุนุซ <strong>Corruption ุฏุงุฏูโูุง</strong> ุดูุฏุ ุญุช ุงฺฏุฑ ุจุฑูุงูู ฺฉุฑุด ูฺฉูุฏุ ุฏุงุฏูโูุง ููฺฉู ุงุณุช ุฏุฑ ูุถุนุช ูุงูุนุชุจุฑ ุจุงู ุจูุงููุฏ.</li>
</ul>
<p>ุจูุงุจุฑุงูุ ููุช ุจุง ฺูุฏ Thread ฺฉุงุฑ ูโฺฉูุฏุ ููู ุงุณุช ฺฉู <strong>ุงุดุงุก ุดูุง Immutable ุจุงุดูุฏ</strong>. ุฏุฑ ูุตู ณ (Classes, Objects, and Data Structures) ุฑูุด ุงุฌุงุฏ ู ุงุณุชูุงุฏู ุงุฒ ุณุงุฎุชุงุฑูุง ุฏุงุฏู ุบุฑูุงุจู ุชุบุฑ ุฑุง ุงุฏ ฺฏุฑูุชู.</p>
<p>โ ุจุฑุง ุงุทููุงู ุงุฒ Thread Safety:</p>
<ul>
<li>ุงุฒ <strong>Mutable Objects</strong> ุงุณุชูุงุฏู ูฺฉูุฏ.</li>
<li>ูพุงุฑุงูุชุฑูุง ุฑุง <strong>By Reference</strong> ุงุฑุณุงู ูฺฉูุฏ.</li>
<li><strong>Member Variables</strong> ุฑุง ุชุบุฑ ูุฏูุฏ.</li>
<li>ููุท ูพุงุฑุงูุชุฑูุง ุฑุง <strong>By Value</strong> ุงุฑุณุงู ฺฉูุฏ ู ุฑู ููุงูโูุง ุนููุงุช ุงูุฌุงู ุฏูุฏ.</li>
</ul>
<p><strong>Immutable Structures</strong> ุฑูุด ุงูู ู ููุงุณุจ ุจุฑุง ุงูุชูุงู ุฏุงุฏูโูุง ุจู ุงุดุงุก ูุณุชูุฏ.</p>
<hr>
<h2>ููููู ฺฉุฏ ุจุฑุง Mutable ู ุบุฑ Thread-Safe</h2>
<p>ุจุฑุง ููุงุด <strong>Mutability</strong> ุฏุฑ ฺฉ ุจุฑูุงูู ฺูุฏ Threadูุ ฺฉ <strong>Console Application</strong> ุฌุฏุฏ ุงุฌุงุฏ ฺฉูุฏ. ฺฉ ฺฉูุงุณ ุจู ูุงู <strong>MutableClass</strong> ุงุถุงูู ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">internal</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MutableClass</span>
{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-built_in">int</span>[] _intArray;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MutableClass</span>(<span class="hljs-params"><span class="hljs-built_in">int</span>[] intArray</span>)</span>
    {
        _intArray = intArray;
    }
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span>[] <span class="hljs-title">GetIntArray</span>()</span>
    {
        <span class="hljs-keyword">return</span> _intArray;
    }
}
</code></pre>
<ul>
<li>ุงู ฺฉูุงุณ ฺฉ <strong>Constructor</strong> ุฏุงุฑุฏ ฺฉู ฺฉ ุขุฑุงู ุนุฏุฏ ุตุญุญ ูโฺฏุฑุฏ ู ุจู ุนุถู ฺฉูุงุณ ุงุฎุชุตุงุต ูโุฏูุฏ.</li>
<li>ูุชุฏ <strong>GetIntArray()</strong> ููุงู ุขุฑุงู ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ.</li>
<li>ุงฺฏุฑฺู ฺฉูุงุณ ุจู ูุธุฑ ุบุฑูุงุจู ุชุบุฑ ูโุขุฏุ ุงูุง <strong>ุขุฑุงู ุนุฏุฏ ุตุญุญ ูุฑูุฏ mutable ุงุณุช</strong> ู GetIntArray() ฺฉ <strong>Reference</strong> ุงุฒ ุขู ุจุฑูโฺฏุฑุฏุงูุฏ.</li>
</ul>
<hr>
<h3>MutableExample Method</h3>
<p>ุฏุฑ ฺฉูุงุณ <strong>Program</strong>ุ ูุชุฏ <strong>MutableExample()</strong> ุฑุง ุงุถุงูู ฺฉูุฏ ุชุง ูุดุงู ุฏูุฏ ุขุฑุงู mutable ุงุณุช:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">MutableExample</span>()</span>
{
    <span class="hljs-built_in">int</span>[] iar = { <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span> };
    <span class="hljs-keyword">var</span> mutableClass = <span class="hljs-keyword">new</span> MutableClass(iar);
    Console.WriteLine(<span class="hljs-string">$&quot;Initial Array: <span class="hljs-subst">{iar[<span class="hljs-number">0</span>]}</span>, <span class="hljs-subst">{iar[<span class="hljs-number">1</span>]}</span>, <span class="hljs-subst">{iar[<span class="hljs-number">2</span>]}</span>, <span class="hljs-subst">{iar[<span class="hljs-number">3</span>]}</span>, <span class="hljs-subst">{iar[<span class="hljs-number">4</span>]}</span>, <span class="hljs-subst">{iar[<span class="hljs-number">5</span>]}</span>, <span class="hljs-subst">{iar[<span class="hljs-number">6</span>]}</span>, <span class="hljs-subst">{iar[<span class="hljs-number">7</span>]}</span>, <span class="hljs-subst">{iar[<span class="hljs-number">8</span>]}</span>, <span class="hljs-subst">{iar[<span class="hljs-number">9</span>]}</span>&quot;</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> x = <span class="hljs-number">0</span>; x &lt; <span class="hljs-number">9</span>; x++)
    {
        <span class="hljs-keyword">var</span> thread = <span class="hljs-keyword">new</span> Thread(() =&gt;
        {
            iar[x] = x + <span class="hljs-number">1</span>;
            <span class="hljs-keyword">var</span> ia = mutableClass.GetIntArray();
            Console.WriteLine(<span class="hljs-string">$&quot;Array [<span class="hljs-subst">{x}</span>]: <span class="hljs-subst">{ia[<span class="hljs-number">0</span>]}</span>, <span class="hljs-subst">{ia[<span class="hljs-number">1</span>]}</span>, <span class="hljs-subst">{ia[<span class="hljs-number">2</span>]}</span>, <span class="hljs-subst">{ia[<span class="hljs-number">3</span>]}</span>, <span class="hljs-subst">{ia[<span class="hljs-number">4</span>]}</span>, <span class="hljs-subst">{ia[<span class="hljs-number">5</span>]}</span>, <span class="hljs-subst">{ia[<span class="hljs-number">6</span>]}</span>, <span class="hljs-subst">{ia[<span class="hljs-number">7</span>]}</span>, <span class="hljs-subst">{ia[<span class="hljs-number">8</span>]}</span>, <span class="hljs-subst">{ia[<span class="hljs-number">9</span>]}</span>&quot;</span>);
        });
        thread.Start();
    }
}
</code></pre>
<ul>
<li>ุฏุฑ ุงู ูุชุฏุ ุงุจุชุฏุง ฺฉ ุขุฑุงู ุนุฏุฏ ุตุญุญ ุงุฒ ฐ ุชุง น ุงุฌุงุฏ ูโฺฉูู.</li>
<li>ุณูพุณ ฺฉ ููููู ุงุฒ <strong>MutableClass</strong> ูโุณุงุฒู ู ุขุฑุงู ุฑุง ุจู ุขู ูพุงุณ ูโุฏูู.</li>
<li>ุงุจุชุฏุง ูุญุชูุงุช ุขุฑุงู ุฑุง ฺุงูพ ูโฺฉูู.</li>
<li>ุณูพุณ ุฏุฑ ฺฉ ุญููู น ุจุงุฑุ ููุฏุงุฑ ูุฑ ุงูุฏฺฉุณ ุฑุง ุจู <code>x + 1</code> ุชุบุฑ ูโุฏูู ู ฺฉ Thread ุจุฑุง ฺุงูพ ุขุฑุงู ุงุฌุงุฏ ูโฺฉูู.</li>
</ul>
<hr>
<h3>ุจุฑูุฒุฑุณุงู Main Method</h3>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] <span class="hljs-keyword">args</span></span>)</span>
{
    MutableExample();
    Console.ReadKey();
}
</code></pre>
<ul>
<li>Main() ุชููุง ูุชุฏ <strong>MutableExample()</strong> ุฑุง ูุฑุงุฎูุงู ูโฺฉูุฏ ู ุณูพุณ ููุชุธุฑ ูุดุฑุฏู ฺฉ ฺฉูุฏ ูโูุงูุฏ.</li>
</ul>
<p>ุจุง ุงุฌุฑุง ุงู ุจุฑูุงููุ ุฎุฑูุฌ ูุดุงุจู <strong>Screenshot</strong> ุจุนุฏ ููุงุด ุฏุงุฏู ุฎูุงูุฏ ุดุฏ ู ูุดุงู ูโุฏูุฏ ฺฉู <strong>ฺูุฏ Thread ููุงุฏุฑ ุขุฑุงู ุฑุง ููุฒูุงู ุชุบุฑ ูโุฏููุฏ</strong> ู ุจุงุนุซ <strong>ุนุฏู ูพุดโุจู ูุถุนุช ููุง ุขุฑุงู</strong> ูโุดููุฏ. โก</p>
<div align="center">
<p><img src="../../../assets/image/08/Table%208-15.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ููุงูโุทูุฑ ฺฉู ูโุจูุฏุ ุญุช ุจุง ุงูฺฉู ุชููุง ฺฉ ููููู ุงุฒ <strong>MutableClass</strong> ุงุฌุงุฏ ฺฉุฑุฏู ูุจู ุงุฒ ุณุงุฎุช ู ุงุฌุฑุง Threadูุงุ ุชุบุฑ ุขุฑุงู ูุญู ุจุงุนุซ ุชุบุฑ ุขุฑุงู ุฏุฑ ููููู MutableClass ูโุดูุฏ. ุงู ุซุงุจุช ูโฺฉูุฏ ฺฉู ุขุฑุงูโูุง <strong>ูุงุจู ุชุบุฑ (Mutable)</strong> ูุณุชูุฏ ู ุจูุงุจุฑุงู <strong>Thread-Safe</strong> ูุณุชูุฏ. โ๏ธ</p>
<hr>
<h2>ููุดุชู ฺฉุฏ Immutable ู Thread-Safe</h2>
<p>ุฏุฑ ูุซุงู <strong>Immutable</strong>ุ ุฏูุจุงุฑู ฺฉ ุจุฑูุงูู <strong>.NET Framework Console Application</strong> ุงุฌุงุฏ ูโฺฉูู ู ุงุฒ ููุงู ุขุฑุงู ุงุณุชูุงุฏู ูโฺฉูู.</p>
<p>ฺฉ ฺฉูุงุณ ุจู ูุงู <strong>ImmutableStruct</strong> ุงุถุงูู ฺฉูุฏ ู ฺฉุฏ ุฑุง ุจู ุดฺฉู ุฒุฑ ุงุตูุงุญ ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">internal</span> <span class="hljs-keyword">struct</span> ImmutableStruct
{
    <span class="hljs-keyword">private</span> ImmutableArray&lt;<span class="hljs-built_in">int</span>&gt; _immutableArray;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ImmutableStruct</span>(<span class="hljs-params">ImmutableArray&lt;<span class="hljs-built_in">int</span>&gt; immutableArray</span>)</span>
    {
        _immutableArray = immutableArray;
    }
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span>[] <span class="hljs-title">GetIntArray</span>()</span>
    {
        <span class="hljs-keyword">return</span> _immutableArray.ToArray&lt;<span class="hljs-built_in">int</span>&gt;();
    }
}
</code></pre>
<ul>
<li>ุจู ุฌุง ุขุฑุงู ุนุฏุฏ ุตุญุญ ูุนูููุ ุงุฒ <strong>ImmutableArray</strong> ุงุณุชูุงุฏู ูโฺฉูู.</li>
<li>ฺฉ ุขุฑุงู Immutable ุจู <strong>Constructor</strong> ูพุงุณ ุฏุงุฏู ุดุฏู ู ุจู ูุชุบุฑ ุนุถู <code>_immutableArray</code> ุงุฎุชุตุงุต ูโุงุจุฏ.</li>
<li>ูุชุฏ <strong>GetIntArray()</strong> ุขุฑุงู Immutable ุฑุง ุจู ุตูุฑุช ุขุฑุงู ุนุฏุฏ ุตุญุญ ูุนููู ุจุฑูโฺฏุฑุฏุงูุฏ.</li>
</ul>
<hr>
<h3>ImmutableExample Method</h3>
<p>ุฏุฑ ฺฉูุงุณ <strong>Program</strong>ุ ูุชุฏ <strong>ImmutableExample()</strong> ุฑุง ุงุถุงูู ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ImmutableExample</span>()</span>
{
    <span class="hljs-built_in">int</span>[] iar = { <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span> };
    <span class="hljs-keyword">var</span> immutableStruct = <span class="hljs-keyword">new</span> ImmutableStruct(iar.ToImmutableArray&lt;<span class="hljs-built_in">int</span>&gt;());
    Console.WriteLine(<span class="hljs-string">$&quot;Initial Array: <span class="hljs-subst">{iar[<span class="hljs-number">0</span>]}</span>, <span class="hljs-subst">{iar[<span class="hljs-number">1</span>]}</span>, <span class="hljs-subst">{iar[<span class="hljs-number">2</span>]}</span>, <span class="hljs-subst">{iar[<span class="hljs-number">3</span>]}</span>, <span class="hljs-subst">{iar[<span class="hljs-number">4</span>]}</span>, <span class="hljs-subst">{iar[<span class="hljs-number">5</span>]}</span>, <span class="hljs-subst">{iar[<span class="hljs-number">6</span>]}</span>, <span class="hljs-subst">{iar[<span class="hljs-number">7</span>]}</span>, <span class="hljs-subst">{iar[<span class="hljs-number">8</span>]}</span>, <span class="hljs-subst">{iar[<span class="hljs-number">9</span>]}</span>&quot;</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> x = <span class="hljs-number">0</span>; x &lt; <span class="hljs-number">9</span>; x++)
    {
        <span class="hljs-keyword">var</span> thread = <span class="hljs-keyword">new</span> Thread(() =&gt;
        {
            iar[x] = x + <span class="hljs-number">1</span>;
            <span class="hljs-keyword">var</span> ia = immutableStruct.GetIntArray();
            Console.WriteLine(<span class="hljs-string">$&quot;Array [<span class="hljs-subst">{x}</span>]: <span class="hljs-subst">{ia[<span class="hljs-number">0</span>]}</span>, <span class="hljs-subst">{ia[<span class="hljs-number">1</span>]}</span>, <span class="hljs-subst">{ia[<span class="hljs-number">2</span>]}</span>, <span class="hljs-subst">{ia[<span class="hljs-number">3</span>]}</span>, <span class="hljs-subst">{ia[<span class="hljs-number">4</span>]}</span>, <span class="hljs-subst">{ia[<span class="hljs-number">5</span>]}</span>, <span class="hljs-subst">{ia[<span class="hljs-number">6</span>]}</span>, <span class="hljs-subst">{ia[<span class="hljs-number">7</span>]}</span>, <span class="hljs-subst">{ia[<span class="hljs-number">8</span>]}</span>, <span class="hljs-subst">{ia[<span class="hljs-number">9</span>]}</span>&quot;</span>);
        });
        thread.Start();
    }
}
</code></pre>
<ul>
<li>ุฏุฑ ุงู ูุชุฏุ ุงุจุชุฏุง ฺฉ ุขุฑุงู ุนุฏุฏ ุตุญุญ ุงุฌุงุฏ ูโฺฉูู ู ุขู ุฑุง ุจู Constructor <strong>ImmutableStruct</strong> ุจู ุตูุฑุช ฺฉ <strong>ImmutableArray</strong> ูพุงุณ ูโุฏูู.</li>
<li>ุณูพุณ ูุญุชูุง ุขุฑุงู ูุญู ูุจู ุงุฒ ุชุบุฑ ฺุงูพ ูโุดูุฏ.</li>
<li>ุจุนุฏ ุงุฒ ุขูุ ฺฉ ุญููู น ุจุงุฑ ุงุฌุฑุง ูโฺฉูู ู ุฏุฑ ูุฑ ุชฺฉุฑุงุฑ ููุฏุงุฑ ุงูุฏฺฉุณ ุฌุงุฑ + ฑ ุจู ุขุฑุงู ูุญู ุงุถุงูู ูโฺฉูู.</li>
<li>ุณูพุณ ุงุฒ ุทุฑู ูุชุฏ <strong>GetIntArray()</strong>ุ ฺฉ ฺฉูพ ุงุฒ ุขุฑุงู Immutable ุฏุฑุงูุช ฺฉุฑุฏู ู ููุงุฏุฑ ุขู ุฑุง ฺุงูพ ูโฺฉูู.</li>
<li>ุฏุฑ ููุงุชุ Thread ุฑุง ุงุฌุฑุง ูโฺฉูู.</li>
</ul>
<p>ูุชุฏ <strong>ImmutableExample()</strong> ุฑุง ุงุฒ <strong>Main()</strong> ูุฑุงุฎูุงู ฺฉุฑุฏู ู ุจุฑูุงูู ุฑุง ุงุฌุฑุง ฺฉูุฏ. ุฎุฑูุฌ ูุดุงู ูโุฏูุฏ ฺฉู <strong>ุขุฑุงู Immutable ูฺ ุชุบุฑ ุชูุณุท Threadูุง ููโุจูุฏ</strong> ู ุจุฑูุงูู <strong>Thread-Safe</strong> ุงุณุช. โ</p>
<div align="center">
<p><img src="../../../assets/image/08/Table%208-16.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ููุงูโุทูุฑ ฺฉู ูโุจูุฏุ ูุญุชูุง ุขุฑุงู ุจุง ุชุบุฑ ุขุฑุงู ูุญู ุชุบุฑ ููโฺฉูุฏ. ุงู ูุณุฎู ุงุฒ ุจุฑูุงูู ูุดุงู ูโุฏูุฏ ฺฉู ุจุฑูุงูู ูุง <strong>Thread-Safe</strong> ุงุณุช. โ</p>
<hr>
<h2>ุฏุฑฺฉ ููููู Thread-Safety ๐ก๏ธ</h2>
<p>ููุงูโุทูุฑ ฺฉู ุฏุฑ ุฏู ุจุฎุด ูุจู ุฏุฏุฏุ ููฺฏุงู ููุดุชู ฺฉุฏูุง ฺูุฏ ูุฎ ุจุงุฏ ุจุณุงุฑ ูุฑุงูุจ ุจูุฏ. ููุดุชู ฺฉุฏ <strong>Thread-Safe</strong> ูโุชูุงูุฏ ุจูโูฺู ุฏุฑ ูพุฑูฺูโูุง ุจุฒุฑฺฏ ุจุณุงุฑ ุฏุดูุงุฑ ุจุงุดุฏ. ุดูุง ุจุงุฏ ุจูโุทูุฑ ูฺู ูุฑุงูุจ ููุงุฑุฏ ุฒุฑ ุจุงุดุฏ:</p>
<ul>
<li>ฺฉุงุฑ ุจุง <strong>Collections</strong></li>
<li><strong>ูพุงุณ ุฏุงุฏู ูพุงุฑุงูุชุฑูุง ุจูโุตูุฑุช ูุฑุฌุน (by reference)</strong></li>
<li>ุฏุณุชุฑุณ ุจู <strong>ูุชุบุฑูุง ุนุถู ุฏุฑ ฺฉูุงุณโูุง static</strong></li>
</ul>
<p>ุจูุชุฑู ุดููโูุง ุจุฑุง ุจุฑูุงููโูุง ฺูุฏ ูุฎ:</p>
<ol>
<li>ุชููุง ุงุฒ <strong>Immutable Types</strong> ุงุณุชูุงุฏู ฺฉูุฏ.</li>
<li>ุจู ูุชุบุฑูุง ุนุถู <strong>static</strong> ุฏุณุชุฑุณ ูพุฏุง ูฺฉูุฏ.</li>
<li>ุงฺฏุฑ ฺฉุฏ ูุฌูุฏ ุฏุงุฑุฏ ฺฉู <strong>Thread-Safe ูุณุช</strong>ุ ุขู ุฑุง ุจุง <strong>lockุ mutex ุง semaphore</strong> ูุญุงูุธุช ฺฉูุฏ.</li>
</ol>
<p>ฺฏุฑฺู ุดูุง ูุจูุงู ูููููโูุง ุงุฒ ุงู ฺฉุฏูุง ุฑุง ุฏุฑ ุงู ูุตู ุฏุฏูโุงุฏุ ุจุงุฏ ฺฉ ูุฑูุฑ ฺฉูุชุงู ุจุง ููููู ฺฉุฏ ุฏุงุดุชู ุจุงุดู.</p>
<hr>
<h3>ููููู ููุดุชู ฺฉ ููุน Immutable ุจุง <code>readonly struct</code></h3>
<pre class="hljs"><code><span class="hljs-keyword">public</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">struct</span> ImmutablePerson
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ImmutablePerson</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> id, <span class="hljs-built_in">string</span> firstName, <span class="hljs-built_in">string</span> lastName</span>)</span>
    {
        _id = id;
        _firstName = firstName;
        _lastName = lastName;
    }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> Id { <span class="hljs-keyword">get</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> FirstName { <span class="hljs-keyword">get</span> { <span class="hljs-keyword">return</span> _firstName; } }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> LastName { <span class="hljs-keyword">get</span> { <span class="hljs-keyword">return</span> _lastName; } }
}
</code></pre>
<ul>
<li>ุฏุฑ ุณุงุฎุชุงุฑ <strong>ImmutablePerson</strong>ุ ฺฉ <strong>Constructor ุนููู</strong> ุฏุงุฑู ฺฉู ฺฉ ุนุฏุฏ ุตุญุญ ุจุฑุง <strong>ID</strong> ู ุฏู ุฑุดุชู ุจุฑุง ูุงู ู ูุงู ุฎุงููุงุฏฺฏ ูโฺฏุฑุฏ.</li>
<li>ูพุงุฑุงูุชุฑูุง <strong>idุ firstName ู lastName</strong> ุจู ูุชุบุฑูุง ุนุถู <strong>Read-Only</strong> ุงุฎุชุตุงุต ุฏุงุฏู ูโุดููุฏ.</li>
<li>ุชููุง ุฏุณุชุฑุณ ุจู ุฏุงุฏูโูุง ุงุฒ ุทุฑู <strong>Properties ููุท ุฎูุงูุฏู</strong> ุงูุฌุงู ูโุดูุฏุ ุจูุงุจุฑุงู <strong>ุงูฺฉุงู ุชุบุฑ ุฏุงุฏูโูุง ูุฌูุฏ ูุฏุงุฑุฏ</strong>.</li>
</ul>
<p>ุงุฒ ุขูุฌุง ฺฉู ุฏุงุฏูโูุง ูพุณ ุงุฒ ุงุฌุงุฏ ูุงุจู ุชุบุฑ ูุณุชูุฏุ ุงู ุณุงุฎุชุงุฑ <strong>Thread-Safe</strong> ุงุณุช. ุนู ููโุชูุงู ุขู ุฑุง ุงุฒ ุทุฑู Threadูุง ูุฎุชูู ุชุบุฑ ุฏุงุฏ. ุชููุง ุฑุงู ุชุบุฑ ุฏุงุฏูโูุงุ ุงุฌุงุฏ ฺฉ <strong>Struct ุฌุฏุฏ ุจุง ุฏุงุฏูโูุง ุฌุฏุฏ</strong> ุงุณุช.</p>
<hr>
<h3>ูฺฉุงุช ุชฺฉูู</h3>
<ul>
<li>Structูุง ูโุชูุงููุฏ <strong>Mutable</strong> ุจุงุดูุฏุ ุฏุฑุณุช ูุงููุฏ ฺฉูุงุณโูุง.</li>
<li>ุงูุง ุงฺฏุฑ ูโุฎูุงูุฏ ุฏุงุฏูโูุง ุชุบุฑ ูุงูพุฐุฑ ุจุงุดูุฏุ <strong>Read-Only Structs</strong> ฺฏุฒููโุง ุณุจฺฉ ู ููุงุณุจ ูุณุชูุฏ.</li>
<li>ุงุฌุงุฏ ู ุงุฒ ุจู ุจุฑุฏู ุงู Structูุง ุณุฑุนโุชุฑ ุงุฒ ฺฉูุงุณโูุง ุงุณุชุ ุฒุฑุง ุฑู <strong>Stack</strong> ูุฑุงุฑ ูโฺฏุฑูุฏ (ูฺฏุฑ ุงูฺฉู ุจุฎุด ุงุฒ ฺฉูุงุณ ุจุงุดูุฏ ฺฉู ุฑู <strong>Heap</strong> ูุฑุงุฑ ุฏุงุฑุฏ).</li>
</ul>
<hr>
<h3>Collections Immutable</h3>
<p>ูพุดโุชุฑ ุฏุฏู ฺฉู <strong>Collections Mutable</strong> ูุณุชูุฏ. ุงูุง ฺฉ <strong>Namespace</strong> ุจุฑุง <strong>Immutable Collections</strong> ูุฌูุฏ ุฏุงุฑุฏ ุจู ูุงู:</p>
<p><strong><code>System.Collections.Immutable</code></strong></p>
<p>ุฌุฏูู ุฒุฑ ุจุฑุฎ ุงุฒ ุนูุงุตุฑ ููู ุงู Namespace ุฑุง ูุดุงู ูโุฏูุฏ:</p>
<div align="center">
<p><img src="../../../assets/image/08/Table%208-17.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>Namespace <strong><code>System.Collections.Immutable</code></strong> ุดุงูู ูุฌููุนูโุง ุงุฒ <strong>Immutable Collections</strong> ุงุณุช ฺฉู ูโุชูุงูุฏ ุจูโุทูุฑ ุงูู ุจู Threadูุง ุงุณุชูุงุฏู ฺฉูุฏ. ุจุฑุง ุฌุฒุฆุงุช ุจุดุชุฑุ ุจู ููฺฉ ุฒุฑ ูุฑุงุฌุนู ฺฉูุฏ:<br>
<a href="https://docs.microsoft.com/en-us/dotnet/api/system.collections.immutable?view=netcore-3.1">https://docs.microsoft.com/en-us/dotnet/api/system.collections.immutable?view=netcore-3.1</a> ๐</p>
<hr>
<h3>ุงุณุชูุงุฏู ุงุฒ Lock ุฏุฑ C# ๐</h3>
<p>ุงุณุชูุงุฏู ุงุฒ <strong>lock object</strong> ุฏุฑ C# ุจุณุงุฑ ุณุงุฏู ุงุณุชุ ููุงูโุทูุฑ ฺฉู ุฏุฑ ููููู ฺฉุฏ ุฒุฑ ูโุจูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">LockExample</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">object</span> _lock = <span class="hljs-keyword">new</span> <span class="hljs-built_in">object</span>();

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">UnsafeMethod</span>()</span>
    {
        <span class="hljs-keyword">lock</span>(_lock)
        {
            <span class="hljs-comment">// ุงุฌุฑุง ฺฉุฏ ุบุฑ ุงูู</span>
        }
    }
}
</code></pre>
<ul>
<li>ุงุจุชุฏุง ูุชุบุฑ ุนุถู <code>_lock</code> ุฑุง ุงุฌุงุฏ ู ูููููโุณุงุฒ ูโฺฉูู.</li>
<li>ุฒูุงู ฺฉู ูโุฎูุงูู ฺฉุฏ ฺฉู <strong>Thread-Safe ูุณุช</strong> ุฑุง ุงุฌุฑุง ฺฉููุ ุขู ุฑุง ุฏุงุฎู <strong>lock</strong> ูุฑุงุฑ ูโุฏูู ู <code>_lock</code> ุฑุง ุจู ุนููุงู <strong>lock object</strong> ุงุณุชูุงุฏู ูโฺฉูู.</li>
<li>ููุช ฺฉ Thread ูุงุฑุฏ lock ูโุดูุฏุ ุชูุงู Threadูุง ุฏฺฏุฑ ุชุง ุฎุฑูุฌ Thread ูุนู ุงุฒ lockุ ุงุฌุงุฒู ุงุฌุฑุง ูุฏุงุฑูุฏ.</li>
</ul>
<p>ฺฉ ูุดฺฉู ุงุญุชูุงู: <strong>Deadlock</strong>. ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุขู ูโุชูุงู ุงุฒ <strong>Mutex</strong> ุงุณุชูุงุฏู ฺฉุฑุฏ.</p>
<hr>
<h3>ุงุณุชูุงุฏู ุงุฒ Mutex ๐ก๏ธ</h3>
<p>ุงุจุชุฏุง ูุชุบุฑ Mutex ุฑุง ุชุนุฑู ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> Mutex _mutex = <span class="hljs-keyword">new</span> Mutex();
</code></pre>
<p>ุณูพุณ ฺฉุฏ ูุญุงูุธุชโุดุฏู ุฑุง ุจู ุงู ุตูุฑุช ุงุฌุฑุง ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">try</span>
{
    _mutex.WaitOne();
    <span class="hljs-comment">// ... ุงูุฌุงู ฺฉุงุฑ ...</span>
}
<span class="hljs-keyword">finally</span>
{
    _mutex.ReleaseMutex();
}
</code></pre>
<ul>
<li><strong>WaitOne()</strong> Thread ูุนู ุฑุง ุชุง ุฒูุงู ุฏุฑุงูุช ุณฺฏูุงู ูุชููู ูโฺฉูุฏ.</li>
<li>ูพุณ ุงุฒ ุฏุฑุงูุช ุณฺฏูุงูุ Thread ูุงูฺฉ <strong>mutex</strong> ูโุดูุฏ ู ูโุชูุงูุฏ ุจู ููุงุจุน ูุญุงูุธุชโุดุฏู ุฏุณุชุฑุณ ูพุฏุง ฺฉูุฏ.</li>
<li>ูพุณ ุงุฒ ุงุชูุงู ฺฉุงุฑุ ุจุง <strong>ReleaseMutex()</strong> Mutex ุขุฒุงุฏ ูโุดูุฏ.</li>
<li>ููู: ููุดู ReleaseMutex() ุฑุง ุฏุฑ ุจููฺฉ <strong>finally</strong> ูุฑุงุฑ ุฏูุฏ ุชุง ุฏุฑ ุตูุฑุช ุฑุฎ ุฏุงุฏู Exceptionุ ููุงุจุน ููฺูุงู ุขุฒุงุฏ ุดููุฏ. โ</li>
</ul>
<hr>
<h3>ุงุณุชูุงุฏู ุงุฒ Semaphore ๐ข</h3>
<p><strong>Semaphore</strong> ูุฒ ุดุจู Mutex ุนูู ูโฺฉูุฏุ ุงูุง ุชูุงูุช ุงุตู ุงู ุงุณุช ฺฉู <strong>Mutex ูฺฉุงูุฒู ููู ุงุณุช</strong> ู <strong>Semaphore ูฺฉุงูุฒู ุณฺฏูุงูโุฏู</strong>.</p>
<p>ูุซุงู ุชุนุฑู Semaphore:</p>
<pre class="hljs"><code><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> Semaphore _semaphore = <span class="hljs-keyword">new</span> Semaphore(<span class="hljs-number">2</span>, <span class="hljs-number">4</span>);
</code></pre>
<ul>
<li>ูพุงุฑุงูุชุฑ ุงูู: ุชุนุฏุงุฏ ุฏุฑุฎูุงุณุชโูุง ููุฒูุงู ุงููู ฺฉู ูโุชูุงููุฏ ุงุฌุงุฒู ุฏุณุชุฑุณ ุจฺฏุฑูุฏ.</li>
<li>ูพุงุฑุงูุชุฑ ุฏูู: ุญุฏุงฺฉุซุฑ ุชุนุฏุงุฏ ุฏุฑุฎูุงุณุชโูุง ููุฒูุงู ฺฉู ูโุชูุงููุฏ ุงุฌุงุฒู ุฏุณุชุฑุณ ุจฺฏุฑูุฏ.</li>
</ul>
<p>ุงุณุชูุงุฏู ุฏุฑ ูุชุฏูุง:</p>
<pre class="hljs"><code><span class="hljs-keyword">try</span>
{
    _semaphore.WaitOne();
    <span class="hljs-comment">// ... ุงูุฌุงู ฺฉุงุฑ ...</span>
}
<span class="hljs-keyword">finally</span>
{
    _semaphore.Release();
}
</code></pre>
<ul>
<li>Thread ูุนู ุชุง ุฏุฑุงูุช ุณฺฏูุงู ููุชุธุฑ ูโูุงูุฏุ ุณูพุณ ฺฉุงุฑ ุฎูุฏ ุฑุง ุงูุฌุงู ูโุฏูุฏ ู ุฏุฑ ููุงุช <strong>Semaphore</strong> ุขุฒุงุฏ ูโุดูุฏ.</li>
</ul>
<hr>
<h3>ูฺฉุงุช ููู ๐น</h3>
<ul>
<li>ุฏุฑ ุงู ูุตู ุงุฏ ฺฏุฑูุชู ฺฉู ฺฺฏููู ุจุง <strong>locksุ mutexes ู semaphores</strong> ุงุฒ ฺฉุฏูุง ุบุฑ Thread-Safe ูุญุงูุธุช ฺฉูู.</li>
<li><strong>Threadูุง ูพุณโุฒููู</strong> ูพุณ ุงุฒ ุงุชูุงู ูพุฑูุณู ุฎุงุชูู ูโุงุจูุฏุ ุฏุฑ ุญุงู ฺฉู <strong>Threadูุง ูพุดโุฒููู</strong> ุชุง ูพุงุงู ุงุฌุฑุง ุงุฏุงูู ูโุฏููุฏ.</li>
<li>ุงฺฏุฑ ูุงุฒ ุฏุงุฑุฏ ฺฉุฏ <strong>ุชุง ูพุงุงู ุงุฌุฑุง ุจุฏูู ูุทุน ุดุฏู Thread</strong> ุงุฏุงูู ูพุฏุง ฺฉูุฏุ ุจูุชุฑ ุงุณุช ุงุฒ <strong>Foreground Threads</strong> ุงุณุชูุงุฏู ฺฉูุฏ.</li>
</ul>
<hr>
<h3>ูุงุจุณุชฺฏโูุง ูุชุฏ ููุฒูุงู (Synchronized Method Dependencies) โก</h3>
<p>ุจุฑุง ููุฒูุงูโุณุงุฒ ฺฉุฏูุง:</p>
<ul>
<li>ุงุฒ <strong>lock statement</strong> ุงุณุชูุงุฏู ฺฉูุฏ.</li>
<li>ุง <strong>Namespace</strong> <code>System.Runtime.CompilerServices</code> ุฑุง ุงุถุงูู ฺฉุฑุฏู ู ุงุฒ annotation ุฒุฑ ุงุณุชูุงุฏู ฺฉูุฏ:</li>
</ul>
<pre class="hljs"><code>[<span class="hljs-meta">MethodImpl(MethodImplOptions.Synchronized)</span>]
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ThisIsASynchronisedMethod</span>()</span>
{
    Console.WriteLine(<span class="hljs-string">&quot;Synchronised method called.&quot;</span>);
}
</code></pre>
<p>ุจุง property ูุฒ ูโุชูุงู ููุฒูุงูโุณุงุฒ ุงูุฌุงู ุฏุงุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">private</span> <span class="hljs-built_in">int</span> i;
<span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> SomeProperty
{
    [<span class="hljs-meta">MethodImpl(MethodImplOptions.Synchronized)</span>]
    <span class="hljs-keyword">get</span> { <span class="hljs-keyword">return</span> i; }
    [<span class="hljs-meta">MethodImpl(MethodImplOptions.Synchronized)</span>]
    <span class="hljs-keyword">set</span> { i = <span class="hljs-keyword">value</span>; }
}
</code></pre>
<hr>
<h3>ุงุณุชูุงุฏู ุงุฒ ฺฉูุงุณ Interlocked โก</h3>
<p>ุฏุฑ ุจุฑูุงููโูุง ฺูุฏ ูุฎุ <strong>ุฎุทุงูุง ููฺฏุงู Context Switching Threadูุง</strong> ุฑุฎ ูโุฏููุฏุ ูุซูุงู ููุช ฺูุฏ Thread ูุชุบุฑ ฺฉุณุงู ุฑุง ุจูโุฑูุฒุฑุณุงู ูโฺฉููุฏ.</p>
<p>ฺฉูุงุณ <strong><code>System.Threading.Interlocked</code></strong> ุฏุฑ <strong>mscorlib</strong> ุจุฑุง ูุญุงูุธุช ุฏุฑ ุจุฑุงุจุฑ ุงู ุฎุทุงูุง ุงุณุชูุงุฏู ูโุดูุฏ.</p>
<p>ูฺฺฏโูุง:</p>
<ul>
<li>ุฑูุดโูุง <strong>Exception</strong> ููโุงูุฏุงุฒูุฏ ู ุนููฺฉุฑุฏ ุจูุชุฑ ูุณุจุช ุจู lock ุฏุงุฑูุฏ.</li>
<li>ุจุฑุง ุงุนูุงู ุชุบุฑุงุช ุณุงุฏู ุฏุฑ ูุถุนุช ูุชุบุฑูุง ุงุฏูโุขู ูุณุชูุฏ.</li>
</ul>
<hr>
<h3>ูุชุฏูุง ููุฌูุฏ ุฏุฑ Interlocked ๐ง</h3>
<ul>
<li><strong>CompareExchange</strong>: ููุงุณู ุฏู ูุชุบุฑ ู ุฐุฎุฑู ูุชุฌู ุฏุฑ ูุชุบุฑ ุฏฺฏุฑ</li>
<li><strong>Add</strong>: ุฌูุน ุฏู ูุชุบุฑ Int32 ุง Int64 ู ุฐุฎุฑู ูุชุฌู ุฏุฑ ูุชุบุฑ ุงูู</li>
<li><strong>Decrement</strong>: ฺฉุงูุด ููุฏุงุฑ Int32 ู Int64 ู ุฐุฎุฑู ูุชุฌู</li>
<li><strong>Increment</strong>: ุงูุฒุงุด ููุฏุงุฑ Int32 ู Int64 ู ุฐุฎุฑู ูุชุฌู</li>
<li><strong>Read</strong>: ุฎูุงูุฏู ูุชุบุฑูุง Int64</li>
<li><strong>Exchange</strong>: ุชุจุงุฏู ููุงุฏุฑ ุจู ูุชุบุฑูุง<br>
ูุง ุงฺฉููู ูุตุฏ ุฏุงุฑู ฺฉ ุจุฑูุงููโ ุณุงุฏูโ ฺฉูุณูู ุจููุณู ฺฉู ุงู ุฑูุดโูุง ุฑุง ููุงุด ุฏูุฏ. ๐ป</li>
</ul>
<p>ุงุจุชุฏุง ฺฉ ุจุฑูุงููโ ุฌุฏุฏ <strong>.NET Framework Console Application</strong> ุงุฌุงุฏ ฺฉูุฏ ู ุฎุทูุท ุฒุฑ ุฑุง ุฏุฑ ุจุงูุง ฺฉูุงุณ <strong>Program</strong> ุงุถุงูู ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">long</span> _value = <span class="hljs-built_in">long</span>.MaxValue;
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">int</span> _resourceInUse = <span class="hljs-number">0</span>;
</code></pre>
<p>ูุชุบุฑ <code>_value</code> ุจุฑุง ูุดุงู ุฏุงุฏู ุจูโุฑูุฒุฑุณุงู ูุชุบุฑูุง ุจุง ุงุณุชูุงุฏู ุงุฒ ุฑูุดโูุง <strong>interlocking</strong> ุงุณุชูุงุฏู ูโุดูุฏ. ูุชุบุฑ <code>_resourceInUse</code> ุจุฑุง ูุดุงู ุฏุงุฏู ุงู ุงุณุช ฺฉู ุขุง ฺฉ ููุจุน ุฏุฑ ุญุงู ุงุณุชูุงุฏู ุงุณุช ุง ุฎุฑ.</p>
<p>ุณูพุณ ูุชุฏ <strong>CompareExchangeVariables()</strong> ุฑุง ุงุถุงูู ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">CompareExchangeVariables</span>()</span>
{
    Interlocked.CompareExchange(<span class="hljs-keyword">ref</span> _value, <span class="hljs-number">123</span>, <span class="hljs-built_in">long</span>.MaxValue);
}
</code></pre>
<p>ุฏุฑ ูุชุฏ <strong>CompareExchangeVariables()</strong>ุ ูุง ูุชุฏ <strong>CompareExchange()</strong> ุฑุง ูุฑุงุฎูุงู ูโฺฉูู ุชุง <code>_value</code> ุฑุง ุจุง <code>long.MaxValue</code> ููุงุณู ฺฉูุฏ. ุงฺฏุฑ ุฏู ููุฏุงุฑ ุจุฑุงุจุฑ ุจุงุดูุฏุ <code>_value</code> ุจุง ููุฏุงุฑ <code>123</code> ุฌุงฺฏุฒู ูโุดูุฏ.</p>
<p>ุญุงูุง ูุชุฏ <strong>AddVariables()</strong> ุฑุง ุงุถุงูู ูโฺฉูู:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">AddVariables</span>()</span>
{
    Interlocked.Add(<span class="hljs-keyword">ref</span> _value, <span class="hljs-number">321</span>);
}
</code></pre>
<p>ูุชุฏ <strong>AddVariables()</strong> ูุชุฏ <strong>Add()</strong> ุฑุง ูุฑุงุฎูุงู ูโฺฉูุฏ ุชุง ุจู ูุชุบุฑ ุนุถู <code>_value</code> ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดุฏ ู ุขู ุฑุง ุจุง ููุฏุงุฑ <code>_value + 321</code> ุจูโุฑูุฒุฑุณุงู ฺฉูุฏ.</p>
<p>ุณูพุณ ูุชุฏ <strong>DecrementVariable()</strong> ุฑุง ุงุถุงูู ูโฺฉูู:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DecrementVariable</span>()</span>
{
    Interlocked.Decrement(<span class="hljs-keyword">ref</span> _value);
}
</code></pre>
<p>ุงู ูุชุฏุ ูุชุฏ <strong>Decrement()</strong> ุฑุง ูุฑุงุฎูุงู ูโฺฉูุฏ ฺฉู ููุฏุงุฑ ูุชุบุฑ ุนุถู <code>_value</code> ุฑุง ฑ ูุงุญุฏ ฺฉุงูุด ูโุฏูุฏ.</p>
<p>ูุชุฏ ุจุนุฏ <strong>IncrementVariable()</strong> ุงุณุช:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">IncrementVariable</span>()</span>
{
    Interlocked.Increment(<span class="hljs-keyword">ref</span> _value);
}
</code></pre>
<p>ุฏุฑ <strong>IncrementVariable()</strong>ุ ููุฏุงุฑ ูุชุบุฑ ุนุถู <code>_value</code> ุจุง ูุฑุงุฎูุงู ูุชุฏ <strong>Increment()</strong> ุงูุฒุงุด ูโุงุจุฏ.</p>
<p>ุญุงูุง ูุชุฏ <strong>ReadVariable()</strong> ุฑุง ูโููุณู:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">long</span> <span class="hljs-title">ReadVariable</span>()</span>
{
    <span class="hljs-comment">// ูุชุฏ Read ุฏุฑ ุณุณุชูโูุง 64 ุจุช ูุงุฒู ูุณุชุ</span>
    <span class="hljs-comment">// ฺูู ุนููุงุช ุฎูุงูุฏู 64 ุจุช ุจูโุตูุฑุช atomic ุงูุฌุงู ูโุดูุฏ.</span>
    <span class="hljs-comment">// ุฏุฑ ุณุณุชูโูุง 32 ุจุชุ ุนููุงุช ุฎูุงูุฏู 64 ุจุช atomic ูุณุช</span>
    <span class="hljs-comment">// ูฺฏุฑ ุงูฺฉู ุจุง Read ุงูุฌุงู ุดูุฏ.</span>
    <span class="hljs-keyword">return</span> Interlocked.Read(<span class="hljs-keyword">ref</span> _value);
}
</code></pre>
<p>ุงุฒ ุขูุฌุง ฺฉู ุนููุงุช ุฎูุงูุฏู ถด ุจุช atomic ุงุณุชุ ูุฑุงุฎูุงู ูุชุฏ <strong>Interlocked.Read()</strong> ุฏุฑ ุณุณุชูโูุง ถด ุจุช ุถุฑูุฑ ูุณุช. ุงูุง ุฏุฑ ุณุณุชูโูุง ณฒ ุจุชุ ุจุฑุง ุงูฺฉู ุฎูุงูุฏู ถด ุจุช atomic ุจุงุดุฏุ ุจุงุฏ ุงุฒ <strong>Interlocked.Read()</strong> ุงุณุชูุงุฏู ฺฉูุฏ.</p>
<p>ุณูพุณ ูุชุฏ <strong>PerformUnsafeCodeSafely()</strong> ุฑุง ุงุถุงูู ูโฺฉูู:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">PerformUnsafeCodeSafely</span>()</span>
{
    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++)
    {
        UseResource();
        Thread.Sleep(<span class="hljs-number">1000</span>);
    }
}
</code></pre>
<p>ูุชุฏ <strong>PerformUnsafeCodeSafely()</strong> ูพูุฌ ุจุงุฑ ุญููู ูโุฒูุฏ. ุฏุฑ ูุฑ ุจุงุฑ ุญูููุ ูุชุฏ <strong>UseResource()</strong> ูุฑุงุฎูุงู ูโุดูุฏ ู ุณูพุณ ูุฎ ุจุฑุง ฺฉ ุซุงูู ุจู ุฎูุงุจ ูโุฑูุฏ.</p>
<p>ุญุงูุง ูุชุฏ <strong>UseResource()</strong> ุฑุง ุงุถุงูู ูโฺฉูู:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">UseResource</span>()</span>
{
    <span class="hljs-keyword">if</span> (<span class="hljs-number">0</span> == Interlocked.Exchange(<span class="hljs-keyword">ref</span> _resourceInUse, <span class="hljs-number">1</span>))
    {
        Console.WriteLine(<span class="hljs-string">$&quot;<span class="hljs-subst">{Thread.CurrentThread.Name}</span> acquired the lock&quot;</span>);
        NonThreadSafeResourceAccess();
        Thread.Sleep(<span class="hljs-number">500</span>);
        Console.WriteLine(<span class="hljs-string">$&quot;<span class="hljs-subst">{Thread.CurrentThread.Name}</span> exiting lock&quot;</span>);
        Interlocked.Exchange(<span class="hljs-keyword">ref</span> _resourceInUse, <span class="hljs-number">0</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">else</span>
    {
        Console.WriteLine(<span class="hljs-string">$&quot;<span class="hljs-subst">{Thread.CurrentThread.Name}</span> was denied the lock&quot;</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
}
</code></pre>
<p>ูุชุฏ <strong>UseResource()</strong> ุฌููฺฏุฑ ูโฺฉูุฏ ุงุฒ ุงูฺฉู ุงฺฏุฑ ููุจุน ุฏุฑ ุญุงู ุงุณุชูุงุฏู ุงุณุชุ <strong>lock</strong> ฺฏุฑูุชู ุดูุฏุ ููุงูุทูุฑ ฺฉู ุชูุณุท ูุชุบุฑ <code>_resourceInUse</code> ูุดุฎุต ุดุฏู ุงุณุช. ุงุจุชุฏุง ููุฏุงุฑ <code>_resourceInUse</code> ุฑุง ุจุง ูุฑุงุฎูุงู ูุชุฏ <strong>Exchange()</strong> ุฑู ฑ ุชูุธู ูโฺฉูู. ูุชุฏ <strong>Exchange()</strong> ฺฉ ุนุฏุฏ ุจุงุฒูโฺฏุฑุฏุงูุฏ ฺฉู ุจุง ฐ ููุงุณู ูโุดูุฏ. ุงฺฏุฑ ููุฏุงุฑ ุจุงุฒฺฏุดุช ฐ ุจุงุดุฏุ ูุชุฏ ุฏุฑ ุญุงู ุงุณุชูุงุฏู ูุณุช.</p>
<p>ุงฺฏุฑ ูุชุฏ ุฏุฑ ุญุงู ุงุณุชูุงุฏู ุจุงุดุฏุ ูพุงู ุจู ฺฉุงุฑุจุฑ ููุงุด ุฏุงุฏู ูโุดูุฏ ฺฉู ูุฎ ูุนู ุงุฌุงุฒูโ lock ูุฏุงุฑุฏ.<br>
ุงฺฏุฑ ูุชุฏ ุขุฒุงุฏ ุจุงุดุฏุ ูพุงู ุจู ฺฉุงุฑุจุฑ ููุงุด ุฏุงุฏู ูโุดูุฏ ฺฉู ูุฎ ูุนู lock ุฑุง ฺฏุฑูุชู ุงุณุช. ุณูพุณ ูุชุฏ <strong>NonThreadSafeResourceAccess()</strong> ูุฑุงุฎูุงู ูโุดูุฏ ู ูุฎ ุจุฑุง ูู ุซุงูู ุจู ุฎูุงุจ ูโุฑูุฏ ุชุง ุดุจูโุณุงุฒ ฺฉุงุฑ ุงูุฌุงู ุดูุฏ.</p>
<p>ูพุณ ุงุฒ ุจุฏุงุฑ ุดุฏู ูุฎุ ูพุงู ูุดุงู ูโุฏูุฏ ฺฉู ูุฎ ูุนู ุงุฒ lock ุฎุงุฑุฌ ุดุฏู ุงุณุช ู ุณูพุณ lock ุจุง ูุฑุงุฎูุงู <strong>Exchange()</strong> ุขุฒุงุฏ ูโุดูุฏ ู ููุฏุงุฑ <code>_resourceInUse</code> ุจู ฐ ุจุงุฒฺฏุฑุฏุงูุฏู ูโุดูุฏ.</p>
<p>ูุชุฏ <strong>NonThreadSafeResourceAccess()</strong> ุฑุง ุงุถุงูู ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">NonThreadSafeResourceAccess</span>()</span>
{
    Console.WriteLine(<span class="hljs-string">&quot;Non-thread-safe code executed.&quot;</span>);
}
</code></pre>
<p>ุฏุฑ <strong>NonThreadSafeResourceAccess()</strong> ฺฉุฏ ุบุฑ thread-safe ุฏุฑ ุงููุช lock ุงุฌุฑุง ูโุดูุฏ. ุฏุฑ ูุซุงู ูุงุ ููุท ูพุงู ุจู ฺฉุงุฑุจุฑ ููุงุด ุฏุงุฏู ูโุดูุฏ.</p>
<p>ุฏุฑ ููุงุชุ ูุชุฏ <strong>Main()</strong> ุฑุง ุจู ุดฺฉู ุฒุฑ ุจูโุฑูุฒุฑุณุงู ฺฉูุฏ:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] <span class="hljs-keyword">args</span></span>)</span>
{
    CompareExchangeVariables();
    AddVariables();
    DecrementVariable();
    IncrementVariable();
    ReadVariable();
    PerformUnsafeCodeSafely();
}
</code></pre>
<p>ูุชุฏ <strong>Main()</strong> ูุชุฏูุง ฺฉู ุฑูุดโูุง <strong>Interlocked</strong> ุฑุง ุชุณุช ูโฺฉููุฏุ ูุฑุงุฎูุงู ูโฺฉูุฏ. โ</p>
<p>ุงฺฏุฑ ฺฉุฏ ุฑุง ุงุฌุฑุง ฺฉูุฏุ ุฎุฑูุฌ ูุดุงุจู ฺุฒ ุฎูุงูุฏ ุจูุฏ ฺฉู ุงูุชุธุงุฑ ุฏุงุฑู.</p>
<div align="center">
<p><img src="../../../assets/image/08/Table%208-18.jpeg" alt="Conventions-UsedThis-Book"></p>
</div>
<p>ุญุงู ุจุงุฏ ุจู ุจุฑุฎ ุชูุตูโูุง ุนููู ุจูพุฑุฏุงุฒู. ๐</p>
<h3>ุชูุตูโูุง ุนููู โ๏ธ</h3>
<p>ุฏุฑ ุงู ุจุฎุด ููุงุ ุจุฑุฎ ุงุฒ ุชูุตูโูุง ูุงฺฉุฑูุณุงูุช ุจุฑุง ฺฉุงุฑ ุจุง ุจุฑูุงููโูุง <strong>multi-threaded</strong> ุฑุง ุจุฑุฑุณ ูโฺฉูู. ุงู ุชูุตูโูุง ุดุงูู ููุงุฑุฏ ุฒุฑ ูุณุชูุฏ:</p>
<ul>
<li>ุงุฒ <strong>Thread.Abort</strong> ุจุฑุง ุฎุงุชูู ุฏุงุฏู ุจู ุณุงุฑ threadูุง ุงุฌุชูุงุจ ฺฉูุฏ.</li>
<li>ุงุฒ <strong>mutex</strong>ุ <strong>ManualResetEvent</strong>ุ <strong>AutoResetEvent</strong> ู <strong>Monitor</strong> ุจุฑุง ููฺฏุงูโุณุงุฒ ูุนุงูุชโูุง ุจู ฺูุฏ thread ุงุณุชูุงุฏู ฺฉูุฏ.</li>
<li>ูุฑ ุฌุง ฺฉู ููฺฉู ุงุณุชุ ุงุฒ <strong>thread pool</strong> ุจุฑุง threadูุง ฺฉุงุฑ ุงุณุชูุงุฏู ฺฉูุฏ.</li>
<li>ุงฺฏุฑ threadูุง ฺฉุงุฑ ุดูุง ูุณุฏูุฏ ุดุฏูุฏุ ุงุฒ <strong>Monitor.PulseAll</strong> ุจุฑุง ุงุทูุงุน ุฏุงุฏู ุจู ููู threadูุง ุงุฒ ุชุบุฑ ูุถุนุช thread ฺฉุงุฑ ุงุณุชูุงุฏู ฺฉูุฏ.</li>
<li>ุงุฒ ุงุณุชูุงุฏู ุงุฒ <strong>this</strong>ุ ูููููโูุง ููุนโูุง (<strong>type instances</strong>) ู ูููููโูุง ุฑุดุชูโุง (<strong>string instances</strong>) ุงุฒ ุฌููู ุฑุดุชูโูุง literal ุจูโุนููุงู <strong>lock objects</strong> ุงุฌุชูุงุจ ฺฉูุฏ. ุงุณุชูุงุฏู ุงุฒ ููุน lockูุง ูโุชูุงูุฏ ุฎุทุฑ deadlock ุงุฌุงุฏ ฺฉูุฏุ ูพุณ ูุฑุงูุจ ุจุงุดุฏ.</li>
<li>ุงุฒ ุจููฺฉ <strong>try/finally</strong> ุจุง threadูุง ฺฉู ูุงุฑุฏ <strong>monitor</strong> ูโุดููุฏ ุงุณุชูุงุฏู ฺฉูุฏุ ุชุง ุฏุฑ ุจููฺฉ <strong>finally</strong> ุงุทููุงู ุญุงุตู ุดูุฏ ฺฉู thread ุจุง ูุฑุงุฎูุงู <strong>Monitor.Exit()</strong> ุงุฒ monitor ุฎุงุฑุฌ ูโุดูุฏ.</li>
<li>ุจุฑุง ููุงุจุน ูุฎุชููุ ุงุฒ threadูุง ุฌุฏุงฺฏุงูู ุงุณุชูุงุฏู ฺฉูุฏ ู ุงุฒ ุงุฎุชุตุงุต ฺูุฏ thread ุจู ฺฉ ููุจุน ุงุฌุชูุงุจ ฺฉูุฏ.</li>
<li>ูุธุงู <strong>I/O</strong> ุจุงุฏ thread ูุฎุตูุต ุฎูุฏ ุฑุง ุฏุงุดุชู ุจุงุดูุฏุ ุฒุฑุง ููฺฏุงู ุงูุฌุงู ุนููุงุช I/O ูุณุฏูุฏ ูโุดููุฏ ู ุงู ุงุฌุงุฒู ูโุฏูุฏ ุณุงุฑ threadูุง ุงุฌุฑุง ุดููุฏ.</li>
<li>ูุฑูุฏ ฺฉุงุฑุจุฑ ุจุงุฏ thread ูุฎุตูุต ุจู ุฎูุฏ ุฑุง ุฏุงุดุชู ุจุงุดุฏ.</li>
<li>ุจุฑุง ุจูุจูุฏ ุนููฺฉุฑุฏ ุฏุฑ ุชุบุฑุงุช ุณุงุฏู ูุถุนุชุ ุงุฒ ูุชุฏูุง ฺฉูุงุณ <strong>System.Threading.Interlocked</strong> ุจู ุฌุง ุฏุณุชูุฑ <strong>lock</strong> ุงุณุชูุงุฏู ฺฉูุฏ.</li>
<li>ุจุฑุง ฺฉุฏูุง ฺฉู ุงุณุชูุงุฏู ุฒุงุฏ ุฏุงุฑูุฏุ ุงุฒ ููฺฏุงูโุณุงุฒ ุงุฌุชูุงุจ ฺฉูุฏุ ุฒุฑุง ูโุชูุงูุฏ ููุฌุฑ ุจู deadlock ู race condition ุดูุฏ.</li>
<li>ุฏุงุฏูโูุง <strong>static</strong> ุจุงุฏ ุจูโุตูุฑุช ูพุดโูุฑุถ <strong>thread-safe</strong> ุจุงุดูุฏ.</li>
<li>ุฏุงุฏูโูุง <strong>instance</strong> ูุจุงุฏ ุจูโุตูุฑุช ูพุดโูุฑุถ <strong>thread-safe</strong> ุจุงุดูุฏุ ุฏุฑ ุบุฑ ุงู ุตูุฑุช ุนููฺฉุฑุฏ ฺฉุงูุด ูโุงุจุฏุ ุฑูุงุจุช ุจุฑ ุณุฑ lock ุงูุฒุงุด ูโุงุจุฏ ู ุงูฺฉุงู ูููุน race condition ู deadlock ุงูุฒุงุด ูโุงุจุฏ.</li>
<li>ุงุฒ ูุชุฏูุง <strong>static</strong> ฺฉู state ุฑุง ุชุบุฑ ูโุฏููุฏ ุงุฌุชูุงุจ ฺฉูุฏุ ุฒุฑุง ููุฌุฑ ุจู ุจุงฺฏโูุง threading ูโุดููุฏ.</li>
</ul>
<hr>
<h3>ุฌูุนโุจูุฏ ๐</h3>
<p>ุฏุฑ ุงู ูุตูุ ูุง ุจุฑุฑุณ ฺฉุฑุฏู ฺฉู <strong>threading</strong> ฺุณุช ู ฺฺฏููู ุงุฒ ุขู ุงุณุชูุงุฏู ฺฉูู. ูุง ูุดฺฉูุงุช <strong>deadlock</strong> ู <strong>race condition</strong> ุฑุง ูุดุงูุฏู ฺฉุฑุฏู ู ุฏุฏู ฺฺฏููู ูโุชูุงู ุจุง ุงุณุชูุงุฏู ุงุฒ <strong>lock statement</strong> ู ฺฉุชุงุจุฎุงูู <strong>TPL</strong> ุงุฒ ุงู ุดุฑุงุท ุงุณุชุซูุง ุฌููฺฏุฑ ฺฉุฑุฏ. ููฺูู ุจู ุจุฑุฑุณ <strong>thread safety</strong> ุฏุฑ <strong>static constructors</strong>ุ <strong>static methods</strong>ุ <strong>immutable objects</strong> ู <strong>mutable objects</strong> ูพุฑุฏุงุฎุชู. ูุดุงูุฏู ฺฉุฑุฏู ฺฉู ุงุณุชูุงุฏู ุงุฒ <strong>immutable objects</strong> ุฑุงู ุงูู ุจุฑุง ุงูุชูุงู ุฏุงุฏู ุจู threadูุง ุงุณุช ู ุจุฑุฎ ุชูุตูโูุง ุนููู ุจุฑุง ฺฉุงุฑ ุจุง threadูุง ูุฑูุฑ ุดุฏ.</p>
<p>ููฺูู ุฏุฏู ฺฉู ฺฺฏููู ุงูู ฺฉุฑุฏู ฺฉุฏ ุจุฑุง threadูุง ูโุชูุงูุฏ ูุฒุงุง ุฒุงุฏ ุฏุงุดุชู ุจุงุดุฏ. โ</p>
<p>ุฏุฑ ูุตู ุจุนุฏุ ุจู ุทุฑุงุญ <strong>APIs</strong> ูุคุซุฑ ุฎูุงูู ูพุฑุฏุงุฎุช. ุงูุง ุฏุฑ ุญุงู ุญุงุถุฑ ูโุชูุงูุฏ ุฏุงูุด ุฎูุฏ ุฑุง ุจุง ูพุงุณุฎ ุฏุงุฏู ุจู ุณูุงูุงุช ุฒุฑ ุงูุชุญุงู ฺฉูุฏ ู ูุทุงูุนู ุฎูุฏ ุฑุง ุจุง ูุฑุงุฌุนู ุจู ููฺฉโูุง ุงุฑุงุฆู ุดุฏู ุงุฏุงูู ุฏูุฏ.</p>
<hr>
<h3>ุณูุงูุงุช โ</h3>
<ol>
<li><strong>Thread ฺุณุชุ</strong></li>
<li>ุฏุฑ ฺฉ ุจุฑูุงูู <strong>single-threaded</strong> ฺูุฏ thread ูุฌูุฏ ุฏุงุฑุฏุ</li>
<li>ฺู ุงููุงุน ุงุฒ thread ูุฌูุฏ ุฏุงุฑุฏุ</li>
<li>ฺฉุฏุงู thread ุจูุงูุงุตูู ูพุณ ุงุฒ ุฎุฑูุฌ ุจุฑูุงูู ุฎุงุชูู ูโุงุจุฏุ</li>
<li>ฺฉุฏุงู thread ุญุช ูพุณ ุงุฒ ุฎุฑูุฌ ุจุฑูุงูู ุชุง ุชฺฉูู ุงุฏุงูู ูโุงุจุฏุ</li>
<li>ฺู ฺฉุฏ ุจุงุนุซ ูโุดูุฏ ฺฉ thread ุจู ูุฏุช ูู ููโุซุงูู ุจุฎูุงุจุฏุ</li>
<li>ฺฺฏููู ฺฉ thread ุงุฌุงุฏ ูโฺฉูุฏ ฺฉู ูุชุฏ ุจู ูุงู <strong>Method1</strong> ุฑุง ูุฑุงุฎูุงู ฺฉูุฏุ</li>
<li>ฺฺฏููู ฺฉ thread ุฑุง ุจู <strong>background thread</strong> ุชุจุฏู ูโฺฉูุฏุ</li>
<li><strong>Deadlock</strong> ฺุณุชุ</li>
<li>ฺฺฏููู ุงุฒ ฺฉ lock ฺฉู ุจุง <strong>Monitor.TryEnter(objectName)</strong> ฺฏุฑูุชู ุดุฏู ุฎุงุฑุฌ ูโุดูุฏุ</li>
<li>ฺฺฏููู ูโุชูุงู ุงุฒ <strong>deadlock</strong> ุจุงุฒุงุจ ฺฉุฑุฏุ</li>
<li><strong>Race condition</strong> ฺุณุชุ</li>
<li>ฺฉ ุฑูุด ุจุฑุง ุฌููฺฏุฑ ุงุฒ <strong>race condition</strong> ฺุณุชุ</li>
<li>ฺู ฺุฒ ูุชุฏูุง <strong>static</strong> ุฑุง ูุงุงูู ูโฺฉูุฏุ</li>
<li>ุขุง <strong>static constructors</strong> thread-safe ูุณุชูุฏุ</li>
<li>ฺู ฺุฒ ูุณุฆูู ูุฏุฑุช ฺฏุฑููโูุง thread ุงุณุชุ</li>
<li><strong>Immutable object</strong> ฺุณุชุ</li>
<li>ฺุฑุง ุฏุฑ ุจุฑูุงููโูุง multi-threadedุ <strong>immutable objects</strong> ูุณุจุช ุจู <strong>mutable objects</strong> ุชุฑุฌุญ ุฏุงุฏู ูโุดููุฏุ</li>
</ol>
<hr>
<h3>ูุทุงูุนูโ ุจุดุชุฑ ๐</h3>
<ul>
<li><a href="https://www.c-sharpcorner.com/blogs/mutex-and-semaphore-inthread">Examples of using mutex and semaphore</a></li>
<li><a href="https://www.guru99.com/mutex-vs-semaphore.html">Differences between mutex and semaphore</a></li>
<li><a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/static-constructors">Official Microsoft documentation on static constructors</a></li>
<li><a href="https://docs.microsoft.com/en-us/dotnet/standard/threading/managedthreading-best-practices">Microsoft guidance on managed threading best practices</a></li>
<li><a href="https://docs.microsoft.com/en-us/dotnet/standard/parallel-programming/task-parallel-library-tpl">Official Microsoft API documentation for the TPL</a></li>
<li><a href="https://www.c-sharpcorner.com/UploadFile/1d42da/interlocked-class-inC-Sharp-threading/">Interlocked class in C# threading</a></li>
<li><a href="http://geekswithblogs.net/BlackRabbitCoder/archive/2012/08/23/c.net-little-wonders-interlocked-read-and-exchange.aspx">Discussion on System.Threading.Interlocked</a></li>
<li><a href="http://www.albahari.com/threading/">Free eBook about threading in C#</a></li>
<li><a href="https://docs.microsoft.com/en-us/dotnet/api/system.collections.immutable?view=netcore-3.1">Immutable collections in System.Collections.Immutable</a></li>
</ul>

</main>


 

  <!-- ููุชุฑ ูุดุชุฑฺฉ -->
  <footer class="footer">
    <div class="container">
      <p>
        <img src="/icone/copyright.svg" alt="ฺฉูพโุฑุงุช" width="14" height="14"
             style="vertical-align:middle;margin-inline:4px">
        <span id="y"></span> Gitab โ ุจุฑุง ุชูุณุนูโุฏููุฏฺฏุงู
      </p>
    </div>
  </footer>

  <!-- ุณุงู + ุงุณฺฉุฑูพุช ุชู -->
<script>
(() => {
  const root = document.documentElement;
  const btn = document.getElementById('themeToggle');
  const KEY = 'gitab-theme';
  const media = window.matchMedia('(prefers-color-scheme: dark)');
  const getEffective = s => (s === 'auto' ? (media.matches ? 'dark' : 'light') : s);

  function updateTheme(s) {
    root.setAttribute('data-theme', s);
    const mode = getEffective(s);
    root.dataset.colorMode = mode;
    btn.dataset.icon = mode === 'dark' ? 'moon' : 'sun';
  }

  // ููุฏุงุฑ ุฐุฎุฑูโุดุฏู ุง ูพุดโูุฑุถ
  let saved = localStorage.getItem(KEY) || 'auto';
  updateTheme(saved);

  btn.addEventListener('click', () => {
    // ุจูโุฑูุฒุฑุณุงู ููุฑ ุชู
    const current = localStorage.getItem(KEY) || 'auto';
    const next = current === 'auto' ? 'dark' : current === 'dark' ? 'light' : 'auto';
    localStorage.setItem(KEY, next);
    updateTheme(next);
  });

  // ููุช ุชู ุณุณุชู ุชุบุฑ ฺฉูู ู ุญุงูุช auto ูุนุงููุ ุชู ุจูโุฑูุฒุฑุณุงู ูุดู
  media.addEventListener('change', () => {
    if ((localStorage.getItem(KEY) || 'auto') === 'auto') updateTheme('auto');
  });

  // ุงุทููุงู ุงุฒ ููโุฒูุงู ุจู DOM ู localStorage
  document.addEventListener('DOMContentLoaded', () => {
    updateTheme(localStorage.getItem(KEY) || 'auto');
  });
})();
</script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script>hljs.highlightAll();</script>

<script>
document.querySelectorAll('pre code').forEach(block => {
  const btn = document.createElement('button');
  btn.className = 'copy-btn';

  const icon = document.createElement('img');
  icon.src = '/icone/copy.svg';
  icon.alt = 'Copy';
  btn.appendChild(icon);

  block.parentNode.insertBefore(btn, block);

  btn.addEventListener('click', async () => {
    await navigator.clipboard.writeText(block.textContent);
    btn.classList.add('copied');
    setTimeout(() => btn.classList.remove('copied'), 1500);
  });
});
</script>
<script>
  document.body.dataset.page = window.location.pathname;
</script>
<script>
  // ุจุงุฒ ู ุจุณุชู ฺฉุฑุฏู ููู ููุจุงู
  const menuBtn = document.querySelector(".menu-toggle");
  const nav = document.querySelector(".nav");

  if (menuBtn && nav) {
    // ุจุงุฒ ู ุจุณุชู ุดุฏู ุจุง ุฏฺฉูู
    menuBtn.addEventListener("click", (e) => {
      e.stopPropagation(); // ูุฐุงุฑู ฺฉูฺฉ ุฑู ุฎูุฏ ุฏฺฉูู ุจุงุนุซ ุจุณุชู ุดุฏู ุจุดู
      nav.classList.toggle("show");
    });

    // ุจุณุชู ููู ุจุง ฺฉูฺฉ ุจุฑูู
    document.addEventListener("click", (e) => {
      const clickedInsideNav = nav.contains(e.target);
      const clickedMenuButton = menuBtn.contains(e.target);
      if (!clickedInsideNav && !clickedMenuButton) {
        nav.classList.remove("show");
      }
    });
  }
</script>



</body>

</html>
